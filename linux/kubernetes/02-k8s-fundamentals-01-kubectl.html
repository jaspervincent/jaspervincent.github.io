<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kubernetes: Kuberctl</title>
<meta name="generator" content="Org Mode" />
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="me" href="https://emacs.ch/@jasperhsu">
<meta name="google-adsense-account" content="ca-pub-1741779893655624">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1741779893655624" crossorigin="anonymous"></script>
<!-- from -->
<!--
<style>#back-to-top{background:#000;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;bottom:20px;-webkit-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);-moz-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);box-shadow:0 2px 5px 0 rgba(0,0,0,.26);color:#fff;cursor:pointer;display:block;height:56px;opacity:1;outline:0;position:fixed;right:20px;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-transition:bottom .2s,opacity .2s;-o-transition:bottom .2s,opacity .2s;-moz-transition:bottom .2s,opacity .2s;transition:bottom .2s,opacity .2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:56px;z-index:1}#back-to-top svg{display:block;fill:currentColor;height:24px;margin:16px auto 0;width:24px}#back-to-top.hidden{bottom:-56px;opacity:0}</style>
-->
<link rel="stylesheet" href="/static/aandds.com/css/main.css">
<link rel="stylesheet" href="/static/aandds.com/css/drollery.min.css">
<script type="text/javascript" src="/static/aandds.com/js/main.js"></script>
<!--
<script id="MathJax-script" async="" src="/static/aandds.com/js/mathjax.js"></script>

<script type="text/javascript" src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
-->
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">Kubernetes: Kuberctl</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#h:9acbbac1-a4f6-4659-b3ea-cc586a5f63c3">核心组件-kubectl</a>
<ul>
<li><a href="#h:6d6b3a69-7ddb-4756-b8fd-03133bff0331">简述</a></li>
<li><a href="#h:d1f497ed-c277-4f4e-b59b-a81dd52b995a">常用命令</a>
<ul>
<li><a href="#h:4b222705-4ed7-4aa3-9b82-2865d66e15c1">Kubectl 自动补全</a></li>
<li><a href="#h:d16a9bcf-7dd6-4d6e-8e24-bca94b1a07db">Kubectl 上下文和配置</a></li>
<li><a href="#h:003e354b-b904-4c87-8d2f-751111a8eb71">Kubectl apply</a></li>
<li><a href="#h:33141834-8c88-413b-8eb6-94ca70aed8a2">创建对象</a></li>
<li><a href="#h:53c692cd-432a-44d0-952f-b26c43068d3d">查看和查找资源</a></li>
<li><a href="#h:d9cf5e45-2883-4b84-b574-deea116f00af">更新资源</a></li>
<li><a href="#h:55b38d9b-62a7-4220-9993-dc002b343544">部分更新资源</a></li>
<li><a href="#h:70ee5f11-67c0-4c2d-a531-c489e3122c21">编辑资源</a></li>
<li><a href="#h:c75bd29b-db97-4b3a-8281-47c0decd5f8e">对资源进行伸缩</a></li>
<li><a href="#h:3c8f9a85-92f4-461b-8ef1-8e852d5cbb5f">删除资源</a></li>
<li><a href="#h:44b46dd3-84ab-4423-83ca-45ca12bd429c">与运行中的 Pods 进行交互</a>
<ul>
<li><a href="#h:e98c97ec-2a15-47e8-b5e8-13f8c6a53fe7">logs</a></li>
</ul>
</li>
<li><a href="#h:70d9e9fa-2aa0-451d-a672-688045db17b0">与 Deployments 和 Services 进行交互</a></li>
<li><a href="#h:ec537685-5de8-4289-ad9a-5e612d6261b7">与节点和集群进行交互</a></li>
<li><a href="#h:b7f48b6a-384f-4168-8c61-5c3873120f4b">资源类型</a></li>
<li><a href="#h:20ff773d-4155-4425-8cdb-475b8e1bc31c">格式化输出</a></li>
<li><a href="#h:9b826fe2-1263-40fc-8f32-661a3870919c">Kubectl 日志输出详细程度和调试</a></li>
</ul>
</li>
<li><a href="#h:de6d55b6-37c3-4283-95a1-8935770a4262">kubectl安装</a></li>
<li><a href="#h:c285c725-1765-4fa3-866d-fac8b2f8e8ed">命令详解</a>
<ul>
<li><a href="#h:75e751b8-ad12-40d5-9504-8de911d7ca32">查看</a>
<ul>
<li><a href="#h:beeca436-d72a-4a7c-aacd-536a2a231a43">Cluster Info</a></li>
<li><a href="#h:834bb8a4-7a47-4bca-9b4a-49f82359b3cb">查看上下文</a></li>
<li><a href="#h:ed3f8cc5-8a27-41d3-95b4-bfa670fc6ffe">Nodes</a></li>
<li><a href="#h:75ea09b4-66d3-4dd9-ba46-76a17fb0b3a7">Pods</a></li>
<li><a href="#h:097bfcd0-269d-4236-9f91-c70f75807774">Namespaces（命名空间）</a></li>
<li><a href="#h:24c3bda7-20ef-4366-83da-fc47e624800b">Deployments</a></li>
<li><a href="#h:0de9d447-575c-4524-8fb8-9b8646b747e9">Services</a></li>
<li><a href="#h:523ee34e-05c8-4860-9bf8-01a9498b00b8">Events</a></li>
<li><a href="#h:b36b36d6-e0a3-4ff0-af7b-f3199c21e585">logs</a></li>
<li><a href="#h:bdc71311-1ad8-4303-8aa9-c7aa4e145427">Service Accounts</a></li>
<li><a href="#h:e254bd02-e754-4d55-903c-29581fc0806b">ReplicaSets</a></li>
<li><a href="#h:752f915f-7331-4a0c-8ee3-b05c9babc5f0">Roles</a></li>
<li><a href="#h:e20c4c24-f83c-45a7-834f-14f0071773de">Secrets</a></li>
<li><a href="#h:00ba9576-b213-4d3d-9154-cfe5cf2b326e">ConfigMaps</a></li>
<li><a href="#h:2b039f47-123c-472a-af64-b7baf2c3e30e">Ingress</a></li>
<li><a href="#h:991dbbe2-97b4-4fcd-b4cf-1415b08aa3af">PersistentVolume</a></li>
<li><a href="#h:2d9774be-eadd-4cab-ac53-4cc6ad90bbd2">PersistentVolumeClaim</a></li>
<li><a href="#h:9e739909-b13e-4454-a490-c98301d5f5a5">StorageClass</a></li>
<li><a href="#h:5c0f4b35-8af9-4e4c-86c2-a255706cfc71">Multiple Resources</a></li>
</ul>
</li>
<li><a href="#h:b596d0b6-bf2c-4c4c-9df2-f7ef3350d4ea">Adding Resources 添加资源</a>
<ul>
<li><a href="#h:6e5e38c9-741a-4754-afc5-41748884f1c8">Creating a Pod</a></li>
<li><a href="#h:9a20fe8f-b7b4-4550-892d-3b64537344c1">Creating a Service</a></li>
<li><a href="#h:4da85756-3d25-4181-8612-679e183a7a6a">Creating a Deployment</a></li>
<li><a href="#h:2e270b19-20c5-4180-a12c-47a752a25e29">Interactive Pod</a></li>
<li><a href="#h:84f2fd04-ff42-4e3e-b3b9-d5a661645fcd">Output YAML to a File</a></li>
<li><a href="#h:6efc66b5-7a1e-4064-8250-1f269263b2a5">Getting Help</a></li>
</ul>
</li>
<li><a href="#h:799b2b48-7aa7-4cff-a054-a6fb30187a69">Changing Resource Attributes 改变资源属性</a>
<ul>
<li><a href="#h:834bf28d-f422-4fc2-9db5-a5c8a4f539fd">Taint</a></li>
<li><a href="#h:b856106c-0e6e-4a0e-ad36-4233a72402d8">Labels</a></li>
<li><a href="#h:37d7b04c-d63c-4914-bca5-902c042a9a65">Cordon/Uncordon</a></li>
<li><a href="#h:94ef19e3-3bb5-4e6e-9c20-b849c7072cb4">Drain</a></li>
<li><a href="#h:fddb3421-da3e-4d7f-b3cb-b18473e04025">Nodes/Pods</a></li>
<li><a href="#h:1a1a1127-fece-4639-9b55-f520f3dd6e29">Deployments/Namespaces</a></li>
<li><a href="#h:5855b447-2d1c-4753-a7e9-a4237992f63a">Services</a></li>
<li><a href="#h:58f60629-e99c-4230-b275-efb7774286a1">DaemonSets</a></li>
<li><a href="#h:57da0910-eb53-49a3-938f-5ad3e93feb1e">Service Accounts</a></li>
<li><a href="#h:2a18028f-8aaf-47d4-ac8b-15f0e3bea3c1">Annotate</a></li>
<li><a href="#h:34ef25c8-5cbf-4521-aefa-a568fcd91399">hpa</a></li>
</ul>
</li>
<li><a href="#h:8a00d652-f174-4bdb-aea7-4ae706604dd0">扩展资源</a></li>
<li><a href="#h:2b31aa5b-3f60-4eb2-b527-14727f9abbc5">删除资源</a></li>
<li><a href="#h:42e52388-4e88-4a5f-9ee1-af87db0c9689">与正在运行的pod交互</a></li>
<li><a href="#h:8fbcc7dc-5e87-4063-b1f1-78a266a949c9">与节点集群交互</a></li>
<li><a href="#h:2cd25d58-bdda-4fe2-ab2c-23284c19b245">资源类型</a></li>
<li><a href="#h:00c9645f-c029-4d0a-9443-722459354b67">Requests //请求</a>
<ul>
<li><a href="#h:eac11a0d-a96a-40e2-b83e-f206d07e409b">API Call</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:85a80de8-3b47-409c-87dd-123759ccbeed">别名</a></li>
<li><a href="#h:f55bdc02-dc9a-4bc0-9c92-f48a30f88e12">集群升级</a></li>
<li><a href="#h:ae6ff05b-918c-4950-ac51-177d54c867c4">参考文档</a></li>
</ul>
</li>
</ul>
</div>
</nav>
<ul class="org-ul">
<li>TAGS: <a href="./index.html">Kubernetes</a></li>
</ul>


<p>
摘要：本文介绍k8s核心组件-kubectl
</p>
<section id="outline-container-h:9acbbac1-a4f6-4659-b3ea-cc586a5f63c3" class="outline-2">
<h2 id="h:9acbbac1-a4f6-4659-b3ea-cc586a5f63c3">核心组件-kubectl</h2>
<div class="outline-text-2" id="text-h:9acbbac1-a4f6-4659-b3ea-cc586a5f63c3">
</div>
<div id="outline-container-h:6d6b3a69-7ddb-4756-b8fd-03133bff0331" class="outline-3">
<h3 id="h:6d6b3a69-7ddb-4756-b8fd-03133bff0331">简述</h3>
<div class="outline-text-3" id="text-h:6d6b3a69-7ddb-4756-b8fd-03133bff0331">
<p>
你可以使用 Kubectl 命令行工具管理 Kubernetes 集群。 <code>kubectl</code> 在
<code>$HOME/.kube</code> 目录中查找一个名为 <code>config</code> 的配置文件。 你可以通过设置
KUBECONFIG 环境变量或设置
<a href="https://kubernetes.io/zh/docs/concepts/configuration/organize-cluster-access-kubeconfig/"><code>--kubeconfig</code></a>
参数来指定其它
<a href="https://kubernetes.io/zh/docs/concepts/configuration/organize-cluster-access-kubeconfig/">kubeconfig</a>
文件。
</p>

<p>
本文概述了 <code>kubectl</code> 语法和命令操作描述，并提供了常见的示例。
有关每个命令的详细信息，包括所有受支持的参数和子命令， 请参阅
<a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands/">kubectl</a>
参考文档。
有关安装说明，请参见<a href="https://kubernetes.io/zh/docs/tasks/tools/install-kubectl/">安装
kubectl</a> 。
</p>

<p>
kubectl 提供了大量的子命令，方便管理 Kubernetes
集群中的各种功能。这里不再罗列各种子命令的格式，而是介绍下如何查询命令的帮助
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl -h &#26597;&#30475;&#23376;&#21629;&#20196;&#21015;&#34920;
kubectl options &#26597;&#30475;&#20840;&#23616;&#36873;&#39033;
kubectl &lt;command&gt; --help &#26597;&#30475;&#23376;&#21629;&#20196;&#30340;&#24110;&#21161;
kubectl [command] [PARAMS] -o=&lt;format&gt; &#35774;&#32622;&#36755;&#20986;&#26684;&#24335;&#65288;&#22914; json&#12289;yaml&#12289;jsonpath &#31561;&#65289;
kubectl explain &lt;type&gt;.&lt;fieldName&gt;[.&lt;fieldName&gt;] &#26597;&#30475;&#36164;&#28304;&#30340;&#23450;&#20041;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:d1f497ed-c277-4f4e-b59b-a81dd52b995a" class="outline-3">
<h3 id="h:d1f497ed-c277-4f4e-b59b-a81dd52b995a">常用命令</h3>
<div class="outline-text-3" id="text-h:d1f497ed-c277-4f4e-b59b-a81dd52b995a">
<p>
参考：<a href="https://kubernetes.io/docs/reference/kubectl/">https://kubernetes.io/docs/reference/kubectl/</a>
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">命令集</th>
<th scope="col" class="org-left">命令</th>
<th scope="col" class="org-left">用途</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">基础命令1</td>
<td class="org-left">explain(推荐)</td>
<td class="org-left">命令说明</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">增删改查：create/run/delete/edit/get</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">set</td>
<td class="org-left">设置对象状态</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">expose</td>
<td class="org-left">为deployment，pod创建Service</td>
</tr>

<tr>
<td class="org-left">Deploy命令</td>
<td class="org-left">rollout</td>
<td class="org-left">Deployment,Daemonset的升级过程管理(查看状态、操作历史、暂停升级、恢复升级、回滚等)</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">rolling-update</td>
<td class="org-left">客户端滚动升级，仅跟RelicationController</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">scale</td>
<td class="org-left">修改Deployment, ReplicaSet, RelicationController, Job的实例数</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">autoscale</td>
<td class="org-left">为Deploy, RS, RC配置自动伸缩规则（依赖HPA）</td>
</tr>

<tr>
<td class="org-left">集群管理命令</td>
<td class="org-left">集群状态：cluster-info/top</td>
<td class="org-left">集群信息/资源占用率</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">node节点管理： cordon</td>
<td class="org-left">警戒线，标记node不被调度</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">node节点管理：uncordon</td>
<td class="org-left">取消警戒标记为cordon的node</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">node节点管理：drain</td>
<td class="org-left">驱逐node上的pod,用户node下线等场景</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">node节点管理：taint</td>
<td class="org-left">给node标记污点，实现反亲pod与node反亲和性</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">certificate</td>
<td class="org-left">证书管理</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">api-resources/api-versions</td>
<td class="org-left">api资源</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">config</td>
<td class="org-left">客户端kube-config配置</td>
</tr>

<tr>
<td class="org-left">问题排查</td>
<td class="org-left">describe</td>
<td class="org-left">查看资源详情</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">logs</td>
<td class="org-left">查看pod内容的日志</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">attach</td>
<td class="org-left">Attach到pod内的一个容器</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">exec</td>
<td class="org-left">在指定容器内执行命令</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">port-forward</td>
<td class="org-left">为pod创建本地端口映射</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">proxy</td>
<td class="org-left">为k8s API server创建代理</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">cp</td>
<td class="org-left">容器内外/容器间文件拷贝</td>
</tr>

<tr>
<td class="org-left">高级命令</td>
<td class="org-left">apply(推荐)</td>
<td class="org-left">从文件或stdin创建/更新资源。支持文件修改和动态生效，支持回滚，可替代create</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">patch</td>
<td class="org-left">使用strategic merge patch语法更新对象的某些字段</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">replace</td>
<td class="org-left">从文件或stdin更新资源</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">convert</td>
<td class="org-left">在不同API版本之间转换对象定义</td>
</tr>

<tr>
<td class="org-left">配置命令</td>
<td class="org-left">标签管理：Label</td>
<td class="org-left">给node标记label，实现亲pod与node亲和性</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">annotate</td>
<td class="org-left">给资源设置annotation</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">completion(推荐)</td>
<td class="org-left">获取shell自动补全脚本（支持bash和zsh）</td>
</tr>

<tr>
<td class="org-left">其它命令</td>
<td class="org-left">help</td>
<td class="org-left">帮助</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">version</td>
<td class="org-left">查看客户端和Server端k8s版本</td>
</tr>
</tbody>
</table>

<p>
<b>实用技巧</b>
</p>

<p>
kubectl命令太多太长记不住？
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#36164;&#28304;&#32553;&#20889;</span>
kubectl api-resources
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#37197;&#32622;kubectl&#33258;&#21160;&#34917;&#20840;</span>
<span style="color: #483d8b;">source</span> &lt;(kubectl completion bash)
</pre>
</div>

<p>
kubectl 写yaml太累，找样例麻烦？
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#29992;run&#21629;&#20196;&#29983;&#20135;+</span>
kubectl run --image=nginx my-deploy -o yaml --dry-run &gt; my-deploy.yaml
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#29992;get&#21629;&#20196;&#23548;&#20986;</span>
kubectl get statefulset/foo -o=yaml --export &gt; new.yaml
<span style="color: #b22222;"># </span><span style="color: #b22222;">pod&#20146;&#21644;&#24615;&#19979;&#38754;&#23383;&#27573;&#30340;&#25340;&#20889;&#24536;&#35760;&#20102;</span>
kubectl explain pod.spec.affinity.podAffinity
</pre>
</div>
</div>
<div id="outline-container-h:4b222705-4ed7-4aa3-9b82-2865d66e15c1" class="outline-4">
<h4 id="h:4b222705-4ed7-4aa3-9b82-2865d66e15c1">Kubectl 自动补全</h4>
<div class="outline-text-4" id="text-h:4b222705-4ed7-4aa3-9b82-2865d66e15c1">
<p>
BASH
</p>

<pre class="example" id="org3f8a42e">
yum install -y bash-completion
source &lt;(kubectl completion bash) # 在 bash 中设置当前 shell 的自动补全，要先安装 bash-completion 包。
echo "source &lt;(kubectl completion bash)" &gt;&gt; ~/.bashrc # 在您的 bash shell 中永久的添加自动补全
</pre>

<p>
您还可以为 <code>kubectl</code> 使用一个速记别名，该别名也可以与 completion
一起使用：
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">k</span>=kubectl
<span style="color: #483d8b;">complete</span> -F __start_kubectl k
</pre>
</div>

<p>
ZSH
</p>

<pre class="example" id="org5ca79b2">
source &lt;(kubectl completion zsh)  # 在 zsh 中设置当前 shell 的自动补全
echo "[[ $commands[kubectl] ]] &amp;&amp; source &lt;(kubectl completion zsh)" &gt;&gt; ~/.zshrc # 在您的 zsh shell 中永久的添加自动补全
</pre>
</div>
</div>
<div id="outline-container-h:d16a9bcf-7dd6-4d6e-8e24-bca94b1a07db" class="outline-4">
<h4 id="h:d16a9bcf-7dd6-4d6e-8e24-bca94b1a07db">Kubectl 上下文和配置</h4>
<div class="outline-text-4" id="text-h:d16a9bcf-7dd6-4d6e-8e24-bca94b1a07db">
<p>
设置 <code>kubectl</code> 与哪个 Kubernetes 集群进行通信并修改配置信息。
查看<a href="https://kubernetes.io/zh/docs/tasks/access-application-cluster/configure-access-multiple-clusters/">使用
kubeconfig 跨集群授权访问</a> 文档获取配置文件详细信息。
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl config view <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#21512;&#24182;&#30340; kubeconfig &#37197;&#32622;&#12290;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21516;&#26102;&#20351;&#29992;&#22810;&#20010; kubeconfig &#25991;&#20214;&#24182;&#26597;&#30475;&#21512;&#24182;&#30340;&#37197;&#32622;</span>
<span style="color: #a0522d;">KUBECONFIG</span>=~/.kube/config:~/.kube/kubconfig2 kubectl config view

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462; e2e &#29992;&#25143;&#30340;&#23494;&#30721;</span>
kubectl config view -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.users[?(@.name == "e2e")].user.password}'</span>

kubectl config view -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.users[].name}'</span>    <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#31532;&#19968;&#20010;&#29992;&#25143;</span>
kubectl config view -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.users[*].name}'</span>   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#29992;&#25143;&#21015;&#34920;</span>
kubectl config get-contexts                          <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#19978;&#19979;&#25991;&#21015;&#34920;</span>
kubectl config current-context                       <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23637;&#31034;&#24403;&#21069;&#25152;&#22788;&#30340;&#19978;&#19979;&#25991;</span>
kubectl config use-context my-cluster-name           <span style="color: #b22222;"># </span><span style="color: #b22222;">&#35774;&#32622;&#40664;&#35748;&#30340;&#19978;&#19979;&#25991;&#20026; my-cluster-name</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#28155;&#21152;&#26032;&#30340;&#29992;&#25143;&#37197;&#32622;&#21040; kubeconf &#20013;&#65292;&#20351;&#29992; basic auth &#36827;&#34892;&#36523;&#20221;&#35748;&#35777;</span>
kubectl config set-credentials kubeuser/foo.kubernetes.com --username=kubeuser --password=kubepassword

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#25351;&#23450;&#19978;&#19979;&#25991;&#20013;&#25345;&#20037;&#24615;&#22320;&#20445;&#23384;&#21517;&#23383;&#31354;&#38388;&#65292;&#20379;&#25152;&#26377;&#21518;&#32493; kubectl &#21629;&#20196;&#20351;&#29992;</span>
kubectl config set-context --current --namespace=ggckad-s2
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcn</span>=<span style="color: #8b2252;">'kubectl config set-context $(</span><span style="color: #ff00ff;">kubectl config current-context</span><span style="color: #8b2252;">) --namespace'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;&#29305;&#23450;&#30340;&#29992;&#25143;&#21517;&#21644;&#21517;&#23383;&#31354;&#38388;&#35774;&#32622;&#19978;&#19979;&#25991;</span>
kubectl config set-context gce --user=cluster-admin --namespace=foo <span style="color: #8b2252;">\</span>
  &amp;&amp; kubectl config use-context gce


kubectl config unset users.foo                       <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;&#29992;&#25143; foo</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:003e354b-b904-4c87-8d2f-751111a8eb71" class="outline-4">
<h4 id="h:003e354b-b904-4c87-8d2f-751111a8eb71">Kubectl apply</h4>
<div class="outline-text-4" id="text-h:003e354b-b904-4c87-8d2f-751111a8eb71">
<p>
<code>apply</code> 通过定义 Kubernetes 资源的文件来管理应用。 它通过运行
<code>kubectl apply</code> 在集群中创建和更新资源。 这是在生产中管理 Kubernetes
应用的推荐方法。 参见 <a href="https://kubectl.docs.kubernetes.io/">Kubectl
文档</a>。
</p>
</div>
</div>
<div id="outline-container-h:33141834-8c88-413b-8eb6-94ca70aed8a2" class="outline-4">
<h4 id="h:33141834-8c88-413b-8eb6-94ca70aed8a2">创建对象</h4>
<div class="outline-text-4" id="text-h:33141834-8c88-413b-8eb6-94ca70aed8a2">
<p>
Kubernetes 配置可以用 YAML 或 JSON 定义。可以使用的文件扩展名有
<code>.yaml=、</code>.yml= 和 =.json=。
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl apply -f ./my-manifest.yaml           <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21019;&#24314;&#36164;&#28304;</span>
kubectl apply -f ./my1.yaml -f ./my2.yaml     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;&#22810;&#20010;&#25991;&#20214;&#21019;&#24314;</span>
kubectl apply -f ./dir                        <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22522;&#20110;&#30446;&#24405;&#19979;&#30340;&#25152;&#26377;&#28165;&#21333;&#25991;&#20214;&#21019;&#24314;&#36164;&#28304;</span>
kubectl apply -f https://git.io/vPieo         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20174; URL &#20013;&#21019;&#24314;&#36164;&#28304;</span>
kubectl create deployment nginx --image=nginx <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21551;&#21160;&#21333;&#23454;&#20363; nginx</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21019;&#24314;&#19968;&#20010;&#25171;&#21360; &#8220;Hello World&#8221; &#30340; Job</span>
kubectl create job hello --image=busybox -- echo <span style="color: #8b2252;">"Hello World"</span> 

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21019;&#24314;&#19968;&#20010;&#25171;&#21360; &#8220;Hello World&#8221; &#38388;&#38548;1&#20998;&#38047;&#30340; CronJob</span>
kubectl create cronjob hello --image=busybox   --schedule=<span style="color: #8b2252;">"*/1 * * * *"</span> -- echo <span style="color: #8b2252;">"Hello World"</span>    

kubectl explain pods                          <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462; pod &#28165;&#21333;&#30340;&#25991;&#26723;&#35828;&#26126;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20174;&#26631;&#20934;&#36755;&#20837;&#21019;&#24314;&#22810;&#20010; YAML &#23545;&#35937;</span>
cat &lt;&lt;EOF | kubectl apply -f -
<span style="color: #ffa54f;">apiVersion: v1</span>
<span style="color: #ffa54f;">kind: Pod</span>
<span style="color: #ffa54f;">metadata:</span>
<span style="color: #ffa54f;">  name: busybox-sleep</span>
<span style="color: #ffa54f;">spec:</span>
<span style="color: #ffa54f;">  containers:</span>
<span style="color: #ffa54f;">  - name: busybox</span>
<span style="color: #ffa54f;">    image: busybox</span>
<span style="color: #ffa54f;">    args:</span>
<span style="color: #ffa54f;">    - sleep</span>
<span style="color: #ffa54f;">    - "1000000"</span>
<span style="color: #ffa54f;">---</span>
<span style="color: #ffa54f;">apiVersion: v1</span>
<span style="color: #ffa54f;">kind: Pod</span>
<span style="color: #ffa54f;">metadata:</span>
<span style="color: #ffa54f;">  name: busybox-sleep-less</span>
<span style="color: #ffa54f;">spec:</span>
<span style="color: #ffa54f;">  containers:</span>
<span style="color: #ffa54f;">  - name: busybox</span>
<span style="color: #ffa54f;">    image: busybox</span>
<span style="color: #ffa54f;">    args:</span>
<span style="color: #ffa54f;">    - sleep</span>
<span style="color: #ffa54f;">    - "1000"</span>
<span style="color: #ffa54f;">EOF</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21019;&#24314;&#26377;&#22810;&#20010; key &#30340; Secret</span>
cat &lt;&lt;EOF | kubectl apply -f -
<span style="color: #ffa54f;">apiVersion: v1</span>
<span style="color: #ffa54f;">kind: Secret</span>
<span style="color: #ffa54f;">metadata:</span>
<span style="color: #ffa54f;">  name: mysecret</span>
<span style="color: #ffa54f;">type: Opaque</span>
<span style="color: #ffa54f;">data:</span>
<span style="color: #ffa54f;">  password: $(</span><span style="color: #ff00ff;">echo -n "s33msi4" | base64 -w0</span><span style="color: #ffa54f;">)</span>
<span style="color: #ffa54f;">  username: $(</span><span style="color: #ff00ff;">echo -n "jane" | base64 -w0</span><span style="color: #ffa54f;">)</span>
<span style="color: #ffa54f;">EOF</span>
</pre>
</div>

<p>
其它
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#29992;&#24050;&#29983;&#25104;&#30340;&#36164;&#28304;</span>
kubectl get deploy nginx -oyaml &gt; test.yaml

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#19981;&#30495;&#30340;&#21019;&#24314;&#30340; pod </span>
kubectl run --image=nginx my-deploy -o yaml --dry-run &gt; my-deploy.yaml

kubectl create -f rs.yml  --save-config=true <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20445;&#23384;&#37197;&#32622;&#65292;&#19979;&#27425;&#20877;&#21019;&#24314;RS&#29992;apply&#23601;&#21487;&#20197; </span>
kubectl create -f rs.yml --record            <span style="color: #b22222;"># </span><span style="color: #b22222;">--record &#21487;&#20197;&#23454;&#29616;&#29256;&#26412;&#31649;&#29702;&#65292;&#19979;&#27425;&#20877;&#21019;&#24314;RS&#29992;apply&#23601;&#21487;&#20197; </span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:53c692cd-432a-44d0-952f-b26c43068d3d" class="outline-4">
<h4 id="h:53c692cd-432a-44d0-952f-b26c43068d3d">查看和查找资源</h4>
<div class="outline-text-4" id="text-h:53c692cd-432a-44d0-952f-b26c43068d3d">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">get &#21629;&#20196;&#30340;&#22522;&#26412;&#36755;&#20986;</span>
kubectl get services                          <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#24403;&#21069;&#21629;&#21517;&#31354;&#38388;&#19979;&#30340;&#25152;&#26377; services</span>
kubectl get pods --all-namespaces             <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#25152;&#26377;&#21629;&#21517;&#31354;&#38388;&#19979;&#30340;&#20840;&#37096;&#30340; Pods</span>
kubectl get pods -o wide                      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#24403;&#21069;&#21629;&#21517;&#31354;&#38388;&#19979;&#30340;&#20840;&#37096; Pods&#65292;&#24182;&#26174;&#31034;&#26356;&#35814;&#32454;&#30340;&#20449;&#24687;</span>
kubectl get deployment my-dep                 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#26576;&#20010;&#29305;&#23450;&#30340; Deployment</span>
kubectl get pods                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#24403;&#21069;&#21629;&#21517;&#31354;&#38388;&#19979;&#30340;&#20840;&#37096; Pods</span>
kubectl get pod my-pod -o yaml                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#19968;&#20010; pod &#30340; YAML</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">describe &#21629;&#20196;&#30340;&#35814;&#32454;&#36755;&#20986;</span>
kubectl describe nodes my-node
kubectl describe pods my-pod

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#24403;&#21069;&#21517;&#23383;&#31354;&#38388;&#19979;&#25152;&#26377; Services&#65292;&#25353;&#21517;&#31216;&#25490;&#24207;</span>
kubectl get services --sort-by=.metadata.name

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986; Pods&#65292;&#25353;&#37325;&#21551;&#27425;&#25968;&#25490;&#24207;</span>
kubectl get pods --sort-by=<span style="color: #8b2252;">'.status.containerStatuses[0].restartCount'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20030;&#25152;&#26377; PV &#25345;&#20037;&#21367;&#65292;&#25353;&#23481;&#37327;&#25490;&#24207;</span>
kubectl get pv --sort-by=.spec.capacity.storage

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#21253;&#21547; app=cassandra &#26631;&#31614;&#30340;&#25152;&#26377; Pods &#30340; version &#26631;&#31614;</span>
kubectl get pods --selector=<span style="color: #a0522d;">app</span>=cassandra -o <span style="color: #8b2252;">\</span>
  <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.items[*].metadata.labels.version}'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26816;&#32034;&#24102;&#26377; &#8220;.&#8221; &#38190;&#20540;&#65292;&#20363;&#65306; 'ca.crt'</span>
kubectl get configmap myconfig <span style="color: #8b2252;">\</span>
  -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.data.ca\.crt}'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#25152;&#26377;&#24037;&#20316;&#33410;&#28857;&#65288;&#20351;&#29992;&#36873;&#25321;&#22120;&#20197;&#25490;&#38500;&#26631;&#31614;&#21517;&#31216;&#20026; 'node-role.kubernetes.io/master' &#30340;&#32467;&#26524;&#65289;</span>
kubectl get node --selector=<span style="color: #8b2252;">'!node-role.kubernetes.io/master'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#24403;&#21069;&#21629;&#21517;&#31354;&#38388;&#20013;&#27491;&#22312;&#36816;&#34892;&#30340; Pods</span>
kubectl get pods --field-selector=status.phase=Running

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#20840;&#37096;&#33410;&#28857;&#30340; ExternalIP &#22320;&#22336;</span>
kubectl get nodes -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.items[*].status.addresses[?(@.type=="ExternalIP")].address}'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#23646;&#20110;&#26576;&#20010;&#29305;&#23450; RC &#30340; Pods &#30340;&#21517;&#31216;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#36716;&#25442;&#23545;&#20110; jsonpath &#36807;&#20110;&#22797;&#26434;&#30340;&#22330;&#21512;&#65292;"jq" &#21629;&#20196;&#24456;&#26377;&#29992;&#65307;&#21487;&#20197;&#22312; https://stedolan.github.io/jq/ &#25214;&#21040;&#23427;&#12290;</span>
<span style="color: #a0522d;">sel</span>=${<span style="color: #a0522d;">$</span>(<span style="color: #ff00ff;">kubectl get rc my-rc --output=json | jq -j '.spec.selector | to_entries | .[] | "\(.key</span><span style="color: #8b2252;">)=\(.value),"'</span>)%?}
<span style="color: #483d8b;">echo</span> $(<span style="color: #ff00ff;">kubectl get pods --selector=$sel --output=jsonpath={.items..metadata.name}</span>)

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#25152;&#26377; Pods &#30340;&#26631;&#31614;&#65288;&#25110;&#20219;&#20309;&#20854;&#20182;&#25903;&#25345;&#26631;&#31614;&#30340; Kubernetes &#23545;&#35937;&#65289;</span>
kubectl get pods --show-labels

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26816;&#26597;&#21738;&#20123;&#33410;&#28857;&#22788;&#20110;&#23601;&#32490;&#29366;&#24577;</span>
<span style="color: #a0522d;">JSONPATH</span>=<span style="color: #8b2252;">'{range .items[*]}{@.metadata.name}:{range @.status.conditions[*]}{@.type}={@.status};{end}{end}'</span> <span style="color: #8b2252;">\</span>
 &amp;&amp; kubectl get nodes -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">"$JSONPATH"</span> | grep <span style="color: #8b2252;">"Ready=True"</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#19981;&#20351;&#29992;&#22806;&#37096;&#24037;&#20855;&#26469;&#36755;&#20986;&#35299;&#30721;&#21518;&#30340; Secret</span>
kubectl get secret my-secret -o go-template=<span style="color: #8b2252;">'{{range $k,$v := .data}}{{"### "}}{{$k}}{{"\n"}}{{$v|base64decode}}{{"\n\n"}}{{end}}'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#34987;&#19968;&#20010; Pod &#20351;&#29992;&#30340;&#20840;&#37096; Secret</span>
kubectl get pods -o json | jq <span style="color: #8b2252;">'.items[].spec.containers[].env[]?.valueFrom.secretKeyRef.name'</span> | grep -v null | sort | uniq

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20030;&#25152;&#26377; Pods &#20013;&#21021;&#22987;&#21270;&#23481;&#22120;&#30340;&#23481;&#22120; ID&#65288;containerID&#65289;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21487;&#29992;&#20110;&#22312;&#28165;&#29702;&#24050;&#20572;&#27490;&#30340;&#23481;&#22120;&#26102;&#36991;&#20813;&#21024;&#38500;&#21021;&#22987;&#21270;&#23481;&#22120;</span>
kubectl get pods --all-namespaces -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{range .items[*].status.initContainerStatuses[*]}{.containerID}{"\n"}{end}'</span> | cut -d/ -f3

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#20107;&#20214;&#65288;Events&#65289;&#65292;&#25353;&#26102;&#38388;&#25139;&#25490;&#24207;</span>
kubectl get events --sort-by=.metadata.creationTimestamp

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#27604;&#36739;&#24403;&#21069;&#30340;&#38598;&#32676;&#29366;&#24577;&#21644;&#20551;&#23450;&#26576;&#28165;&#21333;&#34987;&#24212;&#29992;&#20043;&#21518;&#30340;&#38598;&#32676;&#29366;&#24577;</span>
kubectl diff -f ./my-manifest.yaml

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#29983;&#25104;&#19968;&#20010;&#21477;&#28857;&#20998;&#38548;&#30340;&#26641;&#65292;&#20854;&#20013;&#21253;&#21547;&#20026;&#33410;&#28857;&#36820;&#22238;&#30340;&#25152;&#26377;&#38190;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#22797;&#26434;&#30340;&#23884;&#22871;JSON&#32467;&#26500;&#20013;&#23450;&#20301;&#38190;&#26102;&#38750;&#24120;&#26377;&#29992;</span>
kubectl get nodes -o json | jq -c <span style="color: #8b2252;">'path(..)|[.[]|tostring]|join(".")'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#29983;&#25104;&#19968;&#20010;&#21477;&#28857;&#20998;&#38548;&#30340;&#26641;&#65292;&#20854;&#20013;&#21253;&#21547;&#20026;pod&#31561;&#36820;&#22238;&#30340;&#25152;&#26377;&#38190;</span>
kubectl get pods -o json | jq -c <span style="color: #8b2252;">'path(..)|[.[]|tostring]|join(".")'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20551;&#35774;&#20320;&#30340; Pods &#26377;&#40664;&#35748;&#30340;&#23481;&#22120;&#21644;&#40664;&#35748;&#30340;&#21517;&#23383;&#31354;&#38388;&#65292;&#24182;&#19988;&#25903;&#25345; 'env' &#21629;&#20196;&#65292;&#21487;&#20197;&#20351;&#29992;&#20197;&#19979;&#33050;&#26412;&#20026;&#25152;&#26377; Pods &#29983;&#25104; ENV &#21464;&#37327;&#12290;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#35813;&#33050;&#26412;&#20063;&#21487;&#29992;&#20110;&#22312;&#25152;&#26377;&#30340; Pods &#37324;&#36816;&#34892;&#20219;&#20309;&#21463;&#25903;&#25345;&#30340;&#21629;&#20196;&#65292;&#32780;&#19981;&#20165;&#20165;&#26159; 'env'&#12290; </span>
<span style="color: #a020f0;">for</span> pod<span style="color: #a020f0;"> in</span> $(<span style="color: #ff00ff;">kubectl get po --output=jsonpath={.items..metadata.name}</span>); <span style="color: #a020f0;">do </span><span style="color: #483d8b;">echo</span> $<span style="color: #a0522d;">pod</span> &amp;&amp; kubectl exec -it $<span style="color: #a0522d;">pod</span> -- env; <span style="color: #a020f0;">done</span>
</pre>
</div>

<p>
其它
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl get &lt;resource&gt; -A <span style="color: #b22222;"># </span><span style="color: #b22222;">-A &#25152;&#26377;&#21517;&#31216;&#31354;&#38388;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#35810; Pod IP</span>
kubectl get pod &lt;pod-name&gt; -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.status.podIP}'</span>
</pre>
</div>

<p>
有些资源是没有命名空间的，可以使用以下命令查看
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl api-resources --namespaced=false     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25152;&#26377;&#38750;&#21629;&#21517;&#31354;&#38388;&#20316;&#29992;&#22495;&#30340;&#36164;&#28304;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:d9cf5e45-2883-4b84-b574-deea116f00af" class="outline-4">
<h4 id="h:d9cf5e45-2883-4b84-b574-deea116f00af">更新资源</h4>
<div class="outline-text-4" id="text-h:d9cf5e45-2883-4b84-b574-deea116f00af">
<div class="org-src-container">
<pre class="src src-sh">kubectl set image deployment/frontend <span style="color: #a0522d;">www</span>=image:v2               <span style="color: #b22222;"># </span><span style="color: #b22222;">&#28378;&#21160;&#26356;&#26032; "frontend" Deployment &#30340; "www" &#23481;&#22120;&#38236;&#20687;</span>
kubectl rollout history deployment/frontend                      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26816;&#26597; Deployment &#30340;&#21382;&#21490;&#35760;&#24405;&#65292;&#21253;&#25324;&#29256;&#26412;</span>
kubectl rollout undo deployment/frontend                         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22238;&#28378;&#21040;&#19978;&#27425;&#37096;&#32626;&#29256;&#26412;</span>
kubectl rollout undo deployment/frontend --to-revision=2         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22238;&#28378;&#21040;&#29305;&#23450;&#37096;&#32626;&#29256;&#26412;</span>
kubectl rollout status -w deployment/frontend                    <span style="color: #b22222;"># </span><span style="color: #b22222;">&#30417;&#35270; "frontend" Deployment &#30340;&#28378;&#21160;&#21319;&#32423;&#29366;&#24577;&#30452;&#21040;&#23436;&#25104;</span>
kubectl rollout restart deployment/frontend                      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36718;&#26367;&#37325;&#21551; "frontend" Deployment</span>

cat pod.json | kubectl replace -f -                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36890;&#36807;&#20256;&#20837;&#21040;&#26631;&#20934;&#36755;&#20837;&#30340; JSON &#26469;&#26367;&#25442; Pod</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#24378;&#21046;&#26367;&#25442;&#65292;&#21024;&#38500;&#21518;&#37325;&#24314;&#36164;&#28304;&#12290;&#20250;&#23548;&#33268;&#26381;&#21153;&#19981;&#21487;&#29992;&#12290;</span>
kubectl replace --force -f ./pod.json

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20026;&#22810;&#21103;&#26412;&#30340; nginx &#21019;&#24314;&#26381;&#21153;&#65292;&#20351;&#29992; 80 &#31471;&#21475;&#25552;&#20379;&#26381;&#21153;&#65292;&#36830;&#25509;&#21040;&#23481;&#22120;&#30340; 8000 &#31471;&#21475;&#12290;</span>
kubectl expose rc nginx --port=80 --target-port=8000

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;&#26576;&#21333;&#23481;&#22120; Pod &#30340;&#38236;&#20687;&#29256;&#26412;&#65288;&#26631;&#31614;&#65289;&#26356;&#26032;&#21040; v4</span>
kubectl get pod mypod -o yaml | sed <span style="color: #8b2252;">'s/\(image: myimage\):.*$/\1:v4/'</span> | kubectl replace -f -

kubectl label pods my-pod new-label=awesome                      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#28155;&#21152;&#26631;&#31614;</span>
kubectl annotate pods my-pod icon-url=http://goo.gl/XXBTWq       <span style="color: #b22222;"># </span><span style="color: #b22222;">&#28155;&#21152;&#27880;&#35299;</span>
kubectl autoscale deployment foo --min=2 --max=10                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23545; "foo" Deployment &#33258;&#21160;&#20280;&#32553;&#23481;</span>
</pre>
</div>

<p>
其它
</p>

<p>
kubernetes修改node的role标签
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#25191;&#34892;kubectl get node&#21629;&#20196;&#65292;&#21487;&#20197;&#30475;&#21040;&#22914;&#19979;&#32467;</span>
NAME    STATUS   ROLES         AGE   VERSION
node1   Ready    master,node   57d   v1.13.3
node2   Ready    master,node   57d   v1.13.3
node3   Ready    master,node   57d   v1.13.3
&#20877;&#25191;&#34892;&#65306;kubectl describe node node1
&#21435;&#25481;node&#26631;&#31614;
kubectl label node node1 node-role.kubernetes.io/node-
&#32473;node&#21152;&#26631;&#31614;&#65306;
kubectl label nodes  node1 node-role.kubernetes.io/node=
</pre>
</div>
</div>
</div>
<div id="outline-container-h:55b38d9b-62a7-4220-9993-dc002b343544" class="outline-4">
<h4 id="h:55b38d9b-62a7-4220-9993-dc002b343544">部分更新资源</h4>
<div class="outline-text-4" id="text-h:55b38d9b-62a7-4220-9993-dc002b343544">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#37096;&#20998;&#26356;&#26032;&#26576;&#33410;&#28857;</span>
kubectl patch node k8s-node-1 -p <span style="color: #8b2252;">'{"spec":{"unschedulable":true}}'</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26356;&#26032;&#23481;&#22120;&#30340;&#38236;&#20687;&#65307;spec.containers[*].name &#26159;&#24517;&#39035;&#30340;&#12290;&#22240;&#20026;&#23427;&#26159;&#19968;&#20010;&#21512;&#24182;&#24615;&#36136;&#30340;&#20027;&#38190;&#12290;</span>
kubectl patch pod valid-pod -p <span style="color: #8b2252;">'{"spec":{"containers":[{"name":"kubernetes-serve-hostname","image":"new image"}]}}'</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26356;&#26032; hpa</span>
kubectl -n taskcenter patch hpa task-center-job -p <span style="color: #8b2252;">'{"spec":{"maxReplicas":2,"minReplicas":1}}'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;&#24102;&#20301;&#32622;&#25968;&#32452;&#30340; JSON patch &#26356;&#26032;&#23481;&#22120;&#30340;&#38236;&#20687;</span>
kubectl patch pod valid-pod --type=<span style="color: #8b2252;">'json'</span> -p=<span style="color: #8b2252;">'[{"op": "replace", "path": "/spec/containers/0/image", "value":"new image"}]'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;&#24102;&#20301;&#32622;&#25968;&#32452;&#30340; JSON patch &#31105;&#29992;&#26576; Deployment &#30340; livenessProbe</span>
kubectl patch deployment valid-deployment  --type json   -p=<span style="color: #8b2252;">'[{"op": "remove", "path": "/spec/template/spec/containers/0/livenessProbe"}]'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#24102;&#20301;&#32622;&#25968;&#32452;&#20013;&#28155;&#21152;&#20803;&#32032;</span>
kubectl patch sa default --type=<span style="color: #8b2252;">'json'</span> -p=<span style="color: #8b2252;">'[{"op": "add", "path": "/secrets/1", "value": {"name": "whatever" } }]'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26356;&#26032; deployment &#32465;&#23450;&#33410;&#28857;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">https://kubernetes.io/zh-cn/docs/tasks/manage-kubernetes-objects/update-api-object-kubectl-patch/</span>
spec:
  template:
    spec:
      nodeSelector:
        <span style="color: #483d8b;">type</span>: rummy-staging-app-spot


kubectl patch deployment rummy-game --type merge --patch-file /tmp/r.yaml
</pre>
</div>
</div>
</div>
<div id="outline-container-h:70ee5f11-67c0-4c2d-a531-c489e3122c21" class="outline-4">
<h4 id="h:70ee5f11-67c0-4c2d-a531-c489e3122c21">编辑资源</h4>
<div class="outline-text-4" id="text-h:70ee5f11-67c0-4c2d-a531-c489e3122c21">
<p>
使用你偏爱的编辑器编辑 API 资源
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl edit svc/docker-registry                      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#32534;&#36753;&#21517;&#20026; docker-registry &#30340;&#26381;&#21153;</span>
<span style="color: #a0522d;">KUBE_EDITOR</span>=<span style="color: #8b2252;">"nano"</span> kubectl edit svc/docker-registry   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;&#20854;&#20182;&#32534;&#36753;&#22120;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:c75bd29b-db97-4b3a-8281-47c0decd5f8e" class="outline-4">
<h4 id="h:c75bd29b-db97-4b3a-8281-47c0decd5f8e">对资源进行伸缩</h4>
<div class="outline-text-4" id="text-h:c75bd29b-db97-4b3a-8281-47c0decd5f8e">
<div class="org-src-container">
<pre class="src src-sh">kubectl scale --replicas=3 rs/foo                                 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;&#21517;&#20026; 'foo' &#30340;&#21103;&#26412;&#38598;&#20280;&#32553;&#21040; 3 &#21103;&#26412;</span>
kubectl scale --replicas=3 -f foo.yaml                            <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;&#22312; "foo.yaml" &#20013;&#30340;&#29305;&#23450;&#36164;&#28304;&#20280;&#32553;&#21040; 3 &#20010;&#21103;&#26412;</span>
kubectl scale --current-replicas=2 --replicas=3 deployment/mysql  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22914;&#26524;&#21517;&#20026; mysql &#30340; Deployment &#30340;&#21103;&#26412;&#24403;&#21069;&#26159; 2&#65292;&#37027;&#20040;&#23558;&#23427;&#20280;&#32553;&#21040; 3</span>
kubectl scale --replicas=5 rc/foo rc/bar rc/baz                   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20280;&#32553;&#22810;&#20010;&#21103;&#26412;&#25511;&#21046;&#22120;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:3c8f9a85-92f4-461b-8ef1-8e852d5cbb5f" class="outline-4">
<h4 id="h:3c8f9a85-92f4-461b-8ef1-8e852d5cbb5f">删除资源</h4>
<div class="outline-text-4" id="text-h:3c8f9a85-92f4-461b-8ef1-8e852d5cbb5f">
<div class="org-src-container">
<pre class="src src-sh">kubectl delete -f ./pod.json                                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;&#22312; pod.json &#20013;&#25351;&#23450;&#30340;&#31867;&#22411;&#21644;&#21517;&#31216;&#30340; Pod</span>
kubectl delete pod,service baz foo                                        <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;&#21517;&#31216;&#20026; "baz" &#21644; "foo" &#30340; Pod &#21644;&#26381;&#21153;</span>
kubectl delete pods,services -l <span style="color: #a0522d;">name</span>=myLabel                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;&#21253;&#21547; name=myLabel &#26631;&#31614;&#30340; pods &#21644;&#26381;&#21153;</span>
kubectl -n my-ns delete pod,svc --all                                     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;&#22312; my-ns &#21517;&#23383;&#31354;&#38388;&#20013;&#20840;&#37096;&#30340; Pods &#21644;&#26381;&#21153;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;&#25152;&#26377;&#19982; pattern1 &#25110; pattern2 awk &#27169;&#24335;&#21305;&#37197;&#30340; Pods</span>
kubectl get pods  -n mynamespace --no-headers=true | awk <span style="color: #8b2252;">'/pattern1|pattern2/{print $1}'</span> | xargs  kubectl delete -n mynamespace pod
</pre>
</div>
</div>
</div>
<div id="outline-container-h:44b46dd3-84ab-4423-83ca-45ca12bd429c" class="outline-4">
<h4 id="h:44b46dd3-84ab-4423-83ca-45ca12bd429c">与运行中的 Pods 进行交互</h4>
<div class="outline-text-4" id="text-h:44b46dd3-84ab-4423-83ca-45ca12bd429c">
<div class="org-src-container">
<pre class="src src-sh">kubectl logs my-pod                                 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462; pod &#26085;&#24535;&#65288;&#26631;&#20934;&#36755;&#20986;&#65289;</span>
kubectl logs -l <span style="color: #a0522d;">name</span>=myLabel                        <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#21547; name=myLabel &#26631;&#31614;&#30340; Pods &#30340;&#26085;&#24535;&#65288;&#26631;&#20934;&#36755;&#20986;&#65289;</span>
kubectl logs my-pod --previous                      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#19978;&#20010;&#23481;&#22120;&#23454;&#20363;&#30340; pod &#26085;&#24535;&#65288;&#26631;&#20934;&#36755;&#20986;&#65289;</span>
kubectl logs my-pod -c my-container                 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462; Pod &#23481;&#22120;&#30340;&#26085;&#24535;&#65288;&#26631;&#20934;&#36755;&#20986;, &#22810;&#23481;&#22120;&#22330;&#26223;&#65289;</span>
kubectl logs -l <span style="color: #a0522d;">name</span>=myLabel -c my-container        <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#21547; name=myLabel &#26631;&#31614;&#30340; Pod &#23481;&#22120;&#26085;&#24535;&#65288;&#26631;&#20934;&#36755;&#20986;, &#22810;&#23481;&#22120;&#22330;&#26223;&#65289;</span>
kubectl logs my-pod -c my-container --previous      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462; Pod &#20013;&#26576;&#23481;&#22120;&#30340;&#19978;&#20010;&#23454;&#20363;&#30340;&#26085;&#24535;&#65288;&#26631;&#20934;&#36755;&#20986;, &#22810;&#23481;&#22120;&#22330;&#26223;&#65289;</span>
kubectl logs -f my-pod                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#27969;&#24335;&#36755;&#20986; Pod &#30340;&#26085;&#24535;&#65288;&#26631;&#20934;&#36755;&#20986;&#65289;</span>
kubectl logs -f my-pod -c my-container              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#27969;&#24335;&#36755;&#20986; Pod &#23481;&#22120;&#30340;&#26085;&#24535;&#65288;&#26631;&#20934;&#36755;&#20986;, &#22810;&#23481;&#22120;&#22330;&#26223;&#65289;</span>
kubectl logs -f -l <span style="color: #a0522d;">name</span>=myLabel --all-containers    <span style="color: #b22222;"># </span><span style="color: #b22222;">&#27969;&#24335;&#36755;&#20986;&#21547; name=myLabel &#26631;&#31614;&#30340; Pod &#30340;&#25152;&#26377;&#26085;&#24535;&#65288;&#26631;&#20934;&#36755;&#20986;&#65289;</span>
kubectl run -i --tty busybox --image=busybox -- sh  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20197;&#20132;&#20114;&#24335; Shell &#36816;&#34892; Pod</span>
kubectl run nginx --image=nginx -n mynamespace      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#25351;&#23450;&#21517;&#23383;&#31354;&#38388;&#20013;&#36816;&#34892; nginx Pod</span>
kubectl run nginx --image=nginx                     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36816;&#34892; ngins Pod &#24182;&#23558;&#20854;&#35268;&#32422;&#20889;&#20837;&#21040;&#21517;&#20026; pod.yaml &#30340;&#25991;&#20214;</span>
  --dry-run=client -o yaml &gt; pod.yaml

kubectl attach my-pod -i                            <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25346;&#25509;&#21040;&#19968;&#20010;&#36816;&#34892;&#30340;&#23481;&#22120;&#20013;</span>
kubectl port-forward my-pod 5000:6000               <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#26412;&#22320;&#35745;&#31639;&#26426;&#19978;&#20390;&#21548;&#31471;&#21475; 5000 &#24182;&#36716;&#21457;&#21040; my-pod &#19978;&#30340;&#31471;&#21475; 6000</span>
kubectl exec my-pod -- ls /                         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#24050;&#26377;&#30340; Pod &#20013;&#36816;&#34892;&#21629;&#20196;&#65288;&#21333;&#23481;&#22120;&#22330;&#26223;&#65289;</span>
kubectl exec --stdin --tty my-pod -- /bin/sh        <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;&#20132;&#20114; shell &#35775;&#38382;&#27491;&#22312;&#36816;&#34892;&#30340; Pod (&#19968;&#20010;&#23481;&#22120;&#22330;&#26223;)</span>
kubectl exec my-pod -c my-container -- ls /         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#24050;&#26377;&#30340; Pod &#20013;&#36816;&#34892;&#21629;&#20196;&#65288;&#22810;&#23481;&#22120;&#22330;&#26223;&#65289;</span>
kubectl top pod POD_NAME --containers               <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#32473;&#23450; Pod &#21644;&#20854;&#20013;&#23481;&#22120;&#30340;&#30417;&#25511;&#25968;&#25454;</span>
kubectl top pod POD_NAME --sort-by=cpu              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#32473;&#23450; Pod &#30340;&#25351;&#26631;&#24182;&#19988;&#25353;&#29031; 'cpu' &#25110;&#32773; 'memory' &#25490;&#24207;</span>
</pre>
</div>
</div>
<div id="outline-container-h:e98c97ec-2a15-47e8-b5e8-13f8c6a53fe7" class="outline-5">
<h5 id="h:e98c97ec-2a15-47e8-b5e8-13f8c6a53fe7">logs</h5>
<div class="outline-text-5" id="text-h:e98c97ec-2a15-47e8-b5e8-13f8c6a53fe7">
<pre class="example" id="orgc8b3d6b">
kubectl logs [pod_name]
kubectl logs --since=1h [pod_name]
kubectl logs --tail =20 [pod_name]
kubectl logs -f -c [container_name] [pod_name]  # 跟踪查看容器的日志，相当于tail -f命令的结果
kubectl logs [pod_name] &gt; pod.log
</pre>
</div>
</div>
</div>
<div id="outline-container-h:70d9e9fa-2aa0-451d-a672-688045db17b0" class="outline-4">
<h4 id="h:70d9e9fa-2aa0-451d-a672-688045db17b0">与 Deployments 和 Services 进行交互</h4>
<div class="outline-text-4" id="text-h:70d9e9fa-2aa0-451d-a672-688045db17b0">
<div class="org-src-container">
<pre class="src src-sh">kubectl logs deploy/my-deployment                         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#19968;&#20010; Deployment &#30340; Pod &#30340;&#26085;&#24535;&#65288;&#21333;&#23481;&#22120;&#20363;&#23376;&#65289;</span>
kubectl logs deploy/my-deployment -c my-container         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#19968;&#20010; Deployment &#30340; Pod &#30340;&#26085;&#24535;&#65288;&#22810;&#23481;&#22120;&#20363;&#23376;&#65289;</span>

kubectl port-forward svc/my-service 5000                  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20390;&#21548;&#26412;&#22320;&#31471;&#21475; 5000 &#24182;&#36716;&#21457;&#21040; Service &#21518;&#31471;&#31471;&#21475; 5000</span>
kubectl port-forward svc/my-service 5000:my-service-port  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20390;&#21548;&#26412;&#22320;&#31471;&#21475; 5000 &#24182;&#36716;&#21457;&#21040;&#21517;&#23383;&#20026; &lt;my-service-port&gt; &#30340; Service &#30446;&#26631;&#31471;&#21475;</span>

kubectl port-forward deploy/my-deployment 5000:6000       <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20390;&#21548;&#26412;&#22320;&#31471;&#21475; 5000 &#24182;&#36716;&#21457;&#21040; &lt;my-deployment&gt; &#21019;&#24314;&#30340; Pod &#37324;&#30340;&#31471;&#21475; 6000</span>
kubectl exec deploy/my-deployment -- ls                   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312; Deployment &#37324;&#30340;&#31532;&#19968;&#20010; Pod &#30340;&#31532;&#19968;&#20010;&#23481;&#22120;&#37324;&#36816;&#34892;&#21629;&#20196;&#65288;&#21333;&#23481;&#22120;&#21644;&#22810;&#23481;&#22120;&#20363;&#23376;&#65289;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:ec537685-5de8-4289-ad9a-5e612d6261b7" class="outline-4">
<h4 id="h:ec537685-5de8-4289-ad9a-5e612d6261b7">与节点和集群进行交互</h4>
<div class="outline-text-4" id="text-h:ec537685-5de8-4289-ad9a-5e612d6261b7">
<div class="org-src-container">
<pre class="src src-sh">kubectl cordon my-node                                                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26631;&#35760; my-node &#33410;&#28857;&#20026;&#19981;&#21487;&#35843;&#24230;</span>
kubectl drain my-node                                                 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23545; my-node &#33410;&#28857;&#36827;&#34892;&#28165;&#31354;&#25805;&#20316;&#65292;&#20026;&#33410;&#28857;&#32500;&#25252;&#20570;&#20934;&#22791;</span>
kubectl uncordon my-node                                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26631;&#35760; my-node &#33410;&#28857;&#20026;&#21487;&#20197;&#35843;&#24230;</span>
kubectl top node my-node                                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#32473;&#23450;&#33410;&#28857;&#30340;&#24230;&#37327;&#20540;</span>
kubectl cluster-info                                                  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#20027;&#25511;&#33410;&#28857;&#21644;&#26381;&#21153;&#30340;&#22320;&#22336;</span>
kubectl cluster-info dump                                             <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;&#24403;&#21069;&#38598;&#32676;&#29366;&#24577;&#36716;&#20648;&#21040;&#26631;&#20934;&#36755;&#20986;</span>
kubectl cluster-info dump --output-directory=/path/to/cluster-state   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;&#24403;&#21069;&#38598;&#32676;&#29366;&#24577;&#36755;&#20986;&#21040; /path/to/cluster-state</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22914;&#26524;&#24050;&#23384;&#22312;&#20855;&#26377;&#25351;&#23450;&#38190;&#21644;&#25928;&#26524;&#30340;&#27745;&#28857;&#65292;&#21017;&#26367;&#25442;&#20854;&#20540;&#20026;&#25351;&#23450;&#20540;&#12290;</span>
kubectl taint nodes foo <span style="color: #a0522d;">dedicated</span>=special-user:NoSchedule
</pre>
</div>

<p>
其它
</p>

<p>
范例：kubernetes修改node不可调度与删除
</p>

<p>
在master 执行
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">1, &#19981;&#21487;&#35843;&#24230;</span>
kubectl cordon k8s-node-1
kubectl uncordon k8s-node-1       <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21462;&#28040;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">2,&#39537;&#36880;&#24050;&#32463;&#36816;&#34892;&#30340;&#19994;&#21153;&#23481;&#22120;</span>
kubectl drain --ignore-daemonsets --delete-local-data k8s-node-1
<span style="color: #b22222;">#</span><span style="color: #b22222;">3&#65292;&#22914;&#26524;&#24819;&#21024;&#38500;node &#33410;&#28857;&#65292;&#21017;&#36827;&#34892;&#36825;&#20010;&#27493;&#39588;</span>
kubectl delete node k8s-node-1
</pre>
</div>
</div>
</div>
<div id="outline-container-h:b7f48b6a-384f-4168-8c61-5c3873120f4b" class="outline-4">
<h4 id="h:b7f48b6a-384f-4168-8c61-5c3873120f4b">资源类型</h4>
<div class="outline-text-4" id="text-h:b7f48b6a-384f-4168-8c61-5c3873120f4b">
<p>
列出所支持的全部资源类型和它们的简称、<a href="https://kubernetes.io/zh/docs/concepts/overview/kubernetes-api/#api-groups-and-versioning">API
组</a>,
是否是<a href="https://kubernetes.io/zh/docs/concepts/overview/working-with-objects/namespaces">名字空间作用域</a>
和
<a href="https://kubernetes.io/zh/docs/concepts/overview/working-with-objects/kubernetes-objects">Kind</a>。
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl api-resources
</pre>
</div>

<p>
用于探索 API 资源的其他操作
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl api-resources --namespaced=true      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25152;&#26377;&#21629;&#21517;&#31354;&#38388;&#20316;&#29992;&#22495;&#30340;&#36164;&#28304;</span>
kubectl api-resources --namespaced=false     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25152;&#26377;&#38750;&#21629;&#21517;&#31354;&#38388;&#20316;&#29992;&#22495;&#30340;&#36164;&#28304;</span>
kubectl api-resources -o name                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#29992;&#31616;&#21333;&#26684;&#24335;&#21015;&#20030;&#25152;&#26377;&#36164;&#28304;&#65288;&#20165;&#26174;&#31034;&#36164;&#28304;&#21517;&#31216;&#65289;</span>
kubectl api-resources -o wide                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#29992;&#25193;&#23637;&#26684;&#24335;&#21015;&#20030;&#25152;&#26377;&#36164;&#28304;&#65288;&#21448;&#31216; "wide" &#26684;&#24335;&#65289;</span>
kubectl api-resources --verbs=list,get       <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25903;&#25345; "list" &#21644; "get" &#35831;&#27714;&#21160;&#35789;&#30340;&#25152;&#26377;&#36164;&#28304;</span>
kubectl api-resources --api-group=extensions <span style="color: #b22222;"># </span><span style="color: #b22222;">"extensions" API &#32452;&#20013;&#30340;&#25152;&#26377;&#36164;&#28304;</span>
</pre>
</div>

<p>
api-versions
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">kubectl api-versions</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:20ff773d-4155-4425-8cdb-475b8e1bc31c" class="outline-4">
<h4 id="h:20ff773d-4155-4425-8cdb-475b8e1bc31c">格式化输出</h4>
<div class="outline-text-4" id="text-h:20ff773d-4155-4425-8cdb-475b8e1bc31c">
<p>
要以特定格式将详细信息输出到终端窗口，将 <code>-o=（或者
=--output=）参数添加到支持的 =kubectl</code> 命令中
</p>

<div class="org-src-container">
<pre class="src src-sh">-o=custom-columns=&lt;spec&gt;  &#20351;&#29992;&#36887;&#21495;&#20998;&#38548;&#30340;&#33258;&#23450;&#20041;&#21015;&#21015;&#34920;&#25171;&#21360;&#34920;
-o=custom-columns-file=&lt;filename&gt; &#20351;&#29992;&lt;filename&gt;&#25991;&#20214;&#20013;&#30340;&#33258;&#23450;&#20041;&#21015;&#27169;&#26495;&#25171;&#21360;&#34920;
-o=json &#36755;&#20986;JSON&#26684;&#24335;&#30340;API&#23545;&#35937;
-o=<span style="color: #a0522d;">jsonpath</span>=&lt;template&gt;  &#25171;&#21360;jsonpath&#34920;&#36798;&#24335;&#20013;&#23450;&#20041;&#30340;&#23383;&#27573;
-o=jsonpath-file=&lt;filename&gt; &#25171;&#21360;&#25991;&#20214;&#20013;jsonpath&#34920;&#36798;&#24335;&#23450;&#20041;&#30340;&#23383;&#27573;&lt;filename&gt;
-o=name &#20165;&#25171;&#21360;&#36164;&#28304;&#21517;&#31216;&#32780;&#19981;&#25171;&#21360;&#20219;&#20309;&#20854;&#20182;&#20869;&#23481;
-o=wide &#20351;&#29992;&#20219;&#20309;&#20854;&#20182;&#20449;&#24687;&#20197;&#32431;&#25991;&#26412;&#26684;&#24335;&#36755;&#20986;&#65292;&#23545;&#20110;pod&#65292;&#21253;&#25324;&#33410;&#28857;&#21517;&#31216;
-o=yaml &#36755;&#20986;YAML&#26684;&#24335;&#30340;API&#23545;&#35937;
</pre>
</div>

<p>
使用 <code>-o=custom-columns</code> 的示例：
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#38598;&#32676;&#20013;&#36816;&#34892;&#30528;&#30340;&#25152;&#26377;&#38236;&#20687;</span>
kubectl get pods -A -o=custom-columns=<span style="color: #8b2252;">'DATA:spec.containers[*].image'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20030; default &#21517;&#23383;&#31354;&#38388;&#20013;&#36816;&#34892;&#30340;&#25152;&#26377;&#38236;&#20687;&#65292;&#25353; Pod &#20998;&#32452;</span>
kubectl get pods --namespace default --output=custom-columns=<span style="color: #8b2252;">"NAME:.metadata.name,IMAGE:.spec.containers[*].image"</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#38500; "k8s.gcr.io/coredns:1.6.2" &#20043;&#22806;&#30340;&#25152;&#26377;&#38236;&#20687;</span>
kubectl get pods -A -o=custom-columns=<span style="color: #8b2252;">'DATA:spec.containers[?(@.image!="k8s.gcr.io/coredns:1.6.2")].image'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36755;&#20986; metadata &#19979;&#38754;&#30340;&#25152;&#26377;&#23383;&#27573;&#65292;&#26080;&#35770; Pod &#21517;&#23383;&#20026;&#20309;</span>
kubectl get pods -A -o=custom-columns=<span style="color: #8b2252;">'DATA:metadata.*'</span>
</pre>
</div>

<p>
有关更多示例，请参看 kubectl
<a href="https://kubernetes.io/zh/docs/reference/kubectl/overview/#custom-columns">参考文档</a>。
</p>

<p>
<b>其它</b>
</p>

<p>
json 输出JSON格式的API对象
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#23646;&#20110;&#26576;&#20010; PC &#30340; Pod &#30340;&#21517;&#23383;</span>
<span style="color: #a0522d;">sel</span>=${<span style="color: #a0522d;">$</span>(<span style="color: #ff00ff;">kubectl get rc my-rc --output=json | jq -j '.spec.selector | to_entries | .[] | "\(.key</span><span style="color: #8b2252;">)=\(.value),"'</span>)%?}
<span style="color: #483d8b;">echo</span> $(<span style="color: #ff00ff;">kubectl get pods --selector=$sel --output=jsonpath={.items..metadata.name}</span>)

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#24403;&#21069; Pod &#20013;&#20351;&#29992;&#30340; Secret</span>

kubectl get pods -o json | jq <span style="color: #8b2252;">'.items[].spec.containers[].env[]?.valueFrom.secretKeyRef.name'</span> | grep -v null | sort | uniq
</pre>
</div>

<p>
（3）以自定义列名显示Pod的信息：
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl get pod &lt;pod-name&gt; -o=custom-columns=NAME:.metadata.name,RSRC:.metadata.resourceVersion
</pre>
</div>

<p>
（4）基于文件的自定义列名输出：
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl get pods &lt;pod-name&gt; -o=custom-columns-file=template.txt

template.txt&#25991;&#20214;&#30340;&#20869;&#23481;&#20026;&#65306;
NAME                RSRC
metadata.name       metadata.resourceVersion

&#36755;&#20986;&#32467;&#26524;
$ kubectl get pods chaosfomoney-deployment-64ccd59bdc-h72gh -o=custom-columns-file=template.txt 
NAME                                       RSRC
chaosfomoney-deployment-64ccd59bdc-h72gh   101119
</pre>
</div>

<p>
（5）jsonpath= 打印jsonpath表达式中定义的字段
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl get nodes -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.items[*].status.addresses[?(@.type=="ExternalIP")].address}'</span> <span style="color: #b22222;">#</span><span style="color: #b22222;">&#33719;&#21462;&#25152;&#26377;&#33410;&#28857;&#30340; ExternalIP</span>

kubectl get pods --selector=<span style="color: #a0522d;">app</span>=cassandra rc -o  
<span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.items[*].metadata.labels.version}'</span> <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#25152;&#26377;&#20855;&#26377; app=cassandra &#30340; pod &#20013;&#30340; version &#26631;&#31614;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#30475;&#21738;&#20123;&#33410;&#28857;&#24050;&#23601;&#32490;</span>

<span style="color: #a0522d;">JSONPATH</span>=<span style="color: #8b2252;">'{range .items[*]}{@.metadata.name}:{range @.status.conditions[*]}{@.type}={@.status};{end}{end}'</span> <span style="color: #8b2252;">\</span>
&amp;&amp; kubectl get nodes -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">"$JSONPATH"</span> | grep <span style="color: #8b2252;">"Ready=True"</span>
</pre>
</div>

<p>
另外，还可以将输出结果按某个字段排序，通过&#x2013;sort-by参数以jsonpath表达式进行指定：
</p>

<div class="org-src-container">
<pre class="src src-sh">$ kubectl [command] [TYPE] [NAME] --sort-by=&lt;jsonpath_exp&gt;
</pre>
</div>

<p>
例如，按照名字进行排序：
</p>

<div class="org-src-container">
<pre class="src src-sh">$ kubectl get pods
NAME                                       READY     STATUS    RESTARTS   AGE
chaosfomoney-deployment-64ccd59bdc-h72gh   1/1       Running   0          1d
chaosfomoney-deployment-64ccd59bdc-spnpj   1/1       Running   0          1d
chaosfomoney-deployment-64ccd59bdc-xhnjr   1/1       Running   0          1d

$ kubectl get pods --sort-by=.metadata.name
NAME                                       READY     STATUS    RESTARTS   AGE
chaosfomoney-deployment-64ccd59bdc-h72gh   1/1       Running   0          1d
chaosfomoney-deployment-64ccd59bdc-spnpj   1/1       Running   0          1d
chaosfomoney-deployment-64ccd59bdc-xhnjr   1/1       Running   0          1d
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">kubectl get services --sort-by=.metadata.name <span style="color: #b22222;"># </span><span style="color: #b22222;">List Services Sorted by Name</span>
</pre>
</div>

<p>
根据重启次数排序列出 pod
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl get pods --sort-by=<span style="color: #8b2252;">'.status.containerStatuses[0].restartCount'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9b826fe2-1263-40fc-8f32-661a3870919c" class="outline-4">
<h4 id="h:9b826fe2-1263-40fc-8f32-661a3870919c">Kubectl 日志输出详细程度和调试</h4>
<div class="outline-text-4" id="text-h:9b826fe2-1263-40fc-8f32-661a3870919c">
<p>
Kubectl 日志输出详细程度是通过 <code>-v</code> 或者 <code>--v</code>
来控制的，参数后跟一个数字表示日志的级别。 Kubernetes
通用的日志习惯和相关的日志级别在
<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-instrumentation/logging.md">这里</a>
有相应的描述。
</p>

<div class="org-src-container">
<pre class="src src-sh">&#35814;&#32454;&#31561;&#32423;    &#25551;&#36848;
--v=0   &#24635;&#26159;&#23545;&#25805;&#20316;&#20154;&#21592;&#21487;&#35265;&#12290;
--v=1   &#21512;&#29702;&#30340;&#40664;&#35748;&#26085;&#24535;&#32423;&#21035;&#65292;&#22914;&#26524;&#24744;&#19981;&#38656;&#35201;&#35814;&#32454;&#36755;&#20986;&#12290;
--v=2   &#21487;&#33021;&#19982;&#31995;&#32479;&#30340;&#37325;&#22823;&#21464;&#21270;&#30456;&#20851;&#30340;&#65292;&#26377;&#20851;&#31283;&#23450;&#29366;&#24577;&#30340;&#20449;&#24687;&#21644;&#37325;&#35201;&#30340;&#26085;&#24535;&#20449;&#24687;&#12290;&#36825;&#26159;&#23545;&#22823;&#22810;&#25968;&#31995;&#32479;&#25512;&#33616;&#30340;&#26085;&#24535;&#32423;&#21035;&#12290;
--v=3   &#26377;&#20851;&#26356;&#25913;&#30340;&#25193;&#23637;&#20449;&#24687;&#12290;
--v=4   &#35843;&#35797;&#32423;&#21035;&#35814;&#32454;&#36755;&#20986;&#12290;
--v=6   &#26174;&#31034;&#35831;&#27714;&#30340;&#36164;&#28304;&#12290;
--v=7   &#26174;&#31034;HTTP&#35831;&#27714;&#30340;header&#12290;
--v=8   &#26174;&#31034;HTTP&#35831;&#27714;&#30340;&#20869;&#23481;&#12290;
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:de6d55b6-37c3-4283-95a1-8935770a4262" class="outline-3">
<h3 id="h:de6d55b6-37c3-4283-95a1-8935770a4262">kubectl安装</h3>
<div class="outline-text-3" id="text-h:de6d55b6-37c3-4283-95a1-8935770a4262">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">OS X</span>
curl -LO https://storage.googleapis.com/kubernetes-release/release/$(<span style="color: #ff00ff;">curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt</span>)/bin/darwin/amd64/kubectl

<span style="color: #b22222;"># </span><span style="color: #b22222;">Linux</span>
curl -LO https://storage.googleapis.com/kubernetes-release/release/$(<span style="color: #ff00ff;">curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt</span>)/bin/linux/amd64/kubectl

mkdir -p $<span style="color: #a0522d;">HOME</span>/.kube
sudo cp -i /etc/kubernetes/admin.conf $<span style="color: #a0522d;">HOME</span>/.kube/config
sudo chown $(<span style="color: #ff00ff;">id -u</span>):$(<span style="color: #ff00ff;">id -g</span>) $<span style="color: #a0522d;">HOME</span>/.kube/config

<span style="color: #b22222;"># </span><span style="color: #b22222;">Windows</span>
curl -LO https://storage.googleapis.com/kubernetes-release/release/$(<span style="color: #ff00ff;">curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt</span>)/bin/windows/amd64/kubectl.exe
</pre>
</div>
</div>
</div>
<div id="outline-container-h:c285c725-1765-4fa3-866d-fac8b2f8e8ed" class="outline-3">
<h3 id="h:c285c725-1765-4fa3-866d-fac8b2f8e8ed">命令详解</h3>
<div class="outline-text-3" id="text-h:c285c725-1765-4fa3-866d-fac8b2f8e8ed">
<p>
常用命令详解 get命令用于获取集群的一个或一些resource信息
describe类似于get，同样用于获取resource的相关信息。不同的是，get获得的是更详细的resource个性的详细信息，describe获得的是resource集群相关的信息。describe命令同get类似，但是describe不支持-o选项
resource包括集群节点、运行的pod，ReplicationController，service等。
</p>

<p>
参考： <a href="https://blog.csdn.net/u012429005/article/details/98069681">https://blog.csdn.net/u012429005/article/details/98069681</a>
</p>
</div>
<div id="outline-container-h:75e751b8-ad12-40d5-9504-8de911d7ca32" class="outline-4">
<h4 id="h:75e751b8-ad12-40d5-9504-8de911d7ca32">查看</h4>
<div class="outline-text-4" id="text-h:75e751b8-ad12-40d5-9504-8de911d7ca32">
</div>
<div id="outline-container-h:beeca436-d72a-4a7c-aacd-536a2a231a43" class="outline-5">
<h5 id="h:beeca436-d72a-4a7c-aacd-536a2a231a43">Cluster Info</h5>
<div class="outline-text-5" id="text-h:beeca436-d72a-4a7c-aacd-536a2a231a43">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl config 
[root@master ~]# kubectl cluster-info
[root@master ~]# kubectl get componentstatuses
</pre>
</div>
</div>
</div>
<div id="outline-container-h:834bb8a4-7a47-4bca-9b4a-49f82359b3cb" class="outline-5">
<h5 id="h:834bb8a4-7a47-4bca-9b4a-49f82359b3cb">查看上下文</h5>
<div class="outline-text-5" id="text-h:834bb8a4-7a47-4bca-9b4a-49f82359b3cb">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#23637;&#31034;kubernet&#38598;&#32676;&#30340;&#37197;&#32622;&#35774;&#32622;&#20449;&#24687;</span>
kubectl config view

<span style="color: #b22222;"># </span><span style="color: #b22222;">use multiple kubeconfig files at the same time and view merged config</span>
<span style="color: #a0522d;">KUBECONFIG</span>=~/.kube/config:~/.kube/kubconfig2


<span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;e2e&#29992;&#25143;&#30340;&#23494;&#30721;</span>
kubectl config view -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.users[?(@.name == "e2e")].user.password}'</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#33719;&#21462;&#29992;&#25143;&#21015;&#34920;</span>
kubectl config view -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.users[].name}'</span>   

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23637;&#31034;&#19978;&#19979;&#25991;&#21015;&#34920;</span>
kubectl config get-contexts                       

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23637;&#31034;&#24403;&#21069;&#19978;&#19979;&#25991;</span>
kubectl config current-context                        

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35774;&#32622;&#40664;&#35748;&#19978;&#19979;&#25991;&#20026;my-cluster-name</span>
kubectl config use-context my-cluster-name         

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36890;&#36807;&#39564;&#35777;&#28155;&#21152;&#19968;&#20010;&#26032;&#30340;&#20998;&#25903;&#36827;&#38598;&#32676;</span>
kubectl config set-credentials kubeuser/foo.kubernetes.com --username=kubeuser --password=kubepassword

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;&#21518;&#32493;kubectl &#30340;&#21629;&#20196;&#27704;&#20037;&#20445;&#23384;&#21040;&#35813;&#19978;&#19979;&#25991;&#25152;&#26377;&#30340;&#21629;&#21517;&#31354;&#38388;</span>
kubectl config set-context --current --namespace=ggckad-s2

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;&#29305;&#23450;&#30340;&#29992;&#25143;&#21517;&#21644;&#21629;&#21517;&#31354;&#38388;&#35774;&#32622;&#19978;&#19979;&#25991;</span>
kubectl config set-context gce --user=cluster-admin --namespace=foo <span style="color: #8b2252;">\</span>
  &amp;&amp; kubectl config use-context gce

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21024;&#38500;&#29992;&#25143;foo</span>
kubectl config unset users.foo                       <span style="color: #b22222;"># </span><span style="color: #b22222;">delete user foo</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:ed3f8cc5-8a27-41d3-95b4-bfa670fc6ffe" class="outline-5">
<h5 id="h:ed3f8cc5-8a27-41d3-95b4-bfa670fc6ffe">Nodes</h5>
<div class="outline-text-5" id="text-h:ed3f8cc5-8a27-41d3-95b4-bfa670fc6ffe">
<p>
关于节点的常见命令
</p>

<p>
no 是 node的简写
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get no    <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;node&#33410;&#28857;</span>
NAME     STATUS   ROLES    AGE     VERSION
master   Ready    master   4h22m   v1.14.0
node1    Ready    &lt;none&gt;   3h52m   v1.14.0
node2    Ready    &lt;none&gt;   3h52m   v1.14.0
-----------------------------------------------------
NAME         &#33410;&#28857;&#30340;&#21517;&#23383;
STATUS        &#33410;&#28857;&#30340;&#29366;&#24577;
ROLES        &#33410;&#28857;&#22312;&#38598;&#32676;&#20013;&#25198;&#28436;&#30340;&#35282;&#33394;
AGE            &#36816;&#34892;&#26102;&#38271;
VERSION      &#29256;&#26412;&#21495;
[root@master ~]# kubectl get no -o wide   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;node&#33410;&#28857;</span>
NAME     STATUS   ROLES    AGE     VERSION   INTERNAL-IP      EXTERNAL-IP   OS-IMAGE                KERNEL-VERSION          CONTAINER-RUNTIME
master   Ready    master   4h25m   v1.14.0   192.168.13.141   &lt;none&gt;        CentOS Linux 7 (Core)   3.10.0-693.el7.x86_64   docker://18.6.1
node1    Ready    &lt;none&gt;   3h56m   v1.14.0   192.168.13.142   &lt;none&gt;        CentOS Linux 7 (Core)   3.10.0-693.el7.x86_64   docker://18.6.1
node2    Ready    &lt;none&gt;   3h56m   v1.14.0   192.168.13.143   &lt;none&gt;        CentOS Linux 7 (Core)   3.10.0-693.el7.x86_64   docker://18.6.1
-----------------------------------------------------
INTERNAL-IP            &#33410;&#28857;&#25152;&#22312;&#30340;IP&#22320;&#22336;
EXTERNAL-IP            IP&#30340;&#22806;&#37096;&#32593;&#32476;&#25110;&#20114;&#32852;&#32593;
OS-IMAGE            &#25805;&#20316;&#31995;&#32479;&#30340;&#38236;&#20687;&#29256;&#26412;
KERNEL-VERSION         &#20869;&#26680;&#29256;&#26412;&#21495;
CONTAINER-RUNTIME    &#23481;&#22120;&#36816;&#34892;&#26102;&#30340;&#29256;&#26412;
[root@master ~]# kubectl describe no   
[root@master ~]# kubectl get no -o yaml  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20197;yaml&#30340;&#26684;&#24335;&#36755;&#20986;node&#30340;&#35814;&#32454;&#20449;&#24687;</span>
[root@master ~]# kubectl get no -o json     <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20197;json&#30340;&#26684;&#24335;&#36755;&#20986;node&#30340;&#35814;&#32454;&#20449;&#24687;</span>
[root@master ~]# kubectl get node --selector=[label_name]   <span style="color: #b22222;">#</span><span style="color: #b22222;">selector &#26631;&#31614;&#36873;&#25321;&#22120;&#65288;yaml&#25991;&#20214;&#20013;&#26377;&#65289;</span>
kubectl get node --selector=<span style="color: #8b2252;">'!node-role.kubernetes.io/master'</span>
[root@master ~]# kubectl top node [node_name]  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;node&#33410;&#28857;&#21508;&#36164;&#28304;&#30340;&#20351;&#29992;&#24773;&#20917;</span>
&#22914;&#65306;
[root@master ~]# kubectl top node node1
NAME    CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%   
node1   96m          9%     587Mi           67%       

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#25152;&#26377;node&#30340;ExtenalIP&#22320;&#22336;</span>
kubectl get nodes -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.items[*].status.addresses[?(@.type=="ExternalIP")].address}'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26816;&#26597;&#21738;&#20123;&#33410;&#28857;&#24050;&#20934;&#22791;&#23601;&#32490;</span>
<span style="color: #a0522d;">JSONPATH</span>=<span style="color: #8b2252;">'{range .items[*]}{@.metadata.name}:{range @.status.conditions[*]}{@.type}={@.status};{end}{end}'</span> <span style="color: #8b2252;">\</span>
 &amp;&amp; kubectl get nodes -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">"$JSONPATH"</span> | grep <span style="color: #8b2252;">"Ready=True"</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;status&#20013;&#22810;&#20010;&#23383;&#27573;, &#20877;&#32452;&#21512;&#25104;json</span>
[root@ip-10-0-129-226 bin]# kubectl  ip-1 -ojsonpath=<span style="color: #8b2252;">'{.status.capacity}{"\n"}{.status.allocatable}'</span>|jq
{
  <span style="color: #8b2252;">"cpu"</span>: <span style="color: #8b2252;">"4"</span>,
  <span style="color: #8b2252;">"ephemeral-storage"</span>: <span style="color: #8b2252;">"83864556Ki"</span>,
  <span style="color: #8b2252;">"hugepages-1Gi"</span>: <span style="color: #8b2252;">"0"</span>,
  <span style="color: #8b2252;">"hugepages-2Mi"</span>: <span style="color: #8b2252;">"0"</span>,
  <span style="color: #8b2252;">"hugepages-32Mi"</span>: <span style="color: #8b2252;">"0"</span>,
  <span style="color: #8b2252;">"hugepages-64Ki"</span>: <span style="color: #8b2252;">"0"</span>,
  <span style="color: #8b2252;">"memory"</span>: <span style="color: #8b2252;">"32447172Ki"</span>,
  <span style="color: #8b2252;">"pods"</span>: <span style="color: #8b2252;">"58"</span>
}
{
  <span style="color: #8b2252;">"cpu"</span>: <span style="color: #8b2252;">"3920m"</span>,
  <span style="color: #8b2252;">"ephemeral-storage"</span>: <span style="color: #8b2252;">"76215832858"</span>,
  <span style="color: #8b2252;">"hugepages-1Gi"</span>: <span style="color: #8b2252;">"0"</span>,
  <span style="color: #8b2252;">"hugepages-2Mi"</span>: <span style="color: #8b2252;">"0"</span>,
  <span style="color: #8b2252;">"hugepages-32Mi"</span>: <span style="color: #8b2252;">"0"</span>,
  <span style="color: #8b2252;">"hugepages-64Ki"</span>: <span style="color: #8b2252;">"0"</span>,
  <span style="color: #8b2252;">"memory"</span>: <span style="color: #8b2252;">"31430340Ki"</span>,
  <span style="color: #8b2252;">"pods"</span>: <span style="color: #8b2252;">"58"</span>
}
[root@ip-10-0-129-226 bin]# kubectl get node ip-1 -ojsonpath=<span style="color: #8b2252;">'{.status.capacity}{"\n"}{.status.allocatable}'</span>|jq -s <span style="color: #8b2252;">'.[0] as $capacity | .[1] as $allocatable | {capacity: $capacity, allocatable: $allocatable}'</span>
{
  <span style="color: #8b2252;">"capacity"</span>: {
    <span style="color: #8b2252;">"cpu"</span>: <span style="color: #8b2252;">"4"</span>,
    <span style="color: #8b2252;">"ephemeral-storage"</span>: <span style="color: #8b2252;">"83864556Ki"</span>,
    <span style="color: #8b2252;">"hugepages-1Gi"</span>: <span style="color: #8b2252;">"0"</span>,
    <span style="color: #8b2252;">"hugepages-2Mi"</span>: <span style="color: #8b2252;">"0"</span>,
    <span style="color: #8b2252;">"hugepages-32Mi"</span>: <span style="color: #8b2252;">"0"</span>,
    <span style="color: #8b2252;">"hugepages-64Ki"</span>: <span style="color: #8b2252;">"0"</span>,
    <span style="color: #8b2252;">"memory"</span>: <span style="color: #8b2252;">"32447172Ki"</span>,
    <span style="color: #8b2252;">"pods"</span>: <span style="color: #8b2252;">"58"</span>
  },
  <span style="color: #8b2252;">"allocatable"</span>: {
    <span style="color: #8b2252;">"cpu"</span>: <span style="color: #8b2252;">"3920m"</span>,
    <span style="color: #8b2252;">"ephemeral-storage"</span>: <span style="color: #8b2252;">"76215832858"</span>,
    <span style="color: #8b2252;">"hugepages-1Gi"</span>: <span style="color: #8b2252;">"0"</span>,
    <span style="color: #8b2252;">"hugepages-2Mi"</span>: <span style="color: #8b2252;">"0"</span>,
    <span style="color: #8b2252;">"hugepages-32Mi"</span>: <span style="color: #8b2252;">"0"</span>,
    <span style="color: #8b2252;">"hugepages-64Ki"</span>: <span style="color: #8b2252;">"0"</span>,
    <span style="color: #8b2252;">"memory"</span>: <span style="color: #8b2252;">"31430340Ki"</span>,
    <span style="color: #8b2252;">"pods"</span>: <span style="color: #8b2252;">"58"</span>
  }
}

</pre>
</div>
</div>
</div>
<div id="outline-container-h:75ea09b4-66d3-4dd9-ba46-76a17fb0b3a7" class="outline-5">
<h5 id="h:75ea09b4-66d3-4dd9-ba46-76a17fb0b3a7">Pods</h5>
<div class="outline-text-5" id="text-h:75ea09b4-66d3-4dd9-ba46-76a17fb0b3a7">
<p>
po 是pod的简写
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl get po                 <span style="color: #b22222;">#</span><span style="color: #b22222;">pod&#30340;&#20449;&#24687;</span>
kubectl get pods --all-namespaces             <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23637;&#31034;&#25152;&#26377;namespace&#19979;&#25152;&#26377;&#30340;pod</span>
kubectl get pods -o wide                      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23637;&#31034;&#25152;&#26377;namespace&#19979;&#25152;&#26377;&#30340;pod&#30340;&#26356;&#22810;&#20449;&#24687;</span>
kubectl get pods --include-uninitialized      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23637;&#31034;&#24403;&#21069;namespace&#19979;&#25152;&#26377;pod,&#21253;&#25324;&#26410;&#21021;&#22987;&#21270;&#30340;</span>
kubectl get pod my-pod -o yaml                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;pod&#30340;&#37197;&#32622;&#25991;&#20214;</span>
kubectl get pod my-pod -o yaml --export       <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;pod&#30340;&#37197;&#32622;&#25991;&#20214;&#65292;&#25490;&#38500;&#29305;&#23450;&#30340;&#23646;&#24615;</span>
kubectl describe po
[root@master ~]# kubectl get po --show-labels      <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;pod&#23545;&#24212;&#30340;&#26631;&#31614;</span>
NAME                     READY   STATUS    RESTARTS   AGE    LABELS
mysql-ft58r              1/1     Running   0          64m    <span style="color: #a0522d;">app</span>=mysql
myweb-2j67r              1/1     Running   0          56m    <span style="color: #a0522d;">app</span>=myweb
myweb-7nzdc              1/1     Running   0          56m    <span style="color: #a0522d;">app</span>=myweb
nginx-5f965696dd-w4thr   1/1     Running   1          3h8m   <span style="color: #a0522d;">app</span>=nginx,pod-template-hash=5f965696dd
[root@master ~]# kubectl get po -l <span style="color: #a0522d;">app</span>=nginx          <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#26631;&#31614;&#20026;app: nginx &#30340;pod</span>
[root@master ~]# kubectl get po -o yaml                   <span style="color: #b22222;">#</span><span style="color: #b22222;">yaml&#26684;&#24335;</span>
[root@master ~]# kubectl get po -o json                    <span style="color: #b22222;">#</span><span style="color: #b22222;">json&#26684;&#24335;</span>
[root@master ~]# kubectl get pods -- field-selector status.phase=Running   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#29366;&#24577;&#20026;Running&#30340;pod</span>
NAME                     READY   STATUS    RESTARTS   AGE
mysql-ft58r              1/1     Running   0          78m
myweb-2j67r              1/1     Running   0          70m
myweb-7nzdc              1/1     Running   0          70m
nginx-5f965696dd-w4thr   1/1     Running   1          3h22m

<span style="color: #b22222;"># </span><span style="color: #b22222;">pod&#19978;&#27425;&#29366;&#24577;</span>
$<span style="color: #a0522d;">kube_CMD</span> -n $<span style="color: #a0522d;">namespace</span> get pods $<span style="color: #a0522d;">rname</span> -o go-template=<span style="color: #8b2252;">"{{range .status.containerStatuses}}{{.lastState.terminated.finishedAt}}@{{.lastState.terminated.reason}}{{end}}@{{.status.podIP}}@{{.status.hostIP}}"</span>


<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23637;&#31034;&#20381;&#25454;&#37325;&#21551;&#27425;&#25968;&#25490;&#24207;&#30340;pod</span>
kubectl get pods --sort-by=<span style="color: #8b2252;">'.status.containerStatuses[0].restartCount'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#33719;&#21462;&#26631;&#31614;&#20026;app=cassandra&#30340;pod&#30340;metadata.labels.version</span>
kubectl get pods --selector=<span style="color: #a0522d;">app</span>=cassandra -o <span style="color: #8b2252;">\</span>
  <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{.items[*].metadata.labels.version}'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#23646;&#20110;&#29305;&#23450;RC&#30340;Pod&#21517;&#31216;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">jq&#21629;&#20196;&#23545;&#20110;&#22797;&#26434;&#30340;json&#36335;&#24452;&#36716;&#25442;&#24456;&#26377;&#29992;, &#26356;&#22810;&#35814;&#24773;https://stedolan.github.io/jq/</span>
<span style="color: #a0522d;">sel</span>=${<span style="color: #a0522d;">$</span>(<span style="color: #ff00ff;">kubectl get rc my-rc --output=json | jq -j '.spec.selector | to_entries | .[] | "\(.key</span><span style="color: #8b2252;">)=\(.value),"'</span>)%?}
<span style="color: #483d8b;">echo</span> $(<span style="color: #ff00ff;">kubectl get pods --selector=$sel --output=jsonpath={.items..metadata.name}</span>)

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#25152;&#26377;pod&#65288;&#25110;&#20219;&#20309;&#20854;&#20182;&#25903;&#25345;&#26631;&#31614;&#30340;Kubernetes&#23545;&#35937;&#65289;&#30340;&#26631;&#31614;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">Also uses "jq"</span>
<span style="color: #a020f0;">for</span> item<span style="color: #a020f0;"> in</span> $(<span style="color: #ff00ff;"> kubectl get pod --output=name</span>); <span style="color: #a020f0;">do </span><span style="color: #483d8b;">printf</span> <span style="color: #8b2252;">"Labels for %s\n"</span> <span style="color: #8b2252;">"$item"</span> | grep --color -E <span style="color: #8b2252;">'[^/]+$'</span> &amp;&amp; kubectl get <span style="color: #8b2252;">"$item"</span> --output=json | jq -r -S <span style="color: #8b2252;">'.metadata.labels | to_entries | .[] | " \(.key)=\(.value)"'</span> 2&gt;/dev/null; <span style="color: #483d8b;">printf</span> <span style="color: #8b2252;">"\n"</span>; <span style="color: #a020f0;">done</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#24403;&#21069;pod&#27491;&#22312;&#20351;&#29992;&#30340;&#25152;&#26377;secert</span>
kubectl get pods -o json | jq <span style="color: #8b2252;">'.items[].spec.containers[].env[]?.valueFrom.secretKeyRef.name'</span> | grep -v null | sort | uniq

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#38236;&#20687;</span>
kubectl get deploy -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{range .items[*]}{@.metadata.namespace},{@.metadata.name},{range @.spec.template.spec.containers[*]}{@.name},{@.image}{"\n"}{end}{end}'</span>|sort -t <span style="color: #8b2252;">','</span>  -k 2 | awk -F<span style="color: #8b2252;">','</span> <span style="color: #8b2252;">'{printf"%20-s %30-s %40-s %40-s\n",$1,$2,$3,$4}'</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#36807;&#28388;&#20986;&#38598;&#32676;&#20013;&#25152;&#26377;&#26631;&#31614;&#19981;&#31526;&#21512;k8s-app&#20026;calico-node&#21644;ratel&#30340;Pod&#65292;&#24182;&#25353;&#29031;pod&#21517;&#23383;&#36827;&#34892;&#25490;&#24207;</span>
kubectl get po -l k8s-app notin (calico-node,ratel) --all-namespaces --sort-by=.metadata.name
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;pod&#36164;&#28304;&#37197;&#32622;</span>
kubectl get deploy -n general-components -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{range .items[*]}{@.spec.replicas},{range @.spec.template.spec.containers[*]}{@.name},{@.resources.requests.cpu}C/{@.resources.requests.memory},{@.readinessProbe.httpGet.path},{@.readinessProbe.httpGet.port}{"\n"}{end}{end}'</span>|sort -t <span style="color: #8b2252;">','</span>  -k 2 |sed <span style="color: #8b2252;">'1i&#21103;&#26412;&#25968;,&#39033;&#30446;,&#21333;&#33410;&#28857;&#36164;&#28304;,&#20581;&#24247;&#22320;&#22336;,&#31471;&#21475;'</span> &gt;general-components.csv
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">kubectl get deploy -n english-prod -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{range .items[*]}{@.spec.replicas},{range @.spec.template.spec.containers[*]}{@.name},{@.resources.requests.cpu}C/{@.resources.requests.memory},{@.readinessProbe.httpGet.path},{@.readinessProbe.httpGet.port}{"\n"}{end}{end}'</span>|sort -t <span style="color: #8b2252;">','</span>  -k 2 |sed <span style="color: #8b2252;">'1i&#21103;&#26412;&#25968;,&#39033;&#30446;,&#21333;&#33410;&#28857;&#36164;&#28304;,&#20581;&#24247;&#22320;&#22336;,&#31471;&#21475;'</span> |awk -F<span style="color: #8b2252;">','</span> <span style="color: #8b2252;">'{printf"%s %40-s %20-s %10-s\n",$1,$2,$3,$4}'</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">kubectl get deploy -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{range .items[*]}{@.spec.replicas},{range @.spec.template.spec.containers[*]}{@.name},{@.resources.requests.cpu}C/{@.resources.requests.memory},{@.resources.limits.cpu}C/{@.resources.limits.memory},{@.readinessProbe.httpGet.path},{@.readinessProbe.httpGet.port}{"\n"}{end}{end}'</span>|sort -t <span style="color: #8b2252;">','</span>  -k 2 |sed <span style="color: #8b2252;">'1i&#21103;&#26412;&#25968;,&#39033;&#30446;,&#21333;&#21103;&#26412;request,&#21333;&#21103;&#26412;limit,&#20581;&#24247;&#22320;&#22336;,&#31471;&#21475;'</span> |awk -F<span style="color: #8b2252;">','</span> <span style="color: #8b2252;">'{printf"%s %40-s %20-s %20-s %10-s\n",$1,$2,$3,$4,$5}'</span>


kubectl get deploy -o <span style="color: #a0522d;">jsonpath</span>=<span style="color: #8b2252;">'{range .items[*]}{@.spec.replicas}%{range @.spec.template.spec.containers[*]}{@.name}%{@.resources.requests.cpu}C/{@.resources.requests.memory}%{@.resources.limits.cpu}C/{@.resources.limits.memory}%{@.readinessProbe.httpGet.path}%{@.readinessProbe.httpGet.port}%{@.ports}%{@.command}/{@.args}{"\n"}{end}{end}'</span>|sort -t <span style="color: #8b2252;">','</span>  -k 2 |sed <span style="color: #8b2252;">'1i&#21103;&#26412;&#25968;,&#39033;&#30446;,&#21333;&#21103;&#26412;request,&#21333;&#21103;&#26412;limit,&#20581;&#24247;&#22320;&#22336;,&#31471;&#21475;,&#26381;&#21153;&#31471;&#21475;,&#21551;&#21160;&#21442;&#25968;'</span> |awk -F<span style="color: #8b2252;">'%'</span> <span style="color: #8b2252;">'{printf"%s %40-s %20-s %20-s %10-s %10-s %20-s %20-s\n",$1,$2,$3,$4,$5,$6,$7,$8}'</span>
</pre>
</div>

<p>
匹配env字段内容
</p>
<div class="org-src-container">
<pre class="src src-shell">                <span style="color: #8b2252;">"env"</span>: [
                    {
                        <span style="color: #8b2252;">"name"</span>: <span style="color: #8b2252;">"POD_IP"</span>,
                        <span style="color: #8b2252;">"valueFrom"</span>: {
                            <span style="color: #8b2252;">"fieldRef"</span>: {
                                <span style="color: #8b2252;">"apiVersion"</span>: <span style="color: #8b2252;">"v1"</span>,
                                <span style="color: #8b2252;">"fieldPath"</span>: <span style="color: #8b2252;">"status.podIP"</span>
                            }
                        }
                    }
                ],
[root@proxy ~]# kubectl -n dev1 get po canal-server-69b5f49894-2tzhd -ojson |grep -C20 env

[root@proxy ~]# kubectl -n dev1 get po canal-server-69b5f49894-2tzhd -ojsonpath=<span style="color: #8b2252;">'{.spec.containers[?(@.name == "canal-server")].env}'</span>
[{<span style="color: #8b2252;">"name"</span>:<span style="color: #8b2252;">"POD_IP"</span>,<span style="color: #8b2252;">"valueFrom"</span>:{<span style="color: #8b2252;">"fieldRef"</span>:{<span style="color: #8b2252;">"apiVersion"</span>:<span style="color: #8b2252;">"v1"</span>,<span style="color: #8b2252;">"fieldPath"</span>:<span style="color: #8b2252;">"status.podIP"</span>}}}]

[root@proxy ~]# kubectl -n dev1 get po canal-server-69b5f49894-2tzhd -ojsonpath=<span style="color: #8b2252;">'{.spec.containers[?(@.name == "canal-server")].env[?(@.name == "POD_IP")].valueFrom}'</span>
{<span style="color: #8b2252;">"fieldRef"</span>:{<span style="color: #8b2252;">"apiVersion"</span>:<span style="color: #8b2252;">"v1"</span>,<span style="color: #8b2252;">"fieldPath"</span>:<span style="color: #8b2252;">"status.podIP"</span>}}
</pre>
</div>
</div>
</div>
<div id="outline-container-h:097bfcd0-269d-4236-9f91-c70f75807774" class="outline-5">
<h5 id="h:097bfcd0-269d-4236-9f91-c70f75807774">Namespaces（命名空间）</h5>
<div class="outline-text-5" id="text-h:097bfcd0-269d-4236-9f91-c70f75807774">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get ns   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#21629;&#21517;&#31354;&#38388;</span>
NAME              STATUS   AGE
default           Active   5h22m
kube-node-lease   Active   5h22m
kube-public       Active   5h22m
kube-system       Active   5h22m

[root@master ~]# kubectl get ns - o yaml
[root@master ~]# kubectl describe ns
</pre>
</div>
</div>
</div>
<div id="outline-container-h:24c3bda7-20ef-4366-83da-fc47e624800b" class="outline-5">
<h5 id="h:24c3bda7-20ef-4366-83da-fc47e624800b">Deployments</h5>
<div class="outline-text-5" id="text-h:24c3bda7-20ef-4366-83da-fc47e624800b">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get deploy
[root@master ~]# kubectl describe deploy
[root@master ~]# kubectl get deploy - o wide
[root@master ~]# kubectl get deploy - o yaml
</pre>
</div>
</div>
</div>
<div id="outline-container-h:0de9d447-575c-4524-8fb8-9b8646b747e9" class="outline-5">
<h5 id="h:0de9d447-575c-4524-8fb8-9b8646b747e9">Services</h5>
<div class="outline-text-5" id="text-h:0de9d447-575c-4524-8fb8-9b8646b747e9">
<div class="org-src-container">
<pre class="src src-sh">kubectl get svc
kubectl describe svc
kubectl get svc - o wide
kubectl get svc - o yaml
kubectl get svc --show-labels

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23637;&#31034;&#20381;&#25454;metadata.name &#25490;&#24207;&#36807;&#30340;service</span>
kubectl get services --sort-by=.metadata.name
</pre>
</div>

<p>
​####DaemonSets
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get ds
[root@master ~]# kubectl get ds --all-namespaces
[root@master ~]# kubectl describe ds [daemonset_name] - n [namespce_name]
[root@master ~]# kubectl get ds [ds_name] -n [ns_name] -o yaml
</pre>
</div>
</div>
</div>
<div id="outline-container-h:523ee34e-05c8-4860-9bf8-01a9498b00b8" class="outline-5">
<h5 id="h:523ee34e-05c8-4860-9bf8-01a9498b00b8">Events</h5>
<div class="outline-text-5" id="text-h:523ee34e-05c8-4860-9bf8-01a9498b00b8">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get events
[root@master ~]# kubectl get events -n kube-system
[root@master ~]# kubectl get events -w

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23637;&#31034;&#26681;&#25454;&#26102;&#38388;&#26631;&#31614;&#25490;&#24207;&#30340;&#20107;&#20214;</span>
kubectl --kubeconfig=/etc/kubernetes/admin.conf  -n english-prod get event --sort-by=.metadata.creationTimestamp

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#30475;&#25152;&#26377;&#20107;&#20214;</span>
kubectl get events --all-namespaces

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#30475;&#21517;&#20026;nginx&#23545;&#35937;&#30340;&#20107;&#20214;</span>
kubectl get events --field-selector involvedObject.name=nginx,involvedObject.namespace=default

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#30475;&#21517;&#20026;nginx&#30340;&#26381;&#21153;&#20107;&#20214;</span>
kubectl get events --field-selector involvedObject.name=nginx,involvedObject.namespace=default,involvedObject.kind=Service

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#30475;Pod&#30340;&#20107;&#20214;</span>
kubectl get events --field-selector involvedObject.name=nginx-85cb5867f-bs7pn,involvedObject.kind=Pod

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25353;&#26102;&#38388;&#23545;events&#25490;&#24207;</span>
kubectl get events --sort-by=.metadata.creationTimestamp

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#33258;&#23450;&#20041;events&#36755;&#20986;&#26684;&#24335;</span>
kubectl get events  --sort-by=<span style="color: #8b2252;">'.metadata.creationTimestamp'</span>  -o <span style="color: #8b2252;">'go-template={{range .items}}{{.involvedObject.name}}{{"\t"}}{{.involvedObject.kind}}{{"\t"}}{{.message}}{{"\t"}}{{.reason}}{{"\t"}}{{.type}}{{"\t"}}{{.firstTimestamp}}{{"\n"}}{{end}}'</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">LAST SEEN   TYPE      REASON              OBJECT                                            MESSAGE
&lt;unknown&gt;   Warning   FailedScheduling    pod/english-etp-race-mqtt-658ffc45bd-8jqnp        0/109 nodes are available: 27 Insufficient cpu, 32 node(s) didn<span style="color: #8b2252;">'t match node selector, 77 Insufficient memory.</span>
<span style="color: #8b2252;">4m3s        Normal    NotTriggerScaleUp        pod/english-etp-race-mqtt-658ffc45bd-mth47        pod didn'</span>t trigger scale-up (no group fit even if a new node is added)


3m20s       Normal    TriggeredScaleUp    pod/english-etp-race-mqtt-658ffc45bd-xrhkf        pod triggered scale-up: [{asg-2ze1hr7i95b770owi42z 0-&gt;2 (max: 30)}]
38m         Warning   Unhealthy           pod/english-etp-race-mqtt-658ffc45bd-w68gq        Readiness probe failed: Get http://172.20.14.93:8090/health: dial tcp 172.20.14.93:8090: connect: connection refused

37m         Normal    Killing             pod/english-etp-race-match-8454d88655-kvjmq       Stopping container english-etp-race-match
37m         Warning   FailedPreStopHook   pod/english-etp-race-match-8454d88655-tcbjg       Exec lifecycle hook ([/bin/sh -c /data/down_nacos.sh]) <span style="color: #a020f0;">for</span> Container <span style="color: #8b2252;">"english-etp-race-match"</span><span style="color: #a020f0;"> in</span> Pod <span style="color: #8b2252;">"english-etp-race-match-8454d88655-tcbjg_english-prod(0368b640-1bee-4770-a4ab-ba606fc2a8fa)"</span> failed - error: command <span style="color: #8b2252;">'/bin/sh -c /data/down_nacos.sh'</span> exited with 127: /bin/sh: /data/down_nacos.sh: No such file or directory
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">kubectl -n english-prod get events  -o json

{
    <span style="color: #8b2252;">"apiVersion"</span>: <span style="color: #8b2252;">"v1"</span>,
    <span style="color: #8b2252;">"items"</span>: [
        {
            <span style="color: #8b2252;">"apiVersion"</span>: <span style="color: #8b2252;">"v1"</span>,
            <span style="color: #8b2252;">"count"</span>: 39,
            <span style="color: #8b2252;">"eventTime"</span>: null,
            <span style="color: #8b2252;">"firstTimestamp"</span>: <span style="color: #8b2252;">"2020-11-10T07:21:30Z"</span>,
            <span style="color: #8b2252;">"involvedObject"</span>: {
                <span style="color: #8b2252;">"apiVersion"</span>: <span style="color: #8b2252;">"autoscaling.alibabacloud.com/v1beta1"</span>,
                <span style="color: #8b2252;">"kind"</span>: <span style="color: #8b2252;">"CronHorizontalPodAutoscaler"</span>,
                <span style="color: #8b2252;">"name"</span>: <span style="color: #8b2252;">"cronhpa-sample"</span>,
                <span style="color: #8b2252;">"namespace"</span>: <span style="color: #8b2252;">"english-prod"</span>,
                <span style="color: #8b2252;">"resourceVersion"</span>: <span style="color: #8b2252;">"1410145805"</span>,
                <span style="color: #8b2252;">"uid"</span>: <span style="color: #8b2252;">"cccc07ce-da3a-4574-b365-3b07eaaea255"</span>
            },
            <span style="color: #8b2252;">"kind"</span>: <span style="color: #8b2252;">"Event"</span>,
            <span style="color: #8b2252;">"lastTimestamp"</span>: <span style="color: #8b2252;">"2020-11-15T14:21:30Z"</span>,
            <span style="color: #8b2252;">"message"</span>: <span style="color: #8b2252;">"cron hpa job scale-down executed successfully. current replicas:8, desired replicas:2."</span>,
            <span style="color: #8b2252;">"metadata"</span>: {
                <span style="color: #8b2252;">"creationTimestamp"</span>: <span style="color: #8b2252;">"2020-11-15T14:21:30Z"</span>,
                <span style="color: #8b2252;">"name"</span>: <span style="color: #8b2252;">"cronhpa-sample.16461487ce3c408d"</span>,
                <span style="color: #8b2252;">"namespace"</span>: <span style="color: #8b2252;">"english-prod"</span>,
                <span style="color: #8b2252;">"resourceVersion"</span>: <span style="color: #8b2252;">"8926911"</span>,
                <span style="color: #8b2252;">"selfLink"</span>: <span style="color: #8b2252;">"/api/v1/namespaces/english-prod/events/cronhpa-sample.16461487ce3c408d"</span>,
                <span style="color: #8b2252;">"uid"</span>: <span style="color: #8b2252;">"b5bedee8-5a1f-4d17-bf7e-c2aa2fcbe0ca"</span>
            },
            <span style="color: #8b2252;">"reason"</span>: <span style="color: #8b2252;">"Succeed"</span>,
            <span style="color: #8b2252;">"reportingComponent"</span>: <span style="color: #8b2252;">""</span>,
            <span style="color: #8b2252;">"reportingInstance"</span>: <span style="color: #8b2252;">""</span>,
            <span style="color: #8b2252;">"source"</span>: {
                <span style="color: #8b2252;">"component"</span>: <span style="color: #8b2252;">"cron-horizontal-pod-autoscaler"</span>
            },
            <span style="color: #8b2252;">"type"</span>: <span style="color: #8b2252;">"Normal"</span>
        },
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">kubectl -n english-prod get events   --field-selector <span style="color: #a0522d;">type</span>=Warning,<span style="color: #a0522d;">reason</span>=FailedScheduling

kubectl -n english-prod get events   --field-selector <span style="color: #a0522d;">type</span>=Warning,<span style="color: #a0522d;">reason</span>=FailedScheduling --sort-by=<span style="color: #8b2252;">'.metadata.creationTimestamp'</span> -o <span style="color: #8b2252;">'go-template={{range .items}}{{.involvedObject.name}}{{"\t"}}{{.involvedObject.kind}}{{"\t"}}{{.message}}{{"\t"}}{{.reason}}{{"\t"}}{{.type}}{{"\t"}}{{.firstTimestamp}}{{"\n"}}{{end}}'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:b36b36d6-e0a3-4ff0-af7b-f3199c21e585" class="outline-5">
<h5 id="h:b36b36d6-e0a3-4ff0-af7b-f3199c21e585">logs</h5>
<div class="outline-text-5" id="text-h:b36b36d6-e0a3-4ff0-af7b-f3199c21e585">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl logs [pod_name]
[root@master ~]# kubectl logs --since=1h [pod_name]
[root@master ~]# kubectl logs --tail =20 [pod_name]
[root@master ~]# kubectl logs -f -c [container_name] [pod_name]  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36319;&#36394;&#26597;&#30475;&#23481;&#22120;&#30340;&#26085;&#24535;&#65292;&#30456;&#24403;&#20110;tail -f&#21629;&#20196;&#30340;&#32467;&#26524;</span>
[root@master ~]# kubectl logs [pod_name] &gt; pod.log
</pre>
</div>
</div>
</div>
<div id="outline-container-h:bdc71311-1ad8-4303-8aa9-c7aa4e145427" class="outline-5">
<h5 id="h:bdc71311-1ad8-4303-8aa9-c7aa4e145427">Service Accounts</h5>
<div class="outline-text-5" id="text-h:bdc71311-1ad8-4303-8aa9-c7aa4e145427">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get sa
[root@master ~]# kubectl get sa -o yaml
[root@master ~]# kubectl get serviceaccounts default -o yaml &gt;./sa.yaml
[root@master ~]# kubectl replace serviceaccount default -f ./sa.yaml
</pre>
</div>
</div>
</div>
<div id="outline-container-h:e254bd02-e754-4d55-903c-29581fc0806b" class="outline-5">
<h5 id="h:e254bd02-e754-4d55-903c-29581fc0806b">ReplicaSets</h5>
<div class="outline-text-5" id="text-h:e254bd02-e754-4d55-903c-29581fc0806b">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get rs
[root@master ~]# kubectl describe rs
[root@master ~]# kubectl get rs -o wide
[root@master ~]# kubectl get rs -o yaml
</pre>
</div>
</div>
</div>
<div id="outline-container-h:752f915f-7331-4a0c-8ee3-b05c9babc5f0" class="outline-5">
<h5 id="h:752f915f-7331-4a0c-8ee3-b05c9babc5f0">Roles</h5>
<div class="outline-text-5" id="text-h:752f915f-7331-4a0c-8ee3-b05c9babc5f0">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get roles --all -namespaces
[root@master ~]# kubectl get roles --all -namespaces -o yaml
</pre>
</div>
</div>
</div>
<div id="outline-container-h:e20c4c24-f83c-45a7-834f-14f0071773de" class="outline-5">
<h5 id="h:e20c4c24-f83c-45a7-834f-14f0071773de">Secrets</h5>
<div class="outline-text-5" id="text-h:e20c4c24-f83c-45a7-834f-14f0071773de">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get secrets
[root@master ~]# kubectl get secrets --all-namespaces
[root@master ~]# kubectl get secrets -o yaml
</pre>
</div>
</div>
</div>
<div id="outline-container-h:00ba9576-b213-4d3d-9154-cfe5cf2b326e" class="outline-5">
<h5 id="h:00ba9576-b213-4d3d-9154-cfe5cf2b326e">ConfigMaps</h5>
<div class="outline-text-5" id="text-h:00ba9576-b213-4d3d-9154-cfe5cf2b326e">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get cm
[root@master ~]# kubectl get cm --all-namespaces
[root@master ~]# kubectl get cm --all-namespaces -o yaml
kubectl -n kube-system edit cm coredns
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2b039f47-123c-472a-af64-b7baf2c3e30e" class="outline-5">
<h5 id="h:2b039f47-123c-472a-af64-b7baf2c3e30e">Ingress</h5>
<div class="outline-text-5" id="text-h:2b039f47-123c-472a-af64-b7baf2c3e30e">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get ing
[root@master ~]# kubectl get ing --all-namespaces
</pre>
</div>
</div>
</div>
<div id="outline-container-h:991dbbe2-97b4-4fcd-b4cf-1415b08aa3af" class="outline-5">
<h5 id="h:991dbbe2-97b4-4fcd-b4cf-1415b08aa3af">PersistentVolume</h5>
<div class="outline-text-5" id="text-h:991dbbe2-97b4-4fcd-b4cf-1415b08aa3af">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get pv
[root@master ~]# kubectl describe pv
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2d9774be-eadd-4cab-ac53-4cc6ad90bbd2" class="outline-5">
<h5 id="h:2d9774be-eadd-4cab-ac53-4cc6ad90bbd2">PersistentVolumeClaim</h5>
<div class="outline-text-5" id="text-h:2d9774be-eadd-4cab-ac53-4cc6ad90bbd2">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get pvc
[root@master ~]# kubectl describe pvc
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9e739909-b13e-4454-a490-c98301d5f5a5" class="outline-5">
<h5 id="h:9e739909-b13e-4454-a490-c98301d5f5a5">StorageClass</h5>
<div class="outline-text-5" id="text-h:9e739909-b13e-4454-a490-c98301d5f5a5">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get sc
[root@master ~]# kubectl get sc -o yaml
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5c0f4b35-8af9-4e4c-86c2-a255706cfc71" class="outline-5">
<h5 id="h:5c0f4b35-8af9-4e4c-86c2-a255706cfc71">Multiple Resources</h5>
<div class="outline-text-5" id="text-h:5c0f4b35-8af9-4e4c-86c2-a255706cfc71">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get svc,po
[root@master ~]# kubectl get deploy,no
[root@master ~]# kubectl get all
[root@master ~]# kubectl get all --all -namespaces
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:b596d0b6-bf2c-4c4c-9df2-f7ef3350d4ea" class="outline-4">
<h4 id="h:b596d0b6-bf2c-4c4c-9df2-f7ef3350d4ea">Adding Resources 添加资源</h4>
<div class="outline-text-4" id="text-h:b596d0b6-bf2c-4c4c-9df2-f7ef3350d4ea">
</div>
<div id="outline-container-h:6e5e38c9-741a-4754-afc5-41748884f1c8" class="outline-5">
<h5 id="h:6e5e38c9-741a-4754-afc5-41748884f1c8">Creating a Pod</h5>
<div class="outline-text-5" id="text-h:6e5e38c9-741a-4754-afc5-41748884f1c8">
<div class="org-src-container">
<pre class="src src-sh">kubectl create -f [name_of_file]
kubectl apply -f [name_of_file] <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36890;&#36807;&#25991;&#20214;&#21019;&#24314;&#36164;&#28304;</span>
kubectl apply -f ./my1.yaml -f ./my2.yaml     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36890;&#36807;&#22810;&#20010;&#25991;&#20214;&#21019;&#24314;&#36164;&#28304;</span>
kubectl apply -f ./dir                        <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36890;&#36807;&#25991;&#20214;&#22841;&#37324;&#38754;&#30340;&#36164;&#28304;&#25991;&#20214;&#21019;&#24314;&#36164;&#28304;</span>
kubectl apply -f https://git.io/vPieo         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36890;&#36807;URL&#21019;&#24314;&#36164;&#28304;</span>
kubectl create deployment nginx --image=nginx  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#24320;&#21551;&#19968;&#20010;Nginx&#23454;&#20363;</span>
kubectl explain pods,svc                       <span style="color: #b22222;"># </span><span style="color: #b22222;">get the documentation for pod and svc manifest</span>
kubectl run [pod_name] --image=nginx --resart=Never
kubectl run [pod_name] --geneator=run-pod/v1 --image=nginx
kubectl run [pod_name] --image=nginx --restart=Never
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9a20fe8f-b7b4-4550-892d-3b64537344c1" class="outline-5">
<h5 id="h:9a20fe8f-b7b4-4550-892d-3b64537344c1">Creating a Service</h5>
<div class="outline-text-5" id="text-h:9a20fe8f-b7b4-4550-892d-3b64537344c1">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl create svc nodeport [svc_name] --tcp=8080: 80
</pre>
</div>
</div>
</div>
<div id="outline-container-h:4da85756-3d25-4181-8612-679e183a7a6a" class="outline-5">
<h5 id="h:4da85756-3d25-4181-8612-679e183a7a6a">Creating a Deployment</h5>
<div class="outline-text-5" id="text-h:4da85756-3d25-4181-8612-679e183a7a6a">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl create -f [name_of_file]
[root@master ~]# kubectl apply -f [name_of_file]
[root@master ~]# kubectl create deploy [deploy_name] --image=nginx --replicas=3
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2e270b19-20c5-4180-a12c-47a752a25e29" class="outline-5">
<h5 id="h:2e270b19-20c5-4180-a12c-47a752a25e29">Interactive Pod</h5>
<div class="outline-text-5" id="text-h:2e270b19-20c5-4180-a12c-47a752a25e29">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl run [pod_name] --image=busybox --rm -it --restart=Never -- sh
</pre>
</div>
</div>
</div>
<div id="outline-container-h:84f2fd04-ff42-4e3e-b3b9-d5a661645fcd" class="outline-5">
<h5 id="h:84f2fd04-ff42-4e3e-b3b9-d5a661645fcd">Output YAML to a File</h5>
<div class="outline-text-5" id="text-h:84f2fd04-ff42-4e3e-b3b9-d5a661645fcd">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl create deploy [deploy_name] --image=nginx --dry-run -o yaml &gt; depl oy. yaml
[root@master ~]# kubectl get po [pod_name] -o yaml --export &gt; pod. yaml
</pre>
</div>
</div>
</div>
<div id="outline-container-h:6efc66b5-7a1e-4064-8250-1f269263b2a5" class="outline-5">
<h5 id="h:6efc66b5-7a1e-4064-8250-1f269263b2a5">Getting Help</h5>
<div class="outline-text-5" id="text-h:6efc66b5-7a1e-4064-8250-1f269263b2a5">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl -h 
[root@master ~]# kubectl create -h
[root@master ~]# kubectl run -h
[root@master ~]# kubectl explain deploy.spec
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:799b2b48-7aa7-4cff-a054-a6fb30187a69" class="outline-4">
<h4 id="h:799b2b48-7aa7-4cff-a054-a6fb30187a69">Changing Resource Attributes 改变资源属性</h4>
<div class="outline-text-4" id="text-h:799b2b48-7aa7-4cff-a054-a6fb30187a69">
</div>
<div id="outline-container-h:834bf28d-f422-4fc2-9db5-a5c8a4f539fd" class="outline-5">
<h5 id="h:834bf28d-f422-4fc2-9db5-a5c8a4f539fd">Taint</h5>
<div class="outline-text-5" id="text-h:834bf28d-f422-4fc2-9db5-a5c8a4f539fd">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl taint [node_name] [taint_name] 
</pre>
</div>
</div>
</div>
<div id="outline-container-h:b856106c-0e6e-4a0e-ad36-4233a72402d8" class="outline-5">
<h5 id="h:b856106c-0e6e-4a0e-ad36-4233a72402d8">Labels</h5>
<div class="outline-text-5" id="text-h:b856106c-0e6e-4a0e-ad36-4233a72402d8">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl label [node_name] <span style="color: #a0522d;">disktype</span>=ssd
[root@master ~]# kubectl label [pod_name] <span style="color: #a0522d;">env</span>=prod <span style="color: #b22222;"># </span><span style="color: #b22222;">&#28155;&#21152;&#26631;&#31614;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:37d7b04c-d63c-4914-bca5-902c042a9a65" class="outline-5">
<h5 id="h:37d7b04c-d63c-4914-bca5-902c042a9a65">Cordon/Uncordon</h5>
<div class="outline-text-5" id="text-h:37d7b04c-d63c-4914-bca5-902c042a9a65">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl cordon [node_name]
[root@master ~]# kunectl uncordon [node_name]
</pre>
</div>
</div>
</div>
<div id="outline-container-h:94ef19e3-3bb5-4e6e-9c20-b849c7072cb4" class="outline-5">
<h5 id="h:94ef19e3-3bb5-4e6e-9c20-b849c7072cb4">Drain</h5>
<div class="outline-text-5" id="text-h:94ef19e3-3bb5-4e6e-9c20-b849c7072cb4">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl drain [node_name]
</pre>
</div>
</div>
</div>
<div id="outline-container-h:fddb3421-da3e-4d7f-b3cb-b18473e04025" class="outline-5">
<h5 id="h:fddb3421-da3e-4d7f-b3cb-b18473e04025">Nodes/Pods</h5>
<div class="outline-text-5" id="text-h:fddb3421-da3e-4d7f-b3cb-b18473e04025">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl delet enode [node_name]
[root@master ~]# kubectl delet epod [pod_name]
[root@master ~]# kubectl edit node [node_name]
[root@master ~]# kubectl edit pod [pod_name] 

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20026;rc&#31649;&#29702;&#30340;Nginx&#21019;&#24314;&#19968;&#20010;&#31471;&#21475;&#21495;&#20026;80&#65292;&#38142;&#25509;&#21040;&#23481;&#22120;&#31471;&#21475;&#20026;8000&#30340;&#26381;&#21153;</span>
kubectl expose rc nginx --port=80 --target-port=8000

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;&#21333;&#23481;&#22120;&#30340;Pod&#29256;&#26412;&#26356;&#25913;&#21040;v4</span>
kubectl get pod mypod -o yaml | sed <span style="color: #8b2252;">'s/\(image: myimage\):.*$/\1:v4/'</span> | kubectl replace -f -

&#20462;&#25913;&#36164;&#28304;
kubectl patch node k8s-node-1 -p <span style="color: #8b2252;">'{"spec":{"unschedulable":true}}'</span> <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26356;&#26032;&#37096;&#20998;&#33410;&#28857;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26356;&#26032;&#23481;&#22120;&#38236;&#20687;&#65306;&#23481;&#22120;&#21517;&#26159;&#24517;&#39035;&#30340;&#65292;&#36890;&#36807;&#21517;&#23383;&#26469;&#36827;&#34892;&#21512;&#24182;</span>
kubectl patch pod valid-pod -p <span style="color: #8b2252;">'{"spec":{"containers":[{"name":"kubernetes-serve-hostname","image":"new image"}]}}'</span>


<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;json&#25968;&#32452;&#26469;&#26356;&#26032;&#23481;&#22120;&#30340;&#38236;&#20687;</span>
kubectl patch pod valid-pod --type=<span style="color: #8b2252;">'json'</span> -p=<span style="color: #8b2252;">'[{"op": "replace", "path": "/spec/containers/0/image", "value":"new image"}]'</span>

kubectl rolling-update frontend-v1 -f frontend-v2.json <span style="color: #b22222;"># </span><span style="color: #b22222;">&#28378;&#21160;&#26356;&#26032; pod frontend-v1</span>
kubectl rolling-update frontend-v1 frontend-v2 --image=image:v2 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26356;&#26032;&#36164;&#28304;&#21517;&#31216;&#24182;&#26356;&#26032;&#38236;&#20687;</span>
kubectl rolling-update frontend --image=image:v2 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26356;&#26032; frontend pod &#20013;&#30340;&#38236;&#20687;</span>
kubectl rolling-update frontend-v1 frontend-v2 --rollback <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36864;&#20986;&#24050;&#23384;&#22312;&#30340;&#36827;&#34892;&#20013;&#30340;&#28378;&#21160;&#26356;&#26032;</span>
cat pod.json | kubectl replace -f - <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22522;&#20110; stdin &#36755;&#20837;&#30340; JSON &#26367;&#25442; pod</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:1a1a1127-fece-4639-9b55-f520f3dd6e29" class="outline-5">
<h5 id="h:1a1a1127-fece-4639-9b55-f520f3dd6e29">Deployments/Namespaces</h5>
<div class="outline-text-5" id="text-h:1a1a1127-fece-4639-9b55-f520f3dd6e29">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl edit deploy [deploy_name]
[root@master ~]# kubectl delete deploy [deploy_name]
[root@master ~]# kubectl expse deploy [deploy_name] --por=80  -type=NodePort
[root@master ~]# kubectl scale deploy [deploy_name] --repicas=5

kubectl set image deployment/frontend <span style="color: #a0522d;">www</span>=image:v2               <span style="color: #b22222;"># </span><span style="color: #b22222;">&#28378;&#21160;&#26356;&#26032;&#23481;&#22120;"www"&#30340;"frontend"deployment,&#24182;&#19988;&#26356;&#26032;&#38236;&#20687;</span>
kubectl rollout undo deployment/frontend                         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22238;&#36864;&#21040;&#19978;&#19968;&#20010;&#29256;&#26412;&#30340;deploymeny</span>
kubectl rollout status -w deployment/frontend                    <span style="color: #b22222;"># </span><span style="color: #b22222;">&#28378;&#21160;&#35266;&#23519;frontend &#37096;&#32626;&#24773;&#20917;&#65292;&#30452;&#21040;&#23436;&#25104;</span>

kubectl scale deployment/nginx-deploy --relicas=2 -n default  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20020;&#26102;&#29983;&#25928;&#65292;&#37325;&#24314;yaml&#21518;pod&#25968;&#20462;&#22797;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36890;&#36807;json&#25968;&#32452;&#26469;&#31105;&#29992;deployment&#30340;livenessProbe &#23646;&#24615;</span>
kubectl patch deployment valid-deployment  --type json   -p=<span style="color: #8b2252;">'[{"op": "remove", "path": "/spec/template/spec/containers/0/livenessProbe"}]'</span>


kubectl autoscale deployment foo --min=2 --max=10                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33258;&#21160;&#25193;&#23637;&#37096;&#32626; foo</span>
kubectl autoscale deployment/nginx-deploymen --min=2 --max=5 --cpu-percent=50 -n default
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#33258;&#21160;&#25193;&#23481;&#25351;&#23450;deployment&#30340;pod&#25968;&#37327;&#65292;&#24403;pod&#30340;cpu&#36164;&#28304;&#21033;&#29992;&#29575;&#36798;&#21040;50%&#65292;&#26368;&#22823;pod&#25968;&#37327;&#25193;&#23481;&#21040;5&#20010;&#65292;&#26368;&#23567;2&#20010;pod&#25968;&#37327;</span>

[root@master ~]# kubectl delete ns 
[root@master ~]# kubectl edit ns [ns_name]
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5855b447-2d1c-4753-a7e9-a4237992f63a" class="outline-5">
<h5 id="h:5855b447-2d1c-4753-a7e9-a4237992f63a">Services</h5>
<div class="outline-text-5" id="text-h:5855b447-2d1c-4753-a7e9-a4237992f63a">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl edit svc [svc_name]
[root@master ~]# kubectl delete svc [svc_name]

kubectl edit svc/docker-registry                      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#32534;&#36753;&#19968;&#20010;docker-registry&#30340;&#26381;&#21153;</span>
<span style="color: #a0522d;">KUBE_EDITOR</span>=<span style="color: #8b2252;">"nano"</span> kubectl edit svc/docker-registry   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;&#26367;&#20195;&#32534;&#36753;&#22120;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:58f60629-e99c-4230-b275-efb7774286a1" class="outline-5">
<h5 id="h:58f60629-e99c-4230-b275-efb7774286a1">DaemonSets</h5>
<div class="outline-text-5" id="text-h:58f60629-e99c-4230-b275-efb7774286a1">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl edit ds [ds_name] -n kube-system
[root@master ~]# kubectl delete ds [ds_name]
</pre>
</div>
</div>
</div>
<div id="outline-container-h:57da0910-eb53-49a3-938f-5ad3e93feb1e" class="outline-5">
<h5 id="h:57da0910-eb53-49a3-938f-5ad3e93feb1e">Service Accounts</h5>
<div class="outline-text-5" id="text-h:57da0910-eb53-49a3-938f-5ad3e93feb1e">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl edit sa [sa_name]
[root@master ~]# kubectl delete sa [sa_name]

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;&#26032;&#20803;&#32032;&#28155;&#21152;&#21040;&#25351;&#23450;&#20301;&#32622;</span>
kubectl patch sa default --type=<span style="color: #8b2252;">'json'</span> -p=<span style="color: #8b2252;">'[{"op": "add", "path": "/secrets/1", "value": {"name": "whatever" } }]'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2a18028f-8aaf-47d4-ac8b-15f0e3bea3c1" class="outline-5">
<h5 id="h:2a18028f-8aaf-47d4-ac8b-15f0e3bea3c1">Annotate</h5>
<div class="outline-text-5" id="text-h:2a18028f-8aaf-47d4-ac8b-15f0e3bea3c1">
<div class="org-src-container">
<pre class="src src-sh">kubectl annotate po [pod_name] [annotation]
kubectl autoscale deployment foo --min=2 --max=10                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33258;&#21160;&#25193;&#23637;&#37096;&#32626; foo</span>
kubectl annotate no [node_name]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#  </span><span style="color: #b22222;">&#24378;&#21046;&#26367;&#25442;&#65292;&#21024;&#38500;&#28982;&#21518;&#37325;&#24314;&#36164;&#28304;&#65292;&#36825;&#20010;&#25805;&#20316;&#20250;&#23548;&#33268;&#26381;&#21153;&#20013;&#26029;</span>
kubectl replace --force -f ./pod.json
</pre>
</div>
</div>
</div>
<div id="outline-container-h:34ef25c8-5cbf-4521-aefa-a568fcd91399" class="outline-5">
<h5 id="h:34ef25c8-5cbf-4521-aefa-a568fcd91399">hpa</h5>
<div class="outline-text-5" id="text-h:34ef25c8-5cbf-4521-aefa-a568fcd91399">
<div class="org-src-container">
<pre class="src src-sh">kubectl --kubeconfig=/root/xuchangwei/config_qa -n english-qa  patch hpa english-etp-race-mqtt -p <span style="color: #8b2252;">'{"spec":{"minReplicas":'"$a"'}}'</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:8a00d652-f174-4bdb-aea7-4ae706604dd0" class="outline-4">
<h4 id="h:8a00d652-f174-4bdb-aea7-4ae706604dd0">扩展资源</h4>
<div class="outline-text-4" id="text-h:8a00d652-f174-4bdb-aea7-4ae706604dd0">
<div class="org-src-container">
<pre class="src src-sh">kubectl scale --replicas=3 rs/foo                                 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;&#19968;&#20010;&#21517;&#20026;foo&#30340;&#36164;&#28304;&#21103;&#26412;&#21464;&#20026;3</span>
kubectl scale --replicas=3 -f foo.yaml                            <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;foo.yml&#20013;&#25351;&#23450;&#30340;&#36164;&#28304;&#21464;&#20026;3</span>
kubectl scale --current-replicas=2 --replicas=3 deployment/mysql  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22914;&#26524;&#21517;&#20026;mysql&#30340;deployment&#24403;&#21069;&#21103;&#26412;&#20026;2&#65292;&#21017;&#25193;&#23637;&#20026;3</span>
kubectl scale --replicas=5 rc/foo rc/bar rc/baz                   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25511;&#21046;&#22810;&#20010;rc &#21464;&#20026;5&#20010;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2b31aa5b-3f60-4eb2-b527-14727f9abbc5" class="outline-4">
<h4 id="h:2b31aa5b-3f60-4eb2-b527-14727f9abbc5">删除资源</h4>
<div class="outline-text-4" id="text-h:2b31aa5b-3f60-4eb2-b527-14727f9abbc5">
<div class="org-src-container">
<pre class="src src-sh">kubectl delete -f ./pod.json                                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36890;&#36807;&#29305;&#23450;&#30340;pod.json &#21024;&#38500;pod</span>
kubectl delete pod,service baz foo                                        <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;&#21517;&#23383;&#20026;baz&#21644;foo&#30340;pods&#21644;services</span>
kubectl delete pods,services -l <span style="color: #a0522d;">name</span>=myLabel                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;label&#20026;myLabel&#30340;pods&#21644;services</span>
kubectl delete pods,services -l <span style="color: #a0522d;">name</span>=myLabel --include-uninitialized      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;label&#20026;myLabel&#24182;&#19988;&#27809;&#26377;&#21021;&#22987;&#21270;&#30340;pods&#21644;services</span>
kubectl -n my-ns delete po,svc --all                                      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;my-ns&#21629;&#21517;&#31354;&#38388;&#19979;&#30340;&#25152;&#26377;&#26410;&#21021;&#22987;&#21270;&#30340;pods&#21644;services</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;&#19982;pattern1&#21644;pattern2&#21305;&#37197;&#30340;pods</span>
kubectl get pods  -n mynamespace --no-headers=true | awk <span style="color: #8b2252;">'/pattern1|pattern2/{print $1}'</span> | xargs  kubectl delete -n mynamespace pod
</pre>
</div>
</div>
</div>
<div id="outline-container-h:42e52388-4e88-4a5f-9ee1-af87db0c9689" class="outline-4">
<h4 id="h:42e52388-4e88-4a5f-9ee1-af87db0c9689">与正在运行的pod交互</h4>
<div class="outline-text-4" id="text-h:42e52388-4e88-4a5f-9ee1-af87db0c9689">
<div class="org-src-container">
<pre class="src src-sh">kubectl logs my-pod                                 <span style="color: #b22222;"># </span><span style="color: #b22222;">dump pod&#30340;&#26085;&#24535;&#65288;&#25511;&#21046;&#21488;&#36755;&#20986;&#65289;</span>
kubectl logs -l <span style="color: #a0522d;">name</span>=myLabel                        <span style="color: #b22222;"># </span><span style="color: #b22222;">dump label&#20026;myLabel&#30340;pod&#30340;&#26085;&#24535;&#65288;&#25511;&#21046;&#21488;&#36755;&#20986;&#65289;</span>
kubectl logs my-pod --previous                      <span style="color: #b22222;"># </span><span style="color: #b22222;">dump pod &#21069;&#19968;&#20010;&#29256;&#26412;&#23481;&#22120;&#23454;&#20363;&#21270;&#30340;&#26085;&#24535;&#65288;&#25511;&#21046;&#21488;&#36755;&#20986;&#65289;</span>
kubectl logs my-pod -c my-container                 <span style="color: #b22222;"># </span><span style="color: #b22222;">dump pod&#30340;&#23481;&#22120;&#26085;&#24535;</span>
kubectl logs -l <span style="color: #a0522d;">name</span>=myLabel -c my-container        <span style="color: #b22222;"># </span><span style="color: #b22222;">dump label&#20026;myLabel&#30340;pod&#30340;&#26085;&#24535;&#65288;&#25511;&#21046;&#21488;&#36755;&#20986;&#65289;</span>
kubectl logs my-pod -c my-container --previous      <span style="color: #b22222;"># </span><span style="color: #b22222;">dump pod &#21069;&#19968;&#20010;&#29256;&#26412;&#23481;&#22120;&#23454;&#20363;&#21270;&#30340;&#26085;&#24535;&#65288;&#25511;&#21046;&#21488;&#36755;&#20986;&#65289;</span>
kubectl logs -f my-pod                              <span style="color: #b22222;"># </span><span style="color: #b22222;">dump pod&#30340;&#26085;&#24535;&#65288;&#25511;&#21046;&#21488;&#36755;&#20986;&#65289;</span>
kubectl logs -f my-pod -c my-container              <span style="color: #b22222;"># </span><span style="color: #b22222;">dump pod&#30340;&#23481;&#22120;&#26085;&#24535;</span>
kubectl logs -f -l <span style="color: #a0522d;">name</span>=myLabel --all-containers    <span style="color: #b22222;"># </span><span style="color: #b22222;">dump &#25152;&#26377;&#26631;&#31614;&#20026;myLabel&#30340;pod&#25152;&#26377;&#26085;&#24535;</span>

kubectl run -i --tty busybox --image=busybox -- sh  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;pod&#20316;&#20026;&#20132;&#20114;&#24335;shell&#36816;&#34892;</span>
kubectl attach my-pod -i                            <span style="color: #b22222;"># </span><span style="color: #b22222;">&#38468;&#21152;&#21040;&#36816;&#34892;&#23481;&#22120;</span>
kubectl port-forward my-pod 5000:6000               <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#26412;&#22320;&#35745;&#31639;&#26426;&#19978;&#20390;&#21548;&#31471;&#21475;5000&#24182;&#36716;&#21457;&#21040;my-pod&#19978;&#30340;&#31471;&#21475;6000</span>
kubectl exec my-pod -- ls /                         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#29616;&#26377;pod&#20013;&#36816;&#34892;&#21629;&#21517;&#65288;&#19968;&#20010;&#23481;&#22120;&#30340;&#24773;&#20917;&#65289;</span>
kubectl exec my-pod -c my-container -- ls /         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#29616;&#26377;pod&#20013;&#26576;&#20010;&#23481;&#22120;&#36816;&#34892;&#21629;&#21517;&#65288;&#22810;&#20010;&#23481;&#22120;&#30340;&#24773;&#20917;&#65289;</span>

kubectl exec -ti &lt;pod-name&gt; -c &lt;container-name&gt; /bin/bash  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36890;&#36807;bash&#33719;&#24471;Pod&#20013;&#26576;&#20010;&#23481;&#22120;&#30340;TTY&#65292;&#30456;&#24403;&#20110;&#30331;&#38470;&#23481;&#22120;&#65306;</span>
kubectl top pod POD_NAME --containers               <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#32473;&#23450;pod&#21450;&#20854;&#23481;&#22120;&#30340;metrics</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:8fbcc7dc-5e87-4063-b1f1-78a266a949c9" class="outline-4">
<h4 id="h:8fbcc7dc-5e87-4063-b1f1-78a266a949c9">与节点集群交互</h4>
<div class="outline-text-4" id="text-h:8fbcc7dc-5e87-4063-b1f1-78a266a949c9">
<div class="org-src-container">
<pre class="src src-sh">kubectl cordon my-node                                                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;my-node&#26631;&#35760;&#20026;&#19981;&#21487;&#35843;&#24230;</span>
kubectl drain my-node                                                 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#28165;&#31354;my-node&#20197;&#20934;&#22791;&#32500;&#25252;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39537;&#36880;&#24050;&#32463;&#36816;&#34892;&#30340;&#19994;&#21153;&#23481;&#22120;</span>
kubectl drain --ignore-daemonsets --delete-local-data k8s-node-1

kubectl uncordon my-node                                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;my-node&#26631;&#35760;&#20026;&#21487;&#35843;&#24230;</span>
kubectl top node my-node                                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23637;&#31034;&#25351;&#23450;my-node&#30340;metrics</span>
kubectl cluster-info                                                  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23637;&#31034;master&#33410;&#28857;&#20197;&#21450;services&#30340;&#22320;&#22336;</span>
kubectl cluster-info dump                                             <span style="color: #b22222;"># </span><span style="color: #b22222;">dump &#24403;&#21069;&#38598;&#32676;&#20998;&#25903;&#30340;&#29366;&#24577;</span>
kubectl cluster-info dump --output-directory=/path/to/cluster-state   <span style="color: #b22222;"># </span><span style="color: #b22222;">dump &#24403;&#21069;&#38598;&#32676;&#20998;&#25903;&#30340;&#29366;&#24577;&#21040;/path/to/cluster-state</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22914;&#26524;&#24050;&#23384;&#22312;&#20855;&#26377;&#35813;key&#21644;&#25928;&#26524;&#30340;&#23646;&#24615;&#65292;&#21017;&#20854;&#20540;&#23558;&#25353;&#25351;&#23450;&#26367;&#25442;&#12290;</span>
kubectl taint nodes foo <span style="color: #a0522d;">dedicated</span>=special-user:NoSchedule

&#22914;&#26524;&#24819;&#21024;&#38500;node &#33410;&#28857;&#65292;&#21017;&#36827;&#34892;&#36825;&#20010;&#27493;&#39588;
kubectl delete node k8s-node-1
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2cd25d58-bdda-4fe2-ab2c-23284c19b245" class="outline-4">
<h4 id="h:2cd25d58-bdda-4fe2-ab2c-23284c19b245">资源类型</h4>
<div class="outline-text-4" id="text-h:2cd25d58-bdda-4fe2-ab2c-23284c19b245">
<div class="org-src-container">
<pre class="src src-sh">kubectl api-resources &#21015;&#20986;&#25152;&#26377;&#25903;&#25345;&#30340;&#36164;&#28304;&#31867;&#22411;&#21450;&#20854;&#30701;&#21517;&#31216;&#65292;API&#32452;&#65292;&#26159;&#21542;&#20026;&#21629;&#21517;&#31354;&#38388;&#65292;&#20197;&#21450;Kind
kubectl api-resources --namespaced=true      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25152;&#26377;&#30340;&#21629;&#21517;&#31354;&#38388;&#36164;&#28304;</span>
kubectl api-resources --namespaced=false     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25152;&#26377;&#38750;&#21629;&#21517;&#31354;&#38388;&#36164;&#28304;</span>
kubectl api-resources -o name                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36755;&#20986;&#31616;&#21333;&#30340;&#25152;&#26377;&#36164;&#28304;&#65288;&#21482;&#26159;&#36164;&#28304;&#21517;&#31216;&#65289;</span>
kubectl api-resources -o wide                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25193;&#23637;&#36164;&#28304;&#23637;&#31034;&#30340;&#20869;&#23481;</span>
kubectl api-resources --verbs=list,get       <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25903;&#25345;&#8220;list&#8221;&#21644;&#8220;get&#8221;&#35831;&#27714;&#21160;&#35789;&#30340;&#25152;&#26377;&#36164;&#28304;</span>
kubectl api-resources --api-group=extensions <span style="color: #b22222;"># </span><span style="color: #b22222;">&#8220;extensions&#8221;API&#32452;&#20013;&#30340;&#25152;&#26377;&#36164;&#28304;</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">kubectl api-resources -o wide</span>
NAME                              SHORTNAMES   APIGROUP                       NAMESPACED   KIND                             VERBS
bindings                                                                      true         Binding                          [create]
componentstatuses                 cs                                          false        ComponentStatus                  [get list]
configmaps                        cm                                          true         ConfigMap                        [create delete deletecollection get list patch update watch]
endpoints                         ep                                          true         Endpoints                        [create delete deletecollection get list patch update watch]
events                            ev                                          true         Event                            [create delete deletecollection get list patch update watch]
limitranges                       limits                                      true         LimitRange                       [create delete deletecollection get list patch update watch]
namespaces                        ns                                          false        Namespace                        [create delete get list patch update watch]
</pre>
</div>
</div>
</div>
<div id="outline-container-h:00c9645f-c029-4d0a-9443-722459354b67" class="outline-4">
<h4 id="h:00c9645f-c029-4d0a-9443-722459354b67">Requests //请求</h4>
<div class="outline-text-4" id="text-h:00c9645f-c029-4d0a-9443-722459354b67">
</div>
<div id="outline-container-h:eac11a0d-a96a-40e2-b83e-f206d07e409b" class="outline-5">
<h5 id="h:eac11a0d-a96a-40e2-b83e-f206d07e409b">API Call</h5>
<div class="outline-text-5" id="text-h:eac11a0d-a96a-40e2-b83e-f206d07e409b">
<div class="org-src-container">
<pre class="src src-sh">[root@master ~]# kubectl get --raw /apis/metrics.k8s.io/
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-h:85a80de8-3b47-409c-87dd-123759ccbeed" class="outline-3">
<h3 id="h:85a80de8-3b47-409c-87dd-123759ccbeed">别名</h3>
<div class="outline-text-3" id="text-h:85a80de8-3b47-409c-87dd-123759ccbeed">
<p>
常用
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcn</span>=<span style="color: #8b2252;">'kubectl config set-context $(</span><span style="color: #ff00ff;">kubectl config current-context</span><span style="color: #8b2252;">) --namespace'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgp</span>=<span style="color: #8b2252;">'kubectl get pods'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">ka</span>=<span style="color: #8b2252;">'kubectl apply -f'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">ke</span>=<span style="color: #8b2252;">'kubectl exec -ti'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgpa</span>=<span style="color: #8b2252;">'kubectl get pods --all-namespaces'</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">cdg</span>=<span style="color: #8b2252;">'cd /data/prod-k8s/'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">cp</span>=<span style="color: #8b2252;">'cp -i'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">egrep</span>=<span style="color: #8b2252;">'egrep --color=auto'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">fgrep</span>=<span style="color: #8b2252;">'fgrep --color=auto'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">grep</span>=<span style="color: #8b2252;">'grep --color=auto'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">k</span>=<span style="color: #8b2252;">'kubectl'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kaf</span>=<span style="color: #8b2252;">'kubectl apply -f'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kca</span>=<span style="color: #8b2252;">'f(){ kubectl "$@" --all-namespaces;  unset -f f; }; f'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kccc</span>=<span style="color: #8b2252;">'kubectl config current-context'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcd</span>=<span style="color: #8b2252;">'kubectl config set-context $(</span><span style="color: #ff00ff;">kubectl config current-context</span><span style="color: #8b2252;">) --namespace'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcdc</span>=<span style="color: #8b2252;">'kubectl config delete-context'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcg</span>=<span style="color: #8b2252;">'k config get-contexts'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcgc</span>=<span style="color: #8b2252;">'kubectl config get-contexts'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcn</span>=<span style="color: #8b2252;">'kubectl config set-context $(</span><span style="color: #ff00ff;">kubectl config current-context</span><span style="color: #8b2252;">) --namespace'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">dev_ns</span>=<span style="color: #8b2252;">'export K8S_NAMESPACE=dev-wallet'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcp</span>=<span style="color: #8b2252;">'kubectl cp'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcsc</span>=<span style="color: #8b2252;">'kubectl config set-context'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcu</span>=<span style="color: #8b2252;">'k config use-context'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kcuc</span>=<span style="color: #8b2252;">'kubectl config use-context'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kd</span>=<span style="color: #8b2252;">'kubectl describe'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdcm</span>=<span style="color: #8b2252;">'kubectl describe configmap'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdd</span>=<span style="color: #8b2252;">'kubectl describe deployment'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdel</span>=<span style="color: #8b2252;">'kubectl delete'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdelcm</span>=<span style="color: #8b2252;">'kubectl delete configmap'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdeld</span>=<span style="color: #8b2252;">'kubectl delete deployment'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdelf</span>=<span style="color: #8b2252;">'kubectl delete -f'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdeli</span>=<span style="color: #8b2252;">'kubectl delete ingress'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdelno</span>=<span style="color: #8b2252;">'kubectl delete node'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdelns</span>=<span style="color: #8b2252;">'kubectl delete namespace'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdelp</span>=<span style="color: #8b2252;">'kubectl delete pods'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdelpvc</span>=<span style="color: #8b2252;">'kubectl delete pvc'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdels</span>=<span style="color: #8b2252;">'kubectl delete svc'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdelsec</span>=<span style="color: #8b2252;">'kubectl delete secret'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdelss</span>=<span style="color: #8b2252;">'kubectl delete statefulset'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdi</span>=<span style="color: #8b2252;">'kubectl describe ingress'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdno</span>=<span style="color: #8b2252;">'kubectl describe node'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdns</span>=<span style="color: #8b2252;">'kubectl describe namespace'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdp</span>=<span style="color: #8b2252;">'kubectl describe pods'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdpvc</span>=<span style="color: #8b2252;">'kubectl describe pvc'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kds</span>=<span style="color: #8b2252;">'kubectl describe svc'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdsec</span>=<span style="color: #8b2252;">'kubectl describe secret'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kdss</span>=<span style="color: #8b2252;">'kubectl describe statefulset'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">ke</span>=<span style="color: #8b2252;">'kubectl edit'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kecm</span>=<span style="color: #8b2252;">'kubectl edit configmap'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">ked</span>=<span style="color: #8b2252;">'kubectl edit deployment'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kei</span>=<span style="color: #8b2252;">'kubectl edit ingress'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">keno</span>=<span style="color: #8b2252;">'kubectl edit node'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kens</span>=<span style="color: #8b2252;">'kubectl edit namespace'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kep</span>=<span style="color: #8b2252;">'kubectl edit pods'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kepvc</span>=<span style="color: #8b2252;">'kubectl edit pvc'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kes</span>=<span style="color: #8b2252;">'kubectl edit svc'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kess</span>=<span style="color: #8b2252;">'kubectl edit statefulset'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">keti</span>=<span style="color: #8b2252;">'kubectl exec -ti'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kg</span>=<span style="color: #8b2252;">'kubectl get'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kga</span>=<span style="color: #8b2252;">'kubectl get all'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgaa</span>=<span style="color: #8b2252;">'kubectl get all --all-namespaces'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgap</span>=<span style="color: #8b2252;">'kubectl get pods --all-namespaces'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgc</span>=<span style="color: #8b2252;">'kubectl get configmap'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgcm</span>=<span style="color: #8b2252;">'kubectl get configmaps'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgd</span>=<span style="color: #8b2252;">'kubectl get deployment'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgdw</span>=<span style="color: #8b2252;">'kgd --watch'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgdwide</span>=<span style="color: #8b2252;">'kgd -o wide'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgi</span>=<span style="color: #8b2252;">'kubectl get ingress'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgm</span>=<span style="color: #8b2252;">'kubectl get servicemonitor'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgn</span>=<span style="color: #8b2252;">'kubectl get namespace'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgno</span>=<span style="color: #8b2252;">'kubectl get nodes'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgns</span>=<span style="color: #8b2252;">'kubectl get namespaces'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgp</span>=<span style="color: #8b2252;">'kubectl get pods'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgpa</span>=<span style="color: #8b2252;">'kubectl get pods --all-namespaces'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgpl</span>=<span style="color: #8b2252;">'kgp -l'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgpvc</span>=<span style="color: #8b2252;">'kubectl get pvc'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgpvcw</span>=<span style="color: #8b2252;">'kgpvc --watch'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgpw</span>=<span style="color: #8b2252;">'kgp --watch'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgpwide</span>=<span style="color: #8b2252;">'kgp -o wide'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgrs</span>=<span style="color: #8b2252;">'kubectl get rs'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgs</span>=<span style="color: #8b2252;">'kubectl get service'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgsec</span>=<span style="color: #8b2252;">'kubectl get secret'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgss</span>=<span style="color: #8b2252;">'kubectl get statefulset'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgssw</span>=<span style="color: #8b2252;">'kgss --watch'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgsswide</span>=<span style="color: #8b2252;">'kgss -o wide'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgsw</span>=<span style="color: #8b2252;">'kgs --watch'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kgswide</span>=<span style="color: #8b2252;">'kgs -o wide'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kl</span>=<span style="color: #8b2252;">'kubectl logs'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">klf</span>=<span style="color: #8b2252;">'kubectl logs -f'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kp</span>=<span style="color: #8b2252;">'kubectl port-forward'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">krh</span>=<span style="color: #8b2252;">'kubectl rollout history'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">krsd</span>=<span style="color: #8b2252;">'kubectl rollout status deployment'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">krsss</span>=<span style="color: #8b2252;">'kubectl rollout status statefulset'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kru</span>=<span style="color: #8b2252;">'kubectl rollout undo'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">ksd</span>=<span style="color: #8b2252;">'kubectl scale deployment'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">ksss</span>=<span style="color: #8b2252;">'kubectl scale statefulset'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">kx</span>=<span style="color: #8b2252;">'kubectl exec'</span>
<span style="color: #483d8b;">alias</span> l.=<span style="color: #8b2252;">'ls -d .* --color=auto'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">ll</span>=<span style="color: #8b2252;">'ls -l --color=auto'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">ls</span>=<span style="color: #8b2252;">'ls --color=auto'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">mv</span>=<span style="color: #8b2252;">'mv -i'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">pull_prod_k8s</span>=<span style="color: #8b2252;">'git pull origin master'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">rm</span>=<span style="color: #8b2252;">'rm -i'</span>
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">which</span>=<span style="color: #8b2252;">'alias | /usr/bin/which --tty-only --read-alias --show-dot --show-tilde'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:f55bdc02-dc9a-4bc0-9c92-f48a30f88e12" class="outline-3">
<h3 id="h:f55bdc02-dc9a-4bc0-9c92-f48a30f88e12">集群升级</h3>
<div class="outline-text-3" id="text-h:f55bdc02-dc9a-4bc0-9c92-f48a30f88e12">
<p>
参考：<a href="https://www.xujun.org/note-136772.html">https://www.xujun.org/note-136772.html</a>
</p>

<p>
安装 kubectl convert 插件 地址：<a href="https://kubernetes.io/releases/download/">https://kubernetes.io/releases/download/</a>
</p>

<p>
使用： 例如，将旧的 Ingress 定义转换为 networking.k8s.io/v1，可以运行：
</p>

<div class="org-src-container">
<pre class="src src-sh">kubectl convert -f ./legacy-ingress.yaml --output-version networking.k8s.io/v1
</pre>
</div>

<p>
自动转换使用了一种类似于 Kubernetes
控制平面更新对象的技术，这些对象最初是使用旧 API
版本创建的。因为这是一个机械转换，你可能需要进去改变清单来调整默认值等等。
</p>
</div>
</div>
<div id="outline-container-h:ae6ff05b-918c-4950-ac51-177d54c867c4" class="outline-3">
<h3 id="h:ae6ff05b-918c-4950-ac51-177d54c867c4">参考文档</h3>
<div class="outline-text-3" id="text-h:ae6ff05b-918c-4950-ac51-177d54c867c4">
<ul class="org-ul">
<li><a href="https://kubernetes.io/docs/reference/kubectl/overview/">https://kubernetes.io/docs/reference/kubectl/overview/</a></li>
<li>华为云<a href="https://support.huaweicloud.com/basics-cce/kubernetes.html">https://support.huaweicloud.com/basics-cce/kubernetes.html</a></li>
</ul>
</div>
</div>
</section>
</div>
<div id="postamble" class="status">
    <div class=bar data-astro-cid-p3givckg>
        <div class=list data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:gnuemacs height=1em viewBox="0 0 24 24" width=1em>
                    <title>emacs</title>
                    <symbol id=ai:simple-icons:gnuemacs>
                        <path d="M12 24C5.448 24 .118 18.617.118 12S5.448 0 12 0s11.882 5.383 11.882 12S18.552 24 12 24zM12 .661C5.813.661.779 5.748.779 12S5.813 23.339 12 23.339S23.221 18.253 23.221 12S18.187.661 12 .661zM8.03 20.197s.978.069 2.236-.042c.51-.045 2.444-.235 3.891-.552c0 0 1.764-.377 2.707-.725c.987-.364 1.524-.673 1.766-1.11c-.011-.09.074-.408-.381-.599c-1.164-.488-2.514-.4-5.185-.457c-2.962-.102-3.948-.598-4.472-.997c-.503-.405-.25-1.526 1.907-2.513c1.086-.526 5.345-1.496 5.345-1.496c-1.434-.709-4.109-1.955-4.659-2.224c-.482-.236-1.254-.591-1.421-1.021c-.19-.413.448-.768.804-.87c1.147-.331 2.766-.536 4.24-.56c.741-.012.861-.059.861-.059c1.022-.17 1.695-.869 1.414-1.976c-.252-1.13-1.579-1.795-2.84-1.565c-1.188.217-4.05 1.048-4.05 1.048c3.539-.031 4.131.028 4.395.398c.156.218-.071.518-1.015.672c-1.027.168-3.163.37-3.163.37c-2.049.122-3.492.13-3.925 1.046c-.283.599.302 1.129.558 1.46c1.082 1.204 2.646 1.853 3.652 2.331c.379.18 1.49.52 1.49.52c-3.265-.18-5.619.823-7.001 1.977c-1.562 1.445-.871 3.168 2.33 4.228c1.891.626 2.828.921 5.648.667c1.661-.09 1.923-.036 1.939.1c.023.192-1.845.669-2.355.816c-1.298.374-4.699 1.129-4.716 1.133z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:gnuemacs></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Emacs</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:org height=1em viewBox="0 0 24 24" width=1em>
                    <title>org-mode</title>
                    <symbol id=ai:simple-icons:org>
                        <path d="M17.169 0c-.566.004-2.16 3.312-3.376 5.94a2.19 2.19 0 0 1-.408-1.267c-.03-.582-1.089.237-.936 1.275c-.068-.035-1.26.227-1.26.23c-.23-.93-.802-1.618-1.15-.563c-.701 1.663-.88 2.984.115 4.585c-.908 4.058-6.948 6.053-6.32 9.33c.175.004 1.634 3.48 6.337 2.057c5.557-1.577 8.624 2.116 8.978 2.375c.52.526-1.348-4.573-5.302-6.865c-2.339-1.276-.87-3.474-.703-4.25c0 0 1.874 1.312 3.232-.692c1.227.316 2.05-.224 3.105.158c.64.28 3.336.11 2.334-1.396c-.148.129.07.27-.075.46c-.043.056-.128.232-.408.315c-.314.149-.83.27-1.43-.37c-.434-.32-.748-.04-.992-.063c.152-.098.577-.315 1.264-.315c.388 0 .594.336.854.338c.174 0 .685-.262.787-.365c.63-.41.697-.278 1.012-.905c.17-.759-.215-.92-.332-1.129c-.032-.483-.436-.67-.919-.326c-1.106-.198-2.192-.105-2.728-.15c-1.175-.164-2.153-.786-2.153-.786c.143-.19.075-.6-.842-.628c-.315-.104-.45-.2-.745-.307c.61-1.37.674-2.007 1.418-4.004c.261-1.053 1.039-2.685.643-2.682zm-4.297 8.093c.03-.086.443.138.952.176c.395.03.805.048 1.296-.025c.03-.005.172.095-.15.194c-.02.01-.062-.01-.065.196c0 .022-.01.04-.02.046c-.15.152-.708.223-1.065.1c-.436-.17-.482-.316-.517-.443c-.305-.147-.47-.123-.43-.244zM9.685 10.2C8.86 9 8.929 8.36 8.96 7.256C7.961 8.288 6.855 8.3 5.18 8.58c-1.299.234-3.657 2.447-4.025 4.742c-.043.608-.08 2.183.424 3.498c.492 1.13.828 1.727 1.844 2.335c-.882-3.169 5.296-5.33 6.263-8.955z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:org></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Orgmode</p>
                </div>
            </span>
            <a href=/donations.html class=entry data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:astro height=1em viewBox="0 0 24 24" width=1em>
                    <title>Donations</title>
                    <symbol id=ai:simple-icons:astro>
                        <path d="M8.358 20.162c-1.186-1.07-1.532-3.316-1.038-4.944c.856 1.026 2.043 1.352 3.272 1.535c1.897.283 3.76.177 5.522-.678c.202-.098.388-.229.608-.36c.166.473.209.95.151 1.437c-.14 1.185-.738 2.1-1.688 2.794c-.38.277-.782.525-1.175.787c-1.205.804-1.531 1.747-1.078 3.119l.044.148a3.158 3.158 0 0 1-1.407-1.188a3.31 3.31 0 0 1-.544-1.815c-.004-.32-.004-.642-.048-.958c-.106-.769-.472-1.113-1.161-1.133c-.707-.02-1.267.411-1.415 1.09c-.012.053-.028.104-.045.165h.002zm-5.961-4.445s3.24-1.575 6.49-1.575l2.451-7.565c.092-.366.36-.614.662-.614c.302 0 .57.248.662.614l2.45 7.565c3.85 0 6.491 1.575 6.491 1.575L16.088.727C15.93.285 15.663 0 15.303 0H8.697c-.36 0-.615.285-.784.727l-5.516 14.99z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:astro></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>打赏</p>
                </div>
            </span>
            </a>
            <span class=entry data-astro-cid-p3givckg>
                <svg xmlns="http://www.w3.org/2000/svg" class=heading data-astro-cid-p3givckg data-icon=simple-icons:copyright width="1em" height="1em" viewBox="0 0 24 24">
                    <title>Copyright</title>
                    <path fill="currentColor" d="M19 2a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3zm-5 5h-4a1 1 0 0 0-1 1l.007.117A1 1 0 0 0 10 9h3v5a1 1 0 0 1-1.993.117L11 14a1 1 0 0 0-2 0a3 3 0 0 0 6 0V8a1 1 0 0 0-1-1" />
                    <use xlink:href=#ai:simple-icons:copyright></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>© 2025 Jasper Hsu</p>
                </div>
            </span>
        </div>
        <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ class="list license" data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Creative Commons</title>
                    <symbol id=ai:fa6-brands:creative-commons>
                        <path d="m245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93c-22.13 0-33.22 14.61-33.22 43.84c0 23.57 9.21 43.84 33.22 43.84c14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98c-22.6 0-73.96-10.32-73.96-77.05c0-58.69 43-77.06 72.63-77.06c30.72-.01 52.7 11.95 65.99 35.86zm143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93c-22.14 0-33.22 14.61-33.22 43.84c0 23.55 9.23 43.84 33.22 43.84c14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98c-22.69 0-73.96-9.87-73.96-77.05c0-58.67 42.97-77.06 72.63-77.06c30.71-.01 52.58 11.95 65.56 35.86zM247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248c129.93 0 248.44-100.87 248.44-248c0-137.87-106.62-248-248.44-248zm.87 450.81c-112.54 0-203.7-93.04-203.7-202.81c0-105.42 85.43-203.27 203.72-203.27c112.53 0 202.82 89.46 202.82 203.26c-.01 121.69-99.68 202.82-202.84 202.82z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Creative Commons</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-by height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Attribute</title>
                    <symbol id=ai:fa6-brands:creative-commons-by>
                        <path d="M314.9 194.4v101.4h-28.3v120.5h-77.1V295.9h-28.3V194.4c0-4.4 1.6-8.2 4.6-11.3c3.1-3.1 6.9-4.7 11.3-4.7H299c4.1 0 7.8 1.6 11.1 4.7c3.1 3.2 4.8 6.9 4.8 11.3zm-101.5-63.7c0-23.3 11.5-35 34.5-35s34.5 11.7 34.5 35c0 23-11.5 34.5-34.5 34.5s-34.5-11.5-34.5-34.5zM247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256C0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8c103.2 0 202.8-81.1 202.8-202.8c.1-113.8-90.2-203.3-202.8-203.3z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-by></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Attribute</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-nc height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Noncommercial</title>
                    <symbol id=ai:fa6-brands:creative-commons-nc>
                        <path d="M247.6 8C387.4 8 496 115.9 496 256c0 147.2-118.5 248-248.4 248C113.1 504 0 393.2 0 256C0 123.1 104.7 8 247.6 8zM55.8 189.1c-7.4 20.4-11.1 42.7-11.1 66.9c0 110.9 92.1 202.4 203.7 202.4c122.4 0 177.2-101.8 178.5-104.1l-93.4-41.6c-7.7 37.1-41.2 53-68.2 55.4v38.1h-28.8V368c-27.5-.3-52.6-10.2-75.3-29.7l34.1-34.5c31.7 29.4 86.4 31.8 86.4-2.2c0-6.2-2.2-11.2-6.6-15.1c-14.2-6-1.8-.1-219.3-97.4zM248.4 52.3c-38.4 0-112.4 8.7-170.5 93l94.8 42.5c10-31.3 40.4-42.9 63.8-44.3v-38.1h28.8v38.1c22.7 1.2 43.4 8.9 62 23L295 199.7c-42.7-29.9-83.5-8-70 11.1c53.4 24.1 43.8 19.8 93 41.6l127.1 56.7c4.1-17.4 6.2-35.1 6.2-53.1c0-57-19.8-105-59.3-143.9c-39.3-39.9-87.2-59.8-143.6-59.8z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-nc></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Noncommercial</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-sa height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Share Alike</title>
                    <symbol id=ai:fa6-brands:creative-commons-sa>
                        <path d="M247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256C0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8c103.2 0 202.8-81.1 202.8-202.8c.1-113.8-90.2-203.3-202.8-203.3zM137.7 221c13-83.9 80.5-95.7 108.9-95.7c99.8 0 127.5 82.5 127.5 134.2c0 63.6-41 132.9-128.9 132.9c-38.9 0-99.1-20-109.4-97h62.5c1.5 30.1 19.6 45.2 54.5 45.2c23.3 0 58-18.2 58-82.8c0-82.5-49.1-80.6-56.7-80.6c-33.1 0-51.7 14.6-55.8 43.8h18.2l-49.2 49.2l-49-49.2h19.4z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-sa></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Share Alike</p>
                </div>
            </span>
        </a>
    </div>
<!--
<script type="text/javascript" src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/bootstrap@5.2.1/dist/js/bootstrap.min.js"></script>
<div id="back-to-top" class=""><svg viewBox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg></div>
-->
</div>
</body>
</html>
