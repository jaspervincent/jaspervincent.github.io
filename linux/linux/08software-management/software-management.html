<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Linux: è½¯ä»¶ç®¡ç†</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/static/font.css"/>
<link rel="stylesheet" type="text/css" href="/static/drollery.e825b870.css"/>
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="me" href="https://emacs.ch/@jasperhsu">
<meta name="google-adsense-account" content="ca-pub-1741779893655624">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1741779893655624" crossorigin="anonymous"></script>
</head>
<body>
<header id="preamble" class="status">
<header class="{className}" data-astro-cid-3ef6ksr2>
  <div class=header-branding data-astro-cid-g2lrb5xm>
      <span class=header-text data-astro-cid-g2lrb5xm>
          <span class=dropcap data-astro-cid-g2lrb5xm aria-hidden=true>
              <span class=actual data-astro-cid-g2lrb5xm>J</span>
              <span class=rest data-astro-cid-g2lrb5xm>asper Hsu</span>
              <span class=period data-astro-cid-g2lrb5xm>.</span>
          </span>
          <span class=sr-only data-astro-cid-g2lrb5xm>Drollery</span>
      </span>
      <img alt="Medieval drollery of a knight on a horse" class=spring decoding=async height=250 loading=lazy src=/images/knight-horse.a96eee7d_Z1WCOYs.webp width=68 data-astro-cid-g2lrb5xm>
  </div>

  <nav data-astro-cid-pux6a34n>
      <span class=flower2 data-astro-cid-pux6a34n>M</span>
      <a href=/jcodelog.html class=nobracket data-astro-cid-pux6a34n>æŠ€æœ¯</a>
      <span class=flower2 data-astro-cid-pux6a34n>K</span>
      <a href=/reading/index.html class=nobracket data-astro-cid-pux6a34n>é˜…è¯»</a>
      <span class=flower2 data-astro-cid-pux6a34n>J</span>
      <a href=/archives.html class=nobracket data-astro-cid-pux6a34n>å½’æ¡£</a>
      <span class=flower2 data-astro-cid-pux6a34n>L</span>
      <a href=/link/index.html class=nobracket data-astro-cid-pux6a34n>å‹é“¾</a>
      <span class=flower2 data-astro-cid-pux6a34n>M</span>
      <a href=/about.html class=nobracket data-astro-cid-pux6a34n>å…³äº</a>
      <span class=flower2 data-astro-cid-pux6a34n>J</span>
  </nav>


  <div class="container" data-astro-cid-3ef6ksr2>
    <p class="info" data-astro-cid-3ef6ksr2>
              ğŸ† æ¬¢è¿æ¥åˆ°æœ¬ç«™ï¼š
              <a href="https://xuchangwei.com/">https://xuchangwei.com/</a>ã€‚
              <strong>å¸Œæœ›è¿™é‡Œæœ‰ä½ æ„Ÿå…´è¶£çš„å†…å®¹</strong>ã€‚
            </p>
  </div>
  <div id=borderArtWrapper class="tt1" data-astro-cid-5hce7sga data-turbo-permanent>
      <script>
          var man, shakeCount = 0, noSound = new Audio("/audio/effects/no.m4a"), screamSound = new Audio("/audio/effects/scream.m4a");
          function animateManShakeHandler() {
              man.removeEventListener("animationend", animateManShakeHandler, !1),
              shakeCount += 1,
              man.classList.remove("shakeMan")
          }
          function animateManFallHandler() {
              man.removeEventListener("animationend", animateManFallHandler, !1),
              man.classList.add("hide")
          }
          function animateMan() {
              man = man ?? document.getElementById("borderMan"),
              3 === shakeCount ? (man.classList.add("fallMan"),
              screamSound.play(),
              man.addEventListener("animationend", animateManFallHandler, !1)) : (man.classList.add("shakeMan"),
              noSound.play(),
              man.addEventListener("animationend", animateManShakeHandler, !1))
          }
      </script>
      <div class=borderArt data-astro-cid-5dda5nwp id=articleBorder>
          <img alt="flowery border with man falling" decoding=async height=620 loading=lazy src=/images/border-vines-no-man.b7d246cc_DRxSe.webp width=909 class=border data-astro-cid-5dda5nwp>
          <div class=fallWrapper data-astro-cid-5dda5nwp>
              <img alt="flowery border with man falling" decoding=async height=292 loading=lazy src=/images/man-no-vines.247a3187_Z2ioXNM.webp width=98 class=man data-astro-cid-5dda5nwp id=borderMan onclick=animateMan()>
          </div>
      </div>
  </div>
</header>
</header>
<main class="container" id="content" class="content">
<header>
<h1 class="title">Linux: è½¯ä»¶ç®¡ç†</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#h:837d61c9-5033-4b42-8399-74678df98576">è½¯ä»¶è¿è¡Œå’Œç¼–è¯‘</a>
<ul>
<li><a href="#h:b43402c6-743d-4e7d-9043-e060cff006b8">è½¯ä»¶ç›¸å…³æ¦‚å¿µ</a>
<ul>
<li><a href="#h:a2ffd68e-cc23-4d23-bdc9-183d86e70fd9">ABI</a></li>
<li><a href="#h:bf4a4c6a-fb66-4de7-accd-43cf585d1372">API</a></li>
<li><a href="#h:c44af887-f3d5-4664-a9c6-c12f7728a3c8">å¼€å‘è¯­è¨€</a></li>
</ul>
</li>
<li><a href="#h:47ac1fdc-c97d-4b12-835a-eaaba90f1ead">Cè¯­è¨€ç¨‹åºçš„å®ç°è¿‡ç¨‹</a></li>
<li><a href="#h:bb7c01e2-b92b-415f-a84b-9fd0ed59ddee">è½¯ä»¶æ¨¡å—çš„é™æ€å’ŒåŠ¨æ€é“¾æ¥</a>
<ul>
<li><a href="#h:7fcf09d9-4a42-4751-b037-b0fd9ef035a0">é™æ€é“¾æ¥</a></li>
<li><a href="#h:9928cc67-d25c-4fe9-9c2c-407e7806cd09">åŠ¨æ€é“¾æ¥</a></li>
<li><a href="#h:f6abc1a5-4710-4cbb-ae19-e47644be48b9">æ¨¡å—ï¼ˆåº“ï¼‰æ–‡ä»¶</a></li>
</ul>
</li>
<li><a href="#h:338bf581-ed67-4143-b71e-81d55906d115">Javaç¨‹åºç¼–è¯‘è¿è¡Œè¿‡ç¨‹</a></li>
</ul>
</li>
<li><a href="#h:6c25e601-3718-486b-b6b7-8e04b22f1059">è½¯ä»¶åŒ…å’ŒåŒ…ç®¡ç†å™¨</a>
<ul>
<li><a href="#h:c262c8f6-4488-446e-ad59-2bbc630cb2c5">è½¯ä»¶åŒ…ä»‹ç»</a>
<ul>
<li><a href="#h:d806e1a5-d451-414c-aead-787f0d601002">è½¯ä»¶åŒ…ä¸­çš„æ–‡ä»¶åˆ†ç±»</a></li>
<li><a href="#h:a6a13cef-6563-45f6-9e9c-1b0d15f955e0">ç¨‹åºåŒ…ç®¡ç†å™¨</a></li>
<li><a href="#h:f945dcd0-56cb-4234-9149-9856990a3964">åŒ…å‘½å</a></li>
<li><a href="#h:479cbf80-b900-4140-82bb-4d9409db95d7">åˆ†ç±»å’Œæ‹†åŒ…</a></li>
<li><a href="#h:88e272c8-31ce-49d9-9e6f-8f656f72e8e4">åŒ…çš„ä¾èµ–</a></li>
<li><a href="#h:08dae7f9-2a64-40ec-88ee-25e4e1abbd90">ç¨‹åºåŒ…ç®¡ç†å™¨ç›¸å…³æ–‡ä»¶</a></li>
<li><a href="#h:c31ee92c-a0b4-4955-b1f1-23b06ce5662a">è·å–ç¨‹åºåŒ…çš„é€”å¾„</a>
<ul>
<li><a href="#h:e9916de8-6d62-4f17-8191-91295e0a8b6d">ç³»ç»Ÿå‘ç‰ˆçš„å…‰ç›˜æˆ–å®˜æ–¹ç½‘ç«™</a></li>
<li><a href="#h:6eaae818-a901-4e66-9b8c-37d4cbe8deb5">ç¬¬ä¸‰æ–¹ç»„ç»‡æä¾›</a></li>
<li><a href="#h:88846cc1-fb66-4d36-95dc-b6ac467f83dc">è½¯ä»¶é¡¹ç›®å®˜æ–¹ç«™ç‚¹</a></li>
<li><a href="#h:1f246c51-9b36-441e-af80-863893fbb1fc">æœç´¢å¼•æ“</a></li>
<li><a href="#h:9f6c3bdd-50d7-4e0c-82a7-7bf3be6bb9ba">è‡ªå·±åˆ¶ä½œ</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:67ed83cd-a5d7-4cc4-ba8d-a431570b2139">åŒ…ç®¡ç†å™¨rpm</a>
<ul>
<li><a href="#h:544cfc17-9ebc-43bb-802a-6b9d8a08ae54">å®‰è£…</a></li>
<li><a href="#h:82ea39a9-0903-4506-8c27-c5d61877a629">å‡çº§å’Œé™çº§</a></li>
<li><a href="#h:ce35e207-58c6-4949-a16c-c0a4afa6598b">åŒ…æŸ¥è¯¢</a></li>
<li><a href="#h:2e24402e-9d33-404d-95da-ae3ca93125b4">åŒ…å¸è½½</a></li>
<li><a href="#h:52014c9c-cf3c-43cf-bedd-6a0d097ce478">åŒ…æ ¡éªŒ</a></li>
<li><a href="#h:5c158fee-1dc8-41e6-a4de-de581a78f60b">æ•°æ®åº“</a></li>
</ul>
</li>
<li><a href="#h:328e7c58-986e-4291-ad14-c020117983a8">yumå’Œdnf</a>
<ul>
<li><a href="#h:41183e23-91dd-4eda-9734-10455d42a144">yum/dnf å·¥ä½œåŸç†</a></li>
<li><a href="#h:11f69a5b-babf-4133-b4eb-7b4b6f01878b">yumå®¢æˆ·ç«¯é…ç½®</a>
<ul>
<li><a href="#h:443242a3-12c4-42aa-9396-05141e1888f1">/etc/yum.confä¸»é…ç½®å®šä¹‰</a></li>
<li><a href="#h:352c0b6b-420b-46fa-a986-0414b2618646">ä»“åº“(*.repo)é…ç½®æ–‡ä»¶å®šä¹‰ï¼š</a></li>
<li><a href="#h:dffb8357-f15a-4707-8041-e1dfc59eb216">yum-config-managerå‘½ä»¤</a></li>
<li><a href="#h:c7e0b143-26b2-45bc-b851-f853ccc21c09">é”å®šè½¯ä»¶ç‰ˆæœ¬</a></li>
</ul>
</li>
<li><a href="#h:cba0e6bc-ecc7-4dea-8806-52951d45d63d">yumå‘½ä»¤</a>
<ul>
<li><a href="#h:20020b7b-fb37-458f-b470-ae93033ae661">æ˜¾ç¤ºä»“åº“åˆ—è¡¨</a></li>
<li><a href="#h:f767d76f-2dc8-46ea-adb4-e68dbf531e2c">æ˜¾ç¤ºç¨‹åºåŒ…</a></li>
<li><a href="#h:8cb17a52-2951-42a3-9c8d-357901b3c0ea">å®‰è£…ç¨‹åºåŒ…</a>
<ul>
<li><a href="#h:b76289ec-56f5-4271-8f29-d98e13b0b6a8">èŒƒä¾‹ï¼šåªä¸‹è½½ä¸å®‰è£…</a></li>
<li><a href="#h:c02ccb31-a0ec-4eb5-a1e3-f735f0c6a8b9">èŒƒä¾‹ï¼šåˆ©ç”¨elrepoæºåœ¨CentOS 7 å®‰è£…æ–°ç‰ˆå†…æ ¸</a></li>
</ul>
</li>
<li><a href="#h:51a5b9e4-4811-42d8-8cd1-e76b78b9ca69">å¸è½½ç¨‹åºåŒ…</a></li>
<li><a href="#h:27b4acc9-5922-4c70-bef0-866b76a21596">å‡çº§å’Œé™çº§</a></li>
<li><a href="#h:f3fc4561-2146-4283-989c-0f8b847073d7">æŸ¥è¯¢</a></li>
<li><a href="#h:d11b2a47-813a-4c05-ac3e-3718aaf92fea">ä»“åº“ç¼“å­˜</a></li>
<li><a href="#h:3cdce67e-9825-4c88-b953-f7c3d77cd8f0">æŸ¥çœ‹yumäº‹åŠ¡å†å²</a></li>
<li><a href="#h:151e618d-41f2-4296-86ea-800111925875">å®‰è£…åŠå‡çº§æœ¬åœ°ç¨‹åºåŒ…</a></li>
<li><a href="#org656766f">æŸ¥çœ‹åŒ…çš„å®‰å…¨è­¦æŠ¥</a></li>
<li><a href="#h:1b3ff4a3-da51-4184-ab6d-b6328f171bdc">åŒ…ç»„ç®¡ç†çš„ç›¸å…³å‘½ä»¤</a></li>
<li><a href="#h:63ec964a-bb5a-4faa-bbf7-475adcaac0e5">å®ç°ç§ç”¨ yumä»“åº“</a></li>
<li><a href="#h:1a95dba4-44af-4866-b38a-9044eab803b2">DNF ä»‹ç»</a></li>
<li><a href="#h:d84bb7d7-5799-403e-aa93-4e95aec4f6c4">yum Troubleshooting</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:ee8702e2-25dc-4096-bf4d-210aae3a906f">ç¨‹åºåŒ…ç¼–è¯‘</a>
<ul>
<li><a href="#h:f64a6f08-63d6-41ce-870b-83b12f331e66">æºç ç¼–è¯‘ä»‹ç»</a></li>
<li><a href="#h:df05665b-8680-4c49-9de8-0d9361484ae0">å¼€æºç¨‹åºæºä»£ç çš„è·å–</a></li>
<li><a href="#h:7a2c0189-8b82-4238-bf01-d8a8bd14a162">ç¼–è¯‘æºç çš„é¡¹ç›®å·¥å…·</a></li>
<li><a href="#h:5eadb370-44cc-4855-ad66-9f9fa91194d1">Cè¯­è¨€æºä»£ç ç¼–è¯‘å®‰è£…è¿‡ç¨‹</a>
<ul>
<li><a href="#h:241bf723-dd84-498b-99b6-3965c0954a2d">ç¼–è¯‘å®‰è£…å‡†å¤‡</a></li>
<li><a href="#h:e9d3886c-10ff-4f0f-9ee4-1a8f08c88f61">ç¼–è¯‘å®‰è£…</a></li>
<li><a href="#h:cde24117-8fde-47ef-b0f3-8ff0ceccf999">å®‰è£…åçš„é…ç½®</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:4b3e2142-78a3-4377-8161-6562169c891f">Ubuntu è½¯ä»¶ç®¡ç†</a>
<ul>
<li><a href="#h:643f7863-e72b-4023-8f8c-5bbfa5f6918e">APTå·¥ä½œåŸç†</a></li>
<li><a href="#h:da743a3f-8cc6-4931-90b8-6c0820731b2f">dpkg åŒ…ç®¡ç†å™¨</a></li>
<li><a href="#h:49de8721-b2df-4089-a65e-eb1c700e1d30">apt</a></li>
<li><a href="#h:b78fb7e2-f822-4cc3-9092-f15e593aa560">è½¯ä»¶ç®¡ç†æ¡ˆä¾‹</a></li>
<li><a href="#h:1371b82f-9dfa-4557-9b0c-871c42e2563c">ubuntuå»ºè®®å®‰è£…çš„å¸¸ç”¨åŒ…</a></li>
</ul>
</li>
<li><a href="#h:549bdb1f-b5e7-4961-9f37-ce8737d8e46f">rpmåŒ…åˆ¶ä½œ</a>
<ul>
<li><a href="#h:70e2bbad-37db-483a-a457-8e5e11c9bab2">å¿«é€Ÿåˆ¶ä½œRPM</a>
<ul>
<li><a href="#h:0e7e9b7d-d09c-48dd-84c2-f2221f059407">å¿«é€Ÿåˆ¶ä½œRPM</a>
<ul>
<li><a href="#h:1959d010-332c-490e-ba63-c9e7e317a5c2">å‡†å¤‡åˆ¶ä½œRPMåŒ…</a></li>
<li><a href="#h:db3f3648-9db8-4f63-952d-ad166c48a817">è§„åˆ’RPMåŒ…</a></li>
<li><a href="#h:e0ea36fb-22a8-4926-a5b8-00442c34a2bb">è§£é‡Šåˆ¶ä½œçš„è¿‡ç¨‹</a></li>
<li><a href="#h:3b0b7809-1fe4-40a0-bc15-d49ce8786416">å¦‚ä½•ä½¿ç”¨åˆ¶ä½œçš„ç›¸å…³æ–‡ä»¶</a></li>
<li><a href="#h:1584f173-f06f-4d64-a854-f0e7a932f2f0">éªŒè¯ç»“æœ</a></li>
</ul>
</li>
<li><a href="#h:6b808e24-eef0-4d91-8414-9b51bb7273ad">å†™ä¸€ä¸ªSpecæ–‡ä»¶</a>
<ul>
<li><a href="#h:c15db9cb-7564-4dc3-9278-0eca504bb8e7">specæ–‡ä»¶è¯­æ³•æ ¼å¼</a></li>
<li><a href="#h:9c55a872-4868-4243-a019-1308cc292365">å®šä¹‰åŒ…çš„ä¿¡æ¯</a></li>
<li><a href="#h:42781958-7adc-403b-a4f1-26e786113853">æ§åˆ¶ç¼–è¯‘å®‰è£…è¿‡ç¨‹</a></li>
<li><a href="#h:6d5fea45-2645-4a6b-a345-0cc3ecceb9b0">è„šæœ¬æ®µ</a></li>
<li><a href="#h:93f62913-31a8-4197-b70d-3477fdbcfde5">æ–‡ä»¶æ®µï¼Œåˆ—å‡ºçš„æ–‡ä»¶ %files</a></li>
<li><a href="#h:21eb0f66-bbf0-4c4a-a165-a169bd9a21d7">changlogæ”¹å˜æ—¥å¿—æ®µ %changelog</a></li>
<li><a href="#h:a118878a-0abc-4706-b96a-f9234488bb64">å¦‚ä½•åœ¨specæ–‡ä»¶ä¸­ä½¿ç”¨å®</a></li>
</ul>
</li>
<li><a href="#h:9aea5127-5c75-4cc8-93ae-7d4ea62ba8c5">RPMåŒ…ç­¾å</a></li>
<li><a href="#h:0a27839a-f3b4-42b2-8a3a-dc002bddcd71">RPMæ‹†åŒ…</a>
<ul>
<li><a href="#h:eb9ce5f0-b998-4060-84f3-0c421a94d2f7">å¿…é€‰åŠŸèƒ½æ®µ</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:fc8d1de9-cc97-4253-aafa-2a0f8b29582b">FPM</a>
<ul>
<li><a href="#h:2543eea9-0288-4092-ba76-427cee89f04b">FPMæ‰“åŒ…å·¥å…·</a></li>
<li><a href="#h:c1bc70c3-5442-4fdf-90e2-c39bc6284be2">ä½¿ç”¨å®ä¾‹&#x2013;å®æˆ˜å®šåˆ¶nginxçš„RPMåŒ…</a></li>
<li><a href="#h:0cdf247a-b567-496d-8712-ea7b743045c3">æ³¨æ„äº‹é¡¹</a></li>
<li><a href="#h:bf21d0dc-57ca-42cd-8d0e-9df143577cdd">å®šåˆ¶LNMPçš„RPMåŒ…æ€è·¯</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav>
<ul class="org-ul">
<li>TAGS: <a href="../../index.html">Linux</a></li>
</ul>

<p>
æ‘˜è¦ï¼šæœ¬æ–‡ä»‹ç»è½¯ä»¶ç®¡ç†
</p>

<p>
å†…å®¹æ¦‚è¿°
</p>

<ul class="org-ul">
<li>è½¯ä»¶è¿è¡Œç¯å¢ƒ</li>
<li>è½¯ä»¶åŒ…åŸºç¡€</li>
<li>rpmåŒ…ç®¡ç†</li>
<li>yumå’Œdnf ç®¡ç†</li>
<li>å®šåˆ¶yumä»“åº“</li>
<li>ç¼–è¯‘å®‰è£…</li>
<li>Ubuntuè½¯ä»¶ç®¡ç†</li>
</ul>
<section id="outline-container-h:837d61c9-5033-4b42-8399-74678df98576" class="outline-2">
<h2 id="h:837d61c9-5033-4b42-8399-74678df98576">è½¯ä»¶è¿è¡Œå’Œç¼–è¯‘</h2>
<div class="outline-text-2" id="text-h:837d61c9-5033-4b42-8399-74678df98576">
</div>
<div id="outline-container-h:b43402c6-743d-4e7d-9043-e060cff006b8" class="outline-3">
<h3 id="h:b43402c6-743d-4e7d-9043-e060cff006b8">è½¯ä»¶ç›¸å…³æ¦‚å¿µ</h3>
<div class="outline-text-3" id="text-h:b43402c6-743d-4e7d-9043-e060cff006b8">

<figure id="orgddc2806">
<img src="images/image-20210216014134231.png" alt="image-20210216014134231.png" width="80%">

</figure>



<figure id="orge4b50b9">
<img src="images/image-20210216014154510.png" alt="image-20210216014154510.png" width="80%">

</figure>
</div>
<div id="outline-container-h:a2ffd68e-cc23-4d23-bdc9-183d86e70fd9" class="outline-4">
<h4 id="h:a2ffd68e-cc23-4d23-bdc9-183d86e70fd9">ABI</h4>
<div class="outline-text-4" id="text-h:a2ffd68e-cc23-4d23-bdc9-183d86e70fd9">
<p>
ABIå³ Application Binary Interface
</p>


<p>
Windowsä¸Linuxä¸å…¼å®¹
</p>

<ul class="org-ul">
<li>ELF(Executable and Linkable Format)</li>
<li>PEï¼ˆPortable Executableï¼‰</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">[root@test ~]# file /bin/hostname
/bin/hostname: ELF 64-bit LSB pie executable, ARM aarch64, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux-aarch64.so.1, <span style="color: #a0522d;">BuildID</span>[sha1]=26daeb4dffa6a2e15eb287407e656a762927380b, for GNU/Linux 3.7.0, stripped

</pre>
</div>

<p>
åº“çº§åˆ«çš„è™šæ‹ŸåŒ–ï¼š
</p>

<ul class="org-ul">
<li>Linux: WINE</li>
<li>Windows: Cygwin</li>
</ul>
</div>
</div>
<div id="outline-container-h:bf4a4c6a-fb66-4de7-accd-43cf585d1372" class="outline-4">
<h4 id="h:bf4a4c6a-fb66-4de7-accd-43cf585d1372">API</h4>
<div class="outline-text-4" id="text-h:bf4a4c6a-fb66-4de7-accd-43cf585d1372">
<p>
APIå³Application Programming Interfaceï¼ŒAPIå¯ä»¥åœ¨å„ç§ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Š
å®ç°ç»™åº”ç”¨ç¨‹åºæä¾›å®Œå…¨ç›¸åŒçš„æ¥å£ï¼Œè€Œå®ƒä»¬æœ¬èº«åœ¨è¿™äº›ç³»ç»Ÿä¸Šçš„å®ç°å´å¯èƒ½è¿¥
å¼‚ï¼Œä¸»æµçš„æ“ä½œç³»ç»Ÿæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯Windowsç³»ç»Ÿï¼Œå¦ä¸€ç§æ˜¯Linuxç³»ç»Ÿã€‚ç”±äºæ“
ä½œç³»ç»Ÿçš„ä¸åŒï¼ŒAPIåˆåˆ†ä¸ºWindows APIå’ŒLinux APIã€‚åœ¨Windowså¹³å°å¼€å‘å‡ºæ¥çš„
è½¯ä»¶åœ¨Linuxä¸Šæ— æ³•è¿è¡Œï¼Œåœ¨Linuxä¸Šå¼€å‘çš„è½¯ä»¶åœ¨Windowsä¸Šåˆæ— æ³•è¿è¡Œï¼Œè¿™å°±
å¯¼è‡´äº†è½¯ä»¶ç§»æ¤å›°éš¾ï¼ŒPOSIXæ ‡å‡†çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜
</p>

<p>
POSIXï¼šPortable Operating System Interfaceå¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£ï¼Œå®šä¹‰äº†æ“
ä½œç³»ç»Ÿåº”è¯¥ä¸ºåº”ç”¨ç¨‹åºæä¾›çš„æ¥å£æ ‡å‡†ï¼Œæ˜¯IEEEä¸ºè¦åœ¨å„ç§UNIXæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œ
çš„è½¯ä»¶è€Œå®šä¹‰çš„ä¸€ç³»åˆ—APIæ ‡å‡†çš„æ€»ç§°ã€‚Linuxå’Œwindowséƒ½è¦å®ç°åŸºæœ¬çš„posixæ ‡
å‡†ï¼Œç¨‹åºå°±åœ¨æºä»£ç çº§åˆ«å¯ç§»æ¤äº†
</p>
</div>
</div>
<div id="outline-container-h:c44af887-f3d5-4664-a9c6-c12f7728a3c8" class="outline-4">
<h4 id="h:c44af887-f3d5-4664-a9c6-c12f7728a3c8">å¼€å‘è¯­è¨€</h4>
<div class="outline-text-4" id="text-h:c44af887-f3d5-4664-a9c6-c12f7728a3c8">
<p>
ç³»ç»Ÿçº§å¼€å‘
</p>
<ul class="org-ul">
<li>æ±‡ç¼–è¯­è¨€</li>
<li>C</li>
<li>C++</li>
</ul>

<p>
åº”ç”¨çº§å¼€å‘
</p>
<ul class="org-ul">
<li>java</li>
<li>Python</li>
<li>go</li>
<li>php</li>
<li>perl</li>
<li>delphi</li>
<li>basic</li>
<li>ruby</li>
<li>bash</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:47ac1fdc-c97d-4b12-835a-eaaba90f1ead" class="outline-3">
<h3 id="h:47ac1fdc-c97d-4b12-835a-eaaba90f1ead">Cè¯­è¨€ç¨‹åºçš„å®ç°è¿‡ç¨‹</h3>
<div class="outline-text-3" id="text-h:47ac1fdc-c97d-4b12-835a-eaaba90f1ead">
<p>
C ç¨‹åºæºä»£ç  &#x2013;&gt; é¢„å¤„ç† &#x2013;&gt; ç¼–è¯‘ &#x2013;&gt; æ±‡ç¼– &#x2013;&gt; é“¾æ¥
</p>

<p>
Cè¯­è¨€çš„ç¨‹åºç¼–è¯‘ä¸»è¦ç»è¿‡å››ä¸ªè¿‡ç¨‹ï¼š
</p>



<figure id="orge58b94b">
<img src="images/image-20210216014218324.png" alt="image-20210216014218324.png" width="60%">

</figure>

<ul class="org-ul">
<li>é¢„å¤„ç†ï¼ˆPre-Processingï¼‰
<ol class="org-ol">
<li>å°†æ‰€æœ‰çš„#defineåˆ é™¤ï¼Œå¹¶ä¸”å±•å¼€æ‰€æœ‰çš„å®å®šä¹‰</li>
<li>å¤„ç†æ‰€æœ‰çš„æ¡ä»¶é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œæ¯”å¦‚#if #ifdef #elif #else #endifç­‰</li>
<li>å¤„ç†#include é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œå°†è¢«åŒ…å«çš„æ–‡ä»¶æ’å…¥åˆ°è¯¥é¢„ç¼–è¯‘æŒ‡ä»¤çš„ä½ç½®ã€‚</li>
<li>åˆ é™¤æ‰€æœ‰æ³¨é‡Š "//"å’Œâ€/* */â€œ.</li>
<li>æ·»åŠ è¡Œå·å’Œæ–‡ä»¶æ ‡è¯†ï¼Œä»¥ä¾¿ç¼–è¯‘æ—¶äº§ç”Ÿè°ƒè¯•ç”¨çš„è¡Œå·åŠç¼–è¯‘é”™è¯¯è­¦å‘Šè¡Œå·ã€‚</li>
<li>ä¿ç•™æ‰€æœ‰çš„#pragmaç¼–è¯‘å™¨æŒ‡ä»¤ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦ä½¿ç”¨å®ƒä»¬</li>
</ol></li>

<li><p>
ç¼–è¯‘ ï¼ˆCompilingï¼‰
</p>

<p>
ç¼–è¯‘è¿‡ç¨‹å°±æ˜¯æŠŠé¢„å¤„ç†å®Œçš„æ–‡ä»¶è¿›è¡Œä¸€ç³»åˆ—çš„è¯æ³•åˆ†æï¼Œè¯­æ³•åˆ†æï¼Œè¯­ä¹‰åˆ†æ
åŠä¼˜åŒ–åï¼Œæœ€åç”Ÿæˆç›¸åº”çš„æ±‡ç¼–ä»£ç 
</p></li>

<li><p>
æ±‡ç¼– ï¼ˆAssemblingï¼‰
</p>

<p>
æ±‡ç¼–å™¨æ˜¯å°†æ±‡ç¼–ä»£ç è½¬å˜æˆæœºå™¨å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ¯ä¸€ä¸ªæ±‡ç¼–è¯­å¥å‡ ä¹éƒ½å¯¹åº”
ä¸€æ¡æœºå™¨æŒ‡ä»¤ã€‚æ±‡ç¼–ç›¸å¯¹äºç¼–è¯‘è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œæ ¹æ®æ±‡ç¼–æŒ‡ä»¤å’Œæœºå™¨æŒ‡ä»¤çš„å¯¹
ç…§è¡¨ä¸€ä¸€ç¿»è¯‘å³å¯
</p></li>

<li><p>
é“¾æ¥ ï¼ˆLinkingï¼‰
</p>

<p>
é€šè¿‡è°ƒç”¨é“¾æ¥å™¨ldæ¥é“¾æ¥ç¨‹åºè¿è¡Œéœ€è¦çš„ä¸€å¤§å †ç›®æ ‡æ–‡ä»¶ï¼Œä»¥åŠæ‰€ä¾èµ–çš„å…¶å®ƒ
åº“æ–‡ä»¶ï¼Œæœ€åç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶
</p></li>
</ul>

<p>
èŒƒä¾‹ï¼šgcc ç¼–è¯‘è¿‡ç¨‹
</p>

<div class="org-src-container">
<pre class="src src-sh">cat &lt;&lt;\EOF&gt; hello.c
<span style="color: #ffa54f;">#include &lt;stdio.h&gt;</span>

<span style="color: #ffa54f;">int main(void)</span>
<span style="color: #ffa54f;">{</span>
<span style="color: #ffa54f;">  printf("Hello World!\n");</span>
<span style="color: #ffa54f;">}</span>
<span style="color: #ffa54f;">EOF</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#27493;&#39588;&#32534;&#35793;&#36816;&#34892;</span>
gcc -E hello.c -o hello.i  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23545;hello.c&#25991;&#20214;&#36827;&#34892;&#39044;&#22788;&#29702;&#65292;&#29983;&#25104;&#20102;hello.i &#25991;&#20214;</span>
gcc -S hello.i -o hello.s  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23545;&#39044;&#22788;&#29702;&#25991;&#20214;&#36827;&#34892;&#32534;&#35793;&#65292;&#29983;&#25104;&#20102;&#27719;&#32534;&#25991;&#20214;</span>
gcc -c hello.s -o hello.o  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23545;&#27719;&#32534;&#25991;&#20214;&#36827;&#34892;&#32534;&#35793;&#65292;&#29983;&#25104;&#20102;&#30446;&#26631;&#25991;&#20214;</span>
gcc hello.o -o hello        <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23545;&#30446;&#26631;&#25991;&#20214;&#36827;&#34892;&#38142;&#25509;&#65292;&#29983;&#25104;&#21487;&#25191;&#34892;&#25991;&#20214;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#19968;&#27493;&#23454;&#29616;&#32534;&#35793;&#36807;&#31243;</span>
gcc hello.c -o hello &#30452;&#25509;&#32534;&#35793;&#38142;&#25509;&#25104;&#21487;&#25191;&#34892;&#30446;&#26631;&#25991;&#20214;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:bb7c01e2-b92b-415f-a84b-9fd0ed59ddee" class="outline-3">
<h3 id="h:bb7c01e2-b92b-415f-a84b-9fd0ed59ddee">è½¯ä»¶æ¨¡å—çš„é™æ€å’ŒåŠ¨æ€é“¾æ¥</h3>
<div class="outline-text-3" id="text-h:bb7c01e2-b92b-415f-a84b-9fd0ed59ddee">
<p>
é“¾æ¥ä¸»è¦ä½œç”¨æ˜¯æŠŠå„ä¸ªæ¨¡å—ä¹‹é—´ç›¸äº’å¼•ç”¨çš„éƒ¨åˆ†å¤„ç†å¥½ï¼Œä½¿å¾—å„ä¸ªæ¨¡å—ä¹‹é—´èƒ½å¤Ÿ
æ­£ç¡®åœ°è¡”æ¥ï¼Œåˆ†ä¸ºé™æ€å’ŒåŠ¨æ€é“¾æ¥
</p>



<figure id="org24a57a1">
<img src="images/image-20210216014234673.png" alt="image-20210216014234673.png" width="60%">

</figure>
</div>
<div id="outline-container-h:7fcf09d9-4a42-4751-b037-b0fd9ef035a0" class="outline-4">
<h4 id="h:7fcf09d9-4a42-4751-b037-b0fd9ef035a0">é™æ€é“¾æ¥</h4>
<div class="outline-text-4" id="text-h:7fcf09d9-4a42-4751-b037-b0fd9ef035a0">
<ul class="org-ul">
<li>æŠŠç¨‹åºå¯¹åº”çš„ä¾èµ–åº“å¤åˆ¶ä¸€ä»½åˆ°åŒ…</li>
<li>ç”Ÿæˆæ¨¡å—æ–‡ä»¶libxxx.a</li>
<li>åµŒå…¥ç¨‹åºåŒ…</li>
<li>å‡çº§éš¾ï¼Œéœ€é‡æ–°ç¼–è¯‘</li>
<li>å ç”¨è¾ƒå¤šç©ºé—´ï¼Œè¿ç§»å®¹æ˜“</li>
</ul>
</div>
</div>
<div id="outline-container-h:9928cc67-d25c-4fe9-9c2c-407e7806cd09" class="outline-4">
<h4 id="h:9928cc67-d25c-4fe9-9c2c-407e7806cd09">åŠ¨æ€é“¾æ¥</h4>
<div class="outline-text-4" id="text-h:9928cc67-d25c-4fe9-9c2c-407e7806cd09">
<ul class="org-ul">
<li>åªæŠŠä¾èµ–åŠ åšä¸€ä¸ªåŠ¨æ€é“¾æ¥</li>
<li>ç”Ÿæˆæ¨¡å—æ–‡ä»¶libxxx.so</li>
<li>è¿æ¥æŒ‡å‘</li>
<li>å ç”¨è¾ƒå°‘ç©ºé—´ï¼Œå‡çº§æ–¹ä¾¿</li>
</ul>

<p>
èŒƒä¾‹ï¼š
</p>
<div class="org-src-container">
<pre class="src src-shell">root@debian:~/.jasper# file hello
hello: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span style="color: #a0522d;">BuildID</span>[sha1]=6d0e42e93b2869fabde6055a1301dd64870fe558, for GNU/Linux 3.2.0, not stripped
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20854;&#20013;  dynamically linked &#34920;&#31034;&#21160;&#24577;&#38142;&#25509;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#31243;&#24207;&#20381;&#36182;&#30340;&#31532;&#19977;&#26041;&#24211; ldd</span>
root@debian:~/.jasper# ldd hello
        linux-vdso.so.1 (0x00007ffdb99b4000)  <span style="color: #b22222;">#</span><span style="color: #b22222;">.so &#25991;&#20214; shared object &#20849;&#20139;&#30340;&#23545;&#35937;</span>
        libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f64b021d000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f64b0418000)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:f6abc1a5-4710-4cbb-ae19-e47644be48b9" class="outline-4">
<h4 id="h:f6abc1a5-4710-4cbb-ae19-e47644be48b9">æ¨¡å—ï¼ˆåº“ï¼‰æ–‡ä»¶</h4>
<div class="outline-text-4" id="text-h:f6abc1a5-4710-4cbb-ae19-e47644be48b9">
<p>
æŸ¥çœ‹äºŒè¿›åˆ¶ç¨‹åºæ‰€ä¾èµ–çš„åº“æ–‡ä»¶
</p>

<div class="org-src-container">
<pre class="src src-sh">ldd /PATH/TO/BINARY_FILE
</pre>
</div>

<p>
ç®¡ç†åŠæŸ¥çœ‹æœ¬æœºè£…è½½çš„åº“æ–‡ä»¶
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#21152;&#36733;&#37197;&#32622;&#25991;&#20214;&#20013;&#25351;&#23450;&#30340;&#24211;&#25991;&#20214;</span>
ldconfig

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26174;&#31034;&#26412;&#26426;&#24050;&#32463;&#32531;&#23384;&#30340;&#25152;&#26377;&#21487;&#29992;&#24211;&#25991;&#20214;&#21517;&#21450;&#25991;&#20214;&#36335;&#24452;&#26144;&#23556;&#20851;&#31995;</span>
/sbin/ldconfig &#8211;p
</pre>
</div>

<p>
é…ç½®æ–‡ä»¶ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">/etc/ld.so.conf,
/etc/ld.so.conf.d/*.conf
</pre>
</div>

<p>
èŒƒä¾‹ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">(2) &#23548;&#20986;&#24211;&#25991;&#20214;&#36335;&#24452;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#32534;&#36753;/etc/ld.so.conf.d/NAME.conf   &#28155;&#21152;&#26032;&#30340;&#24211;&#25991;&#20214;&#25152;&#22312;&#30446;&#24405;&#33267;&#27492;&#25991;&#20214;&#20013;&#65307;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35753;&#31995;&#32479;&#37325;&#26032;&#29983;&#25104;&#32531;&#23384;&#65306;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">ldconfig [-v]  #&#35201;&#26174;&#31034;&#36807;&#31243;&#23601;&#21152;-v&#36873;&#39033;</span>
[root@localhost httpd-2.4.18]# cat /etc/ld.so.conf.d/apache2.conf
/usr/local/apache2/lib
[root@localhost httpd-2.4.18]# ldconfig
</pre>
</div>

<p>
ç¼“å­˜æ–‡ä»¶ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">/etc/ld.so.cache
</pre>
</div>

<p>
èŒƒä¾‹ï¼šåº“æ–‡ä»¶ç ´ååï¼Œå°†å¯¼è‡´ä¾èµ–çš„ç¨‹åºæ— æ³•æ­£å¸¸è¿è¡Œ
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#ldd /bin/ls
    linux-vdso.so.1 (0x00007ffc509fd000)
    libselinux.so.1 =&gt; /lib64/libselinux.so.1 (0x00007fc6ef24a000)
    libcap.so.2 =&gt; /lib64/libcap.so.2 (0x00007fc6ef044000)
    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007fc6eec81000)
    libpcre2-8.so.0 =&gt; /lib64/libpcre2-8.so.0 (0x00007fc6ee9fd000)
    libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00007fc6ee7f9000)
    /lib64/ld-linux-x86-64.so.2 (0x00007fc6ef698000)
    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007fc6ee5d9000)

[root@centos8 ~]#ldd /bin/cat
    linux-vdso.so.1 (0x00007ffe335dd000)
    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007fa34749e000)
    /lib64/ld-linux-x86-64.so.2 (0x00007fa347a6b000)
[root@centos8 ~]#mv /lib64/libc.so.6 /tmp
[root@centos8 ~]#ls
ls: error while loading shared libraries: libc.so.6: cannot open shared object
file: No such file or directory
[root@centos8 ~]#cat
cat: error while loading shared libraries: libc.so.6: cannot open shared object
file: No such file or directory

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21160;&#24577;&#25991;&#20214;&#36801;&#31227;</span>
<span style="color: #a020f0;">for</span> i<span style="color: #a020f0;"> in</span> $(ldd /bin/bash | grep -o <span style="color: #8b2252;">'/[^[:space:]]\+[0-9]\&gt;'</span>); <span style="color: #a020f0;">do</span> cp $<span style="color: #a0522d;">i</span> /mnt/sysroot/lib64 ;<span style="color: #a020f0;">done</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:338bf581-ed67-4143-b71e-81d55906d115" class="outline-3">
<h3 id="h:338bf581-ed67-4143-b71e-81d55906d115">Javaç¨‹åºç¼–è¯‘è¿è¡Œè¿‡ç¨‹</h3>
<div class="outline-text-3" id="text-h:338bf581-ed67-4143-b71e-81d55906d115">

<figure id="org2baa5b4">
<img src="images/image-20210216014252395.png" alt="image-20210216014252395.png" width="60%">

</figure>
</div>
</div>
</section>
<section id="outline-container-h:6c25e601-3718-486b-b6b7-8e04b22f1059" class="outline-2">
<h2 id="h:6c25e601-3718-486b-b6b7-8e04b22f1059">è½¯ä»¶åŒ…å’ŒåŒ…ç®¡ç†å™¨</h2>
<div class="outline-text-2" id="text-h:6c25e601-3718-486b-b6b7-8e04b22f1059">
</div>
<div id="outline-container-h:c262c8f6-4488-446e-ad59-2bbc630cb2c5" class="outline-3">
<h3 id="h:c262c8f6-4488-446e-ad59-2bbc630cb2c5">è½¯ä»¶åŒ…ä»‹ç»</h3>
<div class="outline-text-3" id="text-h:c262c8f6-4488-446e-ad59-2bbc630cb2c5">
<p>
å¼€æºè½¯ä»¶æœ€åˆåªæä¾›äº†.tar.gzçš„æ‰“åŒ…çš„æºç æ–‡ä»¶ï¼Œç”¨æˆ·å¿…é¡»è‡ªå·²ç¼–è¯‘æ¯ä¸ªæƒ³åœ¨
GNU/Linuxä¸Šè¿è¡Œçš„è½¯ä»¶ã€‚ç”¨æˆ·æ€¥éœ€ç³»ç»Ÿèƒ½æä¾›ä¸€ç§æ›´åŠ ä¾¿åˆ©çš„æ–¹æ³•æ¥ç®¡ç†è¿™äº›
è½¯ä»¶ï¼Œå½“Debianè¯ç”Ÿæ—¶ï¼Œè¿™æ ·ä¸€ä¸ªç®¡ç†å·¥å…·dpkgä¹Ÿå°±åº”è¿è€Œç”Ÿï¼Œå¯ç”¨æ¥ç®¡ç†deb
åç¼€çš„â€åŒ…â€æ–‡ä»¶ã€‚ä»è€Œè‘—åçš„â€packageâ€æ¦‚å¿µç¬¬ä¸€æ¬¡å‡ºç°åœ¨GNU/Linuxç³»ç»Ÿä¸­ï¼Œ
ç¨åRed Hatæ‰å¼€å‘è‡ªå·±çš„rpmåŒ…ç®¡ç†ç³»ç»Ÿ
</p>
</div>
<div id="outline-container-h:d806e1a5-d451-414c-aead-787f0d601002" class="outline-4">
<h4 id="h:d806e1a5-d451-414c-aead-787f0d601002">è½¯ä»¶åŒ…ä¸­çš„æ–‡ä»¶åˆ†ç±»</h4>
<div class="outline-text-4" id="text-h:d806e1a5-d451-414c-aead-787f0d601002">
<ul class="org-ul">
<li>äºŒè¿›åˆ¶æ–‡ä»¶</li>
<li>åº“æ–‡ä»¶</li>
<li>é…ç½®æ–‡ä»¶</li>
<li>å¸®åŠ©æ–‡ä»¶</li>
</ul>

<p>
èŒƒä¾‹ï¼šåˆ©ç”¨ cpioå·¥å…·æŸ¥çœ‹åŒ…æ–‡ä»¶åˆ—è¡¨
</p>
<div class="org-src-container">
<pre class="src src-sh">rpm2cpio &#21253;&#25991;&#20214;|cpio &#8211;itv              <span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#35272;&#21253;&#20869;&#25991;&#20214;</span>
rpm2cpio &#21253;&#25991;&#20214;|cpio &#8211;id <span style="color: #8b2252;">"*.conf"</span>  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#37322;&#25918;&#21253;&#20869;&#25991;&#20214;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">rpm2cpio jenkins-2.222.1-1.1.noarch.rpm  | cpio -itv</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a6a13cef-6563-45f6-9e9c-1b0d15f955e0" class="outline-4">
<h4 id="h:a6a13cef-6563-45f6-9e9c-1b0d15f955e0">ç¨‹åºåŒ…ç®¡ç†å™¨</h4>
<div class="outline-text-4" id="text-h:a6a13cef-6563-45f6-9e9c-1b0d15f955e0">
<p>
è½¯ä»¶åŒ…ç®¡ç†å™¨åŠŸèƒ½ï¼šå°†ç¼–è¯‘å¥½çš„åº”ç”¨ç¨‹åºçš„å„ç»„æˆæ–‡ä»¶æ‰“åŒ…ä¸€ä¸ªæˆ–å‡ ä¸ªç¨‹åºåŒ…æ–‡
ä»¶ï¼Œåˆ©ç”¨åŒ…ç®¡ç†å™¨å¯ä»¥æ–¹ä¾¿å¿«æ·åœ°å®ç°ç¨‹åºåŒ…çš„å®‰è£…ã€å¸è½½ã€æŸ¥è¯¢ã€å‡çº§å’Œæ ¡éªŒ
ç­‰ç®¡ç†æ“ä½œ
</p>

<p>
ä¸»æµçš„ç¨‹åºåŒ…ç®¡ç†å™¨
</p>

<ul class="org-ul">
<li>redhatï¼šrpmæ–‡ä»¶, rpm åŒ…ç®¡ç†å™¨ï¼Œrpmï¼šRedhat Package Managerï¼Œåæ¥å«RPM
Package Manager</li>
<li>debianï¼šdebæ–‡ä»¶, dpkg åŒ…ç®¡ç†å™¨</li>
</ul>
</div>
</div>
<div id="outline-container-h:f945dcd0-56cb-4234-9149-9856990a3964" class="outline-4">
<h4 id="h:f945dcd0-56cb-4234-9149-9856990a3964">åŒ…å‘½å</h4>
<div class="outline-text-4" id="text-h:f945dcd0-56cb-4234-9149-9856990a3964">
<p>
æºä»£ç æ‰“åŒ…æ–‡ä»¶å‘½åï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">name-VERSION.tar.gz|bz2|xz
VERSION: major.minor.release
</pre>
</div>

<p>
rpmåŒ…å‘½åæ–¹å¼ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">name-VERSION-release.arch.rpm
VERSION: major.minor.release
release&#65306;release.OS
</pre>
</div>

<p>
VERSION: major.minor.release
</p>
<ul class="org-ul">
<li>major:ä¸»ç‰ˆæœ¬å·ï¼Œé‡å¤§çš„ç‰ˆæœ¬åˆ†æ”¯</li>
<li>minorï¼šæ¬¡ç‰ˆæœ¬å·ï¼›åŠŸèƒ½æ”¹å˜</li>
<li>releaseï¼šå‘è¡Œå·ï¼›ä¿®å¤bugï¼Œæ›´æ”¹ä¸€å°æ®µä»£ç ï¼›</li>
</ul>

<p>
å¸¸è§çš„archï¼š
</p>

<ul class="org-ul">
<li>x86: i386, i486, i586, i686</li>
<li>x86_64: x64, x86_64, amd64</li>
<li>powerpc: ppc</li>
<li>è·Ÿå¹³å°æ— å…³ï¼šnoarch</li>
</ul>

<p>
èŒƒä¾‹ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">bash-3.2-32.el5_9.1.i386.rpm
bash-4.2.46-19.el7.x86_64.rpm
bash-4.4.19-7.el8.x86_64.rpm
bash-4.4.19-7.el8.aarch64.rpm
bash-4.4.19-7.el8.ppc64le.rpm
bc_1.07.1-2_amd64.deb
bc_1.07.1-2_s390x.deb
</pre>
</div>

<p>
èŒƒä¾‹ï¼šç»Ÿè®¡rpmçš„æ¶æ„ç±»å‹åŠç›¸åº”çš„åŒ…æ•°é‡
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 Packages]#pwd
/misc/cd/BaseOS/Packages
[root@centos8 Packages]#ls *.rpm | grep -Eo <span style="color: #8b2252;">'[^.]+\.rpm$'</span>| grep -Eo <span style="color: #8b2252;">'^[^.]+'</span>|sort |uniq -c
  389 i686
  211 noarch
 1061 x86_64
[root@centos8 Packages]#ls *.rpm |rev|cut -d. -f2|rev |sort |uniq -c
  389 i686
  211 noarch
 1061 x86_64
[root@centos8 Packages]#ls *.rpm | grep -Eo <span style="color: #8b2252;">'[^.]+\.rpm$'</span>|cut -d. -f1|sort |uniq -c
  389 i686
  211 noarch
 1061 x86_64
</pre>
</div>
</div>
</div>
<div id="outline-container-h:479cbf80-b900-4140-82bb-4d9409db95d7" class="outline-4">
<h4 id="h:479cbf80-b900-4140-82bb-4d9409db95d7">åˆ†ç±»å’Œæ‹†åŒ…</h4>
<div class="outline-text-4" id="text-h:479cbf80-b900-4140-82bb-4d9409db95d7">
<p>
è½¯ä»¶åŒ…ä¸ºäº†ç®¡ç†å’Œä½¿ç”¨çš„ä¾¿åˆ©ï¼Œä¼šå°†ä¸€ä¸ªå¤§çš„è½¯ä»¶åˆ†ç±»ï¼Œæ”¾åœ¨ä¸åŒçš„å­åŒ…ä¸­ã€‚
</p>

<p>
åŒ…çš„åˆ†ç±»
</p>

<ul class="org-ul">
<li>Application-VERSION-ARCH.rpm: ä¸»åŒ…</li>
<li>Application-devel-VERSION-ARCH.rpm å¼€å‘å­åŒ…</li>
<li>Application-utils-VERSION-ARHC.rpm å…¶å®ƒå­åŒ…</li>
<li>Application-libs-VERSION-ARHC.rpm å…¶å®ƒå­åŒ…</li>
</ul>
</div>
</div>
<div id="outline-container-h:88e272c8-31ce-49d9-9e6f-8f656f72e8e4" class="outline-4">
<h4 id="h:88e272c8-31ce-49d9-9e6f-8f656f72e8e4">åŒ…çš„ä¾èµ–</h4>
<div class="outline-text-4" id="text-h:88e272c8-31ce-49d9-9e6f-8f656f72e8e4">
<p>
è½¯ä»¶åŒ…ä¹‹é—´å¯èƒ½å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œç”šè‡³å¾ªç¯ä¾èµ–ï¼Œå³ï¼šAåŒ…ä¾èµ–BåŒ…ï¼ŒBåŒ…ä¾èµ–CåŒ…ï¼Œ
CåŒ…ä¾èµ–AåŒ…
</p>

<p>
å®‰è£…è½¯ä»¶åŒ…æ—¶ï¼Œä¼šå› ä¸ºç¼ºå°‘ä¾èµ–çš„åŒ…ï¼Œè€Œå¯¼è‡´å®‰è£…åŒ…å¤±è´¥ã€‚
</p>

<p>
è§£å†³ä¾èµ–åŒ…ç®¡ç†å·¥å…·ï¼š
</p>

<ul class="org-ul">
<li>yumï¼šrpmåŒ…ç®¡ç†å™¨çš„å‰ç«¯å·¥å…·</li>
<li>dnfï¼šFedora 18+ rpmåŒ…ç®¡ç†å™¨å‰ç«¯ç®¡ç†å·¥å…·ï¼ŒCentOS 8 ç‰ˆä»£æ›¿ yum</li>
<li>aptï¼šdebåŒ…ç®¡ç†å™¨å‰ç«¯å·¥å…·</li>
<li>zypperï¼šsuseä¸Šçš„rpmå‰ç«¯ç®¡ç†å·¥å…·</li>
</ul>
</div>
</div>
<div id="outline-container-h:08dae7f9-2a64-40ec-88ee-25e4e1abbd90" class="outline-4">
<h4 id="h:08dae7f9-2a64-40ec-88ee-25e4e1abbd90">ç¨‹åºåŒ…ç®¡ç†å™¨ç›¸å…³æ–‡ä»¶</h4>
<div class="outline-text-4" id="text-h:08dae7f9-2a64-40ec-88ee-25e4e1abbd90">
<ol class="org-ol">
<li>åŒ…æ–‡ä»¶ç»„æˆ (æ¯ä¸ªåŒ…ç‹¬æœ‰)
<ul class="org-ul">
<li>åŒ…å†…çš„æ–‡ä»¶</li>
<li>å…ƒæ•°æ®ï¼Œå¦‚ï¼šåŒ…çš„åç§°ï¼Œç‰ˆæœ¬ï¼Œä¾èµ–æ€§ï¼Œæè¿°ç­‰</li>
<li>å¯èƒ½ä¼šæœ‰åŒ…å®‰è£…æˆ–å¸è½½æ—¶è¿è¡Œçš„è„šæœ¬</li>
</ul></li>

<li>æ•°æ®åº“(å…¬å…±)ï¼š/var/lib/rpm
<ul class="org-ul">
<li>ç¨‹åºåŒ…åç§°åŠç‰ˆæœ¬</li>
<li>ä¾èµ–å…³ç³»</li>
<li>åŠŸèƒ½è¯´æ˜</li>
<li>åŒ…å®‰è£…åç”Ÿæˆçš„å„æ–‡ä»¶è·¯å¾„åŠæ ¡éªŒç ä¿¡æ¯</li>
</ul></li>
</ol>
</div>
</div>
<div id="outline-container-h:c31ee92c-a0b4-4955-b1f1-23b06ce5662a" class="outline-4">
<h4 id="h:c31ee92c-a0b4-4955-b1f1-23b06ce5662a">è·å–ç¨‹åºåŒ…çš„é€”å¾„</h4>
<div class="outline-text-4" id="text-h:c31ee92c-a0b4-4955-b1f1-23b06ce5662a">
<p>
è½¯ä»¶åŒ…éœ€è¦äº‹å…ˆå°†æºç è¿›è¡Œç¼–è¯‘åæ‰“åŒ…å½¢æˆï¼Œè·å–åŒ…çš„é€”å¾„å¦‚ä¸‹ï¼š
</p>
</div>
<div id="outline-container-h:e9916de8-6d62-4f17-8191-91295e0a8b6d" class="outline-5">
<h5 id="h:e9916de8-6d62-4f17-8191-91295e0a8b6d">ç³»ç»Ÿå‘ç‰ˆçš„å…‰ç›˜æˆ–å®˜æ–¹ç½‘ç«™</h5>
<div class="outline-text-5" id="text-h:e9916de8-6d62-4f17-8191-91295e0a8b6d">
<p>
CentOSé•œåƒï¼š
</p>
<ul class="org-ul">
<li><a href="https://www.centos.org/download/">https://www.centos.org/download/</a></li>
<li><a href="http://mirrors.aliyun.com">http://mirrors.aliyun.com</a></li>
<li><a href="http://mirrors.sohu.com">http://mirrors.sohu.com</a></li>
<li><a href="http://mirrors.163.com">http://mirrors.163.com</a></li>
</ul>

<p>
Ubuntu é•œåƒï¼š
</p>

<ul class="org-ul">
<li><a href="http://cdimage.ubuntu.com/releases/">http://cdimage.ubuntu.com/releases/</a></li>
<li><a href="http://releases.ubuntu.com">http://releases.ubuntu.com</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:6eaae818-a901-4e66-9b8c-37d4cbe8deb5" class="outline-5">
<h5 id="h:6eaae818-a901-4e66-9b8c-37d4cbe8deb5">ç¬¬ä¸‰æ–¹ç»„ç»‡æä¾›</h5>
<div class="outline-text-5" id="text-h:6eaae818-a901-4e66-9b8c-37d4cbe8deb5">
<ul class="org-ul">
<li>Fedora-EPELï¼šExtra Packages for Enterprise Linux
<ul class="org-ul">
<li><a href="https://fedoraproject.org/wiki/EPEL">https://fedoraproject.org/wiki/EPEL</a></li>
<li><a href="https://mirrors.aliyun.com/epel/">https://mirrors.aliyun.com/epel/</a></li>
</ul></li>

<li><p>
SCLï¼š Software Collections, æä¾›è¾ƒé«˜ç‰ˆæœ¬çš„ç¬¬ä¸‰æ–¹è½¯ä»¶åŒ…
</p>

<p>
çº¢å¸½å…¬å¸åˆ›å»ºçš„è½¯ä»¶é›†åˆ(SCL)é¡¹ç›®ç«™ç‚¹ <a href="https://wiki.centos.org/SpecialInterestGroup(2f)SCLo.html">https://wiki.centos.org/SpecialInterestGroup(2f)SCLo.html</a>
</p></li>

<li>Community Enterprise Linux Repositoryï¼š<a href="http://www.elrepo.org">http://www.elrepo.org</a>ï¼Œæ”¯æŒ <code>æœ€æ–°çš„å†…æ ¸å’Œç¡¬ä»¶</code> ç›¸å…³åŒ…</li>

<li>Rpmforgeï¼šå®˜ç½‘ï¼š<a href="http://repoforge.org/">http://repoforge.org/</a>ï¼Œ RHELæ¨èï¼ŒåŒ…å¾ˆå…¨ï¼Œå³å°†å…³é—­</li>
</ul>
</div>
</div>
<div id="outline-container-h:88846cc1-fb66-4d36-95dc-b6ac467f83dc" class="outline-5">
<h5 id="h:88846cc1-fb66-4d36-95dc-b6ac467f83dc">è½¯ä»¶é¡¹ç›®å®˜æ–¹ç«™ç‚¹</h5>
<div class="outline-text-5" id="text-h:88846cc1-fb66-4d36-95dc-b6ac467f83dc">
<ul class="org-ul">
<li><a href="http://yum.mariadb.org/10.4/centos8-amd64/rpms/">http://yum.mariadb.org/10.4/centos8-amd64/rpms/</a></li>
<li><a href="http://repo.mysql.com/yum/mysql-8.0-community/el/8/x86_64/">http://repo.mysql.com/yum/mysql-8.0-community/el/8/x86_64/</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:1f246c51-9b36-441e-af80-863893fbb1fc" class="outline-5">
<h5 id="h:1f246c51-9b36-441e-af80-863893fbb1fc">æœç´¢å¼•æ“</h5>
<div class="outline-text-5" id="text-h:1f246c51-9b36-441e-af80-863893fbb1fc">
<ul class="org-ul">
<li><a href="http://pkgs.org">http://pkgs.org</a></li>
<li><a href="http://rpmfind.net">http://rpmfind.net</a></li>
<li><a href="http://rpm.pbone.net">http://rpm.pbone.net</a></li>
<li><a href="https://sourceforge.net/">https://sourceforge.net/</a></li>
</ul>

<p>
æ³¨æ„ï¼šç¬¬ä¸‰æ–¹åŒ…å»ºè®®è¦æ£€æŸ¥å…¶åˆæ³•æ€§ï¼Œæ¥æºåˆæ³•æ€§,ç¨‹åºåŒ…çš„å®Œæ•´æ€§
</p>
</div>
</div>
<div id="outline-container-h:9f6c3bdd-50d7-4e0c-82a7-7bf3be6bb9ba" class="outline-5">
<h5 id="h:9f6c3bdd-50d7-4e0c-82a7-7bf3be6bb9ba">è‡ªå·±åˆ¶ä½œ</h5>
<div class="outline-text-5" id="text-h:9f6c3bdd-50d7-4e0c-82a7-7bf3be6bb9ba">
<p>
å°†æºç æ–‡ä»¶ï¼Œåˆ©ç”¨å·¥å…·ï¼Œå¦‚ï¼šrpmbuildï¼Œfpmç­‰å·¥å…·åˆ¶ä½œæˆrpmåŒ…æ–‡ä»¶
</p>
</div>
</div>
</div>
</div>
</section>
<section id="outline-container-h:67ed83cd-a5d7-4cc4-ba8d-a431570b2139" class="outline-2">
<h2 id="h:67ed83cd-a5d7-4cc4-ba8d-a431570b2139">åŒ…ç®¡ç†å™¨rpm</h2>
<div class="outline-text-2" id="text-h:67ed83cd-a5d7-4cc4-ba8d-a431570b2139">
<p>
CentOSç³»ç»Ÿä¸Šä½¿ç”¨rpmå‘½ä»¤ç®¡ç†ç¨‹åºåŒ…
</p>

<p>
åŠŸèƒ½ï¼š å®‰è£…ã€å¸è½½ã€å‡çº§ã€æŸ¥è¯¢ã€æ ¡éªŒã€æ•°æ®åº“ç»´æŠ¤
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm&#21517;: rpm [OPTIONS] [PACKAGE_FILE]
&#23433;&#35013; : -i&#65292;--install
&#21319;&#32423; : -U&#65292;--updat&#65292;-F&#65292;--freshen
&#21368;&#36733; : -e,--erase
&#26597;&#35810; : -q,--query
&#26657;&#39564; : -V,--verify
&#25968;&#25454;&#24211;&#32500;&#25252; : --builddb,--initdb

&#27880;&#24847;&#65306;&#23433;&#35013;&#38656;&#35201;&#36755;&#20837;PACKAGE_FILE&#65292;&#32780;&#26597;&#35810;&#26102;&#21482;&#38656;&#35201;package&#21517;&#23383;&#23601;&#34892;
</pre>
</div>

<p>
ç¼ºç‚¹ï¼šä¸èƒ½è§£å†³åŒ…çš„ä¾èµ–é—®é¢˜ï¼Œrpmå‘½ä»¤å¸¸ç”¨åœ¨æŸ¥è¯¢
</p>
</div>
<div id="outline-container-h:544cfc17-9ebc-43bb-802a-6b9d8a08ae54" class="outline-3">
<h3 id="h:544cfc17-9ebc-43bb-802a-6b9d8a08ae54">å®‰è£…</h3>
<div class="outline-text-3" id="text-h:544cfc17-9ebc-43bb-802a-6b9d8a08ae54">
<p>
æ ¼å¼ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm {-i|--install} [install-options] PACKAGE_FILE&#8230;

&#36873;&#39033;&#65306;
-v: verbose
-vv:
-h:      <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20197;#&#26174;&#31034;&#31243;&#24207;&#21253;&#31649;&#29702;&#25191;&#34892;&#36827;&#24230;</span>

&#24120;&#29992;&#32452;&#21512;&#65306;
rpm -ivh PACKAGE_FILE ...
</pre>
</div>


<p>
rpmåŒ…å®‰è£…[install-options]
</p>

<div class="org-src-container">
<pre class="src src-sh">--test: &#27979;&#35797;&#23433;&#35013;&#65292;&#20294;&#19981;&#30495;&#27491;&#25191;&#34892;&#23433;&#35013;&#65292;&#21363;dry run&#27169;&#24335;
--nodeps&#65306;&#24573;&#30053;&#20381;&#36182;&#20851;&#31995;
--replacepkgs | replacefiles &#37325;&#26032;&#23433;&#35013;&#65307;&#27880;&#24847;&#23427;&#19981;&#33021;&#26367;&#25442;&#37197;&#32622;&#25991;&#20214;&#65292;&#22914;&#26524;&#21253;&#37197;&#32622;&#25991;&#20214;&#34987;&#20462;&#25913;&#24314;&#35758;&#21024;&#25481;&#22312;&#20351;&#29992;&#35813;&#21442;&#25968;&#65307;

--nosignature: &#19981;&#26816;&#26597;&#26469;&#28304;&#21512;&#27861;&#24615;
--nodigest&#65306;&#19981;&#26816;&#26597;&#21253;&#23436;&#25972;&#24615;
--noscripts&#65306;&#19981;&#25191;&#34892;&#31243;&#24207;&#21253;&#33050;&#26412;
        %pre: &#23433;&#35013;&#21069;&#33050;&#26412; --nopre
        %post: &#23433;&#35013;&#21518;&#33050;&#26412; --nopost
        %preun: &#21368;&#36733;&#21069;&#33050;&#26412; --nopreun
        %postun: &#21368;&#36733;&#21518;&#33050;&#26412; --nopostun

&#20854;&#23427;
--justdb : &#26356;&#26032;&#25968;&#25454;&#24211;&#65292;&#23454;&#38469;&#27809;&#26377;&#23433;&#35013;
--root &#25351;&#23450;&#23433;&#35013;&#30340;&#26681;&#30446;&#24405;
</pre>
</div>

<p>
èŒƒä¾‹ï¼šæŒ‡å®šæ ¹å®‰è£…
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm -ivh /mnt/cdrom/Packages/rpm-4.11-3-40.el7.x86_64.rpm --root=/mnt/sysimage/
</pre>
</div>
</div>
</div>
<div id="outline-container-h:82ea39a9-0903-4506-8c27-c5d61877a629" class="outline-3">
<h3 id="h:82ea39a9-0903-4506-8c27-c5d61877a629">å‡çº§å’Œé™çº§</h3>
<div class="outline-text-3" id="text-h:82ea39a9-0903-4506-8c27-c5d61877a629">
<p>
rpmåŒ…å‡çº§
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm {-U|--upgrade} [install-options] PACKAGE_FILE...
rpm {-F|--freshen} [install-options] PACKAGE_FILE...
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">--upgrade&#65306;&#23433;&#35013;&#26377;&#26087;&#29256;&#31243;&#24207;&#21253;&#65292;&#21017;<span style="color: #8b2252;">"&#21319;&#32423;"</span>&#65292;&#22914;&#26524;&#19981;&#23384;&#22312;&#26087;&#29256;&#31243;&#24207;&#21253;&#65292;&#21017;<span style="color: #8b2252;">"&#23433;&#35013;"</span>
--freshen&#65306;&#23433;&#35013;&#26377;&#26087;&#29256;&#31243;&#24207;&#21253;&#65292;&#21017;<span style="color: #8b2252;">"&#21319;&#32423;"</span>&#65292; &#22914;&#26524;&#19981;&#23384;&#22312;&#26087;&#29256;&#31243;&#24207;&#21253;&#65292;&#21017;&#19981;&#25191;&#34892;&#21319;&#32423;&#25805;&#20316;

--oldpackage&#65306;&#38477;&#32423;
--force: &#24378;&#21046;&#23433;&#35013;
</pre>
</div>

<p>
å¸¸ç”¨ç»„åˆ
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm -Uvh PACKAGE_FILE ...
rpm -Fvh PACKAGE_FILE ...
</pre>
</div>

<p>
å‡çº§æ³¨æ„é¡¹ï¼š
</p>
<ol class="org-ol">
<li>ä¸è¦å¯¹å†…æ ¸åšå‡çº§æ“ä½œï¼›Linuxæ”¯æŒå¤šå†…æ ¸ç‰ˆæœ¬å¹¶å­˜ï¼Œå› æ­¤ç›´æ¥å®‰è£…æ–°ç‰ˆæœ¬å†…æ ¸</li>
<li>å¦‚æœåŸç¨‹åºåŒ…çš„é…ç½®æ–‡ä»¶å®‰è£…åæ›¾è¢«ä¿®æ”¹ï¼Œå‡çº§æ—¶ï¼Œæ–°ç‰ˆæœ¬æä¾›çš„åŒä¸€ä¸ªé…
ç½®æ–‡ä»¶ä¸ä¼šç›´æ¥è¦†ç›–è€ç‰ˆæœ¬çš„é…ç½®æ–‡ä»¶ï¼Œè€ŒæŠŠæ–°ç‰ˆæœ¬æ–‡ä»¶é‡å‘½å
(FILENAME.rpmnew)åä¿ç•™</li>
</ol>
</div>
</div>
<div id="outline-container-h:ce35e207-58c6-4949-a16c-c0a4afa6598b" class="outline-3">
<h3 id="h:ce35e207-58c6-4949-a16c-c0a4afa6598b">åŒ…æŸ¥è¯¢</h3>
<div class="outline-text-3" id="text-h:ce35e207-58c6-4949-a16c-c0a4afa6598b">
<p>
æ•°æ®åº“(å…¬å…±)ï¼š/var/lib/rpm
</p>

<ul class="org-ul">
<li>ç¨‹åºåŒ…åç§°åŠç‰ˆæœ¬</li>
<li>ä¾èµ–å…³ç³»</li>
<li>åŠŸèƒ½è¯´æ˜</li>
<li>åŒ…å®‰è£…åç”Ÿæˆçš„å„æ–‡ä»¶è·¯å¾„åŠæ ¡éªŒç ä¿¡æ¯</li>
</ul>

<p>
æŸ¥è¯¢ä¼šä»è¿™æ•°æ®åº“ä¸­æŸ¥
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm {-q|--query} [select-options] [query-options]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">[select-options]
-a                                <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25152;&#26377;&#21253;</span>
-f                                <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#25351;&#23450;&#30340;&#25991;&#20214;&#30001;&#21738;&#20010;&#31243;&#24207;&#21253;&#23433;&#35013;&#29983;&#25104;</span>
-p rpmfile                 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#38024;&#23545;&#23578;&#26410;&#23433;&#35013;&#30340;&#31243;&#24207;&#21253;&#25991;&#20214;&#20570;&#26597;&#35810;&#25805;&#20316;</span>
-g,--group GROUP  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#35810;&#21253;&#32452;&#20013;&#21253;&#21547;&#20102;&#21738;&#20123;&#21253;</span>

[query-options]
--changelog  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#35810;rpm&#21253;&#30340;changelog</span>
-c                   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#35810;&#31243;&#24207;&#30340;&#37197;&#32622;&#25991;&#20214;</span>
-d                  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#35810;&#31243;&#24207;&#30340;&#25991;&#26723;</span>
-i                   <span style="color: #b22222;">#</span><span style="color: #b22222;">information&#20449;&#24687;</span>
-l                  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#25351;&#23450;&#30340;&#31243;&#24207;&#21253;&#23433;&#35013;&#21518;&#29983;&#25104;&#30340;&#25152;&#26377;&#25991;&#20214;</span>
--scripts      <span style="color: #b22222;">#</span><span style="color: #b22222;">&#31243;&#24207;&#21253;&#33258;&#24102;&#30340;&#33050;&#26412;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21644;CAPABILITY&#30456;&#20851;</span>
--whatprovides CAPABILITY     <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#35810;&#25351;&#23450;&#30340;CAPABILITY&#30001;&#21738;&#20010;&#21253;&#25152;&#25552;&#20379;</span>
--whatrequires CAPABILITY      <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#35810;&#25351;&#23450;&#30340;CAPABILITY&#34987;&#21738;&#20010;&#21253;&#25152;&#20381;&#36182;</span>
--provides                                    <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#25351;&#23450;&#31243;&#24207;&#21253;&#25152;&#25552;&#20379;&#30340;CAPABILITY</span>
-R                                                <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#35810;&#25351;&#23450;&#30340;&#31243;&#24207;&#21253;&#25152;&#20381;&#36182;&#30340;CAPABILITY</span>
</pre>
</div>

<p>
å¸¸ç”¨æŸ¥è¯¢ç”¨æ³•ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">&#24050;&#23433;&#35013;&#21253;&#26597;&#35810;
-qa
-q PACKAGE
-qi PACKAGE
-qc PACKAGE
-ql PACKAGE
-qd PACKAGE
-q --scripts PACKAGE  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#21253;&#20013;&#33050;&#26412;</span>
-qf FILE                          <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#25351;&#23450;&#30340;&#25991;&#20214;&#30001;&#21738;&#20010;&#31243;&#24207;&#21253;&#23433;&#35013;&#29983;&#25104;</span>

&#26410;&#23433;&#35013;&#21253;&#26597;&#35810;
-qpi PACKAGE_FILE
-qpl PACKAGE_FILE, ...
</pre>
</div>

<p>
èŒƒä¾‹ï¼š
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">PACKAGE_NAME : &#26597;&#35810;&#25351;&#23450;&#30340;&#31243;&#24207;&#21253;&#26159;&#21542;&#24050;&#32463;&#23433;&#35013;&#65292;&#21450;&#20854;&#29256;&#26412;&#65307;</span>
rpm -q zsh  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#31934;&#30830;&#21517;&#25110;&#21069;&#32512;+TAB&#38190;&#34917;&#20840;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">-a,--all : &#26597;&#35810;&#25152;&#26377;&#24050;&#32463;&#23433;&#35013;&#36807;&#30340;&#21253;</span>
rpm -qa |grep ^zs
rpm -qa  zs* <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25903;&#25345;&#36890;&#37197;&#31526;</span>

rpm -ql wget  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#21253;&#20013;&#21253;&#21547;&#30340;&#25991;&#20214;</span>

rpm -q --scripts wget  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26174;&#31034;&#21253;&#20013;&#33050;&#26412;&#20869;&#23481;</span>

rpm -qa --last|head <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#26368;&#36817;&#23433;&#35013;&#30340;&#21253;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">-f FILE : &#26597;&#35810;&#25351;&#23450;&#30340;&#25991;&#20214;&#30001;&#21738;&#20010;&#31243;&#24207;&#21253;&#23433;&#35013;&#29983;&#25104;</span>
[root@node01 Packages]# rpm -qf /etc/fstab
setup-2.8.71-7.el7.noarch

<span style="color: #b22222;"># </span><span style="color: #b22222;">-i,--info : &#31243;&#24207;&#21253;&#30456;&#20851;&#30340;&#20449;&#24687;&#65292;&#29256;&#26412;&#21495;&#12289;&#22823;&#23567;&#12289;&#25152;&#23646;&#30340;&#32452;</span>
rpm -qi bash


<span style="color: #b22222;"># </span><span style="color: #b22222;">--provides : &#21015;&#20986;&#25351;&#23450;&#30340;&#31243;&#24207;&#21253;&#25552;&#20379;&#30340;&#25152;&#26377;&#30340;&#33021;&#21147;CAPABILITY</span>
[root@localhost ~]# rpm -q --provides  bash
/bin/bash
/bin/sh
<span style="color: #a0522d;">bash</span> = 4.2.46-12.el7
<span style="color: #0000ff;">bash</span>(x86-64) = 4.2.46-12.el7
<span style="color: #0000ff;">config</span>(bash) = 4.2.46-12.el7

<span style="color: #b22222;"># </span><span style="color: #b22222;">--whatprovides CAPABILITY : &#26597;&#35810;&#25351;&#23450;&#30340;&#33021;&#21147;CAPABILITY&#30001;&#21738;&#20010;&#31243;&#24207;&#21253;&#25552;&#20379;</span>
[root@localhost ~]# rpm -q --whatprovides  bash
bash-4.2.46-12.el7.x86_64
<span style="color: #b22222;"># </span><span style="color: #b22222;">--whatrequires CAPABILITY : &#26597;&#35810;&#25351;&#23450;&#30340;CAPABILITY&#34987;&#21738;&#20010;&#21253;&#25152;&#20381;&#36182;</span>
[root@localhost ~]# rpm -q --whatprovides  <span style="color: #8b2252;">'config(bash)'</span>
bash-4.2.46-12.el7.x86_64

<span style="color: #b22222;"># </span><span style="color: #b22222;">--scripts : &#26597;&#30475;&#31243;&#24207;&#21253;&#33258;&#24102;&#30340;&#33050;&#26412;&#29255;&#26029;&#26377;&#21738;&#20123;</span>
[root@jenkins01 soft]# rpm -qp --scripts tomcat-app-8.0.36-20160817.el7.centos.x86_64.rpm
postinstall scriptlet (using /bin/sh):
<span style="color: #a020f0;">if</span> [ $<span style="color: #a0522d;">1</span> == 1 ]; <span style="color: #a020f0;">then</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2e24402e-9d33-404d-95da-ae3ca93125b4" class="outline-3">
<h3 id="h:2e24402e-9d33-404d-95da-ae3ca93125b4">åŒ…å¸è½½</h3>
<div class="outline-text-3" id="text-h:2e24402e-9d33-404d-95da-ae3ca93125b4">
<p>
æ ¼å¼ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm {-e|--erase} [--allmatches] [--nodeps] [--noscripts] [--notriggers] [--test] PACKAGE_NAME ...
</pre>
</div>

<p>
æ³¨æ„ï¼šå½“åŒ…å¸è½½æ—¶ï¼Œå¯¹åº”çš„é…ç½®æ–‡ä»¶ä¸ä¼šåˆ é™¤ï¼Œ ä»¥FILENAME.rpmsaveå½¢å¼ä¿ç•™
</p>

<div class="org-src-container">
<pre class="src src-sh">--allmatches&#65306;&#21368;&#36733;&#25152;&#26377;&#21305;&#37197;&#30340;&#25351;&#23450;&#21517;&#31216;&#30340;&#31243;&#24207;&#21253;&#30340;&#21508;&#29256;&#26412;&#65307;
--nodep&#65306;&#24573;&#30053;&#20381;&#36182;&#20851;&#31995;
--noscripts&#65306;&#19981;&#25191;&#34892;&#33050;&#26412;
 %pre: &#23433;&#35013;&#21069;&#33050;&#26412; --nopre
 %post: &#23433;&#35013;&#21518;&#33050;&#26412; --nopost
 %preun: &#21368;&#36733;&#21069;&#33050;&#26412; --nopreun
 %postun: &#21368;&#36733;&#21518;&#33050;&#26412; --nopostun

--test&#65306;&#27979;&#35797;&#21368;&#36733;&#65292;dry run&#27169;&#24335;&#65307;
</pre>
</div>

<p>
èŒƒä¾‹ï¼šå¼ºè¡Œåˆ é™¤rpmåŒ…ï¼Œå¹¶æ¢å¤
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos7 ~]#rpm -e rpm --nodeps

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#37325;&#21551;&#36827;&#20837;rescue&#27169;&#24335;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">mkdir /mnt/cdrom</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">mount /dev/sr0 /mnt/cdrom</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">rpm -ivh /mnt/cdrom/Packages/rpm-4.11.3-40.el7.x86_64.rpm --root=/mnt/sysimage</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">reboot</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:52014c9c-cf3c-43cf-bedd-6a0d097ce478" class="outline-3">
<h3 id="h:52014c9c-cf3c-43cf-bedd-6a0d097ce478">åŒ…æ ¡éªŒ</h3>
<div class="outline-text-3" id="text-h:52014c9c-cf3c-43cf-bedd-6a0d097ce478">
<p>
åœ¨å®‰è£…åŒ…æ—¶ï¼Œç³»ç»Ÿä¹Ÿä¼šæ£€æŸ¥åŒ…çš„æ¥æºæ˜¯å¦æ˜¯åˆæ³•çš„
</p>

<p>
æ£€æŸ¥åŒ…çš„å®Œæ•´æ€§å’Œç­¾å
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm -K|--checksig rpmfile 
</pre>
</div>

<p>
åœ¨æ£€æŸ¥åŒ…çš„æ¥æºå’Œå®Œæ•´æ€§å‰ï¼Œå¿…é¡»å¯¼å…¥æ‰€éœ€è¦å…¬é’¥
</p>

<p>
èŒƒä¾‹ï¼šcentos7 å¯¼å…¥å¯†é’¥
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23548;&#20837;&#23494;&#38053;</span>
rpm -qa <span style="color: #8b2252;">"gpg-pubkey*"</span> <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26816;&#26597;&#23433;&#35013;&#22909;&#30340;&#23494;&#38053;</span>
</pre>
</div>

<p>
èŒƒä¾‹ï¼šCentOS 8
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#rpm -K /misc/cd/AppStream/Packages/httpd-2.4.37-16.module_el8.1.0+256+ae790463.x86_64.rpm
/misc/cd/AppStream/Packages/httpd-2.4.37-16.module_el8.1.0+256+ae790463.x86_64.rpm: digests SIGNATURES NOT OK
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#38656;&#35201;&#20107;&#20808;&#30693;&#36947;&#31614;&#21517;&#65292;&#25152;&#20197;&#19978;&#38754;&#25253;&#38169;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#29992;&#20110;&#26816;&#26597;&#31614;&#21517;&#30340;&#25991;&#20214;</span>
[root@centos8 ~]#cat /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2.0.22 (GNU/Linux)
mQINBFzMWxkBEADHrskpBgN9OphmhRkc7P/YrsAGSvvl7kfu+e9KAaU6f5MeAVyn
.. ...

[root@centos8 ~]#rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23548;&#20837;&#31614;&#21517;</span>
[root@centos8 rpm-gpg]#rpm -K /misc/cd/AppStream/Packages/httpd-2.4.37-
16.module_el8.1.0+256+ae790463.x86_64.rpm
/misc/cd/AppStream/Packages/httpd-2.4.37-
16.module_el8.1.0+256+ae790463.x86_64.rpm: digests signatures OK

[root@centos8 ~]#rpm -qa <span style="color: #8b2252;">"gpg-pubkey*"</span>
gpg-pubkey-8483c65d-5ccc5b19
[root@centos8 ~]#rpm -qi gpg-pubkey-8483c65d-5ccc5b19
.
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: rpm-4.14.2 (NSS-3)
mQINBFzMWxkBEADHrskpBgN9OphmhRkc7P/YrsAGSvvl7kfu+e9KAaU6f5MeAVyn
... ...
</pre>
</div>

<p>
èŒƒä¾‹ï¼šæ ¡éªŒåŒ…æ–‡ä»¶
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#rpm -K /misc/cd/BaseOS/Packages/tree-1.7.0-15.el8.x86_64.rpm
/misc/cd/BaseOS/Packages/tree-1.7.0-15.el8.x86_64.rpm: digests signatures OK
[root@centos8 ~]#cp /misc/cd/BaseOS/Packages/tree-1.7.0-15.el8.x86_64.rpm /data
[root@centos8 ~]#cd /data
[root@centos8 data]#ll
total 60
-r--r--r-- 1 root root 60780 Apr  8 10:11 tree-1.7.0-15.el8.x86_64.rpm
[root@centos8 data]#echo &gt;&gt;tree-1.7.0-15.el8.x86_64.rpm
[root@centos8 data]#ll tree-1.7.0-15.el8.x86_64.rpm
-r--r--r-- 1 root root 60781 Apr  8 10:11 tree-1.7.0-15.el8.x86_64.rpm
[root@centos8 data]#cd
[root@centos8 ~]#rpm -K /data/tree-1.7.0-15.el8.x86_64.rpm
/data/tree-1.7.0-15.el8.x86_64.rpm: DIGESTS SIGNATURES NOT OK
</pre>
</div>

<p>
è½¯ä»¶åœ¨å®‰è£…æ—¶ï¼Œä¼šå°†åŒ…é‡Œçš„æ¯ä¸ªæ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œå¦‚ï¼šå¤§å°ï¼Œæƒé™ï¼Œæ‰€æœ‰è€…ï¼Œæ—¶é—´
ç­‰è®°å½•è‡³rpmç›¸å…³çš„æ•°æ®åº“ä¸­ï¼Œå¯ä»¥ç”¨æ¥æ£€æŸ¥åŒ…ä¸­çš„æ–‡ä»¶æ˜¯å¦å’Œå½“åˆå®‰è£…æ—¶æœ‰æ‰€
å˜åŒ–
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm {-V|--verify} [select-options] [verify-options]
</pre>
</div>

<p>
èŒƒä¾‹ï¼šæŸ¥çœ‹åŒ…ä»å®‰è£…åæ˜¯å¦æ›´æ”¹è¿‡
</p>
<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#rpm -V centos-release
S.5....T. c /etc/issue

S file Size differs
M Mode differs (includes permissions and file type)
5 digest (formerly MD5 sum) differs
D Device major/minor number mismatch
L readLink(2) path mismatch
U User ownership differs
G Group ownership differs
T mTime differs
P capabilities differ
<span style="color: #0000ff;">.</span> (&#28857;) &#34920;&#31034;&#24403;&#21069;&#20301;&#32622;&#20195;&#34920;&#30340;&#23383;&#31526;&#21547;&#20041;&#19968;&#33268;

c &#25152;&#22312;&#30340;&#20301;&#32622;&#34920;&#31034;&#25991;&#20214;&#31867;&#22411;
c &#37197;&#32622;&#25991;&#20214;
d &#25991;&#20214;&#25968;&#25454;&#25991;&#20214;
g &#35813;&#25991;&#20214;&#19981;&#23646;&#20110;&#26576;&#20010;&#25991;&#20214;(&#26497;&#23569;&#24773;&#20917;)
l &#35768;&#21487;&#35777;&#25991;&#20214;(license file)
<span style="color: #483d8b;">r</span> &#33258;&#36848;&#25991;&#20214;(READ ME)

&#21487;&#20197;&#30475;&#21040;&#65292;&#32467;&#26524;&#26174;&#31034;&#20102;&#25991;&#20214;&#34987;&#20462;&#25913;&#30340;&#20449;&#24687;&#12290;&#35813;&#20449;&#24687;&#21487;&#20998;&#20026;&#20197;&#19979; 3 &#37096;&#20998;&#65306;
1 &#26368;&#21069;&#38754;&#30340; 8 &#20010;&#23383;&#31526;&#65288;S.5....T&#65289;&#37117;&#23646;&#20110;&#39564;&#35777;&#20449;&#24687;&#65292;&#21508;&#23383;&#31526;&#30340;&#20855;&#20307;&#21547;&#20041;&#22914;&#19979;&#65306;
S&#65306;&#25991;&#20214;&#22823;&#23567;&#26159;&#21542;&#25913;&#21464;&#12290;
M&#65306;&#25991;&#20214;&#30340;&#31867;&#22411;&#25110;&#25991;&#20214;&#30340;&#26435;&#38480;&#65288;rwx&#65289;&#26159;&#21542;&#25913;&#21464;&#12290;
5&#65306;&#25991;&#20214;MD5&#26657;&#39564;&#21644;&#26159;&#21542;&#25913;&#21464;&#65288;&#21487;&#20197;&#30475;&#25104;&#25991;&#20214;&#20869;&#23481;&#26159;&#21542;&#25913;&#21464;&#65289;&#12290;
D&#65306;&#35774;&#22791;&#30340;&#20027;&#20174;&#20195;&#30721;&#26159;&#21542;&#25913;&#21464;&#12290;
L&#65306;&#25991;&#20214;&#36335;&#24452;&#26159;&#21542;&#25913;&#21464;&#12290;
U&#65306;&#25991;&#20214;&#30340;&#23646;&#20027;&#65288;&#25152;&#26377;&#32773;&#65289;&#26159;&#21542;&#25913;&#21464;&#12290;
G&#65306;&#25991;&#20214;&#30340;&#23646;&#32452;&#26159;&#21542;&#25913;&#21464;&#12290;
T&#65306;&#25991;&#20214;&#30340;&#20462;&#25913;&#26102;&#38388;&#26159;&#21542;&#25913;&#21464;&#12290;
.&#65306;&#33509;&#30456;&#20851;&#39033;&#27809;&#21457;&#29983;&#25913;&#21464;&#65292;&#29992; . &#34920;&#31034;&#12290;

2 &#34987;&#20462;&#25913;&#25991;&#20214;&#31867;&#22411;&#65292;&#22823;&#33268;&#21487;&#20998;&#20026;&#20197;&#19979;&#20960;&#31867;&#65306;
c&#65306;&#37197;&#32622;&#25991;&#20214;&#65288;configuration file&#65289;&#12290;
d&#65306;&#26222;&#36890;&#25991;&#26723;&#65288;documentation&#65289;&#12290;
g&#65306;<span style="color: #8b2252;">"&#39740;"</span>&#25991;&#20214;&#65288;ghost file&#65289;&#65292;&#24456;&#23569;&#35265;&#65292;&#23601;&#26159;&#35813;&#25991;&#20214;&#19981;&#24212;&#35813;&#34987;&#36825;&#20010; RPM &#21253;&#21253;&#21547;&#12290;
l&#65306;&#25480;&#26435;&#25991;&#20214;&#65288;license file&#65289;&#12290;
<span style="color: #483d8b;">r</span>&#65306;&#25551;&#36848;&#25991;&#20214;&#65288;read me&#65289;&#12290;

3 &#34987;&#20462;&#25913;&#25991;&#20214;&#25152;&#22312;&#32477;&#23545;&#36335;&#24452;&#65288;&#21253;&#21547;&#25991;&#20214;&#21517;&#65289;&#12290;

<span style="color: #b22222;">#</span>
S.5....T. c /etc/httpd/conf/httpd.conf &#34920;&#36798;&#30340;&#23436;&#25972;&#21547;&#20041;&#26159;&#65306;&#37197;&#32622;&#25991;&#20214; httpd.conf &#30340;&#22823;&#23567;&#12289;&#20869;&#23481;&#12289;&#20462;&#25913;&#26102;&#38388;&#34987;&#20154;&#20026;&#20462;&#25913;&#36807;&#12290;
</pre>
</div>

<p>
èŒƒä¾‹ï¼šæ£€æŸ¥åŒ…æ˜¯å¦è¢«ç¯¡æ”¹è¿‡
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#rpm -qf /etc/issue
centos-release-8.1-1.1911.0.8.el8.x86_64
[root@centos8 ~]#vim /var/lib/rpm^C/etc/issue
[root@centos8 ~]#vim /etc/issue
welcome to u                               

\S
Kernel \r on an \m
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39564;&#35777;&#25972;&#20010;&#21253;&#26159;&#21542;&#21253;&#25913;&#36807;</span>
[root@centos8 ~]#rpm -V centos-release
S.5....T. c /etc/issue
[root@centos8 ~]#vim /etc/issue
[root@centos8 ~]#cat /etc/issue
\S
Kernel \r on an \m
[root@centos8 ~]#

[root@centos8 ~]#rpm -V centos-release
.......T. c /etc/issue

[root@centos8 ~]#rpm -ql centos-release
/etc/centos-release
/etc/centos-release-upstream
/etc/issue
/etc/issue.net
/etc/os-release
/etc/redhat-release
/etc/rpm/macros.dist
/etc/system-release
/etc/system-release-cpe
/usr/lib/systemd/system-preset/85-display-manager.preset
/usr/lib/systemd/system-preset/90-default.preset
/usr/lib/systemd/system-preset/99-default-disable.preset
/usr/share/centos-release/EULA
/usr/share/doc/centos-release/Contributors
/usr/share/doc/centos-release/GPL
/usr/share/doc/redhat-release
/usr/share/redhat-release

[root@centos8 ~]#rpm -Va  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26816;&#26597;&#30340;&#21253;&#26377;&#27809;&#26377;&#25913;&#21464;</span>
.M....... g /run/dbus
.......T.  /usr/bin/tree
.M....... c /etc/machine-id
missing  c /etc/systemd/system/dbus-org.freedesktop.resolve1.service
.M....... g /var/cache/private
.M....... g /var/lib/private
.M....... g /var/log/btmp
.M....... g /var/log/private
S.5....T. c /etc/issue
.M....G.. g /var/log/lastlog
.M....... d /usr/share/info/dir.old
.M....... g /var/cache/dnf/packages.db
.M....... g /var/lib/plymouth/boot-duration
.......T. c /etc/kdump.conf
S.5....T. c /etc/ssh/sshd_config
.M....... c /etc/rc.d/rc.local
S.5....T. c /root/.bashrc
.M....... g /etc/crypto-policies/back-ends/nss.config
.M....... g /etc/udev/hwdb.bin
.M....... g /var/lib/systemd/random-seed
missing  c /etc/yum.repos.d/CentOS-AppStream.repo
missing  c /etc/yum.repos.d/CentOS-Base.repo
missing  c /etc/yum.repos.d/CentOS-CR.repo
missing  c /etc/yum.repos.d/CentOS-Debuginfo.repo
missing  c /etc/yum.repos.d/CentOS-Extras.repo
missing  c /etc/yum.repos.d/CentOS-HA.repo
missing  c /etc/yum.repos.d/CentOS-Media.repo
missing  c /etc/yum.repos.d/CentOS-PowerTools.repo
missing  c /etc/yum.repos.d/CentOS-Sources.repo
missing  c /etc/yum.repos.d/CentOS-Vault.repo
missing  c /etc/yum.repos.d/CentOS-centosplus.repo
missing  c /etc/yum.repos.d/CentOS-fasttrack.repo
.M.......  /var/log/audit


<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39564;&#35777;&#36719;&#20214;&#21253;&#20013;&#30340;&#21333;&#20010;&#25991;&#20214;&#65292;&#22914;&#26524;&#25991;&#20214;&#27809;&#26377;&#34987;&#20462;&#25913;&#36807;&#65292;&#21017;&#19981;&#36755;&#20986;&#20219;&#20309;&#20449;&#24687;</span>
rpm -Vf /etc/crontab

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39564;&#35777;&#25972;&#20010;&#36719;&#20214;&#21253;&#26159;&#21542;&#34987;&#20462;&#25913;&#36807;</span>
rpm -Vp AdobeReader_chs-7.0.9-1.i386.rpm 
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5c158fee-1dc8-41e6-a4de-de581a78f60b" class="outline-3">
<h3 id="h:5c158fee-1dc8-41e6-a4de-de581a78f60b">æ•°æ®åº“</h3>
<div class="outline-text-3" id="text-h:5c158fee-1dc8-41e6-a4de-de581a78f60b">
<p>
rpmåŒ…å®‰è£…æ—¶ç”Ÿæˆçš„ä¿¡æ¯ï¼Œéƒ½æ”¾åœ¨rpmæ•°æ®åº“ä¸­
</p>

<div class="org-src-container">
<pre class="src src-sh">/var/lib/rpm
</pre>
</div>

<p>
å¯ä»¥é‡å»ºæ•°æ®åº“
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm {--initdb|--rebuilddb}
initdb: &#21021;&#22987;&#21270;&#65292;&#22914;&#26524;&#20107;&#20808;&#19981;&#23384;&#22312;&#25968;&#25454;&#24211;&#65292;&#21017;&#26032;&#24314;&#20043;&#65292;&#21542;&#21017;&#65292;&#19981;&#25191;&#34892;&#20219;&#20309;&#25805;&#20316;
rebuilddb&#65306;&#37325;&#24314;&#24050;&#23433;&#35013;&#30340;&#21253;&#22836;&#30340;&#25968;&#25454;&#24211;&#32034;&#24341;&#30446;&#24405;
</pre>
</div>

<p>
<b>æŠ¥é”™-è§£å†³yum installæ—¶å‡ºç°Thread died in Berkeley DB libraryçš„é”™è¯¯</b>
</p>


<div class="org-src-container">
<pre class="src src-sh">$ yum install wireshark wireshark-gnome
error: rpmdb: BDB0113 Thread/process 3336/140141695063872 failed: BDB1507 Thread died<span style="color: #a020f0;"> in</span> Berkeley DB library
error: db5 error(-30973) from dbenv-&gt;failchk: BDB0087 DB_RUNRECOVERY: Fatal error, run database recovery
error: cannot open Packages index using db5 -  (-30973)
error: cannot open Packages database<span style="color: #a020f0;"> in</span> /var/lib/rpm
CRITICAL:yum.main:

Error: rpmdb open failed
</pre>
</div>

<p>
åŸå› ï¼š æç¤ºrpmç›¸å…³çš„æ•°æ®åº“æŸåäº†
</p>

<p>
è§£å†³ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">mkdir /var/lib/rpm/backup
cp -a /var/lib/rpm/__db* /var/lib/rpm/backup/
rm -f /var/lib/rpm/__db.[0-9][0-9]*
rpm --quiet -qa
rpm --rebuilddb
yum clean all
</pre>
</div>
</div>
</div>
</section>
<section id="outline-container-h:328e7c58-986e-4291-ad14-c020117983a8" class="outline-2">
<h2 id="h:328e7c58-986e-4291-ad14-c020117983a8">yumå’Œdnf</h2>
<div class="outline-text-2" id="text-h:328e7c58-986e-4291-ad14-c020117983a8">
<p>
CentOS ä½¿ç”¨ yum, dnf è§£å†³rpmçš„åŒ…ä¾èµ–å…³ç³»
</p>

<p>
YUM: Yellowdog Update Modifierï¼Œrpmçš„å‰ç«¯ç¨‹åºï¼Œå¯è§£å†³è½¯ä»¶åŒ…ç›¸å…³ä¾èµ–æ€§ï¼Œ
å¯åœ¨å¤šä¸ªåº“ä¹‹é—´å®šä½è½¯ä»¶åŒ…ï¼Œup2dateçš„æ›¿ä»£å·¥å…·ï¼ŒCentOS 8 ç”¨dnf ä»£æ›¿äº†yum
,ä¸è¿‡ä¿ç•™äº†å’Œyumçš„å…¼å®¹æ€§ï¼Œé…ç½®ä¹Ÿæ˜¯é€šç”¨çš„
</p>
</div>
<div id="outline-container-h:41183e23-91dd-4eda-9734-10455d42a144" class="outline-3">
<h3 id="h:41183e23-91dd-4eda-9734-10455d42a144">yum/dnf å·¥ä½œåŸç†</h3>
<div class="outline-text-3" id="text-h:41183e23-91dd-4eda-9734-10455d42a144">
<p>
yum/dnf æ˜¯åŸºäºC/S æ¨¡å¼
</p>
<ul class="org-ul">
<li>yum æœåŠ¡å™¨å­˜æ”¾rpmåŒ…å’Œç›¸å…³åŒ…çš„å…ƒæ•°æ®åº“</li>
<li>yum å®¢æˆ·ç«¯è®¿é—®yumæœåŠ¡å™¨è¿›è¡Œå®‰è£…æˆ–æŸ¥è¯¢ç­‰</li>
</ul>


<figure id="orgd63aebb">
<img src="images/image-20210216014442131.png" alt="image-20210216014442131.png" width="60%">

</figure>

<p>
yum å®ç°è¿‡ç¨‹
</p>

<p>
å…ˆåœ¨yumæœåŠ¡å™¨ä¸Šåˆ›å»º yum repositoryï¼ˆä»“åº“ï¼‰ï¼Œåœ¨ä»“åº“ä¸­äº‹å…ˆå­˜å‚¨äº†ä¼—å¤šrpm
åŒ…ï¼Œä»¥åŠåŒ…çš„ç›¸å…³çš„å…ƒæ•°æ®æ–‡ä»¶ï¼ˆæ”¾ç½®äºç‰¹å®šç›®å½•repodataä¸‹ï¼‰ï¼Œå½“yumå®¢æˆ·ç«¯
åˆ©ç”¨yum/dnfå·¥å…·è¿›è¡Œå®‰è£…æ—¶åŒ…æ—¶ï¼Œä¼šè‡ªåŠ¨ä¸‹è½½repodataä¸­çš„å…ƒæ•°æ®ï¼ŒæŸ¥è¯¢è¿œæ•°
æ®æ˜¯å¦å­˜åœ¨ç›¸å…³çš„åŒ…åŠä¾èµ–å…³ç³»ï¼Œè‡ªåŠ¨ä»ä»“åº“ä¸­æ‰¾åˆ°ç›¸å…³åŒ…ä¸‹è½½å¹¶å®‰è£…ã€‚
</p>

<p>
yumè·å–rpmåŒ…è¿‡ç¨‹ï¼š
</p>

<ol class="org-ol">
<li>å®¢æˆ·ç«¯è¿œç¨‹è¿æ¥åˆ°æä¾›èµ„æºçš„æœåŠ¡ç«¯æ±‚æƒ…æ•°æ®</li>
<li>æœåŠ¡ç«¯å°†ä¿æŒæœ‰åŒ…çš„ç›¸å…³å…ƒæ•°æ®ä¿¡æ¯æ–‡ä»¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œä¸è¿‡åœ¨è¿™ä¹‹å‰æœ‰ä¸€
æ¬¡å‘é€æ ¡éªŒç çš„è¿‡ç¨‹(repodataç›®å½•ä¸‹repomd.xmlæ–‡ä»¶)ï¼›é€šå¸¸å…ƒæ•°æ®æ–‡ä»¶æ”¾
åœ¨ç‰¹å®šçš„ç›®å½•ä¸‹ï¼Œè€Œæ¯ä¸ªå…ƒæ•°æ®æ–‡ä»¶éƒ½æœ‰ä¸ä¹‹å¯¹åº”çš„æ ¡éªŒç ä»¥æ–¹ä¾¿æŸ¥è¯¢å…¶å®Œ
æ•´æ€§ï¼›</li>
<li>å®¢æˆ·ç«¯å°†å…ƒæ•°æ®æ–‡ä»¶æ”¾ç½®äºæœ¬åœ°ç¼“å­˜åŒºåŸŸä¸­ï¼Œå¹¶æ ¹æ®å…ƒæ•°æ®æ–‡ä»¶åˆ†ææ˜¯å¦æœ‰
æ‰€éœ€çš„rpmåŒ…ååŠä¾èµ–å…³ç³»ç­‰ï¼›</li>
<li>å®¢æˆ·ç«¯æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰rpmåŒ…ç›¸å…³ä¾èµ–å…³ç³»çš„æ–‡ä»¶</li>
<li>å®¢æˆ·ç«¯è¿œç¨‹è¿æ¥è‡³æœåŠ¡ç«¯ä¸‹è½½æ‰€éœ€rpmåŒ…ï¼Œå¹¶ç¼“å­˜åˆ°æœ¬åœ°æ‰§è¡Œå®‰è£…ï¼›</li>
<li>å®¢æˆ·ç«¯é»˜è®¤ä¼šåˆ é™¤ä¸‹è½½çš„rpmåŒ…ï¼Œä½†å…ƒæ•°æ®æ–‡ä»¶ä¸ä¼šåˆ é™¤ï¼›</li>
</ol>
</div>
</div>
<div id="outline-container-h:11f69a5b-babf-4133-b4eb-7b4b6f01878b" class="outline-3">
<h3 id="h:11f69a5b-babf-4133-b4eb-7b4b6f01878b">yumå®¢æˆ·ç«¯é…ç½®</h3>
<div class="outline-text-3" id="text-h:11f69a5b-babf-4133-b4eb-7b4b6f01878b">
<p>
yumå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶
</p>

<div class="org-src-container">
<pre class="src src-sh">/etc/yum.conf                        <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20026;&#25152;&#26377;&#20179;&#24211;&#25552;&#20379;&#20844;&#20849;&#37197;&#32622;</span>
/etc/yum.repos.d/*.repo      <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20026;&#27599;&#20010;&#20179;&#24211;&#30340;&#25552;&#20379;&#37197;&#32622;&#25991;&#20214;</span>
</pre>
</div>

<p>
å¸®åŠ©å‚è€ƒï¼š man 5 yum.conf
</p>
</div>
<div id="outline-container-h:443242a3-12c4-42aa-9396-05141e1888f1" class="outline-4">
<h4 id="h:443242a3-12c4-42aa-9396-05141e1888f1">/etc/yum.confä¸»é…ç½®å®šä¹‰</h4>
<div class="outline-text-4" id="text-h:443242a3-12c4-42aa-9396-05141e1888f1">
<p>
èŒƒä¾‹ï¼šCentOS 8 é…ç½®æ–‡ä»¶
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]# ll /etc/yum.conf
lrwxrwxrwx. 1 root root 12 May 14  2019 /etc/yum.conf -&gt; dnf/dnf.conf

[root@centos8 ~]#cat /etc/yum.conf
[main]
<span style="color: #a0522d;">gpgcheck</span>=1   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23433;&#35013;&#21253;&#21069;&#35201;&#20570;&#21253;&#30340;&#21512;&#27861;&#21644;&#23436;&#25972;&#24615;&#26657;&#39564;</span>
<span style="color: #a0522d;">installonly_limit</span>=3 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21516;&#26102;&#21487;&#20197;&#23433;&#35013;3&#20010;&#21253;&#65292;&#26368;&#23567;&#20540;&#20026;2&#65292;&#22914;&#35774;&#20026;0&#25110;1&#65292;&#20026;&#19981;&#38480;&#21046;</span>
<span style="color: #a0522d;">clean_requirements_on_remove</span>=True  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21024;&#38500;&#21253;&#26102;&#65292;&#26159;&#21542;&#23558;&#19981;&#20877;&#20351;&#29992;&#30340;&#21253;&#21024;&#38500;</span>
<span style="color: #a0522d;">best</span>=True <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21319;&#32423;&#26102;&#65292;&#33258;&#21160;&#36873;&#25321;&#23433;&#35013;&#26368;&#26032;&#29256;&#65292;&#21363;&#20351;&#32570;&#23569;&#21253;&#30340;&#20381;&#36182;</span>
</pre>
</div>

<p>
èŒƒä¾‹ï¼šCentOS 7çš„é…ç½®æ–‡ä»¶
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos7 ~]# ll /etc/yum.conf
-rw-r--r--. 1 root root 970 Aug  8 19:57 /etc/yum.conf

[root@centos7 ~]# cat /etc/yum.conf
[main]
<span style="color: #a0522d;">cachedir</span>=/var/cache/yum/$<span style="color: #a0522d;">basearch</span>/$<span style="color: #a0522d;">releasever</span> <span style="color: #b22222;"># </span><span style="color: #b22222;">&#32531;&#23384;&#25991;&#20214;&#36335;&#24452;</span>
<span style="color: #a0522d;">keepcache</span>=0 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26412;&#22320;&#32531;&#23384;&#26159;&#21542;&#20445;&#23384;(rpm&#21253;)</span>
<span style="color: #a0522d;">debuglevel</span>=2 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#35843;&#35797;&#32423;&#21035;</span>
<span style="color: #a0522d;">logfile</span>=/var/log/yum.log   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23433;&#35013;&#30340;&#26085;&#24535;&#25991;&#20214;</span>
<span style="color: #a0522d;">exactarch</span>=1                     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26159;&#21542;&#31934;&#30830;&#24179;&#21488;release&#21305;&#37197;</span>
<span style="color: #a0522d;">obsoletes</span>=1   
<span style="color: #a0522d;">gpgcheck</span>=1                     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26159;&#21542;&#26816;&#26597;&#26469;&#28304;&#21512;&#27861;&#24615;&#21644;&#23436;&#25972;&#24615;</span>
<span style="color: #a0522d;">plugins</span>=1                         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26159;&#21542;&#25903;&#25345;&#25554;&#20214;&#26426;&#21046;</span>
<span style="color: #a0522d;">installonly_limit</span>=5              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21516;&#26102;&#23433;&#35013;&#20960;&#20010;&#31243;&#24207;&#21253;</span>
<span style="color: #a0522d;">bugtracker_url</span>=http://bugs.centos.org/set_project.php? <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36861;&#36394;bug&#36335;&#24452;</span>
<span style="color: #a0522d;">project_id</span>=23&amp;<span style="color: #a0522d;">ref</span>=http://bugs.centos.org/bug_report_page.php?<span style="color: #a0522d;">category</span>=yum
<span style="color: #a0522d;">distroverpkg</span>=centos-release <span style="color: #b22222;"># </span><span style="color: #b22222;">&#24403;&#21069;&#21457;&#34892;&#29256;&#29256;&#26412;&#21495;&#20174;&#21738;&#20799;&#33719;&#21462;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:352c0b6b-420b-46fa-a986-0414b2618646" class="outline-4">
<h4 id="h:352c0b6b-420b-46fa-a986-0414b2618646">ä»“åº“(*.repo)é…ç½®æ–‡ä»¶å®šä¹‰ï¼š</h4>
<div class="outline-text-4" id="text-h:352c0b6b-420b-46fa-a986-0414b2618646">
<p>
repoä»“åº“é…ç½®æ–‡ä»¶æŒ‡å‘çš„å®šä¹‰ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">[repositoryID]  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20179;&#24211;ID&#65292;&#21807;&#19968;&#26631;&#35782;&#21035;&#65292;&#19981;&#33021;&#37325;&#22797;</span>
<span style="color: #a0522d;">name</span>=Some name for this repository  <span style="color: #b22222;">#  </span><span style="color: #b22222;">&#23436;&#25972;&#30340;&#20179;&#24211;&#21517;&#31216;&#65292;&#27880;&#24847; = &#31561;&#21495;&#24038;&#21491;&#19981;&#35201;&#26377;&#31354;&#26684;&#65292;&#21542;&#21017;&#21487;&#33021;&#20250;&#20986;&#29616;&#35821;&#27861;&#38169;&#35823;</span>
<span style="color: #a0522d;">baseurl</span>=url://path/to/repository/    <span style="color: #b22222;"># </span><span style="color: #b22222;">yum&#20179;&#24211;&#25351;&#26126;&#30340;&#35775;&#38382;&#36335;&#24452;&#65292;&#22810;&#20010;url&#25442;&#34892;&#20889;&#12290;repodata &#25152;&#22312;&#30340;&#36335;&#24452;&#23601;&#26159; yum &#28304;&#25351;&#21521;&#30340;&#36335;&#24452;.</span>
<span style="color: #a0522d;">enabled</span>={1|0} <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26159;&#21542;&#21551;&#29992;&#27492;&#20179;&#24211;&#65292;&#40664;&#35748;1&#21551;&#21160;</span>

&#20854;&#23427;&#36873;&#39033;&#65306;
<span style="color: #a0522d;">keepcache</span>={1|0}   : &#26412;&#22320;&#32531;&#23384;&#26159;&#21542;&#20445;&#23384;(rpm&#21253;)
<span style="color: #a0522d;">enabled</span>={1|0} : &#26159;&#21542;&#21551;&#29992;&#27492;&#20179;&#24211;&#65292;&#40664;&#35748;&#21551;&#21160;
<span style="color: #a0522d;">gpgcheck</span>={1|0}  : &#26159;&#21542;&#26816;&#26597;&#26469;&#28304;&#21512;&#27861;&#24615;&#21644;&#23436;&#25972;&#24615;, &#40664;&#35748;1&#26816;&#26597;
<span style="color: #a0522d;">repo_gpgcheck</span>={1|0}  : &#26816;&#26597;&#20803;&#25968;&#25454;&#23436;&#25972;&#24615;
<span style="color: #a0522d;">gpgkey</span>=URL : &#31192;&#38053;&#25991;&#20214;&#20301;&#32622;&#65292;&#21487;&#33021;&#26159;&#23545;&#26041;&#20179;&#24211;&#25552;&#20379;
<span style="color: #a0522d;">enablegroups</span>={1|0}  : &#26159;&#21542;&#25903;&#25345;&#32452;&#25209;&#37327;&#31649;&#29702;&#31243;&#24207;&#21253;&#65292;&#40664;&#35748;&#25903;&#25345;
<span style="color: #a0522d;">failovermethod</span>={roundrobin|priority} : &#25351;&#26126;baseurl&#26377;&#22810;&#20010;&#26102;&#30340;&#20248;&#20808;&#32423;&#65307;
    roundrobin&#65306;&#24847;&#20026;&#38543;&#26426;&#25361;&#36873;&#65292;&#40664;&#35748;&#20540;
    priority:&#25353;&#39034;&#24207;&#35775;&#38382;&#65292;&#19978;&#32780;&#19979;&#35831;&#27714;
<span style="color: #a0522d;">cost</span>=   : &#24320;&#38144;&#65307;&#40664;&#35748;&#20026;1000&#65307;&#22810;&#20010;&#20179;&#24211;&#37324;&#37117;&#26377;&#21516;&#19968;&#20010;rpm&#21253;&#21487;&#23450;&#20041;&#24320;&#38144;&#65292;&#36234;&#23567;&#36234;&#20808;&#35775;&#38382;&#65307;

mirrorlist   :  &#20197;&#38236;&#20687;&#26041;&#24335;&#25351;&#23450; baseurl&#12290; &#19968;&#20010; baseurl &#22312;&#25351;&#23450;&#22810;&#20010; url &#26102;&#31649;&#29702;&#36215;&#26469;&#19981;&#26041;&#20415;&#65292;&#22312;&#20114;&#32852;&#32593;&#20013;&#25214;&#19968;&#21488;&#26381;&#21153;&#22120;&#65292;&#22312;&#26381;&#21153;&#22120;&#19978;&#30340;&#36890;&#36807;&#25991;&#20214;&#26381;&#21153;&#30340;&#20849;&#20139;&#20301;&#32622;&#21019;&#24314;&#19968;&#20010;&#25991;&#26412;&#25991;&#20214;&#65292;&#22312;&#25991;&#26412;&#25991;&#20214;&#20013;&#21015;&#34920;&#20986; baseurl &#30340;&#35775;&#38382;&#36335;&#24452;&#65292;mirrorlist&#25351;&#21521;&#36825;&#20010;&#25991;&#26412;&#25991;&#20214;&#12290;&#20351;&#29992;mirrorlist &#35201;&#27714; yum &#26377;&#25554;&#20214;&#21151;&#33021;
bandwidth : &#24102;&#23485;&#38480;&#21046;

username : &#29992;&#25143;&#21517;
password : &#26377;&#20123;&#26381;&#21153;&#22120;&#35775;&#38382;&#26102;&#38656;&#35201;&#29992;&#25143;&#26469;&#23494;&#30721;
<span style="color: #a0522d;">keepalive</span>=&#65371;1|0&#65373;: &#26159;&#21542;&#20351;&#29992;&#20445;&#25345;&#36830;&#25509;

&#35828;&#26126;&#65306;
1) *.repo&#21487;&#20197;&#23558;&#22810;&#20010;[repositoryID]&#30340;&#37197;&#32622;&#20449;&#24687;&#25918;&#22312;&#19968;&#20010;&#32780;&#25991;&#20214;&#20869;&#65292;&#20063;&#21487;&#20197;&#20999;&#25104;&#22810;&#20010;&#26041;&#20415;&#31649;&#29702;
2) baseurl&#21487;&#20197;&#20351;&#29992;&#65306;ftp://&#12289;http://&#12289;nfs://&#12289;file:///  &#25351;&#26126;URL&#36335;&#24452;
3)baseurl&#31561;&#21495;&#20004;&#36793;&#19981;&#33021;&#26377;&#31354;&#26684;&#65292;&#20854;&#21518;&#21487;&#20197;&#22635;&#20889;&#22810;&#20010;&#38236;&#20687;&#35775;&#38382;&#36335;&#24452;&#65292;&#27599;&#34892;&#19968;&#20010;&#65292;&#19981;&#33021;&#39030;&#34892;&#20889;
&#22810;&#20010;&#35775;&#38382;&#36335;&#24452;&#38388;&#32852;&#31995;&#26159;&#38236;&#20687;&#30456;&#21516;&#65292;&#30446;&#30340;&#26159;&#20026;&#20102;&#20570;&#22791;&#29992;&#35775;&#38382;
4)&#26356;&#22810;&#36873;&#39033;&#20351;&#29992;man  5  yum.conf&#26597;&#30475;&#65292;&#22522;&#26412;&#37197;&#32622;&#21482;&#38656;&#21069;&#19977;&#34892;&#23601;&#21487;&#20197;        
5)&#21457;&#34892;&#29256;&#20809;&#30424;&#38236;&#20687;&#23433;&#35013;&#21487;&#33021;&#20250;&#33258;&#21160;&#37197;&#32622;&#32593;&#32476;&#38236;&#20687;URL&#22320;&#22336;
</pre>
</div>

<p>
yumæœåŠ¡å™¨çš„baseurlå½¢å¼
</p>
<pre class="example" id="org6add99b">
file:// æœ¬åœ°è·¯å¾„
http://
https://
ftp:// 
</pre>

<p>
<b>æ³¨æ„ï¼šyumä»“åº“æŒ‡å‘çš„è·¯å¾„ä¸€å®šå¿…é¡»æ˜¯repodataç›®å½•æ‰€åœ¨ç›®å½•</b>
</p>

<p>
<b>ç›¸å…³å˜é‡</b>
</p>
<div class="org-src-container">
<pre class="src src-sh">yum&#30340;repo&#37197;&#32622;&#25991;&#20214;&#20013;&#21487;&#29992;&#30340;&#21464;&#37327;&#65306;
$<span style="color: #a0522d;">releasever</span>         <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24403;&#21069;OS&#30340;&#21457;&#34892;&#29256;&#30340;&#20027;&#29256;&#26412;&#21495;&#65292;&#22914;&#65306;8&#65292;7&#65292;6</span>
$<span style="color: #a0522d;">arch</span>                   <span style="color: #b22222;">#</span><span style="color: #b22222;">CPU&#26550;&#26500;&#65292;&#22914;&#65306;aarch64, i586, i686&#65292;x86_64&#31561;</span>
$<span style="color: #a0522d;">basearch</span>          <span style="color: #b22222;">#</span><span style="color: #b22222;">&#31995;&#32479;&#22522;&#30784;&#24179;&#21488;&#65307;i386, x86_64</span>
$<span style="color: #a0522d;">contentdir</span>        <span style="color: #b22222;">#</span><span style="color: #b22222;">&#34920;&#31034;&#30446;&#24405;&#65292;&#27604;&#22914;&#65306;centos-8&#65292;centos-7</span>
$<span style="color: #a0522d;">YUM0</span>-$<span style="color: #a0522d;">YUM9</span> <span style="color: #b22222;">#</span><span style="color: #b22222;">&#33258;&#23450;&#20041;&#21464;&#37327;</span>
</pre>
</div>

<p>
èŒƒä¾‹ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">http://server/centos/$<span style="color: #a0522d;">releasever</span>/$<span style="color: #a0522d;">basearch</span>/
http://server/centos/7/x86_64
http://server/centos/6/i386
</pre>
</div>

<p>
<b>baseurlæŒ‡å‘çš„è·¯å¾„</b>
</p>

<p>
é˜¿é‡Œäº‘æä¾›äº†å†™å¥½çš„CentOSå’Œubuntuçš„ä»“åº“æ–‡ä»¶ä¸‹è½½é“¾æ¥<a href="http://mirrors.aliyun.com/repo/">http://mirrors.aliyun.com/repo/</a>
</p>

<p>
Rocky ç³»ç»Ÿyunæº
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#21335;&#20140;&#22823;&#23398;</span>
https://mirror.nju.edu.cn/rocky/$<span style="color: #a0522d;">releasever</span>/

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#19978;&#28023;&#20132;&#22823;</span>
https://mirror.sjtu.edu.cn/rocky/$<span style="color: #a0522d;">releasever</span>/

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23665;&#19996;&#22823;&#23398;</span>
https://mirrors.sdu.edu.cn/rocky/$<span style="color: #a0522d;">releasever</span>/
</pre>
</div>

<p>
CentOSç³»ç»Ÿçš„yumæº
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#38463;&#37324;&#20113;</span>
https://mirrors.aliyun.com/centos/$<span style="color: #a0522d;">releasever</span>/

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#28165;&#21326;&#22823;&#23398;</span>
https://mirrors.tuna.tsinghua.edu.cn/centos/$<span style="color: #a0522d;">releasever</span>/

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21326;&#20026;&#20113;</span>
https://mirrors.huaweicloud.com/centos/$<span style="color: #a0522d;">releasever</span>/
</pre>
</div>

<p>
EPELçš„yumæº
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#38463;&#37324;&#20113;</span>
https://mirrors.aliyun.com/epel/$<span style="color: #a0522d;">releasever</span>/

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#33150;&#35759;&#20113;</span>
https://mirrors.cloud.tencent.com/centos/$<span style="color: #a0522d;">releasever</span>/

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21326;&#20026;&#20113;</span>
https://mirrors.huaweicloud.com/epel/$<span style="color: #a0522d;">releasever</span>/

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#28165;&#21326;&#22823;&#23398;</span>
https://mirrors.tuna.tsinghua.edu.cn/epel/$<span style="color: #a0522d;">releasever</span>/
</pre>
</div>

<p>
é˜¿é‡Œå·´å·´å¼€æºè½¯ä»¶
</p>
<div class="org-src-container">
<pre class="src src-sh">https://opsx.alibaba.com/
</pre>
</div>

<p>
èŒƒä¾‹ï¼šä¸ºCentOS7ç”¨ç³»ç»Ÿå®‰è£…å…‰ç›˜ä½œçš„æœ¬åœ°yumä»“åº“
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#25346;&#36733;&#20809;&#30424;&#33267;&#26576;&#30446;&#24405;,&#22914;/mnt/cdrom</span>
mount /dev/cdrom /mnt/cdrom

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21019;&#24314;&#37197;&#32622;&#25991;&#20214;</span>
[root@centos7 ~]#vim /etc/yum.repos.d/centos7.repo
[CentOS7]
<span style="color: #a0522d;">name</span>=CentOS 7
<span style="color: #a0522d;">baseurl</span>=file:///mnt/cdrom
<span style="color: #a0522d;">gpgcheck</span>=0
<span style="color: #a0522d;">enabled</span>=1
</pre>
</div>

<p>
èŒƒä¾‹ï¼šä¸ºRockyé…ç½® yum çš„ç³»ç»Ÿå’ŒEPELæºä»“åº“
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#25903;&#25345;&#20809;&#30424;&#65292; /misc/cd&#23545;&#24212;&#23601;&#26159;&#20809;&#30424;&#20869;&#23481;</span>
yum install autofs
systemctl enable --now autofs
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#cat /etc/yum.repos.d/base.repo
[BaseOS]
<span style="color: #a0522d;">name</span>=BaseOS
<span style="color: #a0522d;">baseurl</span>=file:///misc/cd/BaseOS
               https://mirror.nju.edu.cn/rocky/$<span style="color: #a0522d;">releasever</span>/BaseOS/$<span style="color: #a0522d;">basearch</span>/os/
<span style="color: #a0522d;">gpgcheck</span>=1
<span style="color: #a0522d;">gpgkey</span>=/etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial               

[AppStream]
<span style="color: #a0522d;">name</span>=AppStream
<span style="color: #a0522d;">baseurl</span>=file:///misc/cd/AppStream
               https://mirror.nju.edu.cn/rocky/$<span style="color: #a0522d;">releasever</span>/AppStream/$<span style="color: #a0522d;">basearch</span>/os/
<span style="color: #a0522d;">gpgcheck</span>=0

[extras]
<span style="color: #a0522d;">name</span>=extras
<span style="color: #a0522d;">baseurl</span>=https://mirror.nju.edu.cn/rocky/$<span style="color: #a0522d;">releasever</span>/extras/$<span style="color: #a0522d;">basearch</span>/os/
<span style="color: #a0522d;">gpgcheck</span>=0

[epel]
<span style="color: #a0522d;">name</span>=EPEL
<span style="color: #a0522d;">baseurl</span>=http://mirrors.aliyun.com/epel/$<span style="color: #a0522d;">releasever</span>/Everything/$<span style="color: #a0522d;">basearch</span>
               https://mirrors.tuna.tsinghua.edu.cn/epel/$<span style="color: #a0522d;">releasever</span>/Everything/$<span style="color: #a0522d;">basearch</span>/
<span style="color: #a0522d;">gpgcheck</span>=0
<span style="color: #a0522d;">enabled</span>=1
</pre>
</div>

<p>
æ³¨æ„ï¼šä¸ä¹‹å‰çš„ç‰ˆæœ¬ä¸åŒï¼ŒCentOS 8 ç³»ç»Ÿæœ‰ä¸¤ä¸ªyum æºï¼šBaseOSå’ŒAppStreamï¼Œ
éœ€è¦åˆ†åˆ«è®¾ç½®ä¸¤ä¸ªä»“åº“
</p>

<p>
èŒƒä¾‹ï¼šç”¨è„šæœ¬å®ç°åˆ›å»ºyumä»“åº“é…ç½®æ–‡ä»¶
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos7 ~]# cat yum.sh
<span style="color: #b22222;">#</span><span style="color: #b22222;">!/bin/bash</span>
mkdir /etc/yum.repos.d/backup
mv /etc/yum.repos.d/*.repo /etc/yum.repos.d/backup

cat &gt; /etc/yum.repos.d/base.repo &lt;&lt;EOF
<span style="color: #ffa54f;">[base]</span>
<span style="color: #ffa54f;">name=base</span>
<span style="color: #ffa54f;">baseurl=https://mirrors.aliyun.com/centos/\$releasever/os/\$basearch</span>
<span style="color: #ffa54f;">gpgcheck=0</span>
<span style="color: #ffa54f;">EOF</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:dffb8357-f15a-4707-8041-e1dfc59eb216" class="outline-4">
<h4 id="h:dffb8357-f15a-4707-8041-e1dfc59eb216">yum-config-managerå‘½ä»¤</h4>
<div class="outline-text-4" id="text-h:dffb8357-f15a-4707-8041-e1dfc59eb216">
<p>
å¯ä»¥ç”Ÿæˆyumä»“åº“çš„é…ç½®æ–‡ä»¶åŠå¯ç”¨æˆ–ç¦ç”¨ä»“åº“ï¼Œæ¥è‡ªäºyum-utilsåŒ…
</p>

<p>
æ ¼å¼ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">yum-config-manager --add-repo URL&#25110;file   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22686;&#21152;&#20179;&#24211;</span>
yum-config-manager --disable <span style="color: #8b2252;">"&#20179;&#24211;&#21517;"</span>        <span style="color: #b22222;">#</span><span style="color: #b22222;">&#31105;&#29992;&#20179;&#24211;</span>
yum-config-manager --enable <span style="color: #8b2252;">"&#20179;&#24211;&#21517;"</span>         <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21551;&#29992;&#20179;&#24211;</span>
</pre>
</div>

<p>
èŒƒä¾‹ï¼šåˆ›å»ºä»“åº“é…ç½®
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#rpm -qf <span style="color: #ff00ff;">`which yum-config-manager `</span>
dnf-utils-4.0.2.2-3.el8.noarch

[root@centos8 ~]#yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
Adding repo from: https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
[root@centos8 ~]#ls /etc/yum.repos.d/
backup base.repo docker-ce.repo
</pre>
</div>

<p>
èŒƒä¾‹ï¼šåˆ›å»ºä»“åº“é…ç½®
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#29983;&#25104;172.16.0.1_cobbler_ks_mirror_8_.repo</span>
[root@centos8 ~]#yum-config-manager --add-repo=http://172.16.0.1/cobbler/ks_mirror/8/

[root@centos8 ~]#cat /etc/yum.repos.d/172.16.0.1_cobbler_ks_mirror_8_.repo
[172.16.0.1_cobbler_ks_mirror_8_]
<span style="color: #a0522d;">name</span>=created by dnf config-manager from http://172.16.0.1/cobbler/ks_mirror/8/
<span style="color: #a0522d;">baseurl</span>=http://172.16.0.1/cobbler/ks_mirror/8/
<span style="color: #a0522d;">enabled</span>=1
</pre>
</div>

<p>
èŒƒä¾‹ï¼šåˆ›å»ºä»“åº“é…ç½®
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#ls /etc/yum.repos.d/
backup base.repo
[root@centos8 ~]#yum-config-manager --add-repo /data/docker-ce.repo
Adding repo from: file:///data/docker-ce.repo
[root@centos8 ~]#ls /etc/yum.repos.d/
backup base.repo docker-ce.repo
[root@centos8 ~]#yum repolist
</pre>
</div>

<p>
èŒƒä¾‹ï¼šå¯ç”¨å’Œç¦ç”¨ä»“åº“
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#yum-config-manager --disable epel  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#31105;&#29992;epel&#28304;</span>
[root@centos8 ~]#cat /etc/yum.repos.d/base.repo
[BaseOS]
<span style="color: #a0522d;">name</span>=BaseOS
<span style="color: #a0522d;">baseurl</span>=file:///misc/cd/BaseOS
<span style="color: #a0522d;">gpgcheck</span>=0
[AppStream]
<span style="color: #a0522d;">name</span>=AppStream
<span style="color: #a0522d;">baseurl</span>=file:///misc/cd/AppStream
<span style="color: #a0522d;">gpgcheck</span>=0
[epel]
<span style="color: #a0522d;">name</span>=EPEL
<span style="color: #a0522d;">baseurl</span>=http://mirrors.aliyun.com/epel/$<span style="color: #a0522d;">releasever</span>/Everything/$<span style="color: #a0522d;">basearch</span>
   http://mirrors.huaweicloud.com/epel/$<span style="color: #a0522d;">releasever</span>/Everything/$<span style="color: #a0522d;">basearch</span>
<span style="color: #a0522d;">gpgcheck</span>=0
<span style="color: #a0522d;">enabled</span>=0
[extras]
<span style="color: #a0522d;">name</span>=extras
<span style="color: #a0522d;">baseurl</span>=https://mirrors.aliyun.com/centos/$<span style="color: #a0522d;">releasever</span>/extras/$<span style="color: #a0522d;">basearch</span>/os
   http://mirrors.huaweicloud.com/centos/$<span style="color: #a0522d;">releasever</span>/extras/$<span style="color: #a0522d;">basearch</span>/os
<span style="color: #a0522d;">gpgcheck</span>=0
<span style="color: #a0522d;">enabled</span>=1
[root@centos8 ~]#yum repolist

[root@centos8 ~]#yum-config-manager --disable extras
[root@centos8 ~]#yum repolist
BaseOS               3.8 MB/s | 3.9 kB   00:00  
AppStream              4.2 MB/s | 4.3 kB   00:00  
repo id        repo name                      status
AppStream       AppStream                      4,755
BaseOS        BaseOS                        1,659
[root@centos8 ~]#yum-config-manager --enable extras
[root@centos8 ~]#yum repolist
BaseOS                 3.8 MB/s | 3.9 kB   00:00  
AppStream               4.2 MB/s | 4.3 kB   00:00  
extras                 12 kB/s | 1.5 kB   00:00  
repo id        repo name                      status
AppStream       AppStream                      4,755
BaseOS        BaseOS                        1,659
extras extras                         12
</pre>
</div>
</div>
</div>
<div id="outline-container-h:c7e0b143-26b2-45bc-b851-f853ccc21c09" class="outline-4">
<h4 id="h:c7e0b143-26b2-45bc-b851-f853ccc21c09">é”å®šè½¯ä»¶ç‰ˆæœ¬</h4>
<div class="outline-text-4" id="text-h:c7e0b143-26b2-45bc-b851-f853ccc21c09">
<p>
é”å®šåç‰ˆæœ¬æ— æ³•æ›´æ–°
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo cat /etc/yum/pluginconf.d/versionlock.conf
[main]
<span style="color: #a0522d;">enabled</span> = 1
<span style="color: #a0522d;">locklist</span> = /etc/yum/pluginconf.d/versionlock.list
<span style="color: #b22222;">#  </span><span style="color: #b22222;">Uncomment this to lock out "upgrade via. obsoletes" etc. (slower)</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">follow_obsoletes = 1</span>

cat /etc/yum/pluginconf.d/versionlock.list

<span style="color: #b22222;"># </span><span style="color: #b22222;">Added locks on Sat Mar  4 23:44:04 2023</span>
0:kernel-5.4.231-137.341.amzn2.*

<span style="color: #b22222;"># </span><span style="color: #b22222;">Added locks on Sat Mar  4 23:44:14 2023</span>
0:runc-1.1.4-1.amzn2.*

<span style="color: #b22222;"># </span><span style="color: #b22222;">Added locks on Sat Mar  4 23:44:20 2023</span>
0:containerd-1.6.6-1.amzn2.0.2.*

<span style="color: #b22222;"># </span><span style="color: #b22222;">Added locks on Sat Mar  4 23:44:47 2023</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:cba0e6bc-ecc7-4dea-8806-52951d45d63d" class="outline-3">
<h3 id="h:cba0e6bc-ecc7-4dea-8806-52951d45d63d">yumå‘½ä»¤</h3>
<div class="outline-text-3" id="text-h:cba0e6bc-ecc7-4dea-8806-52951d45d63d">
<p>
yumå‘½ä»¤çš„ç”¨æ³•ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">yum [options] [command] [package ...]
</pre>
</div>

<p>
yumçš„å‘½ä»¤è¡Œé€‰é¡¹ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">-y <span style="color: #b22222;">#</span><span style="color: #b22222;">&#33258;&#21160;&#22238;&#31572;&#20026;"yes"</span>
-q <span style="color: #b22222;">#</span><span style="color: #b22222;">&#38745;&#40664;&#27169;&#24335;</span>
--nogpgcheck <span style="color: #b22222;">#</span><span style="color: #b22222;">&#31105;&#27490;&#36827;&#34892;gpg check</span>
--enablerepo=repoidglob   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20020;&#26102;&#21551;&#29992;&#27492;&#22788;&#25351;&#23450;&#30340;repo&#65292;&#25903;&#25345;&#36890;&#37197;&#31526;&#65292;&#22914;&#65306;"*"</span>
--disablerepo=repoidglob <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20020;&#26102;&#31105;&#29992;&#27492;&#22788;&#25351;&#23450;&#30340;repo,&#21644;&#19978;&#38754;&#35821;&#21477;&#21516;&#26102;&#20351;&#29992;&#65292;&#25918;&#22312;&#21518;&#38754;&#30340;&#29983;&#25928;</span>
--showduplicates &#22914;&#26524;&#22810;&#21152;&#20102;&#20179;&#24211;&#28304;&#65292;&#21487;&#26174;&#31034;&#21253;&#30340;&#22810;&#20010;&#29256;&#26412;
</pre>
</div>
</div>
<div id="outline-container-h:20020b7b-fb37-458f-b470-ae93033ae661" class="outline-4">
<h4 id="h:20020b7b-fb37-458f-b470-ae93033ae661">æ˜¾ç¤ºä»“åº“åˆ—è¡¨</h4>
<div class="outline-text-4" id="text-h:20020b7b-fb37-458f-b470-ae93033ae661">
<div class="org-src-container">
<pre class="src src-sh">yum repolist [all|enabled|disabled]

-v    <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26174;&#31034;&#20179;&#24211;&#20449;&#24687;&#65292;&#21253;&#24635;&#25968;&#12289;&#24635;&#22823;&#23567;&#31561;</span>
</pre>
</div>

<p>
èŒƒä¾‹ï¼š
</p>
<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#yum repolist
[root@centos8 ~]#yum repolist all
[root@centos8 ~]#yum repolist -v
......
pkgsack time: 0.011
Repo-id      : base/7/x86_64
Repo-name    : CentOS-7 - Base
Repo-revision: 1604001756
Repo-updated : Thu Oct 29 20:03:00 2020
Repo-pkgs    : 10,072
Repo-size    : 8.9 G
Repo-mirrors : http://mirrorlist.centos.org/?<span style="color: #a0522d;">release</span>=7&amp;<span style="color: #a0522d;">arch</span>=x86_64&amp;<span style="color: #a0522d;">repo</span>=os&amp;<span style="color: #a0522d;">infra</span>=genclo
Repo-baseurl : https://download.cf.centos.org/centos/7/os/x86_64/ (1 more)
Repo-expire  : 21,600 second(s) (last: Mon Sep 23 05:38:09 2024)
  Filter     : read-only:present
Repo-filename: /etc/yum.repos.d/CentOS-Base.repo

[root@centos8 ~]#yum --enablerepo=ep* --disablerepo=A* repolist  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20020;&#26102;&#31105;&#29992;ep&#24320;&#22836;&#30340;&#28304;&#65292;&#21551;&#29992;A&#24320;&#22836;&#30340;&#28304;</span>
Last metadata expiration check: 0:01:18 ago on Sun 29 Dec 2019 12:13:27 AM CST.
repo id          repo name                     
status
BaseOS           BaseOS                      
 1,657
epel            EPEL                       
 3,733
</pre>
</div>
</div>
</div>
<div id="outline-container-h:f767d76f-2dc8-46ea-adb4-e68dbf531e2c" class="outline-4">
<h4 id="h:f767d76f-2dc8-46ea-adb4-e68dbf531e2c">æ˜¾ç¤ºç¨‹åºåŒ…</h4>
<div class="outline-text-4" id="text-h:f767d76f-2dc8-46ea-adb4-e68dbf531e2c">
<div class="org-src-container">
<pre class="src src-sh">yum list
yum list [all | glob_exp1] [glob_exp2] [...]
yum list {available|installed|updates} [glob_exp1] [...]
</pre>
</div>

<p>
èŒƒä¾‹ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 data]#dnf list mariadb-server
[root@centos8 data]#dnf list mariadb*  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25903;&#25345;&#36890;&#37197;&#31526;</span>

[root@centos8 data]#dnf list mariadb-server --showduplicates  <span style="color: #b22222;"># </span><span style="color: #b22222;">--showduplicates &#22914;&#26524;&#22810;&#21152;&#20102;&#20179;&#24211;&#28304;&#65292;&#21487;&#26174;&#31034;&#21253;&#30340;&#22810;&#20010;&#29256;&#26412;</span>

[root@centos8 data]#dnf list mariadb-server  --disablerepo=AppStream

[root@centos8 data]#dnf list mariadb-server --showduplicates --disablerepo=AppStream
Last metadata expiration check: 0:05:41 ago on Sun 08 Dec 2019 04:11:17 PM CST.
Available Packages
MariaDB-server.x86_64                  10.3.17-1.el8      mariadb
MariaDB-server.x86_64                  10.3.18-1.el8      mariadb
MariaDB-server.x86_64                  10.3.20-1.el8      mariadb
MariaDB-server.x86_64                  10.4.7-1.el8      mariadb2
MariaDB-server.x86_64                  10.4.8-1.el8      mariadb2
MariaDB-server.x86_64                  10.4.10-1.el8      
mariadb2
[root@centos8 ~]#yum --disablerepo=<span style="color: #8b2252;">"A*"</span> --disablerepo=<span style="color: #8b2252;">"B*"</span> --disablerepo=<span style="color: #8b2252;">"e*"</span> list available  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36807;&#28388;&#20986;&#21487;&#29992;&#30340;&#21253;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:8cb17a52-2951-42a3-9c8d-357901b3c0ea" class="outline-4">
<h4 id="h:8cb17a52-2951-42a3-9c8d-357901b3c0ea">å®‰è£…ç¨‹åºåŒ…</h4>
<div class="outline-text-4" id="text-h:8cb17a52-2951-42a3-9c8d-357901b3c0ea">
<div class="org-src-container">
<pre class="src src-sh">yum install package1 [package2] [...]
yum reinstall package1 [package2] [...] <span style="color: #b22222;">#</span><span style="color: #b22222;">&#37325;&#26032;&#23433;&#35013;</span>
</pre>
</div>


<p>
èŒƒä¾‹ï¼šåªç”¨ base æºå®‰è£…æœåŠ¡
</p>

<div class="org-src-container">
<pre class="src src-sh">yum -y --disablerepo=* --enablerepo=base install bridge-utils
</pre>
</div>

<p>
èŒƒä¾‹ï¼šå®‰è£…epelæº
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos7 ~]#yum remove epel-release
[root@centos7 ~]#yum -y install sl
[root@centos7 ~]#rpm -ql sl

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#36816;&#34892;&#23433;&#35013;sl&#31243;&#24207;&#65292;&#21487;&#20197;&#30475;&#21040;&#19979;&#38754;&#28779;&#36710;&#65292;&#36825;&#26631;&#24535;&#30528;&#25105;&#20204;&#21487;&#20197;&#24403;&#32769;&#21496;&#26426;&#20102;</span>
[root@centos7 ~]#sl -a
</pre>
</div>
</div>
<div id="outline-container-h:b76289ec-56f5-4271-8f29-d98e13b0b6a8" class="outline-5">
<h5 id="h:b76289ec-56f5-4271-8f29-d98e13b0b6a8">èŒƒä¾‹ï¼šåªä¸‹è½½ä¸å®‰è£…</h5>
<div class="outline-text-5" id="text-h:b76289ec-56f5-4271-8f29-d98e13b0b6a8">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#26041;&#27861;1 yum </span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#19979;&#36733;&#21253;&#21040;&#25351;&#23450;&#30446;&#24405;</span>
yum install --downloadonly --downloaddir=/tmp/php/ php73-php-fpm

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22312;CentOS/RHEL 6&#25110;&#26356;&#26089;&#26399;&#30340;&#29256;&#26412;&#20013;&#65292;&#20320;&#38656;&#35201;&#23433;&#35013;&#19968;&#20010;&#21333;&#29420;yum&#25554;&#20214;(&#21517;&#31216;&#20026; yum-plugin-downloadonly)&#25165;&#33021;&#20351;&#29992;--downloadonly&#21629;&#20196;&#36873;&#39033;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26041;&#27861;2 yumdownloader</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21478;&#22806;&#19968;&#20010;&#19979;&#36733;RPM&#21253;&#30340;&#26041;&#27861;&#23601;&#26159;&#36890;&#36807;&#19968;&#20010;&#19987;&#38376;&#30340;&#21253;&#19979;&#36733;&#24037;&#20855;--yumdownloader&#12290; &#36825;&#20010;&#24037;&#20855;&#26159;yum&#24037;&#20855;&#21253;(&#21253;&#21547;&#20102;&#29992;&#26469;&#36827;&#34892;yum&#21253;&#31649;&#29702;&#30340;&#24110;&#21161;&#24037;&#20855;&#22871;&#20214;)&#30340;&#23376;&#38598;&#12290;</span>
yum install yum-utils 
yumdownloader lsof --resolve --destdir=/data/mydepot/  <span style="color: #b22222;">#</span><span style="color: #b22222;">resolve&#19979;&#36733;&#20381;&#36182;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:c02ccb31-a0ec-4eb5-a1e3-f735f0c6a8b9" class="outline-5">
<h5 id="h:c02ccb31-a0ec-4eb5-a1e3-f735f0c6a8b9">èŒƒä¾‹ï¼šåˆ©ç”¨elrepoæºåœ¨CentOS 7 å®‰è£…æ–°ç‰ˆå†…æ ¸</h5>
<div class="outline-text-5" id="text-h:c02ccb31-a0ec-4eb5-a1e3-f735f0c6a8b9">
<p>
<a href="https://www.elrepo.org/">https://www.elrepo.org/</a>
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos7 ~]#yum install https://www.elrepo.org/elrepo-release-7.0-4.el7.elrepo.noarch.rpm
[root@centos7 ~]#rpm -ql elrepo-release-7.0-4.el7.elrepo
/etc/pki/elrepo
/etc/pki/elrepo/SECURE-BOOT-KEY-elrepo.org.der
/etc/pki/rpm-gpg
/etc/pki/rpm-gpg/RPM-GPG-KEY-elrepo.org
/etc/yum.repos.d
/etc/yum.repos.d/elrepo.repo

[root@centos7 ~]#yum repolist

[root@centos7 ~]#cat /etc/yum.repos.d/elrepo.repo
... ...
[elrepo-kernel]
<span style="color: #a0522d;">name</span>=ELRepo.org Community Enterprise Linux Kernel Repository - el7
<span style="color: #a0522d;">baseurl</span>=http://elrepo.org/linux/kernel/el7/$<span style="color: #a0522d;">basearch</span>/
http://mirrors.coreix.net/elrepo/kernel/el7/$<span style="color: #a0522d;">basearch</span>/
http://mirror.rackspace.com/elrepo/kernel/el7/$<span style="color: #a0522d;">basearch</span>/
http://repos.lax-noc.com/elrepo/kernel/el7/$<span style="color: #a0522d;">basearch</span>/
<span style="color: #a0522d;">mirrorlist</span>=http://mirrors.elrepo.org/mirrors-elrepo-kernel.el7
<span style="color: #a0522d;">enabled</span>=0
<span style="color: #a0522d;">gpgcheck</span>=1
<span style="color: #a0522d;">gpgkey</span>=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-elrepo.org
<span style="color: #a0522d;">protect</span>=0
... ...


[root@centos7 ~]#yum --disablerepo=<span style="color: #8b2252;">"*"</span> --enablerepo=<span style="color: #8b2252;">"elrepo-kernel"</span> repolist

[root@u ~]#yum -y --enablerepo=<span style="color: #8b2252;">"elrepo-kernel"</span> install kernel-lt <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23433;&#35013;&#26368;&#26032;&#20869;&#26680;.  kernel-lt-* &#26159;&#38271;&#26399;&#25903;&#25345;&#29256;&#65292; kernel-ml-* &#20027;&#32447;&#29256;&#21363;&#27979;&#35797;&#29256; </span>
[root@centos7 ~]#ls /boot
initramfs-3.10.0-957.el7.x86_64.img         
initramfs-5.4.6-1.el7.elrepo.x86_64.img

[root@centos7 ~]#ls /lib/modules
3.10.0-957.el7.x86_64  5.4.6-1.el7.elrepo.x86_64
[root@centos7 ~]#reboot
[root@centos7 ~]#uname -r
5.4.6-1.el7.elrepo.x86_64

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21368;&#36733;&#20869;&#26680;, &#20808;&#20999;&#21040;&#26087;&#20869;&#26680;</span>
yum remove kernel-lt
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:51a5b9e4-4811-42d8-8cd1-e76b78b9ca69" class="outline-4">
<h4 id="h:51a5b9e4-4811-42d8-8cd1-e76b78b9ca69">å¸è½½ç¨‹åºåŒ…</h4>
<div class="outline-text-4" id="text-h:51a5b9e4-4811-42d8-8cd1-e76b78b9ca69">
<div class="org-src-container">
<pre class="src src-sh">yum remove | erase package1 [package2] [...]
</pre>
</div>
</div>
</div>
<div id="outline-container-h:27b4acc9-5922-4c70-bef0-866b76a21596" class="outline-4">
<h4 id="h:27b4acc9-5922-4c70-bef0-866b76a21596">å‡çº§å’Œé™çº§</h4>
<div class="outline-text-4" id="text-h:27b4acc9-5922-4c70-bef0-866b76a21596">
<p>
å‡çº§å’Œé™çº§
</p>

<div class="org-src-container">
<pre class="src src-sh">yum update [package1] [package2] [...]
yum downgrade package1 [package2] [...] (&#38477;&#32423;)
</pre>
</div>

<p>
èŒƒä¾‹:
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos7 ~]# cat /etc/yum.repos.d/base.repo
[base]
<span style="color: #a0522d;">name</span>=aliyum base
<span style="color: #a0522d;">baseurl</span>=https://mirrors.aliyun.com/centos/$<span style="color: #a0522d;">releasever</span>/os/$<span style="color: #a0522d;">basearch</span>
<span style="color: #a0522d;">gpgcheck</span>=1
<span style="color: #a0522d;">gpgkey</span>=https://mirrors.aliyun.com/centos/$<span style="color: #a0522d;">releasever</span>/os/x86_64/RPM-GPG-KEY-
CentOS-$<span style="color: #a0522d;">releasever</span>
<span style="color: #a0522d;">enabled</span>=1

[update]
<span style="color: #a0522d;">name</span>=aliyun update
<span style="color: #a0522d;">baseurl</span>=https://mirrors.aliyun.com/centos/7/updates/x86_64/
<span style="color: #a0522d;">gpgcheck</span>=0

[root@centos7 ~]#yum --disablerepo=* --enablerep=updates list available
[root@centos7 ~]#yum info samba

[root@centos7 ~]#yum info samba --showduplicates <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26174;&#31034;&#22810;&#20010;&#29256;&#26412;</span>
Name    : samba
Arch    : x86_64
Version   : 4.9.1
Release   : 6.el7

Name    : samba
Arch    : x86_64
Version   : 4.9.1
Release   : 10.el7_7

[root@centos7 ~]#yum install samba --disablerepo=updates
[root@centos7 ~]#yum update samba
[root@centos7 ~]# yum update
</pre>
</div>

<p>
æ£€æŸ¥å¯ç”¨å‡çº§ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">yum check-update
</pre>
</div>
</div>
</div>
<div id="outline-container-h:f3fc4561-2146-4283-989c-0f8b847073d7" class="outline-4">
<h4 id="h:f3fc4561-2146-4283-989c-0f8b847073d7">æŸ¥è¯¢</h4>
<div class="outline-text-4" id="text-h:f3fc4561-2146-4283-989c-0f8b847073d7">
<p>
æŸ¥çœ‹ç¨‹åºåŒ…informationï¼š
</p>
<div class="org-src-container">
<pre class="src src-sh">yum info [...] 
</pre>
</div>

<p>
æŸ¥çœ‹æŒ‡å®šçš„ç‰¹æ€§(å¯ä»¥æ˜¯æŸæ–‡ä»¶)æ˜¯ç”±å“ªä¸ªç¨‹åºåŒ…æ‰€æä¾›ï¼š
</p>
<div class="org-src-container">
<pre class="src src-sh">yum provides | whatprovides feature1 [feature2] [...]
</pre>
</div>

<p>
æ³¨æ„ï¼šæ–‡ä»¶è¦å†™å…¨è·¯å¾„ï¼Œè€Œä¸åªæ˜¯æ–‡ä»¶åï¼Œå¦åˆ™æ— æ³•æŸ¥è¯¢åˆ°
</p>


<p>
ä»¥æŒ‡å®šçš„å…³é”®å­—æœç´¢ç¨‹åºåŒ…ååŠsummaryä¿¡æ¯
</p>
<div class="org-src-container">
<pre class="src src-sh">yum search string1 [string2] [...]
</pre>
</div>

<p>
æŸ¥çœ‹æŒ‡å®šåŒ…æ‰€ä¾èµ–çš„capabilitiesï¼š
</p>
<div class="org-src-container">
<pre class="src src-sh">yum deplist package1 [package2] [...]
</pre>
</div>

<p>
èŒƒä¾‹ï¼š
</p>
<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#dnf info bash
Last metadata expiration check: 0:25:44 ago on Sun 22 Dec 2019 01:56:36 PM CST.
Installed Packages
Name     : bash
Version   : 4.4.19
Release   : 7.el8
Arch     : x86_64
Size     : 6.6 M
Source    : bash-4.4.19-7.el8.src.rpm
Repo     : @System
From repo  : anaconda
Summary   : The GNU Bourne Again shell
URL     : https://www.gnu.org/software/bash
License   : GPLv3+
Description : The GNU Bourne Again shell (Bash) is a shell or command language
      : interpreter that is compatible with the Bourne shell (sh). Bash
      : incorporates useful features from the Korn shell (ksh) and the C
shell
      : (csh). Most sh scripts can be run by bash without modification.
</pre>
</div>

<p>
èŒƒä¾‹:
</p>
<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]# ll /etc/vsftpd/vsftpd.conf
ls: cannot access <span style="color: #8b2252;">'/etc/vsftpd/vsftpd.conf'</span>: No such file or directory

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#27880;&#24847;&#35201;&#20889;&#25991;&#20214;&#20840;&#36335;&#24452;&#25165;&#33021;&#26597;&#35810;&#21040;</span>
[root@centos8 ~]#yum provides vsftpd.conf
Last metadata expiration check: 0:56:45 ago on Fri 10 Apr 2020 11:24:00 AM CST.
Error: No Matches found

[root@centos8 ~]# yum provides /etc/vsftpd/vsftpd.conf
Last metadata expiration check: 0:33:13 ago on Fri 27 Dec 2019 03:47:34 PM CST.
vsftpd-3.0.3-28.el8.x86_64 : Very Secure Ftp Daemon
Repo    : AppStream
Matched from:
Filename  : /etc/vsftpd/vsftpd.conf

yum provides */mime.types  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;&#21253;&#25991;&#20214;&#21253;&#21547;mime.types&#30340;&#21253;</span>
</pre>
</div>


<p>
èŒƒä¾‹ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#rpm -ivh /misc/cd/AppStream/Packages/httpd-2.4.37-16.module_el8.1.0+256+ae790463.x86_64.rpm
error: Failed dependencies:
/etc/mime.types is needed by httpd-2.4.37-16.module_el8.1.0+256+ae790463.x86_64

[root@centos8 ~]#yum provides /etc/mime.types
mailcap-2.1.48-3.el8.noarch : Helper application and MIME type associations for

[root@centos8 ~]#yum deplist httpd
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#21487;&#29992;&#29256;&#26412;</span>
yum list kubeadm.x86_64 --showduplicates | sort -r
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25351;&#23450;&#29256;&#26412;yum install -y kubeadm-1.21.3-0.x86_64 kubectl-1.21.3-0.x86_64 kubelet-1.21.3-0.x86_64</span>
yum install -y kubelet kubeadm kubectl
<span style="color: #b22222;">#</span><span style="color: #b22222;">systemctl enable --now kubelet</span>
</pre>
</div>

<p>
èŒƒä¾‹ï¼šæŸ¥çœ‹æœªå®‰è£…åŒ…çš„æ–‡ä»¶åˆ—è¡¨
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">centos8</span>
yum repoquery -l memcached

<span style="color: #b22222;">#</span><span style="color: #b22222;">centos7</span>
yum -y install yum-utils
yum -ql memcached
</pre>
</div>
</div>
</div>
<div id="outline-container-h:d11b2a47-813a-4c05-ac3e-3718aaf92fea" class="outline-4">
<h4 id="h:d11b2a47-813a-4c05-ac3e-3718aaf92fea">ä»“åº“ç¼“å­˜</h4>
<div class="outline-text-4" id="text-h:d11b2a47-813a-4c05-ac3e-3718aaf92fea">
<p>
æ¸…é™¤ç›®å½•/var/cache/{yum, dnf}/ç¼“å­˜
</p>

<div class="org-src-container">
<pre class="src src-sh">yum clean [ packages | metadata | expire-cache | rpmdb | plugins | all ]
</pre>
</div>

<p>
æ„å»ºç¼“å­˜ï¼š
</p>
<div class="org-src-container">
<pre class="src src-sh">yum makecache
</pre>
</div>

<p>
èŒƒä¾‹ï¼šç®¡ç†yumç¼“å­˜
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos7 ~]#du -sh /var/cache/yum
93M /var/cache/yum
[root@centos7 ~]#ls /var/cache/yum/x86_64/7/
base epel extras timedhosts timedhosts.txt

[root@u ~]#yum clean all  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#28165;&#38500;&#20803;&#25968;&#25454;</span>
Loaded plugins: fastestmirror
Cleaning repos: base epel extras
Cleaning up list of fastest mirrors
[root@centos7 ~]#du -sh /var/cache/yum
4.0K /var/cache/yum
[root@centos7 ~]#yum makecache  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#37325;&#26032;&#19979;&#36733;&#20803;&#25968;&#25454;</span>
......
Metadata Cache Created
[root@centos7 ~]#du -sh /var/cache/yum
276M /var/cache/yum
</pre>
</div>
</div>
</div>
<div id="outline-container-h:3cdce67e-9825-4c88-b953-f7c3d77cd8f0" class="outline-4">
<h4 id="h:3cdce67e-9825-4c88-b953-f7c3d77cd8f0">æŸ¥çœ‹yumäº‹åŠ¡å†å²</h4>
<div class="outline-text-4" id="text-h:3cdce67e-9825-4c88-b953-f7c3d77cd8f0">
<p>
yum æ‰§è¡Œå®‰è£…å¸è½½å‘½ä»¤ä¼šè®°å½•åˆ°ç›¸å…³æ—¥å¿—ä¸­ æ—¥å¿— æ–‡ä»¶ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">CentOS 7&#20197;&#21069;&#29256;&#26412;&#26085;&#24535;</span>
/var/log/yum.log

<span style="color: #b22222;">#</span><span style="color: #b22222;">CentOS 8 &#29256;&#26412;&#26085;&#24535;</span>
/var/log/dnf.rpm.log
/var/log/dnf.log

<span style="color: #b22222;"># </span><span style="color: #b22222;">tail  /var/log/anaconda/packaging.log  # &#23433;&#35013;&#25805;&#20316;&#31995;&#32479;&#26102;&#23433;&#35013;&#36807;&#30340;&#21253;</span>
12:38:15,280 INFO packaging: iwl2000-firmware-18.168.6.1-69.el7.noarch (295/298)

12:38:15,280 INFO packaging: iwl6000g2a-firmware-17.168.5.3-69.el7.noarch (296/298)
</pre>
</div>

<p>
æ—¥å¿—å‘½ä»¤
</p>

<div class="org-src-container">
<pre class="src src-sh">yum history [info|list|packages-list|packages-info|summary|addon-info|redo|undo|rollback|new|sync|stats]
</pre>
</div>

<p>
èŒƒä¾‹ï¼š æŸ¥çœ‹è½¯ä»¶å®‰è£…äº‹ä»¶å¹¶åˆ é™¤å®‰è£…è¿‡çš„åŒ…
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#dnf history
ID   | Command line       | Date and time  | Action(s)   | Altered
-------------------------------------------------------------------------------
  22 | install yum-utils    | 2019-12-22 13:44 | Install    |   1 
  21 | remove vsftpd      | 2019-12-22 13:39 | Removed    |   1 
  20 | install vsftpd      | 2019-12-22 13:39 | Install    |   1 
  19 | install python3     | 2019-12-22 12:26 | Install    |   3 
  18 | install perl       | 2019-12-22 12:25 | Install    |  156 
  17 | install httpd -y     | 2019-12-21 20:21 | Install    |  10 
...&#30465;&#30053;...
[root@centos8 ~]#dnf history info 22
Transaction ID : 22
Begin time   : Sun 22 Dec 2019 01:44:08 PM CST
Begin rpmdb  : 607:35cd823ff347e56ceb688a9f72715eabb3c53d41
End time    : Sun 22 Dec 2019 01:44:08 PM CST (0 seconds)
End rpmdb   : 608:24139ec38fc131c182b75fdaad0626692045da94
User      : root &lt;root&gt;
Return-Code  : Success
Releasever   : 8
Command Line  : install yum-utils
Packages Altered:
 Install dnf-utils-4.0.2.2-3.el8.noarch @BaseOS
[root@centos8 ~]#dnf history undo 22 -y  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25764;&#38144;&#65292;&#23558;&#21253;&#21450;&#20854;&#23427;&#20381;&#36182;&#21253;&#19968;&#24182;&#21368;&#36733;</span>
Removed:
dnf-utils-4.0.2.2-3.el8.noarch       
Complete!
[root@centos8 ~]#dnf history redo 22 -y  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21453;&#25764;&#38144;&#65292;&#37325;&#26032;&#23433;&#35013;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:151e618d-41f2-4296-86ea-800111925875" class="outline-4">
<h4 id="h:151e618d-41f2-4296-86ea-800111925875">å®‰è£…åŠå‡çº§æœ¬åœ°ç¨‹åºåŒ…</h4>
<div class="outline-text-4" id="text-h:151e618d-41f2-4296-86ea-800111925875">
<div class="org-src-container">
<pre class="src src-sh">yum localinstall|install rpmfile1 [rpmfile2] [...]
yum localupdate|update rpmfile1 [rpmfile2] [...]
</pre>
</div>
</div>
</div>
<div id="outline-container-org656766f" class="outline-4">
<h4 id="org656766f">æŸ¥çœ‹åŒ…çš„å®‰å…¨è­¦æŠ¥</h4>
<div class="outline-text-4" id="text-org656766f">
<div class="org-src-container">
<pre class="src src-sh">yum updateinfo --summary|--list|--info
</pre>
</div>

<p>
èŒƒä¾‹
</p>
<div class="org-src-container">
<pre class="src src-sh">yum updateinfo summary
yum updateinfo
yum updateinfo all
yum updateinfo list
</pre>
</div>
</div>
</div>
<div id="outline-container-h:1b3ff4a3-da51-4184-ab6d-b6328f171bdc" class="outline-4">
<h4 id="h:1b3ff4a3-da51-4184-ab6d-b6328f171bdc">åŒ…ç»„ç®¡ç†çš„ç›¸å…³å‘½ä»¤</h4>
<div class="outline-text-4" id="text-h:1b3ff4a3-da51-4184-ab6d-b6328f171bdc">
<div class="org-src-container">
<pre class="src src-sh">yum grouplist [hidden] [groupwildcard] [...]
yum groupinstall group1 [group2] [...]
yum groupupdate group1 [group2] [...]
yum groupremove group1 [group2] [...]
yum groupinfo group1 [...]
</pre>
</div>

<p>
èŒƒä¾‹ï¼šæœ€å°åŒ–å®‰è£…çš„ç³»ç»Ÿå®‰è£…å›¾å½¢ç¯å¢ƒ
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#yum grouplist
Last metadata expiration check: 0:21:21 ago on Sun 22 Dec 2019 01:56:36 PM CST.
Available Environment Groups:
 Server with GUI
 Server
 Workstation
 KDE Plasma Workspaces
 Virtualization Host
 Custom Operating System
Installed Environment Groups:
 Minimal Install
Available Groups:
 Container Management
 .NET Core Development
 RPM Development Tools
 Smart Card Support
 Development Tools
 Graphical Administration Tools
 Headless Management
 Legacy UNIX Compatibility
 Network Servers
 Scientific Support
 Security Tools
 System Tools
 Fedora Packager
[root@centos8 ~]#yum groupinfo <span style="color: #8b2252;">"Server with GUI"</span>
Last metadata expiration check: 0:32:00 ago on Wed 08 Apr 2020 04:35:02 PM CST.
Environment Group: Server with GUI
Description: An integrated, easy-to-manage server with a graphical interface.
no group <span style="color: #8b2252;">'dns-server'</span> from environment <span style="color: #8b2252;">'graphical-server-environment'</span>
Mandatory Groups:
 Common NetworkManager submodules
 Container Management
 Core
 Fonts
 GNOME
 Guest Desktop Agents
 Hardware Monitoring Utilities
 Hardware Support
 Headless Management
 Internet Browser
 Multimedia
 Printing Client
 Server product core
 Standard
 base-x
Optional Groups:
 Basic Web Server
 Debugging Tools
 FTP Server
 File and Storage Server
 Guest Agents
 Infiniband Support
 Mail Server
 Network File System Client
 Network Servers
 Performance Tools
 Remote Desktop Clients
 Remote Management for Linux
 Virtualization Client
 Virtualization Hypervisor
 Virtualization Tools
 Windows File Server
[root@centos8 ~]#dnf groupinstall GNOME -y
[root@centos8 ~]#init 5
</pre>
</div>
</div>
</div>
<div id="outline-container-h:63ec964a-bb5a-4faa-bbf7-475adcaac0e5" class="outline-4">
<h4 id="h:63ec964a-bb5a-4faa-bbf7-475adcaac0e5">å®ç°ç§ç”¨ yumä»“åº“</h4>
<div class="outline-text-4" id="text-h:63ec964a-bb5a-4faa-bbf7-475adcaac0e5">
<p>
ä¸‹è½½æ‰€æœ‰yumä»“åº“çš„ç›¸å…³åŒ…å’Œmeta æ•°æ®
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">CentOS 8 dnf &#24037;&#20855;&#38598;&#25104;</span>
dnf reposync --help <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#24110;&#21161;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#21482;&#19979;&#36733;rpm&#21253;&#65292;&#19981;&#19979;&#36733;meta&#25968;&#25454;&#65292;&#38656;&#35201;&#25351;&#23450;--download-metadata &#25165;&#33021;&#19979;&#36733;meta</span>
dnf reposync  --repoid=REPOID --download-metadata -p /path

<span style="color: #b22222;">#</span><span style="color: #b22222;">CentOS 7 &#20197;&#21069;&#29256;&#26412;&#65292;reposync&#24037;&#20855;&#26469;&#33258;&#20110;yum-utils&#21253;</span>
reposync --repoid=REPOID --download-metadata -p /path 
</pre>
</div>

<p>
åˆ›å»ºç§æœ‰yumä»“åº“ï¼š
</p>
<div class="org-src-container">
<pre class="src src-sh">createrepo [options] &lt;directory&gt;
</pre>
</div>

<p>
èŒƒä¾‹ï¼šåˆ›å»ºå±€åŸŸç½‘çš„åŸºäºBaseçš„ç§æœ‰yumæº
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#20179;&#24211;&#26381;&#21153;&#22120;&#37197;&#32622;</span>
[root@repo-server ~]#yum -y install httpd
[root@repo-server ~]#systemctl enable --now httpd
[root@repo-server ~]#mkdir /var/www/html/centos/8 -pv
[root@repo-server ~]#mount /dev/sr0 /mnt/  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20809;&#30424;&#25346;&#36733;</span>
[root@repo-server ~]#cp -a /mnt/* /var/www/html/centos/8

<span style="color: #b22222;">#</span><span style="color: #b22222;">yum&#23458;&#25143;&#31471;&#37197;&#32622;</span>
[root@repo-client ~]#cat /etc/yum.repos.d/test.repo
[BaseOS]
<span style="color: #a0522d;">name</span>=BaseOS
<span style="color: #a0522d;">baseurl</span>=http://10.0.0.8/centos/8/BaseOS
<span style="color: #a0522d;">gpgkey</span>=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
[AppStream]
<span style="color: #a0522d;">name</span>=Appstream
<span style="color: #a0522d;">baseurl</span>=http://10.0.0.8/centos/8/AppStream/
<span style="color: #a0522d;">gpgkey</span>=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
</pre>
</div>

<p>
èŒƒä¾‹ï¼šä¸‹è½½é˜¿é‡Œäº‘çš„extrasæºï¼Œåˆ¶ä½œç§æœ‰yumæº
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@repo-server ~]#dnf reposync --repoid=extras --download-metadata -p /var/www/html/centos

[root@repo-server ~]#ls /var/www/html/centos/
8 extras
[root@repo-server ~]#ls /var/www/html/centos/extras/
Packages repodata

[root@repo-client ~]#cat /etc/yum.repos.d/test.repo
[BaseOS]
<span style="color: #a0522d;">name</span>=BaseOS
<span style="color: #a0522d;">baseurl</span>=http://10.0.0.8/centos/8/BaseOS
<span style="color: #a0522d;">gpgkey</span>=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
[AppStream]
<span style="color: #a0522d;">name</span>=Appstream
<span style="color: #a0522d;">baseurl</span>=http://10.0.0.8/centos/8/AppStream/
<span style="color: #a0522d;">gpgkey</span>=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
[extras]
<span style="color: #a0522d;">name</span>=extras
<span style="color: #a0522d;">baseurl</span>=http://10.0.0.8/centos/extras/

[root@repo-client ~]#yum repolist
[root@repo-client ~]#yum --disablerepo=* --enablerepo=extras list available
[root@repo-client ~]#yum -y install epel-release
</pre>
</div>

<p>
èŒƒä¾‹ï¼šä¸‹è½½é˜¿é‡Œäº‘çš„EPELæºï¼Œåˆ¶ä½œç§æœ‰yumæº
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@centos8 ~]#cat /etc/yum.repos.d/base.repo
[epel]
<span style="color: #a0522d;">name</span>=EPEL
<span style="color: #a0522d;">baseurl</span>=https://mirrors.aliyun.com/epel/8/Everything/x86_64/
<span style="color: #a0522d;">gpgcheck</span>=0

[root@centos8 ~]#dnf repolist
Last metadata expiration check: 0:07:40 ago on Sun 22 Dec 2019 03:14:16 PM CST.
repo id       repo name                      status
AppStream      AppStream                      4,681
BaseOS        BaseOS                        1,655
epel         EPEL                         3,707

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#19979;&#36733;&#30456;&#20851;&#20179;&#24211;&#21253;&#21644;&#20803;&#25968;&#25454;</span>
[root@centos8 ~]#dnf reposync --repoid=epel --download-metadata  -p /var/www/html
<span style="color: #b22222;">#</span><span style="color: #b22222;">--download-metadata &#21152;&#27492;&#36873;&#39033;&#21487;&#20197;&#19979;&#36733;&#20803;&#25968;&#25454;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#19979;&#36733;&#30456;&#20851;&#30340;key&#25991;&#20214;</span>
[root@repo-server ~]#wget -P /var/www/html/epel/ https://mirrors.aliyun.com/epel/RPM-GPG-KEY-EPEL-8
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#19979;&#38754;&#20004;&#20010;&#27493;&#39588;&#21482;&#26377;&#27809;meta&#25968;&#25454;&#25165;&#38656;&#35201;&#25191;&#34892;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">[root@centos8 ~]#dnf -y install createrepo httpd</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">[root@centos8 ~]#createrepo /var/www/html/epel/</span>
[root@centos8 ~]#ls /var/www/html/epel/
Packages repodata
[root@centos8 ~]#systemctl start httpd
[root@repo-client ~]#cat /etc/yum.repos.d/test.repo
[BaseOS]
<span style="color: #a0522d;">name</span>=BaseOS
<span style="color: #a0522d;">baseurl</span>=http://10.0.0.8/centos/8/BaseOS
<span style="color: #a0522d;">gpgkey</span>=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
[AppStream]
<span style="color: #a0522d;">name</span>=Appstream
<span style="color: #a0522d;">baseurl</span>=http://10.0.0.8/centos/8/AppStream/
<span style="color: #a0522d;">gpgkey</span>=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
[extras]
<span style="color: #a0522d;">name</span>=extras
<span style="color: #a0522d;">baseurl</span>=http://10.0.0.8/centos/extras/
[epel]
<span style="color: #a0522d;">name</span>=epel
<span style="color: #a0522d;">baseurl</span>=http://10.0.0.8/epel/
<span style="color: #a0522d;">gpgkey</span>=http://10.0.0.8/epel/RPM-GPG-KEY-EPEL-8

[root@repo-client ~]#yum repolist
extras                  1.6 MB/s | 4.9 kB   00:00  
epel                   88 MB/s | 6.2 MB   00:00  
repo id     repo name        status
AppStream    Appstream         4,755
BaseOS     BaseOS          1,659
epel      epel           5,206
extras extras          12
[root@repo-client ~]#dnf install openvpn
</pre>
</div>
</div>
</div>
<div id="outline-container-h:1a95dba4-44af-4866-b38a-9044eab803b2" class="outline-4">
<h4 id="h:1a95dba4-44af-4866-b38a-9044eab803b2">DNF ä»‹ç»</h4>
<div class="outline-text-4" id="text-h:1a95dba4-44af-4866-b38a-9044eab803b2">
<p>
DNFï¼Œå³DaNdiFiedï¼Œæ˜¯æ–°ä¸€ä»£çš„RPMè½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚DNFå‘è¡Œæ—¥æœŸæ˜¯2015å¹´5æœˆ11
æ—¥ï¼ŒDNF åŒ…ç®¡ç†å™¨é‡‡ç”¨Python ç¼–å†™ï¼Œå‘è¡Œè®¸å¯ä¸ºGPL v2ï¼Œé¦–å…ˆå‡ºç°åœ¨Fedora 18
å‘è¡Œç‰ˆä¸­ã€‚åœ¨ RHEL 8.0 ç‰ˆæœ¬æ­£å¼å–ä»£äº†YUMï¼ŒDNFåŒ…ç®¡ç†å™¨å…‹æœäº†YUMåŒ…ç®¡ç†å™¨
çš„ä¸€äº›ç“¶é¢ˆï¼Œæå‡äº†åŒ…æ‹¬ç”¨æˆ·ä½“éªŒï¼Œå†…å­˜å ç”¨ï¼Œä¾èµ–åˆ†æï¼Œè¿è¡Œé€Ÿåº¦ç­‰
</p>

<p>
é…ç½®æ–‡ä»¶ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">/etc/dnf/dnf.conf 
</pre>
</div>

<p>
ä»“åº“æ–‡ä»¶ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">/etc/yum.repos.d/ *.repo
</pre>
</div>

<p>
æ—¥å¿—ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">/var/log/dnf.rpm.log
/var/log/dnf.log
</pre>
</div>

<p>
DNF ä½¿ç”¨å¸®åŠ©ï¼šman dnf
</p>

<p>
dnf ç”¨æ³•ä¸yumä¸€è‡´
</p>

<div class="org-src-container">
<pre class="src src-sh">dnf [options] &lt;command&gt; [&lt;arguments&gt;...]
dnf --version
dnf repolist
dnf reposync
dnf install httpd
dnf remove httpd
dnf clean all
dnf makecache
dnf list installed
dnf list available
dnf search nano
dnf history undo 1
</pre>
</div>

<p>
CentOS 7 ä½¿ç”¨ dnf ï¼Œä¸‹è½½å¹¶å®‰è£…ä¸‹é¢åŒ…
</p>

<div class="org-src-container">
<pre class="src src-sh">wget http://springdale.math.ias.edu/data/puias/unsupported/7/x86_64/dnf-conf-0.6.4-2.sdl7.noarch.rpm
wget http://springdale.math.ias.edu/data/puias/unsupported/7/x86_64/dnf-0.6.4-2.sdl7.noarch.rpm
wget http://springdale.math.ias.edu/data/puias/unsupported/7/x86_64/python-dnf-0.6.4-2.sdl7.noarch.rpm
wget https://mirrors.aliyun.com/centos/7/extras/x86_64/Packages/python2-libcomps-0.1.8-12.el7.x86_64.rpm
wget https://mirrors.aliyun.com/centos/7/extras/x86_64/Packages/libcomps-0.1.8-12.el7.x86_64.rpm
</pre>
</div>
</div>
</div>
<div id="outline-container-h:d84bb7d7-5799-403e-aa93-4e95aec4f6c4" class="outline-4">
<h4 id="h:d84bb7d7-5799-403e-aa93-4e95aec4f6c4">yum Troubleshooting</h4>
<div class="outline-text-4" id="text-h:d84bb7d7-5799-403e-aa93-4e95aec4f6c4">
<p>
yum å’Œ dnf å¤±è´¥æœ€ä¸»è¦åŸå› ï¼š
</p>

<ul class="org-ul">
<li>yumçš„é…ç½®æ–‡ä»¶æ ¼å¼æˆ–è·¯å¾„é”™è¯¯
è§£å†³æ–¹æ³•ï¼šæ£€æŸ¥/etc/yum.repos.d/*.repoæ–‡ä»¶æ ¼å¼</li>
<li>yum cache è§£å†³æ–¹æ³•ï¼šyum clean all</li>
<li>ç½‘ç»œä¸é€šï¼š è§£å†³æ–¹æ³•ï¼šç½‘å¡é…ç½®</li>
</ul>
</div>
</div>
</div>
</section>
<section id="outline-container-h:ee8702e2-25dc-4096-bf4d-210aae3a906f" class="outline-2">
<h2 id="h:ee8702e2-25dc-4096-bf4d-210aae3a906f">ç¨‹åºåŒ…ç¼–è¯‘</h2>
<div class="outline-text-2" id="text-h:ee8702e2-25dc-4096-bf4d-210aae3a906f">
</div>
<div id="outline-container-h:f64a6f08-63d6-41ce-870b-83b12f331e66" class="outline-3">
<h3 id="h:f64a6f08-63d6-41ce-870b-83b12f331e66">æºç ç¼–è¯‘ä»‹ç»</h3>
<div class="outline-text-3" id="text-h:f64a6f08-63d6-41ce-870b-83b12f331e66">
<p>
ç¨‹åºåŒ…ç¼–è¯‘å®‰è£…ï¼š æºä»£ç &#x2013;&gt;é¢„å¤„ç†&#x2013;&gt;ç¼–è¯‘&#x2013;&gt;æ±‡ç¼–&#x2013;&gt;é“¾æ¥&#x2013;&gt;æ‰§è¡Œ
</p>

<p>
å¤šæ–‡ä»¶ï¼šæ–‡ä»¶ä¸­çš„ä»£ç ä¹‹é—´ï¼Œå¾ˆå¯èƒ½å­˜åœ¨è·¨æ–‡ä»¶ä¾èµ–å…³ç³»
</p>

<p>
è™½ç„¶æœ‰å¾ˆå¤šå¼€æºè½¯ä»¶å°†è½¯ä»¶æ‰“æˆåŒ…ï¼Œä¾›äººä»¬ä½¿ç”¨ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰æºä»£ç éƒ½æ‰“æˆåŒ…ï¼Œ
å¦‚æœæƒ³ä½¿ç”¨å¼€æºè½¯ä»¶ï¼Œå¯èƒ½éœ€è¦è‡ªå·²ä¸‹è½½æºç ï¼Œè¿›è¡Œç¼–è¯‘å®‰è£…ã€‚å¦å¤–å³ä½¿æä¾›äº†
åŒ…ï¼Œä½†æ˜¯ç”Ÿäº§ä¸­éœ€è¦ç”¨äºè½¯ä»¶çš„æŸäº›ç‰¹æ€§ï¼Œä»ç„¶éœ€è¦è‡ªè¡Œç¼–è¯‘å®‰è£…ã€‚ä½†æ˜¯åˆ©ç”¨æº
ä»£ç ç¼–è¯‘å®‰è£…æ˜¯æ¯”è¾ƒç¹ççš„ï¼Œåº†å¹¸çš„æ˜¯æœ‰ç›¸å…³çš„é¡¹ç›®ç®¡ç†å·¥å…·å¯ä»¥å¤§å¤§å‡å°‘ç¼–è¯‘
è¿‡ç¨‹çš„å¤æ‚åº¦
</p>
</div>
</div>
<div id="outline-container-h:df05665b-8680-4c49-9de8-0d9361484ae0" class="outline-3">
<h3 id="h:df05665b-8680-4c49-9de8-0d9361484ae0">å¼€æºç¨‹åºæºä»£ç çš„è·å–</h3>
<div class="outline-text-3" id="text-h:df05665b-8680-4c49-9de8-0d9361484ae0">
<p>
é¡¹ç›®å®˜æ–¹è‡ªå»ºç«™ç‚¹ï¼š
</p>

<ul class="org-ul">
<li><a href="https://apache.org">https://apache.org</a> (ASFï¼šApache Software Foundation)</li>
<li><a href="https://mariadb.org">https://mariadb.org</a></li>
<li>&#x2026;</li>
</ul>

<p>
ä»£ç æ‰˜ç®¡ï¼š
</p>
<ul class="org-ul">
<li><a href="https://github.com">https://github.com</a></li>
<li><a href="https://gitee.com">https://gitee.com</a></li>
<li><a href="https://sourceforge.net">https://sourceforge.net</a></li>
<li><a href="https://code.google.com">https://code.google.com</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:7a2c0189-8b82-4238-bf01-d8a8bd14a162" class="outline-3">
<h3 id="h:7a2c0189-8b82-4238-bf01-d8a8bd14a162">ç¼–è¯‘æºç çš„é¡¹ç›®å·¥å…·</h3>
<div class="outline-text-3" id="text-h:7a2c0189-8b82-4238-bf01-d8a8bd14a162">
<ul class="org-ul">
<li><p>
Cã€C++çš„æºç ç¼–è¯‘ï¼šä½¿ç”¨ make é¡¹ç›®ç®¡ç†å™¨
</p>

<p>
configureè„šæœ¬ &#x2013;&gt; Makefile.in &#x2013;&gt; Makefile
</p>

<p>
ç›¸å…³å¼€å‘å·¥å…·ï¼š
</p>
<ul class="org-ul">
<li>autoconf: ç”Ÿæˆconfigureè„šæœ¬</li>
<li>automakeï¼šç”ŸæˆMakefile.in</li>
</ul></li>

<li>javaçš„æºç ç¼–è¯‘: ä½¿ç”¨ maven</li>
</ul>


<p>
æºç ç¼–è¯‘ä¼˜åŠ¿ï¼šç§äººå®šåˆ¶æ›´ç¬¦åˆè‡ªå·±çš„è¦æ±‚
</p>
</div>
</div>
<div id="outline-container-h:5eadb370-44cc-4855-ad66-9f9fa91194d1" class="outline-3">
<h3 id="h:5eadb370-44cc-4855-ad66-9f9fa91194d1">Cè¯­è¨€æºä»£ç ç¼–è¯‘å®‰è£…è¿‡ç¨‹</h3>
<div class="outline-text-3" id="text-h:5eadb370-44cc-4855-ad66-9f9fa91194d1">
<p>
åˆ©ç”¨ç¼–è¯‘å·¥å…·ï¼Œé€šå¸¸åªéœ€è¦ä¸‰ä¸ªå¤§çš„æ­¥éª¤
</p>

<ul class="org-ul">
<li>./configure
<ol class="org-ol">
<li>é€šè¿‡é€‰é¡¹ä¼ é€’å‚æ•°ï¼ŒæŒ‡å®šå®‰è£…è·¯å¾„ã€å¯ç”¨ç‰¹æ€§ç­‰ï¼›æ‰§è¡Œæ—¶ä¼šå‚è€ƒç”¨æˆ·çš„æŒ‡
å®šä»¥åŠMakefile.inæ–‡ä»¶ç”ŸæˆMakefile</li>
<li>æ£€æŸ¥ä¾èµ–åˆ°çš„å¤–éƒ¨ç¯å¢ƒï¼Œå¦‚ä¾èµ–çš„è½¯ä»¶åŒ…</li>
</ol></li>
<li>make æ ¹æ®Makefileæ–‡ä»¶ï¼Œä¼šæ£€æµ‹ä¾èµ–çš„ç¯å¢ƒï¼Œè¿›è¡Œæ„å»ºåº”ç”¨ç¨‹åºï¼Œ</li>
<li>make install å¤åˆ¶æ–‡ä»¶åˆ°ç›¸åº”è·¯å¾„</li>
</ul>

<p>
æ³¨æ„ï¼šå®‰è£…å‰å¯ä»¥é€šè¿‡æŸ¥çœ‹READMEï¼ŒINSTALLè·å–å¸®åŠ©
</p>
</div>
<div id="outline-container-h:241bf723-dd84-498b-99b6-3965c0954a2d" class="outline-4">
<h4 id="h:241bf723-dd84-498b-99b6-3965c0954a2d">ç¼–è¯‘å®‰è£…å‡†å¤‡</h4>
<div class="outline-text-4" id="text-h:241bf723-dd84-498b-99b6-3965c0954a2d">
<p>
å‡†å¤‡ï¼šå®‰è£…ç›¸å…³çš„ä¾èµ–åŒ…
</p>

<ul class="org-ul">
<li>å¼€å‘å·¥å…·ï¼šmake, gcc (c/c++ç¼–è¯‘å™¨GNU C Complier)</li>
<li>å¼€å‘ç¯å¢ƒï¼šå¼€å‘åº“ï¼ˆglibcï¼šæ ‡å‡†åº“ï¼‰ï¼Œå¤´æ–‡ä»¶ï¼Œå¯å®‰è£…å¼€å‘åŒ…ç»„
Development Tools</li>
<li>è½¯ä»¶ç›¸å…³ä¾èµ–åŒ…</li>
</ul>

<p>
ç”Ÿäº§å®è·µï¼šåŸºäºæœ€å°åŒ–å®‰è£…çš„ç³»ç»Ÿå»ºè®®å®‰è£…ä¸‹é¢ç›¸å…³åŒ…
</p>

<div class="org-src-container">
<pre class="src src-sh">yum install  gcc make autoconf gcc-c++ glibc glibc-devel pcre pcre-devel openssl openssl-devel 
ncurses-devel systemd-devel zlib-devel  vim lrzsz tree tmux lsof tcpdump wget net-tools iotop bc bzip2 zip unzip nfs-utils man-pages
</pre>
</div>
</div>
</div>
<div id="outline-container-h:e9d3886c-10ff-4f0f-9ee4-1a8f08c88f61" class="outline-4">
<h4 id="h:e9d3886c-10ff-4f0f-9ee4-1a8f08c88f61">ç¼–è¯‘å®‰è£…</h4>
<div class="outline-text-4" id="text-h:e9d3886c-10ff-4f0f-9ee4-1a8f08c88f61">
<p>
<b>ç¬¬ä¸€æ­¥ï¼šè¿è¡Œ configure è„šæœ¬ï¼Œç”ŸæˆMakefile æ–‡ä»¶</b>
</p>

<ol class="org-ol">
<li>é€šè¿‡é€‰é¡¹ä¼ é€’å‚æ•°ï¼ŒæŒ‡å®šå¯ç”¨ç‰¹æ€§ã€å®‰è£…è·¯å¾„ç­‰ï¼›æ‰§è¡Œæ—¶ä¼šå‚è€ƒç”¨æˆ·çš„æŒ‡å®š
ä»¥åŠMakefile.in æ–‡ä»¶ç”Ÿæˆ makefileï¼›</li>

<li>æ£€æŸ¥ä¾èµ–åˆ°çš„å¤–éƒ¨ç¯å¢ƒï¼›å¦‚æœæ­¤æ—¶ä¾èµ–çš„å¤–éƒ¨ç¯å¢ƒæ²¡æœ‰é…ç½®ï¼Œä¼šå¯¼è‡´æŠ¥é”™</li>
</ol>

<p>
å…¶é€‰é¡¹ä¸»è¦åŠŸèƒ½ï¼š
</p>

<ul class="org-ul">
<li>å¯ä»¥æŒ‡å®šå®‰è£…ä½ç½®</li>
<li>æŒ‡å®šå¯ç”¨çš„ç‰¹æ€§</li>
</ul>

<p>
è·å–å…¶æ”¯æŒä½¿ç”¨çš„é€‰é¡¹
</p>

<div class="org-src-container">
<pre class="src src-sh">./configure --help
</pre>
</div>

<p>
é€‰é¡¹åˆ†ç±»ï¼š
</p>
<div class="org-src-container">
<pre class="src src-sh">- &#23433;&#35013;&#36335;&#24452;&#35774;&#23450;&#65306;
  --prefix=/PATH&#65306;&#25351;&#23450;&#40664;&#35748;&#23433;&#35013;&#20301;&#32622;,&#40664;&#35748;&#20026;/usr/local/
  --sysconfdir=/PATH&#65306;&#37197;&#32622;&#25991;&#20214;&#23433;&#35013;&#20301;&#32622;
  System types&#65306;&#25903;&#25345;&#20132;&#21449;&#32534;&#35793;

- &#36719;&#20214;&#29305;&#24615;&#21644;&#30456;&#20851;&#25351;&#23450;&#65306;
  Optional Features: &#21487;&#36873;&#29305;&#24615;
   --disable-FEATURE <span style="color: #b22222;">#</span><span style="color: #b22222;">&#31105;&#29992;&#29305;&#24615;</span>
   --enable-FEATURE[=ARG] <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21551;&#21160;&#26576;&#29305;&#24615;</span>
  Optional Packages: &#21487;&#36873;&#21253;
   --with-PACKAGE[=ARG] &#20381;&#36182;&#21253;
   --without-PACKAGE &#31105;&#29992;&#20381;&#36182;&#20851;&#31995;
</pre>
</div>

<p>
æ³¨æ„ï¼šé€šå¸¸è¢«ç¼–è¯‘æ“ä½œä¾èµ–çš„ç¨‹åºåŒ…ï¼Œéœ€è¦å®‰è£…æ­¤ç¨‹åºåŒ…çš„â€å¼€å‘â€ç»„ä»¶ï¼Œå…¶åŒ…
åä¸€èˆ¬ç±»ä¼¼äºname-devel-VERSION
</p>

<p>
configureå’ŒMakefile.inæ˜¯ç¨‹åºå‘˜é€šè¿‡ä¸¤ä¸ªå·¥å…·ç”Ÿæˆå¹¶æä¾›ç»™æˆ‘ä»¬ä½¿ç”¨çš„å¼€å‘å·¥
å…·ï¼š
</p>

<ol class="org-ol">
<li><p>
autoconf : ç”Ÿæˆconfigureè„šæœ¬ï¼›
</p>

<p>
autoconfå’Œåˆ«çš„é…ç½®æ–‡ä»¶ç»“åˆç”Ÿäº§configure è„šæœ¬
</p></li>

<li><p>
automake : ç”ŸæˆMakefile.in
</p>

<p>
automakeå’Œåˆ«çš„é…ç½®æ–‡ä»¶ç»“åˆç”Ÿäº§Makefile.inæ–‡ä»¶
</p></li>
</ol>

<p>
<b>ç¬¬äºŒæ­¥ï¼šmake</b>
</p>

<p>
æ ¹æ®makefileæ–‡ä»¶ï¼Œæ„å»ºåº”ç”¨ç¨‹åºï¼›
</p>

<p>
é€šè¿‡ç”Ÿæˆçš„makefileæ–‡ä»¶è°ƒç”¨é¢„å¤„ç†å™¨ï¼Œç¼–è¯‘å™¨ç­‰å¼€å§‹ç¼–è¯‘å®‰è£…ç¨‹åºåŒ…
</p>

<div class="org-src-container">
<pre class="src src-sh">nproc&#21629;&#20196;&#33719;&#21462;cpu&#20010;&#25968;
make -j $(nproc)
</pre>
</div>

<p>
<b>ç¬¬ä¸‰æ­¥ï¼šmake install</b>
</p>

<p>
ç›¸å½“äºä½¿ç”¨äº†mkdir,installå‘½ä»¤ï¼ŒæŠŠäºŒè¿›åˆ¶æ–‡ä»¶ã€åº“æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ã€å¸®åŠ©æ–‡
ä»¶å¤åˆ¶åˆ°å¯¹åº”çš„ç›®å½•ä¸­ï¼›
</p>

<p>
make distclean å¯¹ç›®å½•è¿›è¡Œç¼–è¯‘æ¸…ç†ã€‚
</p>

<p>
å»ºè®®ï¼šå®‰è£…å‰æŸ¥çœ‹INSTALLï¼ŒREADME
</p>

<p>
c/c++ç¼–è¯‘é€šè¿‡: gcc (GNU C Complier)ç¼–è¯‘å™¨æ¥å®ç°ï¼›
</p>

<p>
<b>æŠ¥é”™è§£å†³ç»éªŒ</b>
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#32570;&#23569;&#25991;&#20214;</span>
yum provides */filename  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26816;&#26597;&#25991;&#20214;&#20381;&#36182;&#21738;&#20010;&#21253;</span>
yum provides autoheader  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26816;&#26597;&#31243;&#24207;&#20381;&#36182;&#21738;&#20010;&#21253;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">APR Not find &#20687;&#36825;&#31181;&#27809;&#26377;&#21457;&#29616;&#19968;&#33324;&#37117;&#32570;&#23569;&#24320;&#21457;&#21253;</span>
yum install apr-devel
</pre>
</div>
</div>
</div>
<div id="outline-container-h:cde24117-8fde-47ef-b0f3-8ff0ceccf999" class="outline-4">
<h4 id="h:cde24117-8fde-47ef-b0f3-8ff0ceccf999">å®‰è£…åçš„é…ç½®</h4>
<div class="outline-text-4" id="text-h:cde24117-8fde-47ef-b0f3-8ff0ceccf999">
<ol class="org-ol">
<li><p>
äºŒè¿›åˆ¶ç¨‹åºç›®å½•å¯¼å…¥è‡³PATHç¯å¢ƒå˜é‡ä¸­
</p>

<p>
ç¼–è¾‘æ–‡ä»¶/etc/profile.d/NAME.sh
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">export</span> <span style="color: #a0522d;">PATH</span>=/PATH/TO/BIN:$<span style="color: #a0522d;">PATH</span>
</pre>
</div></li>

<li><p>
ç›¸å…³ç”¨æˆ·åŠæ–‡ä»¶
</p>

<p>
æœ‰äº›å¼€æºè½¯ä»¶ç¼–è¯‘å®Œæˆåï¼Œè¿˜éœ€è¦åˆ›å»ºç›¸å…³çš„ç”¨æˆ·åŠæ–‡ä»¶
</p></li>

<li><p>
å¯¼å…¥å¸®åŠ©æ‰‹å†Œ
</p>

<p>
ç¼–è¾‘/etc/man.config|man_db.confæ–‡ä»¶,æ·»åŠ ä¸€ä¸ªMANPATH
</p></li>
</ol>

<p>
å…¶å®ƒï¼š
</p>

<p>
å¯¼å‡ºåº“æ–‡ä»¶è·¯å¾„
</p>

<ol class="org-ol">
<li>ç¼–è¾‘/etc/ld.so.conf.d/NAME.conf æ·»åŠ æ–°çš„åº“æ–‡ä»¶æ‰€åœ¨ç›®å½•è‡³æ­¤æ–‡ä»¶ä¸­ï¼›</li>
<li>è®©ç³»ç»Ÿé‡æ–°ç”Ÿæˆç¼“å­˜ï¼š <code>ldconfig [-v] #è¦æ˜¾ç¤ºè¿‡ç¨‹å°±åŠ -vé€‰é¡¹</code></li>
</ol>

<p>
å¯¼å‡ºå¤´æ–‡ä»¶
</p>

<p>
åŸºäºé“¾æ¥çš„æ–¹å¼å®ç°ï¼Œå¯¼å‡ºæ•´ä¸ªç›®å½•ä¸ºä¸€ä¸ªè¿æ¥æ–‡ä»¶ï¼›ln -sv
</p>

<p>
å¦‚ï¼Œ <code>ln -sv /usr/local/apache2/include/ /usr/include/http2</code>
</p>

<p>
èŒƒä¾‹ï¼šCentOS 7 ç¼–è¯‘å®‰è£… tree1.8
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">1 &#23433;&#35013;&#30456;&#20851;&#30340;&#20381;&#36182;&#21253;</span>
[root@centos7 ~]#yum install gcc make

<span style="color: #b22222;">#</span><span style="color: #b22222;">2 &#19979;&#36733;&#28304;&#30721;&#24182;&#35299;&#21387;</span>
[root@centos7 ~]#tar xvf tree-1.8.0.tgz

<span style="color: #b22222;">#</span><span style="color: #b22222;">3 &#36827;&#20837;&#35299;&#21387;&#32553;&#30340;&#30446;&#24405;&#65292;README&#21644;INSTALL</span>
[root@centos7 ~]#cd tree-1.8.0/
[root@centos7 tree-1.8.0]#cat README
[root@centos7 tree-1.8.0]#cat INSTALL

<span style="color: #b22222;">#</span><span style="color: #b22222;">4 &#20462;&#25913;&#28304;&#30721;&#30340;&#29256;&#26412;&#21495;</span>
[root@centos7 tree-1.8.0]#sed -i <span style="color: #8b2252;">'s#v1\.8\.0#v.8.8.8#'</span> tree.c

<span style="color: #b22222;">#</span><span style="color: #b22222;">5 &#32534;&#35793;&#20934;&#22791;</span>
[root@centos7 tree-1.8.0]#vim Makefile
<span style="color: #a0522d;">prefix</span> = /apps/tree

<span style="color: #b22222;">#</span><span style="color: #b22222;">6 &#32534;&#35793;</span>
[root@centos7 tree-1.8.0]#make

<span style="color: #b22222;">#</span><span style="color: #b22222;">7 &#23433;&#35013;</span>
[root@centos7 tree-1.8.0]#make install

<span style="color: #b22222;">#</span><span style="color: #b22222;">8 &#20462;&#25913;PATH&#21464;&#37327;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#26080;&#27861;&#30452;&#25509;&#36816;&#34892;tree</span>
[root@centos7 ~]#tree
-bash: tree: command not found
[root@centos7 ~]#echo <span style="color: #8b2252;">'PATH=/apps/tree/bin:$PATH'</span> &gt; /etc/profile.d/tree.sh

. /etc/profile.d/tree.sh
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25110;&#32773;&#21033;&#29992;&#36719;&#38142;&#25509;&#23454;&#29616;</span>
[root@centos7 ~]#ln -s /apps/tree/bin/tree /usr/local/bin

<span style="color: #483d8b;">hash</span> -r <span style="color: #b22222;">#</span><span style="color: #b22222;">&#28165;&#29702;&#32531;&#23384;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">9 &#39564;&#35777;&#32467;&#26524;</span>
[root@centos7 ~]#tree --version
tree v8.8.8 (c) 1996 - 2018 by Steve Baker, Thomas Moore, Francesc Rocher,
Florian Sesser, Kyosuke Tokoro

<span style="color: #b22222;">#</span><span style="color: #b22222;">10 &#28155;&#21152;man&#24110;&#21161;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#26080;&#27861;&#26597;&#30475;man</span>
[root@centos7 ~]#man tree
No manual entry for tree
[root@centos7 ~]#vim /etc/man_db.conf
MANDATORY_MANPATH      /apps/tree/man 
[root@centos7 ~]#man tree

<span style="color: #b22222;">#</span><span style="color: #b22222;">11 &#36816;&#34892;tree&#26597;&#30475;&#29983;&#25104;&#30340;&#25991;&#20214;&#21015;&#34920;</span>
[root@centos7 ~]#tree /apps/tree
/apps/tree
&#9500;&#9472;&#9472; bin
&#9474;  &#9492;&#9472;&#9472; tree
&#9492;&#9472;&#9472; man
 &#9492;&#9472;&#9472; man1
   &#9492;&#9472;&#9472; tree.1
3 directories, 2 files
</pre>
</div>

<p>
èŒƒä¾‹ï¼šCentOS 8 ç¼–è¯‘å®‰è£… é»‘å®¢å¸å›½ä»£ç é›¨cmatrix
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">1 &#23433;&#35013;&#30456;&#20851;&#21253;</span>
[root@centos8 ~]#dnf install gcc make autoconf ncurses-devel

<span style="color: #b22222;">#</span><span style="color: #b22222;">2 &#19979;&#36733;&#24182;&#35299;&#21387;&#32553;&#21253;</span>
<span style="color: #483d8b;">cd</span> /usr/local/src
wget https://github.com/abishekvashok/cmatrix/releases/download/v2.0/cmatrix-v2.0-Butterscotch.tar
tar xvf cmatrix-v2.0-Butterscotch.tar

<span style="color: #b22222;">#</span><span style="color: #b22222;">3 &#37197;&#32622;</span>
<span style="color: #483d8b;">cd</span> cmatrix
./configure --prefix=/apps/cmatrix

<span style="color: #b22222;">#</span><span style="color: #b22222;">4 &#32534;&#35793;&#24182;&#23433;&#35013;</span>
make &amp;&amp; make install

<span style="color: #b22222;">#</span><span style="color: #b22222;">5 &#37197;&#32622;&#29615;&#22659;</span>
<span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">'PATH=/apps/cmatrix/bin:$PATH'</span> &gt; /etc/profile.d/cmatrix.sh
. /etc/profile.d/cmatrix.sh
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25110;&#32773;&#29992;&#36719;&#38142;&#25509;&#23454;&#29616;</span>
[root@centos8 ~]#ln -sv /apps/cmatrix/bin/cmatrix /usr/local/bin/

<span style="color: #b22222;">#</span><span style="color: #b22222;">6&#36816;&#34892;</span>
cmatrix -a -b -C yellow

7#&#24110;&#21161;
[root@centos8 ~]#vim /etc/man_db.conf
MANDATORY_MANPATH            /apps/cmatrix/share/man
[root@centos8 ~]#man cmatrix
</pre>
</div>


<figure id="org7169e97">
<img src="images/image-20210216014607145.png" alt="image-20210216014607145.png" width="80%">

</figure>

<p>
èŒƒä¾‹ï¼šcentos8 ç¼–è¯‘å®‰è£… httpd-2.4.43
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#23433;&#35013;&#21069;&#20934;&#22791;&#65306;&#20851;&#38381;&#38450;&#28779;&#22681;&#21644;SELinux</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">1 &#23433;&#35013;&#21253;</span>
[root@centos8 ~]#dnf install gcc make apr-devel apr-util-devel pcre-devel openssl-devel redhat-rpm-config

<span style="color: #b22222;">#</span><span style="color: #b22222;">2 &#19979;&#36733;&#24182;&#35299;&#21387;&#32553;&#21253;</span>
[root@centos8 ~]#tar xvf httpd-2.4.43.tar.bz2 -C /usr/local/src

<span style="color: #b22222;">#</span><span style="color: #b22222;">3 &#37197;&#32622;</span>
[root@centos8 ~]#cd /usr/local/src/httpd-2.4.43/
[root@centos8 httpd-2.4.43]#./configure --prefix=/apps/httpd24 --sysconfdir=/etc/httpd24 --enable-ssl

<span style="color: #b22222;">#</span><span style="color: #b22222;">4 &#32534;&#35793;&#24182;&#23433;&#35013;</span>
[root@centos8 httpd-2.4.43]#make -j 4 &amp;&amp; make install

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25253;&#38169;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#32570;&#23569;&#25991;&#20214;&#65292; yum provides */filename  #&#26816;&#26597;&#25991;&#20214;&#20381;&#36182;&#21738;&#20010;&#21253;</span>
yum provides autoheader  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26816;&#26597;&#31243;&#24207;&#20381;&#36182;&#21738;&#20010;&#21253;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">APR Not find &#65292; &#20687;&#36825;&#31181;&#27809;&#26377;&#21457;&#29616;&#19968;&#33324;&#37117;&#32570;&#23569;&#24320;&#21457;&#21253;&#65292; yum install apr-devel</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">5 &#37197;&#32622;&#29615;&#22659;</span>
[root@centos8 ~]#echo <span style="color: #8b2252;">'PATH=/apps/httpd24/bin:$PATH'</span> &gt; /etc/profile.d/httpd24.sh
[root@centos8 ~]#. /etc/profile.d/httpd24.sh

<span style="color: #b22222;">#</span><span style="color: #b22222;">6&#36816;&#34892;</span>
[root@centos8 ~]#apachectl

<span style="color: #b22222;">#</span><span style="color: #b22222;">7 &#25351;&#23450;&#29992;apache&#29992;&#25143;&#36816;&#34892;</span>
[root@centos8 ~]#useradd -r -s /sbin/nologin -d /var/www -c Apache -u 48 apache
[root@centos8 ~]#vim /etc/httpd24/httpd.conf
user apache
group apache

<span style="color: #b22222;">#</span><span style="color: #b22222;">7&#29983;&#25928;&#21644;&#39564;&#35777;</span>
[root@centos8 ~]#apachectl restart
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;</span>
[root@centos8 ~]#ps aux
</pre>
</div>

<p>
æ¼”ç¤ºï¼šç¼–è¯‘å®‰è£…apache2.4
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">1&#12289;&#26356;&#26032;yum&#28304;</span>
wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo

<span style="color: #b22222;">#</span><span style="color: #b22222;">2&#12289;&#23433;&#35013;gcc</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26816;&#26597;&#26159;&#21542;&#23433;&#35013;gcc:rpm -qa gcc</span>
yum install -y gcc

<span style="color: #b22222;">#</span><span style="color: #b22222;">3&#12289;&#19979;&#36733;httpd&#26381;&#21153;,&#29256;&#26412;&#21495;2.4.18</span>
wget http://olex.openlogic.com/package_versions/28219/download?<span style="color: #a0522d;">package_version_id</span>=105155&amp;<span style="color: #a0522d;">path</span>=https%3A%2F%2Folex-secure.openlogic.com%2Fcontent%2Fopenlogic%2Fapache%2F2.4.18%2Fhttpd-2.4.18.tar.bz2


<span style="color: #b22222;">#</span><span style="color: #b22222;">4&#12289;&#35299;&#21387;http&#28304;&#30721;&#21253;</span>
tar xf httpd-2.4.18.tar.bz2
<span style="color: #483d8b;">cd</span>  httpd-2.4.18/
more INSTALL
     $ ./configure --prefix=PREFIX
     $ make
     $ make install
     $ PREFIX/bin/apachectl start


<span style="color: #b22222;">#</span><span style="color: #b22222;">5&#12289;&#36890;&#36807;./configure &#36319;&#29305;&#23450;&#38656;&#35201;&#30340;&#36873;&#25321;&#36890;&#36807;Makefile.in&#24320;&#22987;&#26500;&#24314;&#29983;&#20135;makefile&#25991;&#20214;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35299;&#20915;&#20381;&#36182;&#38382;&#39064;&#65306;&#24403;&#28982;&#20063;&#21487;&#20197;&#30452;&#25509;&#23433;&#35013;&#24320;&#21457;&#21253;&#32452;&#26469;&#35299;&#20915;</span>
yum install  -y pcre-devel apr*
./configure --prefix=/usr/local/apache2 --sysconfdir=/etc/httpd2

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#32570;&#23569;&#20381;&#36182;&#21253;&#25253;&#38169;&#65306;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">configure: error: APR not found.</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">configure: error: pcre-config for libpcre not found</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">6&#12289;make&#36890;&#36807;&#29983;&#25104;&#30340;makefile&#25991;&#20214;&#35843;&#29992;&#39044;&#22788;&#29702;&#22120;&#65292;&#32534;&#35793;&#22120;&#31561;&#24320;&#22987;&#32534;&#35793;&#23433;&#35013;&#31243;&#24207;&#21253;</span>
make

<span style="color: #b22222;"># </span><span style="color: #b22222;">7&#12289;make install&#65306;&#25226;&#20108;&#36827;&#21046;&#25991;&#20214;&#12289;&#24211;&#25991;&#20214;&#12289;&#37197;&#32622;&#25991;&#20214;&#12289;&#24110;&#21161;&#25991;&#20214;&#22797;&#21046;&#21040;&#23545;&#24212;&#30340;&#30446;&#24405;&#20013;</span>
make install

<span style="color: #b22222;">#</span><span style="color: #b22222;">8&#12289;&#23433;&#35013;&#21518;&#30340;&#37197;&#32622;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#33258;&#23450;&#20041;&#32534;&#35793;&#23433;&#35013;&#20043;&#21518;&#65292;&#23558;&#20854;&#25972;&#20307;&#23433;&#35013;&#22312;&#20102;/usr/local/*&#25991;&#20214;&#19979;&#65292;&#21368;&#36733;&#26102;&#21482;&#38656;&#21024;&#38500;&#35813;&#25991;&#20214;&#22841;&#21363;&#21487;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20294;&#26159;&#65292;&#27492;&#26102;&#31995;&#32479;&#36335;&#24452;&#26159;&#26080;&#27861;&#35835;&#21462;&#35813;&#37197;&#32622;&#25991;&#20214;&#30340;&#65292;&#25152;&#20197;&#26381;&#21153;&#21487;&#33021;&#26080;&#27861;&#21551;&#21160;&#65292;&#38656;&#35201;&#37197;&#32622;&#20854;&#37096;&#20998;&#25991;&#20214;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">(1) &#23548;&#20986;&#20108;&#36827;&#21046;&#31243;&#24207;&#30446;&#24405;&#33267;PATH&#29615;&#22659;&#21464;&#37327;&#20013;&#65307;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#32534;&#36753;&#25991;&#20214;/etc/profile.d/NAME.sh</span>
[root@localhost httpd2]# cat /etc/profile.d/path_httpd.sh
<span style="color: #483d8b;">export</span> <span style="color: #a0522d;">PATH</span>=/usr/local/apache2/bin:$<span style="color: #a0522d;">PATH</span>
[root@localhost httpd2]# . /etc/profile

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#27880;&#24847;&#65306;bin&#36335;&#24452;&#30340;&#25918;&#22312;&#21069;&#38754;&#31995;&#32479;&#22312;&#35835;&#21462;&#37197;&#32622;&#25991;&#20214;&#30340;&#26102;&#20505;&#20250;&#25353;&#29031;&#33258;&#24038;&#21521;&#21491;&#30340;&#39034;&#24207;&#35835;&#21462;</span>


<span style="color: #b22222;">#</span><span style="color: #b22222;">(2) &#23548;&#20986;&#24211;&#25991;&#20214;&#36335;&#24452;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#32534;&#36753;/etc/ld.so.conf.d/NAME.conf   &#28155;&#21152;&#26032;&#30340;&#24211;&#25991;&#20214;&#25152;&#22312;&#30446;&#24405;&#33267;&#27492;&#25991;&#20214;&#20013;&#65307;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35753;&#31995;&#32479;&#37325;&#26032;&#29983;&#25104;&#32531;&#23384;&#65306;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">ldconfig [-v]  #&#35201;&#26174;&#31034;&#36807;&#31243;&#23601;&#21152;-v&#36873;&#39033;</span>

[root@localhost httpd-2.4.18]# cat /etc/ld.so.conf.d/apache2.conf
/usr/local/apache2/lib
[root@localhost httpd-2.4.18]# ldconfig

<span style="color: #b22222;">#</span><span style="color: #b22222;">(3) &#23548;&#20986;&#22836;&#25991;&#20214;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22522;&#20110;&#38142;&#25509;&#30340;&#26041;&#24335;&#23454;&#29616;&#65292;&#23548;&#20986;&#25972;&#20010;&#30446;&#24405;&#20026;&#19968;&#20010;&#36830;&#25509;&#25991;&#20214;&#65307;ln -sv</span>

[root@localhost apache2]# ln -sv /usr/local/apache2/include/  /usr/include/http2
&#8216;/usr/include/http2&#8217; -&gt; &#8216;/usr/local/apache2/include/&#8217;
[root@localhost apache2]# ls -l /usr/include/http2
lrwxrwxrwx. 1 root root 27 Dec 26 18:01 /usr/include/http2 -&gt; /usr/local/apache2/include/


<span style="color: #b22222;">#</span><span style="color: #b22222;">(4) &#23548;&#20986;&#24110;&#21161;&#25163;&#20876;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#32534;&#36753; /etc/man_db.conf  &#25991;&#20214;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#28155;&#21152;&#19968;&#20010;MANPATH</span>

[root@localhost apache2]# grep -B5 apache  /etc/man_db.conf
<span style="color: #b22222;">#</span><span style="color: #b22222;">MANDATORY_MANPATH             /usr/src/pvm3/man</span>
<span style="color: #b22222;">#</span>
MANDATORY_MANPATH            /usr/man
MANDATORY_MANPATH            /usr/share/man
MANDATORY_MANPATH            /usr/local/share/man
MANDATORY_MANPATH            /usr/local/apache2/man
[root@localhost man]# man httpd

<span style="color: #b22222;">#</span><span style="color: #b22222;">9&#12289;&#21551;&#21160;&#26381;&#21153;</span>
[root@localhost man]# apachectl start
AH00558: httpd: Could not reliably determine the server<span style="color: #8b2252;">'s fully qualified domain name, using localhost.localdomain. Set the '</span>ServerName<span style="color: #8b2252;">' directive globally to suppress this message</span>

<span style="color: #8b2252;">[root@localhost man]# ss -lntp | grep 80</span>
<span style="color: #8b2252;">LISTEN     0      128                      :::80                      :::*      users:(("httpd",23704,4),("httpd",23697,4),("httpd",23696,4),("httpd",23695,4))</span>
</pre>
</div>
</div>
</div>
</div>
</section>
<section id="outline-container-h:4b3e2142-78a3-4377-8161-6562169c891f" class="outline-2">
<h2 id="h:4b3e2142-78a3-4377-8161-6562169c891f">Ubuntu è½¯ä»¶ç®¡ç†</h2>
<div class="outline-text-2" id="text-h:4b3e2142-78a3-4377-8161-6562169c891f">
<p>
Debianè½¯ä»¶åŒ…é€šå¸¸ä¸ºé¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ ¼å¼çš„æ‰©å±•åâ€.debâ€ï¼Œç±»ä¼¼rpmæ–‡ä»¶ï¼Œå› 
æ­¤å®‰è£…å¿«é€Ÿï¼Œæ— éœ€ç¼–è¯‘è½¯ä»¶ã€‚åŒ…æ–‡ä»¶åŒ…æ‹¬ç‰¹å®šåŠŸèƒ½æˆ–è½¯ä»¶æ‰€å¿…éœ€çš„æ–‡ä»¶ã€å…ƒæ•°æ®
å’ŒæŒ‡ä»¤
</p>

<ul class="org-ul">
<li>dpkgï¼špackage manager for Debianï¼Œç±»ä¼¼äºrpmï¼Œdpkgæ˜¯åŸºäºDebiançš„ç³»ç»Ÿ
çš„åŒ…ç®¡ç†å™¨ã€‚å¯ä»¥å®‰è£…ï¼Œåˆ é™¤å’Œæ„å»ºè½¯ä»¶åŒ…ï¼Œä½†æ— æ³•è‡ªåŠ¨ä¸‹è½½å’Œå®‰è£…è½¯ä»¶åŒ…æˆ–
å…¶ä¾èµ–é¡¹</li>
<li>aptï¼šAdvanced Packaging Toolï¼ŒåŠŸèƒ½å¼ºå¤§çš„è½¯ä»¶ç®¡ç†å·¥å…·ï¼Œç”šè‡³å¯å‡çº§æ•´ä¸ª
Ubuntuçš„ç³»ç»Ÿï¼ŒåŸºäºå®¢æˆ·/æœåŠ¡å™¨æ¶æ„ï¼Œç±»ä¼¼äºyum</li>
</ul>
</div>
<div id="outline-container-h:643f7863-e72b-4023-8f8c-5bbfa5f6918e" class="outline-3">
<h3 id="h:643f7863-e72b-4023-8f8c-5bbfa5f6918e">APTå·¥ä½œåŸç†</h3>
<div class="outline-text-3" id="text-h:643f7863-e72b-4023-8f8c-5bbfa5f6918e">
<p>
åœ¨æœåŠ¡å™¨ä¸Šå…ˆå¤åˆ¶æ‰€æœ‰DEBåŒ…ï¼Œç„¶åç”¨APTçš„åˆ†æå·¥å…·genbasediræ ¹æ®æ¯ä¸ªDEBåŒ…
çš„åŒ…å¤´ï¼ˆHeaderï¼‰ä¿¡æ¯å¯¹æ‰€æœ‰çš„DEBåŒ…è¿›è¡Œåˆ†æï¼Œå¹¶å°†è¯¥åˆ†æç»“æœè®°å½•åœ¨æ–‡ä»¶å¤¹
baseå†…çš„ä¸€ä¸ªDEBç´¢å¼•æ¸…å•æ–‡ä»¶ä¸­ï¼Œä¸€æ—¦APTæœåŠ¡å™¨å†…çš„DEBæœ‰æ‰€å˜åŠ¨ï¼Œè¦ä½¿ç”¨
genbasediräº§ç”Ÿæ–°çš„DEBç´¢å¼•æ¸…å•ã€‚å®¢æˆ·ç«¯åœ¨è¿›è¡Œå®‰è£…æˆ–å‡çº§æ—¶å…ˆè¦æŸ¥è¯¢DEBç´¢å¼•
æ¸…å•ï¼Œä»è€Œè·çŸ¥æ‰€æœ‰å…·æœ‰ä¾èµ–å…³ç³»çš„è½¯ä»¶åŒ…ï¼Œå¹¶ä¸€åŒä¸‹è½½åˆ°å®¢æˆ·ç«¯ä»¥ä¾¿å®‰è£…ã€‚å½“
å®¢æˆ·ç«¯éœ€è¦å®‰è£…ã€å‡çº§æˆ–åˆ é™¤æŸä¸ªè½¯ä»¶åŒ…æ—¶ï¼Œå®¢æˆ·ç«¯è®¡ç®—æœºå–å¾—DEBç´¢å¼•æ¸…å•å‹
ç¼©æ–‡ä»¶åï¼Œä¼šå°†å…¶è§£å‹ç½®æ”¾äº/var/cache/apt/ï¼Œè€Œå®¢æˆ·ç«¯ä½¿ç”¨apt-get install
æˆ–apt-get upgradeå‘½ä»¤çš„æ—¶å€™ï¼Œå°±ä¼šå°†è¿™ä¸ªæ–‡ä»¶å¤¹å†…çš„æ•°æ®å’Œå®¢æˆ·ç«¯è®¡ç®—æœºå†…
çš„DEBæ•°æ®åº“æ¯”å¯¹ï¼ŒçŸ¥é“å“ªäº›DEBå·²å®‰è£…ã€æœªå®‰è£…æˆ–æ˜¯å¯ä»¥å‡çº§çš„
</p>
</div>
</div>
<div id="outline-container-h:da743a3f-8cc6-4931-90b8-6c0820731b2f" class="outline-3">
<h3 id="h:da743a3f-8cc6-4931-90b8-6c0820731b2f">dpkg åŒ…ç®¡ç†å™¨</h3>
<div class="outline-text-3" id="text-h:da743a3f-8cc6-4931-90b8-6c0820731b2f">
<p>
å¸®åŠ©å‚çœ‹ï¼šman dpkg dpkg å¸¸è§ç”¨æ³•
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#23433;&#35013;&#21253;, &#19981;&#25903;&#25345;&#21253;&#20381;&#36182;</span>
dpkg -i package.deb

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21024;&#38500;&#21253;&#65292;&#19981;&#24314;&#35758;&#65292;&#19981;&#33258;&#21160;&#21368;&#36733;&#20381;&#36182;&#20110;&#23427;&#30340;&#21253;</span>
dpkg -r package

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21024;&#38500;&#21253;&#65288;&#21253;&#25324;&#37197;&#32622;&#25991;&#20214;&#65289;</span>
dpkg -P package

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#24403;&#21069;&#24050;&#23433;&#35013;&#30340;&#21253;&#65292;&#31867;&#20284;rpm -qa</span>
dpkg -l

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26174;&#31034;&#35813;&#21253;&#30340;&#31616;&#35201;&#35828;&#26126;&#65292;&#31867;&#20284;rpm &#8211;qi</span>
dpkg -l package

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#35813;&#21253;&#30340;&#29366;&#24577;&#65292;&#21253;&#25324;&#35814;&#32454;&#20449;&#24687;&#65292;&#31867;&#20284;rpm &#8211;qi</span>
dpkg -s package

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#35813;&#21253;&#20013;&#25152;&#21253;&#21547;&#30340;&#25991;&#20214;&#65292;&#31867;&#20284;rpm &#8211;ql</span>
dpkg -L package

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25628;&#32034;&#21253;&#21547;pattern&#30340;&#21253;&#65292;&#31867;&#20284;rpm &#8211;qf</span>
dpkg -S &lt;pattern&gt;

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#37197;&#32622;&#21253;&#65292;-a &#20351;&#29992;&#65292;&#37197;&#32622;&#25152;&#26377;&#27809;&#26377;&#37197;&#32622;&#30340;&#36719;&#20214;&#21253;</span>
dpkg --configure package

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986; deb &#21253;&#30340;&#20869;&#23481;&#65292;&#31867;&#20284;rpm &#8211;qpl</span>
dpkg -c package.deb

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35299;&#24320; deb &#21253;&#30340;&#20869;&#23481;</span>
dpkg --unpack package.deb
</pre>
</div>

<p>
èŒƒä¾‹ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#31995;&#32479;&#19978;&#23433;&#35013;&#30340;&#25152;&#26377;&#36719;&#20214;&#21253;</span>
dpkg -l

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#36719;&#20214;&#21253;&#23433;&#35013;&#30340;&#25991;&#20214;</span>
dpkg -L bash

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;/bin/bash&#26469;&#33258;&#20110;&#21738;&#20010;&#36719;&#20214;&#21253;</span>
dpkg -S /bin/bash

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23433;&#35013;&#26412;&#22320;&#30340; .deb &#25991;&#20214;</span>
dpkg -i /mnt/cdrom/pool/main/z/zip/zip_3.0-11build1_amd64.deb

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21368;&#36733;&#36719;&#20214;&#21253;</span>
dpkg -r zip
</pre>
</div>

<p>
æ³¨æ„ï¼šä¸€èˆ¬å»ºè®®ä¸è¦ä½¿ç”¨dpkgå¸è½½è½¯ä»¶åŒ…ã€‚å› ä¸ºåˆ é™¤åŒ…æ—¶ï¼Œå…¶å®ƒä¾èµ–å®ƒçš„åŒ…ä¸ä¼š
å¸è½½ï¼Œå¹¶ä¸”å¯èƒ½æ— æ³•å†æ­£å¸¸è¿è¡Œ
</p>
</div>
</div>
<div id="outline-container-h:49de8721-b2df-4089-a65e-eb1c700e1d30" class="outline-3">
<h3 id="h:49de8721-b2df-4089-a65e-eb1c700e1d30">apt</h3>
<div class="outline-text-3" id="text-h:49de8721-b2df-4089-a65e-eb1c700e1d30">
<p>
Debian ä½¿ç”¨apt å·¥å…·é›†æ¥ç®¡ç†åŒ…ç³»ç»Ÿï¼Œapt-getæ˜¯å…¶ä¸­ä¸€ä¸ªå¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œ
å¦å¤–ä¸€æ¬¾è¾ƒä¸ºæµè¡Œçš„å‘½ä»¤è¡Œä¸ GUI å…¼é¡¾çš„å·¥å…·æ˜¯aptitude ï¼Œä¹‹å‰æœ€å¸¸ç”¨çš„
Linux åŒ…ç®¡ç†å‘½ä»¤éƒ½è¢«åˆ†æ•£åœ¨äº† apt-getã€apt-cacheå’Œ apt-config è¿™ä¸‰æ¡å‘½
ä»¤ä¸­
</p>

<p>
åœ¨ 2014 å¹´apt å‘½ä»¤å‘å¸ƒç¬¬ä¸€ä¸ªç¨³å®šç‰ˆï¼ŒUbuntu 16.04 å¼•å…¥æ–°ç‰¹æ€§ä¹‹ä¸€ä¾¿æ˜¯
aptå‘½ä»¤ï¼Œapt å‘½ä»¤è§£å†³äº†å‘½ä»¤è¿‡äºåˆ†æ•£çš„é—®é¢˜ï¼Œå®ƒåŒ…æ‹¬ apt-getå‘½ä»¤å‡ºç°ä»¥æ¥
ä½¿ç”¨æœ€å¹¿æ³›çš„åŠŸèƒ½é€‰é¡¹ï¼Œä»¥åŠ apt-cache å’Œ apt-configå‘½ä»¤ä¸­å¾ˆå°‘ç”¨åˆ°çš„åŠŸèƒ½ã€‚
åœ¨ä½¿ç”¨ apt å‘½ä»¤æ—¶ï¼Œç”¨æˆ·ä¸å¿…å†ç”± apt-get è½¬åˆ°apt-cache æˆ– apt-configï¼Œ
æä¾›ç®¡ç†è½¯ä»¶åŒ…æ‰€éœ€çš„å¿…è¦é€‰é¡¹
</p>

<p>
apt ç›¸å½“äº apt-getã€apt-cache å’Œ apt-config ä¸­æœ€å¸¸ç”¨å‘½ä»¤é€‰é¡¹çš„é›†åˆ
</p>

<p>
aptå…·æœ‰æ›´ç²¾å‡ä½†è¶³å¤Ÿçš„å‘½ä»¤é€‰é¡¹ï¼Œè€Œä¸”å‚æ•°é€‰é¡¹çš„ç»„ç»‡æ–¹å¼æ›´ä¸ºæœ‰æ•ˆã€‚æ­¤å¤–ï¼Œ
å¯ç”¨çš„å‡ ä¸ªç‰¹æ€§ä¹Ÿéå¸¸æœ‰å¸®åŠ©ã€‚ä¾‹å¦‚ï¼šå¯ä»¥åœ¨ä½¿ç”¨apt å‘½ä»¤å®‰è£…æˆ–åˆ é™¤ç¨‹åºæ—¶çœ‹
åˆ°è¿›åº¦æ¡,aptè¿˜ä¼šåœ¨æ›´æ–°å­˜å‚¨åº“æ•°æ®åº“æ—¶æç¤ºç”¨æˆ·å¯å‡çº§çš„è½¯ä»¶åŒ…ä¸ªæ•°
</p>

<p>
apt ä¸ apt-get æœ‰ä¸€äº›ç±»ä¼¼çš„å‘½ä»¤é€‰é¡¹ï¼Œä½†å®ƒå¹¶ä¸èƒ½å®Œå…¨å‘ä¸‹å…¼å®¹ apt-getå‘½
ä»¤,ä¹Ÿå³å¯ç”¨ apt æ›¿æ¢éƒ¨åˆ†apt-get ç³»åˆ—å‘½ä»¤ï¼Œä½†ä¸æ˜¯å…¨éƒ¨apt å‘½ä»¤ç”¨æ³•
</p>

<p>
æŸ¥çœ‹å¸®åŠ©ï¼šapt help
</p>

<p>
<b>aptä¸apt-getå‘½ä»¤å¯¹æ¯”</b>
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">apt å‘½ä»¤</td>
<td class="org-left">è¢«å–ä»£çš„å‘½ä»¤</td>
<td class="org-left">å‘½ä»¤çš„åŠŸèƒ½</td>
</tr>

<tr>
<td class="org-left">apt install</td>
<td class="org-left">apt-get install</td>
<td class="org-left">å®‰è£…è½¯ä»¶åŒ…</td>
</tr>

<tr>
<td class="org-left">apt remove</td>
<td class="org-left">apt-get remove</td>
<td class="org-left">ç§»é™¤è½¯ä»¶åŒ…</td>
</tr>

<tr>
<td class="org-left">apt purge</td>
<td class="org-left">apt-get purge</td>
<td class="org-left">ç§»é™¤è½¯ä»¶åŒ…åŠé…ç½®æ–‡ä»¶</td>
</tr>

<tr>
<td class="org-left">apt update</td>
<td class="org-left">apt-get update</td>
<td class="org-left">åˆ·æ–°å­˜å‚¨åº“ç´¢å¼•</td>
</tr>

<tr>
<td class="org-left">apt upgrade</td>
<td class="org-left">apt-get upgrade</td>
<td class="org-left">å‡çº§æ‰€æœ‰å¯å‡çº§çš„è½¯ä»¶åŒ…</td>
</tr>

<tr>
<td class="org-left">apt autoremove</td>
<td class="org-left">apt-get autoremove</td>
<td class="org-left">è‡ªåŠ¨åˆ é™¤ä¸éœ€è¦çš„åŒ…</td>
</tr>

<tr>
<td class="org-left">apt full-upgrade</td>
<td class="org-left">apt-get dist-upgrade</td>
<td class="org-left">åœ¨å‡çº§è½¯ä»¶åŒ…æ—¶è‡ªåŠ¨å¤„ç†ä¾èµ–å…³ç³»</td>
</tr>

<tr>
<td class="org-left">apt search</td>
<td class="org-left">apt-cache search</td>
<td class="org-left">æœç´¢åº”ç”¨ç¨‹åº</td>
</tr>

<tr>
<td class="org-left">apt show</td>
<td class="org-left">apt-cache show</td>
<td class="org-left">æ˜¾ç¤ºå®‰è£…ç»†èŠ‚</td>
</tr>
</tbody>
</table>

<p>
apt ç‰¹æœ‰çš„å‘½ä»¤
</p>
<div class="org-src-container">
<pre class="src src-sh">apt list                  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#21253;&#21547;&#26465;&#20214;&#30340;&#21253;&#65288;&#24050;&#23433;&#35013;&#65292;&#21487;&#21319;&#32423;&#31561;&#65289;</span>
apt edit-sources  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#32534;&#36753;&#28304;&#21015;&#34920;</span>
</pre>
</div>

<p>
APTåŒ…ç´¢å¼•é…ç½®æ–‡ä»¶
</p>
<div class="org-src-container">
<pre class="src src-sh">/etc/apt/sources.list
/etc/apt/sources.list.d
</pre>
</div>

<p>
å¯ä»¥ä¿®æ”¹ä¸Šé¢æ–‡ä»¶ä¸ºå›½å†…çš„å®‰è£…æºï¼Œæé«˜é€Ÿåº¦
å‚è€ƒé“¾æ¥ï¼š<a href="https://developer.aliyun.com/mirror/ubuntu">https://developer.aliyun.com/mirror/ubuntu</a>
</p>

<p>
aptå‘½ä»¤æ“ä½œï¼ˆå¦‚å®‰è£…å’Œåˆ é™¤è½¯ä»¶åŒ…ï¼‰æ—¥å¿—æ–‡ä»¶
</p>

<div class="org-src-container">
<pre class="src src-sh">/var/log/dpkg.log
</pre>
</div>

<p>
èŒƒä¾‹ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#23433;&#35013;&#21253;&#65306;</span>
apt install tree zip
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23433;&#35013;&#22270;&#24418;&#26700;&#38754;</span>
apt install ubuntu-desktop

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21024;&#38500;&#21253;&#65306;</span>
apt remove tree zip
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35828;&#26126;&#65306;apt remove&#20013;&#28155;&#21152;--purge&#36873;&#39033;&#20250;&#21024;&#38500;&#21253;&#37197;&#32622;&#25991;&#20214;&#65292;&#35880;&#24910;&#20351;&#29992;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26356;&#26032;&#21253;&#32034;&#24341;&#65292;&#30456;&#24403;&#20110;yum clean all;yum makecache</span>
apt update 
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21319;&#32423;&#21253;&#65306;&#35201;&#21319;&#32423;&#31995;&#32479;&#65292;&#35831;&#39318;&#20808;&#26356;&#26032;&#36719;&#20214;&#21253;&#32034;&#24341;&#65292;&#20877;&#21319;&#32423;</span>
apt upgrade

<span style="color: #b22222;">#</span><span style="color: #b22222;">apt&#21015;&#20986;&#20179;&#24211;&#36719;&#20214;&#21253;&#65292;&#31561;&#20110;yum list</span>
apt list

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25628;&#32034;&#23433;&#35013;&#21253;</span>
apt search nginx
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#26576;&#20010;&#23433;&#35013;&#21253;&#30340;&#35814;&#32454;&#20449;&#24687;</span>
apt show apache2

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22312;&#32447;&#23433;&#35013;&#36719;&#20214;&#21253;</span>
apt install apache2

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21368;&#36733;&#21333;&#20010;&#36719;&#20214;&#21253;&#20294;&#26159;&#20445;&#30041;&#37197;&#32622;&#12098;&#20214;</span>
apt remove apache2

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21024;&#38500;&#23433;&#35013;&#21253;&#24182;&#35299;&#20915;&#20381;&#36182;&#20851;&#31995;</span>
apt autoremove apache2

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26356;&#26032;&#26412;&#22320;&#36719;&#20214;&#21253;&#21015;&#34920;&#32034;&#24341;&#65292;&#20462;&#25913;&#20102;apt&#20179;&#24211;&#21518;&#24517;&#39035;&#25191;&#12175;</span>
apt update

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21368;&#36733;&#21333;&#20010;&#36719;&#20214;&#21253;&#21024;&#38500;&#37197;&#32622;&#12098;&#20214;</span>
apt purge apache2

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21319;&#32423;&#25152;&#26377;&#24050;&#23433;&#35013;&#19988;&#21487;&#21319;&#32423;&#21040;&#26032;&#29256;&#26412;&#30340;&#36719;&#20214;&#21253;</span>
apt upgrade

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21319;&#32423;&#25972;&#20010;&#31995;&#32479;&#65292;&#24517;&#35201;&#26102;&#21487;&#20197;&#31227;&#38500;&#26087;&#36719;&#20214;&#21253;&#12290;</span>
apt full-upgrade

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#32534;&#36753;source&#28304;&#12098;&#20214;</span>
apt edit-sources

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#20179;&#24211;&#20013;&#36719;&#20214;&#21253;&#26377;&#21738;&#20123;&#29256;&#26412;&#21487;&#20197;&#23433;&#35013;</span>
apt-cache madison nginx

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23433;&#35013;&#36719;&#20214;&#21253;&#30340;&#26102;&#20505;&#25351;&#23450;&#23433;&#35013;&#20855;&#20307;&#30340;&#29256;&#26412;</span>
apt install <span style="color: #a0522d;">nginx</span>=1.14.0-0ubuntu1.6

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#25991;&#20214;&#26469;&#33258;&#21738;&#20010;&#21253;&#65292;&#31867;&#20284;&#20110;yum provides filename</span>
apt install apt-file
apt-file search <span style="color: #8b2252;">'string'</span>   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#26159;&#21253;&#21547;&#27492;&#23383;&#31526;&#20018;&#30340;&#25991;&#20214;</span>
apt-file search -x <span style="color: #8b2252;">'&#27491;&#21017;&#34920;&#36798;&#24335;'</span>
apt-file search -F /path/file
</pre>
</div>
</div>
</div>
<div id="outline-container-h:b78fb7e2-f822-4cc3-9092-f15e593aa560" class="outline-3">
<h3 id="h:b78fb7e2-f822-4cc3-9092-f15e593aa560">è½¯ä»¶ç®¡ç†æ¡ˆä¾‹</h3>
<div class="outline-text-3" id="text-h:b78fb7e2-f822-4cc3-9092-f15e593aa560">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#26174;&#31034;&#31995;&#32479;&#23433;&#35013;&#21253;&#30340;&#32479;&#35745;&#20449;&#24687;,&#21487;&#20197;&#32479;&#35745;&#24050;&#32463;&#23433;&#35013;&#21253;&#30340;&#25968;&#37327;&#65292;&#22823;&#23567;&#65292;&#21344;&#29992;&#31354;&#38388;&#31561;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">apt-cache stats</span>

[root@ubuntu1804 ~]#apt-cache stats
Total package names: 84873 (1,697 k)
Total package structures: 126998 (5,588 k)
Normal packages: 91623
Pure virtual packages: 2648
Single virtual packages: 10275
Mixed virtual packages: 5110
Missing: 17342
Total distinct versions: 115114 (9,209 k)
Total distinct descriptions: 182818 (4,388 k)
Total dependencies: 905746/262881 (22.3 M)
Total ver/file relations: 39954 (959 k)
Total Desc/File relations: 51746 (1,242 k)
Total Provides mappings: 44540 (1,069 k)
Total globbed strings: 188808 (4,354 k)
Total slack space: 25.8 k
Total space accounted for: 51.3 M
Total buckets<span style="color: #a020f0;"> in</span> PkgHashTable: 50503
Unused: 9337
Used: 41166
Utilization: 81.512%
Average entries: 3.08502
Longest: 60
Shortest: 1
Total buckets<span style="color: #a020f0;"> in</span> GrpHashTable: 50503
Unused: 9337
Used: 41166
Utilization: 81.512%
Average entries: 2.06173
Longest: 12
Shortest: 1

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26174;&#31034;xxx&#21253;&#30340;&#20449;&#24687;,&#21487;&#20197;&#30475;&#21040;&#26576;&#20010;&#21253;&#30340;&#28304;&#12289;&#29256;&#26412;&#31561;&#20449;&#24687;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">apt-cache show xxx #&#26356;&#35814;&#32454;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">apt show xxx</span>
[root@ubuntu1804 ~]#apt show keepalived
Package: keepalived
Version: 1:1.3.9-1ubuntu0.18.04.2
Priority: optional
Section: admin
Origin: Ubuntu
Maintainer: Ubuntu Developers <a href="mailto:ubuntu-devel-discuss%40lists.ubuntu.com">&lt;ubuntu-devel-discuss@lists.ubuntu.com&gt;</a>
Original-Maintainer: Alexander Wirt <a href="mailto:formorer%40debian.org">&lt;formorer@debian.org&gt;</a>
Bugs: https://bugs.launchpad.net/ubuntu/+filebug
Installed-Size: 844 kB
Depends: iproute2, libc6 (&gt;= 2.27), libglib2.0-0 (&gt;= 2.26.0), libip4tc0 (&gt;=
1.6.0+snapshot20161117), libip6tc0 (&gt;= 1.6.0+snapshot20161117), libnl-3-200 (&gt;=
3.2.27), libnl-genl-3-200 (&gt;= 3.2.7), libnl-route-3-200 (&gt;= 3.2.7), libsnmp30
(&gt;= 5.7.3+dfsg-1.8ubuntu3.1~dfsg), libssl1.1 (&gt;= 1.1.0), libxtables12 (&gt;=
1.6.0+snapshot20161117)
Recommends: ipvsadm
Homepage: http://keepalived.org
Supported: 5y
Download-Size: 244 kB
APT-Manual-Installed: yes
APT-Sources: http://mirrors.aliyun.com/ubuntu bionic-security/main amd64
Packages
Description: Failover and monitoring daemon for LVS clusters
keepalived is used for monitoring real servers within a Linux
Virtual Server (LVS) cluster. keepalived can be configured to
remove real servers from the cluster pool if it stops responding,
as well as send a notification email to make the admin aware of
the service failure.
.
In addition, keepalived implements an independent Virtual Router
Redundancy Protocol (VRRPv2; see rfc2338 for additional info)
framework for director failover.
.
You need a kernel &gt;= 2.4.28 or &gt;= 2.6.11 for keepalived.
See README.Debian for more information.
N: There is 1 additional record. Please use the <span style="color: #8b2252;">'-a'</span> switch to see it

[root@ubuntu1804 ~]#apt-cache show keepalived
Package: keepalived
Architecture: amd64
Version: 1:1.3.9-1ubuntu0.18.04.2
Priority: optional
Section: admin
Origin: Ubuntu
Maintainer: Ubuntu Developers <a href="mailto:ubuntu-devel-discuss%40lists.ubuntu.com">&lt;ubuntu-devel-discuss@lists.ubuntu.com&gt;</a>
Original-Maintainer: Alexander Wirt <a href="mailto:formorer%40debian.org">&lt;formorer@debian.org&gt;</a>
Bugs: https://bugs.launchpad.net/ubuntu/+filebug
Installed-Size: 824
Depends: iproute2, libc6 (&gt;= 2.27), libglib2.0-0 (&gt;= 2.26.0), libip4tc0 (&gt;=
1.6.0+snapshot20161117), libip6tc0 (&gt;= 1.6.0+snapshot20161117), libnl-3-200 (&gt;=
3.2.27), libnl-genl-3-200 (&gt;= 3.2.7), libnl-route-3-200 (&gt;= 3.2.7), libsnmp30
(&gt;= 5.7.3+dfsg-1.8ubuntu3.1~dfsg), libssl1.1 (&gt;= 1.1.0), libxtables12 (&gt;=
1.6.0+snapshot20161117)
Recommends: ipvsadm
Filename: pool/main/k/keepalived/keepalived_1.3.9-1ubuntu0.18.04.2_amd64.deb
Size: 243520
MD5sum: 27586893f35660b2a130f344c4b7fcff
SHA1: 36b232cb39ff9179e7197d02c0bd252e32543e97
SHA256: fedef32d748fd4c5180531d1076b254f4705b46523ed61d51eb789f2441dfd56
Homepage: http://keepalived.org
Description-en: Failover and monitoring daemon for LVS clusters
keepalived is used for monitoring real servers within a Linux
Virtual Server (LVS) cluster. keepalived can be configured to
remove real servers from the cluster pool if it stops responding,
as well as send a notification email to make the admin aware of
the service failure.
.
In addition, keepalived implements an independent Virtual Router
Redundancy Protocol (VRRPv2; see rfc2338 for additional info)
framework for director failover.
.
You need a kernel &gt;= 2.4.28 or &gt;= 2.6.11 for keepalived.
See README.Debian for more information.
Description-md5: e2d2506352721e77c2c351de4714ddd6
Supported: 5y
Package: keepalived
Architecture: amd64
Version: 1:1.3.9-1build1
Priority: optional
Section: admin
Origin: Ubuntu
Maintainer: Ubuntu Developers <a href="mailto:ubuntu-devel-discuss%40lists.ubuntu.com">&lt;ubuntu-devel-discuss@lists.ubuntu.com&gt;</a>
Original-Maintainer: Alexander Wirt <a href="mailto:formorer%40debian.org">&lt;formorer@debian.org&gt;</a>
Bugs: https://bugs.launchpad.net/ubuntu/+filebug
Installed-Size: 824
Depends: iproute2, libc6 (&gt;= 2.17), libglib2.0-0 (&gt;= 2.26.0), libip4tc0 (&gt;=
1.6.0+snapshot20161117), libip6tc0 (&gt;= 1.6.0+snapshot20161117), libnl-3-200 (&gt;=
3.2.27), libnl-genl-3-200 (&gt;= 3.2.7), libnl-route-3-200 (&gt;= 3.2.7), libsnmp30
(&gt;= 5.7.3+dfsg-1.8ubuntu1~dfsg), libssl1.1 (&gt;= 1.1.0), libxtables12 (&gt;=
1.6.0+snapshot20161117)
Recommends: ipvsadm
Filename: pool/main/k/keepalived/keepalived_1.3.9-1build1_amd64.deb
Size: 243368
MD5sum: 9998fcf3c2769effd8664b838f144bd6
SHA1: 1f22181adff9f47fdd9b08691817df4ac5d486bc
SHA256: 3d72f7e6cd09b7b903faf07c06c3c0d0883a33648a9e33af27b1909aeaf2b77f
Homepage: http://keepalived.org
Description-en: Failover and monitoring daemon for LVS clusters
keepalived is used for monitoring real servers within a Linux
Virtual Server (LVS) cluster. keepalived can be configured to
remove real servers from the cluster pool if it stops responding,
as well as send a notification email to make the admin aware of
the service failure.
.
In addition, keepalived implements an independent Virtual Router
Redundancy Protocol (VRRPv2; see rfc2338 for additional info)
framework for director failover.
.
You need a kernel &gt;= 2.4.28 or &gt;= 2.6.11 for keepalived.
See README.Debian for more information.
Description-md5: e2d2506352721e77c2c351de4714ddd6
Supported: 5y

[root@ubuntu1804 ~]#

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#25214;&#25991;&#20214;&#23646;&#20110;&#21738;&#20010;&#21253;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">dpkg -S filename &#65306;&#22312;&#24403;&#21069;&#23433;&#35013;&#30340;&#21253;&#37324;&#26597;&#25214;&#25991;&#20214;</span>

[root@ubuntu1804 ~]#dpkg -S /bin/ls
coreutils: /bin/ls

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22312;&#25152;&#26377;&#28304;&#21253;&#37324;&#26597;&#25214;&#25991;&#20214;&#12290;&#65288;&#21253;&#21547;&#26410;&#23433;&#35013;&#30340;&#21253;&#65289;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">apt-file search filename</span>
[root@ubuntu1804 ~]#apt search /bin/tree
Sorting... Done
Full Text Search... Done

[root@ubuntu1804 ~]#apt -y install apt-file
[root@ubuntu1804 ~]#apt-flle upate
[root@ubuntu1804 ~]#apt-file search /bin/tree
arb: /usr/lib/arb/bin/treedist
asp.net-examples: /usr/share/asp.net-demos/bin/treeview.dll
beast-mcmc: /usr/bin/treeannotator
beast-mcmc: /usr/bin/treestat
beast2-mcmc: /usr/bin/treeannotator2
blimps-utils: /usr/share/doc/blimps-utils/html/bin/tree.csh
dosemu: /usr/lib/dosemu/drive_z/bin/tree.com
fastdnaml: /usr/lib/fastdnaml/bin/treefile
fastdnaml: /usr/lib/fastdnaml/bin/treefile2prolog
fastdnaml: /usr/lib/fastdnaml/bin/trees2NEXUS
fastdnaml: /usr/lib/fastdnaml/bin/trees2prolog
phast: /usr/bin/treeGen
phast: /usr/bin/tree_doctor
phylip: /usr/lib/phylip/bin/treedist
prime-phylo: /usr/bin/tree2leafnames
prime-phylo: /usr/bin/treesize
qiime: /usr/lib/qiime/bin/tree_compare.py
seqan-apps: /usr/bin/tree_recon
seqan-apps: /usr/lib/seqan/bin/tree_recon
tree: /usr/bin/tree
tree-ppuzzle: /usr/bin/tree-ppuzzle
tree-puzzle: /usr/bin/tree-puzzle
treeline: /usr/bin/treeline
treesheets: /usr/bin/treesheets
treeview: /usr/bin/treeview
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#35810;&#36719;&#20214;xxx&#20381;&#36182;&#21738;&#20123;&#21253;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">apt  depends xxx</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">apt-cache depends xxx</span>
[root@ubuntu1804 ~]#apt depends keepalived
keepalived
Depends: iproute2
 iproute2:i386
Depends: libc6 (&gt;= 2.27)
Depends: libglib2.0-0 (&gt;= 2.26.0)
Depends: libip4tc0 (&gt;= 1.6.0+snapshot20161117)
Depends: libip6tc0 (&gt;= 1.6.0+snapshot20161117)
Depends: libnl-3-200 (&gt;= 3.2.27)
Depends: libnl-genl-3-200 (&gt;= 3.2.7)
Depends: libnl-route-3-200 (&gt;= 3.2.7)
Depends: libsnmp30 (&gt;= 5.7.3+dfsg-1.8ubuntu3.1~dfsg)
Depends: libssl1.1 (&gt;= 1.1.0)
Depends: libxtables12 (&gt;= 1.6.0+snapshot20161117)
Recommends: ipvsadm
[root@ubuntu1804 ~]#

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#35810;&#36719;&#20214;xxx&#34987;&#21738;&#20123;&#21253;&#20381;&#36182;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">apt rdepends xxx</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">apt-cache rdepends xxx</span>

[root@ubuntu1804 ~]#apt rdepends bash
bash
Reverse Depends:
Depends: bash-builtins (= 4.4.18-2ubuntu1.2)
  bash:i386
Recommends: plasma-sdk (&gt;= 4.3)
  bash:i386
PreDepends: foomatic-db-engine (&gt;= 2.05)
  bash:i386
Replaces: bash-doc (&lt;&lt; 4.3-2)
<span style="color: #ffa54f;">Depends: chromium-browser (&gt;= 4)</span>
<span style="color: #ffa54f;">  bash:i386</span>
<span style="color: #ffa54f;">Depends: gdm3 (&gt;= 4.3)</span>
<span style="color: #ffa54f;">  bash:i386</span>
<span style="color: #ffa54f;">Depends: votca-csg-tutorials (&gt;= 4)</span>
<span style="color: #ffa54f;">  bash:i386</span>
<span style="color: #ffa54f;">Depends: votca-csg-scripts (&gt;= 4)</span>
<span style="color: #ffa54f;">  bash:i386</span>
<span style="color: #ffa54f;">Depends: uck (&gt;= 3.0)</span>
<span style="color: #ffa54f;">  bash:i386</span>
<span style="color: #ffa54f;">Depends: txt2regex (&gt;&gt; 2.04)</span>
<span style="color: #ffa54f;">  bash:i386</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:1371b82f-9dfa-4557-9b0c-871c42e2563c" class="outline-3">
<h3 id="h:1371b82f-9dfa-4557-9b0c-871c42e2563c">ubuntuå»ºè®®å®‰è£…çš„å¸¸ç”¨åŒ…</h3>
<div class="outline-text-3" id="text-h:1371b82f-9dfa-4557-9b0c-871c42e2563c">
<div class="org-src-container">
<pre class="src src-sh">apt purge ufw lxd lxd-client lxcfs liblxc-common
apt install iproute2 ntpdate tcpdump telnet traceroute nfs-kernel-server nfs-common lrzsz tree openssl libssl-dev libpcre3 libpcre3-dev zlib1g-dev gcc openssh-server iotop unzip zip
</pre>
</div>

<p>
ç»ƒä¹ 
</p>
<ul class="org-ul">
<li>æŸ¥è¯¢å‘½ä»¤javaæ¥è‡ªäºå“ªä¸ªrpmåŒ…</li>
<li>yumçš„é…ç½®å’Œä½¿ç”¨,åŒ…æ‹¬yumä»“åº“çš„åˆ›å»º</li>
<li>ç¼–å†™ç³»ç»Ÿåˆå§‹åŒ–è„šæœ¬ reset.shï¼ŒåŒ…æ‹¬åˆ«åï¼Œæç¤ºç¬¦é¢œè‰²ï¼Œyumä»“åº“é…ç½®æ–‡ä»¶,
å®‰è£…tree,ftp,lftp,telnetç­‰åŒ…</li>
<li>åœ¨CentOS 8ä¸Šç¼–è¯‘å®‰è£… apache 2.4.43 æºç åŒ…,å¹¶å¯åŠ¨æ­¤æœåŠ¡</li>
</ul>
</div>
</div>
</section>
<section id="outline-container-h:549bdb1f-b5e7-4961-9f37-ce8737d8e46f" class="outline-2">
<h2 id="h:549bdb1f-b5e7-4961-9f37-ce8737d8e46f">rpmåŒ…åˆ¶ä½œ</h2>
<div class="outline-text-2" id="text-h:549bdb1f-b5e7-4961-9f37-ce8737d8e46f">
</div>
<div id="outline-container-h:70e2bbad-37db-483a-a457-8e5e11c9bab2" class="outline-3">
<h3 id="h:70e2bbad-37db-483a-a457-8e5e11c9bab2">å¿«é€Ÿåˆ¶ä½œRPM</h3>
<div class="outline-text-3" id="text-h:70e2bbad-37db-483a-a457-8e5e11c9bab2">
<p>
An Overview
</p>

<ul class="org-ul">
<li>Preparing to build RPMs å‡†å¤‡åˆ¶ä½œrpmåŒ…</li>
<li>Planing for RPMs åˆ¶ä½œè§„åˆ’</li>
<li>Explanning the build process åˆ¶ä½œè¿‡ç¨‹</li>
<li>Using build files ä½¿ç”¨build files æ–‡ä»¶</li>
<li>Seeing the results åˆ¶ä½œç»“æœ</li>
<li>Verifying your RPMs éªŒè¯</li>
</ul>

<p>
Writing Spec Files
</p>

<ul class="org-ul">
<li>Writing spec files å†™ spec æ–‡ä»¶</li>
<li>Defing package information å®šä¹‰ åŒ… ä¿¡æ¯</li>
<li>Controlling the build æ§åˆ¶ç¼–è¯‘</li>
<li>Listing the files in the package åˆ—å‡ºåŒ…ä¸­åŒ…å«çš„æ‰€æœ‰æ–‡ä»¶</li>
<li>Defining spec file macros ä½¿ç”¨å®</li>
</ul>
</div>
<div id="outline-container-h:0e7e9b7d-d09c-48dd-84c2-f2221f059407" class="outline-4">
<h4 id="h:0e7e9b7d-d09c-48dd-84c2-f2221f059407">å¿«é€Ÿåˆ¶ä½œRPM</h4>
<div class="outline-text-4" id="text-h:0e7e9b7d-d09c-48dd-84c2-f2221f059407">
</div>
<div id="outline-container-h:1959d010-332c-490e-ba63-c9e7e317a5c2" class="outline-5">
<h5 id="h:1959d010-332c-490e-ba63-c9e7e317a5c2">å‡†å¤‡åˆ¶ä½œRPMåŒ…</h5>
<div class="outline-text-5" id="text-h:1959d010-332c-490e-ba63-c9e7e317a5c2">
<p>
åˆ¶ä½œRPMåŒ…çš„ä¸»è¦ä»»åŠ¡æ˜¯The main tasks in building RPMs are:
</p>

<ol class="org-ol">
<li>è§„åˆ’RPMçš„å±æ€§ Planning what you want to build ä¸€ä¸ª rpm
å¯èƒ½åŒ…å«ä¸€ä¸ªè½¯ä»¶å¯èƒ½æ˜¯æœªè¢«ç¼–è¯‘çš„ã€‚ a.æ˜¯å¦å¯ç¼–è¯‘</li>

<li>æ”¶é›†æºææ–™è½¯ä»¶åŒ… Gathering the software to package</li>

<li>æ”¶é›†è¡¥ä¸æ‰“è¡¥ä¸ï¼Œåœ¨åˆ¶ä½œè¿‡ç¨‹ä¸­æ‰“è¡¥ä¸ï¼Œæœ€å¥½åœ¨å®˜æ–¹æºç ä¸Šæ‰“ Pathching the
software as needed</li>

<li>åˆ¶å®šæŒ‡å®šè·¯å¾„çš„RPMåŒ… Creating a reproducible build of the software
æ¯”è¾ƒéº»çƒ¦</li>

<li>å‡çº§åŠŸèƒ½ Planning for upgrades</li>

<li>è§„åˆ’ä¾èµ–å…³ç³» Outlining any dependencies</li>

<li>åˆ¶ä½œRPM Building the RPMs</li>

<li>æµ‹è¯•RPM Testing the RPMs</li>
</ol>
</div>
</div>
<div id="outline-container-h:db3f3648-9db8-4f63-952d-ad166c48a817" class="outline-5">
<h5 id="h:db3f3648-9db8-4f63-952d-ad166c48a817">è§„åˆ’RPMåŒ…</h5>
<div class="outline-text-5" id="text-h:db3f3648-9db8-4f63-952d-ad166c48a817">
<ol class="org-ol">
<li>ä½ æ‰“ç®—åˆ¶ä½œä»€ä¹ˆ ï¼Ÿ åº”è¯¥ç¨‹åº ï¼Ÿ</li>

<li>æ˜¯ä¸æ˜¯ä¸€ä¸ªçº¯ç²¹çš„åº“æ–‡ä»¶</li>

<li>æ˜¯ä¸æ˜¯ä¸€å †ç³»ç»Ÿé…ç½®æ–‡ä»¶</li>

<li>æ˜¯åˆ›å»ºä¸€ä¸ªäºŒè¿›åˆ¶åŒ…è¿˜æ˜¯æºç åŒ…ï¼Œæˆ–æ˜¯éƒ½æœ‰</li>
</ol>

<p>
åŒ…å†…å®¹å¯ä»¥åŒ…æ‹¬ï¼šç¨‹åº:2è¿›åˆ¶ï¼Œæºç ï¼Œåº“æ–‡ä»¶ï¼Œç³»ç»Ÿé…ç½®æ–‡ä»¶
</p>

<p>
RPMåˆ¶ä½œè¿‡ç¨‹ä¸­å°†Mysql-5.5.22.tar.gzæºç åŒ…æ‹†æˆå¤šä¸ªåŠŸèƒ½çš„rpmåŒ…mysql,
mysql-server, mysql-devel
</p>
</div>
</div>
<div id="outline-container-h:e0ea36fb-22a8-4926-a5b8-00442c34a2bb" class="outline-5">
<h5 id="h:e0ea36fb-22a8-4926-a5b8-00442c34a2bb">è§£é‡Šåˆ¶ä½œçš„è¿‡ç¨‹</h5>
<div class="outline-text-5" id="text-h:e0ea36fb-22a8-4926-a5b8-00442c34a2bb">
<p>
rpm åŒ…åœ¨åˆ¶ä½œè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªrpm
éƒ½æä¾›ä¸€ç§èƒ½åŠ›(capabilit)ï¼Œè¿™ç§èƒ½åŠ›å¾ˆå¯èƒ½è¢«åˆ«çš„åŒ…ä¾èµ–ï¼Œè¿™ç§èƒ½åŠ›å¤§å¤šæ•°è·Ÿ
rpm åå­—ç›¸åŒã€‚æ¯ä¸€ä¸ªrpm ä¸­çš„æ–‡ä»¶å¯ä»¥ç§°ä¹‹ä¸ºèƒ½åŠ›ã€‚
</p>

<p>
èƒ½åŠ›ï¼š
</p>
<ol class="org-ol">
<li>rpm è‡ªèº«åå­—åŒ…å«çš„æ„ä¹‰</li>
<li>rpm ä¸­çš„æ–‡ä»¶å¯èƒ½è¢«åˆ«çš„ rpm ä¾èµ–ã€‚</li>
</ol>

<p>
ä¾èµ–åˆ†ä¸ºï¼šç¼–è¯‘ä¾èµ–å’Œå®‰è£…ä¾èµ–
</p>

<p>
<b>(1) å››æ­¥</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">1) &#35774;&#32622;rpm&#21253;&#30340;&#21046;&#20316;&#36710;&#38388;(&#30446;&#24405;&#32467;&#26500;)
<span style="color: #483d8b;">set</span> up the dirctory structure

2) &#23558;&#28304;&#26448;&#26009;&#25918;&#21040;&#35268;&#21010;&#22909;&#30340;&#30446;&#24405;&#20013;
Place the source<span style="color: #a020f0;"> in</span> the right directory

3) &#21019;&#24314;spec&#25991;&#20214;&#25511;&#21046;&#21046;&#20316;
Create a spec file that tells the rpmbuild command what to<span style="color: #a020f0;"> do</span> 

4) &#32534;&#35793;&#28304;&#20195;&#30721;&#29983;&#25104;rpm&#21253;
Build the source and binary RPMs
&#27880;&#24847;&#65306;&#21046;&#20316;&#36807;&#31243;&#20013;&#19981;&#33021;&#29992;&#31649;&#29702;&#21592;&#36827;&#34892;&#65292;&#36991;&#20813;&#26435;&#38480;&#22826;&#22823;&#35823;&#25805;&#20316;
</pre>
</div>

<p>
<b>(2ï¼‰ç›®å½•ç»“æ„</b>
</p>

<p>
å·¥ä½œè½¦é—´ä¸­è¦æœ‰ 5 ä¸ªå­ç›®å½•ï¼Œæ³¨æ„ç›®å½•åéƒ½è¦å¤§å†™ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">BUILD : &#28304;&#20195;&#30721;&#35299;&#21387;&#21518;&#23384;&#25918;&#30340;&#20301;&#32622;&#12290;&#30495;&#27491;&#30340;&#21046;&#20316;&#36710;&#38388;&#26159;BUILD&#30446;&#24405;
RPMS : &#21046;&#20316;&#23436;&#25104;&#21518;&#30340;RPM&#21253;&#23384;&#25918;&#20301;&#32622;&#65292;&#20026;&#29305;&#23450;&#24179;&#21488;&#21019;&#24314;&#23376;&#30446;&#24405;
SOURCES : &#25910;&#38598;&#30340;&#21407;&#26448;&#26009;&#23384;&#25918;&#20301;&#32622;
SPECS : &#23384;&#25918;spec&#25991;&#20214;
SRPMS : SRC&#26684;&#24335;&#30340;RPM&#21253;&#23384;&#25918;&#30446;&#24405;
BUILDROOT : &#20551;&#26681;&#65292;&#20351;&#29992;install&#20020;&#26102;&#23433;&#35013;&#21040;&#36825;&#20010;&#30446;&#24405;&#65292;&#25226;&#36825;&#20010;&#30446;&#24405;&#24403;&#20316;&#26681;&#26469;&#29992;&#30340;&#65292;&#25152;&#20197;&#22312;&#36825;&#20010;&#30446;&#24405;&#19979;&#30340;&#30446;&#24405;&#25991;&#20214;&#65292;&#25165;&#26159;&#30495;&#27491;&#30340;&#30446;&#24405;&#25991;&#20214;&#12290;&#24403;&#25171;&#21253;&#23436;&#25104;&#21518;&#65292;&#22312;&#28165;&#29702;&#38454;&#27573;&#65292;&#36825;&#20010;&#30446;&#24405;&#23558;&#34987;&#21024;&#38500;
</pre>
</div>


<figure id="org398ab65">
<img src="images/image-20210216015434833.png" alt="image-20210216015434833.png" width="60%">

</figure>

<p>
rpmåŒ…çš„é»˜è®¤åˆ¶ä½œè·¯å¾„åœ¨/usr/src/redhatä¸‹
</p>

<p>
<b>(3) RPMåŒ…çš„åˆ¶ä½œè½¦é—´æ˜¯ç”±RMPçš„å®å®šä¹‰çš„</b>
</p>

<p>
å®‰è£…ï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">yum -y install rpm-build   <span style="color: #b22222;"># </span><span style="color: #b22222;">centos 7</span>
</pre>
</div>

<p>
1ï¼‰ä½¿ç”¨rpmbuild æŸ¥çœ‹RPMå®
</p>

<div class="org-src-container">
<pre class="src src-sh">rpmbuild --showrc   
</pre>
</div>

<p>
å®ä»¥%å¼€å¤´ï¼Œå¼•ç”¨æ—¶åŠ {},ä¸€ä¸ªä¸‹åˆ’çº¿æ˜¯å®šä¹‰æœ¬èº«ç¯å¢ƒçš„ï¼ŒäºŒä¸ªä¸‹åˆ’çº¿é€šå¸¸å®šä¹‰çš„
æ˜¯å‘½ä»¤ä¸ºä»€ä¹ˆè¦å®šä¹‰å®ï¼Œå› ä¸ºä¸åŒçš„ç³»ç»Ÿï¼Œå‘½ä»¤çš„å­˜æ”¾ä½ç½®å¯èƒ½ä¸åŒï¼Œæ‰€ä»¥é€šè¿‡
å®çš„å®šä¹‰æ‰¾åˆ°å‘½ä»¤çš„çœŸæ­£å­˜æ”¾ä½ç½®
</p>

<p>
RPMåŒ…å®çš„ä½ç½®
</p>

<div class="org-src-container">
<pre class="src src-sh">rpmbuild --showrc | grep macro  <span style="color: #b22222;"># </span><span style="color: #b22222;">{_target}/macros:~/.rpmmacros</span>
</pre>
</div>

<p>
æ‰€ä»¥åªè¦æ”¹å˜äº†è¿™ä¸ªå®ï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå®šä¹‰å·¥ä½œè½¦é—´äº†
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@node01 ~]# rpmbuild --showrc |grep _topdir  <span style="color: #b22222;"># </span><span style="color: #b22222;">centos 7 &#24050;&#25351;&#23450;&#29992;&#25143;&#23478;&#30446;&#24405;&#65292;centos 6 &#36824;&#26159; _topdir  %{_usrsrc}/redhat</span>
-14: _builddir    %{_topdir}/BUILD
-14: _buildrootdir    %{_topdir}/BUILDROOT
-14: _rpmdir    %{_topdir}/RPMS
-14: _sourcedir    %{_topdir}/SOURCES
-14: _specdir    %{_topdir}/SPECS
-14: _srcrpmdir    %{_topdir}/SRPMS
-14: _topdir    %{getenv:HOME}/rpmbuild   
</pre>
</div>

<p>
æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯
</p>

<div class="org-src-container">
<pre class="src src-sh">rpmbuild --showrc |grep dist  <span style="color: #b22222;"># </span><span style="color: #b22222;">-14: dist    .el7.centos</span>
</pre>
</div>

<p>
åœ¨å®¶ç›®å½•ä¸‹å®šä¹‰å®å°±ä¸å†ä½¿ç”¨ç³»ç»Ÿçš„å®
</p>

<p>
è¯»å–SOURCESæ–‡ä»¶ &#x2013;&gt;BUILD &#x2013;&gt;BUILDROOT &#x2013;&gt; fileæ®µ &#x2013;&gt; cleanæ®µ
</p>

<p>
rpmå®˜æ–¹å¹¶ä¸æ¨èç›´æ¥æ›´æ”¹è¿™ä¸ªç›®å½•ï¼Œè€Œæ˜¯åœ¨ç”¨æˆ·å®¶ç›®å½•ä¸‹å»ºç«‹ä¸€ä¸ªå
ä¸º.rpmmacrosçš„éšè—æ–‡ä»¶(æ³¨æ„å‰é¢çš„ç‚¹ä¸èƒ½å°‘ï¼Œè¿™æ˜¯Linuxä¸‹éšè—æ–‡ä»¶çš„å¸¸è¯†)ï¼Œ
ç„¶ååœ¨é‡Œé¢é‡æ–°å®šä¹‰%_topdirï¼ŒæŒ‡å‘ä¸€ä¸ªæ–°çš„ç›®å½•åã€‚è¿™æ ·å°±å¯ä»¥æ»¡è¶³æŸäº›â€œé«˜
çº§â€ç”¨æˆ·çš„å·®å¼‚åŒ–éœ€æ±‚äº†ã€‚é€šå¸¸æƒ…å†µä¸‹.rpmmacrosæ–‡ä»¶é‡Œä¸€èˆ¬åªæœ‰ä¸€è¡Œå†…å®¹ï¼Œæ¯”
å¦‚
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@node01 ~]# su - jasper
[jasper@node01 ~]$ rpmbuild --showrc |grep _topdir
-14: _builddir    %{_topdir}/BUILD
-14: _buildrootdir    %{_topdir}/BUILDROOT
-14: _rpmdir    %{_topdir}/RPMS
-14: _sourcedir    %{_topdir}/SOURCES
-14: _specdir    %{_topdir}/SPECS
-14: _srcrpmdir    %{_topdir}/SRPMS
-14: _topdir    /home/jasper/rpmbuild

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20462;&#25913;&#24037;&#20316;&#36710;&#38388;&#30340;&#23439;</span>
[jasper@node01 ~]$ vim .rpmmacros  
%_topdir /home/jasper/rpmbuild

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20020;&#26102;&#30446;&#24405;&#30340;&#23439;</span>
[jasper@node01 rpmbuild]$ rpmbuild --showrc |grep -i _tmppath
-14: _tmppath    %{_var}/tmp

<span style="color: #b22222;"># </span><span style="color: #b22222;">BUILDROOT&#30340;&#23439;</span>
[jasper@node01 SPECS]$ rpmbuild --showrc |grep -i buildroot
  %{?buildroot:<span style="color: #a0522d;">RPM_BUILD_ROOT</span>=<span style="color: #8b2252;">"%{u2p:%{buildroot}}"</span>
-14: _buildrootdir    %{_topdir}/BUILDROOT
-14: buildroot    %{_buildrootdir}/%{name}-%{version}-%{release}.%{_arch}

<span style="color: #b22222;"># </span><span style="color: #b22222;">centos7 &#33050;&#26412;&#20301;&#32622;</span>
[jasper@node01 SPECS]$ rpmbuild  --showrc |grep systemd
-14: _unitdir    /usr/lib/systemd/system
</pre>
</div>
</div>
</div>
<div id="outline-container-h:3b0b7809-1fe4-40a0-bc15-d49ce8786416" class="outline-5">
<h5 id="h:3b0b7809-1fe4-40a0-bc15-d49ce8786416">å¦‚ä½•ä½¿ç”¨åˆ¶ä½œçš„ç›¸å…³æ–‡ä»¶</h5>
<div class="outline-text-5" id="text-h:3b0b7809-1fe4-40a0-bc15-d49ce8786416">
<p>
<b>1.å®šä¹‰è½¦é—´ä½ç½®</b>
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">centos7</span>
su - jasper
cat &lt;&lt;\EOF &gt;~/.rpmmacros  
<span style="color: #ffa54f;">%_topdir /home/jasper/rpmbuild</span>
<span style="color: #ffa54f;">EOF</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">centos 6 &#22914;&#19979;</span>
cat &gt;&gt; .rpmmacros  &lt;&lt;EOF
<span style="color: #ffa54f;">%_topdir /home/jasper/rpmbuild</span>
<span style="color: #ffa54f;">%buildroot %{_tmppath}/%{name}-%{version}-%{release}-root</span>
<span style="color: #ffa54f;">EOF</span>
</pre>
</div>

<p>
<b>2.åˆ›å»ºç›®å½•ç»“æ„</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">mkdir -pv ~/rpmbuild/{BUILD,RPMS,SOURCES,SPECS,SRPMS}
rpmbuild --showrc | grep _topdir  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#20197;&#25913;&#25104;&#33258;&#24049;&#30340;&#30446;&#24405;</span>
rpmbuild --showrc | grep buildroot
</pre>
</div>

<p>
<b>3.æ”¶é›†æºç åŒ…</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">[jasper@node01 rpmbuild]$ cd SOURCES/
[jasper@node01 SOURCES]$ wget http://nginx.org/download/nginx-1.13.12.tar.gz
[jasper@node01 SOURCES]$ cat nginx.sysinit  <span style="color: #b22222;"># </span><span style="color: #b22222;">cenos7 &#21551;&#21160;&#33050;&#26412;</span>
[Unit]
<span style="color: #a0522d;">Description</span>=nginx - high performance web server
<span style="color: #a0522d;">Documentation</span>=http://nginx.org/en/docs/
<span style="color: #a0522d;">After</span>=network.target remote-fs.target nss-lookup.target

[Service]
<span style="color: #a0522d;">Type</span>=forking
<span style="color: #a0522d;">PIDFile</span>=/var/run/nginx/nginx.pid
<span style="color: #a0522d;">ExecStartPre</span>=/usr/sbin/nginx -t -c /etc/nginx/nginx.conf
<span style="color: #a0522d;">ExecStart</span>=/usr/sbin/nginx  -c /etc/nginx/nginx.conf
<span style="color: #a0522d;">ExecReload</span>=/bin/kill -s HUP $<span style="color: #a0522d;">MAINPID</span>
<span style="color: #a0522d;">ExecStop</span>=/bin/kill -s QUIT $<span style="color: #a0522d;">MAINPID</span>
<span style="color: #a0522d;">PrivateTmp</span>=true

[Install]
<span style="color: #a0522d;">WantedBy</span>=multi-user.target

[jasper@node01 SOURCES]$ ls
nginx-1.13.12.tar.gz  nginx.sysinit
</pre>
</div>

<p>
<b>4.åˆ›å»ºspecæ–‡ä»¶</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">[jasper@node01 SOURCES]$ cd ../SPECS/
[jasper@node01 SPECS]$ vim nginx.spec
</pre>
</div>

<p>
<b>5.ç”¨rpmbuildå‘½ä»¤åˆ¶ä½œrpmåŒ…</b>
</p>

<p>
rpmbuildå‘½ä»¤ä¼šæ ¹æ®specæ–‡ä»¶æ¥ç”ŸæˆrpmåŒ…
</p>

<p>
rpmbuild é€‰é¡¹
</p>

<div class="org-src-container">
<pre class="src src-sh">-ba : &#21516;&#26102;&#21046;&#20316;&#25104;&#29983;&#20108;&#36827;&#21046;&#26684;&#24335;&#30340;rpm&#21253;&#21644;&#28304;&#30721;&#26684;&#24335;&#30340;rpm&#21253;&#65307;
-bb : &#20165;&#21046;&#20316;&#20108;&#36827;&#21046;&#26684;&#24335;&#30340;rpm&#21253;&#65307;
-bp : &#20165;&#25191;&#34892;&#33267;spec&#25991;&#20214;&#20013;&#30340;%prep&#38454;&#27573;&#21363;&#20572;&#27490;&#36827;&#34892;&#65307;
-bc : &#20165;&#25191;&#34892;&#21040;spec&#25991;&#20214;&#20013;&#30340;%build&#38454;&#27573;&#21363;&#20572;&#27490;&#36827;&#34892;&#65307;
-bi : &#20165;&#36816;&#34892;&#33267;spec&#25991;&#20214;&#20013;&#30340;%install&#38454;&#27573;&#21363;&#20572;&#27490;&#36816;&#34892;&#65307;
-bl : &#26816;&#26597;spec&#25991;&#20214;&#20013;%file&#27573;&#25152;&#21015;&#20986;&#30340;&#25991;&#20214;&#26159;&#19981;&#26159;&#19982;BUILDROOT&#30446;&#24405;&#20013;&#23384;&#22312;&#30340;&#25991;&#20214;&#23436;&#20840;&#21305;&#37197;&#65307;
-bs : &#20165;&#21046;&#20316;&#29983;&#25104;&#28304;&#30721;&#26684;&#24335;&#30340;rpm&#21253;
</pre>
</div>

<p>
æˆ‘ä»¬å¯ä»¥ä¸€æ­¥æ­¥è¯•ï¼Œå…ˆrpmbuild -bp ,å†-bc å†-bi å¦‚æœæ²¡é—®é¢˜ï¼Œrpmbuild -ba
ç”ŸæˆsrcåŒ…ä¸äºŒè¿›åˆ¶åŒ…å§
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">-bp : &#20165;&#25191;&#34892;&#33267;spec&#25991;&#20214;&#20013;&#30340;%prep&#38454;&#27573;&#21363;&#20572;&#27490;&#36827;&#34892;&#65307;</span>
[jasper@node01 SPECS]$ rpmbuild -bp nginx.spec
<span style="color: #0000ff;">Executing</span>(%prep): /bin/sh -e /var/tmp/rpm-tmp.TfvtrC
+ umask 022
+ cd /home/jasper/rpmbuild/BUILD
+ cd /home/jasper/rpmbuild/BUILD
+ rm -rf nginx-1.13.12
+ /usr/bin/gzip -dc /home/jasper/rpmbuild/SOURCES/nginx-1.13.12.tar.gz
+ /usr/bin/tar -xf -
+ <span style="color: #a0522d;">STATUS</span>=0
+ <span style="color: #8b2252;">'['</span> 0 -ne 0 <span style="color: #8b2252;">']'</span>
+ cd nginx-1.13.12
+ /usr/bin/chmod -Rf a+rX,u+w,g-w,o-w .
+ exit 0
[jasper@node01 SPECS]$ ls ~/rpmbuild/BUILD
nginx-1.13.12
[jasper@node01 SPECS]$ ls ~/rpmbuild/BUILD/nginx-1.13.12/
auto  CHANGES  CHANGES.ru  conf  configure  contrib  html  LICENSE  man  README  src

<span style="color: #b22222;"># </span><span style="color: #b22222;">-bc : &#20165;&#25191;&#34892;&#21040;spec&#25991;&#20214;&#20013;&#30340;%build&#38454;&#27573;&#21363;&#20572;&#27490;&#36827;&#34892;&#65307;</span>
[jasper@node01 SPECS]$ rpmbuild  -bc nginx.spec

<span style="color: #b22222;"># </span><span style="color: #b22222;">-bi : &#20165;&#36816;&#34892;&#33267;spec&#25991;&#20214;&#20013;&#30340;%install&#38454;&#27573;&#21363;&#20572;&#27490;&#36816;&#34892;&#65307;</span>
[jasper@node01 SPECS]$ rpmbuild  -bi nginx.spec

<span style="color: #b22222;"># </span><span style="color: #b22222;">-bb : &#20165;&#21046;&#20316;&#20108;&#36827;&#21046;&#26684;&#24335;&#30340;rpm&#21253;&#65307;</span>
[jasper@node01 SPECS]$ rpmbuild  -bb nginx.spec
[jasper@node01 SPECS]$ ls ../RPMS/x86_64/
nginx-1.13.12-1.el7.centos.x86_64.rpm  nginx-debuginfo-1.13.12-1.el7.centos.x86_64.rpm
</pre>
</div>
</div>
</div>
<div id="outline-container-h:1584f173-f06f-4d64-a854-f0e7a932f2f0" class="outline-5">
<h5 id="h:1584f173-f06f-4d64-a854-f0e7a932f2f0">éªŒè¯ç»“æœ</h5>
<div class="outline-text-5" id="text-h:1584f173-f06f-4d64-a854-f0e7a932f2f0">
<p>
å®‰è£…æµ‹è¯•æœ‰æ²¡æœ‰é—®é¢˜ï¼Œèƒ½å¦æ­£å¸¸å®‰è£…è¿è¡Œï¼Œèƒ½å¦æ­£å¸¸å‡çº§ï¼Œå¸è½½æœ‰æ²¡æœ‰é—®é¢˜
</p>

<p>
rootç”¨æˆ·æµ‹è¯•å®‰è£…:
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm -ivh tengine-1.4.2-1.el6.x86_64.rpm  <span style="color: #b22222;">##</span><span style="color: #b22222;">&#27979;&#35797;&#23433;&#35013;</span>
rpm -e tengine                           <span style="color: #b22222;">##</span><span style="color: #b22222;">&#27979;&#35797;&#21368;&#36733;&#65292;&#22914;&#26524;&#29256;&#26412;&#21495;&#27604;&#21407;&#26469;&#30340;&#39640;&#65292;&#21319;&#32423;&#27979;&#35797;</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">[jasper@node01 SPECS]$ su -
[root@node01 ~]# rpm --replacepkgs -ivh /home/jasper/rpmbuild/RPMS/x86_64/nginx-1.13.12-2.el7.centos.x86_64.rpm
Preparing...                          <span style="color: #b22222;">################################# </span><span style="color: #b22222;">[100%]</span>
Updating / installing...
   1:nginx-1.13.12-2.el7.centos       <span style="color: #b22222;">################################# </span><span style="color: #b22222;">[100%]</span>

[root@node01 ~]# systemctl start nginx


<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36824;&#21407;cpio &#20013;&#30340;&#28304;&#25991;&#20214;&#12290;</span>
[jasper@node01 SRPMS]$ rpm2cpio nginx-1.13.12-2.el7.centos.src.rpm &gt; nginx-1.13.12-2.cpio
[root@node01 SRPMS]# cpio -idvc &lt; nginx-1.13.12-2.cpio
nginx-1.13.12.tar.gz
nginx.spec
nginx.sysinit

&#25110;
[root@node01 SRPMS]# rpm2cpio nginx-1.13.12-2.el7.centos.src.rpm | cpio -idv
nginx-1.13.12.tar.gz
nginx.spec
nginx.sysinit
1995 blocks


<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#30475; &#28304;&#30721;&#21253;&#26377;&#20160;&#20040;&#25991;&#20214;</span>
[jasper@node01 SRPMS]$ rpm2cpio nginx-1.13.12-2.el7.centos.src.rpm | cpio -t
nginx-1.13.12.tar.gz
nginx.spec
nginx.sysinit
1995 blocks

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#28304;&#30721;&#21253;&#21487;&#20197;&#29992; --rebuild &#37325;&#26032;&#32534;&#35793;</span>
[root@node01 SRPMS]# rpmbuild --rebuild nginx-1.13.12-2.el7.centos.src.rpm
</pre>
</div>

<p>
æ­¤æ—¶ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨å½“å‰ç”¨æˆ·å®¶ç›®å½•ä¸‹ç”Ÿæˆrpmbuildç›®å½•ä»¥åŠå†…éƒ¨ç›¸å…³æ–‡ä»¶ï¼Œ
ç­‰ç¼–è¯‘ç»“æŸååªä¿ç•™ç¼–è¯‘åçš„åŒ…æ–‡ä»¶ã€‚
</p>

<p>
åœ¨åˆ¶ä½œ rpm åŒ…æ—¶å¿…é¡»ç”¨æ™®é€šç”¨åˆ¶ä½œï¼Œè¿™æ˜¯ä¸ºäº†é¿å…åˆ«äººæ¶æ„åœ¨åˆ¶ä½œè¿‡ç¨‹ <code>rm
-fr /</code> ä¹‹ç±»çš„å±é™©å‘½ä»¤ã€‚
</p>

<p>
å¦‚æœæ²¡é—®é¢˜ä¸ºrpmåŒ…ç­¾åå§ï¼Œé˜²æ­¢æœ‰äººæ¶æ„æ›´æ”¹
</p>

<p>
èŒƒä¾‹ï¼šå¿«é€Ÿæ‰“åŒ…
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">1. &#33258;&#21160;&#29983;&#25104;&#24037;&#20316;&#30446;&#24405;</span>
rpmdev-setuptree

&#24037;&#20316;&#30446;&#24405;&#22914;&#19979;&#65306;
~/rpmbuild
~/rpmbuild/SOURCES 
~/rpmbuild/SPECS 
~/rpmbuild/BUILD 
~/rpmbuild/RPMS 
~/rpmbuild/RPMS/i386 
~/rpmbuild/SRPMS 

<span style="color: #b22222;"># </span><span style="color: #b22222;">2. &#29983;&#25104;spec</span>
rpmrebuild -e -p shellname.rpm    //&#20250;&#37325;&#26032;&#29983;&#25104;spec&#65292;&#26681;&#25454;&#37324;&#38754;&#30340;&#25552;&#31034;&#37325;&#26032;&#20462;&#25913;spec&#20869;&#23481;&#65292;&#27492;&#37096;&#20998;&#26159;&#20043;&#21518;&#25490;&#38169;&#25152;&#29992;&#21040;&#65292;&#29616;&#22312;&#26080;&#38656;&#20351;&#29992;

<span style="color: #b22222;"># </span><span style="color: #b22222;">cd rpmbuild/</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">vi BUILD/shellname.spec       //&#25226;&#20197;&#19979;&#25335;&#36125;&#21040;spec&#25991;&#20214;,&#27492;&#25991;&#20214;&#26159;rpm&#25171;&#21253;&#30340;&#26680;&#24515;</span>
Summary:            Prepare net environment
Name:               shellname.x
Version:            43
Release:            el7
License:            GPL
Group:              System Environment/Base
ExclusiveArch:      x86_64
Provides:      shellname.x = 43-el7
Provides:      shellname.x(x86-64) = 43-el7
<span style="color: #0000ff;">Requires</span>(pre): /bin/sh                               <span style="color: #b22222;">#</span><span style="color: #b22222;">requires &#24456;&#26126;&#26174;&#26159;&#23433;&#35013;rpm&#21253;&#25152;&#38656;&#30340;&#20381;&#36182;,&#26681;&#25454;&#20320;&#30340;&#24773;&#20917;&#22635;&#20889;&#21363;&#21487;</span>
<span style="color: #0000ff;">Requires</span>(post): /bin/sh                               <span style="color: #b22222;">#</span><span style="color: #b22222;">&#19981;&#22635;&#20889;&#20063;&#26159;&#21487;&#20197;&#25171;&#21253;&#25104;&#21151;</span>
<span style="color: #0000ff;">Requires</span>(preun): /bin/sh
Requires:      libc.so.6()(64bit)
Requires:      libc.so.6(GLIBC_2.14)(64bit)
Requires:      libc.so.6(GLIBC_2.2.5)(64bit)
Requires:      libc.so.6(GLIBC_2.7)(64bit)
Requires:      rtld(GNU_HASH)
%description                         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25551;&#36848;&#20869;&#23481;&#65292;&#38543;&#20415;&#22635;&#23601;&#22909;</span>
shellname.x prepare net bridge environment
%prep                                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25171;&#21253;&#21069;&#30340;&#24037;&#20316;&#65292;%{buildroot}&#26159;&#39033;&#30446;&#26681;&#30446;&#24405;&#65292;&#32780;%{_binddir}&#26159;&#25351;/usr/bin&#30446;&#24405;</span>
mkdir -p %{buildroot}%{_bindir}    <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21019;&#24314;&#39033;&#30446;&#25152;&#38656;&#30340;&#30446;&#24405;,&#21040;&#26102;&#20505;&#23433;&#35013;rpm&#21253;&#20250;&#29983;&#25104;_binddir&#30446;&#24405;&#19979;</span>
install -c -m 755 $<span style="color: #a0522d;">OLDPWD</span>/shellname.x %{buildroot}%{_bindir}/shellname.x    <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23558;&#25171;&#21253;&#25991;&#20214;&#25335;&#36125;&#21040;&#21040;&#39033;&#30446;&#30446;&#24405;</span>
<span style="color: #a020f0;">exit</span> 0
%files                <span style="color: #b22222;"># </span><span style="color: #b22222;">&#27492;&#22788;&#22635;&#20889;&#39033;&#30446;&#21253;&#21547;&#30340;&#30446;&#24405;,&#20063;&#23601;&#26159;&#35828;&#23433;&#35013;&#23436;rpm&#21253;&#65292;&#23558;&#20250;&#29983;&#25104;&#36825;&#20123;&#30446;&#24405;&#21644;&#25991;&#20214;</span>
/usr/bin/shellname.x        
<span style="color: #b22222;">#</span><span style="color: #b22222;">%{_bindir}                # &#27492;&#22788;&#25105;&#26366;&#22635;&#20889;,&#25191;&#34892;rpm&#23433;&#35013;&#25253;&#38169;,&#21407;&#22240;&#26435;&#38480;&#19981;&#22815;,&#29616;&#22312;&#24050;&#27880;&#37322;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">%dir %attr(0755, root, root) "/usr/bin"          # &#27492;&#22788;&#25105;&#26366;&#22635;&#20889;,&#25191;&#34892;rpm&#23433;&#35013;&#25253;&#38169;,&#21407;&#22240;&#26435;&#38480;&#19981;&#22815;,&#29616;&#22312;&#24050;&#27880;&#37322;</span>
%attr(0755, root, root) <span style="color: #8b2252;">"/usr/bin/shellname.x"</span>   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20462;&#25913;&#26435;&#38480;&#21644;&#25152;&#23646;</span>
%pre -p /bin/sh                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#19981;&#28165;&#26970;&#21547;&#20041;&#65292;rpmrebuild&#20462;&#22797;&#21518;&#29983;&#25104;&#20986;&#26469;</span>
%post -p /bin/sh                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21516;&#19978;&#65292;rpmrebuild&#20462;&#22797;&#21518;&#29983;&#25104;&#20986;&#26469;</span>
%preun -p /bin/sh                              <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21516;&#19978;&#65292;rpmrebuild&#20462;&#22797;&#21518;&#29983;&#25104;&#20986;&#26469;</span>
%define __spec_install_pre /bin/true                 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21516;&#19978;</span>
%build                 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#27492;&#22788;&#24212;&#35813;&#26159;&#32534;&#35793;&#28304;&#30721;&#21253;&#25152;&#38656;&#35201;&#22635;&#20889;&#30340;</span>
%clean                 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26500;&#24314;&#23436;&#39033;&#30446;&#28165;&#29702;</span>
rm -rf %{buildroot}
%changelog             <span style="color: #b22222;"># </span><span style="color: #b22222;">&#19981;&#28165;&#26970;&#20316;&#29992;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">3. &#20351;&#29992;rpmbuild&#21629;&#20196;&#25171;&#21253;</span>
rpmbuild -bb /BUILD/shellname.spec
</pre>
</div>

<p>
æ³¨æ„ï¼šshellname.x æ”¾åœ¨rpmbuildç›®å½• ç”Ÿæˆçš„rpmåŒ…åœ¨rpmbuild/RPMS/ç›®å½•ä¸‹ï¼Œ
è¾“å‡ºçš„rpmåŒ…å°±å¯ä»¥æ‰§è¡Œå®‰è£…å•¦ï¼ <code>rpm -ivh shellname.rpm</code>
</p>
</div>
</div>
</div>
<div id="outline-container-h:6b808e24-eef0-4d91-8414-9b51bb7273ad" class="outline-4">
<h4 id="h:6b808e24-eef0-4d91-8414-9b51bb7273ad">å†™ä¸€ä¸ªSpecæ–‡ä»¶</h4>
<div class="outline-text-4" id="text-h:6b808e24-eef0-4d91-8414-9b51bb7273ad">
<p>
An Overview
</p>

<ul class="org-ul">
<li>Preparing to build RPMs å‡†å¤‡åˆ¶ä½œrpmåŒ…</li>
<li>Planing for RPMs åˆ¶ä½œè§„åˆ’</li>
<li>Explanning the build process åˆ¶ä½œè¿‡ç¨‹</li>
<li>Using build files ä½¿ç”¨build files æ–‡ä»¶</li>
<li>Seeing the results åˆ¶ä½œç»“æœ</li>
<li>Verifying your RPMs éªŒè¯</li>
</ul>

<p>
Writing Spec Files
</p>

<ul class="org-ul">
<li>Writing spec files å†™ spec æ–‡ä»¶</li>
<li>Defing package information å®šä¹‰ åŒ… ä¿¡æ¯</li>
<li>Controlling the build æ§åˆ¶ç¼–è¯‘</li>
<li>Listing the files in the package åˆ—å‡ºåŒ…ä¸­åŒ…å«çš„æ‰€æœ‰æ–‡ä»¶</li>
<li>Defining spec file macros ä½¿ç”¨å®</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">[root@node01 Packages]# rpm -qi bash-4.2.46-28.el7.x86_64
Name        : bash   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36719;&#20214;&#21253;&#21517;</span>
Version     : 4.2.46  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#29256;&#26412;&#21495;</span>
Release     : 28.el7  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21457;&#34892;&#21495;</span>
Architecture: x86_64
Install Date: Thu 18 Jan 2018 04:15:43 PM CST
Group       : System Environment/Shells  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25152;&#23646;&#30340;&#21253;&#32452;</span>
Size        : 3663637
License     : GPLv3+
Signature   : RSA/SHA256, Thu 10 Aug 2017 11:03:40 PM CST, Key ID 24c6a8a7f4a80eb5  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#31614;&#21517;&#20449;&#24687;</span>
Source RPM  : bash-4.2.46-28.el7.src.rpm
Build Date  : Thu 03 Aug 2017 05:13:21 AM CST <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21046;&#20316;&#26085;&#26399;</span>
Build Host  : c1bm.rdu2.centos.org   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21046;&#20316;&#20027;&#26426;</span>
Relocations : (not relocatable)  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26159;&#21542;&#25903;&#25345;&#37325;&#26032;&#23450;&#20041;&#23433;&#35013;&#36335;&#24452;</span>
Packager    : CentOS BuildSystem <a href="http://bugs.centos.org">&lt;http://bugs.centos.org&gt;</a>  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#35841;&#21046;&#20316;&#30340;</span>
Vendor      : CentOS  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21046;&#20316;&#32773;</span>
URL         : http://www.gnu.org/software/bash
Summary     : The GNU Bourne Again shell  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#31616;&#35201;&#35828;&#26126;&#65292;&#19981;&#35201;&#36229;&#36807;50&#20010;&#23383;&#31526;</span>
Description :   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#35814;&#32454;&#35828;&#26126;</span>
</pre>
</div>

<p>
åŸºæœ¬ä¿¡æ¯
</p>
<div class="org-src-container">
<pre class="src src-sh">Name: &#36719;&#20214;&#21517;&#31216;
Version: &#36719;&#20214;&#29256;&#26412;
Release: &#21457;&#24067;&#27425;&#25968; &#22914;: 1%{?dist}
Summary: &#36719;&#20214;&#35828;&#26126;

Group: &#36719;&#20214;&#20998;&#32452;
License: &#25480;&#26435;&#27169;&#24335;,&#20363;&#22914; GPL
URL: &#28304;&#30721;&#21253;&#30340;URL&#22320;&#22336;
Source0: &#28304;&#30721;&#21253;,&#21487;&#25351;&#23450;&#22810;&#20010;,&#19979;&#38754;&#21487;&#29992;%{SOURCE0}&#21464;&#37327;&#24341;&#29992;
BuildRoot: &#32534;&#35793;&#36807;&#31243;&#20013;&#30340;&#20013;&#38388;&#23384;&#26723;&#30446;&#24405; &#22914;: %(mktemp -ud %{_tmppath}/%{name}-%{version}-%{release}-XXXXXX)
BuildArch: &#24179;&#21488; %{_arch}
BuildRequires:&#32534;&#35793;&#36807;&#31243;&#20381;&#36182;&#30340;&#24037;&#20855;
Requires: &#25152;&#20381;&#36182;&#30340;&#36719;&#20214;&#21253;

</pre>
</div>

<p>
æœ€ç»ˆçš„rpmåç§°: {Name}-{Version}-{Relesae}-{BuildArch}.rpm
</p>
</div>
<div id="outline-container-h:c15db9cb-7564-4dc3-9278-0eca504bb8e7" class="outline-5">
<h5 id="h:c15db9cb-7564-4dc3-9278-0eca504bb8e7">specæ–‡ä»¶è¯­æ³•æ ¼å¼</h5>
<div class="outline-text-5" id="text-h:c15db9cb-7564-4dc3-9278-0eca504bb8e7">
<p>
æ ‡ç­¾ï¼š TagName: value (Name: nginx) â€‹#å‰é¢Nameæ˜¯ä¸åŒºåˆ†å¤§å°å†™ï¼Œåé¢å¿…é¡»
å°å†™
</p>

<p>
è‡ªå®šä¹‰å®ï¼š %define macro_name value #æœ€å¥½ä¸è¦è·Ÿæ ‡ç­¾é‡åï¼Œå¼•ç”¨å®
%{macro_name} æˆ– %macro_name
</p>

<p>
æ³¨é‡Šï¼š #å¼€å¤´çš„è¡Œï¼Œåœ¨æ³¨é‡Šä¸­ä¸è¦ä½¿ç”¨%ï¼Œç”¨%%ä»£æ›¿
</p>
</div>
</div>
<div id="outline-container-h:9c55a872-4868-4243-a019-1308cc292365" class="outline-5">
<h5 id="h:9c55a872-4868-4243-a019-1308cc292365">å®šä¹‰åŒ…çš„ä¿¡æ¯</h5>
<div class="outline-text-5" id="text-h:9c55a872-4868-4243-a019-1308cc292365">
<p>
ä½¿ç”¨ rpm -qi å¯ä»¥çœ‹è§çš„
</p>


<figure id="org18180e8">
<img src="images/image-20210216015554996.png" alt="image-20210216015554996.png" width="60%">

</figure>

<ol class="org-ol">
<li><p>
åŒ…åï¼š
</p>

<div class="org-src-container">
<pre class="src src-sh">Name: Name&#20013;&#19981;&#33021;&#20351;&#29992;<span style="color: #8b2252;">"-"</span>&#65292;<span style="color: #8b2252;">"-"</span>&#26377;&#29305;&#27530;&#24847;&#20041;&#12290;name-version-release.rpm, name-version-release.arch.rpm
Version: &#36319;&#36719;&#20214;&#21253;&#29256;&#26412;&#30456;&#21516;&#29256;&#26412;&#21495;&#65292;version&#20013;&#19981;&#33021;&#20351;&#29992;<span style="color: #8b2252;">"-"</span>
Release: &#20462;&#27491;&#21495;&#12290;&#22914;&#65292;Release: 1%{?dist} <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21457;&#34892;&#21495;&#65292;&#31532;&#20960;&#27425;&#21046;&#20316;&#12290;&#23439;&#21069;&#26377;&#21028;&#26029;?&#21495;&#65292;&#22914;&#26524;&#26377;&#65292;&#21017;&#21152;&#19978;&#23439;</span>
Summary: &#21253;&#30340;&#31616;&#35201;&#25551;&#36848;&#65292;&#19968;&#33324;&#19981;&#35201;&#36229;&#36807;50&#20010;&#23383;&#31526;
Group: &#20351;&#29992; /usr/share/doc/rpm-&#29256;&#26412;&#21495;/GROUPS &#20013;&#29616;&#23384;&#30340;&#32452;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-nil">
</pre>
</div></li>

<li><p>
å…¬å¸ç›¸å…³ä¿¡æ¯ï¼š License:
</p>

<div class="org-src-container">
<pre class="src src-sh">License: &#29256;&#26435;&#65292;&#22914;&#26524;&#29256;&#26435;&#23646;&#20110;&#21035;&#20154;&#30340;&#28304;&#30721;&#21253;&#65292;&#24314;&#35758;Vendor,URL&#20889;&#25104;&#21035;&#20154;&#30340;
URL&#65306;RPM&#21253;&#19979;&#36733;&#20301;&#32622;(&#21487;&#36873;&#65292;&#26368;&#22909;&#21035;&#30465;)
Packager: RPM&#21253;&#21046;&#20316;&#32773;&#12290;&#20808;&#20889;&#21517;&#23383;(first name, last name)&#21518;&#20889;&#37038;&#31570;&#22320;&#22336; email&#19968;&#33324;&#20889;&#22312;&lt;&gt;&#20013; (&#21487;&#36873;)&#12290;&#22914;&#65292;Packager: jasper hsu <a href="mailto:xcwhome%40gmail.com">&lt;xcwhome@gmail.com&gt;</a>
Vendor: &#25552;&#20379;RPM&#20844;&#21496;&#30456;&#20851;&#20449;&#24687;&#65292;&#20063;&#21487;&#20197;&#26159;&#21046;&#20316;&#32773;(&#21487;&#36873;&#65292;&#26368;&#22909;&#21035;&#30465;)
</pre>
</div></li>

<li>æè¿°ä¿¡æ¯ï¼š %descripitionï¼šå¯åˆ†æ®µä»‹ç»ï¼Œæ¯è¡Œé•¿åº¦ä¸è¶…è¿‡50å­—ç¬¦ã€‚</li>

<li><p>
è®¾å®šbuildç›®å½•
</p>

<p>
BUILDï¼šææ–™æ”¾åˆ°é‡Œé¢ç¼–è¯‘ BuildRoot
</p>

<p>
æ‹Ÿå®šçš„/ç›®å½•ï¼Œé€šå¸¸æ”¾åœ¨ä¸´æ—¶ç›®å½•BUILDROOTä¸­ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œä¼šåœ¨æ¸…ç†æ®µ
%cleanåˆ é™¤ç›®å½•ã€‚æ‰€æœ‰åœ¨è¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶é™¤äº†DEBUGä¿¡æ¯éƒ½è¦åšè¿›rpmåŒ…ä¸­ã€‚
</p>

<div class="org-src-container">
<pre class="src src-sh">BuildRoot: %{_tmppath}/%{name}-%{version}-root <span style="color: #b22222;"># </span><span style="color: #b22222;">BuildRoot&#21478;&#19968;&#20010;&#21464;&#37327;&#21517; RPM_BUILD_ROOT&#65292;&#20351;&#29992;&#26102;$RPM_BUILD_ROOT</span>
</pre>
</div>

<p>
cenots7 è¿™é‡Œåˆ‡æ¢BUILDROOT ç›®å½•æˆ‘æ˜¯åœ¨~/.rpmmacros ä¸­å®šä¹‰ç”Ÿæ•ˆçš„
</p>

<div class="org-src-container">
<pre class="src src-sh">su - jasper
cat &lt;&lt;\EOF &gt;~/.rpmmacros
<span style="color: #ffa54f;">%_topdir /home/jasper/rpmbuild</span>
<span style="color: #ffa54f;">%buildroot %{_tmppath}/%{name}-%{version}-root</span>
<span style="color: #ffa54f;">EOF</span>
</pre>
</div></li>

<li><p>
å®šä¹‰åŒ…çš„ä¾èµ–å…³ç³»ï¼š
</p>

<p>
<code>Requires: capbility</code> ã€‚å®‰è£…æ—¶çš„ä¾èµ–ï¼Œcapbilityé€šå¸¸æ˜¯åŒ…çš„åå­—ä¹Ÿå¯ä»¥
æ˜¯æä¾›çš„èƒ½åŠ›,æˆ–æ–‡ä»¶,åå­—æœ‰å¤šä¸ªç”¨â€,â€œéš”å¼€ï¼Œå¯å‡ºç°å¤šæ¬¡(å¯é€‰)
</p>

<div class="org-src-container">
<pre class="src src-sh">Requires: bash,chkconfig
Requires: bash&gt;=2.0             <span style="color: #b22222;"># </span><span style="color: #b22222;">&#29256;&#26412;&#21495;&#22823;&#20110;2.0</span>
Requires: perl(Caro) &gt;=3.2    <span style="color: #b22222;"># </span><span style="color: #b22222;">&#38480;&#21046;&#27169;&#22359;&#29256;&#26412;</span>
<span style="color: #0000ff;">Requires</span>(pre):                         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23433;&#35013;&#21069;pre&#33050;&#26412;&#29992;&#21040;</span>
<span style="color: #0000ff;">Requires</span>(post):                        <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23433;&#35013;&#21518;poste&#33050;&#26412;&#29992;&#21040;</span>
<span style="color: #0000ff;">Requires</span>(preun):                     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21368;&#36733;&#21069;&#30340;&#33050;&#26412;&#29992;&#21040;&#21738;&#20123;&#21253;</span>
<span style="color: #0000ff;">Requires</span>(postun):                   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21368;&#36733;&#21518;&#30340;&#33050;&#26412;&#29992;&#21040;&#21738;&#20123;&#21253;</span>
Provides: capbility                       <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23450;&#20041;&#25552;&#20379;&#30340;&#33021;&#21147;&#65292;&#19981;&#23450;&#20041;&#33021;&#21147;&#20854;&#33021;&#21147;&#26159;&#33258;&#24049;&#30340;&#21253;&#21517;(&#21487;&#36873;)</span>
BuildRequires: capbility               <span style="color: #b22222;"># </span><span style="color: #b22222;">&#32534;&#35793;&#26102;&#38656;&#35201;&#30340;&#20381;&#36182;&#65292;&#21487;&#20986;&#29616;&#22810;&#27425;(&#21487;&#36873;)</span>
</pre>
</div></li>

<li><p>
å®šä¹‰æºç åŒ…çš„æºæ–‡ä»¶ä¿¡æ¯
</p>

<div class="org-src-container">
<pre class="src src-sh">Source0: nginx-1.0.12.tar.gz
Source1: nginx.conf
Source2: nginx.init
Source: http://www.123.com/%{name}-%{version}.tar.gz &#65283;&#26377;URL&#36830;&#25509;&#30340;&#19981;&#20250;&#30495;&#30340;&#19979;&#65292;&#32780;&#26159;&#25226;&#21069;&#38754;&#21435;&#25481;&#21482;&#30041;&#25991;&#20214;&#21517;
</pre>
</div>

<p>
å¦‚æœæºæ–‡ä»¶åªæœ‰ä¸€ä¸ªï¼Œå»æ‰0ï¼Œå¦‚æœæœ‰å¤šä¸ªå°±éœ€è¦ç¼–å·äº†0,1,2,&#x2026;
</p>

<p>
æºæ–‡ä»¶å¿…é¡»ä½äºSOURCESç›®å½•ä¸­
</p></li>

<li><p>
å®šä¹‰è¡¥ä¸åç§°
</p>

<div class="org-src-container">
<pre class="src src-sh">Patch1: httpd-2.2.22-pcre380.patch
Patch3: httpd-2.2.21-mod_proxy-change-state.patch
</pre>
</div>

<p>
å¯ä»¥ä½¿ç”¨patchå‘½ä»¤æ‰“è¡¥ä¸
</p></li>
</ol>
</div>
</div>
<div id="outline-container-h:42781958-7adc-403b-a4f1-26e786113853" class="outline-5">
<h5 id="h:42781958-7adc-403b-a4f1-26e786113853">æ§åˆ¶ç¼–è¯‘å®‰è£…è¿‡ç¨‹</h5>
<div class="outline-text-5" id="text-h:42781958-7adc-403b-a4f1-26e786113853">
<p>
<b>2.3.1 å‡†å¤‡é˜¶æ®µ %prep</b>
</p>

<p>
ä½œç”¨ï¼šæŠŠæºç åŒ…è§£å‹åˆ°%{_builddir}ä¸‹ï¼Œè§£å‹è½¯ä»¶åŒ…åˆ°BUILDå¹¶cdè¿›å»ï¼Œè®¾å®šç¼–
è¯‘å‰çš„å˜é‡
</p>

<p>
å¦‚æœæ˜¯å¯¹æŸå½’æ¡£æ ¼å¼çš„æºç¨‹åºåˆ¶ä½œrpmåŒ…ï¼Œæ­¤æ®µä¸­ç»å¸¸è¦ä½¿ç”¨%setupæ¥å®ç°å°†æº
ç è§£å‹è‡³%{_topdir}/BUILDç›®å½•ä¸­ï¼Œå¹¶ä½¿ç”¨cdå‘½ä»¤å°†åˆ¶ä½œè¿‡ç¨‹çš„å·¥ä½œç›®å½•åˆ‡æ¢è‡³
æ­¤è§£å‹åçš„æºç ç›®å½•ã€‚å½“ç„¶ï¼Œ%setupä¹Ÿæœ‰ä¸€äº›é€‰é¡¹å®ç°æ›´è¿›ä¸€æ­¥çš„è®¾ç½®ã€‚
</p>

<p>
%setup ä¸€ä¸ªå®æ¥å®Œæˆè§£å‹ã€è®¾å®šç¯å¢ƒã€cd è¿›å»
</p>

<p>
<b>ç²¾ç¡®æ§åˆ¶å±•å¼€æ–¹å¼ %setup å‚æ•°</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">-q <span style="color: #b22222;"># </span><span style="color: #b22222;">&#38745;&#40664;&#27169;&#24335;&#65292;&#33267;&#23569;&#36755;&#20986;&#20449;&#24687;</span>
-n <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21578;&#35785;&#23637;&#24320;&#21518;&#30340;&#30446;&#24405;&#21517;&#31216;&#12290; &#22914;nagios-3.3.2.tar.gz &#65292;&#35299;&#21387;&#21518;&#25913;&#21517;&#20026;nagios-hahah</span>
-a number <span style="color: #b22222;"># </span><span style="color: #b22222;">after,&#20808;cd&#21040;&#30446;&#24405;&#35299;&#21387;&#32553;</span>
&#22914;,
Source0: a.tar.gz
Source1: b.tar.gz
Source2: nginx.tar.gz
%setup -q -a 0 -a 1   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20808;cd &#21040;&#30446;&#24405;&#19979;&#65292;&#20877;&#35299;&#21387;&#32553;&#65292;&#20250;&#26377;2&#20010;&#30446;&#24405;</span>

-b number <span style="color: #b22222;"># </span><span style="color: #b22222;">before,&#20808;&#23637;&#24320;&#20877;cd&#21040;&#30446;&#24405;</span>

&#22914;&#65292;
Source0: a.tar.gz
Source1: b.tar.gz
Source2: nginx.tar.gz
%setup -q -b 0 -b 1   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20808;&#23637;&#24320;&#20877;cd&#65292;&#20250;&#26377;1&#20010;&#30446;&#24405;</span>

-c <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21019;&#24314;&#19968;&#20010;&#30446;&#24405;&#65292;&#19968;&#33324;&#37197;&#21512;-b</span>
Name: nginx
Version: 1.0.14
mkdir %{BUILD}/nginx-1.0.14

-T <span style="color: #b22222;">#</span><span style="color: #b22222;">&#19981;&#23637;&#24320;</span>
-D <span style="color: #b22222;">#</span><span style="color: #b22222;">do not delete the directory before unpacking</span>
</pre>
</div>


<p>
å¦‚ï¼Œrpmbuild -bp : ä»…æ‰§è¡Œè‡³specæ–‡ä»¶ä¸­çš„%prepé˜¶æ®µå³åœæ­¢è¿›è¡Œï¼›
</p>

<div class="org-src-container">
<pre class="src src-sh">[jasper@node01 SPECS]$ rpmbuild -bp nginx.spec
<span style="color: #0000ff;">Executing</span>(%prep): /bin/sh -e /var/tmp/rpm-tmp.TfvtrC
+ umask 022
+ cd /home/jasper/rpmbuild/BUILD
+ cd /home/jasper/rpmbuild/BUILD
+ rm -rf nginx-1.13.12
+ /usr/bin/gzip -dc /home/jasper/rpmbuild/SOURCES/nginx-1.13.12.tar.gz
+ /usr/bin/tar -xf -
+ <span style="color: #a0522d;">STATUS</span>=0
+ <span style="color: #8b2252;">'['</span> 0 -ne 0 <span style="color: #8b2252;">']'</span>
+ cd nginx-1.13.12
+ /usr/bin/chmod -Rf a+rX,u+w,g-w,o-w .
+ exit 0
[jasper@node01 SPECS]$ ls ~/rpmbuild/BUILD
nginx-1.13.12
[jasper@node01 SPECS]$ ls ~/rpmbuild/BUILD/nginx-1.13.12/
auto  CHANGES  CHANGES.ru  conf  configure  contrib  html  LICENSE  man  README  src

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23454;&#38469;&#30340;&#36807;&#31243;&#26159;</span>
[jasper@node01 ~]$ cd /home/jasper/rpmbuild/BUILD
[jasper@node01 BUILD]$ rm -fr nginx-1.13.12
[jasper@node01 BUILD]$ /usr/bin/gzip -dc /home/jasper/rpmbuild/SOURCES/nginx-1.13.12.tar.gz | tar -xf -
[jasper@node01 BUILD]$ ls
nginx-1.13.12
</pre>
</div>

<p>
å¦‚ï¼Œä½¿ç”¨rpmbuild &#x2013;clean åˆ é™¤BUILDç›®å½•ä¸­å†…å®¹
</p>

<div class="org-src-container">
<pre class="src src-sh">[jasper@node01 SPECS]$ rpmbuild --clean nginx.spec
warning: bogus date<span style="color: #a020f0;"> in</span> %changelog: Wed May 22 2018 jasperhsu <a href="mailto:xcwhome%40gmail.com">&lt;xcwhome@gmail.com&gt;</a> -1.13.12-2
<span style="color: #0000ff;">Executing</span>(--clean): /bin/sh -e /var/tmp/rpm-tmp.18hPfd
+ umask 022
+ cd /home/jasper/rpmbuild/BUILD
+ rm -rf nginx-1.13.12
+ exit 0
</pre>
</div>

<p>
å¦‚ï¼Œ
</p>

<div class="org-src-container">
<pre class="src src-sh">%prep
%setup -q
%patch       <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25171;&#34917;&#19969; &#31532;&#19968;&#20010;&#34917;&#19969;%patch1,&#31532;&#20108;&#20010;&#34917;&#19969;%patch2&#65292;patch&#21629;&#20196;&#20351;&#29992;&#30340;&#21629;&#20196;&#37117;&#21487;&#20197;&#20351;&#29992;</span>
</pre>
</div>

<p>
<b>2.3.2 ç¼–è¯‘é˜¶æ®µ %build</b>
</p>

<p>
å¦‚æœåˆ¶ä½œrpmåŒ…çš„æºææ–™ä¸æ˜¯æºç¨‹åºï¼Œæ­¤æ®µå¯ä»¥ä¸ç”¨è®¾ç½®ï¼›
</p>

<p>
å¦‚æœæ˜¯C/C++ç­‰ç±»çš„ç¨‹åºï¼Œæ­¤å¤„å¯¹åº”äºå…¶ç¼–è¯‘å®‰è£…è¿‡ç¨‹ä¸­çš„â€œconfigureâ€å’Œâ€œmakeâ€ä¸¤æ­¥ï¼›
</p>

<p>
å¦‚æœæ˜¯perlç±»çš„æºç¨‹åºï¼Œæ­¤å¤„é€šå¸¸å¯¹åº”äºå…¶ç¼–è¯‘å®‰è£…è¿‡ç¨‹ä¸­çš„â€œperl Makefile.PLâ€å’Œâ€œmakeâ€ä¸¤æ­¥ã€‚
</p>

<p>
ç„¶è€Œï¼Œä¸ºäº†ç¼–è¯‘è¿‡ç¨‹ä¸­çš„ç¼–è¯‘ç¯å¢ƒè®¾å®šä¸å‡ºç°é—®é¢˜ï¼Œæ­¤å¤„å¦‚æœè¦ç”¨åˆ°configure
è„šæœ¬æ—¶é€šå¸¸è¦ä½¿ç”¨å®%configureæ¥æ›¿æ¢ã€‚å¯ä»¥ä½¿ç”¨ <code>rpm --eval '%configure'</code>
å‘½ä»¤æ¥è·å–å½“å‰ç³»ç»Ÿä¸Š%configureå®çš„ç›¸å…³å®šä¹‰ã€‚
</p>

<p>
ç¤ºä¾‹
</p>

<div class="org-src-container">
<pre class="src src-sh">%build
./configure  --prefix=/usr<span style="color: #8b2252;">\</span>
--sysconfdir=/etc/nginx
make %{?_smp_mflags}    <span style="color: #b22222;">#</span><span style="color: #b22222;">smp&#23545;&#31216;&#22810;&#22788;&#29702;&#22120;&#65292;&#23439;&#23384;&#22312;&#21017;&#20351;&#29992;&#65292;&#21487;&#22810;&#26680;&#24182;&#34892;&#32534;&#35793;&#12290;?&#21495;&#34920;&#31034;&#21028;&#23450;&#65292;&#22914;&#26524;&#23439;&#23384;&#22312;&#21017;&#20351;&#29992;&#65292;&#19981;&#23384;&#22312;&#21017;&#19981;&#20351;&#29992;&#12290;</span>
</pre>
</div>

<p>
å¦‚ï¼Œå¯¹äº perl çš„ç¼–è¯‘
</p>

<div class="org-src-container">
<pre class="src src-sh">%build
perl Maifile PL
make
</pre>
</div>

<p>
-bc : ä»…æ‰§è¡Œåˆ°specæ–‡ä»¶ä¸­çš„%buildé˜¶æ®µå³åœæ­¢è¿›è¡Œï¼›
</p>

<div class="org-src-container">
<pre class="src src-sh">[jasper@node01 SPECS]$ rpmbuild  -bc nginx.spec
</pre>
</div>

<p>
ä¸æ˜¯æºç åŒ…ä¸éœ€è¦ç¼–è¯‘ï¼Œç•™ç©º
</p>

<p>
*2.3.3 å®‰è£…é˜¶æ®µ %install*åˆ¶ä½œrpmæ—¶ï¼Œæ‰€æœ‰è¦æ‰“åŒ…è¿›rpmåŒ…çš„æ–‡ä»¶éƒ½éœ€è¦äº‹å…ˆ
æŒ‰ç…§å…¶è®¡åˆ’æœ€ç»ˆå®‰è£…åœ¨ç³»ç»Ÿä¸Šçš„è·¯å¾„å…ˆå®‰è£…è‡³ä¸€ä¸ªä¸´æ—¶ç›®å½•ä¸­ï¼Œæ­¤ä¸´æ—¶ç›®å½•åšä¸º
æ¨¡æ‹Ÿçš„ç³»ç»Ÿæ ¹ç›®å½•ï¼Œå…¶é€šå¸¸ç§°ä¸ºBUILDROOTç›®å½•ã€‚æ­¤ç›®å½•å¯ä»¥åœ¨specæ–‡ä»¶ä¸­ä½¿ç”¨
â€œBuildRoot:â€æ ‡ç­¾è¿›è¡Œå®šä¹‰ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨åæ–‡ä¸­ä½¿ç”¨%{BuildRoot}å¼•ç”¨ï¼Œäº‹
å®ä¸Šå…¶ä¹Ÿå¯ä»¥ä½¿ç”¨$RPM_BUILD_ROOTå¼•ç”¨ã€‚
</p>

<p>
%install
</p>

<p>
for example
</p>

<div class="org-src-container">
<pre class="src src-sh">%install
rm -rf %{buildroot}   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21046;&#20316;&#36807;&#31243;&#21487;&#33021;&#37325;&#22797;&#22810;&#36941;&#30340;&#65292;&#36991;&#20813;&#19978;&#27425;&#23433;&#35013;&#30340;&#24433;&#21709;&#36825;&#27425;&#23601;&#35201;&#21024;&#38500;BUILDROOT&#30446;&#24405;&#30340;&#20013;&#25968;&#25454;</span>
make install <span style="color: #a0522d;">DESTDIR</span>=%{buildroot}  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#30446;&#26631;&#22320;&#22336;&#20026;%{buildroot}</span>
%{__install} -p -D -m 0644 %{SOURCE5} <span style="color: #8b2252;">\ </span>                    <span style="color: #b22222;"># </span><span style="color: #b22222;">install &#21629;&#20196;&#22797;&#21046;&#25991;&#20214; -d&#21019;&#24314;&#30446;&#24405;&#65292;-D&#25991;&#20214;&#25918;&#21040;&#25351;&#23450;&#30446;&#24405;&#19979;&#65292;&#19981;&#23384;&#22312;&#21017;&#21019;&#24314;&#12290;&#27880;&#24847;&#24341;&#29992;source5&#24517;&#39035;&#20840;&#22823;&#20889;&#12290;</span>
%{buildroot}%{_sysconfdir}/sysconfig/%{name}
%{__install} -p -d -m 0755 %{buildroot}/var/log/nginx
</pre>
</div>

<p>
<b>2.3.4 æ¸…ç†é˜¶æ®µ %clean</b>
</p>

<p>
å¯è‡ªè¡Œå®šä¹‰åˆ é™¤å“ªäº› æ­¤æ®µé€šå¸¸ç”¨äºæ¸…ç†å…¶å®ƒé˜¶æ®µçš„å‘½ä»¤æ‰€åˆ›å»ºçš„æ–‡ä»¶ï¼Œæ¯”å¦‚
<code>rm -rf $RPM_BUILD_ROOT</code> å‘½ä»¤å³ä¸ºåˆ é™¤å‰æ¬¡åˆ¶ä½œrpmåŒ…æ—¶å®‰è£…ç”Ÿçš„BUILDROOT
ç›®å½•ã€‚
</p>

<p>
for example
</p>

<div class="org-src-container">
<pre class="src src-sh">%clean
rm -fr %{buildroot}
</pre>
</div>
</div>
</div>
<div id="outline-container-h:6d5fea45-2645-4a6b-a345-0cc3ecceb9b0" class="outline-5">
<h5 id="h:6d5fea45-2645-4a6b-a345-0cc3ecceb9b0">è„šæœ¬æ®µ</h5>
<div class="outline-text-5" id="text-h:6d5fea45-2645-4a6b-a345-0cc3ecceb9b0">
<p>
shellè„šæœ¬
</p>

<ul class="org-ul">
<li>%pre å®‰è£…å‰æ‰§è¡Œçš„è„šæœ¬</li>
<li>%post å®‰è£…åæ‰§è¡Œçš„è„šæœ¬</li>
<li>%preun å¸è½½å‰æ‰§è¡Œçš„è„šæœ¬</li>
<li>%postun å¸è½½åæ‰§è¡Œçš„è„šæœ¬</li>
</ul>

<p>
<b>2.4.1 è„šæœ¬ä¸­çš„åˆ¤æ–­åŠ¨ä½œ</b>
</p>

<p>
$1 å¤„ç†ç±»å‹æˆ–å®‰è£…ç±»å‹ï¼Œ1ä¸ºå®‰è£…ï¼Œ2-9ä¸ºå‡çº§ï¼Œ0ä¸ºå¸è½½
</p>

<p>
for example
</p>

<div class="org-src-container">
<pre class="src src-sh">%pre
<span style="color: #a020f0;">if</span> [ $<span style="color: #a0522d;">1</span> == 1 ]; <span style="color: #a020f0;">then</span>
    /usr/sbin/useradd  -s /bin/false -r  nginx 2&gt;/dev/null || :
<span style="color: #a020f0;">fi</span>
%post
<span style="color: #a020f0;">if</span> [ $<span style="color: #a0522d;">1</span> == 1 ]; <span style="color: #a020f0;">then</span>
    <span style="color: #b22222;">#</span><span style="color: #b22222;">/sbin/chkconfig --add %{name}</span>
    /usr/bin/systemctl daemon-reload
    /usr/bin/systemctl enable %{name}
<span style="color: #a020f0;">fi</span>
%preun
<span style="color: #a020f0;">if</span> [ $<span style="color: #a0522d;">1</span> = 0 ]; <span style="color: #a020f0;">then</span>
    <span style="color: #b22222;">#</span><span style="color: #b22222;">/sbin/service %{name} stop &gt;/dev/null 2&gt;&amp;1</span>
    <span style="color: #b22222;">#</span><span style="color: #b22222;">/sbin/chkconfig --del %{name}</span>
    /usr/bin/systemctl stop %{name}
    /usr/bin/systemctl disable %{name}
<span style="color: #a020f0;">fi</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:93f62913-31a8-4197-b70d-3477fdbcfde5" class="outline-5">
<h5 id="h:93f62913-31a8-4197-b70d-3477fdbcfde5">æ–‡ä»¶æ®µï¼Œåˆ—å‡ºçš„æ–‡ä»¶ %files</h5>
<div class="outline-text-5" id="text-h:93f62913-31a8-4197-b70d-3477fdbcfde5">
<p>
ä»»ä½•åœ¨RPMåŒ…ä¸­çš„æ–‡ä»¶éƒ½éœ€è¦åˆ—å‡ºæ¥ï¼Œä¸”æ–‡ä»¶åœ¨%{buildroot}ä¸‹å¿…é¡»æœ‰
</p>

<ol class="org-ol">
<li><p>
ç›´æ¥æŒ‡å®šå•ä¸ªæ–‡ä»¶
</p>

<div class="org-src-container">
<pre class="src src-sh">%files
/usr/sbin/nginx
/etc/nginx/nginx.conf
</pre>
</div></li>

<li><p>
ä½¿ç”¨glob é€šé…ç¬¦
</p>

<div class="org-src-container">
<pre class="src src-sh">%files
/usr/sbin/nginx
/etc/nginx/nginx.*
</pre>
</div></li>

<li><p>
åŒ…å«ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶
</p>

<div class="org-src-container">
<pre class="src src-sh">%files
/usr/sbin/nginx
/etc/nginx/
</pre>
</div></li>

<li><p>
è®¾å®šæ–‡ä»¶å±æ€§
</p>

<div class="org-src-container">
<pre class="src src-sh">%attr(mode, user, group)              <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25991;&#20214;&#20855;&#26377;&#30340;&#26435;&#38480;&#23646;&#24615;</span>
</pre>
</div>

<p>
ä½¿ç”¨é»˜è®¤çš„ç”¨â€-â€œè¡¨ç¤º %attr(-, root, -) /etc/nginx/nginx.conf
</p>

<p>
å¤šä¸ªæ§åˆ¶æŒ‡ä»¤ä¸€èµ·ç”¨ %config %attr(-,root,-) /etc/nginx/nginx.conf
â€‹æ—¢æ˜¯é…ç½®æ–‡ä»¶åˆæœ‰æ–‡ä»¶å±æ€§
</p>

<div class="org-src-container">
<pre class="src src-sh">%defattr(&#25991;&#20214;&#26435;&#38480;,&#29992;&#25143;&#21517;,&#32452;&#21517;,&#30446;&#24405;&#26435;&#38480;) <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23450;&#20041;&#40664;&#35748;&#26435;&#38480;&#65292;</span>
</pre>
</div>

<p>
ç¤ºä¾‹
</p>
<div class="org-src-container">
<pre class="src src-sh">%files
%defattr(-,root,root,-)
%doc LICENSE CHANGES README
/usr/sbin/nginx
%attr(0755, root, root) %{_unitdir}/%{name}.service
</pre>
</div></li>

<li><p>
æ–‡ä»¶æ§åˆ¶ç¬¦
</p>

<p>
è·¯å¾„åä¸è¦å†™buildrootï¼Œbuildrootè·¯å¾„ä¸‹ä»ä»€ä¹ˆè·¯å¾„å¼€å§‹å†™ä»€ä¹ˆè·¯å¾„ ã€‚
</p>

<div class="org-src-container">
<pre class="src src-sh">%doc: &#25991;&#20214;&#34987;&#24403;&#20570;&#25991;&#26723;&#65292;&#22914;&#26524;&#32473;&#20986;&#32477;&#23545;&#36335;&#24452;&#65292;&#25991;&#20214;&#25918;&#22312;&#35813;&#36335;&#24452;&#19979;&#65307;&#22914;&#26524;&#19981;&#32473;&#32477;&#23545;&#36335;&#24452;&#65292;&#25918;&#22312;/usr/share/doc/%{name}-%{version}&#30446;&#24405;&#19979;
%dir: &#21482;&#35748;&#30446;&#24405;&#65292;&#19981;&#35782;&#21035;&#37324;&#38754;&#30340;&#25991;&#20214;&#65292;
%docdir: &#30446;&#24405;&#20013;&#25152;&#26377;&#20869;&#23481;&#37117;&#20316;&#20026;&#25991;&#26723;
%config(noreplace | missingok): &#25991;&#20214;&#24403;&#20570;&#37197;&#32622;&#25991;&#20214;&#12290;&#21518;&#36319;&#25324;&#21495;&#20013;&#21152;&#21442;&#25968;&#65292;

&#20854;&#20013;&#65306;
%config(missingok) :
&#27492;&#20462;&#39280;&#31526;&#35774;&#23450;&#25991;&#20214;&#31867;&#22411;&#20026;&#37197;&#32622;&#25991;&#20214;,&#19988;&#27492;&#25991;&#20214;&#21487;&#20002;&#22833;&#12290;&#21363;&#20351;&#20002;&#22833;&#20102;,RPM&#22312;&#21368;&#36733;&#36719;&#20214;&#21253;&#26102;&#24182;&#19981;&#35748;&#20026;&#36825;&#26159;&#20010;&#38169;&#35823;,&#24182;&#19981;&#25253;&#38169;&#12290;
%config(noreplace) :
&#27492;&#20462;&#39280;&#31526;&#35774;&#23450;&#25991;&#20214;&#31867;&#22411;&#20026;&#37197;&#32622;&#25991;&#20214;,&#19988;&#22914;&#26524;&#23433;&#35013;&#26102;&#31995;&#32479;&#20013;&#26377;&#21516;&#21517;&#30340;&#25991;&#20214;,&#21017;&#36719;&#20214;&#21253;&#20013;&#30340;&#36825;&#20010;&#25991;&#20214;&#23558;&#25442;&#20010;&#21517;&#23383;&#23433;&#35013;,&#20854;&#25991;&#20214;&#21517;&#21518;&#32512;&#21152;&#20010;.rpmnew&#12290;&#23545;&#24050;&#25913;&#21464;&#30340;&#20869;&#23481;&#19981;&#20570;&#26367;&#25442;&#65292;&#26032;&#30340;&#21483;.rpmnew&#65307;

&#20363;&#65306;
&#22914;&#25551;&#36848;&#25991;&#20214;&#30340;&#25991;&#20214;&#27573;&#20013;&#23450;&#20041;&#20102;&#36825;&#20040;&#19968;&#34892;:
%config(noreplace) /etc/test
&#21017;&#21046;&#25104;&#30340;&#21253;&#22312;&#23433;&#35013;&#26102;,&#33509;&#31995;&#32479;&#20013;&#24050;&#26377;&#27492;&#25991;&#20214;/etc/test,&#21017;RPM&#20250;&#25552;&#31034;:
warning: /etc/test created as /etc/test.rpmnew
</pre>
</div>

<p>
for example
</p>

<div class="org-src-container">
<pre class="src src-sh">%dir /etc/nginx  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21482;&#35748;&#30446;&#24405;&#65292;&#19981;&#35782;&#21035;&#37324;&#38754;&#30340;&#25991;&#20214;&#65292;</span>
%config(noreplace) /etc/nginx/win-utf <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26631;&#26126;&#26159;&#37197;&#32622;&#25991;&#20214;&#65292;&#26377;&#20004;&#20010;&#21442;&#25968;noreplace&#65292;missingok,&#65292;noreplace&#19981;&#26367;&#25442;&#24050;&#25913;&#21464;&#30340;&#25991;&#20214;,&#29983;&#25104;&#30340;&#25991;&#20214;&#19982;&#21407;&#26377;&#30340;&#26377;&#20914;&#31361;&#20102;&#19981;&#26367;&#25442;&#21407;&#25991;&#20214;&#65292;&#29983;&#25104;.rpmnew&#25991;&#20214;,&#26032;&#26087;&#29256;&#26412;&#19981;&#20860;&#23481;&#65292;&#26087;&#25991;&#20214;&#23601;&#19994;.orig</span>
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-h:21eb0f66-bbf0-4c4a-a165-a169bd9a21d7" class="outline-5">
<h5 id="h:21eb0f66-bbf0-4c4a-a165-a169bd9a21d7">changlogæ”¹å˜æ—¥å¿—æ®µ %changelog</h5>
<div class="outline-text-5" id="text-h:21eb0f66-bbf0-4c4a-a165-a169bd9a21d7">
<p>
æ­¤æ®µä¸­ç”¨äºå®šä¹‰å½“å‰specæ–‡ä»¶æ¯ä¸€æ¬¡æ”¹è¿›çš„ä½œè€…åŠæ”¹è¿›çš„ç›¸å…³è¯´æ˜ä¿¡æ¯ã€‚
</p>

<p>
%changelog
</p>

<ul class="org-ul">
<li>date +"%a %b %d %Y" ä¿®æ”¹äºº é‚®ç®± æœ¬æ¬¡ç‰ˆæœ¬x.y.z-p</li>
<li>æœ¬æ¬¡å˜æ›´ä¿®æ”¹äº†é‚£äº›å†…å®¹</li>
</ul>

<p>
for example
</p>

<div class="org-src-container">
<pre class="src src-sh">* Tue Jul 23 2013 Petr Pisar <a href="mailto:ppisar%40redhat.com">&lt;ppisar@redhat.com&gt;</a> - 6.04-2
- Perl 5.18 rebuild

* Thu May 02 2013 Petr Pisar <a href="mailto:ppisar%40redhat.com">&lt;ppisar@redhat.com&gt;</a> - 6.04-1
- 6.04 bump <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26412;&#27425;&#21464;&#26356;&#20462;&#25913;&#20102;&#37027;&#20123;&#20869;&#23481;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a118878a-0abc-4706-b96a-f9234488bb64" class="outline-5">
<h5 id="h:a118878a-0abc-4706-b96a-f9234488bb64">å¦‚ä½•åœ¨specæ–‡ä»¶ä¸­ä½¿ç”¨å®</h5>
<div class="outline-text-5" id="text-h:a118878a-0abc-4706-b96a-f9234488bb64">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#23450;&#20041;&#23439;</span>
%define nginx_user       nginx
%define nginx_group      %{nginx_user}
%define nginx_confdir    /etc/nginx

... ...

%build
<span style="color: #483d8b;">export</span> <span style="color: #a0522d;">DESTDIR</span>=%{buildroot}
./configure <span style="color: #8b2252;">\</span>
  --sbin-path=/usr/sbin/nginx <span style="color: #8b2252;">\</span>
  --conf-path=/etc/nginx/nginx.conf <span style="color: #8b2252;">\</span>
  --error-log-path=/var/log/nginx/error.log <span style="color: #8b2252;">\</span>
  --http-log-path=/var/log/nginx/access.log <span style="color: #8b2252;">\</span>
  --pid-path=/var/run/nginx/nginx.pid  <span style="color: #8b2252;">\</span>
  --lock-path=/var/lock/nginx.lock <span style="color: #8b2252;">\</span>
  --user=%{nginx_user} <span style="color: #8b2252;">\</span>
  --group=%{nginx_group} <span style="color: #8b2252;">\</span>
  --with-http_ssl_module <span style="color: #8b2252;">\</span>
  --with-http_flv_module <span style="color: #8b2252;">\</span>
  --with-http_stub_status_module <span style="color: #8b2252;">\</span>
  --with-http_gzip_static_module <span style="color: #8b2252;">\</span>
  --with-pcre
make %{?_smp_mflags}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:9aea5127-5c75-4cc8-93ae-7d4ea62ba8c5" class="outline-4">
<h4 id="h:9aea5127-5c75-4cc8-93ae-7d4ea62ba8c5">RPMåŒ…ç­¾å</h4>
<div class="outline-text-4" id="text-h:9aea5127-5c75-4cc8-93ae-7d4ea62ba8c5">
<p>
éªŒè¯ rpm çš„ md5ç 
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm -K &#21253;&#21517;
</pre>
</div>

<p>
é¦–å…ˆè¯´ä¸‹ PGPï¼Œå®ƒèƒ½å®ç°ç­¾åã€åŠ å¯†å’Œè§£å¯†ï¼Œæ˜¯ä¸ªå•†ä¸šäº§å“ã€‚ åæ¥æœ‰äº†å®ç°è§„
èŒƒRFC 4880 è§„èŒƒï¼Œæ‰æœ‰äº† GnuPGï¼Œç®€ç§°GPG. rpmåŒ…ç­¾åä½¿ç”¨çš„æ˜¯gpgå‘½ä»¤
</p>

<ol class="org-ol">
<li><p>
gpg &#x2013;gen-key ç”ŸæˆGPGç­¾åå¯†é’¥ æˆ‘ç”¨çš„æ˜¯rootç”¨æˆ·
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@node01 ~]$ gpg --gen-key
Your selection?1&lt;Enter&gt;                       <span style="color: #b22222;">##</span><span style="color: #b22222;">&#40664;&#35748;&#21363;&#21487;</span>
What keysize<span style="color: #a020f0;"> do</span> you want? (2048) 1024&lt;Enter&gt;  <span style="color: #b22222;">##</span><span style="color: #b22222;">&#23494;&#38053;&#38271;&#24230;&#65292;&#26377;&#26102;&#21487;&#33021;&#22240;&#20026;&#38543;&#26426;&#25968;&#19981;&#22815;&#23548;&#33268;&#21345;&#22312;&#37027;&#37324;&#65292;&#36825;&#26102;&#20505;&#20320;&#23601;yum &#23433;&#35013;&#20960;&#20010;&#21253;&#32452;&#65292;&#39532;&#19978;&#23601;&#22815;&#20102;</span>
Key is valid for? (0) 1y&lt;Enter&gt;               <span style="color: #b22222;">##</span><span style="color: #b22222;">&#26377;&#25928;&#26399; 0&#20026;&#27704;&#20037;&#26377;&#25928;</span>
Is this correct? (y/N) y&lt;Enter&gt;               <span style="color: #b22222;">##</span><span style="color: #b22222;">&#30830;&#35748;</span>
Real name: Jasper Hsu&lt;Enter&gt;                  <span style="color: #b22222;">##</span><span style="color: #b22222;">&#23494;&#38053;&#21517;&#31216;&#65292;5&#20010;&#23383;&#31526;&#20197;&#19978;</span>
Email address:xcwhome@gmail.com&lt;Enter&gt;        <span style="color: #b22222;">##</span><span style="color: #b22222;">&#37038;&#20214;</span>
Comment: GPG-RPM-KEY&lt;Enter&gt;                   <span style="color: #b22222;">##</span><span style="color: #b22222;">&#22791;&#27880;</span>

You selected this USER-ID:
<span style="color: #8b2252;">"Jasper Hsu <a href="mailto:xcwhome%40gmail.com">&lt;xcwhome@gmail.com&gt;</a>"</span>
<span style="color: #0000ff;">Change</span> (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O&lt;ENTER&gt;   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36825;&#37324;&#19968;&#23450;&#36319; .rpmmacros &#20013; %_gpg_name &#20540;&#20445;&#25345;&#19968;&#33268;</span>
Enter passphrase  OK &lt;Enter&gt;     <span style="color: #b22222;">##</span><span style="color: #b22222;">&#20351;&#29992;&#31354;&#23494;&#30721;&#65292;&#20063;&#21487;&#20197;&#36755;&#20837;                             </span>
&lt;Take this one anyway&gt; &lt;Enter&gt;
&lt;Take this one anyway&gt; &lt;Enter&gt;
</pre>
</div>

<p>
æœ€åè¿™ä¸ªç•Œé¢æ¯”è¾ƒæç¬‘ï¼Œè®©ä½ éšæ„ç§»åŠ¨é¼ æ ‡ï¼Œæ•²å‡»é”®ç›˜ï¼Œæ”¶é›†è¶³å¤Ÿçš„éšæœºå­—
ç¬¦ï¼Œäº§ç”Ÿå¯†é’¥ã€‚
</p></li>

<li><p>
gpg &#x2013;list-keys æŸ¥çœ‹æˆç”Ÿçš„å¯†é’¥
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@node01 ~]# gpg --list-keys
/root/.gnupg/pubring.gpg
------------------------
pub   1024R/682F2811 2018-05-24
uid                  Jasper Hsu <a href="mailto:xcwhome%40gmail.com">&lt;xcwhome@gmail.com&gt;</a>
sub   1024R/DDF7F2D6 2018-05-24
</pre>
</div></li>

<li><p>
gpg &#x2013;export -a "Jasper Hsu" &gt; RPM-GPG-KEY-NAME
æŠŠå¯†é’¥ä¸­çš„å…¬é’¥æå–å‡ºæ¥ï¼Œä»¥ä¾›å¤§å®¶ä½¿ç”¨éªŒè¯ã€‚
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@node01 ~]# gpg --export -a <span style="color: #8b2252;">'Jasper Hsu'</span> &gt;RPM-GPG-KEY-Jasper
</pre>
</div>

<p>
-a : ä»¥ assiiç æ–¹å¼å¯¼å‡º æ–‡ä»¶åç§°å¯ä»¥éšæ„å–
</p></li>

<li><p>
ç¼–ç¼‰
.rpmmacrosè¯´æ˜æˆ‘ä»¬ç”¨å“ªä¸€ä¸ªå¯†é’¥åŠ å¯†,æˆ‘ä»¬ç”¨rootåŠ å¯†çš„é‚£å°±åœ¨/rootä¸‹ç¼–è¾‘
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@node01 ~]# cat ~/.rpmmacros
%_signature gpg
%_gpg_name Jasper Hsu
</pre>
</div></li>

<li><p>
rpm &#x2013;addsign tengine-1.4.2-1.el6.x86_64.rpm ä¸ºrpmåŒ…åŠ ç­¾å
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@node01 ~]# rpm --addsign /home/jasper/rpmbuild/RPMS/x86_64/nginx-1.13.12-2.el7.centos.x86_64.rpm
Enter pass phrase:   <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36755;&#20837;&#23494;&#30721;</span>
Pass phrase is good.
/home/jasper/rpmbuild/RPMS/x86_64/nginx-1.13.12-2.el7.centos.x86_64.rpm:
</pre>
</div>

<p>
åˆ°æ­¤ç­¾åæ·»åŠ æˆåŠŸï¼Œä¸‹é¢æ¥éªŒè¯
</p>

<p>
å¦‚æŠ¥é”™: rpm: /usr/bin/rpmsign: No such file or directory
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@node01 ~]# yum install rpm-sign


<span style="color: #b22222;"># </span><span style="color: #b22222;">&#37325;&#31614;</span>
rpm --resign &#21253;&#21517;
</pre>
</div></li>

<li><p>
å°†åˆšæ‰å¯¼å‡ºçš„å…¬é’¥å¯¼å…¥rpmä¸­
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@node01 ~]# cp RPM-GPG-KEY-Jasper  /tmp/
[root@node01 ~]# cp /home/jasper/rpmbuild/RPMS/x86_64/nginx-1.13.12-2.el7.centos.x86_64.rpm  /tmp/

[root@node01 ~]# rpm --import /tmp/RPM-GPG-KEY-Jasper
</pre>
</div></li>
</ol>


<ol class="org-ol">
<li><p>
éªŒè¯
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm --checksig tengine-1.4.2-1.el6.x86_64.rpm 

[root@node01 ~]# rpm -K /tmp/nginx-1.13.12-2.el7.centos.x86_64.rpm
/tmp/nginx-1.13.12-2.el7.centos.x86_64.rpm: RSA sha1 ((MD5) PGP) md5 NOT OK (MISSING KEYS: (MD5) PGP#036049ba)

[root@node01 ~]# rpm -qpi /tmp/nginx-1.13.12-2.el7.centos.x86_64.rpm
warning: /tmp/nginx-1.13.12-2.el7.centos.x86_64.rpm: Header V4 RSA/SHA1 Signature, key ID 036049ba: NOKEY
Name        : nginx
Signature   : RSA/SHA1, Thu 24 May 2018 08:51:10 PM CST, Key ID 2573f8ee036049ba
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-h:0a27839a-f3b4-42b2-8a3a-dc002bddcd71" class="outline-4">
<h4 id="h:0a27839a-f3b4-42b2-8a3a-dc002bddcd71">RPMæ‹†åŒ…</h4>
<div class="outline-text-4" id="text-h:0a27839a-f3b4-42b2-8a3a-dc002bddcd71">
<p>
åœ¨åŸspec æ–‡ä»¶åŠ å…¥å®šä¹‰å­åŒ…çš„ä¿¡æ¯
</p>

<div class="org-src-container">
<pre class="src src-sh">%package       libs    <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23450;&#20041;libs&#23376;&#21253;   </span>
Summary:        XXXX
Group:            Development/Libraries 
Requires:        %{name}  = %{version}  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23433;&#35013;&#26102;&#20381;&#36182;&#20027;&#21253;</span>
%description   libs    <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23450;&#20041;&#25551;&#36848;&#20449;&#24687;</span>
sljfljl 

%pres libs     <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23376;&#21253;&#30340;&#33050;&#26412;</span>
....

%files  libs     
</pre>
</div>
</div>
<div id="outline-container-h:eb9ce5f0-b998-4060-84f3-0c421a94d2f7" class="outline-5">
<h5 id="h:eb9ce5f0-b998-4060-84f3-0c421a94d2f7">å¿…é€‰åŠŸèƒ½æ®µ</h5>
<div class="outline-text-5" id="text-h:eb9ce5f0-b998-4060-84f3-0c421a94d2f7">
</div>
<ul class="org-ul">
<li><a id="h:8d2208a3-5ec4-49f2-9c3c-5c8c59a8ce7f"></a>%description<br>
<div class="outline-text-6" id="text-h:8d2208a3-5ec4-49f2-9c3c-5c8c59a8ce7f">
<p>
æœ¬æ®µæ˜¯æè¿°æ®µ,æ®µçš„å†…å®¹æ˜¯å¯¹è½¯ä»¶åŒ…è¿›è¡Œè¾ƒä¸ºè¯¦ç»†çš„ä»‹ç»,ä¸åƒæ–‡ä»¶å¤´çš„Summary
åŸŸä»…ç”¨ä¸€å¥è¯è¯´æ˜ã€‚
</p>

<p>
æ­¤åŸŸæè¿°æ ¼å¼æœ‰ä¸‰ç§:
</p>

<p>
1.%description [å­åŒ…é€‰é¡¹]
</p>

<p>
æœ¬åŠŸèƒ½æ®µæè¿°çš„å†…å®¹æ˜¯å…³äºçˆ¶åŒ…çš„ã€‚å®ƒç”¨è½¯ä»¶åæ¥å‘½ä»¤,å…¶åå­—æ ¼å¼æ˜¯ï¼šè½¯ä»¶å-
ç‰ˆæœ¬å·-å‘å¸ƒåºåˆ—å·.ä½“ç³».rpm
</p>

<p>
ä¾‹ï¼štest-1.0-1.i386.rpm
</p>

<p>
2.%description [å­åŒ…é€‰é¡¹]
</p>

<p>
å­åŒ…é€‰é¡¹ä¸­æ²¡æœ‰-né€‰é¡¹æ—¶,å­åŒ…æ˜¯ç”¨è½¯ä»¶å
åŠ å­åŒ…åçš„å½¢å¼å‘½åã€‚
</p>

<p>
æ ¼å¼ä¸º: è½¯ä»¶å-å­åŒ…å-ç‰ˆæœ¬å·-å‘å¸ƒåºåˆ—å·.ä½“ç³».rpm
</p>

<p>
ä¾‹ï¼šåˆ†æˆä¸¤ä¸ªå­åŒ…çš„testè½¯ä»¶: test-bin-1.0-1.i386.rpm(æ‰§è¡Œç¨‹åºåŒ…)
test-config-1.0-1.i386.rpm(é…ç½®æ–‡ä»¶åŒ…)
</p>

<p>
3.%description -n å­åŒ…å
</p>

<p>
æœ¬åŠŸèƒ½æ®µæè¿°çš„å†…å®¹ä¹Ÿæ˜¯å…³äºå­åŒ…çš„ã€‚å½“å­åŒ…é€‰é¡¹ä¸­æœ‰-né€‰é¡¹æ—¶,å­åŒ…ç›´æ¥é‡‡ç”¨å­åŒ…åçš„å½¢å¼å‘½åã€‚
</p>

<p>
å®ƒä¸åŒ…å«è½¯ä»¶å,å‘½åæ ¼å¼ä¸º: å­åŒ…å-ç‰ˆæœ¬å·-å‘å¸ƒåºåˆ—å·.ä½“ç³».rpm
</p>

<p>
ä¾‹ï¼š:åˆ†æˆä¸¤ä¸ªå­åŒ…çš„testè½¯ä»¶: bin-1.0-1.i386.rpm(æ‰§è¡Œç¨‹åºåŒ…)
config-1.0-1.i386.rpm(é…ç½®æ–‡ä»¶åŒ…)
</p>

<p>
å¿…é€‰åŠŸèƒ½æ®µ
</p>
</div>
</li>
<li><a id="h:c598509f-54d8-4cef-802d-5e245af8b161"></a>%files<br>
<div class="outline-text-6" id="text-h:c598509f-54d8-4cef-802d-5e245af8b161">
<p>
æœ¬æ®µæ˜¯æ–‡ä»¶æ®µ,å®ƒå®šä¹‰çš„æ˜¯è½¯ä»¶åŒ…éœ€è¦åŒ…å«å“ªäº›æ–‡ä»¶ã€‚
</p>

<p>
æœ¬æ®µæ®µåæè¿°æ ¼å¼æ ¼å¼ä¸º:
%files [å­åŒ…é€‰é¡¹] [-f æ–‡ä»¶å]
</p>

<p>
å½“æ²¡æœ‰ä»»ä½•é€‰é¡¹æ—¶,æœ¬æ®µå†…å®¹å®šä¹‰çš„æ˜¯çˆ¶åŒ…è¦æ‰“åŒ…çš„æ–‡ä»¶åˆ—è¡¨;
</p>

<p>
å½“æœ‰å­åŒ…é€‰é¡¹æ—¶,æœ¬æ®µå†…å®¹å®šä¹‰çš„åˆ™æ˜¯å­åŒ…è¦æ‰“åŒ…çš„æ–‡ä»¶åˆ—è¡¨;
</p>

<p>
æ–‡ä»¶æ®µçš„å†…å®¹æ ¼å¼ä¸º: [ä¿®é¥°ç¬¦1 [ä¿®é¥°ç¬¦2] &#x2026;] æ–‡ä»¶å
</p>

<p>
å…¶ä¸­:ä¿®é¥°ç¬¦æ˜¯å¯é€‰çš„,ä¸€ä¸ªæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªä¿®é¥°ç¬¦,æ–‡ä»¶åå¿…é¡»ä»¥/å¼€å¤´(ç»å¯¹è·¯å¾„å½¢å¼)
</p>

<p>
å­è½¯ä»¶åŒ…
</p>

<p>
ä¸€ä¸ªRPMçš„è½¯ä»¶åŒ…æè¿°æ–‡ä»¶,å¯ä»¥ä»…ç”Ÿæˆä¸€ä¸ªçˆ¶åŒ…æˆ–ä¸€ä¸ªå­åŒ…,ä¹Ÿå¯ä»¥ç”Ÿæˆä¸€ä¸ªçˆ¶
åŒ…å’Œå¤šä¸ªå­åŒ…ã€‚é€šè¿‡è®¾å®šå­åŒ…é€‰é¡¹,å¯ä»¥ä½¿ç”Ÿæˆçš„å­åŒ…é‡‡ç”¨â€è½¯ä»¶å-å­åŒ…åâ€çš„
æ ‡å‡†å‘½å,ä¹Ÿå¯ä½¿ç”Ÿæˆçš„å­åŒ…é‡‡ç”¨è‡ªå·±çš„åå­—ã€‚
</p>

<p>
è¦æƒ³åˆ›å»ºå­è½¯ä»¶åŒ…,å¿…é¡»æè¿°%packageã€Summaryã€Groupã€%descriptionã€%filesã€‚
ä»¥ä¸Šå‡ ç§å†…å®¹å‰é¢å·²ç»ä»‹ç»ï¼Œæ­¤å¤„å°±ä¸å†èµ˜è¿°ã€‚ æ³¨:æ›´å¤šç”¨æ³•è¯·æŸ¥çœ‹æ•™æSPECè¯¦è§£
</p>

<p>
å¦‚ï¼Œ
</p>


<figure id="orgba07396">
<img src="images/image-20210216015743732.png" alt="image-20210216015743732.png" width="60%">

</figure>

<p>
ç»éªŒä¹‹è°ˆ
</p>
<ol class="org-ol">
<li><p>
ç¼–è¯‘å®Œæˆåä¸æ£€æŸ¥ä¾èµ–
</p>

<p>
AutoReqProv: no
</p></li>

<li><p>
ä¸ç”Ÿæˆdebuginfo
</p>

<p>
%define debug_package %{nil}
</p></li>
<li><p>
åˆ é™¤rpmè½¯ä»¶å,ç›®å½•å¦‚ä½•é”€æ¯
</p>

<p>
åœ¨%fileæ®µè½å†…çš„æ–‡ä»¶,åœ¨åˆ é™¤è½¯ä»¶å,éƒ½ä¼šè‡ªåŠ¨é”€æ¯.
</p>

<p>
å¦‚æœåœ¨%postæ®µè½åˆ›å»ºæ–‡ä»¶,åˆ™éœ€è¦åœ¨%postunæ®µè½,å•ç‹¬æ‰§è¡Œåˆ é™¤å‘½ä»¤
</p></li>

<li><p>
æ‰‹åŠ¨è§£å‹
</p>

<p>
åœ¨%prepæ®µè½,å¦‚æœ%setupå‡½æ•°çš„è§£å‹æ•ˆæœä¸èƒ½æ»¡è¶³éœ€æ±‚,å¯æ‰‹åŠ¨æ‰§è¡Œtar zxvf
æˆ–è€…gunzipå‘½ä»¤è§£å‹
</p></li>
</ol>


<div class="org-src-container">
<pre class="src src-sh">[root@node01 openvswitch-2.5.9]# cat rhel/openvswitch-fedora.spec
<span style="color: #b22222;"># </span><span style="color: #b22222;">rpmbuild -bb --without check rhel/openvswitch-fedora.spec</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">%define kernel 2.6.40.4-5.fc15.x86_64</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">If libcap-ng isn't available and there is no need for running OVS</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">as regular user, specify the '--without libcapng'</span>
%bcond_without libcapng
<span style="color: #b22222;"># </span><span style="color: #b22222;">To enable DPDK support, specify '--with dpdk' when building</span>
%bcond_with dpdk

<span style="color: #b22222;"># </span><span style="color: #b22222;">Enable PIE, bz#955181</span>
%global _hardened_build 1

<span style="color: #b22222;"># </span><span style="color: #b22222;">some distros (e.g: RHEL-7) don't define _rundir macro yet</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">Fedora 15 onwards uses /run as _rundir</span>
%if 0%{!?_rundir:1}
%define _rundir /run
%endif

Name: openvswitch
Summary: Open vSwitch
Group: System Environment/Daemons
URL: http://www.openvswitch.org/
Version: 2.5.9

<span style="color: #b22222;"># </span><span style="color: #b22222;">Nearly all of openvswitch is ASL 2.0.  The bugtool is LGPLv2+, and the</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">lib/sflow*.[ch] files are SISSL</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">datapath/ is GPLv2 (although not built into any of the binary packages)</span>
License: ASL 2.0 and LGPLv2+ and SISSL
Release: 1%{?dist}
Source: http://openvswitch.org/releases/%{name}-%{version}.tar.gz

BuildRequires: autoconf automake libtool
BuildRequires: systemd-units openssl openssl-devel
BuildRequires: python python-twisted-core python-zope-interface PyQt4
BuildRequires: desktop-file-utils
BuildRequires: groff graphviz
BuildRequires: checkpolicy, selinux-policy-devel
<span style="color: #b22222;"># </span><span style="color: #b22222;">make check dependencies</span>
BuildRequires: procps-ng
%if %{with libcapng}
BuildRequires: libcap-ng libcap-ng-devel
%endif
%if %{with dpdk}
BuildRequires: dpdk-devel &gt;= 2.2.0
Provides: %{name}-dpdk = %{version}-%{release}
%endif

Requires: openssl iproute module-init-tools
<span style="color: #b22222;">#</span><span style="color: #b22222;">Upstream kernel commit 4f647e0a3c37b8d5086214128614a136064110c3</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">Requires: kernel &gt;= 3.15.0-0</span>

<span style="color: #0000ff;">Requires</span>(post): systemd-units
<span style="color: #0000ff;">Requires</span>(preun): systemd-units
<span style="color: #0000ff;">Requires</span>(postun): systemd-units
Obsoletes: openvswitch-controller &lt;= 0:2.1.0-1

%bcond_without check

%description
Open vSwitch provides standard network bridging functions and
support for the OpenFlow protocol for remote per-flow control of
traffic.

%package selinux-policy
Summary: Open vSwitch SELinux policy
License: ASL 2.0
BuildArch: noarch
Requires: selinux-policy-targeted

%description selinux-policy
Tailored Open vSwitch SELinux policy

%package -n python-openvswitch
Summary: Open vSwitch python bindings
License: ASL 2.0
BuildArch: noarch
Requires: python

%description -n python-openvswitch
Python bindings for the Open vSwitch database

%package test
Summary: Open vSwitch testing utilities
License: ASL 2.0
BuildArch: noarch
Requires: python-openvswitch = %{version}-%{release}
Requires: python python-twisted-core python-twisted-web

%description test
Utilities that are useful to diagnose performance and connectivity
issues<span style="color: #a020f0;"> in</span> Open vSwitch setup.

%package devel
Summary: Open vSwitch OpenFlow development package (library, headers)
License: ASL 2.0
Provides: openvswitch-static = %{version}-%{release}

%description devel
This provides static library, libopenswitch.a and the openvswitch header
files needed to build an external application.

%package ovn
Summary: Open vSwitch - Open Virtual Network support
License: ASL 2.0
Requires: openvswitch

%description ovn
OVN, the Open Virtual Network, is a system to support virtual network
abstraction.  OVN complements the existing capabilities of OVS to add
native support for virtual network abstractions, such as virtual L2 and L3
overlays and security groups.


%prep
%setup -q

%build
%configure <span style="color: #8b2252;">\</span>
%if %{with libcapng}
    --enable-libcapng <span style="color: #8b2252;">\</span>
%else
    --disable-libcapng <span style="color: #8b2252;">\</span>
%endif
%if %{with dpdk}
    --with-dpdk=$(dirname %{_datadir}/dpdk/*/.config) <span style="color: #8b2252;">\</span>
%endif
    --enable-ssl <span style="color: #8b2252;">\</span>
    --with-pkidir=%{_sharedstatedir}/openvswitch/pki

make %{?_smp_mflags}
<span style="color: #483d8b;">cd</span> selinux
make -f %{_datadir}/selinux/devel/Makefile

%install
rm -rf $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>
make install <span style="color: #a0522d;">DESTDIR</span>=$<span style="color: #a0522d;">RPM_BUILD_ROOT</span>

install -d -m 0755 $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_sysconfdir}/openvswitch

install -p -D -m 0644 <span style="color: #8b2252;">\</span>
        rhel/usr_share_openvswitch_scripts_systemd_sysconfig.template <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>/%{_sysconfdir}/sysconfig/openvswitch
<span style="color: #a020f0;">for</span> service<span style="color: #a020f0;"> in</span> openvswitch ovsdb-server ovs-vswitchd <span style="color: #8b2252;">\</span>
        ovn-controller ovn-controller-vtep ovn-northd; <span style="color: #a020f0;">do</span>
    install -p -D -m 0644 <span style="color: #8b2252;">\</span>
            rhel/usr_lib_systemd_system_${<span style="color: #a0522d;">service</span>}.service <span style="color: #8b2252;">\</span>
            $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_unitdir}/${<span style="color: #a0522d;">service</span>}.service
<span style="color: #a020f0;">done</span>
install -m 0755 rhel/etc_init.d_openvswitch <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_datadir}/openvswitch/scripts/openvswitch.init

install -p -D -m 0644 rhel/etc_logrotate.d_openvswitch <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>/%{_sysconfdir}/logrotate.d/openvswitch

install -m 0644 vswitchd/vswitch.ovsschema <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>/%{_datadir}/openvswitch/vswitch.ovsschema

install -d -m 0755 $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>/%{_sysconfdir}/sysconfig/network-scripts/
install -p -m 0755 rhel/etc_sysconfig_network-scripts_ifdown-ovs <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>/%{_sysconfdir}/sysconfig/network-scripts/ifdown-ovs
install -p -m 0755 rhel/etc_sysconfig_network-scripts_ifup-ovs <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>/%{_sysconfdir}/sysconfig/network-scripts/ifup-ovs

install -d -m 0755 $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{python_sitelib}
mv $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>/%{_datadir}/openvswitch/python/* <span style="color: #8b2252;">\</span>
   $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{python_sitelib}
rmdir $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>/%{_datadir}/openvswitch/python/

install -d -m 0755 $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>/%{_sharedstatedir}/openvswitch

touch $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_sysconfdir}/openvswitch/conf.db
touch $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_sysconfdir}/openvswitch/system-id.conf

install -p -m 644 -D selinux/openvswitch-custom.pp <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_datadir}/selinux/packages/%{name}/openvswitch-custom.pp

<span style="color: #b22222;"># </span><span style="color: #b22222;">remove unpackaged files</span>
rm -f $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_bindir}/ovs-benchmark <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_bindir}/ovs-parse-backtrace <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_bindir}/ovs-pcap <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_bindir}/ovs-tcpundump <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_sbindir}/ovs-vlan-bug-workaround <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_mandir}/man1/ovs-benchmark.1 <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_mandir}/man1/ovs-pcap.1 <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_mandir}/man1/ovs-tcpundump.1 <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_mandir}/man8/ovs-vlan-bug-workaround.8 <span style="color: #8b2252;">\</span>
        $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>%{_datadir}/openvswitch/scripts/ovs-save

%check
%if %{with check}
    <span style="color: #a020f0;">if</span> make check <span style="color: #a0522d;">TESTSUITEFLAGS</span>=<span style="color: #8b2252;">'%{_smp_mflags}'</span> <span style="color: #a0522d;">RECHECK</span>=yes; <span style="color: #a020f0;">then</span> :;
    <span style="color: #a020f0;">else</span>
        cat tests/testsuite.log
        <span style="color: #a020f0;">exit</span> 1
    <span style="color: #a020f0;">fi</span>
%endif

%clean
rm -rf $<span style="color: #a0522d;">RPM_BUILD_ROOT</span>

%preun
%if 0%{?systemd_preun:1}
    %systemd_preun %{name}.service
%else
    <span style="color: #a020f0;">if</span> [ $<span style="color: #a0522d;">1</span> -eq 0 ] ; <span style="color: #a020f0;">then</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">Package removal, not upgrade</span>
        /bin/systemctl --no-reload disable %{name}.service &gt;/dev/null 2&gt;&amp;1 || :
        /bin/systemctl stop %{name}.service &gt;/dev/null 2&gt;&amp;1 || :
    <span style="color: #a020f0;">fi</span>
%endif

%preun ovn
%if 0%{?systemd_preun:1}
    %systemd_preun ovn-controller.service
    %systemd_preun ovn-controller-vtep.service
    %systemd_preun ovn-northd.service
%else
    <span style="color: #a020f0;">if</span> [ $<span style="color: #a0522d;">1</span> -eq 0 ] ; <span style="color: #a020f0;">then</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">Package removal, not upgrade</span>
        /bin/systemctl --no-reload disable ovn-controller.service &gt;/dev/null 2&gt;&amp;1 || :
        /bin/systemctl stop ovn-controller.service &gt;/dev/null 2&gt;&amp;1 || :
        /bin/systemctl --no-reload disable ovn-controller-vtep.service &gt;/dev/null 2&gt;&amp;1 || :
        /bin/systemctl stop ovn-controller-vtep.service &gt;/dev/null 2&gt;&amp;1 || :
        /bin/systemctl --no-reload disable ovn-northd.service &gt;/dev/null 2&gt;&amp;1 || :
        /bin/systemctl stop ovn-northd.service &gt;/dev/null 2&gt;&amp;1 || :
    <span style="color: #a020f0;">fi</span>
%endif

%post
%if 0%{?systemd_post:1}
    %systemd_post %{name}.service
%else
    <span style="color: #b22222;"># </span><span style="color: #b22222;">Package install, not upgrade</span>
    <span style="color: #a020f0;">if</span> [ $<span style="color: #a0522d;">1</span> -eq 1 ]; <span style="color: #a020f0;">then</span>
        /bin/systemctl daemon-reload &gt;dev/null || :
    <span style="color: #a020f0;">fi</span>
%endif

%post ovn
%if 0%{?systemd_post:1}
    %systemd_post ovn-controller.service
    %systemd_post ovn-controller-vtep.service
    %systemd_post ovn-northd.service
%else
    <span style="color: #b22222;"># </span><span style="color: #b22222;">Package install, not upgrade</span>
    <span style="color: #a020f0;">if</span> [ $<span style="color: #a0522d;">1</span> -eq 1 ]; <span style="color: #a020f0;">then</span>
        /bin/systemctl daemon-reload &gt;dev/null || :
    <span style="color: #a020f0;">fi</span>
%endif

%post selinux-policy
/usr/sbin/semodule -i %{_datadir}/selinux/packages/%{name}/openvswitch-custom.pp &amp;&gt; /dev/null || :

%postun
%if 0%{?systemd_postun:1}
    %systemd_postun %{name}.service
%else
    /bin/systemctl daemon-reload &gt;/dev/null 2&gt;&amp;1 || :
%endif

%postun ovn
%if 0%{?systemd_postun_with_restart:1}
    %systemd_postun_with_restart ovn-controller.service
    %systemd_postun_with_restart ovn-controller-vtep.service
    %systemd_postun_with_restart ovn-northd.service
%else
    /bin/systemctl daemon-reload &gt;/dev/null 2&gt;&amp;1 || :
    <span style="color: #a020f0;">if</span> [ <span style="color: #8b2252;">"$1"</span> -ge <span style="color: #8b2252;">"1"</span> ] ; <span style="color: #a020f0;">then</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">Package upgrade, not uninstall</span>
        /bin/systemctl try-restart ovn-controller.service &gt;/dev/null 2&gt;&amp;1 || :
        /bin/systemctl try-restart ovn-controller-vtep.service &gt;/dev/null 2&gt;&amp;1 || :
        /bin/systemctl try-restart ovn-northd.service &gt;/dev/null 2&gt;&amp;1 || :
    <span style="color: #a020f0;">fi</span>
%endif

%postun selinux-policy
<span style="color: #a020f0;">if</span> [ $<span style="color: #a0522d;">1</span> -eq 0 ] ; <span style="color: #a020f0;">then</span>
  /usr/sbin/semodule -r openvswitch-custom &amp;&gt; /dev/null || :
<span style="color: #a020f0;">fi</span>

%files selinux-policy
%defattr(-,root,root)
%{_datadir}/selinux/packages/%{name}/openvswitch-custom.pp

%files -n python-openvswitch
%{python_sitelib}/ovs
%doc COPYING

%files test
%{_bindir}/ovs-test
%{_bindir}/ovs-vlan-test
%{_bindir}/ovs-l3ping
%{_mandir}/man8/ovs-test.8*
%{_mandir}/man8/ovs-vlan-test.8*
%{_mandir}/man8/ovs-l3ping.8*
%{python_sitelib}/ovstest

%files devel
%{_libdir}/*.a
%{_libdir}/*.la
%{_libdir}/pkgconfig/*.pc
%{_includedir}/openvswitch/*
%{_includedir}/openflow/*

%files
%defattr(-,root,root)
%{_sysconfdir}/bash_completion.d/ovs-appctl-bashcomp.bash
%{_sysconfdir}/bash_completion.d/ovs-vsctl-bashcomp.bash
%dir %{_sysconfdir}/openvswitch
%config %ghost %{_sysconfdir}/openvswitch/conf.db
%config %ghost %{_sysconfdir}/openvswitch/system-id.conf
%config(noreplace) %{_sysconfdir}/sysconfig/openvswitch
%config(noreplace) %{_sysconfdir}/logrotate.d/openvswitch
%{_unitdir}/openvswitch.service
%{_unitdir}/ovsdb-server.service
%{_unitdir}/ovs-vswitchd.service
%{_datadir}/openvswitch/scripts/openvswitch.init
%{_sysconfdir}/sysconfig/network-scripts/ifup-ovs
%{_sysconfdir}/sysconfig/network-scripts/ifdown-ovs
%{_datadir}/openvswitch/bugtool-plugins/
%{_datadir}/openvswitch/scripts/ovs-bugtool-*
%{_datadir}/openvswitch/scripts/ovs-check-dead-ifs
%{_datadir}/openvswitch/scripts/ovs-lib
%{_datadir}/openvswitch/scripts/ovs-vtep
%{_datadir}/openvswitch/scripts/ovs-ctl
%config %{_datadir}/openvswitch/vswitch.ovsschema
%config %{_datadir}/openvswitch/vtep.ovsschema
%{_bindir}/ovs-appctl
%{_bindir}/ovs-docker
%{_bindir}/ovs-dpctl
%{_bindir}/ovs-dpctl-top
%{_bindir}/ovs-ofctl
%{_bindir}/ovs-vsctl
%{_bindir}/ovsdb-client
%{_bindir}/ovsdb-tool
%{_bindir}/ovs-testcontroller
%{_bindir}/ovs-pki
%{_bindir}/vtep-ctl
%{_sbindir}/ovs-bugtool
%{_sbindir}/ovs-vswitchd
%{_sbindir}/ovsdb-server
%{_mandir}/man1/ovsdb-client.1*
%{_mandir}/man1/ovsdb-server.1*
%{_mandir}/man1/ovsdb-tool.1*
%{_mandir}/man5/ovs-vswitchd.conf.db.5*
%{_mandir}/man5/vtep.5*
%{_mandir}/man8/vtep-ctl.8*
%{_mandir}/man8/ovs-appctl.8*
%{_mandir}/man8/ovs-bugtool.8*
%{_mandir}/man8/ovs-ctl.8*
%{_mandir}/man8/ovs-dpctl.8*
%{_mandir}/man8/ovs-dpctl-top.8*
%{_mandir}/man8/ovs-ofctl.8*
%{_mandir}/man8/ovs-pki.8*
%{_mandir}/man8/ovs-vsctl.8*
%{_mandir}/man8/ovs-vswitchd.8*
%{_mandir}/man8/ovs-parse-backtrace.8*
%{_mandir}/man8/ovs-testcontroller.8*
%doc COPYING DESIGN.md INSTALL.SSL.md NOTICE README.md WHY-OVS.md
%doc FAQ.md NEWS INSTALL.DPDK.md rhel/README.RHEL
/var/lib/openvswitch
/var/log/openvswitch
%ghost %attr(755,root,root) %{_rundir}/openvswitch

%files ovn
%{_bindir}/ovn-controller
%{_bindir}/ovn-controller-vtep
%{_bindir}/ovn-docker-overlay-driver
%{_bindir}/ovn-docker-underlay-driver
%{_bindir}/ovn-nbctl
%{_bindir}/ovn-northd
%{_bindir}/ovn-sbctl
%{_datadir}/openvswitch/scripts/ovn-ctl
%{_mandir}/man8/ovs-testcontroller.8*
%{_mandir}/man5/ovn-nb.5*
%{_mandir}/man5/ovn-sb.5*
%{_mandir}/man7/ovn-architecture.7*
%{_mandir}/man8/ovn-controller.8*
%{_mandir}/man8/ovn-controller-vtep.8*
%{_mandir}/man8/ovn-ctl.8*
%{_mandir}/man8/ovn-nbctl.8*
%{_mandir}/man8/ovn-northd.8*
%{_mandir}/man8/ovn-sbctl.8*
%config %{_datadir}/openvswitch/ovn-nb.ovsschema
%config %{_datadir}/openvswitch/ovn-sb.ovsschema
%{_unitdir}/ovn-controller.service
%{_unitdir}/ovn-controller-vtep.service
%{_unitdir}/ovn-northd.service

%changelog
* Wed Jan 12 2011 Ralf Spenneberg <a href="mailto:ralf%40os-s.net">&lt;ralf@os-s.net&gt;</a>
- First build on F14
</pre>
</div>

<p>
ç”¨FPMæ‰“åŒ…æ–¹å¼ï¼š<a href="https://www.cnblogs.com/clsn/p/7755242.html">https://www.cnblogs.com/clsn/p/7755242.html</a>
RPMä¸DEBæ‰“åŒ… ï¼š <a href="https://www.cnblogs.com/hiyang/p/13524537.html">https://www.cnblogs.com/hiyang/p/13524537.html</a>
</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:fc8d1de9-cc97-4253-aafa-2a0f8b29582b" class="outline-3">
<h3 id="h:fc8d1de9-cc97-4253-aafa-2a0f8b29582b">FPM</h3>
<div class="outline-text-3" id="text-h:fc8d1de9-cc97-4253-aafa-2a0f8b29582b">
</div>
<div id="outline-container-h:2543eea9-0288-4092-ba76-427cee89f04b" class="outline-4">
<h4 id="h:2543eea9-0288-4092-ba76-427cee89f04b">FPMæ‰“åŒ…å·¥å…·</h4>
<div class="outline-text-4" id="text-h:2543eea9-0288-4092-ba76-427cee89f04b">
<p>
FPMçš„ä½œè€…æ˜¯jordansissel
</p>

<p>
FPMçš„githubï¼š<a href="https://github.com/jordansissel/fpm">https://github.com/jordansissel/fpm</a>
</p>

<p>
FPMåŠŸèƒ½ç®€å•è¯´å°±æ˜¯å°†ä¸€ç§ç±»å‹çš„åŒ…è½¬æ¢æˆå¦ä¸€ç§ç±»å‹ã€‚
</p>

<ol class="org-ol">
<li><p>
æ”¯æŒçš„æºç±»å‹åŒ…
</p>

<div class="org-src-container">
<pre class="src src-sh">dir         &#23558;&#30446;&#24405;&#25171;&#21253;&#25104;&#25152;&#38656;&#35201;&#30340;&#31867;&#22411;&#65292;&#21487;&#20197;&#29992;&#20110;&#28304;&#30721;&#32534;&#35793;&#23433;&#35013;&#30340;&#36719;&#20214;&#21253;
rpm         &#23545;rpm&#36827;&#34892;&#36716;&#25442;
gem         &#23545;rubygem&#21253;&#36827;&#34892;&#36716;&#25442;
python      &#23558;python&#27169;&#22359;&#25171;&#21253;&#25104;&#30456;&#24212;&#30340;&#31867;&#22411;
</pre>
</div></li>

<li><p>
æ”¯æŒçš„ç›®æ ‡ç±»å‹åŒ…
</p>

<div class="org-src-container">
<pre class="src src-sh">rpm         &#36716;&#25442;&#20026;rpm&#21253;
deb         &#36716;&#25442;&#20026;deb&#21253;
solaris     &#36716;&#25442;&#20026;solaris&#21253;
puppet      &#36716;&#25442;&#20026;puppet&#27169;&#22359;
</pre>
</div></li>

<li><p>
FPMå®‰è£…
</p>

<div class="org-src-container">
<pre class="src src-sh">fpm&#26159;ruby&#20889;&#30340;&#65292;&#22240;&#27492;&#31995;&#32479;&#29615;&#22659;&#38656;&#35201;ruby&#65292;&#19988;ruby&#29256;&#26412;&#21495;&#22823;&#20110;1.8.5&#12290;
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23433;&#35013;ruby&#27169;&#22359;</span>
yum -y install ruby rubygems ruby-devel
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#30475;&#24403;&#21069;&#20351;&#29992;&#30340;rubygems&#20179;&#24211;</span>
gem sources list
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#28155;&#21152;&#28120;&#23453;&#30340;Rubygems&#20179;&#24211;&#65292;&#22806;&#22269;&#30340;&#28304;&#24930;&#65292;&#31227;&#38500;&#21407;&#29983;&#30340;Ruby&#20179;&#24211;</span>
gem sources --add https://ruby.taobao.org/ --remove http://rubygems.org/
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23433;&#35013;fpm&#65292;gem&#20174;rubygem&#20179;&#24211;&#23433;&#35013;&#36719;&#20214;&#31867;&#20284;yum&#20174;yum&#20179;&#24211;&#23433;&#35013;&#36719;&#20214;&#12290;&#39318;&#20808;&#23433;&#35013;&#20302;&#29256;&#26412;&#30340;json&#65292;&#39640;&#29256;&#26412;&#30340;json&#38656;&#35201;ruby2.0&#20197;&#19978;&#65292;&#28982;&#21518;&#23433;&#35013;&#20302;&#29256;&#26412;&#30340;fpm&#65292;&#22815;&#29992;&#12290;</span>
gem install json -v 1.8.3
gem install fpm -v 1.3.3
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#19978;&#38754;&#30340;2&#27493;&#23433;&#35013;&#20165;&#36866;&#21512;CentOS6&#31995;&#32479;&#65292;CentOS7&#31995;&#32479;&#19968;&#27493;&#25630;&#23450;&#65292;&#21363;gem install fpm</span>
</pre>
</div></li>

<li>FPMå‚æ•° è¯¦ç»†ä½¿ç”¨è§fpm &#x2013;help</li>
</ol>

<p>
å¸¸ç”¨å‚æ•°
</p>

<div class="org-src-container">
<pre class="src src-sh">-s          &#25351;&#23450;&#28304;&#31867;&#22411;
-t          &#25351;&#23450;&#30446;&#26631;&#31867;&#22411;&#65292;&#21363;&#24819;&#35201;&#21046;&#20316;&#20026;&#20160;&#20040;&#21253;
-n          &#25351;&#23450;&#21253;&#30340;&#21517;&#23383;
-v          &#25351;&#23450;&#21253;&#30340;&#29256;&#26412;&#21495;
-C          &#25351;&#23450;&#25171;&#21253;&#30340;&#30456;&#23545;&#36335;&#24452;  Change directory to here before searching forfiles
-d          &#25351;&#23450;&#20381;&#36182;&#20110;&#21738;&#20123;&#21253;
-f          &#31532;&#20108;&#27425;&#25171;&#21253;&#26102;&#30446;&#24405;&#19979;&#22914;&#26524;&#26377;&#21516;&#21517;&#23433;&#35013;&#21253;&#23384;&#22312;&#65292;&#21017;&#35206;&#30422;&#23427;
-p          &#36755;&#20986;&#30340;&#23433;&#35013;&#21253;&#30340;&#30446;&#24405;&#65292;&#19981;&#24819;&#25918;&#22312;&#24403;&#21069;&#30446;&#24405;&#19979;&#23601;&#38656;&#35201;&#25351;&#23450;
--post-install      &#36719;&#20214;&#21253;&#23433;&#35013;&#23436;&#25104;&#20043;&#21518;&#25152;&#35201;&#36816;&#34892;&#30340;&#33050;&#26412;&#65307;&#21516;--after-install
--pre-install       &#36719;&#20214;&#21253;&#23433;&#35013;&#23436;&#25104;&#20043;&#21069;&#25152;&#35201;&#36816;&#34892;&#30340;&#33050;&#26412;&#65307;&#21516;--before-install
--post-uninstall    &#36719;&#20214;&#21253;&#21368;&#36733;&#23436;&#25104;&#20043;&#21518;&#25152;&#35201;&#36816;&#34892;&#30340;&#33050;&#26412;&#65307;&#21516;--after-remove
--pre-uninstall     &#36719;&#20214;&#21253;&#21368;&#36733;&#23436;&#25104;&#20043;&#21069;&#25152;&#35201;&#36816;&#34892;&#30340;&#33050;&#26412;&#65307;&#21516;--before-remove
</pre>
</div>
</div>
</div>
<div id="outline-container-h:c1bc70c3-5442-4fdf-90e2-c39bc6284be2" class="outline-4">
<h4 id="h:c1bc70c3-5442-4fdf-90e2-c39bc6284be2">ä½¿ç”¨å®ä¾‹&#x2013;å®æˆ˜å®šåˆ¶nginxçš„RPMåŒ…</h4>
<div class="outline-text-4" id="text-h:c1bc70c3-5442-4fdf-90e2-c39bc6284be2">
<p>
1.å®‰è£…nginx
</p>

<div class="org-src-container">
<pre class="src src-sh">yum -y install pcre-devel openssl-devel
useradd nginx -M -s /sbin/nologin
tar xf nginx-1.6.2.tar.gz
<span style="color: #483d8b;">cd</span> nginx-1.6.2


./configure --prefix=/application/nginx-1.6.2 --user=nginx --group=nginx --with-http_ssl_module --with-http_stub_status_module

make &amp;&amp; make install
ln -s /application/nginx-1.6.2/ /application/nginx
</pre>
</div>


<p>
2.ç¼–å†™è„šæœ¬
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@mc ~]# cd /server/scripts/
[root@mc scripts]# vim nginx_rpm.sh  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36825;&#26159;&#23433;&#35013;&#23436;rpm&#21253;&#35201;&#25191;&#34892;&#30340;&#33050;&#26412;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">!/bin/bash</span>
useradd nginx -M -s /sbin/nologin
ln -s /application/nginx-1.6.2/ /application/nginx
</pre>
</div>

<p>
3.æ‰“åŒ…
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@mc ~]# fpm -s dir -t rpm -n nginx -v 1.6.2 -d <span style="color: #8b2252;">'pcre-devel,openssl-devel'</span> --post-install /server/scripts/nginx_rpm.sh -f /application/nginx-1.6.2/  
no value for epoch is set, defaulting to nil {:<span style="color: #a0522d;">level</span>=&gt;:warn}
no value for epoch is set, defaulting to nil {:<span style="color: #a0522d;">level</span>=&gt;:warn}
Created package {:<span style="color: #a0522d;">path</span>=&gt;<span style="color: #8b2252;">"nginx-1.6.2-1.x86_64.rpm"</span>}
[root@mc ~]# ll -h nginx-1.6.2-1.x86_64.rpm 
-rw-r--r-- 1 root root 6.7M Nov  1 10:02 nginx-1.6.2-1.x86_64.rpm
</pre>
</div>

<p>
4.è£…rpmåŒ… å®‰è£…rpmåŒ…çš„ä¸‰ç§æ–¹æ³•ï¼š
</p>

<p>
rpmå‘½ä»¤å®‰è£…
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@LB-nginx-01 ~]# rpm -ivh nginx-1.6.2-1.x86_64.rpm
error: Failed dependencies:
       pcre-devel is needed by nginx-1.6.2-1.x86_64
       openssl-devel is needed by nginx-1.6.2-1.x86_64
&#20294;&#20250;&#25253;&#22914;&#19978;&#20381;&#36182;&#38169;&#35823;&#65292;&#38656;&#35201;&#20808;yum&#23433;&#35013;&#20381;&#36182;&#25165;&#33021;&#23433;&#35013;rpm&#21253;&#12290;
</pre>
</div>

<p>
yumå‘½ä»¤å®‰è£…rpmåŒ…
</p>

<div class="org-src-container">
<pre class="src src-sh">yum -y localinstall nginx-1.6.2-1.x86_64.rpm
&#36825;&#20010;&#21629;&#20196;&#20250;&#33258;&#21160;&#20808;&#23433;&#35013;rpm&#21253;&#30340;&#20381;&#36182;&#65292;&#28982;&#21518;&#20877;&#23433;&#35013;rpm&#21253;&#12290;
</pre>
</div>

<p>
æ­å»ºå†…ç½‘yumä»“åº“ YUMä»“åº“æ­å»º
</p>
</div>
</div>
<div id="outline-container-h:0cdf247a-b567-496d-8712-ea7b743045c3" class="outline-4">
<h4 id="h:0cdf247a-b567-496d-8712-ea7b743045c3">æ³¨æ„äº‹é¡¹</h4>
<div class="outline-text-4" id="text-h:0cdf247a-b567-496d-8712-ea7b743045c3">
<ol class="org-ol">
<li><p>
ç›¸å¯¹è·¯å¾„é—®é¢˜
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#30456;&#23545;&#36335;&#24452;</span>
[root@mc nginx]# fpm -s dir -t rpm -n nginx -v 1.6.2 .
no value for epoch is set, defaulting to nil {:<span style="color: #a0522d;">level</span>=&gt;:warn}
no value for epoch is set, defaulting to nil {:<span style="color: #a0522d;">level</span>=&gt;:warn}
Created package {:<span style="color: #a0522d;">path</span>=&gt;<span style="color: #8b2252;">"nginx-1.6.2-1.x86_64.rpm"</span>}
[root@mc nginx]# rpm -qpl nginx-1.6.2-1.x86_64.rpm    
/client_body_temp
/conf/extra/dynamic_pools
/conf/extra/static_pools
&#8230;&#8230;&#8230;&#8230;
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#32477;&#23545;&#36335;&#24452;</span>
[root@mc ~]# fpm -s dir -t rpm -n nginx -v 1.6.2 /application/nginx-1.6.2/
no value for epoch is set, defaulting to nil {:<span style="color: #a0522d;">level</span>=&gt;:warn}
no value for epoch is set, defaulting to nil {:<span style="color: #a0522d;">level</span>=&gt;:warn}
Created package {:<span style="color: #a0522d;">path</span>=&gt;<span style="color: #8b2252;">"nginx-1.6.2-1.x86_64.rpm"</span>}
[root@mc ~]# rpm -qpl nginx-1.6.2-1.x86_64.rpm 
/application/nginx-1.6.2/client_body_temp
/application/nginx-1.6.2/conf/extra/dynamic_pools
/application/nginx-1.6.2/conf/extra/static_pools
/application/nginx-1.6.2/conf/fastcgi.conf
/application/nginx-1.6.2/conf/fastcgi.conf.default
&#8230;&#8230;&#8230;&#8230;
&#20351;&#29992;rpm -qpl &#21629;&#20196;&#21487;&#20197;&#26597;&#30475;rpm&#21253;&#30340;&#20869;&#23481;&#12290;
&#27880;&#65306;fpm&#31867;&#20284;tar&#25171;&#21253;&#19968;&#26679;&#65292;&#21482;&#26159;fpm&#25171;&#30340;&#21253;&#33021;&#22815;&#34987;yum&#21629;&#20196;&#35782;&#21035;&#32780;&#24050;&#12290;
</pre>
</div></li>

<li><p>
è½¯é“¾æ¥é—®é¢˜
</p>

<div class="org-src-container">
<pre class="src src-sh">[root@mc ~]# fpm -s dir -t rpm -n nginx -v 1.6.2 /application/nginx
no value for epoch is set, defaulting to nil {:<span style="color: #a0522d;">level</span>=&gt;:warn}
File already exists, refusing to continue: nginx-1.6.2-1.x86_64.rpm {:<span style="color: #a0522d;">level</span>=&gt;:fatal}
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25253;&#38169;&#26159;&#22240;&#20026;&#24403;&#21069;&#30446;&#24405;&#23384;&#22312;&#21516;&#21517;&#30340;rpm&#21253;&#65292;&#21487;&#20197;&#20351;&#29992;-f&#21442;&#25968;&#24378;&#21046;&#35206;&#30422;&#12290;</span>
[root@mc ~]# fpm -s dir -t rpm -n nginx -v 1.6.2 -f /application/nginx
no value for epoch is set, defaulting to nil {:<span style="color: #a0522d;">level</span>=&gt;:warn}
Force flag given. Overwriting package at nginx-1.6.2-1.x86_64.rpm {:<span style="color: #a0522d;">level</span>=&gt;:warn}
no value for epoch is set, defaulting to nil {:<span style="color: #a0522d;">level</span>=&gt;:warn}
Created package {:<span style="color: #a0522d;">path</span>=&gt;<span style="color: #8b2252;">"nginx-1.6.2-1.x86_64.rpm"</span>}
&#25171;&#21253;&#30475;&#20284;&#25104;&#21151;&#65292;&#20294;&#26597;&#30475;&#21253;&#30340;&#20869;&#23481;&#65292;&#21482;&#26159;&#36825;&#19968;&#20010;&#36719;&#38142;&#25509;&#25991;&#20214;&#12290;
[root@mc ~]# rpm -qpl nginx-1.6.2-1.x86_64.rpm 
/application/nginx
&#21407;&#22240;&#65306;&#30446;&#24405;&#32467;&#23614;&#30340;/&#38382;&#39064;&#65292;&#31867;&#20284;rm&#21024;&#38500;&#36719;&#38142;&#25509;&#30446;&#24405;
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-h:bf21d0dc-57ca-42cd-8d0e-9df143577cdd" class="outline-4">
<h4 id="h:bf21d0dc-57ca-42cd-8d0e-9df143577cdd">å®šåˆ¶LNMPçš„RPMåŒ…æ€è·¯</h4>
<div class="outline-text-4" id="text-h:bf21d0dc-57ca-42cd-8d0e-9df143577cdd">
<p>
ç¼–è¯‘å®‰è£…å¥½nginxï¼Œmysqlï¼Œphpï¼Œæ­¤å¤„æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯phpçš„å¤§éƒ¨åˆ†ä¾èµ–ç¯å¢ƒæ˜¯é€š
è¿‡yumå®‰è£…çš„ï¼Œä½†æœ‰ä¸€ä¸ªlibiconv-1.14.tar.gzåŒ…éœ€è¦ç¼–è¯‘å®‰è£…,å®‰è£…æ—¶å·²ç»æŒ‡å®š
äº†å®‰è£…ç›®å½•ï¼Œåªéœ€ä¸€åŒæ‰“åŒ…å³å¯ã€‚
</p>

<p>
è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯mysqlè¿™ä¸ªç›®å½•æ¯”è¾ƒå¤§ï¼Œç”¨fpmæ‰“åŒ…è€—æ—¶é•¿ã€‚å¹³æ—¶æˆ‘ä»¬æœ‰å¯èƒ½
éœ€è¦å¯¹nginxæˆ–phpåšä¼˜åŒ–ï¼Œè¿™æ ·åˆå¾—é‡æ–°æ‰“åŒ…ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å°†mysqlåˆ†ç¦»å‡ºæ¥ï¼Œ
åˆ†åˆ«æ‰“åŒ…ã€‚åªéœ€åœ¨åˆ¶ä½œnginx+phpçš„rpmåŒ…æ—¶æ·»åŠ mysqlçš„ä¾èµ–å³å¯ã€‚
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#21442;&#32771;&#21629;&#20196;</span>
 [root@web2 ~]# fpm -s dir -t rpm -n web2 -v 1.1 <span style="color: #8b2252;">\</span>
--description <span style="color: #8b2252;">'lnmp.cms,bbs.blog'</span> <span style="color: #8b2252;">\</span>
-d &#8216;libxslt-devel,nfs-utils,rpcbind,mysql,libmcrypt-devel,mhash,mhash-devel,mcrypt<span style="color: #8b2252;">' \</span>
<span style="color: #8b2252;">--post-install /server/scripts/lnmp-init.sh  \</span>
<span style="color: #8b2252;">/application /usr/local/libiconv/ /app/logs/ /data0/  /server/</span>
</pre>
</div>
</div>
</div>
</div>
</section>
</main class="container">
<footer id="postamble" class="status">
<footer data-astro-cid-sz7xmlte data-turbo-permanent id=rootFooter>
    <script>
        const shuffle = e => e.map((e => ({
            v: e,
            sort: Math.random()
        }))).sort(( (e, o) => e.sort - o.sort)).map(( ({v: e}) => e));
        var songList = ["barbie-girl--stantough", "blue-da-ba-dee--cornelius-link", "hips-dont-lie--stantough", "i-want-it-that-way--stantough", "seven-nation-army--stantough", "smooth-criminal--stantough"]
          , songOrder = songOrder ?? shuffle(songList).map((e => `/audio/music/${e}.opus`))
          , song = new Audio(songOrder[0])
          , nextSong = new Audio(songOrder[1])
          , songIndex = 2
          , musicWrapper = void 0
          , arrow = void 0
          , notes = void 0;
        song.addEventListener("ended", next);
        const toggle = () => song.paused ? play() : pause();
        function play() {
            song.play(),
            musicWrapper = musicWrapper || document.getElementById("musicWrapper"),
            notes = notes || document.getElementById("notesWrapper"),
            musicWrapper.classList.add("shakeManHorse"),
            notes.classList.remove("hideNotes")
        }
        function pause() {
            song.pause(),
            musicWrapper = musicWrapper || document.getElementById("musicWrapper"),
            notes = notes || document.getElementById("notesWrapper"),
            musicWrapper.classList.remove("shakeManHorse"),
            notes.classList.add("hideNotes")
        }
        function next() {
            song = nextSong,
            play(),
            songIndex === songOrder.length && (songIndex = 0),
            nextSong = new Audio(songOrder[songIndex]),
            songIndex += 1
        }
        function skip() {
            pause(),
            (arrow = arrow || document.getElementById("musicArrow")).classList.add("shootArrow");
            new Audio("/audio/effects/ohno.m4a").play(),
            arrow.addEventListener("animationend", arrowShootHandler, !1)
        }
        function arrowShootHandler() {
            arrow.removeEventListener("animationend", arrowShootHandler, !1),
            arrow.classList.remove("shootArrow");
            new Audio("/audio/effects/heythathurt.m4a").play(),
            next()
        }
    </script>
    <div id=musicPlayer data-astro-cid-q7a5pyro>
        <button class=skip data-astro-cid-q7a5pyro onclick=skip() title="Skip song">
            <div id=skipWrapper data-astro-cid-q7a5pyro>
                <img alt="Medieval drollery of a man/snail/bat/monkey shooting an arrow" class=archer decoding=async height=334 loading=lazy src=/images/archer-no-arrow.448ccd8b_Z1KfRYq.webp width=226 data-astro-cid-q7a5pyro>
                <img alt="Arrow for archer" class="arrow complete" decoding=async height=23 loading=lazy src=/images/no-archer-full-arrow.87aa9971_Z2qL2KO.webp width=141 data-astro-cid-q7a5pyro id=musicArrow>
            </div>
        </button>
        <button class=playPause data-astro-cid-q7a5pyro onclick=toggle() title="Play/pause song">
            <div id=musicWrapper data-astro-cid-q7a5pyro>
                <div class=hideNotes id=notesWrapper data-astro-cid-q7a5pyro>
                    <div class=lyreNotes data-astro-cid-6gcrueho>
                        <div class=note1 data-astro-cid-6gcrueho>&#9835;&#9833;</div>
                        <div class=note2 data-astro-cid-6gcrueho>&#9833;</div>
                        <div class=note3 data-astro-cid-6gcrueho>&#9839;&#9834;</div>
                        <div class=note4 data-astro-cid-6gcrueho>&#9834;</div>
                    </div>
                    <div class=fluteNotes data-astro-cid-6gcrueho>
                        <div class=note1 data-astro-cid-6gcrueho>&#9835;&#9833;</div>
                        <div class=note2 data-astro-cid-6gcrueho>&#9833;</div>
                        <div class=note3 data-astro-cid-6gcrueho>&#9839;&#9834;</div>
                        <div class=note4 data-astro-cid-6gcrueho>&#9834;</div>
                    </div>
                </div>
                <img alt="Medieval drollery of a man/horse playing a lyre and a horn" class=manHorse decoding=async height=665 loading=lazy src=/images/man-horse-band.e3a2efcf_q8FCa.webp width=531 data-astro-cid-q7a5pyro>
            </div>
        </button>
    </div>
    <hr data-astro-cid-sz7xmlte>
    <div class=salutation data-astro-cid-gdmrbrho>
        <p data-astro-cid-gdmrbrho>
            <span class=flower2 data-astro-cid-gdmrbrho>A</span>
            <span class=smallcap data-astro-cid-gdmrbrho>pax vobiscum</span>
            <span class="flower2 wiggle" data-astro-cid-gdmrbrho id=leaf>a</span>
        </p>
    </div>
    <script>
        function animateLeafBlownHandler() {
            leaf.removeEventListener("animationend", animateLeafBlownHandler, !1),
            leaf.classList.remove("blownAway"),
            leaf.classList.add("wiggle")
        }
        function animateLeaf() {
            leaf = leaf ?? document.getElementById("leaf"),
            leaf.classList.remove("wiggle"),
            leaf.classList.add("blownAway"),
            leaf.addEventListener("animationend", animateLeafBlownHandler, !1)
        }
        document.getElementById("leaf").onclick = animateLeaf
    </script>


    <div class=bar data-astro-cid-p3givckg>
        <div class=list data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:gnuemacs height=1em viewBox="0 0 24 24" width=1em>
                    <title>emacs</title>
                    <symbol id=ai:simple-icons:gnuemacs>
                        <path d="M12 24C5.448 24 .118 18.617.118 12S5.448 0 12 0s11.882 5.383 11.882 12S18.552 24 12 24zM12 .661C5.813.661.779 5.748.779 12S5.813 23.339 12 23.339S23.221 18.253 23.221 12S18.187.661 12 .661zM8.03 20.197s.978.069 2.236-.042c.51-.045 2.444-.235 3.891-.552c0 0 1.764-.377 2.707-.725c.987-.364 1.524-.673 1.766-1.11c-.011-.09.074-.408-.381-.599c-1.164-.488-2.514-.4-5.185-.457c-2.962-.102-3.948-.598-4.472-.997c-.503-.405-.25-1.526 1.907-2.513c1.086-.526 5.345-1.496 5.345-1.496c-1.434-.709-4.109-1.955-4.659-2.224c-.482-.236-1.254-.591-1.421-1.021c-.19-.413.448-.768.804-.87c1.147-.331 2.766-.536 4.24-.56c.741-.012.861-.059.861-.059c1.022-.17 1.695-.869 1.414-1.976c-.252-1.13-1.579-1.795-2.84-1.565c-1.188.217-4.05 1.048-4.05 1.048c3.539-.031 4.131.028 4.395.398c.156.218-.071.518-1.015.672c-1.027.168-3.163.37-3.163.37c-2.049.122-3.492.13-3.925 1.046c-.283.599.302 1.129.558 1.46c1.082 1.204 2.646 1.853 3.652 2.331c.379.18 1.49.52 1.49.52c-3.265-.18-5.619.823-7.001 1.977c-1.562 1.445-.871 3.168 2.33 4.228c1.891.626 2.828.921 5.648.667c1.661-.09 1.923-.036 1.939.1c.023.192-1.845.669-2.355.816c-1.298.374-4.699 1.129-4.716 1.133z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:gnuemacs></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Emacs</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:org height=1em viewBox="0 0 24 24" width=1em>
                    <title>org-mode</title>
                    <symbol id=ai:simple-icons:org>
                        <path d="M17.169 0c-.566.004-2.16 3.312-3.376 5.94a2.19 2.19 0 0 1-.408-1.267c-.03-.582-1.089.237-.936 1.275c-.068-.035-1.26.227-1.26.23c-.23-.93-.802-1.618-1.15-.563c-.701 1.663-.88 2.984.115 4.585c-.908 4.058-6.948 6.053-6.32 9.33c.175.004 1.634 3.48 6.337 2.057c5.557-1.577 8.624 2.116 8.978 2.375c.52.526-1.348-4.573-5.302-6.865c-2.339-1.276-.87-3.474-.703-4.25c0 0 1.874 1.312 3.232-.692c1.227.316 2.05-.224 3.105.158c.64.28 3.336.11 2.334-1.396c-.148.129.07.27-.075.46c-.043.056-.128.232-.408.315c-.314.149-.83.27-1.43-.37c-.434-.32-.748-.04-.992-.063c.152-.098.577-.315 1.264-.315c.388 0 .594.336.854.338c.174 0 .685-.262.787-.365c.63-.41.697-.278 1.012-.905c.17-.759-.215-.92-.332-1.129c-.032-.483-.436-.67-.919-.326c-1.106-.198-2.192-.105-2.728-.15c-1.175-.164-2.153-.786-2.153-.786c.143-.19.075-.6-.842-.628c-.315-.104-.45-.2-.745-.307c.61-1.37.674-2.007 1.418-4.004c.261-1.053 1.039-2.685.643-2.682zm-4.297 8.093c.03-.086.443.138.952.176c.395.03.805.048 1.296-.025c.03-.005.172.095-.15.194c-.02.01-.062-.01-.065.196c0 .022-.01.04-.02.046c-.15.152-.708.223-1.065.1c-.436-.17-.482-.316-.517-.443c-.305-.147-.47-.123-.43-.244zM9.685 10.2C8.86 9 8.929 8.36 8.96 7.256C7.961 8.288 6.855 8.3 5.18 8.58c-1.299.234-3.657 2.447-4.025 4.742c-.043.608-.08 2.183.424 3.498c.492 1.13.828 1.727 1.844 2.335c-.882-3.169 5.296-5.33 6.263-8.955z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:org></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Orgmode</p>
                </div>
            </span>
            <a href=/donations.html class=entry data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:astro height=1em viewBox="0 0 24 24" width=1em>
                    <title>Donations</title>
                    <symbol id=ai:simple-icons:astro>
                        <path d="M8.358 20.162c-1.186-1.07-1.532-3.316-1.038-4.944c.856 1.026 2.043 1.352 3.272 1.535c1.897.283 3.76.177 5.522-.678c.202-.098.388-.229.608-.36c.166.473.209.95.151 1.437c-.14 1.185-.738 2.1-1.688 2.794c-.38.277-.782.525-1.175.787c-1.205.804-1.531 1.747-1.078 3.119l.044.148a3.158 3.158 0 0 1-1.407-1.188a3.31 3.31 0 0 1-.544-1.815c-.004-.32-.004-.642-.048-.958c-.106-.769-.472-1.113-1.161-1.133c-.707-.02-1.267.411-1.415 1.09c-.012.053-.028.104-.045.165h.002zm-5.961-4.445s3.24-1.575 6.49-1.575l2.451-7.565c.092-.366.36-.614.662-.614c.302 0 .57.248.662.614l2.45 7.565c3.85 0 6.491 1.575 6.491 1.575L16.088.727C15.93.285 15.663 0 15.303 0H8.697c-.36 0-.615.285-.784.727l-5.516 14.99z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:astro></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>æ‰“èµ</p>
                </div>
            </span>
            </a>
            <span class=entry data-astro-cid-p3givckg>
                <svg xmlns="http://www.w3.org/2000/svg" class=heading data-astro-cid-p3givckg data-icon=simple-icons:copyright width="1em" height="1em" viewBox="0 0 24 24">
                    <title>Copyright</title>
                    <path fill="currentColor" d="M19 2a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3zm-5 5h-4a1 1 0 0 0-1 1l.007.117A1 1 0 0 0 10 9h3v5a1 1 0 0 1-1.993.117L11 14a1 1 0 0 0-2 0a3 3 0 0 0 6 0V8a1 1 0 0 0-1-1" />
                    <use xlink:href=#ai:simple-icons:copyright></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Â© 2024 Jasper Hsu</p>
                </div>
            </span>
        </div>
        <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ class="list license" data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Creative Commons</title>
                    <symbol id=ai:fa6-brands:creative-commons>
                        <path d="m245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93c-22.13 0-33.22 14.61-33.22 43.84c0 23.57 9.21 43.84 33.22 43.84c14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98c-22.6 0-73.96-10.32-73.96-77.05c0-58.69 43-77.06 72.63-77.06c30.72-.01 52.7 11.95 65.99 35.86zm143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93c-22.14 0-33.22 14.61-33.22 43.84c0 23.55 9.23 43.84 33.22 43.84c14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98c-22.69 0-73.96-9.87-73.96-77.05c0-58.67 42.97-77.06 72.63-77.06c30.71-.01 52.58 11.95 65.56 35.86zM247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248c129.93 0 248.44-100.87 248.44-248c0-137.87-106.62-248-248.44-248zm.87 450.81c-112.54 0-203.7-93.04-203.7-202.81c0-105.42 85.43-203.27 203.72-203.27c112.53 0 202.82 89.46 202.82 203.26c-.01 121.69-99.68 202.82-202.84 202.82z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Creative Commons</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-by height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Attribute</title>
                    <symbol id=ai:fa6-brands:creative-commons-by>
                        <path d="M314.9 194.4v101.4h-28.3v120.5h-77.1V295.9h-28.3V194.4c0-4.4 1.6-8.2 4.6-11.3c3.1-3.1 6.9-4.7 11.3-4.7H299c4.1 0 7.8 1.6 11.1 4.7c3.1 3.2 4.8 6.9 4.8 11.3zm-101.5-63.7c0-23.3 11.5-35 34.5-35s34.5 11.7 34.5 35c0 23-11.5 34.5-34.5 34.5s-34.5-11.5-34.5-34.5zM247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256C0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8c103.2 0 202.8-81.1 202.8-202.8c.1-113.8-90.2-203.3-202.8-203.3z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-by></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Attribute</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-nc height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Noncommercial</title>
                    <symbol id=ai:fa6-brands:creative-commons-nc>
                        <path d="M247.6 8C387.4 8 496 115.9 496 256c0 147.2-118.5 248-248.4 248C113.1 504 0 393.2 0 256C0 123.1 104.7 8 247.6 8zM55.8 189.1c-7.4 20.4-11.1 42.7-11.1 66.9c0 110.9 92.1 202.4 203.7 202.4c122.4 0 177.2-101.8 178.5-104.1l-93.4-41.6c-7.7 37.1-41.2 53-68.2 55.4v38.1h-28.8V368c-27.5-.3-52.6-10.2-75.3-29.7l34.1-34.5c31.7 29.4 86.4 31.8 86.4-2.2c0-6.2-2.2-11.2-6.6-15.1c-14.2-6-1.8-.1-219.3-97.4zM248.4 52.3c-38.4 0-112.4 8.7-170.5 93l94.8 42.5c10-31.3 40.4-42.9 63.8-44.3v-38.1h28.8v38.1c22.7 1.2 43.4 8.9 62 23L295 199.7c-42.7-29.9-83.5-8-70 11.1c53.4 24.1 43.8 19.8 93 41.6l127.1 56.7c4.1-17.4 6.2-35.1 6.2-53.1c0-57-19.8-105-59.3-143.9c-39.3-39.9-87.2-59.8-143.6-59.8z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-nc></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Noncommercial</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-sa height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Share Alike</title>
                    <symbol id=ai:fa6-brands:creative-commons-sa>
                        <path d="M247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256C0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8c103.2 0 202.8-81.1 202.8-202.8c.1-113.8-90.2-203.3-202.8-203.3zM137.7 221c13-83.9 80.5-95.7 108.9-95.7c99.8 0 127.5 82.5 127.5 134.2c0 63.6-41 132.9-128.9 132.9c-38.9 0-99.1-20-109.4-97h62.5c1.5 30.1 19.6 45.2 54.5 45.2c23.3 0 58-18.2 58-82.8c0-82.5-49.1-80.6-56.7-80.6c-33.1 0-51.7 14.6-55.8 43.8h18.2l-49.2 49.2l-49-49.2h19.4z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-sa></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Share Alike</p>
                </div>
            </span>
        </a>
    </div>
</footer>
</footer>
</body>
</html>
