<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs: 如何提高编程速度-Emacs高手教授轻松学习所有编辑器和IDE的秘诀</title>
<meta name="generator" content="Org Mode" />
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="me" href="https://emacs.ch/@jasperhsu">
<meta name="google-adsense-account" content="ca-pub-1741779893655624">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1741779893655624" crossorigin="anonymous"></script>
<!-- from -->
<!--
<style>#back-to-top{background:#000;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;bottom:20px;-webkit-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);-moz-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);box-shadow:0 2px 5px 0 rgba(0,0,0,.26);color:#fff;cursor:pointer;display:block;height:56px;opacity:1;outline:0;position:fixed;right:20px;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-transition:bottom .2s,opacity .2s;-o-transition:bottom .2s,opacity .2s;-moz-transition:bottom .2s,opacity .2s;transition:bottom .2s,opacity .2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:56px;z-index:1}#back-to-top svg{display:block;fill:currentColor;height:24px;margin:16px auto 0;width:24px}#back-to-top.hidden{bottom:-56px;opacity:0}</style>
-->
<link rel="stylesheet" href="/static/aandds.com/css/main.css">
<link rel="stylesheet" href="/static/aandds.com/css/drollery.min.css">
<script type="text/javascript" src="/static/aandds.com/js/main.js"></script>
<!--
<script id="MathJax-script" async="" src="/static/aandds.com/js/mathjax.js"></script>

<script type="text/javascript" src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
-->
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">Emacs: 如何提高编程速度-Emacs高手教授轻松学习所有编辑器和IDE的秘诀</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgfd5c190">第1章 简介</a>
<ul>
<li><a href="#org50af087">为什要提高速度</a></li>
<li><a href="#org9191a9e">大纲</a></li>
<li><a href="#org4e9f214">科学数据提高编程效率</a></li>
</ul>
</li>
<li><a href="#org8208ba7">第2章 快速编程技巧大全</a>
<ul>
<li><a href="#org85914d2">VSCode的精华只在于一个快捷键</a></li>
<li><a href="#org2d0d366">学习VSCode中File菜单下所有功能</a></li>
<li><a href="#org4a60366">vscode 中 Edit 菜单</a>
<ul>
<li><a href="#org0906dcf">Edit-Undo and Redo 功能</a></li>
<li><a href="#orgba5c8a3">Edit菜单下的查找替换</a>
<ul>
<li><a href="#orge563153">在选定区域内查找替(VSCode版和Emacs版)</a></li>
</ul>
</li>
<li><a href="#org3dfc399">Edit菜单下在多个文件中查找替换</a>
<ul>
<li><a href="#orgef439c0">择包含与排除的目录</a></li>
</ul>
</li>
<li><a href="#org2d6cc8a">Edit 菜单下注释代码</a></li>
<li><a href="#org26bd7ce">Edit 菜单下 Emmet 工具箱扩展与缩写</a></li>
</ul>
</li>
<li><a href="#org9cfe59b">vscode 中 Selection 选择</a>
<ul>
<li><a href="#orga1a2966">Selection下拓展/收缩选择区域和其他技巧</a></li>
<li><a href="#org411ac89">Selection菜单下行操作</a></li>
<li><a href="#orgbef592a">Selection菜单下Multi-Cursor技术</a></li>
</ul>
</li>
<li><a href="#org6959c11">vscode 中 View 查看</a>
<ul>
<li><a href="#orgb4fc1d3">View菜单下Open View</a></li>
<li><a href="#orgf2b10a5">View菜单下Appearance菜单</a></li>
<li><a href="#org6ce0e92">View菜单下Editor Layout菜单子窗口操作</a></li>
<li><a href="#org6e81226">View菜单下选择左边栏和下面板</a></li>
<li><a href="#org0d6d673">View菜单下折叠行</a></li>
</ul>
</li>
<li><a href="#orgb964e00">vscode 中 Go 转到</a>
<ul>
<li><a href="#org133a8a5">Go菜单下跳转到另一个符号或当前符号的定义</a></li>
<li><a href="#orge5bae53">Go菜单下以文件名搜索并打开项目中任意文件</a></li>
<li><a href="#orgadaafb9">Go菜单下回退到之前编辑过的地方</a></li>
<li><a href="#orgfd33bd0">Go菜单在子窗口和打开的文件间移动控制焦点</a>
<ul>
<li><a href="#orgb039d72">和跳转对应的Peek功能(看一眼但不动控制焦点)</a></li>
</ul>
</li>
<li><a href="#orge3f91c9">Go菜单跳到指定行和在匹配括号间跳转</a></li>
<li><a href="#org1af5653">Go菜单在跳到下一个语法错误</a></li>
<li><a href="#org119db40">Go菜单下跳到下一个变化</a></li>
</ul>
</li>
<li><a href="#org4a259ef">vscode 中 Debug菜单</a></li>
<li><a href="#org93e3f5a">vscode 中 Terminal菜单</a></li>
<li><a href="#orgab4a977">vscode 中 Help菜单</a></li>
<li><a href="#orgf576042">如何选择高质量插件</a></li>
</ul>
</li>
<li><a href="#org7ff1ea5">第3章 学习Vim</a>
<ul>
<li><a href="#org227777d">安装Vim</a></li>
<li><a href="#orgb57a332">Vim官方教程第一讲</a>
<ul>
<li><a href="#org3226cbe">移动光标</a></li>
<li><a href="#orgeaef71e">VIM的进入和退出</a></li>
<li><a href="#orgdbf7fb4">文本编辑之删除</a></li>
<li><a href="#org567d8a4">文本编辑之插入</a></li>
<li><a href="#orgced8c46">文本编辑之添加</a></li>
<li><a href="#org485f6de">编辑文件</a></li>
<li><a href="#org54de983">小结</a></li>
</ul>
</li>
<li><a href="#org6cb60f7">Vim官方教程第二讲</a>
<ul>
<li><a href="#orga722a87">删除类命令</a></li>
<li><a href="#org4b7d656">更多删除类命令</a></li>
<li><a href="#orgf3049e4">关于命令和对象，及操作</a></li>
<li><a href="#orgb9a8c71">操作整行</a></li>
<li><a href="#orgfdf4a39">撤消类命令</a></li>
<li><a href="#org2096455">小结</a></li>
</ul>
</li>
<li><a href="#org15d81ab">Vim官方教程第三讲</a>
<ul>
<li><a href="#org26712f4">置入类命令</a></li>
<li><a href="#orgb7fdd52">替换类命令</a></li>
<li><a href="#orgcaca582">更改类命令</a></li>
<li><a href="#org32138ba">使用c更改更多</a></li>
<li><a href="#org247c072">小结</a></li>
</ul>
</li>
<li><a href="#orgd5825c3">Vim官方教程第四讲</a>
<ul>
<li><a href="#orgda14ffa">定位及文件状态</a></li>
<li><a href="#orga1337fa">搜索类命令</a></li>
<li><a href="#org2403798">配对括号的查找</a></li>
<li><a href="#org74f8234">替换命令</a></li>
<li><a href="#org02efd3f">小结</a></li>
</ul>
</li>
<li><a href="#org0704468">Vim官方教程第五讲</a>
<ul>
<li><a href="#org4bebf90">在 VIM 内执行外部命令的方法</a></li>
<li><a href="#org5d907ac">关于保存文件的更多信息</a></li>
<li><a href="#org9512c48">一个具有选择性的保存命令</a></li>
<li><a href="#org488ac15">提取和合并文件</a></li>
<li><a href="#org61313b4">小结</a></li>
</ul>
</li>
<li><a href="#orgb900fd7">Vim官方教程第六讲</a>
<ul>
<li><a href="#org35fa196">打开类命令</a></li>
<li><a href="#orgf0a7ecf">附加类命令</a></li>
<li><a href="#org36e7c0d">另外一个置换类命令的版本</a></li>
<li><a href="#org60ce02c">复制粘贴文本</a></li>
<li><a href="#org7bc346f">设置类命令的选项</a></li>
<li><a href="#orgdcfe101">小结</a></li>
</ul>
</li>
<li><a href="#org9c44629">Vim官方教程第七讲</a>
<ul>
<li><a href="#org38d5eac">获取帮助信息</a></li>
<li><a href="#org32d1152">创建启动脚本</a></li>
<li><a href="#org90528c0">补全功能</a></li>
<li><a href="#orgdd83e59">小结：</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org57f8caf">第4章 用Vim的技术强化Visual Studio Code 体验</a>
<ul>
<li><a href="#org266c76c">把Visual Studio Code变成Vim</a></li>
<li><a href="#orgc1ee8ad">设置全局快捷键</a>
<ul>
<li><a href="#org6aca086">全局快捷键设置</a></li>
</ul>
</li>
<li><a href="#org5822437">代码导航相关全局快捷键优化</a></li>
<li><a href="#orge330f68">Visual Studio Code的全部设置</a></li>
<li><a href="#orgfadb616">File菜单的优化</a>
<ul>
<li><a href="#orgdef816b">最近访问文件</a></li>
<li><a href="#orgde47030">打开文件</a></li>
<li><a href="#org122a67a">保存文件</a></li>
</ul>
</li>
<li><a href="#org215fd83">Edit菜单下优化</a>
<ul>
<li><a href="#org8ca2528">Edit菜单下 Undo/Redo和剪贴板操作</a></li>
<li><a href="#org37f17ca">Edit菜单下查找替换的优化，学习正则表达式</a>
<ul>
<li><a href="#org655843f">查找字符</a></li>
<li><a href="#org0e4ca52">替换</a></li>
</ul>
</li>
<li><a href="#org538c7d2">Edit菜单下注释的优化，行选择的技巧</a></li>
<li><a href="#org49d9e43">Edit菜单下项目中查找替换多个文件的高级技巧</a>
<ul>
<li><a href="#org4374ebb">多文件文本查找</a></li>
<li><a href="#org7f2fd4f">多文件文本替换</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org50eb818">Selection菜单下选择文本的高级技巧</a>
<ul>
<li><a href="#org3381c64">扩大选中的区域</a></li>
<li><a href="#org9785baf">缩小选区</a></li>
<li><a href="#org0677f1e">复制行</a></li>
<li><a href="#orgbfa3f6f">多光标操作</a></li>
</ul>
</li>
<li><a href="#orgc25229a">View菜单下子窗口高级技巧</a>
<ul>
<li><a href="#org71cacae">命令面板</a></li>
<li><a href="#orge768249">禅模式</a></li>
<li><a href="#orge83a7d9">分屏</a></li>
</ul>
</li>
<li><a href="#org4387295">Go菜单下高级技巧</a>
<ul>
<li><a href="#org338c840">回退</a></li>
<li><a href="#org44b1ef2">转到类定义</a></li>
<li><a href="#org9343c8e">上次搜索位置</a></li>
<li><a href="#orgd22b727">搜索并打开项目中任意文件</a></li>
<li><a href="#orgc725821">定位及文件状态-行跳</a></li>
<li><a href="#h:vscode-symbol-jump">在配对的符号间跳转的高级技巧</a></li>
<li><a href="#org75b5c92">代码自动完成的高级技巧</a>
<ul>
<li><a href="#org19bcd7c">完成单词</a></li>
<li><a href="#org0025c8e">完成行</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgee84cab">可选项</a>
<ul>
<li><a href="#org322de03">跳转到声明（Go to Declaration）的高级技巧（可选）</a></li>
<li><a href="#orge1cf65a">打开当前光标下的文件的高级技巧（可选）</a></li>
<li><a href="#org7388cc5">在当前文件搜索文本的高级技巧（可选）</a></li>
<li><a href="#orgd2685b5">把VSCode的Vim插件和Neovim结合（可选）</a></li>
</ul>
</li>
<li><a href="#org610f4b0">小结</a></li>
</ul>
</li>
<li><a href="#org9273e84">第5章 在Sublime Text中应用文本文件操作术</a>
<ul>
<li><a href="#org762e20a">安装NeoVintageous并应用文本文件操作术</a></li>
</ul>
</li>
<li><a href="#org7810cc6">第6章 在任意的IDE中应用文本文件操作术</a>
<ul>
<li><a href="#org92baf9e">在IntelliJ IDEA中安装使用IdeaVim</a></li>
<li><a href="#orgaadb491">IntelliJ IDEA中的文本文件操作术</a></li>
<li><a href="#org8b4e26e">升级IdeaVim到预览版</a></li>
<li><a href="#org86a1b0f">IntelliJ IDEA的子窗口操作和ideavi</a></li>
</ul>
</li>
<li><a href="#orgd23b072">第7章 在Emacs中应用文本文件操作术</a>
<ul>
<li><a href="#org5516f33">安装并学习Emacs和Evil</a>
<ul>
<li><a href="#orge1024dd">Windows</a></li>
<li><a href="#org92c731b">使用 chenbin 配置</a>
<ul>
<li><a href="#org2278a04">文本高级操作快捷键</a></li>
</ul>
</li>
<li><a href="#org484dd49">以服务端形式启动 emacs</a></li>
</ul>
</li>
<li><a href="#orgf4efe64">学习Emacs官方教程</a>
<ul>
<li><a href="#org9dc409c">按键</a></li>
<li><a href="#org7f0b822">跳转</a></li>
<li><a href="#orgc479438">停止响应命令</a></li>
<li><a href="#org6447290">windos 子窗口操作</a></li>
<li><a href="#org0479bf3">输入和删除文本</a></li>
<li><a href="#org2ff20de">UNDO 撤销操作</a></li>
<li><a href="#org63bf7b7">文件操作</a></li>
<li><a href="#orgc2988a1">BUFFERS 缓冲区</a></li>
<li><a href="#orgf4b8dfb">命令集扩展</a></li>
<li><a href="#org954c487">自动保存</a></li>
<li><a href="#orgca54f37">回显区（ECHO AREA）</a></li>
<li><a href="#org4591b40">状态栏（MODE LINE）</a></li>
<li><a href="#org8802e4f">搜索</a></li>
<li><a href="#org8215cb1">多子窗口</a></li>
<li><a href="#org936111a">多FRAMES</a></li>
<li><a href="#org099907f">帮助</a></li>
</ul>
</li>
<li><a href="#org440154b">Emacs的自由开放使其有一些独特的功能</a>
<ul>
<li><a href="#org3dd2b62">workgroups2 插件</a></li>
</ul>
</li>
<li><a href="#orgdae6a53">如何测量并优化工作流</a>
<ul>
<li><a href="#orgc2f4418">keyfreq 统计命令使用 插件</a></li>
</ul>
</li>
<li><a href="#orgd31cff4">文本编辑的核武器</a></li>
<li><a href="#orgf1c68eb">少有人知道的打开文件的技巧</a></li>
<li><a href="#org26c63c2">操作子窗口最理想的技巧</a></li>
</ul>
</li>
<li><a href="#org15f8c76">第8章 打造自由智能的开发环境</a>
<ul>
<li><a href="#org82d95a5">使用脚本和开源自由的命令行工具强化开发环境</a></li>
<li><a href="#org8de6548">理解环境变量</a></li>
<li><a href="#org7c43e2d">在Windows上安装Cygwin</a></li>
<li><a href="#org6aafe3f">在macOS上安装Homebrew</a></li>
<li><a href="#org9621c35">在Linux上使用Apt安装第三方软件</a></li>
<li><a href="#orgfdd47b2">Emacs Lisp基础: 变量</a>
<ul>
<li><a href="#orgc3c26d6">常用命令</a></li>
<li><a href="#org06acbfd">emacs 语法</a></li>
<li><a href="#org5ade722">变量</a></li>
</ul>
</li>
<li><a href="#org07c8d84">Emacs Lisp基础: 函数</a>
<ul>
<li><a href="#orgc884d41">内置的函数</a></li>
<li><a href="#org2acf9b4">可交互函数</a></li>
</ul>
</li>
<li><a href="#org81734a2">Emacs Lisp基础： 运算符</a>
<ul>
<li><a href="#orgc0fa7ba">其它函数</a></li>
</ul>
</li>
<li><a href="#org3703d13">Emacs Lisp基础: 数据结构</a>
<ul>
<li><a href="#org284e097">list 函数</a></li>
<li><a href="#org3f2f357">list 操作</a></li>
</ul>
</li>
<li><a href="#org1f3282a">Emacs Lisp基础: 正则表达式</a></li>
<li><a href="#org029389a">Emacs Lisp基础: 语句(statement</a>
<ul>
<li><a href="#orgb9efe52">if</a></li>
<li><a href="#org50d18bc">when</a></li>
<li><a href="#org07da714">unless</a></li>
<li><a href="#org7842c9a">cond</a></li>
<li><a href="#orgd339487">while</a></li>
<li><a href="#org35b4cc6">and or</a></li>
<li><a href="#org0efe539">dolist</a></li>
<li><a href="#org2c9dd1d">let*</a></li>
<li><a href="#orgda9f9c4">mapcar</a></li>
</ul>
</li>
<li><a href="#orgfcf36dc">Emacs Lisp基础: 和命令行交互</a>
<ul>
<li><a href="#orga0463a8">和 shell 交互</a></li>
</ul>
</li>
<li><a href="#orgdecbf88">Emacs Lisp免费电子书精选</a></li>
<li><a href="#org6e1c89e">Shell和命令行免费电子书精选</a>
<ul>
<li><a href="#org258ffe9">入门基础</a></li>
<li><a href="#org061473d">提高</a></li>
</ul>
</li>
<li><a href="#orgc101311">用Emacs Lisp开发第一个命令 hello</a></li>
<li><a href="#org63f0a21">开发my-find-file原型</a>
<ul>
<li><a href="#org41e5b4b">step 1 调用专业领域的命令行工具 find</a></li>
<li><a href="#org00ae7a9">交互选择</a></li>
</ul>
</li>
<li><a href="#org9956c52">让my-find-file排除特定目录</a></li>
<li><a href="#orgfea6319">my-find-file在项目根目录搜索</a></li>
<li><a href="#org9a8cae9">33行代码实现文件查找魔法</a></li>
<li><a href="#org8074d18">以实战经验优化my-find-file</a></li>
<li><a href="#org180e241">重用代码快速实现功能完整的my-search-text</a></li>
<li><a href="#org11b6c4e">再提速my-search-text</a></li>
<li><a href="#org757cee1">不写任何代码大大加速文本文件操作 vmtouch</a></li>
<li><a href="#org63d7887">代码自动完成引擎company-mytags原型</a>
<ul>
<li><a href="#org14eaa96">模块加载</a></li>
<li><a href="#org435062f">company-mode 第三方自动完成框架借鉴</a></li>
</ul>
</li>
<li><a href="#org7f3c5f0">为company-mytags开发模糊(fuzzy)</a></li>
<li><a href="#org089190d">在其他IDE应用基于模糊匹配算法的技巧</a></li>
<li><a href="#orga6bd640">让company-mytags可以实时扫描项目代码</a></li>
<li><a href="#orgf7d1ee1">利用ctags来加强company-mytags的代码扫描</a></li>
<li><a href="#orgaa7aab7">company-mytags可实时载入Ctags生成</a></li>
<li><a href="#orge3c7013">优化company-mytags性能</a>
<ul>
<li><a href="#org11d12a5">shell 包使用</a></li>
<li><a href="#org78fd5b1">完成内容</a></li>
</ul>
</li>
<li><a href="#org71f679a">代码导航插件my-codenav原型</a>
<ul>
<li><a href="#orgc4c2125">相对目录</a></li>
<li><a href="#org53d97e2">算法</a></li>
</ul>
</li>
<li><a href="#orgf3a2f80">改善my-codenav用户体验</a></li>
<li><a href="#orgf8d0276">打造语法检查器my-syntax-check</a></li>
<li><a href="#orgb575776">打造单词拼写检查器my-spellcheck</a></li>
<li><a href="#org69dc4ef">优化my-spellcheck性能</a></li>
<li><a href="#org84fde14">文本操作神器text object</a>
<ul>
<li><a href="#org2039c87">text object 改造</a></li>
</ul>
</li>
<li><a href="#orgfdffa9a">定义通用的字符串text object</a></li>
<li><a href="#orgd07f548">用hooks管理大项目的魔法</a>
<ul>
<li><a href="#org81bef84">major-mode-hook</a>
<ul>
<li><a href="#orgc77d20c">打开多个js文件，配置不同缩进</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org826f595">用Advice注入病毒至第三方代码中</a>
<ul>
<li><a href="#orgd05ee89">范例 find-file</a></li>
</ul>
</li>
<li><a href="#org210fcb8">参考</a></li>
</ul>
</li>
</ul>
</div>
</nav>
<ul class="org-ul">
<li>TAGS: <a href="../index.html">Emacs</a></li>
</ul>
<section id="outline-container-orgfd5c190" class="outline-2">
<h2 id="orgfd5c190">第1章 简介</h2>
<div class="outline-text-2" id="text-orgfd5c190">
<ul class="org-ul">
<li>在一周到两周内学习主流的编辑器和IDE(Emacs, Vim, Visual Studio Code, IntelliJ IDEA, Sublime Text 3)的文本文件操作</li>
<li>学习 Linux/Unix 的 Shell ，能够结合命令行程序和编辑器优化工作流</li>
<li>学习用 Lisp 拓展神之编辑器 Emacs。 学习函数式编程技术</li>
<li>第一部分对命令使用频率和快捷键设计的点评初学者节省精力和时间,为专家指出了优化效率的方向</li>
<li>第二部分 Lisp 开发的例子是精心选择的.覆盖了程序员日常工作流.代码性能针对主流操作系统(Windows/Linux/macOS)都已优化</li>
</ul>
</div>
<div id="outline-container-org50af087" class="outline-3">
<h3 id="org50af087">为什要提高速度</h3>
<div class="outline-text-3" id="text-org50af087">
<ul class="org-ul">
<li>预算和最后期限</li>
<li>编程体验舒爽</li>
<li>给自己发展多一点可能性</li>
</ul>
</div>
</div>
<div id="outline-container-org9191a9e" class="outline-3">
<h3 id="org9191a9e">大纲</h3>
<div class="outline-text-3" id="text-org9191a9e">
<ul class="org-ul">
<li>快速编程技巧大全( 以 VScode 为例)</li>
<li>学习编辑器之神 vim 的高效文本操作术</li>
<li>VScode  应用的文本文件操作术</li>
<li>在其他编辑器和 IDE 应用些操作术</li>
<li>在 emacs 中演示之前技巧的组合和拓展</li>
</ul>
</div>
</div>
<div id="outline-container-org4e9f214" class="outline-3">
<h3 id="org4e9f214">科学数据提高编程效率</h3>
<div class="outline-text-3" id="text-org4e9f214">
<p>
使用 keyfreq 统计数据，根据数据来优化我们的操作。
</p>

<p>
使用 vim 高效的文本操作术应用到 vscode 中。
</p>

<dl class="org-dl">
<dt>单个文件中查找替换字符串的练习资料</dt><dd><code>test-code-emacs.zip</code> 包含两个文件。 <code>for-code.js</code> 用来在vscode中练习单个文件文本操作。 <code>for-emacs.js</code> 的内容和 <code>for-code.js</code> 一样，是用来在emacs中练习文本操作的。在之后的视频中会多次用到。</dd>

<dt>取自于真实ReactJS项目的代码资料</dt><dd>用于练习 <code>Emmet: Go to Matching Pair</code> 命令， <code>Go to Bracket</code> 命令和 <code>matchit</code> 插件(reactjs-proj(1).zip)</dd>

<dt>多个文件多目录的文件文本操作练习资料</dt><dd>用于练习在多个文件中查找替换文本。也可用来练习多个子项目管理。在多个视频中有演示。(root-proj.zip)</dd>

<dt>Visual Studio Code 配置文件</dt><dd><p>
此配置文件为了配合教程，做了一些简化。例如没有用VSCode的第三方插件matchit的快捷键覆盖VSCode默认的快捷键。
</p>

<p>
建议在学习前面几章时不要执着于快捷键。到学习"用Vim的技术强化Visual Studio Code”一章时在研究如何优化快捷键。
</p>

<p>
启用其中所有功能需要安装vim和matchit两个插件。
</p>

<p>
我的个人VSCode完整配置在 <a href="https://github.com/redguardtoo/vscode-setup">https://github.com/redguardtoo/vscode-setup</a> 。在完成本教程前不建议使用此配置。
</p></dd>

<dt>Sublime Text 3的配置文件</dt><dd>请将zip文件中的内容解压缩到`$MySt/Packages/User`目录下,$MySt指的是你的Sublime Text 3的配置目录(sublimetext3-setup.zip)</dd>

<dt>IntelliJ IDEA的插件IdeaVim的设置</dt><dd><code>ideavimrc.zip</code> 解压缩后得到 <code>.ideavimrc</code> 将其放在环境变量$HOME所指向的目录里。这是IntelliJ IDEA的插件IdeaVim的配置文件。安装插件IdeaVim, 重启IntelliJ IDEA.</dd>

<dt>my-find-file和my-search-text实现</dt><dd><code>my-find-file.el</code> 包含找文件和搜索文件两个功能的Emacs Lisp代码实现。建议照着对应课程完成所有代码后再看本文件对照。</dd>

<dt>company-mytags的实现</dt><dd>建议完成课程后再看代码</dd>

<dt>my-codenav的实现</dt><dd>建议完成课程后再看代码</dd>

<dt>my-syntax-check实现</dt><dd>建议完成课程后再看代码</dd>

<dt>my-spellcheck实现</dt><dd>建议完成课程后再看代码</dd>

<dt>my-evil-textobj实现</dt><dd>建议完成课程后再看代码</dd>
</dl>
</div>
</div>
</section>
<section id="outline-container-org8208ba7" class="outline-2">
<h2 id="org8208ba7">第2章 快速编程技巧大全</h2>
<div class="outline-text-2" id="text-org8208ba7">
</div>
<div id="outline-container-org85914d2" class="outline-3">
<h3 id="org85914d2">VSCode的精华只在于一个快捷键</h3>
<div class="outline-text-3" id="text-org85914d2">
<p>
文档：<a href="https://code.visualstudio.com/docs">https://code.visualstudio.com/docs</a>
</p>

<ul class="org-ul">
<li>强调Execute All Commands需要大量使用，代替不常用的快捷键。此命令等价于Emacs的M-x命令。不要觉得这是人人都已掌握的常识。我可以断言，99%的用户 使用此命令的频率还是太低。不久之前我也是这99%的用户之一。- 只有在我用 “使用科学数据提高编程效率” (<a href="https://zhuanlan.zhihu.com/p/68182816">https://zhuanlan.zhihu.com/p/68182816</a>) 一文中科学方法测量过之后，我才意识到很多我以为应该常用的命令实际上用得不多。不值得为记住其快捷键浪费脑细胞。所以我使用Emacs中的M-x次数才多了起来。</li>
</ul>

<p>
列出所有命令 <code>Comand + Shift + p</code>
</p>

<pre class="example" id="orgd26da02">
Show All Commands: Ctrl + Shift + p  / mac Comand + Shift + p 列出所有命令。重要，关键字搜索方便查询命令
Open FIle:         Ctrl + o
Open Folder:       Ctrl + k Ctrl + o
Open Recent:       Ctrl + r
Keyboadrd Shortcuts Referentce        Ctrl + k Ctrl + r  帮助参考，打开一页面列出所有命令
</pre>

<p>
mac 中 Command 键对应 Ctrl 键
</p>

<p>
下面我们根据 vscode 的菜单来学习一下。
</p>
</div>
</div>
<div id="outline-container-org2d0d366" class="outline-3">
<h3 id="org2d0d366">学习VSCode中File菜单下所有功能</h3>
<div class="outline-text-3" id="text-org2d0d366">
<ul class="org-ul">
<li>很多资深用户也会在基本功上有遗漏。阻碍了他们的进一步提高。所谓基本功就是文本文件操作术。我的教程的目标就是补足所有的基本技术。所以会按照主菜单顺序讲解点评所有功能本教程讲述- 专家实战经验. “实战”这个词可能已被用烂了。网上大多数教程中“实战”两个字的意思就是照着手册“实际操作一遍”。要它们质疑大公司产品经理的决定是绝对不敢的。我肯定是在教程中要把所有不合理的决定都质疑一遍的 （陈斌：VSCode对Emacs，代码浏览哪家强）- 演示了如何充分利用Execute All Comands。少记好多快捷键。要把有限的精力放在少数几个常用的功能上。如伟人所教导的，”集中兵力打歼灭战“- 尽可能用电脑自动完成工作</li>
</ul>


<p>
可以通过 Show All Commands 来操作文件
</p>

<ul class="org-ul">
<li>打开新文件： 输入 new untitiled file，快捷键 C-n</li>
<li>打开新窗口： 输入 new window，快捷键 C-S-n</li>
<li>打开文件：输入 open file, C-o</li>
<li>打开文件夹： 输入open folder，当前作为工作区根目录  常用</li>
<li>保存工作区： 输入save workspace，指定目录保存为一个文件，下次可以直接打开</li>
<li>打开最近： 输入open recent</li>
<li>一个项目中多个目录：  输入add foler to workspace，不常用</li>
<li>自动保存：auto save，勾选上，不要使用手动保存功能</li>
<li>关闭：close</li>
</ul>
</div>
</div>
<div id="outline-container-org4a60366" class="outline-3">
<h3 id="org4a60366">vscode 中 Edit 菜单</h3>
<div class="outline-text-3" id="text-org4a60366">
</div>
<div id="outline-container-org0906dcf" class="outline-4">
<h4 id="org0906dcf">Edit-Undo and Redo 功能</h4>
<div class="outline-text-4" id="text-org0906dcf">
<ul class="org-ul">
<li>撤消/恢复 undo/redo C-z/C-S-z 比较常用</li>
<li>剪切/复制/粘贴 cut/copy/paste C-x/C-c/C-v 常用</li>
</ul>
</div>
</div>
<div id="outline-container-orgba5c8a3" class="outline-4">
<h4 id="orgba5c8a3">Edit菜单下的查找替换</h4>
<div class="outline-text-4" id="text-orgba5c8a3">
<p>
程序员最常用功能。在选定区域查找替换非常有用。
</p>

<ul class="org-ul">
<li>当前文件中查找/替换 C-f/option-C-f  需要选中字符串</li>
</ul>
</div>
<div id="outline-container-orge563153" class="outline-5">
<h5 id="orge563153">在选定区域内查找替(VSCode版和Emacs版)</h5>
<div class="outline-text-5" id="text-orge563153">
<ul class="org-ul">
<li>当前区域中查找/替换 C-f/option-C-f  需要选中字符串，弹出窗口中点 '三' 在选定区域内查找替换
<ul class="org-ul">
<li>在 emcas 中快速选中区域可以使用 <a href="https://melpa.org/#/evil-matchit">evil-matchit</a> <code>,si</code>   原生的为 <code>c-@</code> 到 选中区域， 同时在缩小区域中 narrow-to-region</li>
<li>emcacs 中替换 evil  <code>'&lt;,'&gt;s/\&lt;\(char1\)\&gt;/char2/g</code> ，退出缩小模式 <code>widen C-x n w</code></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org3dfc399" class="outline-4">
<h4 id="org3dfc399">Edit菜单下在多个文件中查找替换</h4>
<div class="outline-text-4" id="text-org3dfc399">
<p>
在多个文件中查找替换是最有用的功能，大量用于重构和阅读代码。但是大多数程序员对此功能没有充分利用
</p>

<p>
在项目根目录文件中查找/替换
</p>
<ul class="org-ul">
<li>Find in Files: S-C-f</li>
<li>Replace in Files: S-C-h</li>
</ul>

<p>
可用选项：
</p>
<ul class="org-ul">
<li>区分大小写</li>
<li>全字匹配</li>
<li>使用正则表达式</li>
</ul>
</div>
<div id="outline-container-orgef439c0" class="outline-5">
<h5 id="orgef439c0">择包含与排除的目录</h5>
<div class="outline-text-5" id="text-orgef439c0">
<p>
参考文档：<a href="https://code.visualstudio.com/docs/editor/codebasics#_search-across-files">https://code.visualstudio.com/docs/editor/codebasics#_search-across-files</a>
</p>

<p>
点击 <code>...</code> 可以选择包含与排除的目录。
</p>

<p>
golb 语法：
</p>
<pre class="example" id="org3b2c8b4">
- * to match zero or more characters in a path segment
- ? to match on one character in a path segment
- ** to match any number of path segments, including none  匹配任意多个目录
- {} to group conditions (for example {**/*.html,**/*.txt} matches all HTML and text files)
- [] to declare a range of characters to match (example.[0-9] to match on example.0, example.1, …)
- [!...] to negate a range of characters to match (example.[!0-9] to match on example.a, example.b, but not example.0)
</pre>


<p>
搜索放下方设置：拖拽搜索框到指定位置。
</p>
</div>
</div>
</div>
<div id="outline-container-org2d6cc8a" class="outline-4">
<h4 id="org2d6cc8a">Edit 菜单下注释代码</h4>
<div class="outline-text-4" id="text-org2d6cc8a">
<p>
注释代码是最常用最经典的场景，但是被大多数程序员忽视。实际上有很大的优化空间。
</p>

<ul class="org-ul">
<li>行注释 Toggle Line Comment： ctrl + /  mac Command + /， 后面使用 vim 来优化</li>
<li>块注释 Toggle Block Comment： shift + alt + a ，不用记</li>
</ul>
</div>
</div>
<div id="outline-container-org26bd7ce" class="outline-4">
<h4 id="org26bd7ce">Edit 菜单下 Emmet 工具箱扩展与缩写</h4>
<div class="outline-text-4" id="text-org26bd7ce">
<p>
Emmet那套自动完成html代码已被现代的web开发淘汰了。不过工具箱中其他工具还有可取之处。
</p>

<p>
官方地址：<a href="https://docs.emmet.io/">https://docs.emmet.io/</a>
</p>

<p>
常用语法
</p>


<pre class="example" id="org352c8b9">
input: div TAB
output: &lt;div&gt;&lt;/div&gt;

input: div*5
output:
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;
&lt;div&gt;&lt;/div&gt;

input: div*test*5
&lt;div id="test"&gt;&lt;/div&gt;
&lt;div id="test"&gt;&lt;/div&gt;
&lt;div id="test"&gt;&lt;/div&gt;
&lt;div id="test"&gt;&lt;/div&gt;
&lt;div id="test"&gt;&lt;/div&gt;
</pre>


<p>
比较古老的工具加快写html的速度，几乎所有编辑器都支持，要被淘汰，顶尖的程序员不会用这个，有了前端框架react等可用循环语句代替。<a href="https://stackoverflow.com/questions/38282997/rendering-an-array-map-in-react">https://stackoverflow.com/questions/38282997/rendering-an-array-map-in-react</a>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #0000ff;">this.state.data.map</span>(<span style="color: #a020f0;">function</span>(item, i){
  console.log(<span style="color: #8b2252;">'test'</span>);
  <span style="color: #a020f0;">return</span> &lt;li <span style="color: #a0522d;">key</span>={i}&gt;Test&lt;/li&gt;
})
</pre>
</div>

<p>
标签开头结尾相互跳转：`emmet: Go to Matching Pair` 比较有用，没有快捷键。
</p>
</div>
</div>
</div>
<div id="outline-container-org9cfe59b" class="outline-3">
<h3 id="org9cfe59b">vscode 中 Selection 选择</h3>
<div class="outline-text-3" id="text-org9cfe59b">
</div>
<div id="outline-container-orga1a2966" class="outline-4">
<h4 id="orga1a2966">Selection下拓展/收缩选择区域和其他技巧</h4>
<div class="outline-text-4" id="text-orga1a2966">
<p>
是程序员最常用的技巧，一定要记住其快捷键并尽量多用
</p>


<ul class="org-ul">
<li>全选 Select All： C-a
<ul class="org-ul">
<li>选中一段文本：shift 左/右</li>
<li>以词为单位左右移动：ctrl 左/右</li>
<li>选择区域以词单位移动：ctrl + shift 左/右</li>
</ul></li>
<li>扩大选择区 Expand Selection： Alt + Shift +  右，mac 上不同</li>
<li>缩小选择区 Shrink Selection： Alt + Shift +  左，mac 上不同</li>
</ul>
</div>
</div>
<div id="outline-container-org411ac89" class="outline-4">
<h4 id="org411ac89">Selection菜单下行操作</h4>
<div class="outline-text-4" id="text-org411ac89">
<p>
行拷贝很常用。
</p>

<ul class="org-ul">
<li>下行操作
<ul class="org-ul">
<li>向下复制一行 Copy Line Down：mac option + Shift + 下方向键，后面使用 vim 插件做重新设置，多模编辑技术</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgbef592a" class="outline-4">
<h4 id="orgbef592a">Selection菜单下Multi-Cursor技术</h4>
<div class="outline-text-4" id="text-orgbef592a">
<ul class="org-ul">
<li>切换为 “ctrl + 单击”进行多光标功能 Switch to Ctrl+Click for Multi-Cursor：，是比较古老的技术，现在比较常用 vi 的方式 C-v，按键会更少些。</li>
<li>添加下一个词 Add Next Occurrence： C-d 。在用选中的词上 C-d 选中词，再 C-d 会匹配下个一样的字符，可以进行多编辑操作。</li>
<li>选择所有匹配项 select all Occurences： S-C-L 选中所有匹配的词</li>
</ul>

<p>
比较古老的技术，现在比较常用 vi 的方式 C-v，按键会更少些。
</p>
</div>
</div>
</div>
<div id="outline-container-org6959c11" class="outline-3">
<h3 id="org6959c11">vscode 中 View 查看</h3>
<div class="outline-text-3" id="text-org6959c11">
<p>
列出所有命令 <code>Comand + Shift + p</code>
</p>
</div>
<div id="outline-container-orgb4fc1d3" class="outline-4">
<h4 id="orgb4fc1d3">View菜单下Open View</h4>
<div class="outline-text-4" id="text-orgb4fc1d3">
<ul class="org-ul">
<li>打开视图 Open view</li>
</ul>

<p>
windows :  都支持按 Alt  不放开，根据菜单栏显示首字符快速选择
</p>
</div>
</div>
<div id="outline-container-orgf2b10a5" class="outline-4">
<h4 id="orgf2b10a5">View菜单下Appearance菜单</h4>
<div class="outline-text-4" id="text-orgf2b10a5">
<p>
有很多经典和常用的操作必须掌握，如zen-mode，如果你觉得没用。那说明你效率太低
</p>

<ul class="org-ul">
<li>Appearance 外观
<ul class="org-ul">
<li>全屏 full screen：F11</li>
<li>禅模式（Zen Mode）：  C-K Z  没有干扰的编辑 重要</li>
<li>显示主侧栏(Menu Bar)、 边栏(Side Bar)、状态栏(Status Bar)、活动栏(Activity Bar)、面板(Panel)</li>
<li>放大 zoom in： ctrl + =  常用</li>
<li>缩小 zoom out： ctrl + -  常用</li>
<li>恢复默认大小 reset zoom： C-0</li>
<li>显示空格 Show Whitespace：调试时用</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org6ce0e92" class="outline-4">
<h4 id="org6ce0e92">View菜单下Editor Layout菜单子窗口操作</h4>
<div class="outline-text-4" id="text-org6ce0e92">
<p>
编辑器布局是非常经典常用的操作。必须多加练习和应用
</p>

<ul class="org-ul">
<li>Editor Layout菜单(子窗口操作)  常用
<ul class="org-ul">
<li>Split Up 向上拆分窗口</li>
<li>Split Down 向下拆分</li>
<li>Split Left 向左拆分</li>
<li>Split Right 向右拆分</li>
<li>Single 唯一的窗口</li>
<li>2x2 网络</li>
<li>Flip Layout 翻转布局</li>
</ul></li>
</ul>

<p>
重要，后面结合 vi 来设置更有效的快捷键。用 Split Right，Split Down，Single 就可以了
</p>
</div>
</div>
<div id="outline-container-org6e81226" class="outline-4">
<h4 id="org6e81226">View菜单下选择左边栏和下面板</h4>
<div class="outline-text-4" id="text-org6e81226">
<p>
不常用，不用记。
</p>

<ul class="org-ul">
<li>资源管理器 explorer 文件浏览器。很少用，直接搜索就可以。</li>
<li>搜索 search</li>
<li>终端  terminal： <code>C-`</code></li>
</ul>
</div>
</div>
<div id="outline-container-org0d6d673" class="outline-4">
<h4 id="org0d6d673">View菜单下折叠行</h4>
<div class="outline-text-4" id="text-org0d6d673">
<ul class="org-ul">
<li>自动换行 toggle word wrap： 打开</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgb964e00" class="outline-3">
<h3 id="orgb964e00">vscode 中 Go 转到</h3>
<div class="outline-text-3" id="text-orgb964e00">
<p>
*重要*，主要用来做代码导航，可以把命令对应的快捷键设置成自己习惯的。按常用性依次介绍。
</p>
</div>
<div id="outline-container-org133a8a5" class="outline-4">
<h4 id="org133a8a5">Go菜单下跳转到另一个符号或当前符号的定义</h4>
<div class="outline-text-4" id="text-org133a8a5">
<p>
程序员每时每刻必用功能，一定要记住并采用最优快捷键
</p>

<ul class="org-ul">
<li>转到编辑器中的符号 Go to Symbol in Editor：常用，列出当前打开的文件里所有重要的函数、变量、类型定义等</li>
<li>转到声明 Go to Definition：依赖语法的，如这个语言支持.</li>
<li>转到类型定义 Go to Type Definition：常用，如果看到的是变量，这个变量的类型就是它的定义，会直接跳到变量类型定义</li>
<li>转到实现 Go to Implemntation：如果定义了类，要把这个实现都显示出来</li>
</ul>

<p>
参考： <a href="https://code.visualstudio.com/docs/editor/editingevolved#_go-to-definition">https://code.visualstudio.com/docs/editor/editingevolved#_go-to-definition</a>
</p>
</div>
</div>
<div id="outline-container-orge5bae53" class="outline-4">
<h4 id="orge5bae53">Go菜单下以文件名搜索并打开项目中任意文件</h4>
<div class="outline-text-4" id="text-orge5bae53">
<ul class="org-ul">
<li>转到文件：go to file：C-p 打开当前项目的文件，可以匹配搜索。</li>
<li>转到工作区中的符号 go o symbol in workspace：列出当前变量的定义</li>
</ul>
</div>
</div>
<div id="outline-container-orgadaafb9" class="outline-4">
<h4 id="orgadaafb9">Go菜单下回退到之前编辑过的地方</h4>
<div class="outline-text-4" id="text-orgadaafb9">
<p>
非常经典的功能，一般和转到定义一起用
</p>

<ul class="org-ul">
<li>返回 Back：C-t 常用，跳转到定义后返回到原来的位置。</li>
<li>前进 Forward：ctrl + shift + -</li>
<li>上次编辑位置 Last Edit Location：常用</li>
</ul>
</div>
</div>
<div id="outline-container-orgfd33bd0" class="outline-4">
<h4 id="orgfd33bd0">Go菜单在子窗口和打开的文件间移动控制焦点</h4>
<div class="outline-text-4" id="text-orgfd33bd0">
<ul class="org-ul">
<li>切换编辑器 Switch Editor：切换到当前窗口在编辑的文件</li>
<li>切换组 Switch Group：相当于子窗口切换操作， C-1 2 3 4</li>
</ul>
</div>
<div id="outline-container-orgb039d72" class="outline-5">
<h5 id="orgb039d72">和跳转对应的Peek功能(看一眼但不动控制焦点)</h5>
<div class="outline-text-5" id="text-orgb039d72">
<p>
输入命令 Peek Definition，会打开一个子窗口快速浏览，Ecs 退出。不常用。
</p>
</div>
</div>
</div>
<div id="outline-container-orge3f91c9" class="outline-4">
<h4 id="orge3f91c9">Go菜单跳到指定行和在匹配括号间跳转</h4>
<div class="outline-text-4" id="text-orge3f91c9">
<p>
常用功能。匹配括号间跳转如结合Vim插件则是大杀器。后续课程会给出更多细节
</p>

<ul class="org-ul">
<li>转到行/列 Go to Line/Column：ctrl + g 行号，快速跳到出错问题行号。</li>
<li>转到括号 Go to Bracket：</li>
</ul>
</div>
</div>
<div id="outline-container-org1af5653" class="outline-4">
<h4 id="org1af5653">Go菜单在跳到下一个语法错误</h4>
<div class="outline-text-4" id="text-org1af5653">
<p>
一般跳到第一个错误后就不需要再跳转了。自带的语法检查也好，第三方语法检查也好，都是实时检查错误。所以你不可能有两个以上错误。快捷键不用记。
</p>

<ul class="org-ul">
<li>转到到下一个问题代码 Next Problem</li>
<li>转到到上一个问题代码 Provious Problem</li>
</ul>
</div>
</div>
<div id="outline-container-org119db40" class="outline-4">
<h4 id="org119db40">Go菜单下跳到下一个变化</h4>
<div class="outline-text-4" id="text-org119db40">
<ul class="org-ul">
<li>下一个更改 Next Change：常用，未放到版本控制服务器用绿色表式，会开一个小窗口。</li>
<li>上一个更改 Previous Change</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org4a259ef" class="outline-3">
<h3 id="org4a259ef">vscode 中 Debug菜单</h3>
<div class="outline-text-3" id="text-org4a259ef">
<p>
不用记，可以使用更好的第三方工具
</p>
</div>
</div>
<div id="outline-container-org93e3f5a" class="outline-3">
<h3 id="org93e3f5a">vscode 中 Terminal菜单</h3>
<div class="outline-text-3" id="text-org93e3f5a">
<p>
不建议用。 一般会使用独立的命令行窗口操作，代码比较清晰。
</p>
</div>
</div>
<div id="outline-container-orgab4a977" class="outline-3">
<h3 id="orgab4a977">vscode 中 Help菜单</h3>
<div class="outline-text-3" id="text-orgab4a977">
<p>
了解就行。
</p>

<ul class="org-ul">
<li>列出所有命令 Keyboadrd Shortcuts Referentce： Ctrl + k Ctrl + r  帮助参考，打开一页面列出所有命令。</li>
<li>报告问题 Report Issue：</li>
</ul>
</div>
</div>
<div id="outline-container-orgf576042" class="outline-3">
<h3 id="orgf576042">如何选择高质量插件</h3>
<div class="outline-text-3" id="text-orgf576042">
<ul class="org-ul">
<li>插件看评价，不看下载量</li>
</ul>

<p>
github 代码质量：
</p>
<ul class="org-ul">
<li>看 issue，open 和 closed 比例：1:1 是差的，1:4 好， closed多表式关闭的bug多。closed 是用户关闭的，而不是作者关闭</li>
<li>pull requests 有人愿意修复这个bug</li>
<li>star 星数</li>
</ul>
</div>
</div>
</section>
<section id="outline-container-org7ff1ea5" class="outline-2">
<h2 id="org7ff1ea5">第3章 学习Vim</h2>
<div class="outline-text-2" id="text-org7ff1ea5">
</div>
<div id="outline-container-org227777d" class="outline-3">
<h3 id="org227777d">安装Vim</h3>
<div class="outline-text-3" id="text-org227777d">
<p>
编辑器之神Vim的文本操作效率公认非常高效。其他编辑器和IDE也支持Vim的快捷键。掌握了Vim就可以提高在所有编辑器和IDE中的效率
</p>


<p>
<a href="https://www.vim.org/">https://www.vim.org/</a>
</p>

<p>
<b>windows</b>
</p>

<ul class="org-ul">
<li>PC: MS-DOS and MS-Window</li>
</ul>


<p>
<a href="https://ftp.nluug.nl/pub/vim/pc/gvim82.exe">https://ftp.nluug.nl/pub/vim/pc/gvim82.exe</a>
双击运行，完全安装
</p>


<p>
官方教程：在开始菜单中找到 vim tutor
</p>

<p>
<b>linux/mac</b>
</p>

<p>
官方教程：在 shell 中输入 vimtutor 或中文 vimtutor zh
</p>

<p>
下面是教程每讲内容，在使用中学习，30分钟
</p>
</div>
</div>
<div id="outline-container-orgb57a332" class="outline-3">
<h3 id="orgb57a332">Vim官方教程第一讲</h3>
<div class="outline-text-3" id="text-orgb57a332">
</div>
<div id="outline-container-org3226cbe" class="outline-4">
<h4 id="org3226cbe">移动光标</h4>
<div class="outline-text-4" id="text-org3226cbe">
<ul class="org-ul">
<li>移动光标
<ul class="org-ul">
<li>h: 左 L: 右 j: 下 k:</li>
<li>ecs 回到正常(noarmal)模式</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgeaef71e" class="outline-4">
<h4 id="orgeaef71e">VIM的进入和退出</h4>
<div class="outline-text-4" id="text-orgeaef71e">
<ul class="org-ul">
<li>VIM的进入和退出
<ul class="org-ul">
<li>输入 &lt;ESC&gt;  确保处在正常模式，输入 <code>:q! &lt;回车&gt;</code> 放弃所有改动</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgdbf7fb4" class="outline-4">
<h4 id="orgdbf7fb4">文本编辑之删除</h4>
<div class="outline-text-4" id="text-orgdbf7fb4">
<ul class="org-ul">
<li>文本编辑之删除
<ul class="org-ul">
<li>在正常(Normal)模式下，可以按下 x 键来删除光标所在位置的字符</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org567d8a4" class="outline-4">
<h4 id="org567d8a4">文本编辑之插入</h4>
<div class="outline-text-4" id="text-org567d8a4">
<ul class="org-ul">
<li>文本编辑之插入
<ul class="org-ul">
<li>在正常模式下，按 i  在光标前插入文本</li>
<li>ecs 返回正常模式</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgced8c46" class="outline-4">
<h4 id="orgced8c46">文本编辑之添加</h4>
<div class="outline-text-4" id="text-orgced8c46">
<ul class="org-ul">
<li>文本编辑之添加
<ul class="org-ul">
<li>A  在一行后添加文本</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org485f6de" class="outline-4">
<h4 id="org485f6de">编辑文件</h4>
<div class="outline-text-4" id="text-org485f6de">
<ul class="org-ul">
<li>编辑文件
<ul class="org-ul">
<li>使用 :wq 以保存文件并退出</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org54de983" class="outline-4">
<h4 id="org54de983">小结</h4>
<div class="outline-text-4" id="text-org54de983">
<pre class="example" id="org07aca92">
1. 光标在屏幕文本中的移动既可以用箭头键，也可以使用 hjkl 字母键。
         h (左移)       j (下行)       k (上行)     l (右移)
2. 欲进入 Vim 编辑器(从命令行提示符)，请输入：vim 文件名 &lt;回车&gt;
3. 欲退出 Vim 编辑器，请输入 &lt;ESC&gt;   :q!   &lt;回车&gt; 放弃所有改动。
                      或者输入 &lt;ESC&gt;   :wq   &lt;回车&gt; 保存改动。
4. 在正常模式下删除光标所在位置的字符，请按： x
5. 欲插入或添加文本，请输入：
         i   输入欲插入文本   &lt;ESC&gt;             在光标前插入文本
         A   输入欲添加文本   &lt;ESC&gt;             在一行后添加文本
特别提示：按下 &lt;ESC&gt; 键会带您回到正常模式或者撤消一个不想输入或部分完整
的命令。
</pre>
</div>
</div>
</div>
<div id="outline-container-org6cb60f7" class="outline-3">
<h3 id="org6cb60f7">Vim官方教程第二讲</h3>
<div class="outline-text-3" id="text-org6cb60f7">
</div>
<div id="outline-container-orga722a87" class="outline-4">
<h4 id="orga722a87">删除类命令</h4>
<div class="outline-text-4" id="text-orga722a87">
<ul class="org-ul">
<li>删除类命令
<ul class="org-ul">
<li>当前光标删除至下一个单词，请输入：dw</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org4b7d656" class="outline-4">
<h4 id="org4b7d656">更多删除类命令</h4>
<div class="outline-text-4" id="text-org4b7d656">
<ul class="org-ul">
<li>更多删除类命令
<ul class="org-ul">
<li>从当前光标删除至当前行末尾，请输入：d$</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgf3049e4" class="outline-4">
<h4 id="orgf3049e4">关于命令和对象，及操作</h4>
<div class="outline-text-4" id="text-orgf3049e4">
<ul class="org-ul">
<li>关于命令和对象
许多改变文本的命令都由一个操作符和一个动作构成。</li>
</ul>

<pre class="example" id="orgd7a2827">
在正常模式下修改命令的格式是：
operator   [number]   motion

其中：
- operator - 操作符，代表要做的事情，比如 d 代表删除
- [number] - 可以附加的数字，代表动作重复的次数
- motion   - 动作，代表在所操作的文本上的移动，例如 w 代表单词(word)，$ 代表行末等等。
一个简短的动作列表：
  w - 从当前光标当前位置直到下一个单词起始处，不包括它的第一个字符。
  e - 从当前光标当前位置直到单词末尾，包括最后一个字符。
  $ - 从当前光标当前位置直到当前行末。

正常模式下面仅按代表相应动作的键而不使用操作符，可以看到光标的移动正如上面的对象列表所代表的一样。

如：
de 会从当前光标位置删除到单词末尾
</pre>


<p>
使用计数指定动作
</p>

<pre class="example" id="orgc768514">
在动作前输入数字会使它重复那么多次
  输入 2w 使光标向前移动两个单词。
  输入 3e 使光标向前移动到第三个单词的末尾。
  输入 0 (数字零) 移动光标到行首。
</pre>

<p>
使用计数以删除更多
</p>

<pre class="example" id="org93bffb2">
使用操作符时输入数字可以使它重复那么多次。
在正常模式下格式是：operator   [number]   motion

- 输入 d2w 以删除两个大写字母单词
</pre>
</div>
</div>
<div id="outline-container-orgb9a8c71" class="outline-4">
<h4 id="orgb9a8c71">操作整行</h4>
<div class="outline-text-4" id="text-orgb9a8c71">
<ul class="org-ul">
<li>操作整行
<ul class="org-ul">
<li>输入 dd 可以删除整一个当前行。如 2dd 删除2行</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgfdf4a39" class="outline-4">
<h4 id="orgfdf4a39">撤消类命令</h4>
<div class="outline-text-4" id="text-orgfdf4a39">
<ul class="org-ul">
<li>撤消类命令
<ul class="org-ul">
<li>撤消以前的操作，请输入：u (小写的u)</li>
<li>撤消在一行中所做的改动，请输入：U (大写的U)</li>
<li>多次输入 CTRL-R (先按下 CTRL 键不放开，接着按 R 键)，这样就
可以重做被撤消的命令，也就是撤消掉撤消命令</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org2096455" class="outline-4">
<h4 id="org2096455">小结</h4>
<div class="outline-text-4" id="text-org2096455">
<pre class="example" id="orgb430357">
1. 欲从当前光标删除至下一个单词，请输入：dw
2. 欲从当前光标删除至当前行末尾，请输入：d$
3. 欲删除整行，请输入：dd

4. 欲重复一个动作，请在它前面加上一个数字：2w
5. 在正常模式下修改命令的格式是：
             operator   [number]   motion
   其中：
     operator - 操作符，代表要做的事情，比如 d 代表删除
     [number] - 可以附加的数字，代表动作重复的次数
     motion   - 动作，代表在所操作的文本上的移动，例如 w 代表单词(word)，
                $ 代表行末等等。

6. 欲移动光标到行首，请按数字0键：0

7. 欲撤消以前的操作，请输入：u (小写的u)
   欲撤消在一行中所做的改动，请输入：U (大写的U)
   欲撤消以前的撤消命令，恢复以前的操作结果，请输入：CTRL-R
</pre>
</div>
</div>
</div>
<div id="outline-container-org15d81ab" class="outline-3">
<h3 id="org15d81ab">Vim官方教程第三讲</h3>
<div class="outline-text-3" id="text-org15d81ab">
</div>
<div id="outline-container-org26712f4" class="outline-4">
<h4 id="org26712f4">置入类命令</h4>
<div class="outline-text-4" id="text-org26712f4">
<ul class="org-ul">
<li>置入类命令
<ul class="org-ul">
<li>输入 p 将最后一次删除的内容置入光标之后</li>
</ul></li>
</ul>

<p>
如
</p>
<pre class="example" id="orgcee4b85">
输入 dd 将该行删除，这样会将该行保存到 Vim 的一个寄存器中
输入 p 将该行粘贴置入
</pre>
</div>
</div>
<div id="outline-container-orgb7fdd52" class="outline-4">
<h4 id="orgb7fdd52">替换类命令</h4>
<div class="outline-text-4" id="text-orgb7fdd52">
<ul class="org-ul">
<li>替换类命令
<ul class="org-ul">
<li>输入 r 和一个字符替换光标所在位置的字符</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgcaca582" class="outline-4">
<h4 id="orgcaca582">更改类命令</h4>
<div class="outline-text-4" id="text-orgcaca582">
<ul class="org-ul">
<li>更改类命令
<ul class="org-ul">
<li>改变文本直到一个单词的末尾，请输入 ce，并进入插入模式</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org32138ba" class="outline-4">
<h4 id="org32138ba">使用c更改更多</h4>
<div class="outline-text-4" id="text-org32138ba">
<ul class="org-ul">
<li>使用c更改更多
<ul class="org-ul">
<li>更改类操作符可以与删除中使用的同样的动作配合使用。格式为 c    [number]   motion</li>
</ul></li>

<li><code>c$</code>  删除当前光标位置到行尾</li>
</ul>
</div>
</div>
<div id="outline-container-org247c072" class="outline-4">
<h4 id="org247c072">小结</h4>
<div class="outline-text-4" id="text-org247c072">
<pre class="example" id="orgd9609e1">
1. 要重新置入已经删除的文本内容，请按小写字母 p 键。该操作可以将已删除
   的文本内容置于光标之后。如果最后一次删除的是一个整行，那么该行将置
   于当前光标所在行的下一行。

2. 要替换光标所在位置的字符，请输入小写的 r 和要替换掉原位置字符的新字
   符即可。

3. 更改类命令允许您改变从当前光标所在位置直到动作指示的位置中间的文本。
   比如输入 ce 可以替换当前光标到单词的末尾的内容；输入 c$ 可以替换当
   前光标到行末的内容。

4. 更改类命令的格式是：

       c   [number]   motion
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd5825c3" class="outline-3">
<h3 id="orgd5825c3">Vim官方教程第四讲</h3>
<div class="outline-text-3" id="text-orgd5825c3">
</div>
<div id="outline-container-orgda14ffa" class="outline-4">
<h4 id="orgda14ffa">定位及文件状态</h4>
<div class="outline-text-4" id="text-orgda14ffa">
<ul class="org-ul">
<li>定位及文件状态-行跳</li>
</ul>

<pre class="example" id="orgcf46e4e">
G 最后一行
1G, gg 第一行
4gg, :4  第4行

输入 CTRL-G 显示当前编辑文件中当前光标所在行位置以及文件状态信息
</pre>
</div>
</div>
<div id="outline-container-orga1337fa" class="outline-4">
<h4 id="orga1337fa">搜索类命令</h4>
<div class="outline-text-4" id="text-orga1337fa">
<ul class="org-ul">
<li>搜索类命令
<ul class="org-ul">
<li>输入 / 加上一个字符串可以用以在当前文件中查找该字符串</li>
<li>逆向查找字符串，请使用 ? 代替 / 进行
<ul class="org-ul">
<li>n/N  向下向上搜索</li>
</ul></li>
<li>CTRL-O 带您跳转回较旧的位置。可跳到上一个文件搜索的旧搜索位置，可多次操作</li>
<li>CTRL-I 则带您到较新的位置。可跳到下一个文件搜索的新搜索位置，可多次操作</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org2403798" class="outline-4">
<h4 id="org2403798">配对括号的查找</h4>
<div class="outline-text-4" id="text-org2403798">
<ul class="org-ul">
<li>配对括号的查找
<ul class="org-ul">
<li>如果光标当前位置是括号(、)、[、]、{、}，按 % 会将光标移动到配对的括号上</li>
</ul></li>
</ul>

<p>
vim-matchit 插件可以在函数、括号之间跳转
</p>
</div>
</div>
<div id="outline-container-org74f8234" class="outline-4">
<h4 id="org74f8234">替换命令</h4>
<div class="outline-text-4" id="text-org74f8234">
<ul class="org-ul">
<li><p>
替换命令
</p>
<ul class="org-ul">
<li>输入 <code>:s/old/new/g</code> 可以替换 old 为 new</li>
</ul>

<pre class="example" id="org6f7142b">
输入   :#,#s/old/new/g   其中 #,# 代表的是替换操作的若干行中
                         首尾两行的行号。
输入   :%s/old/new/g     则是替换整个文件中的每个匹配串。
输入   :%s/old/new/gc    会找到整个文件中的每个匹配串，并且对每个匹配串提示是否进行替换。
</pre></li>
</ul>
</div>
</div>
<div id="outline-container-org02efd3f" class="outline-4">
<h4 id="org02efd3f">小结</h4>
<div class="outline-text-4" id="text-org02efd3f">
<pre class="example" id="org418522b">
  1. CTRL-G 用于显示当前光标所在位置和文件状态信息。
     G 用于将光标跳转至文件最后一行。
     先敲入一个行号然后输入大写 G 则是将光标移动至该行号代表的行。
     gg 用于将光标跳转至文件第一行。

  2. 输入 / 然后紧随一个字符串是在当前所编辑的文档中正向查找该字符串。
     输入 ? 然后紧随一个字符串则是在当前所编辑的文档中反向查找该字符串。
     完成一次查找之后按 n 键是重复上一次的命令，可在同一方向上查
     找下一个匹配字符串所在；或者按大写 N 向相反方向查找下一匹配字符串所在。
     CTRL-O 带您跳转回较旧的位置，CTRL-I 则带您到较新的位置。

  3. 如果光标当前位置是括号(、)、[、]、{、}，按 % 会将光标移动到配对的括号上。

  4. 在一行内替换头一个字符串 old 为新的字符串 new，请输入  :s/old/new
     在一行内替换所有的字符串 old 为新的字符串 new，请输入  :s/old/new/g
     在两行内替换所有的字符串 old 为新的字符串 new，请输入  :#,#s/old/new/g
     在文件内替换所有的字符串 old 为新的字符串 new，请输入  :%s/old/new/g
     进行全文替换时询问用户确认每个替换需添加 c 标志        :%s/old/new/gc

vim-matchit 插件可以在函数、括号之间跳转
CTRL-O 带您跳转回较旧的位置。可跳到上一个文件搜索的旧搜索位置，可多次操作
CTRL-I 则带您到较新的位置。可跳到下一个文件搜索的新搜索位置，可多次操作
</pre>
</div>
</div>
</div>
<div id="outline-container-org0704468" class="outline-3">
<h3 id="org0704468">Vim官方教程第五讲</h3>
<div class="outline-text-3" id="text-org0704468">
</div>
<div id="outline-container-org4bebf90" class="outline-4">
<h4 id="org4bebf90">在 VIM 内执行外部命令的方法</h4>
<div class="outline-text-4" id="text-org4bebf90">
<ul class="org-ul">
<li>在 VIM 内执行外部命令的方法
<ul class="org-ul">
<li>输入 <code>:!</code> 然后紧接着输入一个外部命令可以执行该外部命令</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org5d907ac" class="outline-4">
<h4 id="org5d907ac">关于保存文件的更多信息</h4>
<div class="outline-text-4" id="text-org5d907ac">
<ul class="org-ul">
<li>关于保存文件的更多信息
<ul class="org-ul">
<li>将对文件的改动保存到文件中，请输入 :w FILENAME</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org9512c48" class="outline-4">
<h4 id="org9512c48">一个具有选择性的保存命令</h4>
<div class="outline-text-4" id="text-org9512c48">
<ul class="org-ul">
<li>一个具有选择性的保存命令
<ul class="org-ul">
<li>要保存文件的部分内容，请输入 <code>v motion :w FILENAME</code>
<ul class="org-ul">
<li>v 选中区域，按:  字符, 看到屏幕底部会出现 <code>:'&lt;,'&gt;</code> ，再按 <code>:'&lt;,'&gt;w TEST</code> 保存到 TEST 文件</li>
</ul></li>
</ul></li>
</ul>

<p>
提示：按 v 键使 Vim 进入可视模式进行选取。您可以四处移动光标使选取区域变大或变小。接着您可以使用一个操作符对选中文本进行操作。例如，按 d 键会删除选中的文本内容。
</p>
</div>
</div>
<div id="outline-container-org488ac15" class="outline-4">
<h4 id="org488ac15">提取和合并文件</h4>
<div class="outline-text-4" id="text-org488ac15">
<ul class="org-ul">
<li>提取和合并文件
<ul class="org-ul">
<li>要向当前文件中插入另外的文件的内容，请输入 <code>:r FILENAME</code></li>
<li>读取外部命令的输出，如 <code>:r !dir</code> 可以读取 dir 命令的输出并将其放置到当前文件的光标位置后面</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org61313b4" class="outline-4">
<h4 id="org61313b4">小结</h4>
<div class="outline-text-4" id="text-org61313b4">
<pre class="example" id="org844145e">
1. :!command 用于执行一个外部命令 command。

   请看一些实际例子：
       (MS-DOS)         (Unix)
        :!dir            :!ls            -  用于显示当前目录的内容。
        :!del FILENAME   :!rm FILENAME   -  用于删除名为 FILENAME 的文件。

2. :w FILENAME  可将当前 VIM 中正在编辑的文件保存到名为 FILENAME 的文
   件中。

3. v motion :w FILENAME 可将当前编辑文件中可视模式下选中的内容保存到文件
   FILENAME 中。

4. :r FILENAME 可提取磁盘文件 FILENAME 并将其插入到当前文件的光标位置
   后面。

5. :r !dir 可以读取 dir 命令的输出并将其放置到当前文件的光标位置后面。
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb900fd7" class="outline-3">
<h3 id="orgb900fd7">Vim官方教程第六讲</h3>
<div class="outline-text-3" id="text-orgb900fd7">
</div>
<div id="outline-container-org35fa196" class="outline-4">
<h4 id="org35fa196">打开类命令</h4>
<div class="outline-text-4" id="text-org35fa196">
<ul class="org-ul">
<li>打开类命令
<ul class="org-ul">
<li>输入 o 将在光标的下方打开新的一行并进入插入模式</li>
<li>输入大写的 O 可以在光标上方打开新的一行</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgf0a7ecf" class="outline-4">
<h4 id="orgf0a7ecf">附加类命令</h4>
<div class="outline-text-4" id="text-orgf0a7ecf">
<ul class="org-ul">
<li>附加类命令
<ul class="org-ul">
<li>输入 a 将可在光标之后插入文本</li>
<li>输入大写的 A 可以在光标所在行的行末之后插入文本。</li>
<li>a、i 和 A 都会带您进入插入模式，惟一的区别在于字符插入的位置</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org36e7c0d" class="outline-4">
<h4 id="org36e7c0d">另外一个置换类命令的版本</h4>
<div class="outline-text-4" id="text-org36e7c0d">
<ul class="org-ul">
<li>另外一个置换类命令的版本
<ul class="org-ul">
<li>输入大写的 R 可连续替换多个字符。</li>
</ul></li>
</ul>

<p>
替换模式与插入模式相似，不过每个输入的字符都会删除一个已有的字符
</p>
</div>
</div>
<div id="outline-container-org60ce02c" class="outline-4">
<h4 id="org60ce02c">复制粘贴文本</h4>
<div class="outline-text-4" id="text-org60ce02c">
<ul class="org-ul">
<li>复制粘贴文本
<ul class="org-ul">
<li>使用操作符 y 复制文本，使用 p 粘贴文本</li>
</ul></li>
</ul>

<p>
您还可以把 y 当作操作符来使用；例如 yw 可以用来复制一个单词
</p>
</div>
</div>
<div id="outline-container-org7bc346f" class="outline-4">
<h4 id="org7bc346f">设置类命令的选项</h4>
<div class="outline-text-4" id="text-org7bc346f">
<ul class="org-ul">
<li><p>
设置类命令的选项
</p>
<ul class="org-ul">
<li>设置可使查找或者替换可忽略大小写的选项
<ul class="org-ul">
<li>Ignore Case，忽略大小写 `:set ic`</li>
<li>如果您想要仅在一次查找时忽略字母大小写，您可以使用 <code>\c</code> ，如 <code>/ignore\c &lt;回车&gt;</code></li>
</ul></li>
</ul>

<pre class="example" id="org7ca381a">
:set xxx 可以设置 xxx 选项。一些有用的选项如下：
- 'ic' 'ignorecase'       查找时忽略字母大小写
- 'is' 'incsearch'        查找短语时显示部分匹配
- 'hls' 'hlsearch'        高亮显示所有的匹配短语

选项名可以用完整版本，也可以用缩略版本。

在选项前加上 no 可以关闭选项：  :set noic
</pre></li>
</ul>
</div>
</div>
<div id="outline-container-orgdcfe101" class="outline-4">
<h4 id="orgdcfe101">小结</h4>
<div class="outline-text-4" id="text-orgdcfe101">
<pre class="example" id="orga3218b4">
1. 输入小写的 o 可以在光标下方打开新的一行并进入插入模式。
   输入大写的 O 可以在光标上方打开新的一行。

2. 输入小写的 a 可以在光标所在位置之后插入文本。
   输入大写的 A 可以在光标所在行的行末之后插入文本。

3. e 命令可以使光标移动到单词末尾。

4. 操作符 y 复制文本，p 粘贴先前复制的文本。

5. 输入大写的 R 将进入替换模式，直至按 &lt;ESC&gt; 键回到正常模式。

6. 输入 :set xxx 可以设置 xxx 选项。一些有用的选项如下：
      'ic' 'ignorecase'       查找时忽略字母大小写
      'is' 'incsearch'        查找短语时显示部分匹配
      'hls' 'hlsearch'        高亮显示所有的匹配短语
     
   选项名可以用完整版本，也可以用缩略版本。

7. 在选项前加上 no 可以关闭选项，如  `:set noic` 不忽略大小写， ':set nohlsearch'  移除高亮
8. 仅在一次查找时忽略字母大小写，您可以使用 `\c
</pre>
</div>
</div>
</div>
<div id="outline-container-org9c44629" class="outline-3">
<h3 id="org9c44629">Vim官方教程第七讲</h3>
<div class="outline-text-3" id="text-org9c44629">
</div>
<div id="outline-container-org38d5eac" class="outline-4">
<h4 id="org38d5eac">获取帮助信息</h4>
<div class="outline-text-4" id="text-org38d5eac">
<ul class="org-ul">
<li>获取帮助信息</li>
</ul>

<pre class="example" id="orge10a1cf">
要启动该帮助系统，请选择如下三种方法之一：
    - 按下 &lt;HELP&gt; 键 (如果键盘上有的话)
    - 按下 &lt;F1&gt; 键 (如果键盘上有的话)
    - 输入	:help &lt;回车&gt;

  请阅读帮助窗口中的文字以了解帮助是如何工作的。
  输入 CTRL-W CTRL-W   可以使您在窗口之间跳转。
  输入 :q &lt;回车&gt; 可以关闭帮助窗口。

例如：
:help
:help s * 查看s替换的用法
:help c_CTRL-D  快捷键绑定
:help user-manual 用户手册
</pre>
</div>
</div>
<div id="outline-container-org32d1152" class="outline-4">
<h4 id="org32d1152">创建启动脚本</h4>
<div class="outline-text-4" id="text-org32d1152">
<ul class="org-ul">
<li>创建启动脚本</li>
</ul>

<pre class="example" id="orgcfd3338">
1. 开始编辑 vimrc 文件，具体命令取决于您所使用的操作系统：
      :edit ~/.vimrc		这是 Unix 系统所使用的命令
      :edit $VIM/_vimrc	这是 MS-Windows 系统所使用的命令

2. 接着读取 vimrc 示例文件的内容：
      :r $VIMRUNTIME/vimrc_example.vim

3. 保存文件，命令为：
      :write

下次您启动 Vim 时，编辑器就会有了语法高亮的功能。
您可以把您喜欢的各种设置添加到这个 vimrc 文件中。
要了解更多信息请输入 :help vimrc-intro
</pre>
</div>
</div>
<div id="outline-container-org90528c0" class="outline-4">
<h4 id="org90528c0">补全功能</h4>
<div class="outline-text-4" id="text-org90528c0">
<ul class="org-ul">
<li>补全功能
<ul class="org-ul">
<li>确保 Vim 不是在以兼容模式运行： =:set nocp`</li>
<li>使用 CTRL-D 和 &lt;TAB&gt; 可以进行命令行补全</li>
</ul></li>
</ul>



<p>
范例：使用 CTRL-D 和 &lt;TAB&gt; 可以进行命令行补全
</p>

<pre class="example" id="orga2c719d">
1. 请确保 Vim 不是在以兼容模式运行： :set nocp
2. 查看一下当前目录下已经存在哪些文件，输入： :!ls   或者  :!dir
3. 现在输入一个目录的起始部分，例如输入： :e
4. 接着按 CTRL-D 键，Vim 会显示以 e 开始的命令的列表。
5. 然后按 &lt;TAB&gt; 键，Vim 会补全命令为 :edit 。
6. 现在添加一个空格，以及一个已有文件的文件名的起始部分，例如： :edit FIL
7. 接着按 &lt;TAB&gt; 键，Vim 会补全文件名(如果它是惟一匹配的)。
</pre>
</div>
</div>
<div id="outline-container-orgdd83e59" class="outline-4">
<h4 id="orgdd83e59">小结：</h4>
<div class="outline-text-4" id="text-orgdd83e59">
<pre class="example" id="orge4f6a79">
1. 输入 :help 或者按 &lt;F1&gt; 键或 &lt;Help&gt; 键可以打开帮助窗口。

2. 输入 :help cmd 可以找到关于 cmd 命令的帮助。

3. 输入 CTRL-W CTRL-W  可以使您在窗口之间跳转。

4. 输入 :q 以关闭帮助窗口

5. 您可以创建一个 vimrc 启动脚本文件用来保存您偏好的设置。

6. 当输入 : 命令时，按 CTRL-D 可以查看可能的补全结果。
   按 &lt;TAB&gt; 可以使用一个补全。
</pre>

<p>
要精通的话，可以阅读 Vim 的用户手册，使用的命令是： <code>:help user-manual</code>
</p>

<p>
推荐书： Vim - Vi Improved - 作者：Steve Oualline，这是第一本完全讲解 Vim 的书籍。它对于初学者特别有用。其中包含有大量实例和图示。
</p>
</div>
</div>
</div>
</section>
<section id="outline-container-org57f8caf" class="outline-2">
<h2 id="org57f8caf">第4章 用Vim的技术强化Visual Studio Code 体验</h2>
<div class="outline-text-2" id="text-org57f8caf">
</div>
<div id="outline-container-org266c76c" class="outline-3">
<h3 id="org266c76c">把Visual Studio Code变成Vim</h3>
<div class="outline-text-3" id="text-org266c76c">
<p>
visual studio code 痛点：
</p>
<ul class="org-ul">
<li>扩大缩小选择区域快捷键不方便按</li>
<li>常用快捷键被占用，ctrl + 按键被其它的功能占用。</li>
</ul>

<p>
使用 vim 的好处：
</p>
<ul class="org-ul">
<li>输入模式可以输入文本，同时可以结合 ctrl 键结合。</li>
<li>正常（nomarl）模式 不能输入文本，解放了单字母键使用，如 hjkl 可以上下左右移动、文本操作命令。</li>
</ul>

<p>
安装 vim 插件：
</p>
<ul class="org-ul">
<li>使用 <code>ctrl + shift + p</code> 输入 <code>install extensions</code> 在扩展中输入 vim 安装，之后就是 vim 中使用了。</li>
</ul>

<p>
模式显示在左下角
</p>
</div>
</div>
<div id="outline-container-orgc1ee8ad" class="outline-3">
<h3 id="orgc1ee8ad">设置全局快捷键</h3>
<div class="outline-text-3" id="text-orgc1ee8ad">
<p>
比较关键，vscode 默认的是比较难按的。
</p>
</div>
<div id="outline-container-org6aca086" class="outline-4">
<h4 id="org6aca086">全局快捷键设置</h4>
<div class="outline-text-4" id="text-org6aca086">
<p>
不依赖 vim 。
</p>

<p>
<code>ctrl + shift + p</code> 输入 <code>shortcuts=，找到 =Preferences: Open Keyboadrd Shortcuts(JSON)</code> 在打开的keybindings.json文件中添加
</p>

<p>
修改完文件会立即生效的。
</p>


<p>
例如：f12打开关闭操控面板panel
</p>

<div class="org-src-container">
<pre class="src src-shell">// &#23558;&#38190;&#32465;&#23450;&#25918;&#22312;&#27492;&#25991;&#20214;&#20013;&#20197;&#35206;&#30422;&#40664;&#35748;&#20540;
[
    {
        <span style="color: #8b2252;">"key"</span>: <span style="color: #8b2252;">"F12"</span>,
        <span style="color: #8b2252;">"command"</span>: <span style="color: #8b2252;">"workbench.action.togglePanel"</span>,
    }
]
</pre>
</div>


<ul class="org-ul">
<li>找到command全称： <code>ctrl + shift + p</code> 输入 <code>default</code> 找到 <code>Preferences: Open Default Keyboard Shortcuts</code></li>
<li>看看command是干什么的：如 togglePanel， <code>ctrl + shift + p</code> 输入 toggle panel</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org5822437" class="outline-3">
<h3 id="org5822437">代码导航相关全局快捷键优化</h3>
<div class="outline-text-3" id="text-org5822437">
<p>
设置几个必须的和vim兼容的，主要在代码导航时方便些
</p>


<div class="org-src-container">
<pre class="src src-shell">// &#23558;&#38190;&#32465;&#23450;&#25918;&#22312;&#27492;&#25991;&#20214;&#20013;&#20197;&#35206;&#30422;&#40664;&#35748;&#20540;
[
    {
        <span style="color: #8b2252;">"key"</span>: <span style="color: #8b2252;">"F12"</span>,
        <span style="color: #8b2252;">"command"</span>: <span style="color: #8b2252;">"workbench.action.togglePanel"</span>,
    },
    {
        <span style="color: #8b2252;">"key"</span>: <span style="color: #8b2252;">"Ctrl+]"</span>,
        <span style="color: #8b2252;">"command"</span>: <span style="color: #8b2252;">"editor.action.goToTypeDefinition"</span>,
    },
    {
        <span style="color: #8b2252;">"key"</span>: <span style="color: #8b2252;">"Ctrl+T"</span>,
        <span style="color: #8b2252;">"command"</span>: <span style="color: #8b2252;">"workbench.action.navigateBack"</span>,
    },
 {
  <span style="color: #8b2252;">"key"</span>: <span style="color: #8b2252;">"Ctrl+F12"</span>,
  <span style="color: #8b2252;">"command"</span>: <span style="color: #8b2252;">"workbench.action.toggleMaximizedPanel"</span>
}
]
</pre>
</div>


<ul class="org-ul">
<li>F12 ：打开关闭控制面板。搜索根目录中包含字符串的文件。</li>
<li>ctrl + ] ：跳到类型定义。和vim保持一致，vim中也设置这样的快捷键</li>
<li>ctrl + T：跳回。和vim保持一致，vim中也设置这样的快捷键</li>
</ul>

<p>
<b>vim 中 跳转到文件和变量声明</b>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">:help tagsrch.txt</span>
CTRL-]&#65306;&#36339;&#21040;&#31867;&#22411;&#23450;&#20041;
CTRL-t&#65306;&#36339;&#22238;

<span style="color: #b22222;"># </span><span style="color: #b22222;">:help pattern.txt</span>
gd       <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36339;&#36716;&#21040;&#23450;&#20041; go to declaration</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">:help motion.txt</span>
CTRL-O &#24102;&#24744;&#36339;&#36716;&#22238;&#36739;&#26087;&#30340;&#20301;&#32622;&#12290;&#21487;&#36339;&#21040;&#19978;&#19968;&#20010;&#25991;&#20214;&#25628;&#32034;&#30340;&#26087;&#25628;&#32034;&#20301;&#32622;&#65292;&#21487;&#22810;&#27425;&#25805;&#20316;
CTRL-I &#21017;&#24102;&#24744;&#21040;&#36739;&#26032;&#30340;&#20301;&#32622;&#12290;&#21487;&#36339;&#21040;&#19979;&#19968;&#20010;&#25991;&#20214;&#25628;&#32034;&#30340;&#26032;&#25628;&#32034;&#20301;&#32622;&#65292;&#21487;&#22810;&#27425;&#25805;&#20316;
</pre>
</div>
</div>
</div>
<div id="outline-container-orge330f68" class="outline-3">
<h3 id="orge330f68">Visual Studio Code的全部设置</h3>
<div class="outline-text-3" id="text-orge330f68">
<p>
完整配置参考：<a href="https://github.com/redguardtoo/vscode-setup">https://github.com/redguardtoo/vscode-setup</a>
</p>

<p>
安装好 vim 插件后，优化 vim 的快捷键
</p>

<p>
打开首选项：打开设置(json)。 <code>ctrl + shift + p</code> 输入 settings,  选择 <code>open json</code>  设置 用户settings.json。
如果想知道配置文件路径，可以使用 <code>Copy path of active File</code> 来查看当前活动文件路径。
</p>

<p>
完整文件内容：
</p>
<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"vim.easymotion"</span>: true,
  <span style="color: #8b2252;">"vim.sneak"</span>: true,
  <span style="color: #8b2252;">"vim.visualstar"</span>: true,  // &#24320;&#21551; * <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25628;&#32034;</span>
  <span style="color: #8b2252;">"vim.ignorecase"</span>: false,
  <span style="color: #8b2252;">"vim.useSystemClipboard"</span>: true,
  <span style="color: #8b2252;">"vim.useCtrlKeys"</span>: true,
  <span style="color: #8b2252;">"vim.hlsearch"</span>: true,
  <span style="color: #8b2252;">"vim.insertModeKeyBindings"</span>: [
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"k"</span>,<span style="color: #8b2252;">"j"</span>], //  &#25554;&#20837;&#27169;&#24335;&#19979; &#25353; k j &#20195;&#34920; ecs &#36864;&#20986;&#21040;&#26222;&#36890;&#27169;&#24335;
      <span style="color: #8b2252;">"after"</span>: [<span style="color: #8b2252;">"&lt;Esc&gt;"</span>]
    }
  ],
  <span style="color: #8b2252;">"vim.leader"</span>: <span style="color: #8b2252;">","</span>,
  <span style="color: #8b2252;">"vim.visualModeKeyBindingsNonRecursive"</span>: [
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"v"</span>],  // &#25193;&#22823;&#36873;&#20013;&#30340;&#21306;&#22495;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.smartSelect.expand"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"%"</span>],  // &#20248;&#21270;%&#31526;&#21495;&#36339;&#36716;&#21151;&#33021;&#65292;&#38656;&#23433;&#35013;&#25554;&#20214; matchit
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"extension.matchitJumpItems"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"x"</span>],  // &#25193;&#22823;&#36873;&#20013;&#30340;&#21306;&#22495;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.smartSelect.expand"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"z"</span>, <span style="color: #8b2252;">"z"</span>], // &#32553;&#36873;&#20013;&#30340;&#21306;&#22495;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.smartSelect.shrink"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"c"</span>, <span style="color: #8b2252;">"i"</span>], // &#27880;&#37322;&#34892;&#65292;&#24555;&#25463;&#38190;&#21629;&#21517;&#26469;&#33258;&#20110; vim &#25554;&#20214; nerd-commenter
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.commentLine"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader"</span>, <span style="color: #8b2252;">"a"</span>, <span style="color: #8b2252;">"a"</span>], // ctrl-c &#22797;&#21046;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.clipboardCopyAction"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"q"</span>, <span style="color: #8b2252;">"q"</span>], // &#39033;&#30446;&#20013;&#22810;&#20010;&#25991;&#20214;&#25991;&#26412;&#26597;&#25214;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.findInFiles"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"s"</span>, <span style="color: #8b2252;">"s"</span>],  // &#24403;&#21069;&#25991;&#20214;&#25628;&#32034;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"actions.find"</span>]
    }
  ],
  <span style="color: #8b2252;">"vim.normalModeKeyBindingsNonRecursive"</span>: [
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"r"</span>, <span style="color: #8b2252;">"v"</span>],
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.rename"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"q"</span>, <span style="color: #8b2252;">"q"</span>], // &#39033;&#30446;&#20013;&#26597;&#25214;&#26367;&#25442;&#22810;&#20010;&#25991;&#20214;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.findInFiles"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"f"</span>, <span style="color: #8b2252;">"p"</span>],  // &#25335;&#36125;&#24403;&#21069;&#25991;&#20214;&#36335;&#24452;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.files.copyPathOfActiveFile"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"f"</span>, <span style="color: #8b2252;">"n"</span>],
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"copyRelativeFilePath"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"t"</span>, <span style="color: #8b2252;">"p"</span>], // &#25171;&#24320;&#19979;&#25289;&#33756;&#21333;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.togglePanel"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"m"</span>], // &#26174;&#31034;&#21629;&#20196;&#38754;&#26495;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.showCommands"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"c"</span>, <span style="color: #8b2252;">"i"</span>], // &#27880;&#37322;&#34892;&#65292;&#24555;&#25463;&#38190;&#21629;&#21517;&#26469;&#33258;&#20110; vim &#25554;&#20214; nerd-commenter
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.commentLine"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"x"</span>], // &#25193;&#22823;&#36873;&#20013;&#30340;&#21306;&#22495;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.smartSelect.expand"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"z"</span>, <span style="color: #8b2252;">"z"</span>], // &#32553;&#36873;&#20013;&#30340;&#21306;&#22495;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.smartSelect.shrink"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"t"</span>, <span style="color: #8b2252;">"a"</span>], // &#26174;&#31034;&#27963;&#21160;&#26639;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.toggleActivityBarVisibility"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"t"</span>, <span style="color: #8b2252;">"b"</span>], // &#26174;&#31034;&#20027;&#20391;&#36793;&#26639;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.toggleSidebarVisibility"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"s"</span>], // &#20445;&#23384;&#25991;&#20214;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.files.save"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"s"</span>, <span style="color: #8b2252;">"s"</span>], // &#24403;&#21069;&#25991;&#20214;&#25628;&#32034;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"actions.find"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"%"</span>], // &#20248;&#21270;%&#31526;&#21495;&#36339;&#36716;&#21151;&#33021;&#65292;&#38656;&#23433;&#35013;&#25554;&#20214; matchit
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"extension.matchitJumpItems"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"s"</span>, <span style="color: #8b2252;">"i"</span>],
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"extension.matchitSelectItems"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"d"</span>, <span style="color: #8b2252;">"i"</span>],
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"extension.matchitDeleteItems"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"f"</span>],  // &#25171;&#24320;&#25991;&#20214;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.files.openFile"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>, <span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"k"</span>],
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.closeActiveEditor"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"r"</span>, <span style="color: #8b2252;">"r"</span>],  // &#26368;&#36817;&#35775;&#38382;&#25991;&#20214;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.openRecent"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"k"</span>, <span style="color: #8b2252;">"k"</span>], // &#25171;&#24320;&#39033;&#30446;&#20013;&#20219;&#24847;&#25991;&#20214;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.quickOpen"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"i"</span>, <span style="color: #8b2252;">"i"</span>], // &#36716;&#21040;&#32534;&#36753;&#22120;&#20013;&#30340;&#31526;&#21495;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.gotoSymbol"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"1"</span>], // &#20165;&#19968;&#20010;&#31383;&#21475;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.editorLayoutSingle"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"3"</span>], // &#21521;&#21491;&#22402;&#30452;&#20998;&#23631;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.splitEditorRight"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"2"</span>], // &#21521;&#19979;&#27700;&#24179;&#20998;&#23631;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.splitEditorDown"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"4"</span>], // &#20998; 2*2 &#31383;&#21475;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.editorLayoutTwoByTwoGrid"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"0"</span>], // &#20851;&#38381;&#20998;&#32452;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.closeGroup"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"z"</span>], // &#25171;&#24320;&#32456;&#31471;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.terminal.focus"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"f"</span>, <span style="color: #8b2252;">"f"</span>], // &#31109;&#27169;&#24335;
      <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.toggleZenMode"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"w"</span>, <span style="color: #8b2252;">"h"</span>], // &#31227;&#21160;&#21040;&#24038;&#31383;&#21475;
      <span style="color: #8b2252;">"after"</span>: [<span style="color: #8b2252;">"&lt;C-w&gt;"</span>, <span style="color: #8b2252;">"h"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"w"</span>, <span style="color: #8b2252;">"j"</span>],
      <span style="color: #8b2252;">"after"</span>: [<span style="color: #8b2252;">"&lt;C-w&gt;"</span>, <span style="color: #8b2252;">"j"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"w"</span>, <span style="color: #8b2252;">"k"</span>],
      <span style="color: #8b2252;">"after"</span>: [<span style="color: #8b2252;">"&lt;C-w&gt;"</span>, <span style="color: #8b2252;">"k"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"w"</span>, <span style="color: #8b2252;">"l"</span>],
      <span style="color: #8b2252;">"after"</span>: [<span style="color: #8b2252;">"&lt;C-w&gt;"</span>, <span style="color: #8b2252;">"l"</span>]
    },
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"w"</span>, <span style="color: #8b2252;">"q"</span>],
      <span style="color: #8b2252;">"after"</span>: [<span style="color: #8b2252;">":wq"</span>],
    }
  ],
  <span style="color: #8b2252;">"vim.handleKeys"</span>:{
    <span style="color: #8b2252;">"&lt;C-a&gt;"</span>: false,
  },
  <span style="color: #8b2252;">"zenMode.centerLayout"</span>: false,
  <span style="color: #8b2252;">"window.zoomLevel"</span>: 1,
  <span style="color: #8b2252;">"editor.minimap.enabled"</span>: false,
  <span style="color: #8b2252;">"search.exclude"</span>: {
    <span style="color: #8b2252;">"**/.git"</span>: true,
    <span style="color: #8b2252;">"**/*.bundle.js"</span>: true,
    <span style="color: #8b2252;">"**/bin-packages"</span>: true,
    <span style="color: #8b2252;">"**/frontend-dist"</span>: true,
    <span style="color: #8b2252;">"**/npm-packages-offline-cache"</span>: true
  },
  <span style="color: #8b2252;">"search.useGlobalIgnoreFiles"</span>: true,
  <span style="color: #8b2252;">"search.location"</span>: <span style="color: #8b2252;">"panel"</span>,  // &#24323;&#29992;&#65292;&#25628;&#32034;&#19979;&#31227;&#65292;&#26032;&#29256;&#26412;&#25163;&#21160;&#25302;&#25341;&#26041;&#24335;
  <span style="color: #8b2252;">"workbench.activityBar.visible"</span>: false,
  <span style="color: #8b2252;">"files.autoSave"</span>: <span style="color: #8b2252;">"afterDelay"</span>,
  <span style="color: #8b2252;">"workbench.colorTheme"</span>: <span style="color: #8b2252;">"Solarized Dark"</span>,
  <span style="color: #8b2252;">"workbench.statusBar.visible"</span>: true,
  <span style="color: #8b2252;">"editor.renderWhitespace"</span>: <span style="color: #8b2252;">"none"</span>,
  <span style="color: #8b2252;">"editor.renderControlCharacters"</span>: false,
  <span style="color: #8b2252;">"window.titleBarStyle"</span>: <span style="color: #8b2252;">"native"</span>,
  <span style="color: #8b2252;">"editor.renderLineHighlight"</span>: <span style="color: #8b2252;">"none"</span>,
  <span style="color: #8b2252;">"extensions.ignoreRecommendations"</span>: true,
  <span style="color: #8b2252;">"editor.occurrencesHighlight"</span>: false
}
</pre>
</div>

<p>
说明
</p>


<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#35774;&#32622;leader&#38190;&#20026; , &#36887;&#21495;</span>
 <span style="color: #8b2252;">"vim.leader"</span>: <span style="color: #8b2252;">","</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25554;&#20837;&#27169;&#24335;&#19979; &#25353; k j &#20195;&#34920; ecs &#36864;&#20986;&#21040;&#26222;&#36890;&#27169;&#24335;</span>
  <span style="color: #8b2252;">"vim.insertModeKeyBindings"</span>: [
    {
      <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"k"</span>,<span style="color: #8b2252;">"j"</span>],
      <span style="color: #8b2252;">"after"</span>: [<span style="color: #8b2252;">"&lt;Esc&gt;"</span>]
    }
  ],

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#35270;&#22270;&#27169;&#24335;&#20013;&#20351;&#29992;</span>
  <span style="color: #8b2252;">"vim.visualModeKeyBindingsNonRecursive"</span>: [
...
   ]
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#26222;&#36890;&#27169;&#24335;&#20013;&#20351;&#29992;</span>
 <span style="color: #8b2252;">"vim.normalModeKeyBindingsNonRecursive"</span>: [
 ...
   ]
</pre>
</div>

<p>
后面会讲解每个快捷键要完成的任务。
</p>
</div>
</div>
<div id="outline-container-orgfadb616" class="outline-3">
<h3 id="orgfadb616">File菜单的优化</h3>
<div class="outline-text-3" id="text-orgfadb616">
<p>
普通模式下
</p>
</div>
<div id="outline-container-orgdef816b" class="outline-4">
<h4 id="orgdef816b">最近访问文件</h4>
<div class="outline-text-4" id="text-orgdef816b">
<p>
=,rr-
</p>

<ul class="org-ul">
<li>最近访问文件：对应file&#x2013;&gt;最近&#x2013;&gt;更多</li>
</ul>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"vim.normalModeKeyBindingsNonRecursive"</span>: [
  {
    <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"r"</span>, <span style="color: #8b2252;">"r"</span>],
    <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.openRecent"</span>]
  },
 ]
</pre>
</div>
</div>
</div>
<div id="outline-container-orgde47030" class="outline-4">
<h4 id="orgde47030">打开文件</h4>
<div class="outline-text-4" id="text-orgde47030">
<p>
<code>,xf</code>
</p>

<ul class="org-ul">
<li>打开文件：和 emacs 中 <code>C-x C-f</code> 类似</li>
</ul>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"vim.normalModeKeyBindingsNonRecursive"</span>: [
  {
    <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"f"</span>],
    <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.files.openFile"</span>]
  },
 ]
</pre>
</div>
</div>
</div>
<div id="outline-container-org122a67a" class="outline-4">
<h4 id="org122a67a">保存文件</h4>
<div class="outline-text-4" id="text-org122a67a">
<p>
<code>,xs</code>
</p>

<ul class="org-ul">
<li>保存文件：按键和emacs中 <code>c-x c-s</code> 相似，方便记忆</li>
</ul>

<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"s"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.files.save"</span>]
},
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org215fd83" class="outline-3">
<h3 id="org215fd83">Edit菜单下优化</h3>
<div class="outline-text-3" id="text-org215fd83">
</div>
<div id="outline-container-org8ca2528" class="outline-4">
<h4 id="org8ca2528">Edit菜单下 Undo/Redo和剪贴板操作</h4>
<div class="outline-text-4" id="text-org8ca2528">
<p>
使用 vim 中的操作方式：
</p>

<p>
undo/redo:
</p>
<ul class="org-ul">
<li>u 撤销最近的更改，相当于windows中ctrl+z</li>
<li>大U 撤消光标落在这行后所有此行的更改</li>
<li>Ctrl - r 重做最后的“撤消”更改，相当于windows中crtl+y</li>
</ul>

<p>
剪贴：
</p>
<ul class="org-ul">
<li>x：vim 中剪贴，d 也是删除</li>
</ul>

<p>
复制yink：
</p>
<ul class="org-ul">
<li>选中区域按 y  复制 ，yy 复制当前行</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>, <span style="color: #8b2252;">"a"</span>, <span style="color: #8b2252;">"a"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.clipboardCopyAction"</span>]
},
</pre>
</div>


<p>
粘贴:
</p>
<ul class="org-ul">
<li>按 p</li>
</ul>

<p>
额外说明：
</p>

<p>
剪切操作： vs code vim 插件的剪贴和系统剪贴板合成一个了，原始 vim 是分开的。所以选中文件按 y(yink) 等价于把文本内容拷贝到剪切板了，按 p 相当于剪切板中 paste 操作。
</p>
</div>
</div>
<div id="outline-container-org37f17ca" class="outline-4">
<h4 id="org37f17ca">Edit菜单下查找替换的优化，学习正则表达式</h4>
<div class="outline-text-4" id="text-org37f17ca">
</div>
<div id="outline-container-org655843f" class="outline-5">
<h5 id="org655843f">查找字符</h5>
<div class="outline-text-5" id="text-org655843f">
<p>
<code>,ss</code>
</p>

<p>
或使用 vim 自带的 <code>/</code> 搜索
</p>

<p>
视图和普通模式下
</p>
<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"s"</span>, <span style="color: #8b2252;">"s"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"actions.find"</span>]
},
</pre>
</div>

<p>
推荐选中正则模式来搜索，如 <code>w.*</code>
</p>

<p>
vs 正则手册(30分钟)
<a href="https://docs.microsoft.com/en-us/visualstudio/ide/using-regular-expressions-in-visual-studio?view=vs-2022">https://docs.microsoft.com/en-us/visualstudio/ide/using-regular-expressions-in-visual-studio?view=vs-2022</a>
</p>
</div>
</div>
<div id="outline-container-org0e4ca52" class="outline-5">
<h5 id="org0e4ca52">替换</h5>
<div class="outline-text-5" id="text-org0e4ca52">
<p>
vim 插件
</p>

<div class="org-src-container">
<pre class="src src-shell">world
:%s*(wor)(ld)*$<span style="color: #a0522d;">1</span>=$<span style="color: #a0522d;">2</span>*g
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#21407;&#29983;&#30340; vim &#21644; emacs &#20013;</span>
:%s*<span style="color: #8b2252;">\(</span>wor<span style="color: #8b2252;">\)\(</span>ld<span style="color: #8b2252;">\)</span>*\<span style="color: #a0522d;">1</span>=\2*g
</pre>
</div>

<ul class="org-ul">
<li>在 emcas 中快速选中区域可以使用 <a href="https://melpa.org/#/evil-matchit">evil-matchit</a> <code>,si</code>   原生的为 <code>c-@</code> 到 选中区域， 同时在缩小区域中 narrow-to-region</li>
<li>emcacs 中替换 evil  <code>'&lt;,'&gt;s/\&lt;\(char1\)\&gt;/char2/g</code> ，退出缩小模式 <code>widen C-x n w</code></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org538c7d2" class="outline-4">
<h4 id="org538c7d2">Edit菜单下注释的优化，行选择的技巧</h4>
<div class="outline-text-4" id="text-org538c7d2">
<p>
`,ci`
</p>

<p>
视图和普通模式下
</p>

<p>
快捷键来自于 vim 插件 nerd-commenter，但有些人认为 <code>,cc</code> 更方便些。
</p>
<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"c"</span>, <span style="color: #8b2252;">"i"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.commentLine"</span>]
      },
</pre>
</div>

<p>
结合 vim 注释3行： <code>V3j</code> + <code>,ci</code>
</p>

<p>
结合 emacs 注释3行： <code>C-u 4</code> + <code>,ci</code>
</p>
</div>
</div>
<div id="outline-container-org49d9e43" class="outline-4">
<h4 id="org49d9e43">Edit菜单下项目中查找替换多个文件的高级技巧</h4>
<div class="outline-text-4" id="text-org49d9e43">
</div>
<div id="outline-container-org4374ebb" class="outline-5">
<h5 id="org4374ebb">多文件文本查找</h5>
<div class="outline-text-5" id="text-org4374ebb">
<p>
<code>,qq</code>
</p>

<p>
视图和普通模式下
</p>
<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"q"</span>, <span style="color: #8b2252;">"q"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.findInFiles"</span>]
},
</pre>
</div>
</div>
</div>
<div id="outline-container-org7f2fd4f" class="outline-5">
<h5 id="org7f2fd4f">多文件文本替换</h5>
<div class="outline-text-5" id="text-org7f2fd4f">
<p>
范例：在多文本替换中，将 p1 替换为 project1
</p>

<div class="org-src-container">
<pre class="src src-shell">,qq &#25628;&#32034;&#23383;&#31526;&#24182;&#36873;&#20013;&#27491;&#21017;&#27169;&#24335;
&#21305;&#37197;&#65306;(p)([0-9])
&#26367;&#25442;&#20026;&#65306;$<span style="color: #a0522d;">1</span>roject$<span style="color: #a0522d;">2</span>  <span style="color: #b22222;"># </span><span style="color: #b22222;">$0  &#25972;&#20010;&#21305;&#37197;&#30340;&#27169;&#24335;&#65292; &#21407;&#29983; vim &#20013;&#20026; &amp;</span>
&#28857;&#20987;replace all &#26367;&#25442;&#25152;&#26377;&#12290;
F12  &#20851;&#38381;&#19979;&#25289;&#38754;&#26495;
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org50eb818" class="outline-3">
<h3 id="org50eb818">Selection菜单下选择文本的高级技巧</h3>
<div class="outline-text-3" id="text-org50eb818">
<ul class="org-ul">
<li>全选：C-a</li>
</ul>
</div>
<div id="outline-container-org3381c64" class="outline-4">
<h4 id="org3381c64">扩大选中的区域</h4>
<div class="outline-text-4" id="text-org3381c64">
<p>
<code>,xx</code>
</p>

<p>
视图模式和普通模式
</p>
<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"x"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.smartSelect.expand"</span>]
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org9785baf" class="outline-4">
<h4 id="org9785baf">缩小选区</h4>
<div class="outline-text-4" id="text-org9785baf">
<p>
<code>,zz</code>
</p>

<p>
视图模式
</p>
<div class="org-src-container">
<pre class="src src-shell">{
   <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"z"</span>, <span style="color: #8b2252;">"z"</span>],
   <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"editor.action.smartSelect.shrink"</span>]
 },
</pre>
</div>

<p>
emacs  支持 key map 更方便，如：
</p>

<pre class="example" id="org274f732">
扩大选择区: ,xx  再按x扩大
缩小选区: z
恢复：0
</pre>
</div>
</div>
<div id="outline-container-org0677f1e" class="outline-4">
<h4 id="org0677f1e">复制行</h4>
<div class="outline-text-4" id="text-org0677f1e">
<p>
vim 中 `yy  p`
</p>
</div>
</div>
<div id="outline-container-orgbfa3f6f" class="outline-4">
<h4 id="orgbfa3f6f">多光标操作</h4>
<div class="outline-text-4" id="text-orgbfa3f6f">
<p>
使用 vim 代替
</p>


<ul class="org-ul">
<li>列编辑
ctrl + v 向下移动， 大写 I 输入</li>

<li>text object文件对象
<ul class="org-ul">
<li><a href="https://blog.carbonfive.com/vim-text-objects-the-definitive-guide/">https://blog.carbonfive.com/vim-text-objects-the-definitive-guide/</a></li>
</ul></li>
</ul>

<pre class="example" id="org12ea571">
[number]&lt;operator&gt;[text object or motion]
&lt;数字&gt; &lt;操作符&gt; &lt;文本对象或移动命令&gt;

vit 选中tag内的
vat 选中包含tag

vi{ 选中括号内的
va{ 选中括号内的，包含括号

# 安装 vim-surround 插件后
cs`" 替换`为“  * vs code 中生效
ysw"  单词加绰号。 vs code 中生效。
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc25229a" class="outline-3">
<h3 id="orgc25229a">View菜单下子窗口高级技巧</h3>
<div class="outline-text-3" id="text-orgc25229a">
</div>
<div id="outline-container-org71cacae" class="outline-4">
<h4 id="org71cacae">命令面板</h4>
<div class="outline-text-4" id="text-org71cacae">
<p>
<code>,xm</code>
</p>

<p>
即 vs code 中 <code>ctrl + shift + p</code>
</p>

<p>
普通模式下，
</p>

<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"m"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.showCommands"</span>]
},
</pre>
</div>
</div>
</div>
<div id="outline-container-orge768249" class="outline-4">
<h4 id="orge768249">禅模式</h4>
<div class="outline-text-4" id="text-orge768249">
<p>
<code>,ff</code>
</p>

<p>
ctrl k z 重要
</p>

<p>
普通模式
</p>

<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"f"</span>, <span style="color: #8b2252;">"f"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.toggleZenMode"</span>]
},
</pre>
</div>
</div>
</div>
<div id="outline-container-orge83a7d9" class="outline-4">
<h4 id="orge83a7d9">分屏</h4>
<div class="outline-text-4" id="text-orge83a7d9">
<p>
<code>,x1  ,x2 ,x3 ,x4 ,x0</code>
</p>

<p>
普通模式，1个屏，右分割，水平分割，开4个子窗口，关闭当前窗口
跟 emacs 类似
</p>

<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"1"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.editorLayoutSingle"</span>]
},
{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"3"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.splitEditorRight"</span>]
},
{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"2"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.splitEditorDown"</span>]
},
{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"4"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.editorLayoutTwoByTwoGrid"</span>]
},
{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"x"</span>, <span style="color: #8b2252;">"0"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.closeGroup"</span>]
},
</pre>
</div>

<p>
vim 中的分屏操作
</p>

<pre class="example" id="org160f301">
Ctrl+w,s：水平分割，上下分屏。或者:sp
Ctrl+w,v：垂直分割，左右分屏，或者:vs

:close 关闭当前窗口
:only 关闭除当前窗口以外的所有窗口

Ctrl+w c   关闭分屏  关闭当前窗口
Ctrl+w，方向键 : 窗口间切换

&lt;C-w&gt;w 在窗口循环切换。如&lt;C-w&gt;&lt;C-w&gt;&lt;C-w&gt;&lt;C-w&gt;
&lt;C-w&gt;h 切换到左边的窗口
&lt;C-w&gt;j 切换到下边的窗口
&lt;C-w&gt;k 切换到上边的窗口
&lt;C-w&gt;l 切换到右边的窗口
*移动
&lt;C-w&gt;L 左边窗口移动到右边
&lt;C-w&gt;H 右边窗口移动到左边
</pre>
</div>
</div>
</div>
<div id="outline-container-org4387295" class="outline-3">
<h3 id="org4387295">Go菜单下高级技巧</h3>
<div class="outline-text-3" id="text-org4387295">
</div>
<div id="outline-container-org338c840" class="outline-4">
<h4 id="org338c840">回退</h4>
<div class="outline-text-4" id="text-org338c840">
<p>
<code>Ctrl + t</code>
和 vim emacs 保持兼容
</p>

<div class="org-src-container">
<pre class="src src-shell">ctrl + shift + p
&#36755;&#20837; shortcuts&#65292;&#25214;&#21040; Preferences: Open Keyboadrd Shortcuts(JSON)
&#22312;&#25171;&#24320;&#30340;keybindings.json&#25991;&#20214;&#20013;&#28155;&#21152;
    {
        <span style="color: #8b2252;">"key"</span>: <span style="color: #8b2252;">"Ctrl+T"</span>,
        <span style="color: #8b2252;">"command"</span>: <span style="color: #8b2252;">"workbench.action.navigateBack"</span>,
    }
</pre>
</div>
</div>
</div>
<div id="outline-container-org44b1ef2" class="outline-4">
<h4 id="org44b1ef2">转到类定义</h4>
<div class="outline-text-4" id="text-org44b1ef2">
<p>
<code>Ctrl + ]</code> 和 vim emacs 保持兼容
</p>

<div class="org-src-container">
<pre class="src src-shell">ctrl + shift + p
&#36755;&#20837; shortcuts&#65292;&#25214;&#21040; Preferences: Open Keyboadrd Shortcuts(JSON)
&#22312;&#25171;&#24320;&#30340;keybindings.json&#25991;&#20214;&#20013;&#28155;&#21152;
    {
        <span style="color: #8b2252;">"key"</span>: <span style="color: #8b2252;">"Ctrl+]"</span>,
        <span style="color: #8b2252;">"command"</span>: <span style="color: #8b2252;">"editor.action.goToTypeDefinition"</span>,
    },
</pre>
</div>
</div>
</div>
<div id="outline-container-org9343c8e" class="outline-4">
<h4 id="org9343c8e">上次搜索位置</h4>
<div class="outline-text-4" id="text-org9343c8e">
<p>
使用 vim 的操作
</p>

<pre class="example" id="org9bb7a94">
CTRL-O 带您跳转回较旧的位置。可跳到上一个文件搜索的旧搜索位置，可多次操作
CTRL-I 则带您到较新的位置。可跳到下一个文件搜索的新搜索位置，可多次操作
</pre>
</div>
</div>
<div id="outline-container-orgd22b727" class="outline-4">
<h4 id="orgd22b727">搜索并打开项目中任意文件</h4>
<div class="outline-text-4" id="text-orgd22b727">
<p>
<code>,kk</code>
</p>

<p>
普通模式
</p>

<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"k"</span>, <span style="color: #8b2252;">"k"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.quickOpen"</span>]
},
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc725821" class="outline-4">
<h4 id="orgc725821">定位及文件状态-行跳</h4>
<div class="outline-text-4" id="text-orgc725821">
<p>
使用 vim 操作
</p>

<pre class="example" id="orgf422006">
G 最后一行
1G, gg 第一行
4gg, :4  第4行

输入 CTRL-G 显示当前编辑文件中当前光标所在行位置以及文件状态信息
</pre>
</div>
</div>
<div id="outline-container-h:vscode-symbol-jump" class="outline-4">
<h4 id="h:vscode-symbol-jump">在配对的符号间跳转的高级技巧</h4>
<div class="outline-text-4" id="text-h:vscode-symbol-jump">
<p>
转到括号 Go to Bracket，非常重要，使用 vim 中的操作：
</p>
<ul class="org-ul">
<li>光标放在当前标记下 <code>(、)、[、]、{、}</code> ，按 <code>%</code> 查找配对的标记，再按可跳回配对标记</li>
</ul>

<p>
范例：使用场景，在选中区域中替换
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#21407;&#25991;</span>
<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">minus</span>(var1) {
    const delta = 5;
    const b;
    const <span style="color: #a0522d;">r</span>= var1 + delta
    <span style="color: #a020f0;">return</span> r;
}

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36873;&#20013;&#21253;&#21547;{}&#30340;&#20869;&#23481;</span>
&#20809;&#26631;&#22312;{&#65292;&#25353; v% &#36873;&#20013;

<span style="color: #b22222;"># </span><span style="color: #b22222;">,ss &#25628;&#32034; delta</span>
* ctrl + h &#26367;&#25442;&#20026; alpha
</pre>
</div>


<p>
但存在一些问题，如光标必须在指定位置，不支持 html 标记，目前可用 matchit 插件解决，作者chenbin。emacs 中作者也写了一样的插件 evil-matchit
</p>

<pre class="example" id="org88af4e4">
matchit jump items 跳到标记结尾
matchit select items 选中整个函数开头结尾
matchit delete items
</pre>


<p>
添加settings.json配置
</p>

<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"%"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"extension.matchitJumpItems"</span>]
},
</pre>
</div>
</div>
</div>
<div id="outline-container-org75b5c92" class="outline-4">
<h4 id="org75b5c92">代码自动完成的高级技巧</h4>
<div class="outline-text-4" id="text-org75b5c92">
</div>
<div id="outline-container-org19bcd7c" class="outline-5">
<h5 id="org19bcd7c">完成单词</h5>
<div class="outline-text-5" id="text-org19bcd7c">
<p>
vs code 自带的，当输入命令有列表选项，ctrl + n 向下选，ctrl + p 向上选
</p>

<p>
vim 中补全 ctrl + n
</p>
</div>
</div>
<div id="outline-container-org0025c8e" class="outline-5">
<h5 id="org0025c8e">完成行</h5>
<div class="outline-text-5" id="text-org0025c8e">
<p>
vim 中 <code>C-x C-l</code>  整行补全。vs code 使用 vim 插件后同样快捷键
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgee84cab" class="outline-3">
<h3 id="orgee84cab">可选项</h3>
<div class="outline-text-3" id="text-orgee84cab">
</div>
<div id="outline-container-org322de03" class="outline-4">
<h4 id="org322de03">跳转到声明（Go to Declaration）的高级技巧（可选）</h4>
<div class="outline-text-4" id="text-org322de03">
<p>
理论上可选的。但实际上高手都用此技巧。
</p>

<p>
使用 vim
</p>


<pre class="example" id="orgde2194f">
gd       # 跳转到声明 函数或者变量 go to declaration
ctrl + o # 回到原来位置
</pre>


<p>
gd 在 vs code vim 插件内容实现用的 <code>editor.action.goToDeclaration</code>  <a href="https://github.com/VSCodeVim/Vim/pull/530/files">https://github.com/VSCodeVim/Vim/pull/530/files</a>
</p>

<p>
Go to Symbol in Editor:  转到编辑器中的符号
</p>

<p>
视图和普通模式
</p>

<div class="org-src-container">
<pre class="src src-shell">{
  <span style="color: #8b2252;">"before"</span>: [<span style="color: #8b2252;">"&lt;leader&gt;"</span>,<span style="color: #8b2252;">"i"</span>, <span style="color: #8b2252;">"i"</span>],
  <span style="color: #8b2252;">"commands"</span>: [<span style="color: #8b2252;">"workbench.action.gotoSymbol"</span>]
},
</pre>
</div>
</div>
</div>
<div id="outline-container-orge1cf65a" class="outline-4">
<h4 id="orge1cf65a">打开当前光标下的文件的高级技巧（可选）</h4>
<div class="outline-text-4" id="text-orge1cf65a">
<p>
也是可选的。但是高手都爱用。
</p>

<p>
vim 
</p>

<div class="org-src-container">
<pre class="src src-shell">gf  <span style="color: #b22222;"># </span><span style="color: #b22222;">go to file</span>
ctrl + o * &#22238;&#21040;&#21407;&#26469;&#20301;&#32622;
</pre>
</div>
</div>
</div>
<div id="outline-container-org7388cc5" class="outline-4">
<h4 id="org7388cc5">在当前文件搜索文本的高级技巧（可选）</h4>
<div class="outline-text-4" id="text-org7388cc5">
<p>
也是可选的。但是高手都爱用。
</p>


<p>
vim
</p>

<pre class="example" id="org7326639">
* : 标记当前光标单词，跳至下一个出现该单词的地方。关闭高亮用 :set nohls
# : 与*类似，但是从下往上搜索
</pre>

<p>
在视图模式下使用 <code>*, #</code> 搜索
</p>

<pre class="example" id="org5b9d2cd">
* vs code 按了 vim 插件支持，settings.json 配置"vim.visualstar": true
* vim, emacs 要安装 vim-visualstar 插件支持
注意vs code 第一次按 * 星号 或者 # 井号，再使用 n 查找 ，vim/emacs 不存在此问题。
</pre>
</div>
</div>
<div id="outline-container-orgd2685b5" class="outline-4">
<h4 id="orgd2685b5">把VSCode的Vim插件和Neovim结合（可选）</h4>
<div class="outline-text-4" id="text-orgd2685b5">
<p>
可选，如果你已精通Vim和VSCode，希望简化工作流，把查找替换语法统一到Vim的原生语法，可以用此技术。
</p>


<p>
在 vs code 中字符替换还是 javascript 语法，如果使用原生 vim/emacs 支持的语法就需要和 neovim 结合。
</p>

<div class="org-src-container">
<pre class="src src-shell">world
:%s*(wor)(ld)*$<span style="color: #a0522d;">1</span>=$<span style="color: #a0522d;">2</span>*g  * javascript&#35821;&#27861;

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#21407;&#29983;&#30340; vim &#21644; emacs &#20013;</span>
:%s*<span style="color: #8b2252;">\(</span>wor<span style="color: #8b2252;">\)\(</span>ld<span style="color: #8b2252;">\)</span>*\<span style="color: #a0522d;">1</span>=\2*g
</pre>
</div>

<p>
打开首选项：打开设置(json)
</p>

<div class="org-src-container">
<pre class="src src-shell">ctrl + shift + p &#36755;&#20837; settings
&#29992;&#25143;settings.json &#28155;&#21152;&#22914;&#19979;&#20869;&#23481;
<span style="color: #8b2252;">"vim.neovimPath"</span>: <span style="color: #8b2252;">"/usr/bin/nvim"</span>,
<span style="color: #8b2252;">"vim.enableNeovim"</span>: true,
</pre>
</div>

<p>
提前安装 neovim 工具。<a href="https://github.com/neovim/neovim/releases/">https://github.com/neovim/neovim/releases/</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org610f4b0" class="outline-3">
<h3 id="org610f4b0">小结</h3>
<div class="outline-text-3" id="text-org610f4b0">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#35774;&#32622;leader&#38190;&#20026; , &#36887;&#21495;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25554;&#20837;&#27169;&#24335;&#19979; &#25353; k j &#20195;&#34920; ecs &#36864;&#20986;&#21040;&#26222;&#36890;&#27169;&#24335;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25991;&#20214;&#25805;&#20316; &#20165;&#26222;&#36890;&#27169;&#24335;</span>
&#26368;&#36817;&#35775;&#38382;&#25991;&#20214;&#65306;,rr 
&#25171;&#24320;&#25991;&#20214;&#65306;,xf &#21644; emacs &#20013; <span style="color: #ff00ff;">`C-x C-f`</span> &#31867;&#20284;
&#20445;&#23384;&#25991;&#20214;&#65306;,xs &#21644;emacs&#20013;<span style="color: #ff00ff;">`c-x c-s`</span>&#30456;&#20284;

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#32534;&#36753;&#25805;&#20316;</span>
undo/redo&#65306;vim &#25805;&#20316; uU/C-r&#12290; . &#28857;&#21495;&#37325;&#22797;&#25805;&#20316;&#65292;:e! &#25991;&#26723;&#36824;&#21407;&#21040;&#26368;&#21407;&#22987;&#29366;&#24577;
&#21098;&#36148;&#65306;vim &#20013; x&#12290;d &#20063;&#26159;&#21024;&#38500;
&#22797;&#21046;&#65306;,aa &#36873;&#20013;&#22797;&#21046;&#12290;&#20165;&#35270;&#22270;&#27169;&#24335;&#12290;vim &#20013; yy &#22797;&#21046;&#24403;&#21069;&#34892;&#65307;&#36873;&#20013; <span style="color: #8b2252;">"+y &#20174; vim &#25335;&#36125;&#21040;&#31995;&#32479;&#21098;&#20999;&#26495;&#65292;"</span>+p &#31995;&#32479;&#21040; vim
&#31896;&#36148;&#65306;vim &#20013; p
&#26597;&#25214;&#23383;&#31526;&#65306;,ss &#12290;vim &#20013; / &#12290;&#35270;&#22270;&#21644;&#26222;&#36890;&#27169;&#24335;&#19979;
&#26367;&#25442;&#65306;: :%s*(wor)(ld)*$<span style="color: #a0522d;">1</span>=$<span style="color: #a0522d;">2</span>*g  &#65292;&#21407;&#29983; vim &#20026; :%s*<span style="color: #8b2252;">\(</span>wor<span style="color: #8b2252;">\)\(</span>ld<span style="color: #8b2252;">\)</span>*\<span style="color: #a0522d;">1</span>=\2*g
&#27880;&#37322;&#65306;,ci &#12290;&#32467;&#21512; vim &#27880;&#37322;3&#34892;&#65306;<span style="color: #ff00ff;">`V3j`</span> + <span style="color: #ff00ff;">`,ci`</span>&#65307;&#32467;&#21512; emacs &#27880;&#37322;3&#34892;&#65306;<span style="color: #ff00ff;">`C-u 4`</span> + <span style="color: #ff00ff;">`,ci`</span> &#12290;&#35270;&#22270;&#21644;&#26222;&#36890;&#27169;&#24335;&#19979;
&#22810;&#25991;&#20214;&#26597;&#25214;&#65306;,qq &#12290; &#35270;&#22270;&#21644;&#26222;&#36890;&#27169;&#24335;&#19979;.

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36873;&#25321;&#25805;&#20316;</span>
&#20840;&#36873;&#65306;C-a
&#25193;&#22823;&#36873;&#25321;&#21306;&#65306;&#25353; v &#25110;&#32773; ,xx &#12290;emacs &#20013;&#25193;&#22823;&#36873;&#25321;&#21306;: ,xx  &#20877;&#25353;x&#25193;&#22823;&#12290;&#32553;&#23567;&#36873;&#21306;: z&#12290;&#24674;&#22797;&#65306;-1 &#12290; &#35270;&#22270;&#27169;&#24335;&#21644;&#26222;&#36890;&#27169;&#24335;
&#32553;&#23567;&#36873;&#25321;&#21306;&#65306;,zz &#20165;&#35270;&#22270;&#27169;&#24335;&#12290;emacs  &#25903;&#25345; key map &#26356;&#26041;&#20415;&#65292;&#25193;&#22823;&#36873;&#25321;&#21306;: ,xx  &#20877;&#25353;x&#25193;&#22823;&#65292; &#32553;&#23567;&#36873;&#21306;: z&#65292; &#24674;&#22797;&#65306;0
&#22797;&#21046;&#34892;&#65306;vim &#20013; <span style="color: #ff00ff;">`yy  p`</span>
&#22810;&#20809;&#26631;&#25805;&#20316;&#65306;&#20351;&#29992; vim &#20195;&#26367;
- &#21015;&#32534;&#36753;&#65306;ctrl + v &#21521;&#19979;&#31227;&#21160;&#65292; &#22823;&#20889; I &#36755;&#20837;
- text object&#25991;&#20214;&#23545;&#35937;&#65306;
vit &#36873;&#20013;tag&#20869;&#30340;
vat &#36873;&#20013;&#21253;&#21547;tag
vi{ &#36873;&#20013;&#25324;&#21495;&#20869;&#30340;
va{ &#36873;&#20013;&#25324;&#21495;&#20869;&#30340;&#65292;&#21253;&#21547;&#25324;&#21495;
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23433;&#35013; vim-surround &#25554;&#20214;&#21518;</span>
cs<span style="color: #ff00ff;">`" &#26367;&#25442;`</span>&#20026;&#8220;  * vs code &#20013;&#29983;&#25928;
ysw<span style="color: #8b2252;">"  &#21333;&#35789;&#21152;&#32496;&#21495;&#12290; vs code &#20013;&#29983;&#25928;&#12290;</span>

<span style="color: #8b2252;"># &#35270;&#22270;&#19979;&#23376;&#31383;&#21475;&#25805;&#20316;</span>
<span style="color: #8b2252;">&#21629;&#20196;&#38754;&#26495;&#65306;,xm &#26222;&#36890;&#27169;&#24335;&#19979;</span>
<span style="color: #8b2252;">&#31109;&#27169;&#24335;&#65306;,ff &#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,xm&#65306;leader&#38190;&#65292;&#21629;&#20196;&#38754;&#26495;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,ff&#65306;leader&#38190;&#65292;&#31109;&#27169;&#24335;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">&#20998;&#23631;&#65306;</span>
<span style="color: #8b2252;">,x1&#65306;leader&#38190;&#65292;&#20165;&#20445;&#30041;&#24403;&#21069;&#23376;&#31383;&#21475;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,x3&#65306;leader&#38190;&#65292;&#21491;&#31446;&#20998;&#23631;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,x2&#65306;leader&#38190;&#65292;&#27700;&#24179;&#20998;&#21106;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,x4&#65306;leader&#38190;&#65292;&#24320;4&#20010;&#23631;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,x0&#65306;leader&#38190;&#65292;&#20851;&#38381;&#24403;&#21069;&#23631;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">- vim &#20998;&#23631;:</span>
<span style="color: #8b2252;">Ctrl+w,s&#65306;&#27700;&#24179;&#20998;&#21106;&#65292;&#19978;&#19979;&#20998;&#23631;&#12290;&#25110;&#32773;:sp</span>
<span style="color: #8b2252;">Ctrl+w,v&#65306;&#22402;&#30452;&#20998;&#21106;&#65292;&#24038;&#21491;&#20998;&#23631;&#65292;&#25110;&#32773;:vs</span>

<span style="color: #8b2252;">:close &#20851;&#38381;&#24403;&#21069;&#31383;&#21475;</span>
<span style="color: #8b2252;">:only &#20851;&#38381;&#38500;&#24403;&#21069;&#31383;&#21475;&#20197;&#22806;&#30340;&#25152;&#26377;&#31383;&#21475;</span>

<span style="color: #8b2252;">Ctrl+w c   &#20851;&#38381;&#20998;&#23631;  &#20851;&#38381;&#24403;&#21069;&#31383;&#21475;</span>
<span style="color: #8b2252;">Ctrl+w&#65292;&#26041;&#21521;&#38190; : &#31383;&#21475;&#38388;&#20999;&#25442;</span>

<span style="color: #8b2252;">&lt;C-w&gt;w &#22312;&#31383;&#21475;&#24490;&#29615;&#20999;&#25442;&#12290;&#22914;&lt;C-w&gt;&lt;C-w&gt;&lt;C-w&gt;&lt;C-w&gt;</span>
<span style="color: #8b2252;">&lt;C-w&gt;h &#20999;&#25442;&#21040;&#24038;&#36793;&#30340;&#31383;&#21475;</span>
<span style="color: #8b2252;">&lt;C-w&gt;j &#20999;&#25442;&#21040;&#19979;&#36793;&#30340;&#31383;&#21475;</span>
<span style="color: #8b2252;">&lt;C-w&gt;k &#20999;&#25442;&#21040;&#19978;&#36793;&#30340;&#31383;&#21475;</span>
<span style="color: #8b2252;">&lt;C-w&gt;l &#20999;&#25442;&#21040;&#21491;&#36793;&#30340;&#31383;&#21475;</span>
<span style="color: #8b2252;">&#31227;&#21160;</span>
<span style="color: #8b2252;">&lt;C-w&gt;L &#24038;&#36793;&#31383;&#21475;&#31227;&#21160;&#21040;&#21491;&#36793;</span>
<span style="color: #8b2252;">&lt;C-w&gt;H &#21491;&#36793;&#31383;&#21475;&#31227;&#21160;&#21040;&#24038;&#36793;</span>

<span style="color: #8b2252;"># go</span>
<span style="color: #8b2252;">- &#36339;&#36716;&#25805;&#20316;</span>
<span style="color: #8b2252;">C-t&#65306;&#22238;&#36864;&#12290;&#21644; vim emacs &#20445;&#25345;&#20860;&#23481;</span>
<span style="color: #8b2252;">C-]&#65306;&#36716;&#21040;&#31867;&#23450;&#20041;</span>
<span style="color: #8b2252;">,kk&#65306;&#25628;&#32034;&#24182;&#25171;&#24320;&#39033;&#30446;&#20013;&#20219;&#24847;&#25991;&#20214;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>

<span style="color: #8b2252;">- &#19978;&#27425;&#25628;&#32034;&#20301;&#32622;&#65288;vim&#65289;</span>
<span style="color: #8b2252;">C-o &#24102;&#24744;&#36339;&#36716;&#22238;&#36739;&#26087;&#30340;&#20301;&#32622;&#12290;&#21487;&#36339;&#21040;&#19978;&#19968;&#20010;&#25991;&#20214;&#25628;&#32034;&#30340;&#26087;&#25628;&#32034;&#20301;&#32622;&#65292;&#21487;&#22810;&#27425;&#25805;&#20316;</span>
<span style="color: #8b2252;">C-i &#21017;&#24102;&#24744;&#21040;&#36739;&#26032;&#30340;&#20301;&#32622;&#12290;&#21487;&#36339;&#21040;&#19979;&#19968;&#20010;&#25991;&#20214;&#25628;&#32034;&#30340;&#26032;&#25628;&#32034;&#20301;&#32622;&#65292;&#21487;&#22810;&#27425;&#25805;&#20316;</span>

<span style="color: #8b2252;">- &#23450;&#20301;&#21450;&#25991;&#20214;&#29366;&#24577;&#65288;vim&#65289;</span>
<span style="color: #8b2252;">G &#26368;&#21518;&#19968;&#34892;</span>
<span style="color: #8b2252;">1G, gg &#31532;&#19968;&#34892;</span>
<span style="color: #8b2252;">4gg, :4  &#31532;4&#34892;</span>
<span style="color: #8b2252;">C-g&#65306;&#26174;&#31034;&#24403;&#21069;&#32534;&#36753;&#25991;&#20214;&#20013;&#24403;&#21069;&#20809;&#26631;&#25152;&#22312;&#34892;&#20301;&#32622;&#20197;&#21450;&#25991;&#20214;&#29366;&#24577;&#20449;&#24687;</span>

<span style="color: #8b2252;">%&#65306;&#37197;&#23545;&#30340;&#31526;&#21495;&#38388;&#36339;&#36716;&#65292;&#20809;&#26631;&#25918;&#22312;&#24403;&#21069;&#26631;&#35760;&#19979;(&#12289;)&#12289;[&#12289;]&#12289;{&#12289;}</span>

<span style="color: #8b2252;">- &#20195;&#30721;&#33258;&#21160;&#23436;&#25104;</span>
<span style="color: #8b2252;">C-n&#65306;vim &#20013;&#23436;&#25104;&#21333;&#35789;&#65292;ctrl + n &#21521;&#19979;&#36873;&#65292;ctrl + p &#21521;&#19978;&#36873;</span>
<span style="color: #8b2252;">C-x C-l&#65306;&#23436;&#25104;&#34892;</span>

<span style="color: #8b2252;">- &#21487;&#36873;&#30340;</span>
<span style="color: #8b2252;">  - &#36339;&#36716;&#22768;&#26126;&#65288;&#21487;&#36873;&#65289;</span>
<span style="color: #8b2252;">    ,ii&#65306;leader &#38190;&#65292;&#36716;&#21040;&#32534;&#36753;&#22120;&#30340;&#31526;&#21495;&#12290;vim &#20013;&#29992; gd&#65292;C-o &#22238;&#21040;&#21407;&#20301;&#32622;</span>

<span style="color: #8b2252;">  - &#25171;&#24320;&#24403;&#21069;&#20809;&#26631;&#19979;&#30340;&#25991;&#20214;&#65288;&#21487;&#36873;&#65289;</span>
<span style="color: #8b2252;">    gf&#65306;vim &#20013;&#25171;&#24320;&#24403;&#21069;&#20809;&#26631;&#19979;&#30340;&#25991;&#20214;&#65292;C-o &#22238;&#21040;&#21407;&#20301;&#32622;</span>

<span style="color: #8b2252;">  - &#22312;&#24403;&#21069;&#25991;&#20214;&#25628;&#32034;&#25991;&#26412;&#65288;&#21487;&#36873;&#65289;</span>
<span style="color: #8b2252;">    `*/#`&#65306;* &#21521;&#19979;&#26631;&#35760;&#24403;&#21069;&#20809;&#26631;&#21333;&#35789;&#65292;# &#30456;&#21453;&#12290;&#20851;&#38381;&#39640;&#20142;&#29992; :set nohls</span>

<span style="color: #8b2252;">-  &#20854;&#23427;</span>
<span style="color: #8b2252;">kj&#65306;&#22312;&#25554;&#20837;&#27169;&#24335;&#19979;&#36864;&#22238;&#21040;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,xk&#65306;leader&#38190;&#65292;&#20851;&#38381;&#24403;&#21069;&#32534;&#36753;</span>
<span style="color: #8b2252;">,sp&#65306;leader&#38190;&#65292;&#22238;&#25253;&#31038;&#20250;</span>
</pre>
</div>
</div>
</div>
</section>
<section id="outline-container-org9273e84" class="outline-2">
<h2 id="org9273e84">第5章 在Sublime Text中应用文本文件操作术</h2>
<div class="outline-text-2" id="text-org9273e84">
</div>
<div id="outline-container-org762e20a" class="outline-3">
<h3 id="org762e20a">安装NeoVintageous并应用文本文件操作术</h3>
<div class="outline-text-3" id="text-org762e20a">
<p>
更新: Sublime Text的未公开的API文档的网站可能已下线。可以用<a href="https://web.archive.org/web/20191004202302/https://docs.sublimetext.info/en/latest/reference/api.html">https://web.archive.org/web/20191004202302/https://docs.sublimetext.info/en/latest/reference/api.html</a> 替代
</p>



<p>
之前的操作术完全可以在 sublime 中使用。这里需要安装 NeoVintageous 插件。
</p>

<p>
地址：<a href="https://github.com/NeoVintageous/NeoVintageous">https://github.com/NeoVintageous/NeoVintageous</a>
</p>


<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">window</span>
git clone https://github.com/NeoVintageous/NeoVintageous.git <span style="color: #8b2252;">"%APPDATA%\Sublime Text 3/Packages/NeoVintageous"</span>
</pre>
</div>




<p>
放在 <code>~/.config/sublime-text-3/Packages/User</code> 的文件
</p>

<p>
<code>.neovintageousrc</code> 配置文件
</p>


<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">" Type :help nv for help.</span>
<span style="color: #8b2252;">"</span> @see http://docs.sublimetext.info/en/latest/reference/api.html for all commands
<span style="color: #483d8b;">let</span> <span style="color: #a0522d;">mapleader</span>= <span style="color: #8b2252;">","</span>

noremap &lt;leader&gt;xm :ShowOverlay <span style="color: #a0522d;">overlay</span>=command_palette&lt;CR&gt; <span style="color: #8b2252;">" &#21629;&#20196;&#38754;&#26495;</span>
<span style="color: #8b2252;">noremap &lt;leader&gt;ci :ToggleComment&lt;CR&gt;</span>
<span style="color: #8b2252;">noremap &lt;leader&gt;xs :SaveAll&lt;CR&gt;</span>
<span style="color: #8b2252;">noremap &lt;leader&gt;aa :Copy&lt;CR&gt;&lt;ESC&gt;</span>
<span style="color: #8b2252;">noremap &lt;leader&gt;zz :Paste&lt;CR&gt;</span>
<span style="color: #8b2252;">noremap &lt;leader&gt;yy :PasteFromHistory&lt;CR&gt;  "</span> &#20174;&#22810;&#20010;&#21098;&#36148;&#26495;&#20013;&#31896;&#36148;
noremap &lt;leader&gt;qq :ShowPanel <span style="color: #a0522d;">panel</span>=find_in_files&lt;CR&gt; <span style="color: #8b2252;">" &#25628;&#32034;</span>
<span style="color: #8b2252;">noremap &lt;leader&gt;ss :ShowOverlay overlay=goto text=*&lt;CR&gt; "</span> &#24403;&#21069;&#25991;&#20214;&#25628;&#32034;
noremap &lt;leader&gt;kk :ShowOverlay <span style="color: #a0522d;">overlay</span>=goto <span style="color: #a0522d;">show_files</span>=true&lt;CR&gt;  <span style="color: #8b2252;">" &#25214;&#25991;&#20214;</span>
<span style="color: #8b2252;">noremap &lt;leader&gt;ii :ShowOverlay overlay=goto text=@&lt;CR&gt; "</span> &#24403;&#21069;&#25991;&#20214;&#25214;&#20986;&#31526;&#21495;
noremap &lt;leader&gt;x1 :SetLayout <span style="color: #a0522d;">cols</span>=1 <span style="color: #a0522d;">rows</span>=1&lt;CR&gt; <span style="color: #8b2252;">" &#21482;&#26377;&#19968;&#20010;&#23376;&#31383;&#21475;</span>
<span style="color: #8b2252;">noremap &lt;leader&gt;x2 :sp&lt;CR&gt;</span>
<span style="color: #8b2252;">noremap &lt;leader&gt;x3 :vs&lt;CR&gt;</span>
</pre>
</div>

<p>
<code>&lt;CR&gt;</code> 代表回车
</p>

<p>
<b>额外命令配置</b>
</p>

<p>
<code>%APPDATA%\Sublime Text 3/Packages/User/Default.sublime-commands</code> 文件，可关闭 vim 操作
</p>


<div class="org-src-container">
<pre class="src src-shell">[
  { <span style="color: #8b2252;">"caption"</span>: <span style="color: #8b2252;">"NeoVintageous: Toggle"</span>, <span style="color: #8b2252;">"command"</span>: <span style="color: #8b2252;">"toggle_neo_vintageous"</span> }
]
</pre>
</div>


<p>
引用的py配置 toggle_vintageous.py
</p>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> sublime
<span style="color: #a020f0;">import</span> sublime_plugin

<span style="color: #a020f0;">class</span> <span style="color: #228b22;">ToggleNeoVintageous</span>(sublime_plugin.WindowCommand):
    <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">run</span>(<span style="color: #a020f0;">self</span>):
        <span style="color: #a0522d;">setts</span> = sublime.load_settings(<span style="color: #8b2252;">'Preferences.sublime-settings'</span>)
        <span style="color: #a0522d;">ignored</span> = setts.get(<span style="color: #8b2252;">'ignored_packages'</span>)

        <span style="color: #a020f0;">if</span> <span style="color: #8b2252;">'NeoVintageous'</span> <span style="color: #a020f0;">in</span> ignored:
            ignored.remove(<span style="color: #8b2252;">'NeoVintageous'</span>)
        <span style="color: #a020f0;">else</span>:
            ignored.append(<span style="color: #8b2252;">'NeoVintageous'</span>)

        setts.<span style="color: #483d8b;">set</span>(<span style="color: #8b2252;">'ignored_packages'</span>, ignored)
        sublime.save_settings(<span style="color: #8b2252;">'Preferences.sublime-settings'</span>)
</pre>
</div>


<p>
<code>Default.sublime-keymap</code> 文件
</p>


<pre class="example" id="org000dcd9">
[
  {
    "keys": ["k", "j"],
    "command": "_enter_normal_mode",
    "args": {
      "mode": "mode_insert"
    },
    "context": [
      {
        "key": "vi_insert_mode_aware"
      }
    ]
  }
]
</pre>
</div>
</div>
</section>
<section id="outline-container-org7810cc6" class="outline-2">
<h2 id="org7810cc6">第6章 在任意的IDE中应用文本文件操作术</h2>
<div class="outline-text-2" id="text-org7810cc6">
</div>
<div id="outline-container-org92baf9e" class="outline-3">
<h3 id="org92baf9e">在IntelliJ IDEA中安装使用IdeaVim</h3>
<div class="outline-text-3" id="text-org92baf9e">
<p>
IntelliJ IDEA是全世界流行的IDE。应用之前教授的技术,以证明我们学到的技能是通用的。可以使用一生，永不会贬值。无论以后你使用何种编辑器和IDE，你都可以使用本课程学到的技巧
</p>


<p>
之前的操作术完全可以在 IntelliJ IDEA 中使用。这里需要安装 IdeaVim 插件
</p>

<p>
插件地址：<a href="https://github.com/JetBrains/ideavim">https://github.com/JetBrains/ideavim</a>
</p>



<div class="org-src-container">
<pre class="src src-sehll">IdeaVim插件安装配置：
(1) 在File-&gt;Setting -&gt; Plugins -&gt; Browse repositories中查找IdeaVim插件安装即可。
(2) 重启  IntelliJ IDEA

# 将配置文件拷贝到
~/.ideavimrc
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaadb491" class="outline-3">
<h3 id="orgaadb491">IntelliJ IDEA中的文本文件操作术</h3>
<div class="outline-text-3" id="text-orgaadb491">
<p>
<code>~/.ideavimrc</code> 文件内容
</p>

<pre class="example" id="org76feda3">
let mapleader = ","   " leader is comma
let localleader = "," " leader is comma

set tabstop=4       " number of visual spaces per TAB
set softtabstop=4   " number of spaces in tab when editing
set shiftwidth=4    " spaces in newline start
set expandtab       " tabs are spaces
set number              " show line numbers
set rnu                 " show relative line numbers
set showcmd             " show command in bottom bar
set cursorline          " highlight current line
set surround            " use surround shortcuts
set commentary "vim-commentary
filetype indent on      " load filetype-specific indent files
set wildmenu            " visual autocomplete for command menu
set showmatch           " highlight matching [{()}]
set timeoutlen=500      " timeout for key combinations

set so=5                " lines to cursor
set backspace=2         " make backspace work like most other apps
set incsearch           " search as characters are entered
set hlsearch            " highlight matches
set ignorecase          " do case insensitive matching
set smartcase           " do smart case matching
set hidden

set fillchars+=stl:\ ,stlnc:\
set laststatus=2
set clipboard=unnamedplus  "X clipboard as unnamed

"press kj to exit insert mode
imap kj &lt;Esc&gt; " 输入模式下按 kj 进入到 normal 模式
vmap kj &lt;Esc&gt; " 视图模式下按 kj 进入到 normal 模式

"@see https://youtrack.jetbrains.com/issue/VIM-510 on expand selected region. Press `Ctrl-W` and `Ctrl-Shift-W` to increase and decrease selected region

noremap ,xm :action SearchEverywhere&lt;CR&gt;      " 命令菜单
noremap ,ci :action CommentByLineComment&lt;CR&gt;  " 注释
noremap ,xs :action SaveAll&lt;CR&gt;              " 保存所有
noremap ,aa :action $Copy&lt;CR&gt;    " 复制
noremap ,zz :action $Paste&lt;CR&gt;   " 粘贴
noremap ,yy :action PasteMultiple&lt;CR&gt;  “ 从多个剪贴板中粘贴
noremap ,qq :action FindInPath&lt;CR&gt;     " 搜索
noremap ,ss :action Find&lt;CR&gt;           " 当前文件搜索
noremap ,fp :action CopyPaths&lt;CR&gt;       " 拷贝当前文件路径
noremap ,xk :action CloseEditor&lt;CR&gt;    " 关闭编辑
noremap ,rr :action RecentFiles&lt;CR&gt;  " 最近访问文件
noremap ,kk :action GotoFile&lt;CR&gt;      " 跳到文件
noremap ,ii :action GotoSymbol&lt;CR&gt;    " 转到编辑器的符号
noremap &lt;C-]&gt; :action GotoImplementation&lt;CR&gt;  " 转到类定义
noremap ,xz :action ActivateTerminalToolWindow&lt;CR&gt; " 打开终端

" ideavim don't support numberic character in hotkey in 0.55
" it's fixed in 0.55.1
noremap ,x1 &lt;C-W&gt;o  " 仅保留当前子窗口，将 C-w o 映射到 ,x1
noremap ,x2 :split&lt;CR&gt;
noremap ,x3 :vsplit&lt;CR&gt;
noremap ,x0 :q&lt;CR&gt;
" move window
noremap ,wh &lt;C-W&gt;h
noremap ,wl &lt;C-W&gt;l
noremap ,wj &lt;C-W&gt;j
noremap ,wk &lt;C-W&gt;k
noremap ,xx :action EditorSelectWord&lt;CR&gt; " 扩展区域，选中当前区域不断扩展
</pre>


<p>
帮助小技巧：
</p>

<p>
使用 <code>:actionlist [pattern]</code> 可知道原生快捷键关键词，如 <code>:actionlist &lt;C-W&gt;</code>
</p>
</div>
</div>
<div id="outline-container-org8b4e26e" class="outline-3">
<h3 id="org8b4e26e">升级IdeaVim到预览版</h3>
</div>

<div id="outline-container-org86a1b0f" class="outline-3">
<h3 id="org86a1b0f">IntelliJ IDEA的子窗口操作和ideavi</h3>
<div class="outline-text-3" id="text-org86a1b0f">
<p>
需要安装ideavim 0.55.1版本，见之前的章节
</p>
</div>
</div>
</section>
<section id="outline-container-orgd23b072" class="outline-2">
<h2 id="orgd23b072">第7章 在Emacs中应用文本文件操作术</h2>
<div class="outline-text-2" id="text-orgd23b072">
<p>
结合 vim 的知识，所有的文本能用的高级技术已经在之前 vscode 和 vim 中讲述。
</p>

<p>
官方地址：<a href="https://www.gnu.org/software/emacs/index.html">https://www.gnu.org/software/emacs/index.html</a>
</p>
</div>
<div id="outline-container-org5516f33" class="outline-3">
<h3 id="org5516f33">安装并学习Emacs和Evil</h3>
<div class="outline-text-3" id="text-org5516f33">
</div>
<div id="outline-container-orge1024dd" class="outline-4">
<h4 id="orge1024dd">Windows</h4>
<div class="outline-text-4" id="text-orge1024dd">
<p>
<b>设置环境变量</b>
</p>

<p>
调用 2 个环境变量，HOME 和 PATH。HOME 找到 emacs 的用户目录，PATH 找到 emacs 和 cygwin 里的命令。请提前安装 cygwin 服务。
</p>

<p>
方法1：右击桌面 我的电脑 &gt; 属性 &gt; 高经系统设置 &gt; 高级 &gt; 环境变量 &gt; 用户变量 &gt; 编辑
</p>


<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">HOME</span>
c:/Users/jasper
<span style="color: #b22222;"># </span><span style="color: #b22222;">Path</span>
D:\Program Files\emacs-27.2-x86_64\bin
D:\cygwin64\bin
</pre>
</div>


<p>
方法2：win10 powershell 执行
</p>


<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">HOME &#29615;&#22659;&#21464;&#37327;</span>
[Environment]::SetEnvironmentVariable(<span style="color: #8b2252;">"HOME"</span>, <span style="color: #8b2252;">"c:/Users/jasper/"</span>, <span style="color: #8b2252;">"User"</span>)
<span style="color: #b22222;">#  </span><span style="color: #b22222;">Path</span>
&#21491;&#20987;&#26700;&#38754; &#25105;&#30340;&#30005;&#33041; ...
</pre>
</div>


<p>
运行它后，重新启动 PowerShell 使用 `dir env:`查看是否生效
</p>


<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#30475;&#24403;&#21069;&#29615;&#22659;&#21464;&#37327;&#21644;PATH</span>
Get-ChildItem env:
$<span style="color: #a0522d;">env</span>:path -split <span style="color: #8b2252;">";"</span>
</pre>
</div>




<p>
<b>下载 emacs 程序</b>
</p>

<p>
Download at <a href="http://ftp.gnu.org/pub/gnu/emacs/windows/">http://ftp.gnu.org/pub/gnu/emacs/windows/</a>
</p>

<p>
这是官方的 GNU Emacs，由自由软件基金会为 Windows 构建。
</p>

<p>
这里有 32 或者 64 位的包，可以用 win 键查看“关于”电脑信息选择对应位的包。
</p>


<figure id="orgd0a26a4">
<img src="./images/image-20220115004658051.png" alt="image-20220115004658051.png">

</figure>

<p>
这里下载 emacs-27.2-x86_64.zip 包，解压到 /
</p>

<p>
启动 Emacs in Terminal vs GUI
</p>

<p>
terminal 终端启动： <code>emacs -nw</code>
</p>

<p>
GUI 启动：到 bin 目录下点击 runemacs 启动。addpm.exe 可把应用加到菜单中
</p>

<p>
Windows FAQ参考：<a href="http://xahlee.info/emacs/emacs/emacs_mswin.html">http://xahlee.info/emacs/emacs/emacs_mswin.html</a>
</p>
</div>
</div>
<div id="outline-container-org92c731b" class="outline-4">
<h4 id="org92c731b">使用 chenbin 配置</h4>
<div class="outline-text-4" id="text-org92c731b">
<p>
<a href="https://github.com/redguardtoo/mastering-emacs-in-one-year-guide/blob/master/guide-zh.org">一年成为Emacs高手</a>
</p>

<p>
chen bin <a href="https://github.com/redguardtoo/emacs.d">https://github.com/redguardtoo/emacs.d</a>
</p>

<div class="org-src-container">
<pre class="src src-shell">rm ~/.emacs
<span style="color: #483d8b;">cd</span> ~; git clone https://github.com/redguardtoo/emacs.d.git .emacs.d

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#38543;&#26426;&#20027;&#39064;&#65292;&#22312;~/.custom.el&#20013;&#28155;&#21152;</span>
(my-random-favorite-color-theme)
</pre>
</div>

<p>
终端方式启动
</p>
<div class="org-src-container">
<pre class="src src-shell">emacs -nw

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20132;&#20114;&#24335;&#35843;&#35797;</span>
M-x ielm 
</pre>
</div>
</div>
<div id="outline-container-org2278a04" class="outline-5">
<h5 id="org2278a04">文本高级操作快捷键</h5>
<div class="outline-text-5" id="text-org2278a04">
<p>
可以使用 vim 的操作。文本高级操作快捷键都有。 如:
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#35774;&#32622;leader&#38190;&#20026; , &#36887;&#21495;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25554;&#20837;&#27169;&#24335;&#19979; &#25353; k j &#20195;&#34920; ecs &#36864;&#20986;&#21040;&#26222;&#36890;&#27169;&#24335;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25991;&#20214;&#25805;&#20316; &#20165;&#26222;&#36890;&#27169;&#24335;</span>
&#26368;&#36817;&#35775;&#38382;&#25991;&#20214;&#65306;,rr 
&#25171;&#24320;&#25991;&#20214;&#65306;,xf &#21644; emacs &#20013; <span style="color: #ff00ff;">`C-x C-f`</span> &#31867;&#20284;
&#20445;&#23384;&#25991;&#20214;&#65306;,xs &#21644;emacs&#20013;<span style="color: #ff00ff;">`c-x c-s`</span>&#30456;&#20284;

&#32534;&#36753;&#25805;&#20316;
undo/redo&#65306;vim &#25805;&#20316; uU/C-r&#12290; . &#28857;&#21495;&#37325;&#22797;&#25805;&#20316;&#65292;:e! &#25991;&#26723;&#36824;&#21407;&#21040;&#26368;&#21407;&#22987;&#29366;&#24577;
&#21098;&#36148;&#65306;vim &#20013; x&#12290;d &#20063;&#26159;&#21024;&#38500;
&#22797;&#21046;&#65306;,aa &#36873;&#20013;&#22797;&#21046;&#12290;&#20165;&#35270;&#22270;&#27169;&#24335;&#12290;vim &#20013; yy &#22797;&#21046;&#24403;&#21069;&#34892;&#65307;&#36873;&#20013; <span style="color: #8b2252;">"+y &#20174; vim &#25335;&#36125;&#21040;&#31995;&#32479;&#21098;&#20999;&#26495;&#65292;"</span>+p &#31995;&#32479;&#21040; vim
&#31896;&#36148;&#65306;vim &#20013; p
&#26597;&#25214;&#23383;&#31526;&#65306;,ss &#12290;vim &#20013; / &#12290;&#35270;&#22270;&#21644;&#26222;&#36890;&#27169;&#24335;&#19979;
&#26367;&#25442;&#65306;: ,rb&#65306;leader&#38190;&#65292;&#26597;&#25214;&#26367;&#25442;&#12290;&#36873;&#20013;&#23383;&#31526; :<span style="color: #8b2252;">'&lt;,'</span>&gt;s/<span style="color: #8b2252;">\&lt;</span>(&#36873;&#20013;&#30340;&#23383;&#31526;<span style="color: #8b2252;">\)\&gt;</span>/&#35201;&#26367;&#25442;&#25104;&#30340;&#23383;&#31526;/g
&#27880;&#37322;&#65306;,ci &#12290;&#32467;&#21512; vim &#27880;&#37322;3&#34892;&#65306;<span style="color: #ff00ff;">`V3j`</span> + <span style="color: #ff00ff;">`,ci`</span>&#65307;&#32467;&#21512; emacs &#27880;&#37322;3&#34892;&#65306;<span style="color: #ff00ff;">`C-u 4`</span> + <span style="color: #ff00ff;">`,ci`</span> &#12290;&#35270;&#22270;&#21644;&#26222;&#36890;&#27169;&#24335;&#19979;
&#22810;&#25991;&#20214;&#26597;&#25214;&#65306;,qq &#12290; &#35270;&#22270;&#21644;&#26222;&#36890;&#27169;&#24335;&#19979;.

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36873;&#25321;&#25805;&#20316;</span>
&#20840;&#36873;&#65306;C-a
&#25193;&#22823;&#36873;&#25321;&#21306;&#65306;&#25353; v &#25110;&#32773; ,xx &#12290;emacs &#20013;&#25193;&#22823;&#36873;&#25321;&#21306;: ,xx  &#20877;&#25353;x&#25193;&#22823;&#12290;&#32553;&#23567;&#36873;&#21306;: z&#12290;&#24674;&#22797;&#65306;-1 &#12290; &#35270;&#22270;&#27169;&#24335;&#21644;&#26222;&#36890;&#27169;&#24335;
&#32553;&#23567;&#36873;&#25321;&#21306;&#65306;,zz &#20165;&#35270;&#22270;&#27169;&#24335;&#12290;emacs  &#25903;&#25345; key map &#26356;&#26041;&#20415;&#65292;&#25193;&#22823;&#36873;&#25321;&#21306;: ,xx  &#20877;&#25353;x&#25193;&#22823;&#65292; &#32553;&#23567;&#36873;&#21306;: z&#65292; &#24674;&#22797;&#65306;0
&#22797;&#21046;&#34892;&#65306;vim &#20013; <span style="color: #ff00ff;">`yy  p`</span>
&#22810;&#20809;&#26631;&#25805;&#20316;&#65306;&#20351;&#29992; vim &#20195;&#26367;
- &#21015;&#32534;&#36753;&#65306;ctrl + v &#21521;&#19979;&#31227;&#21160;&#65292; &#22823;&#20889; I &#36755;&#20837;
- text object&#25991;&#20214;&#23545;&#35937;&#65306;
vit &#36873;&#20013;tag&#20869;&#30340;
vat &#36873;&#20013;&#21253;&#21547;tag
vi{ &#36873;&#20013;&#25324;&#21495;&#20869;&#30340;
va{ &#36873;&#20013;&#25324;&#21495;&#20869;&#30340;&#65292;&#21253;&#21547;&#25324;&#21495;
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23433;&#35013; vim-surround &#25554;&#20214;&#21518;</span>
cs<span style="color: #ff00ff;">`" &#26367;&#25442;`</span>&#20026;&#8220;  * vs code &#20013;&#29983;&#25928;
ysw<span style="color: #8b2252;">"  &#21333;&#35789;&#21152;&#32496;&#21495;&#12290; vs code &#20013;&#29983;&#25928;&#12290;</span>

<span style="color: #8b2252;"># &#35270;&#22270;&#19979;&#23376;&#31383;&#21475;&#25805;&#20316;</span>
<span style="color: #8b2252;">&#21629;&#20196;&#38754;&#26495;&#65306;,xm &#26222;&#36890;&#27169;&#24335;&#19979;</span>
<span style="color: #8b2252;">&#31109;&#27169;&#24335;&#65306;,ff &#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,xm&#65306;leader&#38190;&#65292;&#21629;&#20196;&#38754;&#26495;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,ff&#65306;leader&#38190;&#65292;&#31109;&#27169;&#24335;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">&#20998;&#23631;&#65306;</span>
<span style="color: #8b2252;">,x1&#65306;leader&#38190;&#65292;&#20165;&#20445;&#30041;&#24403;&#21069;&#23376;&#31383;&#21475;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,x3&#65306;leader&#38190;&#65292;&#21491;&#31446;&#20998;&#23631;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,x2&#65306;leader&#38190;&#65292;&#27700;&#24179;&#20998;&#21106;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,x4&#65306;leader&#38190;&#65292;&#24320;4&#20010;&#23631;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,x0&#65306;leader&#38190;&#65292;&#20851;&#38381;&#24403;&#21069;&#23631;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">- vim &#20998;&#23631;:</span>
<span style="color: #8b2252;">Ctrl+w,s&#65306;&#27700;&#24179;&#20998;&#21106;&#65292;&#19978;&#19979;&#20998;&#23631;&#12290;&#25110;&#32773;:sp</span>
<span style="color: #8b2252;">Ctrl+w,v&#65306;&#22402;&#30452;&#20998;&#21106;&#65292;&#24038;&#21491;&#20998;&#23631;&#65292;&#25110;&#32773;:vs</span>

<span style="color: #8b2252;">:close &#20851;&#38381;&#24403;&#21069;&#31383;&#21475;</span>
<span style="color: #8b2252;">:only &#20851;&#38381;&#38500;&#24403;&#21069;&#31383;&#21475;&#20197;&#22806;&#30340;&#25152;&#26377;&#31383;&#21475;</span>

<span style="color: #8b2252;">Ctrl+w c   &#20851;&#38381;&#20998;&#23631;  &#20851;&#38381;&#24403;&#21069;&#31383;&#21475;</span>
<span style="color: #8b2252;">Ctrl+w&#65292;&#26041;&#21521;&#38190; : &#31383;&#21475;&#38388;&#20999;&#25442;</span>

<span style="color: #8b2252;">&lt;C-w&gt;w &#22312;&#31383;&#21475;&#24490;&#29615;&#20999;&#25442;&#12290;&#22914;&lt;C-w&gt;&lt;C-w&gt;&lt;C-w&gt;&lt;C-w&gt;</span>
<span style="color: #8b2252;">&lt;C-w&gt;h &#20999;&#25442;&#21040;&#24038;&#36793;&#30340;&#31383;&#21475;</span>
<span style="color: #8b2252;">&lt;C-w&gt;j &#20999;&#25442;&#21040;&#19979;&#36793;&#30340;&#31383;&#21475;</span>
<span style="color: #8b2252;">&lt;C-w&gt;k &#20999;&#25442;&#21040;&#19978;&#36793;&#30340;&#31383;&#21475;</span>
<span style="color: #8b2252;">&lt;C-w&gt;l &#20999;&#25442;&#21040;&#21491;&#36793;&#30340;&#31383;&#21475;</span>
<span style="color: #8b2252;">&#31227;&#21160;</span>
<span style="color: #8b2252;">&lt;C-w&gt;L &#24038;&#36793;&#31383;&#21475;&#31227;&#21160;&#21040;&#21491;&#36793;</span>
<span style="color: #8b2252;">&lt;C-w&gt;H &#21491;&#36793;&#31383;&#21475;&#31227;&#21160;&#21040;&#24038;&#36793;</span>

<span style="color: #8b2252;">,uu &#22238;&#36864;&#31383;&#21475;&#65292;&#21516;&#26102;&#20063;&#26377;C-x 4 u</span>

<span style="color: #8b2252;"># go</span>
<span style="color: #8b2252;">- &#36339;&#36716;&#25805;&#20316;</span>
<span style="color: #8b2252;">C-t&#65306;&#22238;&#36864;&#12290;&#21644; vim emacs &#20445;&#25345;&#20860;&#23481;</span>
<span style="color: #8b2252;">C-]&#65306;&#36716;&#21040;&#31867;&#23450;&#20041;</span>
<span style="color: #8b2252;">,kk&#65306;&#25628;&#32034;&#24182;&#25171;&#24320;&#39033;&#30446;&#20013;&#20219;&#24847;&#25991;&#20214;&#65292;&#20165;&#26222;&#36890;&#27169;&#24335;</span>

<span style="color: #8b2252;">- &#19978;&#27425;&#25628;&#32034;&#20301;&#32622;&#65288;vim&#65289;</span>
<span style="color: #8b2252;">C-o &#24102;&#24744;&#36339;&#36716;&#22238;&#36739;&#26087;&#30340;&#20301;&#32622;&#12290;&#21487;&#36339;&#21040;&#19978;&#19968;&#20010;&#25991;&#20214;&#25628;&#32034;&#30340;&#26087;&#25628;&#32034;&#20301;&#32622;&#65292;&#21487;&#22810;&#27425;&#25805;&#20316;</span>
<span style="color: #8b2252;">C-i &#21017;&#24102;&#24744;&#21040;&#36739;&#26032;&#30340;&#20301;&#32622;&#12290;&#21487;&#36339;&#21040;&#19979;&#19968;&#20010;&#25991;&#20214;&#25628;&#32034;&#30340;&#26032;&#25628;&#32034;&#20301;&#32622;&#65292;&#21487;&#22810;&#27425;&#25805;&#20316;</span>

<span style="color: #8b2252;">- &#23450;&#20301;&#21450;&#25991;&#20214;&#29366;&#24577;&#65288;vim&#65289;</span>
<span style="color: #8b2252;">G &#26368;&#21518;&#19968;&#34892;</span>
<span style="color: #8b2252;">1G, gg &#31532;&#19968;&#34892;</span>
<span style="color: #8b2252;">4gg, :4  &#31532;4&#34892;</span>
<span style="color: #8b2252;">C-g&#65306;&#26174;&#31034;&#24403;&#21069;&#32534;&#36753;&#25991;&#20214;&#20013;&#24403;&#21069;&#20809;&#26631;&#25152;&#22312;&#34892;&#20301;&#32622;&#20197;&#21450;&#25991;&#20214;&#29366;&#24577;&#20449;&#24687;</span>

<span style="color: #8b2252;">%&#65306;&#37197;&#23545;&#30340;&#31526;&#21495;&#38388;&#36339;&#36716;&#65292;&#20809;&#26631;&#25918;&#22312;&#24403;&#21069;&#26631;&#35760;&#19979;(&#12289;)&#12289;[&#12289;]&#12289;{&#12289;}</span>

<span style="color: #8b2252;">- &#20195;&#30721;&#33258;&#21160;&#23436;&#25104;</span>
<span style="color: #8b2252;">C-n&#65306;vim &#20013;&#23436;&#25104;&#21333;&#35789;&#65292;ctrl + n &#21521;&#19979;&#36873;&#65292;ctrl + p &#21521;&#19978;&#36873;</span>
<span style="color: #8b2252;">C-x C-l&#65306;&#23436;&#25104;&#34892;</span>

<span style="color: #8b2252;">- &#21487;&#36873;&#30340;</span>
<span style="color: #8b2252;">  - &#36339;&#36716;&#22768;&#26126;&#65288;&#21487;&#36873;&#65289;</span>
<span style="color: #8b2252;">    ,ii&#65306;leader &#38190;&#65292;&#36716;&#21040;&#32534;&#36753;&#22120;&#30340;&#31526;&#21495;&#12290;vim &#20013;&#29992; gd&#65292;C-o &#22238;&#21040;&#21407;&#20301;&#32622;</span>

<span style="color: #8b2252;">  - &#25171;&#24320;&#24403;&#21069;&#20809;&#26631;&#19979;&#30340;&#25991;&#20214;&#65288;&#21487;&#36873;&#65289;</span>
<span style="color: #8b2252;">    gf&#65306;vim &#20013;&#25171;&#24320;&#24403;&#21069;&#20809;&#26631;&#19979;&#30340;&#25991;&#20214;&#65292;C-o &#22238;&#21040;&#21407;&#20301;&#32622;</span>

<span style="color: #8b2252;">  - &#22312;&#24403;&#21069;&#25991;&#20214;&#25628;&#32034;&#25991;&#26412;&#65288;&#21487;&#36873;&#65289;</span>
<span style="color: #8b2252;">    `*/#`&#65306;* &#21521;&#19979;&#26631;&#35760;&#24403;&#21069;&#20809;&#26631;&#21333;&#35789;&#65292;# &#30456;&#21453;&#12290;&#20851;&#38381;&#39640;&#20142;&#29992; :set nohls</span>

<span style="color: #8b2252;">-  &#20854;&#23427;</span>
<span style="color: #8b2252;">kj&#65306;&#22312;&#25554;&#20837;&#27169;&#24335;&#19979;&#36864;&#22238;&#21040;&#26222;&#36890;&#27169;&#24335;</span>
<span style="color: #8b2252;">,xk&#65306;leader&#38190;&#65292;&#20851;&#38381;&#24403;&#21069;&#32534;&#36753;</span>
<span style="color: #8b2252;">,sp&#65306;leader&#38190;&#65292;&#22238;&#25253;&#31038;&#20250;</span>

<span style="color: #8b2252;">#----</span>
<span style="color: #8b2252;">ga&#65306;&#26174;&#31034;&#23383;&#31526;&#23545;&#24212;&#30340; ASSCII &#30721;</span>
<span style="color: #8b2252;">,ne&#65306;elisp&#35831;&#27714;&#26816;&#26597; lazyflymake-goto-next-error</span>
<span style="color: #8b2252;">,dd&#65306;&#24403;&#21069;&#30446;&#24405;&#20013;&#25628;&#32034;&#25991;&#26412;</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org484dd49" class="outline-4">
<h4 id="org484dd49">以服务端形式启动 emacs</h4>
<div class="outline-text-4" id="text-org484dd49">
<p>
参考官方 ：<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Server.html*Emacs-Server">https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Server.html*Emacs-Server</a>
</p>

<p>
<a href="https://github.com/daviwil/emacs-from-scratch/blob/d24357b488862223fecaebdad758b136b0ca96e7/show-notes/Emacs-Tips-08.org">https://github.com/daviwil/emacs-from-scratch/blob/d24357b488862223fecaebdad758b136b0ca96e7/show-notes/Emacs-Tips-08.org</a>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">3 &#31181;&#21551;&#21160;&#23432;&#25252;&#26041;&#24335;</span>
emacs --daemon
emacs --daemon=work <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21487;&#22810;&#36827;&#31243;&#23432;&#25252;</span>
emacs --fg-daemon <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21069;&#21488;</span>
</pre>
</div>

<p>
目标是 <code>emacsclientw.exe</code> 的绝对路径后跟参数 <code>-c -n -a ""</code> ，运行这个快捷方式就可以以daemon模式启动Emacs。各参数的解释：
</p>

<ul class="org-ul">
<li><code>-c</code> 新建一个frame。这个参数也让 <code>emacsclientw</code> 不要求提供文件名。</li>
<li><code>-n</code> 立即退出，对于Windows来说这样就可以。</li>
<li><code>-a ""</code> 这个参数很有意思。 <code>-a</code> 的本意是在Emacs没有运行的时候提供一个后退的编辑器，而提供一个空字符串则以daemon模式启动Emacs，这就是我们需要的。注意必须要带空字符串</li>
</ul>

<div class="org-src-container">
<pre class="src src-shell">emacsclient -f work -c -n
</pre>
</div>

<p>
关闭 emacs 守护进程
</p>

<div class="org-src-container">
<pre class="src src-shell">emacsclient -e <span style="color: #8b2252;">"(kill-emacs)"</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf4efe64" class="outline-3">
<h3 id="orgf4efe64">学习Emacs官方教程</h3>
<div class="outline-text-3" id="text-orgf4efe64">
<p>
根据之前的文本文件操作术，对官方教程进行了精简优化，有些可以用 vim 来代替
</p>


<p>
使用不加载配置启动 <code>emacs -q</code>
</p>

<pre class="example" id="orgc509a2c">
M-x help-with-tutorial-spec-language * 可选中文
M-x
help-with-tutorial (C-h t)
</pre>

<p>
这里用英文帮助
</p>
</div>
<div id="outline-container-org9dc409c" class="outline-4">
<h4 id="org9dc409c">按键</h4>
<div class="outline-text-4" id="text-org9dc409c">
<p>
Emacs 键盘命令通常包含 CONTROL 键（有时候以 CTRL 或 CTL 来标示）和
META 键（有时候用 EDIT 或 ALT 来标示）。为了避免每次都要写出全名，我们
约定使用下述缩写：
</p>

<pre class="example" id="org3228965">
C-&lt;chr&gt;  按住 ctrl 键，同时按字母键。
M-&lt;chr&gt;  按住 alt 键，mac 中是 Option 键，同时按字母键。

如：
C-x C-c：退出 emacs
C-g： 退出一个在运行的命令Emacs 键盘命令通常包含 CONTROL 键（有时候以 CTRL 或 CTL 来标示）和
META 键（有时候用 EDIT 或 ALT 来标示）。为了避免每次都要写出全名，我们
约定使用下述缩写：
C-x k：关闭当前 buffer
</pre>

<p>
iterm2 设置meta：
</p>
<ul class="org-ul">
<li>打开偏好设置（command+,）</li>
<li>选择 Profiles - Keys - General</li>
<li>将Option键设置为Esc+，注意不要设置成Meta</li>
</ul>
</div>
</div>
<div id="outline-container-org7f0b822" class="outline-4">
<h4 id="org7f0b822">跳转</h4>
<div class="outline-text-4" id="text-org7f0b822">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#20809;&#26631;&#31227;&#21160;</span>
C-v&#65306;&#21521;&#19979;&#32763;&#23631;
M-v&#65306;&#21521;&#19978;&#32763;&#23631;
C-l&#65306;&#20809;&#26631;&#31227;&#21040;&#23631;&#24403;&#20013;&#12290;&#24456;&#23569;&#29992;

C-n&#65306;&#21521;&#19979;&#31227;&#21160;
C-p&#65306;&#21521;&#19978;&#31227;&#21160;
C-b&#65306;&#25353;&#23383;&#31526;&#21521;&#24038;&#31227;&#31227;
C-f&#65306;&#25353;&#23383;&#31526;&#21521;&#21491;&#31227;&#31227;

M-f&#65306;&#25353;&#21333;&#35789;&#21521;&#21491;&#31227;&#31227;
M-b&#65306;&#25353;&#21333;&#35789;&#21521;&#24038;&#31227;&#31227;

C-a&#65306;&#31227;&#21160;&#21040;&#34892;&#39318;
C-e&#65306;&#31227;&#21160;&#21040;&#34892;&#23614;

M-a&#65306;&#21477;&#23376;&#39318; (&#24456;&#23569;&#29992;)
M-e&#65306;&#21477;&#23376;&#23614; (&#24456;&#23569;&#29992;)

&#27573;&#33853;&#25805;&#20316;&#22522;&#26412;&#29992; vim &#30340;&#26041;&#24335;
M-{|} &#27573;&#33853;-&#39318;|&#23614;
M-&lt;|&gt; &#32531;&#20914;&#21306;-&#39318;|&#23614;  vim &#20013; gg|G

&#20960;&#20046;&#25152;&#26377; emacs &#37117;&#25903;&#25345;&#25968;&#23383;&#21442;&#25968;
&#29992;&#27861;&#65306;C-u &#25968;&#23383;&#65288;&#24120;&#29992;&#65289;&#65292;&#25110;&#32773;M-&#25968;&#23383;&#65288;&#19981;&#24120;&#29992;&#65289;
&#22914; C-u 8 C-f &#21521;&#21491;&#31227;&#21160; 8 &#20010;&#23383;&#31526;
&#19981;&#24120;&#29992;&#65292;&#19968;&#33324;&#24320;&#21457;&#26102;&#20250;&#29992;&#36825;&#20010;&#20570;&#35843;&#25972;&#65292;&#20854;&#20182;&#26102;&#20505;&#29992;&#21629;&#20196;&#65292;&#20102;&#35299; emacs &#25903;&#25345;&#25968;&#23383;&#27010;&#24565;&#23601;&#34892;&#12290;
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc479438" class="outline-4">
<h4 id="orgc479438">停止响应命令</h4>
<div class="outline-text-4" id="text-orgc479438">
<p>
C-g：停止响应命令
</p>
</div>
</div>
<div id="outline-container-org6447290" class="outline-4">
<h4 id="org6447290">windos 子窗口操作</h4>
<div class="outline-text-4" id="text-org6447290">
<p>
C-x 1：仅一个当前子窗口，其它关闭。
</p>

<p>
如： C-h k C-f 再按 C-x 1
</p>
</div>
</div>
<div id="outline-container-org0479bf3" class="outline-4">
<h4 id="org0479bf3">输入和删除文本</h4>
<div class="outline-text-4" id="text-org0479bf3">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#36755;&#20837;&#65306;&#38190;&#30424;&#36755;&#20837;</span>
&#25554;&#20837;&#25991;&#23383;&#24456;&#31616;&#21333;&#65292;&#30452;&#25509;&#25970;&#38190;&#30424;&#23601;&#21487;&#20197;&#20102;&#12290;
&#22823;&#37096;&#20998;&#30340; Emacs &#21629;&#20196;&#37117;&#21487;&#20197;&#25351;&#23450;&#37325;&#22797;&#27425;&#25968;&#65292;&#36825;&#20854;&#20013;&#20063;&#21253;&#25324;&#36755;&#20837;&#23383;&#31526;&#30340;
&#21629;&#20196;&#12290;&#22914;&#65306; C-u 8 *

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36755;&#20837; &lt;Return&gt; </span>
&lt;Return&gt; &#26159;&#19968;&#20010;&#29305;&#27530;&#30340;&#38190;&#65292;&#26681;&#25454;&#21608;&#22260;&#25991;&#26412;&#30340;&#19981;&#21516;&#65292;Emacs &#21487;&#33021;&#20250;&#22312;&#25442;&#34892;&#31526;&#20043;&#21518;&#25554;&#20837;&#19968;&#20123;&#31354;&#30333;&#23383;&#31526;&#65292;&#36825;&#26679;&#65292;
&#24403;&#20320;&#22312;&#26032;&#30340;&#19968;&#34892;&#24320;&#22987;&#25171;&#23383;&#26102;&#65292;&#25991;&#26412;&#20250;&#33258;&#21160;&#19982;&#21069;&#19968;&#34892;&#23545;&#40784;&#12290;

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;&#65306;</span>
&lt;DEL&gt;        &#21024;&#38500;&#20809;&#26631;&#21521;&#21069;&#30340;&#23383;&#31526;Delete the character just before the cursor
C-d          &#21024;&#38500;&#20809;&#26631;&#21521;&#21518;&#30340;&#23383;&#31526;Delete the next character after the cursor

M-&lt;DEL&gt;      &#21024;&#38500;&#20809;&#26631;&#21069;&#30340;&#35789;Kill the word immediately before the cursor
M-d              &#21024;&#38500;&#20809;&#26631;&#21518;&#30340;&#35789;Kill the next word after the cursor

C-k          &#21024;&#38500;&#20809;&#26631;&#21518;&#30340;&#34892;Kill from the cursor position to end of line
M-k          &#21024;&#38500;&#24403;&#21069;&#21477;&#23376;&#65288;&#24456;&#23569;&#29992;&#65289;Kill to the end of the current sentence
PS&#65306;&#25105;&#20204;&#21482;&#38656;&#35201;&#23398;&#20064;&#23383;&#31526;&#12289;&#35789;&#12289;&#34892;&#30340;&#25805;&#20316;&#23601;&#34892;

C-&lt;SPC&gt; C-w&#65306;&#21024;&#38500;&#36873;&#20013;&#21306;&#22495;&#12290;&#20351;&#29992; C-&lt;SPC&gt; &#26631;&#35760;&#28857;&#65292;&#20877;&#31227;&#21160;&#21040;&#19968;&#20010;&#20301;&#32622;&#65292;C-w &#21024;&#38500;&#12290;&#65292;C-&lt;SPC&gt; &#24448;
&#24448;&#34987;&#20013;&#25991;&#29992;&#25143;&#35774;&#23450;&#25104;&#36755;&#20837;&#27861;&#28909;&#38190;&#65292;&#21487;&#29992; C-@ &#20195;&#26367;

<span style="color: #b22222;"># </span><span style="color: #b22222;">"killing" and "deleting" &#30340;&#21306;&#21035;</span>
killing &#20250;&#34987; emacs &#35760;&#24405;&#19979;&#26469;&#65292;&#21487;&#20197;&#24674;&#22797;&#12290;&#37325;&#26032;&#35760;&#24405;&#30340; killed &#25991;&#26412;&#21483; yanking&#12290;
C-y&#65306;yanking &#30340;&#24555;&#25463;&#38190;&#26159; C-y &#65288;&#37325;&#35201;&#35201;&#35760;&#20303;&#65289;
&#22914;&#65306;C-k &#21024;&#38500;&#19968;&#34892;&#65292;C-y &#37325;&#26032;&#35760;&#24405;&#24674;&#22797;
M-y&#65306;&#19978;&#19968;&#27425; yanking &#25805;&#20316;&#25289;&#22238;&#26469;&#65292;&#21487;&#37325;&#22797;&#25805;&#20316;&#12290;&#24456;&#23569;&#29992;&#65292;&#25512;&#33616;&#20351;&#29992;&#25554;&#20214;&#23436;&#25104;&#31867;&#20284;&#25805;&#20316;
</pre>
</div>
</div>
</div>
<div id="outline-container-org2ff20de" class="outline-4">
<h4 id="org2ff20de">UNDO 撤销操作</h4>
<div class="outline-text-4" id="text-org2ff20de">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">undo</span>
C-/&#65306;undo&#25764;&#38144;&#25805;&#20316;&#12290;&#36824;&#21487;&#20351;&#29992; C-_ &#25110;&#32773; C-x u
&#22914;&#65306;C-k &#20877;&#25353; C-/
C-x z &#37325;&#22797;&#20043;&#21069;&#30340;&#25805;&#20316; &#37325;&#22797;&#22810;&#27425;&#21487;&#20197;&#21482;&#25353;zzzz

<span style="color: #b22222;"># </span><span style="color: #b22222;">redo &#21453;&#25764;&#38144;</span>
C-g C-/ &#25110;&#32773; C-g C-_ &#25110;&#32773; C-g C-x u
</pre>
</div>
</div>
</div>
<div id="outline-container-org63bf7b7" class="outline-4">
<h4 id="org63bf7b7">文件操作</h4>
<div class="outline-text-4" id="text-org63bf7b7">
<pre class="example" id="orgd4feb7c">
在状态栏会看到类似 " -:---  TUTORIAL" 文本表示当前打开文件名
C-x C-f：打开文件
C-x C-s：保存文件， C-x C-s TUTORIAL.cn &lt;Return&gt; 另存为文件名
</pre>
</div>
</div>
<div id="outline-container-orgc2988a1" class="outline-4">
<h4 id="orgc2988a1">BUFFERS 缓冲区</h4>
<div class="outline-text-4" id="text-orgc2988a1">
<div class="org-src-container">
<pre class="src src-shell">&#20351;&#29992; C-x C-f &#25171;&#24320;&#25991;&#20214;&#65292;&#20877;&#20999;&#25442;&#22238;&#26469;&#36824;&#20250;&#30475;&#21040;&#25171;&#24320;&#30340;&#20869;&#23481;&#65292;&#26159;&#22240;&#20026; emacs &#20250;&#25226;&#36825;&#20123;&#25991;&#26412;&#20869;&#23481;&#25918;&#21040; &#8220;buffer&#8221;&#20013;&#65292;&#27599;&#25171;&#24320;&#19968;&#20010;&#25991;&#20214;&#21019;&#24314;&#19968;&#20010;&#26032; buffer&#12290;
C-x C-b&#65306;&#21015;&#20986; buffer&#12290;&#27599;&#20010;&#25991;&#26412;&#26377;&#19968;&#20010; buffer &#21517;&#23383;&#12290;&#25353; q &#36864;&#20986;&#12290;
C-x b&#65306;&#20999;&#25442; buffer
C-x s&#65306;&#20445;&#23384; buffer &#65288;&#19981;&#24120;&#29992;&#65289;
<span style="color: #b22222;"># </span><span style="color: #b22222;">buffer</span>
*Messages*&#65306;&#36816;&#34892;&#21629;&#20196;&#30340;&#20449;&#24687;&#37117;&#20250;&#20986;&#29616;&#22312;&#36825;&#37324;
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf4b8dfb" class="outline-4">
<h4 id="orgf4b8dfb">命令集扩展</h4>
<div class="outline-text-4" id="text-orgf4b8dfb">
<p>
Emacs 的命令就像天上的星星，数也数不清。把它们都对应到 CONTROL 和 META
组合键上显然是不可能的。Emacs 用扩展（eXtend）命令来解决这个问题，扩展
命令有两种风格：
</p>

<pre class="example" id="org759423f">
C-x     字符扩展。  C-x 之后输入另一个字符或者组合键。如 C-x C-c 退出 emacs 和用 C-x b 切换缓冲区
M-x     命令名扩展。M-x 之后输入一个命令名。
</pre>

<p>
挂起，以切换到其他的应用程序
</p>
<div class="org-src-container">
<pre class="src src-shell">
</pre>
</div>

<p>
C-x：结合 vim 操作基本不用需要这个
</p>

<p>
M-x：非常常用。输入字符按 TAB 键支持补全
</p>

<p>
C-z：常用。linux 中把不用 C-z 要换成 C-x C-z，输入 fg 恢复到前台。
</p>

<p>
linux 中的作业管理
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#35753;&#20316;&#19994;&#36816;&#34892;&#20110;&#21518;&#21488;</span>
&#36816;&#34892;&#20013;&#30340;&#20316;&#19994;&#65306; Ctrl+z
&#23578;&#26410;&#21551;&#21160;&#30340;&#20316;&#19994;&#65306; COMMAND <span style="color: #8b2252;">\&amp;</span>
&#21518;&#21488;&#20316;&#19994;&#34429;&#28982;&#34987;&#36865;&#24448;&#21518;&#21488;&#36816;&#34892;&#65292;&#20294;&#20854;&#20381;&#28982;&#19982;&#32456;&#31471;&#30456;&#20851;&#65307;&#36864;&#20986;&#32456;&#31471;&#65292;&#23558;&#20851;&#38381;&#21518;&#21488;&#20316;&#19994;&#12290;&#22914;&#26524;&#24076;&#26395;&#36865;&#24448;&#21518;&#21488;&#21518;&#65292;&#21093;&#31163;&#19982;&#32456;&#31471;&#30340;&#20851;&#31995;
-    nohup COMMAND <span style="color: #8b2252;">\&amp;</span>&gt;/dev/null <span style="color: #8b2252;">\&amp;</span>
-    screen&#65307;COMMAND
-    tmux&#65307;COMMAN

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#30475;&#24403;&#21069;&#32456;&#31471;&#25152;&#26377;&#20316;&#19994;</span>
<span style="color: #483d8b;">jobs</span> &#65306;+/- &#34920;&#31034;&#20248;&#20808;&#32423;&#65307;&#24403;&#35843;&#29992;&#26102;&#19981;&#21152;&#20316;&#19994;&#21495;&#20250;&#40664;&#35748;&#35843;&#29992;+&#30340;&#21629;&#20196;

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20316;&#19994;&#25511;&#21046;</span>
-    &#21069;&#21488;&#20316;&#19994;:&#36890;&#36807;&#32456;&#31471;&#21551;&#21160;,&#19988;&#21551;&#21160;&#21518;&#19968;&#30452;&#21344;&#25454;&#32456;&#31471;
-    &#21518;&#21488;&#20316;&#19994;:&#21487;&#36890;&#36807;&#32456;&#31471;&#21551;&#21160;,&#20294;&#21551;&#21160;&#21518;&#21363;&#36716;&#20837;&#21518;&#21488;&#36816;&#34892;(&#37322;&#25918;&#32456;&#31471;)  
<span style="color: #483d8b;">fg</span> [[%]JOB_NUM]&#65306;&#25226;&#25351;&#23450;&#30340;&#21518;&#21488;&#20316;&#19994;&#35843;&#22238;&#21069;&#21488;
<span style="color: #483d8b;">bg</span> [[%]JOB_NUM]&#65306;&#35753;&#36865;&#24448;&#21518;&#21488;&#30340;&#20316;&#19994;&#22312;&#21518;&#21488;&#32487;&#32493;&#36816;&#34892;
<span style="color: #483d8b;">kill</span> [%JOB_NUM]&#65306; &#32456;&#27490;&#25351;&#23450;&#30340;&#20316;&#19994; 
</pre>
</div>
</div>
</div>
<div id="outline-container-org954c487" class="outline-4">
<h4 id="org954c487">自动保存</h4>
<div class="outline-text-4" id="text-org954c487">
<pre class="example" id="org0b72e6a">
默认自带，会把要保存的文件名自动保存为#文件名#。这个文件会在正常存盘之后被 Emacs 删除。
如：“helle.c” 自动保存“#hello.c#”

假如不幸真的发生了，你大可以从容地打开原来的文件，使用  M-x recover-this-file 恢复之前保存的版本。
</pre>

<p>
我把自动保存的版本都放在 ~/.backups 目录下。自动保存的文件几乎不会用到，emacs 非常稳定。
</p>
</div>
</div>
<div id="outline-container-orgca54f37" class="outline-4">
<h4 id="orgca54f37">回显区（ECHO AREA）</h4>
<div class="outline-text-4" id="text-orgca54f37">
<p>
如果 Emacs 发现你输入多字符命令的节奏很慢，它会在窗格的下方称为“回显区”
的地方给你提示。回显区位于屏幕的最下面一行。也叫 minibuffer。例如输出信息， <code>M-x</code> 操作等。
</p>
</div>
</div>
<div id="outline-container-org4591b40" class="outline-4">
<h4 id="org4591b40">状态栏（MODE LINE）</h4>
<div class="outline-text-4" id="text-org4591b40">
<p>
位于回显区正上方的一行被称为“状态栏”，也叫模式栏。会说明很多重要信息
</p>

<pre class="example" id="orgb2caf5b">
-:**-  TUTORIAL.cn       63% L749    (Fundamental)

-NN%-- 显示的是光标在全文中的位置, 在开头--Top--，未尾 --Bot--，全部 --All--
“L” 和其后的数字给出了光标所在行的行号
最开头的星号（*）表示你已经对文字做过改动。刚刚打开的文件肯定没有被改动过，所以状态栏上显示的不是星号而是短线（-）
状态栏上小括号里的内容告诉你当前正在使用的编辑模式。缺省的模式是 Fundamental，就是你现在正在使用的这个。它是一种“主模式”。
</pre>

<p>
emacs 有很 marjor mode，每种语言对应一个 marjor mode。
</p>

<p>
每一个 marjor mode 都会对生命令做一个强化或改变。比如写注释，因为每种语言的注释风格是不一样的。可切入不语言的 mode
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#20999;&#21040; text-mode</span>
M-x text-mode
C-h m&#65306;&#26597;&#30475;&#24403;&#21069; mode &#25991;&#26723;
</pre>
</div>

<p>
除 marjor mode 外还有 minor mode ，它没有和编程语言绑定，是为加强 marjor mode 的。
</p>
</div>
</div>
<div id="outline-container-org8802e4f" class="outline-4">
<h4 id="org8802e4f">搜索</h4>
<div class="outline-text-4" id="text-org8802e4f">
<pre class="example" id="org84f117a">
C-s：向下搜索。
C-r：反向搜索（很少用）
</pre>

<p>
但主要还是用 vim 的搜索， C-s 会保留一些额外加强版的命令
</p>
</div>
</div>
<div id="outline-container-org8215cb1" class="outline-4">
<h4 id="org8215cb1">多子窗口</h4>
<div class="outline-text-4" id="text-org8215cb1">
<pre class="example" id="orgfb683b7">
C-x 2：水平分割窗口
C-x 3：垂直分割窗口
C-x o：切换子窗口

在一个新开窗格里打开文件：
C-x 4 C-f，紧跟着输入一个文件，输入 C-x o 回到上方的窗格，然后再用 C-x 1 关掉下方窗格。
</pre>

<p>
更高效的是 vim 操作方式
</p>
</div>
</div>
<div id="outline-container-org936111a" class="outline-4">
<h4 id="org936111a">多FRAMES</h4>
<div class="outline-text-4" id="text-org936111a">
<p>
图形界面中会常用到，命令行界面用不到。
</p>

<pre class="example" id="org73f6b90">
C-x 5 2：新建
C-x 5 0：删除当前
</pre>
</div>
</div>
<div id="outline-container-org099907f" class="outline-4">
<h4 id="org099907f">帮助</h4>
<div class="outline-text-4" id="text-org099907f">
<p>
一定要掌握
</p>

<div class="org-src-container">
<pre class="src src-shell">C-h a&#65306;&#26597;&#25214;&#21629;&#20196;
C-h ?&#65306;&#21487;&#20197;&#30475;&#21040; C-h &#21518;&#38754;&#26377;&#21738;&#20123;&#21487;&#29992;&#30340;&#24110;&#21161;

describe-varible C-h v     &#65306;&#23547;&#25214;&#21464;&#37327;&#30340;&#24110;&#21161;&#20449;&#24687;&#12290;&#22914;&#20809;&#26631;&#20572;&#30041;&#22312;&#21464;&#37327;&#19978;&#65292;C-h v
describe-function C-h f    &#65306;&#23547;&#25214;&#20989;&#25968;&#30340;&#24110;&#21161;&#20449;&#24687;  &#22914;save-buffer&#21151;&#33021;&#65292;&#20351;&#29992;C-h f&#20877;&#36755;&#20837;save-buffer
describe-bindings C-h b    &#65306;&#38190;&#32465;&#23450;
describe-symbol C-h o      &#65306;&#31526;&#21495;

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36890;&#36807;&#38190;&#30424; &#36755;&#20837;&#19968;&#20010;&#38190;&#32465;&#23450;</span>
describe-key-briefly C-h c &#65306;&#31616;&#36848;&#21629;&#20196;
describe-key C-h k         &#65306;&#23547;&#25214;&#24555;&#25463;&#38190;&#30340;&#24110;&#21161;&#20449;&#24687; &#22914;&#26597;&#30475;C-x C-s&#65292;&#20351;&#29992;C-h k&#20877;&#36755;&#20837;C-x C-s

C-h i&#65306;&#23448;&#26041;&#25991;&#26723;
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org440154b" class="outline-3">
<h3 id="org440154b">Emacs的自由开放使其有一些独特的功能</h3>
<div class="outline-text-3" id="text-org440154b">
<p>
以Emacs子窗口布局的特有功能说明自由软件的意义。以VSCode作为对比。
</p>
</div>
<div id="outline-container-org3dd2b62" class="outline-4">
<h4 id="org3dd2b62">workgroups2 插件</h4>
<div class="outline-text-4" id="text-org3dd2b62">
<p>
[workgroups2](<a href="https://github.com/pashinin/workgroups2">https://github.com/pashinin/workgroups2</a>) 插件
</p>

<p>
可以保存工作窗口布局，下次直接使用。
</p>

<pre class="example" id="orgcaf3875">
Use M-x wg-create-workgroup to save save window&amp;buffer layout as a work group. SPC-s s
Use M-x wg-open-workgroup to open an existing work group.  SPC-l l
Use M-x wg-kill-workgroup to delete an existing work group.

布局文件位置： ~/.emacs_workgroups
</pre>

<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#21019;&#24314;&#24067;&#23616;p2&#65292;2&#20010;&#22402;&#30452;&#20998;&#23631;</span>
C-3 &#21019;&#24314;&#22402;&#30452;&#20998;&#23631;
SPC-s s &#20197;&#24403;&#21069;&#24067;&#23616;&#20026;&#26032;&#24314;&#24067;&#23616;&#65292;&#26032;&#24067;&#23616;&#21629;&#21517;&#20026; p2

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21478;&#19968;&#20010;&#31383;&#21475;&#37325;&#26032;&#21152;&#36733;&#24067;&#23616;</span>
SPC-l l &#21015;&#20986;&#25152;&#26377;&#20445;&#23384;&#30340;&#24067;&#23616;&#65292;&#36873;&#25321; p2 &#24067;&#23616;
</pre>
</div>

<p>
PS:
初学 emacs 尽量用高手的配置，等熟悉后再定自己的配置或者开发自己的插件。
</p>
</div>
</div>
</div>
<div id="outline-container-orgdae6a53" class="outline-3">
<h3 id="orgdae6a53">如何测量并优化工作流</h3>
<div class="outline-text-3" id="text-orgdae6a53">
</div>
<div id="outline-container-orgc2f4418" class="outline-4">
<h4 id="orgc2f4418">keyfreq 统计命令使用 插件</h4>
<div class="outline-text-4" id="text-orgc2f4418">
<p>
<a href="https://github.com/dacap/keyfreq">https://github.com/dacap/keyfreq</a>
</p>

<pre class="example" id="org6899af4">
M-x keyfreq-mode
keyfreq-show：查看命令使用情况
</pre>

<p>
范例：优化查找替换，用 vim 中搜索替换，而不是 . 点号重复操作。
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">1. &#25628;&#32034;&#26367;&#25442;</span>
,rb&#65306;leader&#38190;&#65292;&#26597;&#25214;&#26367;&#25442;&#12290;&#36873;&#20013;&#23383;&#31526; :<span style="color: #8b2252;">'&lt;,'</span>&gt;s/<span style="color: #8b2252;">\&lt;</span>(&#36873;&#20013;&#30340;&#23383;&#31526;<span style="color: #8b2252;">\)\&gt;</span>/&#35201;&#26367;&#25442;&#25104;&#30340;&#23383;&#31526;/g
<span style="color: #b22222;"># </span><span style="color: #b22222;">2. &#35201;&#24674;&#22797;&#30340;&#20869;&#23481;</span>
&#20351;&#29992; git diff &#26469;&#30830;&#35748;&#24674;&#22797;&#21738;&#20123;&#20869;&#23481;
</pre>
</div>

<p>
查自己键盘的磨损情况，查自己命令的使用情况是否和高手一致，找到优化点。
</p>
</div>
</div>
</div>
<div id="outline-container-orgd31cff4" class="outline-3">
<h3 id="orgd31cff4">文本编辑的核武器</h3>
<div class="outline-text-3" id="text-orgd31cff4">
<p>
原文：<a href="https://sam217pa.github.io/2016/09/11/nuclear-power-editing-via-ivy-and-ag/">Nuclear weapon multi-editing via Ivy and Ag</a>
</p>

<p>
就是在多文件中查找替换的技巧
</p>

<div class="org-src-container">
<pre class="src src-shell">,qq&#65306;&#22810;&#25991;&#20214;&#26597;&#25214;&#23383;&#31526;&#12290;&#36825;&#37324;&#29992;&#30340; grep&#65292;&#27809;&#29992; ag
C-c C-o&#65306;&#36827;&#20837; ivy-occur &#20013;&#12290;&#22914;&#26524;&#24819;&#25490;&#38500;&#26576;&#25991;&#20214;&#21487;&#36755;&#20837;&#27491;&#21017; !code.js
C-x C-q&#65306;&#21464;&#25104;&#21487;&#32534;&#36753;&#30340;
dd&#65306;&#25490;&#38500;&#19981;&#38656;&#35201;&#22788;&#29702;&#30340;&#34892;&#65288;&#21487;&#36873;&#65289;
,rb&#65306;&#26597;&#25214;&#26367;&#25442;&#12290;&#21363; :<span style="color: #8b2252;">'&lt;,'</span>&gt;s/<span style="color: #8b2252;">\&lt;</span>(&#36873;&#20013;&#30340;&#23383;&#31526;<span style="color: #8b2252;">\)\&gt;</span>/&#35201;&#26367;&#25442;&#25104;&#30340;&#23383;&#31526;/g  &#12290;  &#36825;&#37324;&#29992;&#30340;&#26159;&#33258;&#24049;&#20889;&#30340;&#20195;&#30721;&#12290;
C-c C-c&#65306;&#23436;&#25104;

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21024;&#38500;&#34892;</span>
&#22312; dd &#25442;&#25104; C-c C-d &#21024;&#38500;&#34892;&#65292;&#27492;&#20026; wgrep &#25554;&#20214;&#28304;&#20195;&#30721;&#26377;&#20889;
</pre>
</div>

<p>
发挥自己的主动性，读源代码。
</p>

<p>
git 设置能考： <a href="http://blog.binchen.org/posts/my-git-set-up/">http://blog.binchen.org/posts/my-git-set-up/</a>
</p>
</div>
</div>
<div id="outline-container-orgf1c68eb" class="outline-3">
<h3 id="orgf1c68eb">少有人知道的打开文件的技巧</h3>
<div class="outline-text-3" id="text-orgf1c68eb">
<p>
除Emacs之外的其他工具（包括Vim）在打开文件上总是有这样那样的遗憾之处。
只是演示，自主修改。
</p>

<p>
find-file-in-project 插件 <a href="https://github.com/redguardtoo/find-file-in-project">https://github.com/redguardtoo/find-file-in-project</a> 作者 chenbin
</p>

<pre class="example" id="org4c698e7">
",kk" 'find-file-in-project-by-selected 找文件
",jj" 'find-file-in-project-at-point  在文本中找文件
",tt" 'find-file-in-current-directory   找目录， C-u 1 ,tt 在上层找目录
</pre>
</div>
</div>
<div id="outline-container-org26c63c2" class="outline-3">
<h3 id="org26c63c2">操作子窗口最理想的技巧</h3>
<div class="outline-text-3" id="text-org26c63c2">
<p>
此技巧被著名的emacs配置spacemacs作者采用，已被许多Emacs用户采用
</p>

<p>
leader 键来优化操作。
</p>

<p>
窗口编号：数字加下划线，分配最方便的快捷键，使用 leader 键最方便。
</p>

<p>
插件
</p>
<pre class="example" id="org66e78a5">
winum  https://github.com/deb0ch/emacs-winum
M-1 M-2 窗口切换，窗口编号在左下角。但 alt 键在不同的键盘上有差异，按起来不方便 。

使用 leader 键
,1  ,2 来切换窗口

其他插件：ace-window ，窗口编号在左上角
</pre>
</div>
</div>
</section>
<section id="outline-container-org15f8c76" class="outline-2">
<h2 id="org15f8c76">第8章 打造自由智能的开发环境</h2>
<div class="outline-text-2" id="text-org15f8c76">
<p>
懒熊的Emacs 插件开发手册：<a href="https://manateelazycat.github.io/emacs/elisp/2022/11/18/write-emacs-plugin.html">https://manateelazycat.github.io/emacs/elisp/2022/11/18/write-emacs-plugin.html</a>
</p>
</div>
<div id="outline-container-org82d95a5" class="outline-3">
<h3 id="org82d95a5">使用脚本和开源自由的命令行工具强化开发环境</h3>
<div class="outline-text-3" id="text-org82d95a5">
<p>
拓展自己的能力 。
</p>

<p>
elisp 作为拓展编辑器的语言，它的功能是是非常强的，几乎所有的功能都能实现。如：
</p>

<ul class="org-ul">
<li>代码导航</li>
<li>代码自动完成</li>
<li>在项目中找文件  <code>,jj</code>     其中： <code>,bb</code> 上个文件， <code>pwd</code> 当前路径</li>
</ul>
</div>
</div>
<div id="outline-container-org8de6548" class="outline-3">
<h3 id="org8de6548">理解环境变量</h3>
<div class="outline-text-3" id="text-org8de6548">
<p>
设置 2 个环境变量即可。macOS 和 linux 都有不用额外设置
</p>
<ul class="org-ul">
<li>HOME: 在 windows 才会设置的。如  D:\cygwin64\home\Administrator</li>
<li>PATH: 可执行程序存放的目录。</li>
</ul>
</div>
</div>
<div id="outline-container-org7c43e2d" class="outline-3">
<h3 id="org7c43e2d">在Windows上安装Cygwin</h3>
<div class="outline-text-3" id="text-org7c43e2d">
<p>
官方：<a href="https://www.cygwin.com/">https://www.cygwin.com/</a>
</p>

<p>
emacs.d 配置中的一些插件需要使用 linux 中的 find, grep, ctags, git, vim 等命令。
</p>


<figure id="org31aa8d2">
<img src="./images/image-20220115001718631.png" alt="image-20220115001718631.png">

</figure>
</div>
</div>
<div id="outline-container-org6aafe3f" class="outline-3">
<h3 id="org6aafe3f">在macOS上安装Homebrew</h3>
<div class="outline-text-3" id="text-org6aafe3f">
<p>
<a href="https://brew.sh/">https://brew.sh/</a>
</p>

<div class="org-src-container">
<pre class="src src-shell">/bin/bash -c <span style="color: #8b2252;">"$(</span><span style="color: #ff00ff;">curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh</span><span style="color: #8b2252;">)"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9621c35" class="outline-3">
<h3 id="org9621c35">在Linux上使用Apt安装第三方软件</h3>
<div class="outline-text-3" id="text-org9621c35">
<p>
<a href="https://distrowatch.com/">https://distrowatch.com/</a>  可以看到当前比较流行的 linux 版本。其中 Ubuntu 和 Debian 都是用的 apt 软件包管理工具。
</p>

<div class="org-src-container">
<pre class="src src-shell">sudo apt install git <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23433;&#35013; tags, git&#31561;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfdd47b2" class="outline-3">
<h3 id="orgfdd47b2">Emacs Lisp基础: 变量</h3>
<div class="outline-text-3" id="text-orgfdd47b2">
<p>
Emacs Lisp 用来配置 Emacs 和写Emacs 插件。
</p>

<p>
emacs lisp 是拓展编辑器的强大功能。我们不需要在记快捷键命令上浪费太多时间，只需要记住最关键常用的快捷键
</p>
</div>
<div id="outline-container-orgc3c26d6" class="outline-4">
<h4 id="orgc3c26d6">常用命令</h4>
<div class="outline-text-4" id="text-orgc3c26d6">
<ul class="org-ul">
<li>eval-expression：,ee 查看表达式的结果</li>
<li>eval-buffer：,eb 把缓冲区所有代码全部运行一遍</li>
</ul>
</div>
</div>
<div id="outline-container-org06acbfd" class="outline-4">
<h4 id="org06acbfd">emacs 语法</h4>
<div class="outline-text-4" id="text-org06acbfd">
<p>
任何东西都是函数，包括加号减号。
</p>

<p>
如：
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#25340;&#25509; 2 &#20010;&#23383;&#31526;&#20018;</span>
(concat  <span style="color: #8b2252;">"abc"</span> <span style="color: #8b2252;">"def"</span>)  ;; <span style="color: #8b2252;">"abcdef"</span>  &#25340;&#25509; 2 &#20010;&#23383;&#31526;&#20018;
(&#20989;&#25968;&#21517; &#21442;&#25968; &#21442;&#25968;)
</pre>
</div>
</div>
</div>
<div id="outline-container-org5ade722" class="outline-4">
<h4 id="org5ade722">变量</h4>
<div class="outline-text-4" id="text-org5ade722">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#32473;&#21464;&#37327;&#36171;&#20540;</span>
(setq a 3)  ;; 3 &#32473;&#21464;&#37327;&#36171;&#20540;
(setq b <span style="color: #8b2252;">"abc"</span>) ;; <span style="color: #8b2252;">"abc"</span>   &#36873;&#20013;&#20869;&#23481; va(&#65292;M-x eval-expression &#25353; C-y &#22238;&#36710;&#25191;&#34892;&#21629;&#20196;
</pre>
</div>

<p>
调试
</p>

<p>
使用 <code>*Messages*</code> 来调试
</p>



<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#31383;&#21475;1&#20013;&#36755;&#20837;&#27979;&#35797;&#21464;&#37327;</span>
(setq a 3)
(setq b <span style="color: #8b2252;">"abc"</span>)
(setq c <span style="color: #8b2252;">"eeee"</span>)

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20999;&#25442;&#31383;&#21475;2&#26174;&#31034;&#35843;&#35797;&#20449;&#24687;</span>
C-x 3 (,x3)&#65306;  &#22402;&#30452;&#20999;&#20998;&#23631;
M-2&#65306;&#20999;&#21040;2&#21495;&#23631;&#12290;winum &#25554;&#20214;&#24555;&#25463;&#38190;&#65292;&#25110;&#32773;&#20351;&#29992; leader &#38190; ,2 &#26469;&#20999;&#25442;&#31383;&#21475;&#65292;&#25110;&#32773;&#29992;&#33258;&#24102;&#30340; C-x o
C-x b&#65306;  &#25214;&#21040; *Messages*
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20999;&#25442;&#22238;&#31383;&#21475;1 &#25191;&#34892;&#21464;&#37327;</span>
M-x eval-buffer (,eb)&#65306;&#25226;&#32531;&#20914;&#21306;&#25152;&#26377;&#20195;&#30721;&#20840;&#37096;&#36816;&#34892;&#19968;&#36941;
M-x eval-expression (,ee) &#65292;&#36755;&#20837; c &#26597;&#30475;&#21464;&#37327;&#30340;&#32467;&#26524;
M-x erase-buffer&#65306;&#28165;&#31354;&#24403;&#21069;&#32531;&#20914;&#21306;
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org07c8d84" class="outline-3">
<h3 id="org07c8d84">Emacs Lisp基础: 函数</h3>
<div class="outline-text-3" id="text-org07c8d84">
<pre class="example" id="orgfbf6c9a">
;; define function
(defun hello(v1)
  "Hello worl"
  (message "hello world")
  (+ v1 3)
  )
</pre>

<p>
使用
</p>
<ul class="org-ul">
<li>M-x eval-buffer (,eb)：运行当前缓冲区所有命令</li>
<li>M-x eval-expression (,ee) ：查看表达式的结果，回输入 (hello 3)  给出为 3</li>
</ul>

<p>
注意：
函数最后一行结果就是返回值，不用写 return。Messages 显示函数执行过程和函数返回值
</p>

<p>
函数文档开头需大写，如"Hello worl"
</p>
</div>
<div id="outline-container-orgc884d41" class="outline-4">
<h4 id="orgc884d41">内置的函数</h4>
<div class="outline-text-4" id="text-orgc884d41">
<ul class="org-ul">
<li>message 函数，打印一段信息，支持格式化打印</li>
</ul>


<p>
范例：message 函数
</p>

<pre class="example" id="org77896db">
;; defind function
(defun hello (v1 v2 v3)
  (message "v1=%s v2=%s v3=%s" v1 v2 v3)
  )

使用：
M-x eval-buffer (,eb)：运行当前缓冲区所有命令
M-x eval-expression (,ee) ：查看表达式的结果
(hello a b c)  给出为 "v1=3 v2=abc v3=eeee"
</pre>
</div>
</div>
<div id="outline-container-org2acf9b4" class="outline-4">
<h4 id="org2acf9b4">可交互函数</h4>
<div class="outline-text-4" id="text-org2acf9b4">
<p>
函数中添加 interactive 就可以在加载完缓冲区命令后直接使用 M-x 调用这个函数了
</p>


<p>
范例：
</p>

<pre class="example" id="org9eb75d7">
;; function =&gt; interactive command
(defun bye ()
  (interactive)
  (message "bye world")
  (insert "this is a new line\n"))

;;;;;
this is a new line

使用：
M-x eval-buffer (,eb)：运行当前缓冲区所有命令
M-x bye
其中 insert 函数，在当前缓冲区光标位置插入字符串
</pre>
</div>
</div>
</div>
<div id="outline-container-org81734a2" class="outline-3">
<h3 id="org81734a2">Emacs Lisp基础： 运算符</h3>
<div class="outline-text-3" id="text-org81734a2">
<p>
实际上运算符就是函数。
</p>

<p>
<code>+ - * /</code>
</p>

<p>
范例
</p>

<pre class="example" id="orgc4e6c45">
(defun op (v1 v2 v3)
  (interactive)
  (message "(+ v1 v2 v3)=%s" (+ v1 v2 v3))
  (- v1 v2 v3)
  (* v1 v2 v3)
  (/ v1 v2 v3)
  )

使用：
M-x eval-buffer (,eb)：运行当前缓冲区所有命令
M-x eval-expression (,ee) ：查看表达式的结果，(op 3 4 5)
</pre>
</div>
<div id="outline-container-orgc0fa7ba" class="outline-4">
<h4 id="orgc0fa7ba">其它函数</h4>
<div class="outline-text-4" id="text-orgc0fa7ba">
<div class="org-src-container">
<pre class="src src-shell">(concat v1 <span style="color: #8b2252;">"dddd"</span> <span style="color: #8b2252;">"ee"</span> <span style="color: #8b2252;">"333"</span>)) ;; &#23383;&#31526;&#20018;&#25340;&#25509;
(substring v1 0 1) ;; &#21462;&#23383;&#31526;&#20018;&#20013;&#19979;&#26631; 0 - 1 &#20043;&#38388;&#30340;&#23383;&#31526;
(string-trim v1) ;; &#21435;&#25481;&#39318;&#23614;&#31354;&#26684;
(string-equal v1 v2) ;;  &#27604;&#36739;&#23383;&#31526;&#20018;&#26159;&#21542;&#30456;&#31561;&#65292;t &#20026; true&#65292;false &#20026; nil
(setq d nil)
(setq d t)
</pre>
</div>

<ul class="org-ul">
<li>C-h f 来查看函数的帮助</li>
<li>C-h C-f （需要提前配置好）跳转到函数源代码，使用 C-o 回退到旧位置，或者 C-x k 删除 buffer 来回退。</li>
<li>C-h k 查看快捷键绑定的函数</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org3703d13" class="outline-3">
<h3 id="org3703d13">Emacs Lisp基础: 数据结构</h3>
<div class="outline-text-3" id="text-org3703d13">
</div>
<div id="outline-container-org284e097" class="outline-4">
<h4 id="org284e097">list 函数</h4>
<div class="outline-text-4" id="text-org284e097">
<p>
list 函数，返回 list 列表，比较常用。像 array, hastable 不常用，且性能不好
</p>

<div class="org-src-container">
<pre class="src src-shell">;; list a =&gt; b =&gt; c =&gt; e =&gt; list-fend
(setq my-list (list <span style="color: #8b2252;">"a"</span> <span style="color: #8b2252;">"b"</span> 1 2)) ;; (<span style="color: #8b2252;">"a"</span> <span style="color: #8b2252;">"b"</span> 1 2)  list &#20989;&#25968;&#21442;&#25968;&#21487;&#20197;&#26159;&#21464;&#37327;
;; &#31616;&#20889; list &#20989;&#25968;
(setq my-list2 <span style="color: #8b2252;">'("a" "b" 1))    ;; ("a" "b" 1) &#30452;&#25509;&#36820;&#22238; list, &#20294;&#19981;&#25903;&#25345;&#21464;&#37327;&#36171;&#20540;&#36816;&#31639;</span>

<span style="color: #8b2252;">;; list &#20989;&#25968;&#21442;&#25968;&#21487;&#20197;&#26159;&#21464;&#37327;</span>
<span style="color: #8b2252;">(setq a 3)</span>
<span style="color: #8b2252;">(setq b "abc")</span>
<span style="color: #8b2252;">(setq c "eeee")</span>

<span style="color: #8b2252;">(setq my-list3 (list a b c))  ;; (3 "abc" "eeee")</span>
<span style="color: #8b2252;">(setq my-list4 (list (+ 1 2) 3)) ;; (3 3)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3f2f357" class="outline-4">
<h4 id="org3f2f357">list 操作</h4>
<div class="outline-text-4" id="text-org3f2f357">
<ul class="org-ul">
<li>car 函数，取 list 头一个元素</li>
<li>cdr 函数，取 list 除头一个元素外的元素，返回一个新 list</li>
<li>nth 函数，取 list 中第 n 个元素，0 表示第一个元素。</li>
</ul>

<pre class="example" id="orgd0227b2">
(setq my-list2 '("a" "b" 1)
(message "car=%s" (car my-list2))  ;; "car=a"
(message "cdr=%s" (cdr my-list2))  ;; "cdr=(b 1)"
(message "nth(0)=%s nth(1)=%s" (nth 0 my-list) (nth 1 my-list2)) ;; "nth(0)=a nth(1)=b"   正常模式使用 vab 可选中括号中内容进行复制。
</pre>

<ul class="org-ul">
<li>listp 函数，判断 list 是否是 list</li>
<li>length 函数，list 长度</li>
</ul>

<pre class="example" id="orgfee0da2">
;; listp stringp numberp
(message "listp=%s" (listp my-list)) ;; listp=t
(length my-list)   ;; 4
</pre>

<ul class="org-ul">
<li>cons 函数，类似 list ，但参数只有 2 个</li>
</ul>

<pre class="example" id="org78507a6">
;; a =&gt; b =&gt; list-end   consp
(setq my-cons (cons "abcde" "bbb")) ;;  等价于 (setq my-cons '("abcde" . "bbb"))
(message "car=%s cdr=%s type of cdr=%s" (car my-cons) (cdr my-cons) (stringp (cdr my-cons)))  ;; car=abcde cdr=bbb type of cdr=t
(message "type=%s" (consp my-cons)) ;; type=t
</pre>
</div>
</div>
</div>
<div id="outline-container-org1f3282a" class="outline-3">
<h3 id="org1f3282a">Emacs Lisp基础: 正则表达式</h3>
<div class="outline-text-3" id="text-org1f3282a">
<p>
参考：<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Regular-Expressions.html">https://www.gnu.org/software/emacs/manual/html_node/elisp/Regular-Expressions.html</a>
</p>

<p>
vs 正则手册 <a href="https://docs.microsoft.com/en-us/visualstudio/ide/using-regular-expressions-in-visual-studio?view=vs-2022">https://docs.microsoft.com/en-us/visualstudio/ide/using-regular-expressions-in-visual-studio?view=vs-2022</a>
</p>

<p>
emacs 中的正则语法与 vim 比较接近。
</p>

<p>
常用的正则表达式函数：
</p>

<ul class="org-ul">
<li>replace-regex</li>
</ul>

<p>
(replace-regexp-in-string 正则 替换 字符串)： 给定一个字符串搜索某个模式，然后把它替换掉。经常用来过滤不需要的文本
</p>

<p>
(string-match 正则 字符串)：  正则表达式是否匹配字符串
</p>

<p>
(match-sting num string)：把匹配到的取出来
</p>

<div class="org-src-container">
<pre class="src src-shell">;; replace-regexp-in-string
;; mactch-string string-match

;;
;; replace-regexp-in-string
;; &#32473;&#23450;&#19968;&#20010;&#23383;&#31526;&#20018;&#25628;&#32034;&#26576;&#20010;&#27169;&#24335;&#65292;&#28982;&#21518;&#25226;&#23427;&#26367;&#25442;&#25481;
(setq str <span style="color: #8b2252;">"abc1339def"</span>)
(setq a (replace-regexp-in-string <span style="color: #8b2252;">"[0-9]+"</span> <span style="color: #8b2252;">""</span> str)) ;; <span style="color: #8b2252;">"abcdef"</span>


;; string-match &#27491;&#21017;&#34920;&#36798;&#24335;&#26159;&#21542;&#21305;&#37197;&#23383;&#31526;&#20018;
;; match-string &#25226;&#19978;&#20010;&#21305;&#37197;&#36820;&#22238;&#30340;
;; &#23383;&#31526;&#20018;&#30340; 2 &#20010;&#26012;&#26464;&#20250;&#35299;&#37322;&#20026; <span style="color: #8b2252;">\(\)</span> &#31867;&#20284;&#20110; grep &#20013;&#30340; group &#32452;&#23450;&#20041;
(when (string-match <span style="color: #8b2252;">"[a-z]*\\([0-9]*\\)[a-z]*"</span> str)
  (message (match-string 1 str)))
</pre>
</div>
</div>
</div>
<div id="outline-container-org029389a" class="outline-3">
<h3 id="org029389a">Emacs Lisp基础: 语句(statement</h3>
<div class="outline-text-3" id="text-org029389a">
<p>
`if when unless cond while dolist and or let* mapcar`
所有运算符都是函数
</p>
</div>
<div id="outline-container-orgb9efe52" class="outline-4">
<h4 id="orgb9efe52">if</h4>
<div class="outline-text-4" id="text-orgb9efe52">
<div class="org-src-container">
<pre class="src src-shell">;; <span style="color: #a020f0;">if</span> when unless cond while dolist and or let* mapcar
;; &#25152;&#26377;&#36816;&#31639;&#31526;&#37117;&#26159;&#20989;&#25968;

;; <span style="color: #a020f0;">if</span> &#34920;&#36798;&#24335;&#20026;&#30495;&#21482;&#33021;&#25191;&#34892;&#21518;&#38754;&#19968;&#26465;&#35821;&#21477;&#65292;&#21542;&#21017;&#25191;&#34892;&#21518;&#38754;&#20854;&#23427;&#35821;&#21477;(<span style="color: #a020f0;">if</span> COND THEN ELSE...)
(setq my-cond t)
(<span style="color: #a020f0;">if</span> my-cond (message <span style="color: #8b2252;">"if: my-cond true is true"</span>)  ;; my-cond &#20026;&#30495;&#26102;&#25191;&#34892;
  (message <span style="color: #8b2252;">"bye"</span>)       ;; my-cond &#20026;&#20551;&#26102;&#25191;&#34892;
  (message <span style="color: #8b2252;">"bye bye"</span>)   ;; my-cond &#20026;&#20551;&#26102;&#25191;&#34892;
  )
;; <span style="color: #a020f0;">if</span> &#35821;&#21477;&#19968;&#33324;&#19981;&#24314;&#35758;&#29992;&#65292;&#21487;&#20197;&#29992;&#20854;&#23427;&#35821;&#21477;&#26367;&#25442;
</pre>
</div>

<p>
当 if 为真时要执行多条语句使用 progn  包含
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">and</span> (buffer-file-name) (buffer-modified-p))
    (<span style="color: #a020f0;">progn</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25226;&#24403;&#21069; buffer &#30340;&#21517;&#23383;&#21387;&#36827; autosave-buffer-list &#21015;&#34920;&#65292; &#29992;&#20110;&#21518;&#38754;&#30340;&#20445;&#23384;&#25552;&#31034;</span>
      (<span style="color: #a020f0;">push</span> (buffer-name) autosave-buffer-list)
      (<span style="color: #a020f0;">if</span> auto-save-slient
          (<span style="color: #a020f0;">with-temp-message</span> <span style="color: #8b2252;">""</span>
            (basic-save-buffer))
        (basic-save-buffer))
      )))
</pre>
</div>
</div>
</div>
<div id="outline-container-org50d18bc" class="outline-4">
<h4 id="org50d18bc">when</h4>
<div class="outline-text-4" id="text-org50d18bc">
<div class="org-src-container">
<pre class="src src-shell">;; when &#21518;&#38754;&#34920;&#36798;&#24335;&#20026;&#30495;&#26102;&#25191;&#34892;&#65292;&#21542;&#21017;&#32773;&#19981;&#25191;&#34892;(when COND BODY...)
(setq my-cond t)
(when my-cond
  (message <span style="color: #8b2252;">"when: my-cond true is true"</span>)
  (message <span style="color: #8b2252;">"bye"</span>))
(when (not my-cond) ;; &#24067;&#23572;&#34920;&#36798;&#24335;&#65292;&#22914;&#26524;&#19981;&#20026;&#30495;&#25191;&#34892;&#19979;&#38754;&#35821;&#21477;
  (message <span style="color: #8b2252;">"when: my-cond true is nil"</span>)
  (message <span style="color: #8b2252;">"bye"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-org07da714" class="outline-4">
<h4 id="org07da714">unless</h4>
<div class="outline-text-4" id="text-org07da714">
<div class="org-src-container">
<pre class="src src-shell">;; unless &#31561;&#20215;&#20110; not&#12290;&#22914;&#26524;&#19981;&#31526;&#21512;&#26465;&#20214;&#25191;&#34892;&#21518;&#38754;&#35821;&#21477;
;; (not OBJECT)
;; (unless COND BODY...)
(setq my-cond nil)
(unless my-cond
  (message <span style="color: #8b2252;">"unless: my-cond nil is true"</span>)
  (message <span style="color: #8b2252;">"bye"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-org7842c9a" class="outline-4">
<h4 id="org7842c9a">cond</h4>
<div class="outline-text-4" id="text-org7842c9a">
<div class="org-src-container">
<pre class="src src-shell">;; cond &#21487;&#20197;&#29702;&#35299;&#20026;siwtch case &#35821;&#21477;&#65292;&#28385;&#36275;&#19968;&#20010;&#26465;&#20214;&#32467;&#26463;&#25191;&#34892;&#65292;(cond CLAUSES...)
(setq my-cond1 nil)
(setq my-cond2 nil)
(setq my-cond3 nil)
(cond
 (my-cond1
  (message <span style="color: #8b2252;">"1"</span>))
 (my-cond2
  (message <span style="color: #8b2252;">"2"</span>))
 (my-cond3
  (message <span style="color: #8b2252;">"3"</span>))
 (t
  (message <span style="color: #8b2252;">"default"</span>))
 )
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd339487" class="outline-4">
<h4 id="orgd339487">while</h4>
<div class="outline-text-4" id="text-orgd339487">
<div class="org-src-container">
<pre class="src src-shell">;; <span style="color: #a020f0;">while</span> &#28385;&#36275;&#26465;&#20214;&#65292;&#19981;&#26029;&#25191;&#34892;&#32467;&#26500;&#20307;&#20869;&#23481; (<span style="color: #a020f0;">while</span> TEST BODY...)
(setq i 0)
(<span style="color: #a020f0;">while</span> (&lt; i 5)
  (message <span style="color: #8b2252;">"i=%s"</span> i)
  (setq i (+ 1 i)))
</pre>
</div>
</div>
</div>
<div id="outline-container-org35b4cc6" class="outline-4">
<h4 id="org35b4cc6">and or</h4>
<div class="outline-text-4" id="text-org35b4cc6">
<div class="org-src-container">
<pre class="src src-shell">;; and or &#26159;&#23545; bool &#34920;&#36798;&#24335;&#36827;&#34892;&#36816;&#31639;
;; (and &#21442;&#25968;...) &#27714;&#20540;args&#65292;&#21482;&#35201;&#20854;&#20013;&#19968;&#20010;&#29983;&#25104;nil&#65292;&#21017;&#36820;&#22238;nil&#12290;&#21542;&#21017;&#36820;&#22238;&#26368;&#21518;&#19968;&#20010;&#21442;&#25968;&#20540;&#12290;
;; (or &#21442;&#25968;...)  &#27714;&#20540;args&#65292;&#21482;&#35201;&#20854;&#20013;&#19968;&#20010;&#29983;&#25104;true&#65292;&#21017;&#36820;&#22238;true &#20869;&#23481;&#12290;&#21542;&#21017;&#36820;&#22238;&#26368;&#21518;&#19968;&#20010;&#21442;&#25968;&#20540;&#12290;
(message <span style="color: #8b2252;">"and rlt=%s"</span> (and t  2 3)) ;; 3
(message <span style="color: #8b2252;">"and rlt=%s"</span> (and nil 3)) ;; nil
(message <span style="color: #8b2252;">"or rlt=%s"</span> (or nil 3)) ;;3
(message <span style="color: #8b2252;">"or rlt=%s"</span> (or t 3))  ;; t
(message <span style="color: #8b2252;">"or rlt=%s"</span> (or 4 t 3))  ;; 4
(message <span style="color: #8b2252;">"rlt=%s"</span> (or (and t 4) 5)) ;; 4  &#23884;&#22871;
(setq i 0)
(<span style="color: #a020f0;">while</span> (and t (&lt; i 5))
  (message <span style="color: #8b2252;">"i=%s"</span> i)
  (setq i (+ 1 i)))

(setq i 0)
(<span style="color: #a020f0;">while</span> (or nil (&lt; i 5))
  (message <span style="color: #8b2252;">"i=%s"</span> i)
  (setq i (+ 1 i)))
</pre>
</div>
</div>
</div>
<div id="outline-container-org0efe539" class="outline-4">
<h4 id="org0efe539">dolist</h4>
<div class="outline-text-4" id="text-org0efe539">
<div class="org-src-container">
<pre class="src src-shell">;; dolist &#24490;&#29615; list &#20013;&#21462;&#20986;&#27599;&#20010;&#20803;&#32032;&#19968;&#20010;&#19968;&#20010;&#36827;&#34892;&#25805;&#20316;&#12290;(dolist (VAR LIST [RESULT]) BODY...)
(setq my-list <span style="color: #8b2252;">'(1 2 "a" "b"))</span>
<span style="color: #8b2252;">(dolist (elem my-list)</span>
<span style="color: #8b2252;">  (message "elem=%s" elem))</span>
<span style="color: #8b2252;">;;;</span>
<span style="color: #8b2252;">elem=a</span>
<span style="color: #8b2252;">elem=b</span>
<span style="color: #8b2252;">elem=2</span>
<span style="color: #8b2252;">elem=1</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2c9dd1d" class="outline-4">
<h4 id="org2c9dd1d">let*</h4>
<div class="outline-text-4" id="text-org2c9dd1d">
<div class="org-src-container">
<pre class="src src-shell">;; <span style="color: #483d8b;">let</span>* &#23450;&#20041;&#23616;&#37096;&#21464;&#37327; (<span style="color: #483d8b;">let</span>* VARLIST BODY...)
;; <span style="color: #483d8b;">let</span> &#32769;&#30340;&#35821;&#27861;&#65292;&#19981;&#25903;&#25345;&#21464;&#37327;&#37325;&#22797;&#21033;&#29992;
(<span style="color: #483d8b;">let</span>* ((a 3))
  (message <span style="color: #8b2252;">"a=%s"</span> a))

(<span style="color: #483d8b;">let</span>* ((a 3)
       (b (+ a 3)))
  (message <span style="color: #8b2252;">"a=%s b=%s"</span> a b))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgda9f9c4" class="outline-4">
<h4 id="orgda9f9c4">mapcar</h4>
<div class="outline-text-4" id="text-orgda9f9c4">
<div class="org-src-container">
<pre class="src src-shell">;; mapcar &#32473;&#21518;&#38754;&#27599;&#20010; sequence ( &#25968;&#32452;&#25110;&#32773;list )&#36816;&#34892;&#20989;&#25968; <span style="color: #a020f0;">function</span>&#65292;&#20877;&#25509;&#25910;&#20989;&#25968;&#36820;&#22238;&#20540;&#32452;&#25104;&#26032;&#30340;list&#12290;  (mapcar FUNCTION SEQUENCE)
(setq my-list <span style="color: #8b2252;">'(1 2 "a" "b"))</span>
<span style="color: #8b2252;">(defun say-hi (elem)</span>
<span style="color: #8b2252;">  (message "Hi, elem=%s" elem)</span>
<span style="color: #8b2252;">  (format "str=%s" elem)) ;; &#23558;&#36820;&#22238;&#20540;&#21464;&#25104;&#23383;&#31526;&#20018;</span>
<span style="color: #8b2252;">(message "mapcar=%s" (mapcar '</span>say-hi my-list)) ;; <span style="color: #a0522d;">mapcar</span>=(<span style="color: #a0522d;">str</span>=1 <span style="color: #a0522d;">str</span>=2 <span style="color: #a0522d;">str</span>=a <span style="color: #a0522d;">str</span>=b)

;; mapcar &#35843;&#29992; identity &#20989;&#25968;&#65292;dentity &#20989;&#25968;&#36755;&#20837;&#20160;&#20040;&#21407;&#26679;&#36820;&#22238;
(message <span style="color: #8b2252;">"mapcar=%s"</span> (mapcar <span style="color: #8b2252;">'identity my-list))  ;;mapcar=(1 2 a b)</span>

<span style="color: #8b2252;">;; mapcar &#35843;&#29992; &#21311;&#21517;&#20989;&#25968;&#12290;&#34429;&#28982;&#40635;&#28902;&#28857;&#65292;&#20294;&#26159;&#20195;&#30721;&#27604;&#36739;&#28165;&#26224;</span>
<span style="color: #8b2252;">(message "mapcar=%s" (mapcar</span>
<span style="color: #8b2252;">                      (lambda (a)</span>
<span style="color: #8b2252;">                        (format "lambda=%s" a))</span>
<span style="color: #8b2252;">                      my-list))  ;;mapcar=(lambda=1 lambda=2 lambda=a lambda=b)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgfcf36dc" class="outline-3">
<h3 id="orgfcf36dc">Emacs Lisp基础: 和命令行交互</h3>
<div class="outline-text-3" id="text-orgfcf36dc">
</div>
<div id="outline-container-orga0463a8" class="outline-4">
<h4 id="orga0463a8">和 shell 交互</h4>
<div class="outline-text-4" id="text-orga0463a8">
<p>
shell-command-to-string
</p>

<div class="org-src-container">
<pre class="src src-shell">(setq a (shell-command-to-string <span style="color: #8b2252;">"echo hello world"</span>)) ;; &#23558;&#21629;&#20196;&#34892;&#25191;&#34892;&#30340;&#32467;&#26524;&#20256;&#32473; a
(message <span style="color: #8b2252;">"a=%s"</span> a) ;; <span style="color: #a0522d;">a</span>=hello world
</pre>
</div>

<p>
所有基础语法讲完，对于其它的语法，在写代码中实践就可以了。
</p>
</div>
</div>
</div>
<div id="outline-container-orgdecbf88" class="outline-3">
<h3 id="orgdecbf88">Emacs Lisp免费电子书精选</h3>
<div class="outline-text-3" id="text-orgdecbf88">
<ul class="org-ul">
<li>自带手册： <code>C-h i</code> 或 <code>M-x info</code> 到info界面</li>
<li>官方 Emacs Lisp 编程简介：<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr">https://www.gnu.org/software/emacs/manual/html_node/eintr</a></li>
<li>官方 Emacs Lisp 参考手册：<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/index.html">https://www.gnu.org/software/emacs/manual/html_node/elisp/index.html</a></li>
<li>xahlee 博客教程（浅显易懂）：<a href="http://xahlee.info/emacs/emacs/elisp.html">http://xahlee.info/emacs/emacs/elisp.html</a></li>
</ul>

<p>
比如简介中关于 Narrowing &amp; Widening 介绍，文本操作经常用到这个功能。
</p>
</div>
</div>
<div id="outline-container-org6e1c89e" class="outline-3">
<h3 id="org6e1c89e">Shell和命令行免费电子书精选</h3>
<div class="outline-text-3" id="text-org6e1c89e">
<p>
要点和书
</p>
</div>
<div id="outline-container-org258ffe9" class="outline-4">
<h4 id="org258ffe9">入门基础</h4>
<div class="outline-text-4" id="text-org258ffe9">
<p>
开源电子书集合，有很多高质量书箱：<a href="https://tldp.org/">https://tldp.org/</a>
</p>
<ul class="org-ul">
<li>GNU/Linux Command-Line Tools Summary：<a href="https://tldp.org/LDP/GNU-Linux-Tools-Summary/html/index.html">https://tldp.org/LDP/GNU-Linux-Tools-Summary/html/index.html</a>  只要根文本文件相关的就要学，提高编程程度主要是文本文件操作。</li>
<li>Bash Guide for Beginners：<a href="https://tldp.org/LDP/Bash-Beginners-Guide/html/index.html">https://tldp.org/LDP/Bash-Beginners-Guide/html/index.html</a></li>
</ul>
</div>
</div>
<div id="outline-container-org061473d" class="outline-4">
<h4 id="org061473d">提高</h4>
<div class="outline-text-4" id="text-org061473d">
<ul class="org-ul">
<li>Advanced Bash-Scripting Guide： <a href="https://tldp.org/LDP/abs/html/index.html">https://tldp.org/LDP/abs/html/index.html</a> Bash 圣经，所有 bash 编程都有，很少有人读完</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc101311" class="outline-3">
<h3 id="orgc101311">用Emacs Lisp开发第一个命令 hello</h3>
<div class="outline-text-3" id="text-orgc101311">
<p>
使用 emacs lisp 写自己的插件。
</p>

<p>
<code>SPACE-dd</code> ：pwd，显示当前目录。
</p>

<p>
查看  <code>~/.emacs.d/init.el</code>  文件配置， <code>(load "~/.custom.el" t nil)</code> 表示打开 emacs 会自动加载 <code>~/.custom.el</code> 文件中的个人代码。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">hello</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (message <span style="color: #8b2252;">"hello world"</span>))
</pre>
</div>

<p>
<code>C-x C-c</code> 退出 emacs 再重新打开 emacs，使用 <code>M-x hello</code> 调用函数。
</p>
</div>
</div>
<div id="outline-container-org63f0a21" class="outline-3">
<h3 id="org63f0a21">开发my-find-file原型</h3>
<div class="outline-text-3" id="text-org63f0a21">
<p>
创建文件：~/projs/my-find-file/my-find-file.el
</p>
</div>
<div id="outline-container-org41e5b4b" class="outline-4">
<h4 id="org41e5b4b">step 1 调用专业领域的命令行工具 find</h4>
<div class="outline-text-4" id="text-org41e5b4b">
<p>
<b>定义命令行变量 cmd</b>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> (cmd)
    (message <span style="color: #8b2252;">"cmd=%s"</span> cmd)
    ))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer, M-x my-find-file</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">cmd=nil</span>
</pre>
</div>

<p>
<b>测试命令行是对的</b>
</p>

<p>
查找文件使用专业领域的命令行工具 find。 <code>man find</code> 查看帮助手册
</p>
<ul class="org-ul">
<li>字符串两边加括号：v 选中字符串，按 i 进入插入模式，按 (</li>
</ul>

<p>
测试命令行是对的：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ( (cmd <span style="color: #8b2252;">"find . -name \"*.*\""</span>) )
    (message <span style="color: #8b2252;">"cmd=%s"</span> cmd)
    ))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer, M-x my-find-file</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">cmd=find . -name "*.*"</span>
</pre>
</div>

<p>
<b>命令行输出保存到变量中，并把每行输出放在数组中</b>
</p>
<ul class="org-ul">
<li><code>(split-string STRING &amp;optional SEPARATORS OMIT-NULLS TRIM)</code> 切割字符串。本例以换行符切割。</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ( (cmd <span style="color: #8b2252;">"find . -name \"*.*\""</span>)
         (output (shell-command-to-string cmd))
         (lines (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>)))
    (message <span style="color: #8b2252;">"cmd=%s"</span> cmd)
    (message <span style="color: #8b2252;">"output=%s"</span> output)
    (message <span style="color: #8b2252;">"lines=%s"</span> lines)
    ))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer, M-x my-find-file</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">output</span>
cmd=find . -name <span style="color: #8b2252;">"*.*"</span>
output=.
./nvim.appimage
./.DS_Store
./etcd.config.yml.swp
./portable-ruby-2.6.8.arm64_big_sur.bottle.tar.gz
./myssh.sh
./AWSCLIV2.pkg
./my-find-file.el
./down/.DS_Store

lines=(. ./nvim.appimage ./.DS_Store ./etcd.config.yml.swp ./portable-ruby-2.6.8.arm64_big_sur.bottle.tar.gz ./myssh.sh ./AWSCLIV2.pkg ./my-find-file.el ./down/.DS_Store )
</pre>
</div>
</div>
</div>
<div id="outline-container-org00ae7a9" class="outline-4">
<h4 id="org00ae7a9">交互选择</h4>
<div class="outline-text-4" id="text-org00ae7a9">
<p>
<b>让用户选中文件</b>
</p>

<p>
使用 ivy 插件功能，配置中已加载此插件。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(ivy-read <span style="color: #8b2252;">"Select: "</span> '(<span style="color: #8b2252;">"hello"</span> <span style="color: #8b2252;">"world"</span>))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">output  &#21487;&#36873;&#25321;&#65292;&#36820;&#22238;&#36873;&#25321;&#30340;&#32467;&#26524;</span>
2    Select:
hello
world
</pre>
</div>

<p>
选择需要的文件：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ( (cmd <span style="color: #8b2252;">"find . -type f -name \"*.*\""</span>)
          (output (shell-command-to-string cmd))
          (lines (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>)))
    (message <span style="color: #8b2252;">"lines=%s"</span> lines)
    (<span style="color: #a020f0;">setq</span> selected-line     (ivy-read <span style="color: #8b2252;">"Find file: "</span> lines))
    (message <span style="color: #8b2252;">"selectline=%s"</span> selected-line)
    ))

</pre>
</div>

<p>
<b>打开文件</b>
</p>
<ul class="org-ul">
<li>(find-file FILENAME &amp;optional WILDCARDS) 打开文件
<ul class="org-ul">
<li>支持正则匹配</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ( (cmd <span style="color: #8b2252;">"find . -type f -name \"*.*\""</span>)
          (output (shell-command-to-string cmd))
          (lines (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>)))
    (message <span style="color: #8b2252;">"lines=%s"</span> lines)
    (<span style="color: #a020f0;">setq</span> selected-line     (ivy-read <span style="color: #8b2252;">"Find file: "</span> lines))
    (message <span style="color: #8b2252;">"selectline=%s"</span> selected-line)
    (find-file selected-line)
    ))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer, M-x my-find-file</span>
</pre>
</div>

<p>
<b>调试代码兼容性，减少 bug</b>
</p>

<ul class="org-ul">
<li>(file-exists-p FILENAME) 当文件变量非空，且文件存在时打开文件</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ( (cmd <span style="color: #8b2252;">"find . -type f -name \"*.*\""</span>)
          (output (shell-command-to-string cmd))
          (lines (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>)))
    (message <span style="color: #8b2252;">"lines=%s"</span> lines)
    (<span style="color: #a020f0;">setq</span> selected-line     (ivy-read <span style="color: #8b2252;">"Find file: "</span> lines))
    (message <span style="color: #8b2252;">"selectline=%s"</span> selected-line)
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> selected-line (file-exists-p selected-line))
      (find-file selected-line))
    ))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer, M-x my-find-file</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9956c52" class="outline-3">
<h3 id="org9956c52">让my-find-file排除特定目录</h3>
<div class="outline-text-3" id="text-org9956c52">
<p>
<b>使用专业领域工具排除目录</b>
</p>
<div class="org-src-container">
<pre class="src src-shell">&gt; find . <span style="color: #8b2252;">\(</span> -path <span style="color: #8b2252;">"*/.git"</span> -o -path <span style="color: #8b2252;">"*/.svn"</span> <span style="color: #8b2252;">\)</span> -a -prune -o -print -type f -name <span style="color: #8b2252;">"*.*"</span>
<span style="color: #483d8b;">.</span>
./nvim.appimage
./.DS_Store
./etcd.config.yml.swp
./portable-ruby-2.6.8.arm64_big_sur.bottle.tar.gz
./myssh.sh
./AWSCLIV2.pkg
./my-find-file.el
./down
./down/.DS_Store
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25442;&#25104;&#21487;&#20197;&#35299;&#20915; find . \( -path "*/.git" -o -path "*/.svn" \) -a -prune -o  -type f -name "*.*" -print</span>
</pre>
</div>

<p>
*去除find中的点 . 点 *
</p>
<ul class="org-ul">
<li>(cdr LIST) 去除第一个元素</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ( (cmd <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -print -type f -name \"*.*\""</span>)
          (output (shell-command-to-string cmd))
          (lines (cdr (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>))))
    (<span style="color: #a020f0;">setq</span> selected-line     (ivy-read <span style="color: #8b2252;">"Find file: "</span> lines))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> selected-line (file-exists-p selected-line))
      (find-file selected-line))
    ))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer, M-x my-find-file</span>
10   Find file:
./nvim.appimage
./.DS_Store
./etcd.config.yml.swp
./portable-ruby-2.6.8.arm64_big_sur.bottle.tar.gz
./myssh.sh
./AWSCLIV2.pkg
./a.txt
./my-find-file.el
./down
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfea6319" class="outline-3">
<h3 id="orgfea6319">my-find-file在项目根目录搜索</h3>
<div class="outline-text-3" id="text-orgfea6319">
<p>
<b>使用真实大型项目 linux</b>
</p>

<div class="org-src-container">
<pre class="src src-shell">&gt; find . -name <span style="color: #8b2252;">"*.*"</span> |wc -l
   73312
&gt; cloc ./
   79447 text files.
   78892 unique files.
   11210 files ignored.

github.com/AlDanial/cloc v 1.90  <span style="color: #a0522d;">T</span>=75.61 s (902.9 files/s, 447811.7 lines/s)
---------------------------------------------------------------------------------------
Language                             files          blank        comment           code
---------------------------------------------------------------------------------------
C                                    32314        3276392        2578741       16882894
C/C++ Header                         23460         703974        1338664        6929246
reStructuredText                      3300         160571          64369         438061
JSON                                   508              2              0         360081
YAML                                  3151          57690          14530         265588
Assembly                              1328          47811         101201         229944
Bourne Shell                           900          27555          18983         107930
make                                  2803          10866          11819          49930
SVG                                     74             90           1171          48177
Perl                                    66           7383           5033          36556
Python                                 157           6813           6354          33942
Rust                                    37            948           5454           5539
yacc                                     9            700            409           4914
PO File                                  6            948           1088           3733
lex                                      9            346            309           2111
C++                                     10            373            138           2022
Bourne Again Shell                      56            392            322           1603
awk                                     13            217            157           1323
Glade                                    1             58              0            603
CSV                                     10             73              0            597
NAnt script                              2            154              0            545
Cucumber                                 1             34             58            196
TeX                                      1              6             74            156
TNSDL                                    2             33              0            140
Windows Module Definition                2             15              0            110
CSS                                      3             38             49            104
m4                                       1             15              1             95
Clojure                                 31              0              0             73
XSLT                                     5             13             26             61
MATLAB                                   1             17             37             35
vim script                               1              3             12             27
Markdown                                 1              8              0             25
Ruby                                     1              4              0             25
INI                                      1              1              0              6
sed                                      1              2              5              5
TOML                                     1              1              9              2
---------------------------------------------------------------------------------------
SUM:                                 68267        4303546        4149013       25406399
---------------------------------------------------------------------------------------
</pre>
</div>

<p>
<b>找项目根目录，写死根目录</b>
</p>

<p>
一般不会从当前目录下找文件，更多的是从项目的根目录找文件。
</p>

<ul class="org-ul">
<li>default-directory is a buffer-local variable defined in C source code. 每一个 buffer 都有这个变量，当前绑定的目录。</li>
</ul>


<p>
开启2个窗口，分别打开自己代码、打开 linux 代码文件
</p>

<p>
/tmp/my-find-file.el
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ( (cmd <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -print -type f -name \"*.*\""</span>)
          (default-directory <span style="color: #8b2252;">"~/tmp/linux-master"</span>)
          (output (shell-command-to-string cmd))
          (lines (cdr (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>)))
          selected-line)
    (<span style="color: #a020f0;">setq</span> selected-line     (ivy-read (format <span style="color: #8b2252;">"Find file in %s: "</span> default-directory) lines))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> selected-line (file-exists-p selected-line))
      (find-file selected-line))
    ))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer, &#22312; linux-master &#20219;&#24847;&#23376;&#30446;&#24405;&#25191;&#34892;&#65306;M-x my-find-file</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">output</span>
84629 Find file in ~/tmp/linux-master:
./init
./init/do_mounts_rd.c
./init/do_mounts.c
./init/do_mounts_initrd.c
</pre>
</div>

<p>
<b>优化方向</b>
</p>
<ul class="org-ul">
<li>find 查找多文件本身已自动提速，还需要再提</li>
<li>自动寻找项目根目录：(locate-dominating-file FILE NAME)，项目根目录是硬编码，需要自动查找项目根目录。emacs 自带
<ul class="org-ul">
<li>(locate-dominating-file default-directory ".git")  当前目录向上层查找，有.git的目录就是根目录</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ( (cmd <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -print -type f -name \"*.*\""</span>)
          (default-directory (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>))
          (output (shell-command-to-string cmd))
          (lines (cdr (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>)))
          slected-line)
    (<span style="color: #a020f0;">setq</span> selected-line     (ivy-read (format <span style="color: #8b2252;">"Find file in %s: "</span> default-directory) lines))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> selected-line (file-exists-p selected-line))
      (find-file selected-line))
    ))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer, &#22312; linux-master &#20219;&#24847;&#23376;&#30446;&#24405;&#25191;&#34892;&#65306;M-x my-find-file</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9a8cae9" class="outline-3">
<h3 id="org9a8cae9">33行代码实现文件查找魔法</h3>
<div class="outline-text-3" id="text-org9a8cae9">
<p>
<b>代码利用，即可在根目录查找，也可在当前目录查找</b>
</p>

<ul class="org-ul">
<li>更改目录位置</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file-internal</span> (directory)
  <span style="color: #8b2252;">"Find file in DIRECTORY"</span>
  (<span style="color: #a020f0;">let*</span> ( (cmd <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -print -type f -name \"*.*\""</span>)
          (default-directory directory)
          (output (shell-command-to-string cmd))
          (lines (cdr (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>)))
          selected-line)
    (<span style="color: #a020f0;">setq</span> selected-line     (ivy-read (format <span style="color: #8b2252;">"Find file in %s: "</span> default-directory)
                                      lines))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> selected-line (file-exists-p selected-line))
      (find-file selected-line))
    )
  )
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file-in-project</span> ()
  <span style="color: #8b2252;">"Find file project root directory"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (my-find-file-internal (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> ()
  <span style="color: #8b2252;">"Find file in current directory"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (my-find-file-internal default-directory))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22312; linux-master &#20219;&#24847;&#23376;&#30446;&#24405;&#25191;&#34892;&#65306;M-x my-find-file   &#65306;M-x my-find-file-in-project</span>
</pre>
</div>

<p>
<b>扩展在当前目录搜索</b>
</p>
<ul class="org-ul">
<li>给函数加可选参数。本例添加层级参数，1为上层，2为上2层目录，依次类推。</li>
</ul>

<p>
函数可选参数结合交互式参数组合
</p>
<ul class="org-ul">
<li>(defun NAME ARGLIST &amp;optional DOCSTRING DECL &amp;rest BODY)</li>

<li>(interactive &amp;optional ARG-DESCRIPTOR &amp;rest MODES)
<ul class="org-ul">
<li>p &#x2013; Prefix arg converted to number.  Does not do I/O. 参数转为数字</li>
<li>P &#x2013; Prefix arg in raw form.  Does not do I/O.</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> (<span style="color: #228b22;">&amp;optional</span> level)
  <span style="color: #8b2252;">"Find file in current directory"</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (message <span style="color: #8b2252;">"leve=%s"</span> level)
  (my-find-file-internal default-directory))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-expression (my-find-file 1)  ;; level=1</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25110;&#32773; C-u 1 M-x my-find-file ;; level=1</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25110;&#32773; C-u  &#31354; M-x my-find-file  ;; level=nil</span>
</pre>
</div>

<p>
<b>上层目录</b>
</p>
<ul class="org-ul">
<li>返回文件路径，如果是目录/，则去掉/ (directory-file-name DIRECTORY)
<ul class="org-ul">
<li>(directory-file-name "abc/.git/") ;;output "abc/.git"</li>
</ul></li>
<li>返回文件的父目录，(file-name-directory FILENAME)
<ul class="org-ul">
<li>(file-name-directory "abc/.git") ;;outpu "abc/"</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> (<span style="color: #228b22;">&amp;optional</span> level)
  <span style="color: #8b2252;">"Find file in current directory"</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (<span style="color: #a020f0;">unless</span> level (<span style="color: #a020f0;">setq</span> level 0))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">default-directory</span>
  (<span style="color: #a020f0;">let*</span> ((parent-directory default-directory)
         (i 0))
    (<span style="color: #a020f0;">while</span> (&lt; i level)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">directory-file-name</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">file-name-directory</span>
      (<span style="color: #a020f0;">setq</span> parent-directory
            (file-name-directory (directory-file-name parent-directory)))
      (<span style="color: #a020f0;">setq</span> i (+ i 1)))
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">(my-find-file-internal parent-directory)</span>
    (message <span style="color: #8b2252;">"parent-derectory=%s"</span> parent-directory)
   ))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x my-find-file ;;output parent-derectory=/Users/7tq6lr/Documents/wd/</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">C-u 2 M-x my-find-file ;;output parent-derectory=/Users/7tq6lr/Documents/</span>
</pre>
</div>

<p>
<b>添加快捷键</b>
</p>

<p>
推荐以 vim 插件为基础的 leader 键。
</p>

<p>
emacs/lisp/init-evil.el 已经添加了快捷键，见 my-comma-leader-def
</p>

<p>
~/.custom.el 文件
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(my-comma-leader-def
 <span style="color: #8b2252;">"xf"</span> 'my-find-file
 )
</pre>
</div>

<p>
my-find-file.el
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file-internal</span> (directory)
  <span style="color: #8b2252;">"Find file in DIRECTORY"</span>
  (<span style="color: #a020f0;">let*</span> ( (cmd <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -print -type f -name \"*.*\""</span>)
          (default-directory directory)
          (output (shell-command-to-string cmd))
          (lines (cdr (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>)))
          selected-line)
    (<span style="color: #a020f0;">setq</span> selected-line     (ivy-read (format <span style="color: #8b2252;">"Find file in %s: "</span> default-directory)
                                      lines))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> selected-line (file-exists-p selected-line))
      (find-file selected-line))))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file-in-project</span> ()
  <span style="color: #8b2252;">"Find file project root directory"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (my-find-file-internal (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> (<span style="color: #228b22;">&amp;optional</span> level)
  <span style="color: #8b2252;">"Find file in current directory"</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (<span style="color: #a020f0;">unless</span> level (<span style="color: #a020f0;">setq</span> level 0))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">default-directory</span>
  (<span style="color: #a020f0;">let*</span> ((parent-directory default-directory)
         (i 0))
    (<span style="color: #a020f0;">while</span> (&lt; i level)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">directory-file-name</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">file-name-directory</span>
      (<span style="color: #a020f0;">setq</span> parent-directory
            (file-name-directory (directory-file-name parent-directory)))
      (<span style="color: #a020f0;">setq</span> i (+ i 1)))
    <span style="color: #b22222;">;;</span><span style="color: #b22222;">2,xf</span>
    (my-find-file-internal parent-directory)))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">1,xf</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">2,xf</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8074d18" class="outline-3">
<h3 id="org8074d18">以实战经验优化my-find-file</h3>
<div class="outline-text-3" id="text-org8074d18">
<p>
find 命令查找所有文件，第一次会慢同时也占用内存，没有利用 find 过滤功能。
</p>

<p>
改进：
</p>
<ul class="org-ul">
<li>过滤文件名不区分大小文件名</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell">find . <span style="color: #8b2252;">\(</span> -path <span style="color: #8b2252;">"*/.git"</span> -o -path <span style="color: #8b2252;">"*/.svn"</span>  <span style="color: #8b2252;">\)</span> -prune -o -type f -iname <span style="color: #8b2252;">"*test*"</span> -print
</pre>
</div>

<ul class="org-ul">
<li>读取用户输入的文件名关键字 (read-string "aa: ")</li>
</ul>

<div class="org-src-container">
<pre class="src src-shell">(read-string PROMPT &amp;optional INITIAL-INPUT HISTORY DEFAULT-VALUE INHERIT-INPUT-METHOD)
&#22312; minibuffer &#20013;&#35835;&#21462;&#29992;&#25143;&#36755;&#20837;&#24182;&#36820;&#22238;
</pre>
</div>

<ul class="org-ul">
<li>比字符串是否相等。字符串不能为空，keyword 不为空返回 true。 (not (string= keyword "")</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file-internal</span> (directory)
  <span style="color: #8b2252;">"Find file in DIRECTORY"</span>
  (<span style="color: #a020f0;">let*</span> ((keyword (read-string <span style="color: #8b2252;">"Please input keyword: "</span>)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> keyword (not (string= keyword <span style="color: #8b2252;">""</span>)))
      (<span style="color: #a020f0;">let*</span> ( (cmd (format <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -type f -iname \"*%s*\" -print"</span> keyword))
              (default-directory directory)
              (output (shell-command-to-string cmd))
              (lines (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>))
              selected-line)
        (<span style="color: #a020f0;">setq</span> selected-line  (ivy-read (format <span style="color: #8b2252;">"Find file in %s: "</span> default-directory)
                                          lines))
        (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> selected-line (file-exists-p selected-line))
          (find-file selected-line))))))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file-in-project</span> ()
  <span style="color: #8b2252;">"Find file project root directory"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (my-find-file-internal (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> (<span style="color: #228b22;">&amp;optional</span> level)
  <span style="color: #8b2252;">"Find file in current directory"</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (<span style="color: #a020f0;">unless</span> level (<span style="color: #a020f0;">setq</span> level 0))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">default-directory</span>
  (<span style="color: #a020f0;">let*</span> ((parent-directory default-directory)
         (i 0))
    (<span style="color: #a020f0;">while</span> (&lt; i level)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">directory-file-name</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">file-name-directory</span>
      (<span style="color: #a020f0;">setq</span> parent-directory
            (file-name-directory (directory-file-name parent-directory)))
      (<span style="color: #a020f0;">setq</span> i (+ i 1)))
    <span style="color: #b22222;">;;</span><span style="color: #b22222;">2,xf</span>
    (my-find-file-internal parent-directory)))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">1,xf</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">2,xf</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org180e241" class="outline-3">
<h3 id="org180e241">重用代码快速实现功能完整的my-search-text</h3>
<div class="outline-text-3" id="text-org180e241">
<p>
搜索文本，和找文件是类似的。
</p>
<ul class="org-ul">
<li>让 my-find-file-internal  不仅能找文件，也能搜索文本中关键字</li>
<li>结合 grep 命令搜索文本：grep &#x2013;exclude-dir=".git" &#x2013;exclude-dir=".svn" -rns test .</li>
<li>缩小视图：,ww</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-file-internal</span> (directory <span style="color: #228b22;">&amp;optional</span> grep-p)
  <span style="color: #8b2252;">"Find file in DIRECTORY.</span>
<span style="color: #8b2252;">If GREP-P is t, grep files.</span>
<span style="color: #8b2252;">If GREP-P is nil, find files."</span>
  (<span style="color: #a020f0;">let*</span> ((keyword (read-string <span style="color: #8b2252;">"Please input keyword: "</span>)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> keyword (not (string= keyword <span style="color: #8b2252;">""</span>)))
      (<span style="color: #a020f0;">let*</span> ((find-cmd (format <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -type f -iname \"*%s*\" -print"</span> keyword))
             (grep-cmd (format <span style="color: #8b2252;">"grep --exclude-dir=\"*/.git\" --exclude-dir=\"*/.svn\"  -rns  \"%s\" ."</span> keyword))
             (default-directory directory)
             (output (shell-command-to-string (<span style="color: #a020f0;">if</span> grep-p grep-cmd find-cmd)))
             (lines (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>))
             (hint (<span style="color: #a020f0;">if</span> grep-p <span style="color: #8b2252;">"Grep file in %s: "</span> <span style="color: #8b2252;">"Find file in %s: "</span>))
             selected-line)
        (<span style="color: #a020f0;">setq</span> selected-line  (ivy-read (format hint default-directory)
                                          lines))
        (message <span style="color: #8b2252;">"selected-line=%s"</span> selected-line)
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (and selected-line (file-exists-p selected-line))</span>
        <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(find-file selected-line))</span>
        ))))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-expression (my-file-internal default-directory t)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">output</span>
19   Grep file in /Users/7tq6lr/Documents/wd/:
./KPI-2022.org:22:5. &#21387;&#27979;&#65288;load test, spike test, soak Testcc)
./KPI-2022.html:306:&lt;li&gt;&#21387;&#27979;&#65288;load test, spike test, soak Testcc)&lt;br /&gt;&lt;/li&gt;
</pre>
</div>

<p>
<b>跳转到文件指定行</b>
</p>

<p>
取出文件名和行号
</p>
<ul class="org-ul">
<li>正则过滤字符串 (string-match REGEXP STRING &amp;optional START)</li>
<li>取出匹配的字符 (match-string NUM &amp;optional STRING)</li>
<li>字符串转换成数字 (string-to-number STRING &amp;optional BASE)</li>
<li>光标行动到第一行 (goto-char (point-min 1))。(goto-char POSITION) 将点设置为POSTTION, (point-min) 返回当前缓冲区的起点</li>
<li>从当前光标位置向下移动 N 行 (forward-line &amp;optional N)</li>
<li>数字减 1：(1- NUMBER)</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-file-internal</span> (directory <span style="color: #228b22;">&amp;optional</span> grep-p)
  <span style="color: #8b2252;">"Find file in DIRECTORY.</span>
<span style="color: #8b2252;">If GREP-P is t, grep files.</span>
<span style="color: #8b2252;">If GREP-P is nil, find files."</span>
  (<span style="color: #a020f0;">let*</span> ((keyword (read-string <span style="color: #8b2252;">"Please input keyword: "</span>)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> keyword (not (string= keyword <span style="color: #8b2252;">""</span>)))
      (<span style="color: #a020f0;">let*</span> ((find-cmd (format <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -type f -iname \"*%s*\" -print"</span> keyword))
             (grep-cmd (format <span style="color: #8b2252;">"grep --exclude-dir=\"*/.git\" --exclude-dir=\"*/.svn\"  -rns  \"%s\" ."</span> keyword))
             (default-directory directory)
             (output (shell-command-to-string (<span style="color: #a020f0;">if</span> grep-p grep-cmd find-cmd)))
             (lines (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>))
             (hint (<span style="color: #a020f0;">if</span> grep-p <span style="color: #8b2252;">"Grep file in %s: "</span> <span style="color: #8b2252;">"Find file in %s: "</span>))
             selected-line
             selected-file
             linenum)
        (<span style="color: #a020f0;">setq</span> selected-line  (ivy-read (format hint default-directory)
                                          lines))
        (<span style="color: #a020f0;">cond</span>
          (grep-p
           (<span style="color: #a020f0;">when</span> (string-match <span style="color: #8b2252;">"</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">^[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">:]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:"</span> selected-line)
             (<span style="color: #a020f0;">setq</span> selected-file (match-string 1 selected-line))
             (<span style="color: #a020f0;">setq</span> linenum (match-string 2 selected-line))
             (message <span style="color: #8b2252;">"selected-file=%s linenum=%s"</span> selected-file linenum)
             )
           )
          (t
           (<span style="color: #a020f0;">setq</span> selected-file selected-line)))
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (and selected-line (file-exists-p selected-file))</span>
        <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(find-file selected-file))</span>
        ))))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-expression (my-file-internal default-directory t)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">output</span>
selected-file=./KPI-2022.org linenum=22
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-file-internal</span> (directory <span style="color: #228b22;">&amp;optional</span> grep-p)
  <span style="color: #8b2252;">"Find file in DIRECTORY.</span>
<span style="color: #8b2252;">If GREP-P is t, grep files.</span>
<span style="color: #8b2252;">If GREP-P is nil, find files."</span>
  (<span style="color: #a020f0;">let*</span> ((keyword (read-string <span style="color: #8b2252;">"Please input keyword: "</span>)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> keyword (not (string= keyword <span style="color: #8b2252;">""</span>)))
      (<span style="color: #a020f0;">let*</span> ((find-cmd (format <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -type f -iname \"*%s*\" -print"</span> keyword))
             (grep-cmd (format <span style="color: #8b2252;">"grep --exclude-dir=\"*/.git\" --exclude-dir=\"*/.svn\"  -rns  \"%s\" ."</span> keyword))
             (default-directory directory)
             (output (shell-command-to-string (<span style="color: #a020f0;">if</span> grep-p grep-cmd find-cmd)))
             (lines (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>))
             (hint (<span style="color: #a020f0;">if</span> grep-p <span style="color: #8b2252;">"Grep file in %s: "</span> <span style="color: #8b2252;">"Find file in %s: "</span>))
             selected-line
             selected-file
             linenum)
        (<span style="color: #a020f0;">setq</span> selected-line  (ivy-read (format hint default-directory)
                                          lines))
        (<span style="color: #a020f0;">cond</span>
          (grep-p
           (<span style="color: #a020f0;">when</span> (string-match <span style="color: #8b2252;">"</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">^[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">:]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:"</span> selected-line)
             (<span style="color: #a020f0;">setq</span> selected-file (match-string 1 selected-line))
             (<span style="color: #a020f0;">setq</span> linenum (match-string 2 selected-line))))
          (t
           (<span style="color: #a020f0;">setq</span> selected-file selected-line)))
        (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> selected-line (file-exists-p selected-file))
          (find-file selected-file)
          (<span style="color: #a020f0;">when</span> grep-p
          (goto-char (point-min))
          (forward-line (1- (string-to-number linenum)))))
        ))))
</pre>
</div>

<p>
<b>复用在当前目录找文件和在项目中找文件代码</b>
</p>

<p>
只需要函数调用时加上可选参数即可。(my-file-internal parent-directory t)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-file-internal</span> (directory <span style="color: #228b22;">&amp;optional</span> grep-p)
  <span style="color: #8b2252;">"Find file in DIRECTORY.</span>
<span style="color: #8b2252;">If GREP-P is t, grep files.</span>
<span style="color: #8b2252;">If GREP-P is nil, find files."</span>
  (<span style="color: #a020f0;">let*</span> ((keyword (read-string <span style="color: #8b2252;">"Please input keyword: "</span>)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> keyword (not (string= keyword <span style="color: #8b2252;">""</span>)))
      (<span style="color: #a020f0;">let*</span> ((find-cmd (format <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -type f -iname \"*%s*\" -print"</span> keyword))
             (grep-cmd (format <span style="color: #8b2252;">"grep --exclude-dir=\"*/.git\" --exclude-dir=\"*/.svn\"  -rns  \"%s\" ."</span> keyword))
             (default-directory directory)
             (output (shell-command-to-string (<span style="color: #a020f0;">if</span> grep-p grep-cmd find-cmd)))
             (lines (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>))
             (hint (<span style="color: #a020f0;">if</span> grep-p <span style="color: #8b2252;">"Grep file in %s: "</span> <span style="color: #8b2252;">"Find file in %s: "</span>))
             selected-line
             selected-file
             linenum)
        (<span style="color: #a020f0;">setq</span> selected-line  (ivy-read (format hint default-directory)
                                          lines))
        (<span style="color: #a020f0;">cond</span>
          (grep-p
           (<span style="color: #a020f0;">when</span> (string-match <span style="color: #8b2252;">"</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">^[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">:]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:"</span> selected-line)
             (<span style="color: #a020f0;">setq</span> selected-file (match-string 1 selected-line))
             (<span style="color: #a020f0;">setq</span> linenum (match-string 2 selected-line))))
          (t
           (<span style="color: #a020f0;">setq</span> selected-file selected-line)))
        (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> selected-line (file-exists-p selected-file))
          (find-file selected-file)
          (<span style="color: #a020f0;">when</span> grep-p
          (goto-char (point-min))
          (forward-line (1- (string-to-number linenum)))))
        ))))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-search-text-in-project</span> ()
  <span style="color: #8b2252;">"Search text of files in project root directory."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (my-file-internal (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>) t))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-search-text</span> (<span style="color: #228b22;">&amp;optional</span> level)
  <span style="color: #8b2252;">"Search text of files in current directory or LEVEL parent directory."</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (<span style="color: #a020f0;">unless</span> level (<span style="color: #a020f0;">setq</span> level 0))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">default-directory</span>
  (<span style="color: #a020f0;">let*</span> ((parent-directory default-directory)
         (i 0))
    (<span style="color: #a020f0;">while</span> (&lt; i level)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">directory-file-name</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">file-name-directory</span>
      (<span style="color: #a020f0;">setq</span> parent-directory
            (file-name-directory (directory-file-name parent-directory)))
      (<span style="color: #a020f0;">setq</span> i (+ i 1)))
    <span style="color: #b22222;">;;</span><span style="color: #b22222;">2,xf</span>
    (my-file-internal parent-directory t)))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x my-search-text-in-project</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">C-u 2 M-x my-search-text</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org11b6c4e" class="outline-3">
<h3 id="org11b6c4e">再提速my-search-text</h3>
<div class="outline-text-3" id="text-org11b6c4e">
<p>
站在巨人的肩膀上，充分利用专业的工具。
</p>
<ul class="org-ul">
<li>repgrep <a href="https://github.com/BurntSushi/ripgrep">https://github.com/BurntSushi/ripgrep</a></li>
<li>git grep
<ul class="org-ul">
<li>git grep -P -n -w '[A-Z]+_SUSPEND'  输出格式和 grep 一样
<ul class="org-ul">
<li>- P perl 正则</li>
<li>-n 显示行号</li>
<li>-w 单词匹配</li>
<li>git grep -n 'xxx'</li>
</ul></li>
<li>只能搜索有版本控制的文件</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-file-internal</span> (directory <span style="color: #228b22;">&amp;optional</span> grep-p git-grep-p)
...
             (git-cmd-fmt (<span style="color: #a020f0;">if</span> git-grep-p <span style="color: #8b2252;">"git grep -n \"%s\""</span> <span style="color: #8b2252;">"grep --exclude-dir=\"*/.git\" --exclude-dir=\"*/.svn\"  -rns  \"%s\" ."</span> ))
             (grep-cmd (format git-cmd-fmt keyword))
...
</pre>
</div>


<p>
完整内容：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-file-internal</span> (directory <span style="color: #228b22;">&amp;optional</span> grep-p git-grep-p)
  <span style="color: #8b2252;">"Find file in DIRECTORY.</span>
<span style="color: #8b2252;">If GREP-P is t, grep files.</span>
<span style="color: #8b2252;">If GREP-P is nil, find files."</span>
  (<span style="color: #a020f0;">let*</span> ((keyword (read-string <span style="color: #8b2252;">"Please input keyword: "</span>)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> keyword (not (string= keyword <span style="color: #8b2252;">""</span>)))
      (<span style="color: #a020f0;">let*</span> ((find-cmd (format <span style="color: #8b2252;">"find . </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;"> -path \"*/.git\" -o -path \"*/.svn\"  </span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> -prune -o -type f -iname \"*%s*\" -print"</span> keyword))
             (git-cmd-fmt (<span style="color: #a020f0;">if</span> git-grep-p <span style="color: #8b2252;">"git grep -n \"%s\""</span> <span style="color: #8b2252;">"grep --exclude-dir=\"*/.git\" --exclude-dir=\"*/.svn\"  -rns  \"%s\" ."</span> ))
             (grep-cmd (format git-cmd-fmt keyword))
             (default-directory directory)
             (output (shell-command-to-string (<span style="color: #a020f0;">if</span> grep-p grep-cmd find-cmd)))
             (lines (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>))
             (hint (<span style="color: #a020f0;">if</span> grep-p <span style="color: #8b2252;">"Grep file in %s: "</span> <span style="color: #8b2252;">"Find file in %s: "</span>))
             selected-line
             selected-file
             linenum)
        (<span style="color: #a020f0;">setq</span> selected-line  (ivy-read (format hint default-directory)
                                          lines))
        (<span style="color: #a020f0;">cond</span>
          (grep-p
           (<span style="color: #a020f0;">when</span> (string-match <span style="color: #8b2252;">"</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">^[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">:]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:"</span> selected-line)
             (<span style="color: #a020f0;">setq</span> selected-file (match-string 1 selected-line))
             (<span style="color: #a020f0;">setq</span> linenum (match-string 2 selected-line))))
          (t
           (<span style="color: #a020f0;">setq</span> selected-file selected-line)))
        (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> selected-line (file-exists-p selected-file))
          (find-file selected-file)
          (<span style="color: #a020f0;">when</span> grep-p
          (goto-char (point-min))
          (forward-line (1- (string-to-number linenum)))))
        ))))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-git-search-text-in-project</span> ()
  <span style="color: #8b2252;">"Search text of files in project root directory using git grep."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (my-file-internal (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>) t t))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-search-text-in-project</span> ()
  <span style="color: #8b2252;">"Search text of files in project root directory."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (my-file-internal (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>) t))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-search-text</span> (<span style="color: #228b22;">&amp;optional</span> level)
  <span style="color: #8b2252;">"Search text of files in current directory or LEVEL parent directory."</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (<span style="color: #a020f0;">unless</span> level (<span style="color: #a020f0;">setq</span> level 0))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">default-directory</span>
  (<span style="color: #a020f0;">let*</span> ((parent-directory default-directory)
         (i 0))
    (<span style="color: #a020f0;">while</span> (&lt; i level)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">directory-file-name</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">file-name-directory</span>
      (<span style="color: #a020f0;">setq</span> parent-directory
            (file-name-directory (directory-file-name parent-directory)))
      (<span style="color: #a020f0;">setq</span> i (+ i 1)))
    <span style="color: #b22222;">;;</span><span style="color: #b22222;">2,xf</span>
    (my-file-internal parent-directory t)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file-in-project</span> ()
  <span style="color: #8b2252;">"Find files in project root directory."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (my-file-internal (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file</span> (<span style="color: #228b22;">&amp;optional</span> level)
  <span style="color: #8b2252;">"Find file in current directory or LEVEL parent directory."</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (<span style="color: #a020f0;">unless</span> level (<span style="color: #a020f0;">setq</span> level 0))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">default-directory</span>
  (<span style="color: #a020f0;">let*</span> ((parent-directory default-directory)
         (i 0))
    (<span style="color: #a020f0;">while</span> (&lt; i level)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">directory-file-name</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">file-name-directory</span>
      (<span style="color: #a020f0;">setq</span> parent-directory
            (file-name-directory (directory-file-name parent-directory)))
      (<span style="color: #a020f0;">setq</span> i (+ i 1)))
    <span style="color: #b22222;">;;</span><span style="color: #b22222;">2,xf</span>
    (my-file-internal parent-directory)))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x my-search-text-in-project</span>
</pre>
</div>

<p>
<b>搜索文件提速</b>
利用 git 让 my-find-file-in-project 函数提速
`git ls-files &#x2013;full-name &#x2013;`
</p>

<div class="org-src-container">
<pre class="src src-shell">&gt; git ls-files --full-name --
Jenkinsfile
README.md
addapay/addapay-jenkinsfile
app/app-jenkinsfile
app/app-website-jenkinsfile
bigdata/bigdata-jenkinsfile
</pre>
</div>
</div>
</div>
<div id="outline-container-org757cee1" class="outline-3">
<h3 id="org757cee1">不写任何代码大大加速文本文件操作 vmtouch</h3>
<div class="outline-text-3" id="text-org757cee1">
<p>
任何读写文件的软件都可以用这个方法来优化。如 firefox\chrome
</p>

<p>
<b>vmtouch - the virtual memory toucher</b>
把对应的文件或目录载入到内存中，不支持windows。
<a href="https://hoytech.com/vmtouch/">https://hoytech.com/vmtouch/</a>
</p>

<p>
vmtouch 安装：
</p>
<div class="org-src-container">
<pre class="src src-shell">brew install vmtouch
</pre>
</div>

<p>
常用选项：
vmtouch [OPTIONS] .. FILES OR DERECTORIES &#x2026;
-v 选项来显示当前已经加入到内存中的文件或目录，以及它们所占用的内存大小
-t 指定目录载入到内存
-e 从内存中去除，下次从硬盘上读取。
</p>

<p>
测试对比：time
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">grep</span>
<span style="color: #a020f0;">time</span> grep --exclude=<span style="color: #8b2252;">'.git'</span> -nrs <span style="color: #8b2252;">'test'</span> * &amp;&gt; /dev/null

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992; vmtouch &#24037;&#20855;&#23558;&#30446;&#24405;&#36733;&#20837;&#21040;&#20869;&#23384;</span>
vmtouch -t .

<span style="color: #b22222;"># </span><span style="color: #b22222;">grep</span>
<span style="color: #a020f0;">time</span> grep --exclude=<span style="color: #8b2252;">'.git'</span> -nrs <span style="color: #8b2252;">'test'</span> * &amp;&gt; /dev/null

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#24050;&#32463;&#21152;&#20837;&#21040;&#20869;&#23384;&#20013;&#30340;&#25991;&#20214;&#21644;&#30446;&#24405;</span>
vmtouch -v /

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20174;&#20869;&#23384;&#20013;&#21435;&#38500;</span>
vmtouch -e .
</pre>
</div>
</div>
</div>
<div id="outline-container-org63d7887" class="outline-3">
<h3 id="org63d7887">代码自动完成引擎company-mytags原型</h3>
<div class="outline-text-3" id="text-org63d7887">
<p>
创建文件：~/projs/company-my-tags/company-my-tags.el
</p>
</div>
<div id="outline-container-org14eaa96" class="outline-4">
<h4 id="org14eaa96">模块加载</h4>
<div class="outline-text-4" id="text-org14eaa96">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(message <span style="color: #8b2252;">"hello world"</span>)

(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">company-mytags</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21578;&#35785; emacs &#25552;&#20379; company-mytags &#27169;&#22359;</span>
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">company-my-tags.el ends here</span>
</pre>
</div>

<p>
如果配置要载入模块，添加如下到配置中：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">company-mytags</span>)
</pre>
</div>

<p>
模块位置是通过向 load-path 变量中加入路径。`C-h v load-path`
</p>
</div>
</div>
<div id="outline-container-org435062f" class="outline-4">
<h4 id="org435062f">company-mode 第三方自动完成框架借鉴</h4>
<div class="outline-text-4" id="text-org435062f">
<p>
UI  选项使用第三方 company-mode 提供的。<a href="http://company-mode.github.io/">http://company-mode.github.io/</a>  通过 `C-h C-f company-mode 打开源代码文件`
</p>

<p>
自动完成引擎：
</p>

<p>
<code>C-h v company-backends</code>
</p>
<ul class="org-ul">
<li>company-ispell 到英文词典中查英文单词</li>
<li>company-c-headers 自动找到 C 代码头文件</li>
<li>company-cmake  写 C++ cmake 脚本时自动完成</li>
<li>company-bbdb   写邮件时自动完成邮件地址、收件人名</li>
<li>company-semantic  java 的</li>
<li>company-cmake</li>
<li>company-capf</li>
<li>company-clang</li>
<li>company-files  自动完成文件路径。如 `(cd "~/tmp")`</li>
<li>company-dabbrev-code  从已写代码中找到，自动完成</li>
<li>company-gtags 合命令行工具 gtags 结合，对 c++ java 支持比较好</li>
<li>company-ctags 类似于 gtags，智能程度没 gtags 高</li>
<li>company-keywords</li>
<li>company-oddmuse</li>
<li>company-dabbrev)</li>
</ul>

<p>
<code>C-h C-f company-gtags</code> 代码复制过来进行修改。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;;</span><span style="color: #b22222;">###</span><span style="color: #ff0000; font-weight: bold;">autoload</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-gtags</span> (command <span style="color: #228b22;">&amp;optional</span> arg <span style="color: #228b22;">&amp;rest</span> ignored)
  <span style="color: #8b2252;">"`</span><span style="color: #008b8b;">company-mode</span><span style="color: #8b2252;">' completion backend for GNU Global."</span>
  (<span style="color: #a020f0;">interactive</span> (list 'interactive))
  (<span style="color: #a020f0;">cl-case</span> command
    (<span style="color: #a020f0;">interactive</span> (company-begin-backend 'company-gtags))
    (prefix (<span style="color: #a020f0;">and</span> (company-gtags--executable)
                 buffer-file-name
                 (apply #'derived-mode-p company-gtags-modes)
                 (not (company-in-string-or-comment))
                 (company-gtags--tags-available-p)
                 (<span style="color: #a020f0;">or</span> (company-grab-symbol) 'stop)))
    (candidates (company-gtags--fetch-tags arg))
    (sorted t)
    (duplicates t)
    (annotation (company-gtags--annotation arg))
    (meta (get-text-property 0 'meta arg))
    (location (get-text-property 0 'location arg))
    (post-completion (<span style="color: #a020f0;">let</span> ((anno (company-gtags--annotation arg)))
                       (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> company-gtags-insert-arguments anno)
                         (insert anno)
                         (company-template-c-like-templatify anno))))))

(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">company-gtags</span>)
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">company-gtags.el ends here</span>
</pre>
</div>

<p>
prefix: 不是函数，返回用户输入的前缀给 framework
</p>

<p>
company-grab-symbol: 当前的符号
</p>

<p>
candidates：对用户输入前缀处理， 把用户输入作为参数传给你，返回一个列表，列表中包含字符串，这些字符串就是用来自动完成的。
</p>



<p>
只保留自定义引擎
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-candidates</span> (arg)
  (message <span style="color: #8b2252;">"arg=%s"</span> arg)
  '(<span style="color: #8b2252;">"hello1"</span>
    <span style="color: #8b2252;">"hello2"</span>
    <span style="color: #8b2252;">"bye1"</span>
    <span style="color: #8b2252;">"bye2"</span>))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags</span> (command <span style="color: #228b22;">&amp;optional</span> arg <span style="color: #228b22;">&amp;rest</span> ignored)
  <span style="color: #8b2252;">"`</span><span style="color: #008b8b;">company-mode</span><span style="color: #8b2252;">' completion backend for GNU Global."</span>
  (<span style="color: #a020f0;">interactive</span> (list 'interactive))
  (<span style="color: #a020f0;">cl-case</span> command
    (<span style="color: #a020f0;">interactive</span> (company-begin-backend 'company-gtags))
    (prefix (company-grab-symbol))
    (candidates (company-mytags-candidates arg))))

(<span style="color: #a020f0;">setq</span> company-backends '(company-mytags)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">debug code</span>
(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">company-mytags</span>)
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">company-my-tags.el ends here</span>
</pre>
</div>

<p>
测试：
</p>

<p>
输入 test 可以看到能匹配出 company-mytags-candidates 函数给定的字符。
</p>

<p>
<b>添加字符串过滤功能</b>
</p>

<p>
push: (push NEWELT PLACE) 列表中追加元素。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-candidates</span> (prefix)
  (<span style="color: #a020f0;">let*</span> ((all-items '(<span style="color: #8b2252;">"hello1"</span>
                     <span style="color: #8b2252;">"hello2"</span>
                     <span style="color: #8b2252;">"test1"</span>
                     <span style="color: #8b2252;">"testtab2"</span>
                     <span style="color: #8b2252;">"testtab3"</span>
                     <span style="color: #8b2252;">"bye1"</span>
                     <span style="color: #8b2252;">"bye2"</span>))
         rlt)
    (<span style="color: #a020f0;">dolist</span> (item all-items)
      (<span style="color: #a020f0;">when</span> (string-match prefix item)
        (<span style="color: #a020f0;">push</span> item rlt)))
    rlt))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags</span> (command <span style="color: #228b22;">&amp;optional</span> arg <span style="color: #228b22;">&amp;rest</span> ignored)
  <span style="color: #8b2252;">"`</span><span style="color: #008b8b;">company-mode</span><span style="color: #8b2252;">' completion backend for GNU Global."</span>
  (<span style="color: #a020f0;">interactive</span> (list 'interactive))
  (<span style="color: #a020f0;">cl-case</span> command
    (<span style="color: #a020f0;">interactive</span> (company-begin-backend 'company-gtags))
    (prefix (company-grab-symbol))
    (candidates (company-mytags-candidates arg))))

(<span style="color: #a020f0;">setq</span> company-backends '(company-mytags)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">debug code</span>
(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">company-mytags</span>)
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">company-my-tags.el ends here</span>
</pre>
</div>

<p>
company-mode 默认至少在用户输入 3 个字符时才会触发自动实例功能。自定义可以修改变量 company-minimum-prefix-length。
</p>
</div>
</div>
</div>
<div id="outline-container-org7f3c5f0" class="outline-3">
<h3 id="org7f3c5f0">为company-mytags开发模糊(fuzzy)</h3>
<div class="outline-text-3" id="text-org7f3c5f0">
<p>
正则表达式稍微灵活运用一下。
</p>

<p>
company-backends 默认是局部变量，我们可以在源代码中找到定义：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(put 'company-backends 'safe-local-variable 'company-safe-backends-p)
</pre>
</div>

<p>
safe-local-variable: 表示变量和你当前打开的 buffer 绑定的。
</p>

<p>
只要在新的 buffer 中运行自动补全引擎就可以了。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-expression (setq company-backends '(company-mytags))</span>
</pre>
</div>


<p>
<b>匹配行的开始</b>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (string-match (concat <span style="color: #8b2252;">"^"</span> prefix) item)
</pre>
</div>

<p>
<b>fuzzy match</b>
只要第一个字符能匹配，后面的字符能匹配到。
如： <code>hello 可以写为 ^h.*l.*l</code>
</p>

<p>
取字符串的字符：(substring STRING &amp;optional FROM TO) 下标 0 为第一个字符。
</p>
<ul class="org-ul">
<li>(substring "abc" 0 1) 取第一个字符 a</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-candidates</span> (prefix)
  (<span style="color: #a020f0;">let*</span> ((all-items '(<span style="color: #8b2252;">"hello1"</span>
                     <span style="color: #8b2252;">"hello2"</span>
                     <span style="color: #8b2252;">"test1"</span>
                     <span style="color: #8b2252;">"testtab2"</span>
                     <span style="color: #8b2252;">"testtab3"</span>
                     <span style="color: #8b2252;">"bye1"</span>
                     <span style="color: #8b2252;">"bye2"</span>))
         (i 0)
         (pattern <span style="color: #8b2252;">"^"</span>)
         rlt)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">hel =&gt; ^h.*e.*l.*</span>
    (<span style="color: #a020f0;">while</span> (&lt; i (length prefix))
      (<span style="color: #a020f0;">setq</span> pattern (concat pattern (substring prefix i (1+ i)) <span style="color: #8b2252;">".*"</span>))
      (<span style="color: #a020f0;">setq</span> i (1+ i)))

    (message <span style="color: #8b2252;">"pattern=%s"</span> pattern)

    (<span style="color: #a020f0;">dolist</span> (item all-items)
      (<span style="color: #a020f0;">when</span> (string-match pattern item)
        (<span style="color: #a020f0;">push</span> item rlt)))
    rlt))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags</span> (command <span style="color: #228b22;">&amp;optional</span> arg <span style="color: #228b22;">&amp;rest</span> ignored)
  <span style="color: #8b2252;">"`</span><span style="color: #008b8b;">company-mode</span><span style="color: #8b2252;">' completion backend for GNU Global."</span>
  (<span style="color: #a020f0;">interactive</span> (list 'interactive))
  (<span style="color: #a020f0;">cl-case</span> command
    (<span style="color: #a020f0;">interactive</span> (company-begin-backend 'company-gtags))
    (prefix (company-grab-symbol))
    (candidates (company-mytags-candidates arg))))

(<span style="color: #a020f0;">setq</span> company-backends '(company-mytags)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">debug code</span>
(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">company-mytags</span>)
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">company-my-tags.el ends here</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org089190d" class="outline-3">
<h3 id="org089190d">在其他IDE应用基于模糊匹配算法的技巧</h3>
<div class="outline-text-3" id="text-org089190d">
<p>
可以模糊匹配。如 cpp test
</p>
<ul class="org-ul">
<li><code>c.*p.*p.*t.*e.*s.*t.*</code></li>
<li><code>t.*e.*s.*t.*c.*p.*p.*</code></li>
</ul>
</div>
</div>
<div id="outline-container-orga6bd640" class="outline-3">
<h3 id="orga6bd640">让company-mytags可以实时扫描项目代码</h3>
<div class="outline-text-3" id="text-orga6bd640">
<p>
扫描真实目录来提取后选字符串。
</p>

<ul class="org-ul">
<li>找到根目录</li>
<li>找文件</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-scan-project-root</span> ()
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>))
         (find-cmd (format <span style="color: #8b2252;">"find . -path \"*/.git\"  -prune -o -type f -iname \"*.html*\" -print"</span>))
         (output (shell-command-to-string find-cmd))
         (files (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>))
         rlt)
    (message <span style="color: #8b2252;">"root-dir=%s"</span> root-dir)
    (message <span style="color: #8b2252;">"files=%s"</span> lines)
    (<span style="color: #a020f0;">setq</span> rlt '(<span style="color: #8b2252;">"hello1"</span>
                      <span style="color: #8b2252;">"hello2"</span>
                      <span style="color: #8b2252;">"test1"</span>
                      <span style="color: #8b2252;">"testtab2"</span>
                      <span style="color: #8b2252;">"testtab3"</span>
                      <span style="color: #8b2252;">"bye1"</span>
                      <span style="color: #8b2252;">"bye2"</span>))
    rlt))
</pre>
</div>


<p>
<b>读出文件内容</b>
</p>

<p>
读文件 insert-file-contents filename
</p>
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Reading-from-Files.html">https://www.gnu.org/software/emacs/manual/html_node/elisp/Reading-from-Files.html</a></li>
<li><a href="http://xahlee.info/emacs/emacs/elisp_read_file.html">http://xahlee.info/emacs/emacs/elisp_read_file.html</a></li>

<li>取字符串前100个字符：(substring str 0 100)</li>
<li>字符串长度：(length str)</li>
<li>文件存在：(file-exists-p file)</li>
<li>字符串不为空：(not (string= str ""))</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-scan-project-root</span> ()
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>))
         (find-cmd (format <span style="color: #8b2252;">"find . -path \"*/.git\"  -prune -o -type f -iname \"*.html*\" -print"</span>))
         (output (shell-command-to-string find-cmd))
         (files (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>))
         (all-content <span style="color: #8b2252;">""</span>)
         rlt)
    (message <span style="color: #8b2252;">"root-dir=%s"</span> root-dir)
    (message <span style="color: #8b2252;">"files=%s"</span> files)
    (<span style="color: #a020f0;">dolist</span> (file files)
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (not (string= file <span style="color: #8b2252;">""</span>))
                 (file-exists-p file))
        (message <span style="color: #8b2252;">"file=%s"</span> file)
        (<span style="color: #a020f0;">setq</span> all-content (concat all-content
                                  (<span style="color: #a020f0;">with-temp-buffer</span>
                                    (insert-file-contents file)
                                    (buffer-string)
                                    )))))
    (message <span style="color: #8b2252;">"all-content=%s  len=%s"</span>
             (substring all-content 0 100)
             (length all-content))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">scan root-dir</span>
    (<span style="color: #a020f0;">setq</span> rlt '(<span style="color: #8b2252;">"hello1"</span>
                <span style="color: #8b2252;">"hello2"</span>
                <span style="color: #8b2252;">"test1"</span>
                <span style="color: #8b2252;">"testtab2"</span>
                <span style="color: #8b2252;">"testtab3"</span>
                <span style="color: #8b2252;">"bye1"</span>
                <span style="color: #8b2252;">"bye2"</span>))
    rlt))
</pre>
</div>


<p>
<b>取出文件内容</b>
</p>

<ul class="org-ul">
<li>正则以空格或者非字符分隔：(split-string str "[^a-zA-Z-_]")</li>
<li>对字符串进行排序：(sort '("abc" "e" "c") 'string&lt;)</li>
<li>从列表中删除重复项: (delq nil (delete-dups (list "foo" "bar" nil "moo" "bar" "moo" nil "affe"))) <a href="https://stackoverflow.com/questions/3815467/stripping-duplicate-elements-in-a-list-of-strings-in-elisp">参考 stack 回答</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-scan-project-root</span> ()
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">".git"</span>))
         (find-cmd (format <span style="color: #8b2252;">"find . -path \"*/.git\"  -prune -o -type f -iname \"*.html*\" -print"</span>))
         (output (shell-command-to-string find-cmd))
         (files (split-string output <span style="color: #8b2252;">"[\n\r]+"</span>))
         (all-content <span style="color: #8b2252;">""</span>)
         rlt)
    (<span style="color: #a020f0;">dolist</span> (file files)
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (not (string= file <span style="color: #8b2252;">""</span>))
                 (file-exists-p file))
        (<span style="color: #a020f0;">setq</span> all-content (concat all-content (<span style="color: #a020f0;">with-temp-buffer</span>
                                                (insert-file-contents file)
                                                (buffer-string))))))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">scan root-dir</span>
    (<span style="color: #a020f0;">setq</span> rlt (delq nil (delete-dups (sort (split-string all-content <span style="color: #8b2252;">"[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">a-zA-Z-_]"</span>) 'string&lt;))))
    rlt))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-candidates</span> (prefix)
  (<span style="color: #a020f0;">let*</span> ((all-items (company-mytags-scan-project-root))
         (i 0)
         (pattern <span style="color: #8b2252;">"^"</span>)
         rlt)
    (<span style="color: #a020f0;">while</span> (&lt; i (length prefix))
      (<span style="color: #a020f0;">setq</span> pattern (concat pattern (substring prefix i (1+ i)) <span style="color: #8b2252;">".*"</span>))
      (<span style="color: #a020f0;">setq</span> i (1+ i)))

    (<span style="color: #a020f0;">dolist</span> (item all-items)
      (<span style="color: #a020f0;">when</span> (string-match pattern item)
        (<span style="color: #a020f0;">push</span> item rlt)))
    rlt))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags</span> (command <span style="color: #228b22;">&amp;optional</span> arg <span style="color: #228b22;">&amp;rest</span> ignored)
  <span style="color: #8b2252;">"`</span><span style="color: #008b8b;">company-mode</span><span style="color: #8b2252;">' completion backend for GNU Global."</span>
  (<span style="color: #a020f0;">interactive</span> (list 'interactive))
  (<span style="color: #a020f0;">cl-case</span> command
    (<span style="color: #a020f0;">interactive</span> (company-begin-backend 'company-gtags))
    (prefix (company-grab-symbol))
    (candidates (company-mytags-candidates arg))))

(<span style="color: #a020f0;">setq</span> company-backends '(company-mytags)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">debug code</span>
(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">company-mytags</span>)
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">company-my-tags.el ends here</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer</span>
</pre>
</div>

<p>
缺点：
</p>
<ul class="org-ul">
<li>性能差，敲入一个字符都会调用这个函数，读取多文件。</li>
<li>emacs lisp 性能比较低，它不是专门用来文件高效读写与编程。一般会用 c 或者 c++ 或者其它语言来做</li>
<li>没有扩展性，对多语言不适用</li>
</ul>
</div>
</div>
<div id="outline-container-orgf7d1ee1" class="outline-3">
<h3 id="orgf7d1ee1">利用ctags来加强company-mytags的代码扫描</h3>
<div class="outline-text-3" id="text-orgf7d1ee1">
<p>
<b>ctags 安装</b>
</p>

<p>
ctags 支持各种编程语言。
</p>

<p>
官方地址：<a href="https://ctags.sourceforge.net/">https://ctags.sourceforge.net/</a>
</p>

<p>
安装
参考：<a href="https://galea.medium.com/getting-started-with-ctags-vim-on-macos-87bcb07cf6d">https://galea.medium.com/getting-started-with-ctags-vim-on-macos-87bcb07cf6d</a>
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">macos</span>
brew install ctags
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">ctags</span>=<span style="color: #8b2252;">"`brew --prefix`/bin/ctags"</span>
<span style="color: #483d8b;">alias</span> ctags &gt;&gt; ~/.bashrc

ctags --version
man ctags
</pre>
</div>

<p>
ctags 命令 选项
</p>
<div class="org-src-container">
<pre class="src src-shell">-e &#29983;&#25104; emacs &#20860;&#23481;&#30340;&#26684;&#24335;
-R &#36882;&#24402;&#25628;&#32034;&#23376;&#30446;&#24405;
--exclude &#25490;&#38500;&#25991;&#20214;
</pre>
</div>

<p>
ctags 使用
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#29983;&#25104; TAGS &#25991;&#20214;</span>
ctags -e -R

cat TAGS
^L <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25442;&#39029;</span>
company-my-tags.el,238 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25991;&#20214;&#21517;&#65292;&#25991;&#20214;&#22823;&#23567;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21015;&#20986;&#25195;&#25551;&#20986;&#26469;&#30340;&#20851;&#38190;&#23383; ^&#65311;&#31526;&#21495; ^? &#34892;&#21495;</span>
(defun company-mytags-scan-project-root ()^?company-mytags-scan-project-root^A1,0
(defun company-mytags-candidates (prefix)^?company-mytags-candidates^A18,798
(defun company-mytags (<span style="color: #483d8b;">command</span> &amp;optional arg &amp;rest ignored)^?company-mytags^A32,1182


<span style="color: #b22222;"># </span><span style="color: #b22222;">&#28436;&#31034;&#25490;&#38500;&#29992;&#27861;</span>
mkdir subdir1
touch subdir1/hello.el
cat subdir1/hello.el
(defun helle ()
  (message <span style="color: #8b2252;">"hello world"</span>))
(defun bye ()
  (message <span style="color: #8b2252;">"bye world"</span>))

ctags -e -R
&gt; cat TAGS
^L
company-my-tags.el,238
(defun company-mytags-scan-project-root ()^?company-mytags-scan-project-root^A1,0
(defun company-mytags-candidates (prefix)^?company-mytags-candidates^A18,798
(defun company-mytags (<span style="color: #483d8b;">command</span> &amp;optional arg &amp;rest ignored)^?company-mytags^A32,1182
^L
subdir1/hello.el,49
(defun helle ()^?helle^A1,0
(defun bye ()^?bye^A3,43


ctags -e -R --exclude=<span style="color: #8b2252;">"subdir1/*"</span>
&gt; cat TAGS
^L
company-my-tags.el,238
(defun company-mytags-scan-project-root ()^?company-mytags-scan-project-root^A1,0
(defun company-mytags-candidates (prefix)^?company-mytags-candidates^A18,798
(defun company-mytags (<span style="color: #483d8b;">command</span> &amp;optional arg &amp;rest ignored)^?company-mytags^A32,1182

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25490;&#38500;&#24403;&#21069;&#30446;&#24405;&#19979;&#30446;&#24405;&#65292;&#21644;&#20219;&#24847;&#30446;&#24405;&#19979;&#23376;&#30446;&#24405;&#25991;&#20214;</span>
ctags -e -R --exclude=<span style="color: #8b2252;">"subdir1/*"</span> --exclude=<span style="color: #8b2252;">"*/subdir1/*"</span> 
ctags -e -R --exclude=<span style="color: #8b2252;">".git/*"</span> --exclude=<span style="color: #8b2252;">"*/.git/*"</span> --exclude=<span style="color: #8b2252;">".#*"</span>   <span style="color: #b22222;"># </span><span style="color: #b22222;">.#* &#36807;&#28388; .#xxx &#38450;&#31995;&#32479;&#23849;&#28291;&#30340;&#38544;&#34255;&#25991;&#20214;</span>
</pre>
</div>


<p>
<b>ctags 定时任务</b>
</p>

<p>
ctags 扫描时还是影响性能的，我们可以利用定时任务来执行。如在 linux 下的 crontab
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #483d8b;">cd</span> /Users/7tq6lr/projs/company-my-tags &amp;&amp;  ctags -e -R --exclude=<span style="color: #8b2252;">".git/*"</span> --exclude=<span style="color: #8b2252;">"*/.git/*"</span> --exclude=<span style="color: #8b2252;">".#*"</span>   <span style="color: #b22222;"># </span><span style="color: #b22222;">.#* &#36807;&#28388; .#xxx &#38450;&#31995;&#32479;&#23849;&#28291;&#30340;&#38544;&#34255;&#25991;&#20214;</span>
</pre>
</div>

<p>
<b>mytags</b>
</p>

<ul class="org-ul">
<li>只需要找到 TAGS 所在目录</li>
<li>不需要执行命令</li>
<li>TAGS 文件内容用 8 进制分隔处理。
<ul class="org-ul">
<li>按 ga 显示字符的 ASCII 码 10 进制、8 进制、16进制数</li>
<li>^? 8 进制为 177，^A 8 进制为 1</li>
</ul></li>
</ul>

<p>
修改 company-mytags-scan-project-root 函数
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-scan-project-root</span> ()
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">"TAGS"</span>))
         (tags-file (concat root-dir <span style="color: #8b2252;">"TAGS"</span>))
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">ctags -e -R --exclude=".git/*" --exclude="*/.git/*"</span>
         all-content
         (regex <span style="color: #8b2252;">"^[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+\177</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\001[0-9]+,[0-9]+$"</span>)
         (start 0)
         tag-name
         rlt)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(message "tags-files=%s" tags-file)</span>
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (file-exists-p tags-file)
               (<span style="color: #a020f0;">setq</span> all-content (<span style="color: #a020f0;">with-temp-buffer</span>
                                   (insert-file-contents tags-file)
                                   (buffer-string))))
      (<span style="color: #a020f0;">while</span> (string-match regex all-content start)
        (<span style="color: #a020f0;">setq</span> tag-name (match-string 1 all-content))
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">(message "----rlt=%s" rlt)</span>
        (<span style="color: #a020f0;">push</span> tag-name rlt)
        (<span style="color: #a020f0;">setq</span> start (+ start (length (match-string 0 all-content))))
        )
      )
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(message "rlt=%s" rlt)</span>
    (<span style="color: #a020f0;">setq</span> rlt (delq nil (delete-dups (sort rlt 'string&lt;))))
    rlt))
</pre>
</div>

<p>
不是每次都执行。
</p>
<ul class="org-ul">
<li>定义缓存变量 company-mytags-cache</li>
<li>没缓存时调用 company-mytags-scan-project-root 函数，有缓存时直接使用缓存中的值</li>
</ul>

<p>
仅修改 company-mytags-candidates 函数
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">company-mytags-cache</span> nil
  <span style="color: #8b2252;">"Cache of tags fiel"</span>)

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-scan-project-root</span> ()
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">"TAGS"</span>))
         (tags-file (concat root-dir <span style="color: #8b2252;">"TAGS"</span>))
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">ctags -e -R --exclude=".git/*" --exclude="*/.git/*"</span>
         all-content
         (regex <span style="color: #8b2252;">"^[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+\177</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\001[0-9]+,[0-9]+$"</span>)
         (start 0)
         tag-name
         rlt)
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (file-exists-p tags-file)
               (<span style="color: #a020f0;">setq</span> all-content (<span style="color: #a020f0;">with-temp-buffer</span>
                                   (insert-file-contents tags-file)
                                   (buffer-string))))
      (<span style="color: #a020f0;">while</span> (string-match regex all-content start)
        (<span style="color: #a020f0;">setq</span> tag-name (match-string 1 all-content))
        (<span style="color: #a020f0;">push</span> tag-name rlt)
        (<span style="color: #a020f0;">setq</span> start (+ start (length (match-string 0 all-content))))))
    (<span style="color: #a020f0;">setq</span> rlt (delq nil (delete-dups (sort rlt 'string&lt;))))
    rlt))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-candidates</span> (prefix)
  (<span style="color: #a020f0;">let*</span> ((i 0)
         (pattern <span style="color: #8b2252;">"^"</span>)
         rlt)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">file cache</span>
    (<span style="color: #a020f0;">unless</span> company-mytags-cache
      (<span style="color: #a020f0;">setq</span> company-mytags-cache (company-mytags-scan-project-root)))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">matching by prefix</span>
    (<span style="color: #a020f0;">while</span> (&lt; i (length prefix))
      (<span style="color: #a020f0;">setq</span> pattern (concat pattern (substring prefix i (1+ i)) <span style="color: #8b2252;">".*"</span>))
      (<span style="color: #a020f0;">setq</span> i (1+ i)))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">finalize candidates</span>
    (<span style="color: #a020f0;">dolist</span> (item company-mytags-cache)
      (<span style="color: #a020f0;">when</span> (string-match pattern item)
        (<span style="color: #a020f0;">push</span> item rlt)))
    rlt))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags</span> (command <span style="color: #228b22;">&amp;optional</span> arg <span style="color: #228b22;">&amp;rest</span> ignored)
  <span style="color: #8b2252;">"`</span><span style="color: #008b8b;">company-mode</span><span style="color: #8b2252;">' completion backend for GNU Global."</span>
  (<span style="color: #a020f0;">interactive</span> (list 'interactive))
  (<span style="color: #a020f0;">cl-case</span> command
    (<span style="color: #a020f0;">interactive</span> (company-begin-backend 'company-gtags))
    (prefix (company-grab-symbol))
    (candidates (company-mytags-candidates arg))))

(<span style="color: #a020f0;">setq</span> company-backends '(company-mytags)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">debug code</span>
(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">company-mytags</span>)
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">company-my-tags.el ends here</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaa7aab7" class="outline-3">
<h3 id="orgaa7aab7">company-mytags可实时载入Ctags生成</h3>
<div class="outline-text-3" id="text-orgaa7aab7">
<p>
性能优化可以处理大型项目。需要一些新的算法来处理。
</p>

<ul class="org-ul">
<li>一旦生成新的 TAGS 需要把缓存更新一下。</li>
<li>去掉局部变量 rlt</li>
<li>检查文件时间戳
<ul class="org-ul">
<li>(file-attribute-modification-time ATTRIBUTES)</li>
</ul></li>
<li>文件属性
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/File-Attributes.html">https://www.gnu.org/software/emacs/manual/html_node/elisp/File-Attributes.html</a></li>
<li>(file-attributes FILENAME &amp;optional ID-FORMAT)</li>
<li>(file-attributes "~/projs/company-my-tags/TAGS")  列表中第 5 个值为文件时间属性</li>
<li>(nth 5(file-attributes "~/projs/company-my-tags/TAGS"))</li>
<li>转换时间格式 <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Time-of-Day.html">https://www.gnu.org/software/emacs/manual/html_node/elisp/Time-of-Day.html</a>
<ul class="org-ul">
<li>以秒时间单位：(float-time (nth 5 (file-attributes "~/projs/company-my-tags/TAGS"))) # 1677045133.2727444</li>
</ul></li>
</ul></li>

<li>修改变量 company-mytags-cache 使用 Property Lists
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Plist-Access.html">https://www.gnu.org/software/emacs/manual/html_node/elisp/Plist-Access.html</a></li>
<li>(key1 value1 key2 valued)</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">company-mytags-cache</span> nil  <span style="color: #8b2252;">"Cache of tags fiel"</span>)

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-update-p</span> (tags-file)
  (<span style="color: #a020f0;">let*</span> (rlt old-modification-time file-modification-time)
    (<span style="color: #a020f0;">cond</span>
     ((not company-mytags-cache)
      (<span style="color: #a020f0;">setq</span> rlt t))
     (t
      (<span style="color: #a020f0;">setq</span> old-modification-time (plist-get company-mytags-cache
                                             'modification-time))
      (<span style="color: #a020f0;">setq</span> file-modification-time
            (float-time (nth 5 (file-attributes tags-file))))
      (message <span style="color: #8b2252;">"old=%s file=%s"</span> old-modification-time file-modification-time)
      (message <span style="color: #8b2252;">"t=%s"</span>  (- file-modification-time old-modification-time))
      (<span style="color: #a020f0;">when</span> (&gt; (- file-modification-time old-modification-time) 4)
        (<span style="color: #a020f0;">setq</span> rlt t))))
    rlt))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-scan-project-root</span> ()
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">"TAGS"</span>))
         (tags-file (concat root-dir <span style="color: #8b2252;">"TAGS"</span>))
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">ctags -e -R --exclude=".git/*" --exclude="*/.git/*"</span>
         all-content
         (regex <span style="color: #8b2252;">"^[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+\177</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\001[0-9]+,[0-9]+$"</span>)
         (start 0)
         tag-name
         rlt)
    (<span style="color: #a020f0;">when</span> (company-mytags-update-p tags-file)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">attach file modification time</span>
      (<span style="color: #a020f0;">setq</span> company-mytags-cache
            (plist-put company-mytags-cache
                       'modification-time
                       (float-time (nth 5 (file-attributes tags-file)))))
      (message <span style="color: #8b2252;">"company-mytags-cache=%s"</span> company-mytags-cache)
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (file-exists-p tags-file)
                 (<span style="color: #a020f0;">setq</span> all-content (<span style="color: #a020f0;">with-temp-buffer</span>
                                     (insert-file-contents tags-file)
                                     (buffer-string))))
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">extract tag names</span>
        (<span style="color: #a020f0;">while</span> (string-match regex all-content start)
          (<span style="color: #a020f0;">setq</span> tag-name (match-string 1 all-content))
          (<span style="color: #a020f0;">push</span> tag-name rlt)
          (<span style="color: #a020f0;">setq</span> start (+ start (length (match-string 0 all-content))))))

      <span style="color: #b22222;">;; </span><span style="color: #b22222;">update candidates</span>
      (<span style="color: #a020f0;">setq</span> company-mytags-cache
            (plist-put company-mytags-cache
                       'candidates
                       (delq nil (delete-dups (sort rlt 'string&lt;)))))

      (message <span style="color: #8b2252;">"company-mytags-cache=%s"</span> company-mytags-cache)
      )))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-candidates</span> (prefix)
  (<span style="color: #a020f0;">let*</span> ((i 0)
         (pattern <span style="color: #8b2252;">"^"</span>)
         rlt)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">file cache</span>
    (company-mytags-scan-project-root)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">matching by prefix</span>
    (<span style="color: #a020f0;">while</span> (&lt; i (length prefix))
      (<span style="color: #a020f0;">setq</span> pattern (concat pattern (substring prefix i (1+ i)) <span style="color: #8b2252;">".*"</span>))
      (<span style="color: #a020f0;">setq</span> i (1+ i)))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">finalize candidates</span>
    (<span style="color: #a020f0;">dolist</span> (item (plist-get company-mytags-cache 'candidates))
      (<span style="color: #a020f0;">when</span> (string-match pattern item)
        (<span style="color: #a020f0;">push</span> item rlt)))
    rlt))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags</span> (command <span style="color: #228b22;">&amp;optional</span> arg <span style="color: #228b22;">&amp;rest</span> ignored)
  <span style="color: #8b2252;">"`</span><span style="color: #008b8b;">company-mode</span><span style="color: #8b2252;">' completion backend for GNU Global."</span>
  (<span style="color: #a020f0;">interactive</span> (list 'interactive))
  (<span style="color: #a020f0;">cl-case</span> command
    (<span style="color: #a020f0;">interactive</span> (company-begin-backend 'company-gtags))
    (prefix (company-grab-symbol))
    (candidates (company-mytags-candidates arg))))

(<span style="color: #a020f0;">setq</span> company-backends '(company-mytags)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">debug code</span>
(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">company-mytags</span>)
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">company-my-tags.el ends here</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x eval-buffer</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#28165;&#31354;&#32531;&#23384; &#65288;setq company-mytags-cache nil&#65289;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26412;&#30446;&#24405;&#19979;&#25171;&#24320;&#20010;&#26032;&#25991;&#20214;&#65292;M-x eval-expression (setq company-backends '(company-mytags))</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge3c7013" class="outline-3">
<h3 id="orge3c7013">优化company-mytags性能</h3>
<div class="outline-text-3" id="text-orge3c7013">
<p>
如何在大项目中使用 company-mytags。
在大项目中如linux内核代码，存在 TAGS 文件在生成过程中可能被加载现象。
</p>

<ul class="org-ul">
<li>file-attributes filename 输出的第7个属性为文件大小</li>
<li>新内容加入到老缓存中
<ul class="org-ul">
<li>diff 命令比较文本文件 diff -Nabur TAGS TAGS.2</li>
<li>生产临时文件：(make-temp-file PREFIX &amp;optional DIR-FLAG SUFFIX TEXT)</li>
<li>写入文件：(write-region "something something" nil "~/temp.txt")</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org11d12a5" class="outline-4">
<h4 id="org11d12a5">shell 包使用</h4>
<div class="outline-text-4" id="text-org11d12a5">
<div class="org-src-container">
<pre class="src src-sh">M-x shell &#21629;&#20196;&#25171;&#24320; Shell &#31383;&#21475;

C-c C-c &#20013;&#26029;&#27491;&#22312;&#36816;&#34892;&#30340;&#21629;&#20196;&#12290;
C-c C-z &#23558;&#24403;&#21069;&#21629;&#20196;&#25346;&#36215;&#65292;&#24182;&#36820;&#22238;&#21040; Emacs &#32531;&#20914;&#21306;&#12290;
C-c C-u &#28165;&#31354;&#24403;&#21069;&#21629;&#20196;&#34892;&#12290;

M-p &#30452;&#21040;&#25214;&#21040;&#38656;&#35201;&#30340;&#21629;&#20196;
M-n &#26597;&#25214;&#20043;&#21069;&#25191;&#34892;&#30340;&#21629;&#20196;
</pre>
</div>
</div>
</div>
<div id="outline-container-org78fd5b1" class="outline-4">
<h4 id="org78fd5b1">完成内容</h4>
<div class="outline-text-4" id="text-org78fd5b1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">company-mytags-cache</span> nil <span style="color: #8b2252;">"Cache of tags file"</span>)

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-update-p</span> (tags-file)
  (<span style="color: #a020f0;">let*</span> (rlt old-modification-time file-modification-time old-file-size file-size)
    (<span style="color: #a020f0;">cond</span>
     ((not company-mytags-cache)
      (<span style="color: #a020f0;">setq</span> rlt <span style="color: #8b2252;">"full-update"</span>))
     (t
      (<span style="color: #a020f0;">setq</span> old-file-size (plist-get company-mytags-cache
                                     'file-size))
      (<span style="color: #a020f0;">setq</span> file-size (nth 7 (file-attributes tags-file)))
      (<span style="color: #a020f0;">setq</span> old-modification-time (plist-get company-mytags-cache
                                             'modification-time))
      (<span style="color: #a020f0;">setq</span> file-modification-time
            (float-time (nth 5 (file-attributes tags-file))))
      (message <span style="color: #8b2252;">"old-file-size=%s file-size=%s"</span> old-file-size file-size)
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (&gt; (- file-modification-time old-modification-time) 4)
                 (&gt; file-size old-file-size))
        (<span style="color: #a020f0;">setq</span> rlt <span style="color: #8b2252;">"lite-update"</span>))))
    rlt))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-extract-cands</span> (regex content)
  (<span style="color: #a020f0;">let*</span> (rlt (start 0) tag-name)
    (<span style="color: #a020f0;">while</span> (string-match regex content start)
      (<span style="color: #a020f0;">setq</span> tag-name (match-string 1 content))
      (<span style="color: #a020f0;">push</span> tag-name rlt)
      (<span style="color: #a020f0;">setq</span> start (+ start (length (match-string 0 content)))))
    (delq nil (delete-dups (sort rlt 'string&lt;)))))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-scan-project-root</span> ()
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">"TAGS"</span>))
         (tags-file (concat root-dir <span style="color: #8b2252;">"TAGS"</span>))
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">ctags -e -R --exclude=".git/*" --exclude="*/.git/*"</span>
         all-content
         (regex <span style="color: #8b2252;">"^[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+\177</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\001[0-9]+,[0-9]+$"</span>)
         do-update
         rlt)
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">setq</span> do-update (company-mytags-update-p tags-file))
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">attache file path</span>
      (<span style="color: #a020f0;">setq</span> company-mytags-cache
            (plist-put company-mytags-cache
                       'file-path
                       (file-truename tags-file)))
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">attach file modification time</span>
      (<span style="color: #a020f0;">setq</span> company-mytags-cache
            (plist-put company-mytags-cache
                       'modification-time
                       (float-time (nth 5 (file-attributes tags-file)))))

      <span style="color: #b22222;">;; </span><span style="color: #b22222;">attach file size</span>
      (<span style="color: #a020f0;">setq</span> company-mytags-cache
            (plist-put company-mytags-cache
                       'file-size
                       (nth 7 (file-attributes tags-file))))
      <span style="color: #b22222;">;;  </span><span style="color: #b22222;">load content of tags file into memory</span>
      (<span style="color: #a020f0;">cond</span>
       <span style="color: #b22222;">;; </span><span style="color: #b22222;">full update</span>
       ((string= do-update <span style="color: #8b2252;">"full-update"</span>)
        (message <span style="color: #8b2252;">"run full update"</span>)
        (<span style="color: #a020f0;">setq</span> all-content (<span style="color: #a020f0;">with-temp-buffer</span>
                            (insert-file-contents tags-file)
                            (buffer-string)))

        <span style="color: #b22222;">;; </span><span style="color: #b22222;">attach file content</span>
        (<span style="color: #a020f0;">setq</span> company-mytags-cache
              (plist-put company-mytags-cache
                         'file-content
                         all-content))

        <span style="color: #b22222;">;; </span><span style="color: #b22222;">extract tag names</span>
        (<span style="color: #a020f0;">setq</span> rlt (company-mytags-extract-cands regex all-content))
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">insert candidates to empty list</span>
        (<span style="color: #a020f0;">setq</span> company-mytags-cache
              (plist-put company-mytags-cache
                         'candidates
                         rlt)))

       <span style="color: #b22222;">;; </span><span style="color: #b22222;">lite update</span>
       ((string= do-update <span style="color: #8b2252;">"lite-update"</span>)
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">run diff between old tags file and new tags file</span>
        (message <span style="color: #8b2252;">"run lite update"</span>)
        (<span style="color: #a020f0;">let*</span> ((tmp-file (make-temp-file <span style="color: #8b2252;">"mytags"</span>))
               (old-content (plist-get company-mytags-cache 'file-content))
               (old-candidates (plist-get company-mytags-cache 'candidates))
               diff-output)
          (write-region old-content nil tmp-file)
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">make sure diff exist in $PATH</span>
          (<span style="color: #a020f0;">setq</span> diff-output (shell-command-to-string (format <span style="color: #8b2252;">"diff -Nabur %s %s"</span>
                                                             tmp-file
                                                             tags-file)))
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">extract tag names</span>
          (<span style="color: #a020f0;">setq</span> rlt (company-mytags-extract-cands regex diff-output))
          (message <span style="color: #8b2252;">"lite update rlt=%s"</span> rlt)
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">insert candidates to empty list</span>
          (<span style="color: #a020f0;">setq</span> company-mytags-cache
                (plist-put company-mytags-cache
                           'candidates
                           (append rlt old-candidates)))))))))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags-candidates</span> (prefix)
  (<span style="color: #a020f0;">let*</span> ((i 0)
         (pattern <span style="color: #8b2252;">"^"</span>)
         rlt)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">fill cache</span>
    (company-mytags-scan-project-root)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">matching by prefix</span>
    (<span style="color: #a020f0;">while</span> (&lt; i (length prefix))
      (<span style="color: #a020f0;">setq</span> pattern (concat pattern (substring prefix i (1+ i)) <span style="color: #8b2252;">".*"</span>))
      (<span style="color: #a020f0;">setq</span> i (1+ i)))

    (message <span style="color: #8b2252;">"candidates size=%s"</span> (length (plist-get company-mytags-cache 'candidates)))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">finalize candidates</span>
    (<span style="color: #a020f0;">dolist</span> (item (plist-get company-mytags-cache 'candidates))
      (<span style="color: #a020f0;">when</span> (string-match pattern item)
        (<span style="color: #a020f0;">push</span> item rlt)))
    rlt))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mytags</span> (command <span style="color: #228b22;">&amp;optional</span> arg <span style="color: #228b22;">&amp;rest</span> ignored)
  <span style="color: #8b2252;">"`</span><span style="color: #008b8b;">company-mode</span><span style="color: #8b2252;">' completion backend for mytags."</span>
  (<span style="color: #a020f0;">interactive</span> (list 'interactive))
  (<span style="color: #a020f0;">cl-case</span> command
    (<span style="color: #a020f0;">interactive</span> (company-begin-backend 'company-mytags))
    (prefix (company-grab-symbol))
    (candidates (company-mytags-candidates arg))))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq company-backends '(company-mytags)) ;; debug code</span>
(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">company-mytags</span>)
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">company-mytags.el ends here</span>
</pre>
</div>

<p>
验证
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#21152;&#36733;&#20195;&#30721;</span>
M-x eval-buffer


<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25171;&#24320;&#22810;&#23481;&#22120;&#65292;&#24182;&#25171;&#24320;&#19968;&#20010;&#20195;&#30721;&#24211;&#25991;&#20214;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25171;&#24320;shell&#32456;&#31471;&#65292;&#29983;&#20135; TAGS &#25991;&#20214;</span>
ctags -e -R --exclude=<span style="color: #8b2252;">".git/*"</span> --exclude=<span style="color: #8b2252;">"*/.git/*"</span>
vmtouch -t . <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36733;&#20837;&#20869;&#23384;&#21152;&#36895;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21152;&#36733;&#21518;&#31471;&#24341;&#25806;</span>
M-x eval-expression (setq company-backends <span style="color: #8b2252;">'(company-mytags))</span>

<span style="color: #8b2252;">#&#39564;&#35777;1-&#31532;&#19968;&#27425;&#65292;&#24930;</span>
<span style="color: #8b2252;"># &#28165;&#31354;&#32531;&#23384;</span>
<span style="color: #8b2252;">M-x eval-expression (setq company-mytags-cache nil)</span>
<span style="color: #8b2252;">&#25991;&#20214;&#20013;&#36755;&#20837;&#20219;&#24847;&#20989;&#25968;&#21517;&#21069;&#32512;</span>
<span style="color: #8b2252;">#&#39564;&#35777;2-&#20462;&#25913; TAGS &#25991;&#20214;&#65292;&#22686;&#21152;&#20123;&#20989;&#25968;</span>
<span style="color: #8b2252;">&#25991;&#20214;&#20013;&#36755;&#20837;&#20219;&#24847;&#20989;&#25968;&#21517;&#21069;&#32512;</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org71f679a" class="outline-3">
<h3 id="org71f679a">代码导航插件my-codenav原型</h3>
<div class="outline-text-3" id="text-org71f679a">
<p>
支持所有流行编程语言。
</p>

<p>
创建代码导航目录code navigation
</p>
<div class="org-src-container">
<pre class="src src-sh">mkdir ~/projs/my-codenav
</pre>
</div>

<p>
创建一些js代码
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt; cat bye.js
<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">bye1</span>() {
}

<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">bye2</span>() {
}

&gt; cat hello.js
<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">hello1</span>() {
}

<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">hello2</span>() {
}%
</pre>
</div>

<p>
ctags命令生效关键词
</p>
<div class="org-src-container">
<pre class="src src-sh">ctags -e -R *.js
</pre>
</div>


<p>
创建lisp代码文件
</p>
<div class="org-src-container">
<pre class="src src-sh">emacs -nw my-codenav.el
</pre>
</div>
</div>
<div id="outline-container-orgc4c2125" class="outline-4">
<h4 id="orgc4c2125">相对目录</h4>
<div class="outline-text-4" id="text-orgc4c2125">
<ul class="org-ul">
<li>default-directory：is a buffer-local variable defined in C source code. 每一个 buffer 都有这个变量，当前绑定的目录。
<ul class="org-ul">
<li>相对路径：./abc/def 相对路径对于任何系统都适用</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-codenav</span> ()
  <span style="color: #8b2252;">"My code navigation tool."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">"TAGS"</span>))
         (tags-file (concat root-dir <span style="color: #8b2252;">"TAGS"</span>))
         (default-directory root-dir))
    (message <span style="color: #8b2252;">"my-codenav called. TAGS path=%s default-directory=%s"</span> tags-file default-directory)))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">M-x eval-buffer</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">M-x my-codenav &#36755;&#20986;&#65306;my-codenav called. TAGS path=~/projs/my-codenav/TAGS default-directory=~/projs/my-codenav/</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org53d97e2" class="outline-4">
<h4 id="org53d97e2">算法</h4>
<div class="outline-text-4" id="text-org53d97e2">
<ul class="org-ul">
<li>算法：从TAGS文件开头向搜索，搜到关键函数，如bye1，找到行号再找到对应的文件。</li>
<li>找到TAGS中函数所在的文件名，(etags-file-of-tag t)</li>
<li>当要调用一个函数时要在 temp 里操作，with-temp-buffer</li>
<li>当前buffer搜索 (search-forward "xx")</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-codenav</span> ()
  <span style="color: #8b2252;">"My code navigation tool."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">"TAGS"</span>))
         (tags-file (concat root-dir <span style="color: #8b2252;">"TAGS"</span>))
         all-content
         (default-directory root-dir))

    (<span style="color: #a020f0;">setq</span> all-content (<span style="color: #a020f0;">with-temp-buffer</span>
                        (insert-file-contents tags-file)
                        (buffer-string)))
    (<span style="color: #a020f0;">with-temp-buffer</span>
      (insert all-content)
      (goto-char (point-min))
      (search-forward <span style="color: #8b2252;">"bye1"</span>)
      (message <span style="color: #8b2252;">"file=%s"</span> (etags-file-of-tag t)))
    ))
</pre>
</div>

<p>
验证
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#22810;&#24320;&#23481;&#22120;&#25171;&#24320; bye.js&#25991;&#20214;&#65292;M-x my-codenav</span>
</pre>
</div>

<ul class="org-ul">
<li>显示光标所在符号的名称 (thing-at-point 'symbol)</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-codenav</span> ()
  <span style="color: #8b2252;">"My code navigation tool."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">"TAGS"</span>))
         (tags-file (concat root-dir <span style="color: #8b2252;">"TAGS"</span>))
         (symbol (thing-at-point 'symbol))
         all-content
         cur-line
         (regex <span style="color: #8b2252;">"^</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\177</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\001</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">,[0-9]+$"</span>)
         (default-directory root-dir))

    (<span style="color: #a020f0;">setq</span> all-content (<span style="color: #a020f0;">with-temp-buffer</span>
                        (insert-file-contents tags-file)
                        (buffer-string)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> symbol
               (not (string= symbol <span style="color: #8b2252;">""</span>)))
      (<span style="color: #a020f0;">with-temp-buffer</span>
        (insert all-content)
        (goto-char (point-min))
        (search-forward symbol)
        (<span style="color: #a020f0;">setq</span> cur-line (buffer-substring (line-beginning-position) (line-end-position)))
        (<span style="color: #a020f0;">when</span> (string-match regex cur-line)
          (<span style="color: #a020f0;">let*</span> ((code-line (match-string 1 cur-line))
                 (code-num (match-string 3 cur-line))
                 (file (etags-file-of-tag t)))
            (message <span style="color: #8b2252;">"code-line=%s"</span> code-line)
            (message <span style="color: #8b2252;">"code-num=%s"</span> code-num)
            (message <span style="color: #8b2252;">"file=%s"</span> file)
            ))
        <span style="color: #b22222;">;;</span><span style="color: #b22222;">(message "file=%s" (etags-file-of-tag t))</span>
        )
      )))
</pre>
</div>

<ul class="org-ul">
<li>处理多文件同名函数问题</li>
<li>使用正则匹配定位每行的函数关键词，而不是用 search-forward 搜索，因为一行里包含2个同名词
<ul class="org-ul">
<li><code>(search-forward-regexp (concat "\177" symbol "\001") (point-max) t)</code></li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-codenav</span> ()
  <span style="color: #8b2252;">"My code navigation tool."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">"TAGS"</span>))
         (tags-file (concat root-dir <span style="color: #8b2252;">"TAGS"</span>))
         (symbol (thing-at-point 'symbol))
         candidates <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#31561;&#20215;&#20110;nil '()</span>
         all-content
         cur-line
         (regex <span style="color: #8b2252;">"^</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\177</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\001</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">,[0-9]+$"</span>)
         (default-directory root-dir))

    (<span style="color: #a020f0;">setq</span> all-content (<span style="color: #a020f0;">with-temp-buffer</span>
                        (insert-file-contents tags-file)
                        (buffer-string)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> symbol
               (not (string= symbol <span style="color: #8b2252;">""</span>)))
      (<span style="color: #a020f0;">with-temp-buffer</span>
        (insert all-content)
        (goto-char (point-min))
        (<span style="color: #a020f0;">while</span> (search-forward-regexp (concat <span style="color: #8b2252;">"\177"</span> symbol <span style="color: #8b2252;">"\001"</span>) (point-max) t)
          (<span style="color: #a020f0;">setq</span> cur-line (buffer-substring (line-beginning-position) (line-end-position)))
          (<span style="color: #a020f0;">when</span> (string-match regex cur-line)
            (<span style="color: #a020f0;">let*</span> ((code-line (match-string 1 cur-line))
                   (code-num (string-to-number (match-string 3 cur-line)))
                   (file (etags-file-of-tag t)))
              (<span style="color: #a020f0;">push</span> (list code-line code-num file) candidates)))
         (forward-line)))
      (message <span style="color: #8b2252;">"candidates=%s"</span> candidates))))
</pre>
</div>

<ul class="org-ul">
<li>引用查找文件部分代码</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>)
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-codenav</span> ()
  <span style="color: #8b2252;">"My code navigation tool."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">"TAGS"</span>))
         (tags-file (concat root-dir <span style="color: #8b2252;">"TAGS"</span>))
         (symbol (thing-at-point 'symbol))
         candidates <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#31561;&#20215;&#20110;nil '()</span>
         all-content
         cur-line
         selected
         (regex <span style="color: #8b2252;">"^</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\177</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\001</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">,[0-9]+$"</span>)
         (default-directory root-dir))
    (<span style="color: #a020f0;">setq</span> all-content (<span style="color: #a020f0;">with-temp-buffer</span>
                        (insert-file-contents tags-file)
                        (buffer-string)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> symbol (not (string= symbol <span style="color: #8b2252;">""</span>)))
      (<span style="color: #a020f0;">with-temp-buffer</span>
        (insert all-content)
        (goto-char (point-min))
        (<span style="color: #a020f0;">while</span> (search-forward-regexp (concat <span style="color: #8b2252;">"\177"</span> symbol <span style="color: #8b2252;">"\001"</span>) (point-max) t)
          (<span style="color: #a020f0;">setq</span> cur-line (buffer-substring (line-beginning-position) (line-end-position)))
          (<span style="color: #a020f0;">when</span> (string-match regex cur-line)
            (<span style="color: #a020f0;">let*</span> ((code-line (match-string 1 cur-line))
                   (line-num (match-string 3 cur-line))
                   (file (etags-file-of-tag t))
                   one-candidate)
              (<span style="color: #a020f0;">setq</span> one-candidate (format <span style="color: #8b2252;">"%s:%s:%s"</span> file line-num code-line))
              (<span style="color: #a020f0;">push</span> one-candidate candidates)))
          (forward-line)))
      (message <span style="color: #8b2252;">"candidates=%s"</span> candidates)
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> candidates (<span style="color: #a020f0;">setq</span> selected (ivy-read <span style="color: #8b2252;">"Naviget to: "</span> candidates)))
        (<span style="color: #a020f0;">when</span> (string-match <span style="color: #8b2252;">"^</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">:]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:.*"</span> selected)
          (<span style="color: #a020f0;">let*</span> ((file (match-string 1 selected))
                 (line-num (match-string 2 selected)))
            (message <span style="color: #8b2252;">"file=%s line=%s"</span> file line-num)
            (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> file (file-exists-p file))
              (find-file file)
              (goto-char (point-min))
              (forward-line (1- (string-to-number line-num))))))))))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf3a2f80" class="outline-3">
<h3 id="orgf3a2f80">改善my-codenav用户体验</h3>
<div class="outline-text-3" id="text-orgf3a2f80">
<ul class="org-ul">
<li>支持跳回
<ul class="org-ul">
<li>官方代码导航插件：(require 'xref)</li>
<li>标记：(xref-push-marker-stack (point-marker))</li>
<li>跳回: pop-tag-mark  C-t</li>
<li>跳回后闪烁: (xref-pulse-momentarily)</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ivy</span>)
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">xref</span>)
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-codenav</span> ()
  <span style="color: #8b2252;">"My code navigation tool."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> ((root-dir (locate-dominating-file default-directory <span style="color: #8b2252;">"TAGS"</span>))
         (tags-file (concat root-dir <span style="color: #8b2252;">"TAGS"</span>))
         (symbol (thing-at-point 'symbol))
         candidates <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#31561;&#20215;&#20110;nil '()</span>
         all-content
         cur-line
         selected
         (regex <span style="color: #8b2252;">"^</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\177</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\177\001]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\001</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">,[0-9]+$"</span>)
         (default-directory root-dir))
    (<span style="color: #a020f0;">setq</span> all-content (<span style="color: #a020f0;">with-temp-buffer</span>
                        (insert-file-contents tags-file)
                        (buffer-string)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> symbol (not (string= symbol <span style="color: #8b2252;">""</span>)))
      (<span style="color: #a020f0;">with-temp-buffer</span>
        (insert all-content)
        (goto-char (point-min))
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">push all matches into candidates</span>
        (<span style="color: #a020f0;">while</span> (search-forward-regexp (concat <span style="color: #8b2252;">"\177"</span> symbol <span style="color: #8b2252;">"\001"</span>) (point-max) t)
          (<span style="color: #a020f0;">setq</span> cur-line (buffer-substring (line-beginning-position) (line-end-position)))
          (<span style="color: #a020f0;">when</span> (string-match regex cur-line)
            (<span style="color: #a020f0;">let*</span> ((code-line (match-string 1 cur-line))
                   (line-num (match-string 3 cur-line))
                   (file (etags-file-of-tag t)))
              (<span style="color: #a020f0;">push</span> (format <span style="color: #8b2252;">"%s:%s:%s"</span> file line-num code-line) candidates)))
          (forward-line)))
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> candidates (<span style="color: #a020f0;">setq</span> selected (ivy-read <span style="color: #8b2252;">"Naviget to: "</span> candidates)))
        (<span style="color: #a020f0;">when</span> (string-match <span style="color: #8b2252;">"^</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">:]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:.*"</span> selected)
          (<span style="color: #a020f0;">let*</span> ((file (match-string 1 selected))
                 (line-num (match-string 2 selected)))
            (message <span style="color: #8b2252;">"file=%s line=%s"</span> file line-num)
            (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> file (file-exists-p file))
              (xref-push-marker-stack (point-marker))
              (find-file file)
              (goto-char (point-min))
              (forward-line (1- (string-to-number line-num)))
              (xref-pulse-momentarily))))))))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf8d0276" class="outline-3">
<h3 id="orgf8d0276">打造语法检查器my-syntax-check</h3>
<div class="outline-text-3" id="text-orgf8d0276">
<p>
创建代码目录
</p>
<div class="org-src-container">
<pre class="src src-sh">mkdir ~/projs/my-syntax-check
</pre>
</div>


<p>
emacs 选项
</p>
<div class="org-src-container">
<pre class="src src-sh">-l --load &#36733;&#20837;&#25991;&#20214;
-batch &#19981;&#20132;&#20114;&#24335;&#26174;&#31034;&#65292;&#30452;&#25509;&#36755;&#20986;&#21040;&#25511;&#21046;&#21488;
-Q &#24555;&#36895;&#36755;&#20986;
</pre>
</div>


<p>
范例: 检查每一行不能有多余空格
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">hello.txt</span>
hello world.
hello world.
hello world.
hello world.
hello world.
<span style="color: #a020f0;">bye</span> world.
<span style="color: #a020f0;">bye</span> world.
</pre>
</div>


<div class="org-src-container">
<pre class="src src-sh">&gt; cat my-syntax-checker.el
(message <span style="color: #8b2252;">"hello world"</span>)
&gt; e -Q -batch -l my-syntax-checker.el
hello world
</pre>
</div>

<ul class="org-ul">
<li>变量comand-line-args-left，存储命令参数</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">&gt; cat my-syntax-checker.el
(message <span style="color: #8b2252;">"hello world"</span>)
(message <span style="color: #8b2252;">"command-line-args-left=%s"</span> command-line-args-left)


&gt; emacs -Q -batch -l my-syntax-checker.el hello.txt
hello world
command-line-args-left=(hello.txt)
my-syntax-checker:hello.txt:3:space at the end of line
my-syntax-checker:hello.txt:6:space at the end of line
</pre>
</div>

<ul class="org-ul">
<li>读入文件，再一行一行读出文件内容</li>
<li>检查每行尾有空格时就报错，匹配行尾空格`" +$"`</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">
(<span style="color: #483d8b;">let</span>* ((file (nth 0 command-line-args-left))
       (i 0)
       lines
       all-content)
(when (file-exists-p file)
  (setq all-content (with-temp-buffer
                      (insert-file-contents file)
                      (buffer-string)))
  (setq lines (split-string all-content <span style="color: #8b2252;">"\n"</span>))
  (<span style="color: #a020f0;">while</span> (&lt; i (length lines))
    (when (string-match <span style="color: #8b2252;">" +$"</span> (nth i lines))
      (message <span style="color: #8b2252;">"my-syntax-checker:%s:%s:space at the end of line"</span>
               file
               (1+ i)))
    (setq i (1+ i)))))


&gt; emacs -Q -batch -l my-syntax-checker.el hello.txt
my-syntax-checker:hello.txt:3:space at the end of line
my-syntax-checker:hello.txt:6:space at the end of line
</pre>
</div>

<ul class="org-ul">
<li>`~/.custom.el`添加 `(setq lazyflymake-update-interval 999999)` 用原始的flymake</li>
</ul>


<p>
my-flymake-txt.el中设置flymake
</p>
<ul class="org-ul">
<li>定义init函数</li>
<li>变量buffer-file-name 当前buffer的文件路径</li>
<li>新正则表达式语法  <code>"\\.txt$"</code>  老的 <code>"\\.txt\\'"</code></li>
<li>将"-Q -batch -l my-syntax-checker.el hello.txt" 推送到变量 flymake-allowed-file-name-masks中</li>
<li>抓到的输出信息追加到变量 flymake-err-line-patterns中，第一个是文件名，第二个是行号，第3个类号，第4个</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (list <span style="color: #8b2252;">"emacs"</span>
        (list <span style="color: #8b2252;">"-Q"</span>
              <span style="color: #8b2252;">"-batch"</span>
              <span style="color: #8b2252;">"-l"</span>
              <span style="color: #8b2252;">"/Users/7tq6lr/projs/my-syntax-check/my-syntax-checker.el"</span>
              buffer-file-name)))
(<span style="color: #a020f0;">push</span> (list <span style="color: #8b2252;">"\\.txt$"</span> 'my-flymake-txt-init) flymake-allowed-file-name-masks)
<span style="color: #b22222;">;;</span><span style="color: #b22222;">my-syntax-checker:hello.txt:3:space at the end of line</span>
(<span style="color: #a020f0;">push</span> (list <span style="color: #8b2252;">"^my-syntax-checker:</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">:]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[0-9]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">:</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">$"</span> 1 2 nil 3)
      flymake-err-line-patterns)
</pre>
</div>
<p>
M-x eval-buffer 加载代码，在新窗口中打开hello.txt文件，开启flymake-mode，可以看到自动检查出语法问题了
</p>
</div>
</div>
<div id="outline-container-orgb575776" class="outline-3">
<h3 id="orgb575776">打造单词拼写检查器my-spellcheck</h3>
<div class="outline-text-3" id="text-orgb575776">
<p>
emacs 自带一个flyspell-mode拼写检查插件，这里会用它的一些api打造一个自己的拼写检查插件，可以检查字符串的拼写、注释的拼写、函数拼写
</p>

<ul class="org-ul">
<li>关闭作者的无错插件，在 <code>~/.custom.el</code> 添加 (setq wucuo-update-interval 999999)</li>
<li>GNU Aspell 拼写检查工具默认支持驼峰变量命名 <a href="http://aspell.net/">http://aspell.net/</a></li>
</ul>

<p>
ubuntu上安装aspell包
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo apt install aspell aspell-en
<span style="color: #b22222;">#</span><span style="color: #b22222;">mac</span>
brew install aspell
</pre>
</div>

<p>
aspell使用
</p>
<div class="org-src-container">
<pre class="src src-sh">/Users/7tq6lr/projs/my-syntax-check [7tq6lr@7tq6lrdeMacBook-Air] [6:40]
&gt; echo <span style="color: #8b2252;">"hello world"</span> | aspell pipe --lang en
@(#) International Ispell Version 3.1.20 (but really Aspell 0.60.8)
*
*


/Users/7tq6lr/projs/my-syntax-check [7tq6lr@7tq6lrdeMacBook-Air] [6:41]
&gt; echo <span style="color: #8b2252;">"helle world"</span> | aspell pipe --lang en
@(#) International Ispell Version 3.1.20 (but really Aspell 0.60.8)
&amp; helle 29 0: Heller, hell, hello, heel, he<span style="color: #8b2252;">'ll, helve, belle, Halley, Hallie, Holley, Hollie, healer, holler, huller, Hale, Hall, Hill, Hull, hale, hall, heal, hill, hole, hull, Holly, Hoyle, hilly, holly, hell'</span>s
*

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25903;&#25345;&#39548;&#23792;&#25340;&#20889;&#26816;&#26597;&#65292;0.60.8&#29256;&#26412; &#23436;&#25104;&#25903;&#25345;</span>
&gt; echo <span style="color: #8b2252;">"helloWorld"</span> | aspell pipe --lang en --run-together
@(#) International Ispell Version 3.1.20 (but really Aspell 0.60.8)
-
</pre>
</div>

<p>
创建代码文件
</p>
<div class="org-src-container">
<pre class="src src-sh">mkdir -p  ~/projs/my-spellcheck
<span style="color: #483d8b;">cd</span> ~/projs/my-spellcheck
touch my-spellcheck.el
cat my-spellcheck.el
(defun my-spell-check-start ()
  (interactive)
  (message <span style="color: #8b2252;">"hello world"</span>))



cat hello.js
<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">hello</span>() {
  console.log(<span style="color: #8b2252;">'hello,world'</span>);
  console.log(<span style="color: #8b2252;">'hell,world'</span>);
}
</pre>
</div>

<ul class="org-ul">
<li>flyspell-buffeer 扫描当前buffer</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">flyspell</span>)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">use `</span><span style="color: #008b8b;">flyspell-buffer</span><span style="color: #b22222;">'</span>
(<span style="color: #a020f0;">setq</span> ispell-program-name <span style="color: #8b2252;">"aspell"</span>)
(<span style="color: #a020f0;">setq</span> ispell-extra-args '(<span style="color: #8b2252;">"--lang=en"</span> <span style="color: #8b2252;">"--run-together"</span>))
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-spell-check-start</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (flyspell-buffer))
</pre>
</div>
<p>
M-x eval-buffer
M-x my-spell-check-start 可以看到 hello.js中有找到错误单词高亮
</p>


<ul class="org-ul">
<li>flyspell-generic-check-word-predicate 用户自定义变量</li>
<li>保存文件时自动检查
<ul class="org-ul">
<li>(add-hook 'after-save-hook 'my-spell-check-start nil t)</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">flyspell</span>)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">use `</span><span style="color: #008b8b;">flyspell-buffer</span><span style="color: #b22222;">'</span>
(<span style="color: #a020f0;">setq</span> ispell-program-name <span style="color: #8b2252;">"aspell"</span>)
(<span style="color: #a020f0;">setq</span> ispell-extra-args '(<span style="color: #8b2252;">"--lang=en"</span> <span style="color: #8b2252;">"--run-together"</span>))
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-predicate</span> ()
  (<span style="color: #a020f0;">let*</span> ((pos (1- (point)))
         (font-face-at-point (get-text-property pos 'face)))
    (memq font-face-at-point '(font-lock-string-face
                               font-lock-comment-face
                               font-lock-function-name-face
                               font-lock-variable-name-face))
    ))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-spell-check-start</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">setq</span> flyspell-generic-check-word-predicate 'my-predicate)
  (flyspell-buffer))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'after-save-hook 'my-spell-check-start nil t)</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-mode-hook-setup</span> ()
  (add-hook 'after-save-hook 'my-spell-check-start nil t))
(add-hook 'js2-mode-hook 'my--mode-hook-setup)
</pre>
</div>
</div>
</div>
<div id="outline-container-org69dc4ef" class="outline-3">
<h3 id="org69dc4ef">优化my-spellcheck性能</h3>
<div class="outline-text-3" id="text-org69dc4ef">
<p>
大项目中的优化
</p>

<ul class="org-ul">
<li>修改flyspell-buffer中代码，(flyspell-region (point-min) (point-max))
<ul class="org-ul">
<li>缩小检查区域
<ul class="org-ul">
<li>当前控制焦点是 (point)</li>
<li>可见窗口的高度，即打开的buffer窗口肉眼能看到的高度(window-body-height)</li>
<li>保留当前的焦点，并可执行一下代码，执行结束后回退到原焦点 save-excursion</li>
<li>begin 回退一个容器高度，取行首</li>
<li>end  向下</li>
</ul></li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">flyspell</span>)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">use `</span><span style="color: #008b8b;">flyspell-buffer</span><span style="color: #b22222;">'</span>
(<span style="color: #a020f0;">setq</span> ispell-program-name <span style="color: #8b2252;">"aspell"</span>)
(<span style="color: #a020f0;">setq</span> ispell-extra-args '(<span style="color: #8b2252;">"--lang=en"</span> <span style="color: #8b2252;">"--run-together"</span>))
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-predicate</span> ()
  (<span style="color: #a020f0;">let*</span> ((pos (1- (point)))
         (font-face-at-point (get-text-property pos 'face)))
    <span style="color: #b22222;">;;; </span><span style="color: #b22222;">...skip some logic .....</span>
    (memq font-face-at-point '(font-lock-string-face
                               font-lock-comment-face
                               font-lock-variable-name-face
                               font-lock-function-name-face))))
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-spell-check-start</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let*</span> (begin end (height (window-body-height)))
    (message <span style="color: #8b2252;">"my-spell-check-start called"</span>)
    (<span style="color: #a020f0;">setq</span> flyspell-generic-check-word-predicate 'my-predicate)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(point)</span>
    (<span style="color: #a020f0;">save-excursion</span>
      (forward-line (- height))
      (<span style="color: #a020f0;">setq</span> begin (line-beginning-position)))
    (<span style="color: #a020f0;">save-excursion</span>
      (forward-line height)
      (<span style="color: #a020f0;">setq</span> end (line-end-position)))
    (flyspell-region begin end)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'after-save-hook 'my-spell-check-start nil t)</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-mode-hook-setup</span> ()
  (add-hook 'after-save-hook 'my-spell-check-start nil t))
(add-hook 'js2-mode-hook 'my-mode-hook-setup)
</pre>
</div>
</div>
</div>
<div id="outline-container-org84fde14" class="outline-3">
<h3 id="org84fde14">文本操作神器text object</h3>
<div class="outline-text-3" id="text-org84fde14">
<p>
text object文本对象，vim文本也有对象概念，比如一个单词、句子、段落、tag、块(如括号、方括号、引号)，通过操作文本对象来修改比只操作单个字符高效。
</p>
<div class="org-src-container">
<pre class="src src-sh">[number]&lt;operator&gt;[text object or motion]
&lt;&#25968;&#23383;&gt; &lt;&#25805;&#20316;&#31526;&gt; &lt;&#25991;&#26412;&#23545;&#35937;&#25110;&#31227;&#21160;&#21629;&#20196;&gt;
</pre>
</div>

<p>
emacs中可以自己定义 text object
</p>

<div class="org-src-container">
<pre class="src src-sh">mkdir -p ~/projs/my-evil-textobj
<span style="color: #483d8b;">cd</span> ~/projs/my-evil-textobj
touch my-evil-textobj.el

cat hello.js
<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">bye</span>() {
}
<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">hello</span>() {
  <span style="color: #483d8b;">let</span> v1 = bye();
}
</pre>
</div>

<ul class="org-ul">
<li>利用 evil-define-text-object 宏定义中的函数</li>
</ul>
<p>
原始代码：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">evil</span>)

(evil-define-text-object evil-a-word (count <span style="color: #228b22;">&amp;optional</span> beg end type)
  <span style="color: #8b2252;">"Select a word."</span>
  (evil-select-a-restricted-object 'evil-word beg end type count))

(evil-define-text-object evil-inner-word (count <span style="color: #228b22;">&amp;optional</span> beg end type)
  <span style="color: #8b2252;">"Select inner word."</span>
  (evil-select-inner-restricted-object 'evil-word beg end type count))
(define-key evil-outer-text-objects-map <span style="color: #8b2252;">"w"</span> 'evil-a-word)
(define-key evil-inner-text-objects-map <span style="color: #8b2252;">"w"</span> 'evil-inner-word)
<span style="color: #b22222;">;;</span><span style="color: #b22222;">press `</span><span style="color: #008b8b;">viw</span><span style="color: #b22222;">'evil-inner-word  `</span><span style="color: #008b8b;">vaw</span><span style="color: #b22222;">' evil-a-word</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">"word" vi" va"</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(word) vi( va(</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">i &#19981;&#21253;&#25324;&#36793;&#30028;&#65292;a &#21253;&#25324;&#36793;&#30028;</span>
</pre>
</div>


<ul class="org-ul">
<li>验证输出</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">evil</span>)

(evil-define-text-object my-evil-a-textobj (count <span style="color: #228b22;">&amp;optional</span> beg end type)
  <span style="color: #8b2252;">"Select a word."</span>
  (<span style="color: #a020f0;">let*</span> ((rlt (evil-select-a-restricted-object 'evil-word beg end type count)))
    (message <span style="color: #8b2252;">"rlt=%s"</span> rlt)
    (<span style="color: #a020f0;">setq</span> rlt '(28 34))
    rlt))

(evil-define-text-object my-evil-inner-textobj (count <span style="color: #228b22;">&amp;optional</span> beg end type)
  <span style="color: #8b2252;">"Select inner word."</span>
  (evil-select-inner-restricted-object 'evil-word beg end type count))
(define-key evil-outer-text-objects-map <span style="color: #8b2252;">"t"</span> 'my-evil-a-textobj)
(define-key evil-inner-text-objects-map <span style="color: #8b2252;">"t"</span> 'my-evil-inner-textobj)
<span style="color: #b22222;">;;</span><span style="color: #b22222;">press `</span><span style="color: #008b8b;">viw</span><span style="color: #b22222;">'evil-inner-word  `</span><span style="color: #008b8b;">vaw</span><span style="color: #b22222;">' evil-a-word</span>
</pre>
</div>
<p>
在hello.js中使用 vat 查看自定义的列表 28 34 一样可以使用。
</p>
</div>
<div id="outline-container-org2039c87" class="outline-4">
<h4 id="org2039c87">text object 改造</h4>
<div class="outline-text-4" id="text-org2039c87">
<ul class="org-ul">
<li>选中一行
<ul class="org-ul">
<li><code>(list (line-beginning-position) (line-end-position))</code></li>
</ul></li>
<li>开头去掉空格和TAB
<ul class="org-ul">
<li>asscii 32 9</li>
<li>当前字符是什么 <code>(following-char)</code></li>
<li>光标移动到下一个字符 <code>(forward-char)</code></li>
</ul></li>
<li>不包含边界
<ul class="org-ul">
<li>找到 = 等号 asscii 61</li>
<li>跳过 = 等号 和 ; 分号</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">evil</span> nil t)
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-skip-white-space</span> (start step)
  <span style="color: #8b2252;">"Skip white spaces from START, return position of first non-space character.</span>
<span style="color: #8b2252;">If STEP is 1,  search in forward direction, or else in backward direction."</span>
  (<span style="color: #a020f0;">let*</span> ((b start)
         (e (<span style="color: #a020f0;">if</span> (&gt; step 0) (line-end-position) (line-beginning-position))))
    (<span style="color: #a020f0;">save-excursion</span>
      (goto-char b)
      (<span style="color: #a020f0;">while</span> (<span style="color: #a020f0;">and</span> (not (eq b e)) (memq (following-char) '(9 32)))
        (forward-char step))
      (point))))

(evil-define-text-object my-evil-a-textobj (count <span style="color: #228b22;">&amp;optional</span> beg end type)
  <span style="color: #8b2252;">"Select a statement."</span>
  (list (my-skip-white-space (line-beginning-position) 1)
        (line-end-position)))

(evil-define-text-object my-evil-inner-textobj (count <span style="color: #228b22;">&amp;optional</span> beg end type)
  <span style="color: #8b2252;">"Select inner statement."</span>
  (<span style="color: #a020f0;">let*</span> ((b (my-skip-white-space (line-beginning-position) 1))
         (e (line-end-position)))
    (list (<span style="color: #a020f0;">save-excursion</span>
            (goto-char b)
            (<span style="color: #a020f0;">while</span> (<span style="color: #a020f0;">and</span> (&lt; (point) e) (not (eq (following-char) 61)))
              (message <span style="color: #8b2252;">"(following-char)=%s"</span> (char-to-string (following-char)))
              (forward-char))
            (<span style="color: #a020f0;">cond</span>
             ((eq (point) e)
              b)
             (t
              <span style="color: #b22222;">;; </span><span style="color: #b22222;">skip '</span><span style="color: #008b8b;">=</span><span style="color: #b22222;">' at point</span>
              (goto-char (my-skip-white-space (1+ (point)) 1))
              (point))))
          (<span style="color: #a020f0;">cond</span>
           ((eq (char-before e) 59) <span style="color: #b22222;">; </span><span style="color: #b22222;">";"</span>
            (my-skip-white-space (1- e) -1))
           (t
            e)))))

(define-key evil-outer-text-objects-map <span style="color: #8b2252;">"t"</span> #'my-evil-a-textobj)
(define-key evil-inner-text-objects-map <span style="color: #8b2252;">"t"</span> #'my-evil-inner-textobj)
</pre>
</div>
<p>
在hello.js中使用 vat 和 vit 看看效果
</p>
</div>
</div>
</div>
<div id="outline-container-orgfdffa9a" class="outline-3">
<h3 id="orgfdffa9a">定义通用的字符串text object</h3>
<div class="outline-text-3" id="text-orgfdffa9a">
<p>
常用的 "" '' 中选择方法雷同。
</p>
</div>
</div>
<div id="outline-container-orgd07f548" class="outline-3">
<h3 id="orgd07f548">用hooks管理大项目的魔法</h3>
<div class="outline-text-3" id="text-orgd07f548">
<p>
官方文档：<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Hooks.html">https://www.gnu.org/software/emacs/manual/html_node/emacs/Hooks.html</a>
</p>

<p>
可以包含一系列函数。一般是用户自己定义的函数。
</p>

<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(message <span style="color: #8b2252;">"hello world"</span>)
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">after-save-hook-setup</span> ()
  (message <span style="color: #8b2252;">"buffer-file-name=%s"</span> buffer-file-name)
  (message <span style="color: #8b2252;">"after-save-hook-setup called"</span>))
<span style="color: #b22222;">;;</span><span style="color: #b22222;">aafafalj</span>
(add-hook 'after-save-hook 'after-save-hook-setup)
</pre>
</div>
<p>
M-x save-buffer 可看到对应输出
</p>
</div>
<div id="outline-container-org81bef84" class="outline-4">
<h4 id="org81bef84">major-mode-hook</h4>
<div class="outline-text-4" id="text-org81bef84">
<p>
在主模式 major-mode 下用的hook
</p>

<p>
有
</p>
<ul class="org-ul">
<li>js2</li>
<li>&#x2026;..</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">js2-mode-hook-setup</span> ()
  (message <span style="color: #8b2252;">"js2-mode-hook-setup is called"</span>))
(add-hook 'js2-mode-hook 'js2-mode-hook-setup)
</pre>
</div>
<p>
打开一个js文件看看输出
</p>
</div>
<div id="outline-container-orgc77d20c" class="outline-5">
<h5 id="orgc77d20c">打开多个js文件，配置不同缩进</h5>
<div class="outline-text-5" id="text-orgc77d20c">
<ul class="org-ul">
<li>变量 js-indent-level 缩进默认为2</li>
<li>setq-local 只在对应文件本地的变量</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">js2-mode-hook-setup</span> ()
  (<span style="color: #a020f0;">cond</span>
   ((string-match <span style="color: #8b2252;">"hello.js$"</span> buffer-file-name)
    (<span style="color: #a020f0;">setq-local</span> js-indent-level 4))
   ((string-match <span style="color: #8b2252;">"bye.js$"</span> buffer-file-name)
    (<span style="color: #a020f0;">setq-local</span> js-indent-level 2))))
(add-hook 'js2-mode-hook 'js2-mode-hook-setup)
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org826f595" class="outline-3">
<h3 id="org826f595">用Advice注入病毒至第三方代码中</h3>
<div class="outline-text-3" id="text-org826f595">
<p>
官方文档：<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Advising-Functions.html">https://www.gnu.org/software/emacs/manual/html_node/elisp/Advising-Functions.html</a>
</p>

<p>
改变第三方插件行为。
</p>


<p>
三种注入方式
</p>
<ul class="org-ul">
<li>after：函数执行后执行</li>
<li>around：可以在函数执行前执行，也可以在函数执行后执行</li>
<li>before</li>
</ul>

<p>
卸载注入
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(advice-remove 'my-double #'my-increase)
</pre>
</div>
</div>
<div id="outline-container-orgd05ee89" class="outline-4">
<h4 id="orgd05ee89">范例 find-file</h4>
<div class="outline-text-4" id="text-orgd05ee89">
<ul class="org-ul">
<li>(apply orig-func args) 执行动作。这里是打开文件</li>
<li>变量 kill-ring 存放剪切过的代码</li>
<li>kill-new向kill-ring中存放数据</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-find-file-hack</span> (orig-func <span style="color: #228b22;">&amp;rest</span> args)
  (<span style="color: #a020f0;">let*</span> ((file (nth 0 args)))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> file (file-exists-p file))
      (message <span style="color: #8b2252;">"file=%s"</span> file)
      (kill-new file))
    (apply orig-func args)))
(advice-add 'find-file <span style="color: #483d8b;">:around</span> #'my-find-file-hack)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org210fcb8" class="outline-3">
<h3 id="org210fcb8">参考</h3>
</div>
</section>
</div>
<div id="postamble" class="status">
    <div class=bar data-astro-cid-p3givckg>
        <div class=list data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:gnuemacs height=1em viewBox="0 0 24 24" width=1em>
                    <title>emacs</title>
                    <symbol id=ai:simple-icons:gnuemacs>
                        <path d="M12 24C5.448 24 .118 18.617.118 12S5.448 0 12 0s11.882 5.383 11.882 12S18.552 24 12 24zM12 .661C5.813.661.779 5.748.779 12S5.813 23.339 12 23.339S23.221 18.253 23.221 12S18.187.661 12 .661zM8.03 20.197s.978.069 2.236-.042c.51-.045 2.444-.235 3.891-.552c0 0 1.764-.377 2.707-.725c.987-.364 1.524-.673 1.766-1.11c-.011-.09.074-.408-.381-.599c-1.164-.488-2.514-.4-5.185-.457c-2.962-.102-3.948-.598-4.472-.997c-.503-.405-.25-1.526 1.907-2.513c1.086-.526 5.345-1.496 5.345-1.496c-1.434-.709-4.109-1.955-4.659-2.224c-.482-.236-1.254-.591-1.421-1.021c-.19-.413.448-.768.804-.87c1.147-.331 2.766-.536 4.24-.56c.741-.012.861-.059.861-.059c1.022-.17 1.695-.869 1.414-1.976c-.252-1.13-1.579-1.795-2.84-1.565c-1.188.217-4.05 1.048-4.05 1.048c3.539-.031 4.131.028 4.395.398c.156.218-.071.518-1.015.672c-1.027.168-3.163.37-3.163.37c-2.049.122-3.492.13-3.925 1.046c-.283.599.302 1.129.558 1.46c1.082 1.204 2.646 1.853 3.652 2.331c.379.18 1.49.52 1.49.52c-3.265-.18-5.619.823-7.001 1.977c-1.562 1.445-.871 3.168 2.33 4.228c1.891.626 2.828.921 5.648.667c1.661-.09 1.923-.036 1.939.1c.023.192-1.845.669-2.355.816c-1.298.374-4.699 1.129-4.716 1.133z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:gnuemacs></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Emacs</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:org height=1em viewBox="0 0 24 24" width=1em>
                    <title>org-mode</title>
                    <symbol id=ai:simple-icons:org>
                        <path d="M17.169 0c-.566.004-2.16 3.312-3.376 5.94a2.19 2.19 0 0 1-.408-1.267c-.03-.582-1.089.237-.936 1.275c-.068-.035-1.26.227-1.26.23c-.23-.93-.802-1.618-1.15-.563c-.701 1.663-.88 2.984.115 4.585c-.908 4.058-6.948 6.053-6.32 9.33c.175.004 1.634 3.48 6.337 2.057c5.557-1.577 8.624 2.116 8.978 2.375c.52.526-1.348-4.573-5.302-6.865c-2.339-1.276-.87-3.474-.703-4.25c0 0 1.874 1.312 3.232-.692c1.227.316 2.05-.224 3.105.158c.64.28 3.336.11 2.334-1.396c-.148.129.07.27-.075.46c-.043.056-.128.232-.408.315c-.314.149-.83.27-1.43-.37c-.434-.32-.748-.04-.992-.063c.152-.098.577-.315 1.264-.315c.388 0 .594.336.854.338c.174 0 .685-.262.787-.365c.63-.41.697-.278 1.012-.905c.17-.759-.215-.92-.332-1.129c-.032-.483-.436-.67-.919-.326c-1.106-.198-2.192-.105-2.728-.15c-1.175-.164-2.153-.786-2.153-.786c.143-.19.075-.6-.842-.628c-.315-.104-.45-.2-.745-.307c.61-1.37.674-2.007 1.418-4.004c.261-1.053 1.039-2.685.643-2.682zm-4.297 8.093c.03-.086.443.138.952.176c.395.03.805.048 1.296-.025c.03-.005.172.095-.15.194c-.02.01-.062-.01-.065.196c0 .022-.01.04-.02.046c-.15.152-.708.223-1.065.1c-.436-.17-.482-.316-.517-.443c-.305-.147-.47-.123-.43-.244zM9.685 10.2C8.86 9 8.929 8.36 8.96 7.256C7.961 8.288 6.855 8.3 5.18 8.58c-1.299.234-3.657 2.447-4.025 4.742c-.043.608-.08 2.183.424 3.498c.492 1.13.828 1.727 1.844 2.335c-.882-3.169 5.296-5.33 6.263-8.955z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:org></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Orgmode</p>
                </div>
            </span>
            <a href=/donations.html class=entry data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:astro height=1em viewBox="0 0 24 24" width=1em>
                    <title>Donations</title>
                    <symbol id=ai:simple-icons:astro>
                        <path d="M8.358 20.162c-1.186-1.07-1.532-3.316-1.038-4.944c.856 1.026 2.043 1.352 3.272 1.535c1.897.283 3.76.177 5.522-.678c.202-.098.388-.229.608-.36c.166.473.209.95.151 1.437c-.14 1.185-.738 2.1-1.688 2.794c-.38.277-.782.525-1.175.787c-1.205.804-1.531 1.747-1.078 3.119l.044.148a3.158 3.158 0 0 1-1.407-1.188a3.31 3.31 0 0 1-.544-1.815c-.004-.32-.004-.642-.048-.958c-.106-.769-.472-1.113-1.161-1.133c-.707-.02-1.267.411-1.415 1.09c-.012.053-.028.104-.045.165h.002zm-5.961-4.445s3.24-1.575 6.49-1.575l2.451-7.565c.092-.366.36-.614.662-.614c.302 0 .57.248.662.614l2.45 7.565c3.85 0 6.491 1.575 6.491 1.575L16.088.727C15.93.285 15.663 0 15.303 0H8.697c-.36 0-.615.285-.784.727l-5.516 14.99z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:astro></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>打赏</p>
                </div>
            </span>
            </a>
            <span class=entry data-astro-cid-p3givckg>
                <svg xmlns="http://www.w3.org/2000/svg" class=heading data-astro-cid-p3givckg data-icon=simple-icons:copyright width="1em" height="1em" viewBox="0 0 24 24">
                    <title>Copyright</title>
                    <path fill="currentColor" d="M19 2a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3zm-5 5h-4a1 1 0 0 0-1 1l.007.117A1 1 0 0 0 10 9h3v5a1 1 0 0 1-1.993.117L11 14a1 1 0 0 0-2 0a3 3 0 0 0 6 0V8a1 1 0 0 0-1-1" />
                    <use xlink:href=#ai:simple-icons:copyright></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>© 2025 Jasper Hsu</p>
                </div>
            </span>
        </div>
        <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ class="list license" data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Creative Commons</title>
                    <symbol id=ai:fa6-brands:creative-commons>
                        <path d="m245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93c-22.13 0-33.22 14.61-33.22 43.84c0 23.57 9.21 43.84 33.22 43.84c14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98c-22.6 0-73.96-10.32-73.96-77.05c0-58.69 43-77.06 72.63-77.06c30.72-.01 52.7 11.95 65.99 35.86zm143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93c-22.14 0-33.22 14.61-33.22 43.84c0 23.55 9.23 43.84 33.22 43.84c14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98c-22.69 0-73.96-9.87-73.96-77.05c0-58.67 42.97-77.06 72.63-77.06c30.71-.01 52.58 11.95 65.56 35.86zM247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248c129.93 0 248.44-100.87 248.44-248c0-137.87-106.62-248-248.44-248zm.87 450.81c-112.54 0-203.7-93.04-203.7-202.81c0-105.42 85.43-203.27 203.72-203.27c112.53 0 202.82 89.46 202.82 203.26c-.01 121.69-99.68 202.82-202.84 202.82z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Creative Commons</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-by height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Attribute</title>
                    <symbol id=ai:fa6-brands:creative-commons-by>
                        <path d="M314.9 194.4v101.4h-28.3v120.5h-77.1V295.9h-28.3V194.4c0-4.4 1.6-8.2 4.6-11.3c3.1-3.1 6.9-4.7 11.3-4.7H299c4.1 0 7.8 1.6 11.1 4.7c3.1 3.2 4.8 6.9 4.8 11.3zm-101.5-63.7c0-23.3 11.5-35 34.5-35s34.5 11.7 34.5 35c0 23-11.5 34.5-34.5 34.5s-34.5-11.5-34.5-34.5zM247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256C0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8c103.2 0 202.8-81.1 202.8-202.8c.1-113.8-90.2-203.3-202.8-203.3z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-by></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Attribute</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-nc height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Noncommercial</title>
                    <symbol id=ai:fa6-brands:creative-commons-nc>
                        <path d="M247.6 8C387.4 8 496 115.9 496 256c0 147.2-118.5 248-248.4 248C113.1 504 0 393.2 0 256C0 123.1 104.7 8 247.6 8zM55.8 189.1c-7.4 20.4-11.1 42.7-11.1 66.9c0 110.9 92.1 202.4 203.7 202.4c122.4 0 177.2-101.8 178.5-104.1l-93.4-41.6c-7.7 37.1-41.2 53-68.2 55.4v38.1h-28.8V368c-27.5-.3-52.6-10.2-75.3-29.7l34.1-34.5c31.7 29.4 86.4 31.8 86.4-2.2c0-6.2-2.2-11.2-6.6-15.1c-14.2-6-1.8-.1-219.3-97.4zM248.4 52.3c-38.4 0-112.4 8.7-170.5 93l94.8 42.5c10-31.3 40.4-42.9 63.8-44.3v-38.1h28.8v38.1c22.7 1.2 43.4 8.9 62 23L295 199.7c-42.7-29.9-83.5-8-70 11.1c53.4 24.1 43.8 19.8 93 41.6l127.1 56.7c4.1-17.4 6.2-35.1 6.2-53.1c0-57-19.8-105-59.3-143.9c-39.3-39.9-87.2-59.8-143.6-59.8z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-nc></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Noncommercial</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-sa height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Share Alike</title>
                    <symbol id=ai:fa6-brands:creative-commons-sa>
                        <path d="M247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256C0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8c103.2 0 202.8-81.1 202.8-202.8c.1-113.8-90.2-203.3-202.8-203.3zM137.7 221c13-83.9 80.5-95.7 108.9-95.7c99.8 0 127.5 82.5 127.5 134.2c0 63.6-41 132.9-128.9 132.9c-38.9 0-99.1-20-109.4-97h62.5c1.5 30.1 19.6 45.2 54.5 45.2c23.3 0 58-18.2 58-82.8c0-82.5-49.1-80.6-56.7-80.6c-33.1 0-51.7 14.6-55.8 43.8h18.2l-49.2 49.2l-49-49.2h19.4z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-sa></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Share Alike</p>
                </div>
            </span>
        </a>
    </div>
<!--
<script type="text/javascript" src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/bootstrap@5.2.1/dist/js/bootstrap.min.js"></script>
<div id="back-to-top" class=""><svg viewBox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg></div>
-->
</div>
</body>
</html>
