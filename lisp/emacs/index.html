<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs: 神的编辑器 Emacs</title>
<meta name="generator" content="Org Mode" />

<link rel="stylesheet" type="text/css" href="https://xuchangwei.com/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://xuchangwei.com/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<link rel="stylesheet" type="text/css" href="https://xuchangwei.com/org-html-themes/src/readtheorg_theme/css/search.css"/>
<script type="text/javascript" src="https://xuchangwei.com/org-html-themes/src/lib/js/jquery.min.js"></script>
<script type="text/javascript" src="https://xuchangwei.com/org-html-themes/src/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://xuchangwei.com/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://xuchangwei.com/org-html-themes/src/readtheorg_theme/js/search.js"></script>
<script type="text/javascript" src="https://xuchangwei.com/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">Emacs: 神的编辑器 Emacs</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#h:47ad94b2-91f9-4f33-a8ff-9f6bb7141cb3">作为文本编辑器</a>
<ul>
<li><a href="#h:0b45f861-a71f-4982-881c-0636c01c0cad">快捷键速记</a></li>
<li><a href="#h:0c2edd01-dbc7-4c48-992f-d49d70cda097">移动 &amp; 跳转</a>
<ul>
<li><a href="#h:591f69fe-8fb8-44ac-8480-461c9e69e93c">Buffer 缓冲区</a>
<ul>
<li><a href="#h:f1c02a9b-3a7a-4dfe-bb7b-8582589e6ebf">左右移动</a></li>
<li><a href="#h:9c42fa26-8f2c-4bf1-afad-ec21b4b59f40">上下移动</a></li>
<li><a href="#h:53c17808-09fd-42b4-99a6-f8d9ef6dfb1e">跳转</a></li>
</ul>
</li>
<li><a href="#h:fc147951-6c13-4229-a622-b3b4e52ece34">Window 窗口</a></li>
<li><a href="#h:9707c29e-27b7-4fb6-aa81-dea75c457473">Frame 框架</a></li>
</ul>
</li>
<li><a href="#h:55b331ce-48ce-4cfc-9ff7-b624f4d05212">文本编辑</a>
<ul>
<li><a href="#h:bcf530e5-4eeb-4cba-97e4-0996fc689d9c">Mark 标记</a></li>
<li><a href="#h:d5fb0d7f-61f9-4008-bedb-74619ea1379d">Insert 插入</a></li>
<li><a href="#h:1938c7af-172c-4a5a-af02-980b43618c2d">删除 剪切 复制 粘贴</a></li>
<li><a href="#h:4b4fe1aa-35d3-4039-a69e-8e9c124e3ac5">Undo/Redo 撤销 重做</a></li>
<li><a href="#h:fde9b04a-5287-477e-87e4-0047169d80e7">Multiple 多重</a></li>
<li><a href="#h:5541d898-6743-4585-abcb-d997038c741d">其它</a>
<ul>
<li><a href="#h:5bd95c5e-7fdd-423b-a7ba-da315d234a66">限制每行宽度，方便折行</a></li>
<li><a href="#h:07fbd30c-a7b4-49ca-9028-a271825bc47f">align 对齐</a></li>
<li><a href="#h:00f1c65b-6bcf-4f34-9518-03a5c978e5fe">sort 排序</a></li>
<li><a href="#h:612f9b3a-00fe-41e0-9171-876d2bde7124">Narrowing缩小编辑</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:7fef27f0-cd34-4881-88dd-8b5ecc8b4a72">Search 搜索 &amp; Replace 替换</a></li>
<li><a href="#h:09132711-50b2-47e3-ae46-3e6af8715471">Repeat 重复</a></li>
<li><a href="#h:cff1a2fd-ca05-47a6-adc9-4a22b242ba77">Assist 辅助</a>
<ul>
<li><a href="#h:c6d3e953-ca54-4aee-81d1-5259d416370c">Information 信息</a></li>
<li><a href="#h:e65e48e4-eade-449e-a79e-83acf3478043">Abbrev 缩写</a></li>
<li><a href="#h:8893f083-d707-4a2e-bfb5-7d755faef26f">Register 寄存器</a></li>
<li><a href="#h:d0c6bf5a-27ff-4361-bf4e-93938e74180c">Bookmark 书签</a></li>
<li><a href="#h:f223b93c-8a74-4fd4-84e2-e68d4fa31a2d">Other 其它</a></li>
</ul>
</li>
<li><a href="#h:bc07c3b3-9361-4638-b9b5-c7b646f0382b">多文件操作</a>
<ul>
<li><a href="#h:0abc1cc9-4985-4d62-b3ba-ac1ef9fd4e67">文件与 Buffer</a>
<ul>
<li><a href="#h:2ae249b5-9f47-4856-9966-01aa1dcfb816">打开多文件</a></li>
<li><a href="#h:c015e3ce-3561-4149-acd8-f83ac5eac352">Buffer 的切换</a></li>
<li><a href="#h:cc42a9cf-e4ac-4982-9511-9fbf7417af07">文件备份</a></li>
<li><a href="#h:2116dc7f-25fc-45b8-81bd-6f8bb3a65357">文件保存</a></li>
<li><a href="#h:f9964062-e8cb-40a9-91c5-47122232a8a7">批量管理 Buffer</a></li>
<li><a href="#h:019640c4-5bd3-4e8f-93e1-3e89aef44bd4">关闭窗口</a></li>
<li><a href="#h:01f28d2a-575e-4253-8d6e-8855065d0fc0">其它</a></li>
</ul>
</li>
<li><a href="#h:dbfd2b46-8c3c-4f2d-9832-df3e414b7139">Window &amp; Frame 窗口和框架</a>
<ul>
<li><a href="#h:2530a569-f3b8-45c3-8505-a961eea5b19f">多Window</a>
<ul>
<li><a href="#h:3ff48b65-a847-4d78-8b25-113bec2e273a">划分-垂直|水平</a></li>
<li><a href="#h:172e125e-7be1-46ca-8108-0410ca018681">关闭</a></li>
<li><a href="#h:ab31201a-2a22-4793-88ae-614ccfc64ccd">切换分屏</a></li>
<li><a href="#h:a9414008-de96-4a5f-a53f-4bc37e2fbb40">打开多文件</a></li>
<li><a href="#h:5dc18fd4-21d8-4513-b195-27fe90e9e6f1">滚动</a></li>
<li><a href="#h:86301d75-fd80-49b5-877d-7d6911e6b860">调整大小</a></li>
<li><a href="#h:2bbc35d0-96eb-4764-bfd9-a40f084e756a">其它</a></li>
</ul>
</li>
<li><a href="#h:4f162147-9a37-4bfe-a0c6-48afaa3d2d1f">多Frame</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:d6597f58-35ff-4300-aba1-38679aca070e">目录（文件夹）操作</a></li>
<li><a href="#h:05fe055a-65be-4734-87bb-0c87ac2f741b">插入 tabel.el 表格</a></li>
</ul>
</li>
<li><a href="#原生 emacs">原生 Emas</a>
<ul>
<li><a href="#h:4a3be98f-297b-4bd3-9abc-18228235354f">Emacs 的主要相关资料</a></li>
<li><a href="#h:4000e4e5-df2b-4e72-af1e-ee4ad4f3904e">站在巨人肩膀上</a></li>
<li><a href="#h:6e3e5604-dc5f-49c9-8acd-d7d6ddf84703">大佬答疑</a>
<ul>
<li><a href="#h:4220e050-30e9-4fe9-98d6-adf502c5545a">创建属于自己的配置</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:34f31360-59da-42ab-9286-962f47128f04">安装</a>
<ul>
<li><a href="#h:b208cce7-bae0-468a-9080-ea0d8ba6ad60">二进制包安装</a></li>
<li><a href="#h:04da44fe-12b5-4de9-afc1-126ff7ecfc15">源码安装</a></li>
<li><a href="#h:8ece3a6c-013e-4dd8-a4e2-81cdd73670a6">启动 emacs</a>
<ul>
<li><a href="#h:2acc52d9-0fcd-48e3-bf1e-1b9e062cb39e">以服务端形式启动 emacs</a></li>
</ul>
</li>
<li><a href="#h:eac8b743-ad6d-4f05-b87a-6e7ea0fd059b">退出 Emacs</a></li>
<li><a href="#h:0aa6b359-22fa-40b7-8a7d-74688d667915">多版本emacs启动</a></li>
</ul>
</li>
<li><a href="#h:d75895f0-3e35-4c6e-ba3a-691b52a6ba07">用户界面</a></li>
<li><a href="#h:49e40af4-8439-42d9-bdd6-e9291c30d9a0">基本操作速记</a></li>
<li><a href="#h:3d891b51-d4f8-4492-9af3-165c488e332a">功能键</a>
<ul>
<li><a href="#h:bb2e9786-ff6d-4e7f-b275-81c82418b9bd">改键-Control 键改到了大小写锁定键上</a></li>
<li><a href="#h:5c99dba9-0317-4d27-bd8b-f34b8f99c124">改键-Mac-Windows统一键位</a></li>
</ul>
</li>
<li><a href="#h:e7c6d8c5-cd42-420f-9817-c0e1dc7fcf8f">Mode模式</a>
<ul>
<li><a href="#h:f606f195-b6e3-4406-b02f-393f13fd2751">主要模式</a></li>
<li><a href="#h:6f5ee859-2548-4b70-a848-0e2103e6c258">次要模式</a></li>
<li><a href="#h:b4307ff6-7c54-4f13-b10f-514d345c1108">Mode hook</a></li>
</ul>
</li>
<li><a href="#h:e9266f36-1100-4519-8b9f-261656d06be4">Help 帮助</a>
<ul>
<li><a href="#h:b667c79b-8e69-42d9-9083-09b3212539ce">minibuffer增强vertico</a></li>
<li><a href="#h:2e12e3a1-c7e4-4195-bff4-3d76ed3c9628">帮助系统是你最好的朋友</a></li>
<li><a href="#h:e909acaa-aab6-49e9-8dc0-88a81988c4c7">C-h 作为前缀和后缀</a></li>
<li><a href="#h:f6700e93-3360-4f91-aedf-0000298455f4">如何阅读手册</a></li>
<li><a href="#h:2db47280-0185-4394-8788-be852cc3725a">用 Emacs Lisp 思考</a></li>
<li><a href="#h:553b643e-59de-4b80-b69b-c3aeecc58c1e">试验 Elisp 条件</a></li>
<li><a href="#h:306e619f-5246-4c28-bbbc-40dc9847813c">练习并保持耐心</a></li>
<li><a href="#h:87ba839c-5166-4cb4-93a1-3ed77aa2e349">其它</a></li>
</ul>
</li>
<li><a href="#h:f5059331-4004-44f1-b2b6-814a099fc25a">改变外观</a></li>
<li><a href="#h:8a9fb813-3ce3-4636-8dbe-1f60d69dbe40">其他基础讲解</a>
<ul>
<li><a href="#h:6edd8b84-4a53-4c8c-9cad-960faadccd28">基础</a></li>
<li><a href="#h:79545c10-0087-429c-b9d5-6af86545ce7d">中止命令与撤销命令</a></li>
<li><a href="#h:6699d55e-d5fb-4a8d-98ec-c224611a7e3a">文件与窗口相关命令</a></li>
<li><a href="#h:b3c7b935-67a3-498b-b466-c31d4741724a">帮助命令</a></li>
<li><a href="#h:2e63c556-923d-4480-91d9-d41e5e5a9399">复制/剪切/粘贴</a></li>
<li><a href="#h:ad604d9e-e211-43ed-a7ca-187eb81b8a66">新手快速配置和安装最简插件</a>
<ul>
<li><a href="#h:85160bfd-f118-4318-a388-c21cba012341">Emacs 插件管理</a>
<ul>
<li><a href="#h:e0f63fce-9a35-4a2b-a871-62cddb689901"><code>package.el</code> 设置示例</a></li>
<li><a href="#h:f939df29-1aef-4800-8053-dbd1349b6340"><code>straight.el</code> 设置示例</a></li>
</ul>
</li>
<li><a href="#h:3a24a351-22a7-4da1-bbfd-6fbc531b48ea">推荐插件</a>
<ul>
<li><a href="#h:32bbc13c-49b8-4582-afea-016055ad9940">安装插件的方法</a></li>
<li><a href="#h:28691e33-d352-4276-9cfd-6b6cf0a2e182">更快熟悉 emacs</a>
<ul>
<li><a href="#h:cfcb87e8-1fc8-498e-8f7f-ec5e97da76e7">插件组合1: 更多的帮助信息</a></li>
</ul>
</li>
<li><a href="#h:e52a1a4e-4459-41ba-a4a5-176ffb4ed5f2">更好的补全界面</a>
<ul>
<li><a href="#h:dbd2dea6-7cc9-42d5-9266-436f5af34561">插件组合2: 更好的补全界面</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:e272d9da-8c8e-498a-96c7-07e1dcebfbed">org mode 必要的配置</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:51a717a4-822a-434a-acc9-e33498aee9b4">配置</a>
<ul>
<li><a href="#h:8a3b1d5a-e03d-4de2-b98e-4eb69d5e64f3">体验配置文件配置</a></li>
<li><a href="#h:6ff9076a-7e15-4eed-b2b1-31ddc2ca21e6">配置文件位置</a></li>
<li><a href="#h:42011591-c1ee-48af-95f7-eaa0b83e604d">Emacs Lisp 简介</a>
<ul>
<li><a href="#h:dc18adb8-9cbd-4b66-a518-3b0fdb0e31a8">学习基础的Elisp</a></li>
<li><a href="#h:54de14a9-13a2-4ca2-b647-d8e3897166a4">elisp一些关键词</a></li>
<li><a href="#h:911f6338-d346-4e5e-a69b-228478de6aa5">几种运行elisp代码的方法</a></li>
</ul>
</li>
<li><a href="#h:fe108c1c-fe43-495f-95d0-dd763e3b42a8">工程化管理配置</a>
<ul>
<li><a href="#h:b22de275-5fe1-4a6b-9558-2b9617f1c358">使用git管理你的文件</a></li>
<li><a href="#h:8ce545ab-324f-47f3-a587-bd2ffd45a621">使用多文件存储配置文件</a>
<ul>
<li><a href="#h:94ef3913-683b-4744-9add-41e43bcce276">关于自定义的配置</a></li>
<li><a href="#h:8b4ed8a2-622d-4e09-80e1-632c9fe36b67">文件加载与调用</a></li>
<li><a href="#h:0b7eb58f-9851-4463-8f6f-86171466b26f">配置生效</a></li>
<li><a href="#h:5ad76dc7-63a0-4947-84a7-683020691320">结尾</a></li>
</ul>
</li>
<li><a href="#h:71917c6d-e323-495b-a7f2-f55cb1f3582d">使用 Org-mode 管理 Emacs 配置</a>
<ul>
<li><a href="#h:a2a93741-1976-48e2-b4ab-4241c4e60bfb">通过Org mode 的 tangle 功能管理模块化配置</a></li>
</ul>
</li>
<li><a href="#h:cb512e5c-d90f-4d19-b65d-d71c0fb33028">关于 lexical binding</a></li>
<li><a href="#h:0bf268dd-e6af-4ce1-ac45-0e426f705241">配置快捷键</a></li>
</ul>
</li>
<li><a href="#h:458312fc-ed1b-469f-aff7-8f1800137b0c">插件管理</a>
<ul>
<li><a href="#h:40fc6264-04bf-45e3-a5d8-11e900e91819">MELPA 插件源</a></li>
<li><a href="#h:f8d3c1b8-c336-4fea-9664-766d3c206223">命令安装</a></li>
<li><a href="#h:26317ee7-91b3-4780-b08a-43a67457acc2">手工安装插件</a></li>
<li><a href="#h:16ef6070-8dca-4ab3-b988-2c24bf47e232">配置安装</a></li>
<li><a href="#h:b674aeac-6dc2-486b-8fe0-a6fcc4da339f">加载其它文件</a></li>
</ul>
</li>
<li><a href="#h:8bef14f2-1296-47b9-b98e-d2c6fde1339a">Macro</a>
<ul>
<li><a href="#h:fd17d13e-81c1-4ac0-b1b3-d1e1b8b95136">什么是 Macro</a></li>
<li><a href="#h:aea2b10a-1141-454e-b561-78de3f7d4112">为什么使用宏</a></li>
</ul>
</li>
<li><a href="#h:a9256bed-c776-47db-a733-3e9adfd7de07">插件设置 (use-package)</a>
<ul>
<li><a href="#h:e7e771a2-0f8b-44b6-a1dd-e583bb276916">配置quelpa</a></li>
</ul>
</li>
<li><a href="#h:073e09f4-4662-43c8-98f1-e18f71f9196b">配置变量</a></li>
</ul>
</li>
<li><a href="#h:e3d2a3c1-2875-4ffc-a7c5-4245d0d70f78">一些配置</a>
<ul>
<li><a href="#h:4829bcd1-ea8f-4a96-a6f0-5bf2396a19e6">操作系统判断</a></li>
<li><a href="#h:c0b06a33-5458-4996-8d0e-f6dbd644f4d8">最开始的配置</a>
<ul>
<li><a href="#h:b0835fa4-9bf4-4120-b55b-1a897dc42636">basic 内置功能增强</a></li>
<li><a href="#h:815eb0de-2290-40db-b142-defbf1f9ccd1">不同文件跳转</a></li>
</ul>
</li>
<li><a href="#h:978a256e-9db4-4154-9797-143f3437dfb5">配置快捷键</a></li>
<li><a href="#h:5973ab9f-60b0-4af6-aa4b-15a755ae791a">其它</a>
<ul>
<li><a href="#h:3cae5bd3-c5f2-4622-8647-c4c5581e1cb9">通过修改字体解决 Windows 上 Emacs 的卡顿</a></li>
<li><a href="#h:54f073a0-8e9a-4ee8-ace4-78a839d3a0ee">增加的一点启动配置</a></li>
<li><a href="#h:9b21a271-6160-4e2b-95c1-051bc35101d4">用 y/n 来代替 yes/no</a></li>
<li><a href="#h:0dbe9602-f5b7-4556-8dea-6b6abe8ca870">tab 缩进</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#Org 管理">Org 管理</a>
<ul>
<li><a href="#h:02fe1f63-8c31-4f46-8493-3db7ac084d18">Org-mode 简化版</a>
<ul>
<li><a href="#h:0f7d62d7-90b9-46ef-8002-bc313c247ba9">org mode 能做什么</a></li>
<li><a href="#h:4c096ca6-5a6b-40e4-b252-5ad858db9878">安装最新的 org</a></li>
<li><a href="#h:2b7b026c-ecf9-4cf2-8c3c-0c9ebff624b4">org-mode基础</a>
<ul>
<li><a href="#h:8c8fb6dc-c834-441d-9e91-2a7ff22f6642">标题与折叠</a></li>
<li><a href="#h:a2538426-75c1-4ddd-af04-a105c3106dff">格式化字词</a></li>
<li><a href="#h:22f6d03f-a39b-4ab7-97f4-123df7d86fa6">输入控制字符</a></li>
<li><a href="#h:487ad9ac-ddee-4e81-afa7-8af7cb4761c0">添加代码块</a></li>
<li><a href="#h:43567748-650f-448a-82f7-628d7931273f">列表</a></li>
<li><a href="#h:ac79f8b2-1f22-45e4-a007-7eda24ffd4b8">超链接</a></li>
<li><a href="#h:5218fb37-431c-4c5b-842d-a1cddead9f5a">引用</a></li>
<li><a href="#h:b1a99d22-9b31-4c1c-b9fe-cd783311c16f">标签</a></li>
<li><a href="#h:7ba3695c-ebe0-4f2d-b617-2cc36cfa903e">插入 latex 公式</a></li>
<li><a href="#h:3f4d7afc-cd42-4ff6-ad1e-dc11166329a6">添加 org 注释</a></li>
<li><a href="#h:43040646-ac62-416d-a8c1-458eb0b0a4ca">计时功能</a></li>
<li><a href="#h:1aaf8cd6-c6b7-4707-bd99-60cb0d324dc0">Org 导出</a></li>
</ul>
</li>
<li><a href="#h:a6c29492-860e-4cca-923d-cd7a5d607e02">GTD</a>
<ul>
<li><a href="#h:da3de33b-845e-4733-82c5-6cee65452606">org todo</a>
<ul>
<li><a href="#h:0cd2807c-e072-4527-8534-b6acf0089257">多种工作流状态</a></li>
<li><a href="#h:3089e2ff-2661-466e-935d-5e1f28f84451">每日计划</a></li>
</ul>
</li>
<li><a href="#h:9863d2c8-061d-4d34-a262-8cbf6917e414">org agenda</a></li>
<li><a href="#h:0b8da68c-57ce-492f-9cc6-00252959ecd3">org capture</a></li>
<li><a href="#h:653170a1-0181-4e39-8d56-1a5451c44983">org effect</a></li>
<li><a href="#h:cf6e0e86-ace6-43a5-94cc-d24663c00fe4">org tags</a></li>
<li><a href="#h:689353b5-7a10-48eb-831e-66482d0eb172">org priority</a></li>
</ul>
</li>
<li><a href="#h:7403605c-87eb-4208-bbc5-5edc2b148180">Org文件以指定的目录深度打开</a></li>
<li><a href="#h:b660e930-6db6-49ee-9619-e3605ee121e8">其它操作</a></li>
</ul>
</li>
<li><a href="#h:e5d9645f-305c-49c5-9710-3ae1a2c19881">基础介绍</a>
<ul>
<li><a href="#h:fccec9c0-d1dd-4104-b574-e17e75ca9c39">org能做的事</a></li>
<li><a href="#h:e040cdf8-c264-4369-93ce-b4021e5a65c2">安装好org后的可选基础配置</a></li>
<li><a href="#h:d6397a53-6eaa-438c-be05-0aa8a99b57f9">美化插件</a>
<ul>
<li><a href="#h:ee2b6644-bde0-4474-8097-dc98c031972d">org-bullets 标题星号圆点的插件</a></li>
<li><a href="#h:5497f6e0-6344-4d2e-8237-74cc552da344">目录大纲</a></li>
</ul>
</li>
<li><a href="#h:20f93915-bf5f-47fd-ae45-987f160451b8">org 小技巧</a>
<ul>
<li><a href="#h:2f5bcb63-4994-4099-b39b-eb93349dcd10">更新文件</a></li>
<li><a href="#h:3b8988dd-e52f-4a33-923d-9847a9b88a96">快速选择一个列表</a></li>
</ul>
</li>
<li><a href="#h:084d47f6-ae24-4ce5-aa17-bec2424c54ef">org的编号</a>
<ul>
<li><a href="#h:112731c2-3bf6-431c-9915-2379ffff1f2e">org 格式化</a></li>
<li><a href="#h:2ae0fc53-cce2-4de8-bc79-791da6e34ae6">导出 html 优化</a></li>
<li><a href="#h:a2d92613-03cf-43bb-9111-31bf6a8e2ddd">利用abbrev mode 快速输入重复文本</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:0183db70-c900-436e-bede-acda1dc5174d">文档结构</a>
<ul>
<li><a href="#h:0f7437c5-c2c5-4d46-a479-9efa62e47e3d">标题</a>
<ul>
<li><a href="#h:b9376d8d-a045-4111-8aeb-9c218a0b2bcb">其他</a></li>
</ul>
</li>
<li><a href="#h:b33da071-a8ec-4404-a4a0-78c7f851202d">不同的显示样式</a></li>
<li><a href="#h:5cd90aa4-e750-4c97-aacf-5ab2c0f07386">移动相关</a></li>
<li><a href="#h:fbe96a03-b683-4da0-9351-65c6c732ae42">结构编辑</a>
<ul>
<li><a href="#h:e74b3a65-ceee-4f4a-b46b-d1acbcd73aca">文本</a></li>
</ul>
</li>
<li><a href="#h:0382369b-7a14-468b-9751-a8a4a9dfb304">Sparse Trees稀疏树</a></li>
<li><a href="#h:5a56faf3-01e5-476c-9355-4dac9ee84795">清单列表</a></li>
</ul>
</li>
<li><a href="#h:d8d2336e-1fd9-4909-956d-401bb4b7f46b">表格</a>
<ul>
<li><a href="#h:6adc5bc1-9810-4b0d-9863-0565669efbe1">表格的创建</a></li>
<li><a href="#h:4b3a9a1e-59d7-4f71-a094-2a1f1cbbc35d">按键说明</a></li>
<li><a href="#h:1a937035-94a5-4372-90ce-b0ce0eafb8fc">合并单元格式</a></li>
<li><a href="#h:90e6383f-9ea4-4013-8b7e-7db3adae1e87">表格公式</a></li>
<li><a href="#h:3825333f-a2ea-4f37-9913-90823af97628">表格绘图</a>
<ul>
<li><a href="#h:9402e5a4-3448-4785-86da-f7504cfeb33d">org-plot/gnuplot</a></li>
<li><a href="#h:ee2e9842-5150-4e7c-9d91-d620a35e59ca">With source block</a></li>
</ul>
</li>
<li><a href="#h:5b06ce43-3605-438a-b4dc-a442b3057a75">总结</a></li>
</ul>
</li>
<li><a href="#h:18ffcdf2-f05a-4b65-830f-87220d156c13">超链接</a></li>
<li><a href="#h:a43aea14-2a36-4844-b51a-5058a540ade0">待办事项</a>
<ul>
<li><a href="#h:0b495019-5561-450f-8ecf-9fb55f11fd16">待办事项基础</a>
<ul>
<li><a href="#h:6761fbf3-fc38-40f3-9c6f-bd8cc560ec89">基础的待办事项功能</a></li>
<li><a href="#h:62b0274e-5245-4215-8fc2-4b490ffb0ffb">多种工作流状态</a></li>
<li><a href="#h:0de3fac3-d509-4bbd-9c6c-ced69e67d717">进展日志</a></li>
<li><a href="#h:8d5f9a7c-5f8f-4bba-b71a-22b2c0aa6d76">优先级</a></li>
<li><a href="#h:dff2ef9d-c841-47ea-b977-107f866c9326">任务细分</a></li>
<li><a href="#h:306b3d66-e284-4198-8ed9-09dba71273ea">复选框</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:2ef66dd7-7d1c-4566-99c7-a28a49b37638">标签</a>
<ul>
<li><a href="#h:7898b38e-bc37-40bf-8d0c-c91b5d13abfb">标签继承</a></li>
<li><a href="#h:15f44fc3-d9bf-48ee-8c14-335905c0470b">设置标签</a></li>
<li><a href="#h:355a7c77-5398-413b-9f7f-4ddca5197e23">标签组</a></li>
<li><a href="#h:47fac935-0990-4879-9f92-da563b825e56">搜索标签</a></li>
</ul>
</li>
<li><a href="#h:4a5eba07-20b6-4431-8fad-d87c6fcef6ba">属性</a></li>
<li><a href="#h:5723388f-2559-4daa-8962-fe9cbdbac2c5">日期和时间</a>
<ul>
<li><a href="#h:d064a352-e5b5-4c13-8d45-5accfcb36efc">时间戳</a>
<ul>
<li><a href="#h:4d223d5b-58b4-4ab7-8ddb-833f68c36878">基本的时间戳（事件、约会）</a></li>
<li><a href="#h:9060279e-db5f-4fa7-833c-bc77fce1d5ae">有规律的时间戳</a></li>
<li><a href="#h:714de2a7-f74e-4af6-9524-52f9503fa61b">日记样式的时间</a></li>
<li><a href="#h:44c651b6-b033-4e1a-8205-e5313126f311">时间/日期范围</a></li>
<li><a href="#h:ccacd001-ac5f-4056-a0b4-7473166ba059">非活动时间戳</a></li>
</ul>
</li>
<li><a href="#h:12dd4b33-495d-4e07-850f-ed5bcf365fbb">创建时间戳</a></li>
<li><a href="#h:7b9b6f98-ee93-40c4-b837-766263cf6f44">截止日期和计划安排</a></li>
<li><a href="#h:08f8a188-a4fc-4fc2-9faf-b4b6251e99b7">记录工作时间</a>
<ul>
<li><a href="#h:b3ba054a-b344-4e7b-8143-c4e387c2facc">org mode用于读书记录</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:a48b96a4-cae5-42b1-a3b0-5bf396415739">重新归档和归档</a></li>
<li><a href="#h:261b9b06-b7db-4d6d-bafb-b81b2bb3ee46">捕获和附件</a>
<ul>
<li><a href="#h:c40f3d11-4364-47ab-b2f3-0b7a824425c0">捕获</a>
<ul>
<li><a href="#h:a5b88a10-7f04-48bc-a98a-4808532fb57d">设置捕获</a></li>
<li><a href="#h:671c5ac8-693b-420f-bb27-a862bb84d7d2">使用Capture</a></li>
<li><a href="#h:1562aca7-cfdc-4d5d-a249-1ad5ede538f7">Capture模板</a>
<ul>
<li><a href="#h:1a454cfc-a69a-4679-8e89-19400bb326d8">org-capture快速新建内容</a></li>
<li><a href="#h:a71246dd-75a2-457a-a149-3132569577a2">最小配置</a></li>
</ul>
</li>
<li><a href="#h:f8f2982a-c93e-4104-a5e3-9fce0f9fca53">capture 自定义模板</a>
<ul>
<li><a href="#h:45ce7664-bbfb-46f8-9ebf-30cd7f781544">capture 模板的五个部分</a></li>
<li><a href="#h:1b1639ac-de14-41cf-b346-3510ffb73f2d">使用capture 模板</a></li>
<li><a href="#h:cf87478a-456e-4798-83bd-7a7bbcc240f3">用 org-capture 来做任务管理</a></li>
</ul>
</li>
<li><a href="#h:0ac65517-296c-45c7-83ac-1f75d4b647c1">用 org-capture 来记录日志</a></li>
<li><a href="#h:282b011f-943d-4d71-89b7-266199975026">用 org-capture 收集灵感、记录笔记</a>
<ul>
<li><a href="#h:82d10c5c-3f1d-426d-8024-e0704c275228">弹出capture窗口</a></li>
<li><a href="#h:560a4c45-0e44-4bd1-b4f1-d6e71fac844e">我的配置</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:d7edd865-58c1-49ae-bace-49d481cedb42">GTD</a>
<ul>
<li><a href="#h:21b79770-78d4-49b2-97fa-820e834feb76">什么是GTD</a></li>
<li><a href="#h:c0795252-3795-43ec-a1c4-c6b5858f989d"><b><b>GTD原则：</b></b></a></li>
<li><a href="#h:ef7f7dc4-5772-4a0a-be8d-7024796f3998"><b><b>明确和组织</b></b></a></li>
<li><a href="#h:0bf3858b-23c7-4b6d-b813-292e1b4ac170">选择任务的操作</a></li>
<li><a href="#h:b7c8733b-a3e1-42d7-95a1-c3d4d20977d2">做</a></li>
<li><a href="#h:95c78dc4-1e15-4655-8f98-b98a13d512c9">回顾</a></li>
<li><a href="#h:d79ac030-7a30-493c-bff2-1694b0251b2e">归档</a></li>
<li><a href="#h:dcbc7c79-e43f-4aea-a456-23b64d194bf8">org-pomodoro 番茄时间工作法的插件</a></li>
<li><a href="#h:10cebcd1-5f46-415e-8fda-b002691efbcf">google日历</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:91421128-fd0a-4569-9a43-32d58459dee8">使用Agenda来查看日程</a>
<ul>
<li><a href="#h:38013889-ca2c-4da9-b28d-a256b4e73591">设置</a></li>
<li><a href="#h:ae196bae-d5e4-4f8a-bf5a-1ccc187fff50">Agenda 的使用</a></li>
<li><a href="#h:8f37e915-6f93-46bd-9282-9229d500e546">org-agenda演示</a></li>
<li><a href="#h:f83ddd44-a78e-4b1a-91eb-963cdf4a31fe"><b>org-agenda查看自定义模板</b></a>
<ul>
<li><a href="#h:181062df-e9d9-4a13-bbb9-96e67e4a21b6">org-super-agenda插件</a></li>
</ul>
</li>
<li><a href="#h:3e99829b-2e74-491b-9d1f-b457682a9034">`~/.emacs.d/lisp/init-org.el`文件</a></li>
</ul>
</li>
<li><a href="#h:41dcb152-f0d6-4f47-8471-07fed78b02cf">富文本标记</a>
<ul>
<li><a href="#h:3e7b1ce9-4ebd-436d-9b4b-9c2234addf50">图片</a></li>
<li><a href="#h:770e59aa-8a82-4caf-a804-0c9d859ddcb9">创建脚注</a></li>
</ul>
</li>
<li><a href="#h:4ad4a0a7-7683-40d8-9e58-4928d5e7e42a">导出</a>
<ul>
<li><a href="#h:7594038c-15c5-42a5-85a0-97910cf43cf5">导出设置</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a></li>
<li><a href="#h:2cc66bcd-64e4-4b8a-a540-e668ef98ef6f">插件-内置包</a>
<ul>
<li><a href="#h:4729f7f6-1fc6-4dd3-9165-82741aa69a09">Dired</a>
<ul>
<li><a href="#h:92e65847-da2b-4972-8cb3-2251f3cd5655">批量修改文件名</a></li>
</ul>
</li>
<li><a href="#h:c4633986-58cf-4f2b-a3b3-bd835647b5ed">IDO/Icomplete</a></li>
<li><a href="#h:683fb41c-c52d-4f4b-81d2-ddae3bc742fa">Winner Mode</a></li>
<li><a href="#h:3962d68a-6144-45d7-9523-ef31723fcb2d">imenu 跳转</a></li>
<li><a href="#h:2c58b4d3-ae66-454c-9017-edf5799c7037">whitespace 识别空白内置包</a></li>
<li><a href="#h:94022f09-9bc8-4dd0-960f-ab3244b61142">prettify-symbol-mode</a></li>
<li><a href="#h:8aa7ff0e-5d31-4e91-a7dc-298b235098e0">abbrev 缩写补全内置包</a></li>
<li><a href="#h:84712c53-09a2-4f81-9cc0-8f5e3b4f1630">Eldoc 显示定义内置包</a></li>
<li><a href="#h:2beea88c-e4c7-486d-8d47-63492b0ca00a">hideShow代码折叠 内置包</a></li>
<li><a href="#h:84cbd0b2-761f-4ba7-826f-b607992c572c">flymake 语法检查器 内置包</a></li>
<li><a href="#h:90d00d54-b727-4f3a-b620-16a6f839658c">CC Mode</a></li>
<li><a href="#h:430e36b7-018e-4101-94e9-d3dcfc6134ab">ielm</a></li>
<li><a href="#h:84445224-bb5f-4a3f-9cc9-0df3abb6b08c">Org Mode</a></li>
<li><a href="#h:1c626f40-445b-46d6-8842-9eddd63fa4dd">VC</a></li>
<li><a href="#h:b67fb45a-f74a-4fbd-9df2-8dd574a0fce7">EShell/Term</a></li>
<li><a href="#h:015db127-1d46-4b11-aae9-0c194f1c51c2">package.el</a></li>
<li><a href="#h:4edd4a74-ae23-45c4-9395-65a7abc208bc">tramp-mode编辑远程文件插件</a></li>
<li><a href="#h:4b0b6921-55ca-4f6a-8e18-435254009d8b">eww  浏览器 内置包</a></li>
<li><a href="#h:8a5cf80c-052c-4bab-bacd-37eb4f9b28bb">mu4e邮件</a></li>
<li><a href="#h:ff805566-6d9b-4233-a01a-6ab8d36311ed">emms music插件</a></li>
<li><a href="#h:8ea20429-db9d-4f69-a8b1-5165701b8d81">recentf 最近访问文件</a></li>
<li><a href="#h:6fb2aa07-eb86-4101-bc04-67f8d1903e58">sessions 保存和恢复编辑器会话</a>
<ul>
<li><a href="#h:552aeaef-16e0-4072-ada3-a8e459094020">savehist, saveplace 保存光标历史，记住上个命令位置</a></li>
</ul>
</li>
<li><a href="#h:188a76a5-8b4f-4cfe-8610-07f130a81150">几个内置的主题</a></li>
<li><a href="#h:a42add85-8942-4d45-a922-d4dd150941c8">不常用的内置功能</a></li>
</ul>
</li>
<li><a href="#h:79a4c1cb-7b35-45e3-8a14-0c6458ffd03c">插件-功能优化类</a>
<ul>
<li><a href="#h:eb8b4bbf-fb19-45da-be61-27f1a073497a">ivy 搜索优化插件</a>
<ul>
<li><a href="#h:663fea7f-7999-475b-b228-a1d7f6790cb4">配置流程</a></li>
</ul>
</li>
<li><a href="#h:47ed6446-96e7-4c02-aaba-41374718aa7f">amx</a></li>
<li><a href="#h:7c3f3b73-46bc-400f-a3b0-2d7bb2094afc">ace-window 窗口间的跳转插件</a></li>
<li><a href="#h:16d736b7-ad2f-490b-af9d-58b8ba73e251">mwin</a></li>
<li><a href="#h:9b874035-242f-42fa-89e5-89bf53304977">undo-tree 撤销树插件</a></li>
<li><a href="#h:d3c54205-538e-451f-bc4e-476cd9e605d7">smart-mode-line 插件</a></li>
<li><a href="#h:c5137ddb-e01a-4070-9618-c13421e81307">good-scroll</a></li>
<li><a href="#h:a9a7cbd5-dc3b-43b3-b7d2-afc22f618e8d">restart-emacs 重启emacs插件</a></li>
<li><a href="#h:a3ab1bf4-9a2d-4605-9584-a2274ad6d907">benchmark-ini 测试启动耗时插件</a></li>
<li><a href="#h:de02f34b-6721-4d9c-81f9-c4c801ff52aa">smartparens 成对插件</a></li>
<li><a href="#h:536d5305-bb2a-476c-a985-d27f1c691b6d">crux 优化emacs常用操作</a></li>
<li><a href="#h:3b16b1ae-e41d-4f17-b95d-83b621491747">try包</a></li>
</ul>
</li>
<li><a href="#h:3dbd641f-14b8-4494-93b5-cbb83ccd3b52">插件-功能增强类类</a>
<ul>
<li><a href="#h:2eb6452f-1388-4de8-bc61-21df09c8052e">Interface Enhancement</a>
<ul>
<li><a href="#h:1a6e4818-0c24-4e4b-a42b-ff8243efc7a7">dashboard</a></li>
<li><a href="#h:fcbbec36-69e9-4eee-9b81-7fc9f9598820">helpful 帮助插件</a></li>
</ul>
</li>
<li><a href="#h:905e6512-c21e-4fa5-b5b6-96a3b9e44c42">Book marks</a></li>
<li><a href="#h:38dd2955-f6d1-4a11-b916-cc13fe07c41a">ivy view</a></li>
<li><a href="#h:4da09563-5753-4a78-8dd8-f3183df84dad">which-key 组合键显示插件</a></li>
<li><a href="#h:3253d03e-0457-40a7-8663-3f4cb81c5121">avy 快速搜索定位插件</a>
<ul>
<li><a href="#h:9fa8caaf-17f4-47a9-a646-cf7a8fbfe5ab">操作逻辑抽象</a></li>
<li><a href="#h:fd238ab7-03d6-49d9-a741-562415730f73">基本用法</a></li>
<li><a href="#h:aa0697d6-88ea-4ab8-8f9e-2c0138670768">进阶用法</a></li>
</ul>
</li>
<li><a href="#h:14bdd66b-812e-4b8b-88fa-b25504510336">minibuffer 补全</a>
<ul>
<li><a href="#h:eaada5ce-bec0-4338-8762-878f98851ad8">vertico和 Orderless 增强 minibuffer 补全</a></li>
<li><a href="#h:1a8eb4fa-c83f-4570-a064-ffac59b5e94b">marginalia 增强 minubuffer 的 annotation</a></li>
<li><a href="#h:245be342-c6ad-4688-9840-79699f85a3af">embark 增强 minibuffer action 和自适应的 context menu</a></li>
<li><a href="#h:82e69d3a-6bf5-46bf-8921-f9636908ce1a">Consult 增强文件内搜索和跳转函数定义</a></li>
</ul>
</li>
<li><a href="#h:b8ba25d0-235f-4ddf-9f89-124feeb4f08d">hydra 自定义按键组合菜单插件</a>
<ul>
<li><a href="#h:32112a65-bdd4-46b5-af7f-b7a70e01cda9">Window</a></li>
<li><a href="#h:10b13b6f-5edb-41ba-9372-7b3b003ad56f">MC 多游标</a></li>
</ul>
</li>
<li><a href="#h:e77a9821-94d8-4afe-a1ad-7f2382bd53c9">multiple-cursors多光标插件</a></li>
<li><a href="#h:ea78466a-d75b-4852-a27e-9b3289204921">tiny</a></li>
<li><a href="#h:65e8eb34-0627-4377-96ed-620e9d3931fc">highlight-symbol</a></li>
<li><a href="#h:4e139573-544d-4d15-974a-32e3bd2b2883">rainbow-delimiters</a></li>
<li><a href="#h:964ee18a-93c5-4943-b284-822a58cd19d4">google-this</a></li>
<li><a href="#h:66409e21-1707-4475-a9f1-62d6e256523d">evil（为 Vim 用户）</a>
<ul>
<li><a href="#h:3511eb20-d226-4d76-ad43-a441aa9009b2">安装Evil</a></li>
<li><a href="#h:c59ac394-a32c-478f-9e17-eee29e55b38c">Evil state</a></li>
<li><a href="#h:eff30182-038c-4d5f-9fec-1f752ab1936a">Evil基础用法</a></li>
<li><a href="#h:evil-custom-keybinding">自定义快捷键</a></li>
<li><a href="#h:5bb4009d-f741-44ee-bbc3-61ad2b7bdaeb">evil-leader 插件</a></li>
<li><a href="#h:36d15ff2-87fc-47f2-a385-ddca88f7c2f0">相关插件列表</a>
<ul>
<li><a href="#h:2186eba8-72bf-4c04-b439-168680e1055e">evil-escape插件回退到normal state</a></li>
<li><a href="#h:ff29f09d-cec5-488a-a62e-2e96a9327958">evil-anzu</a></li>
<li><a href="#h:4ab86f63-e3dc-4b10-a730-72d12d10555a">evil-collections</a></li>
<li><a href="#h:efec661d-88ef-4d35-8545-e33a71e60c04">evil-surround</a></li>
<li><a href="#h:5748be0d-f8c4-45d6-89c0-3fd42e880a2c">evil-nerd-commenter</a></li>
<li><a href="#h:c63ca6bf-d489-49a3-90b9-0826c2bc5f20">evil-snipe</a></li>
<li><a href="#h:270a82c8-9426-4829-b6b8-2037a2121fdf">evil-matchit</a></li>
</ul>
</li>
<li><a href="#h:78a0a60e-dfaf-4aeb-9f4d-6bbaefd6ae1d">高阶用法（自定义 text-obj 或者 自定义 commands)</a></li>
</ul>
</li>
<li><a href="#h:ace7fead-b17b-4cb3-a5ef-f1e78e52ecba">Window-numbering 插件</a></li>
<li><a href="#h:e68f5892-d6f7-4298-b1fb-348e49ea8b58">elfeed订阅插件</a>
<ul>
<li><a href="#h:6da7003c-ea3b-411d-88f4-8b4fb3926cbd">elfeed-part1</a></li>
<li><a href="#h:8ff31c4b-fb3c-4f4c-af8f-72cf099f183d">elfeed-part2-Hydras</a></li>
<li><a href="#h:f059a5b3-4ab3-42a6-81ad-9491054b5b32">elfeed-part2-macros</a></li>
</ul>
</li>
<li><a href="#h:45076e41-f667-4616-ac16-bc2f98be461c">Hyperbole 超文本管理系统</a></li>
</ul>
</li>
<li><a href="#h:b7fd23b6-e4f6-40b2-a626-b402646745c6">插件-外观主题</a>
<ul>
<li><a href="#h:b488b90d-b246-4980-b6b5-d249f2001b48">modeline 增强</a>
<ul>
<li><a href="#h:0a2569bd-3126-417c-8886-98ab2b1602a7">simple</a></li>
<li><a href="#h:69a8c85e-9645-4ca7-a282-de4a4858abef">doom-modeline</a></li>
<li><a href="#h:9014e687-3c8e-4d46-a316-bb3543f7963a">更换主题</a>
<ul>
<li><a href="#h:5d366512-d2b0-4adb-b20b-183555cb25c9">customize theme 内置主题</a></li>
<li><a href="#h:8c77c09b-7f63-4e29-b424-e8286278435f">color-theme-sanityinc-tomorrow 主题插件</a></li>
<li><a href="#h:45ff93fe-27b0-4396-a83c-9d39c51b1c31">zenburn-theme 主题插件</a></li>
<li><a href="#h:3094ac2d-07c0-4cd6-9125-854f36ca839e">monokai-theme 主题插件</a></li>
<li><a href="#h:b7d8b66b-436a-42bf-8823-c41866fc9794">doom-themes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:c1608212-7bcc-44eb-a2d7-874a0921eaf3">插件-有趣类</a>
<ul>
<li><a href="#h:76a8660e-5ef9-4b69-9d1c-725847bd069c">教学辅助</a>
<ul>
<li><a href="#h:7716bd23-ebc5-4739-af84-ba5d60c090a2">keycast</a></li>
</ul>
</li>
<li><a href="#h:504f9b85-ac01-4aa7-a038-2c6d942f1821">小功能包</a>
<ul>
<li><a href="#h:f47fcad4-ad11-4f66-b7bf-abce3bcdcec7">beacon 滚动时闪烁光标插件</a></li>
</ul>
</li>
<li><a href="#h:f6d29041-370a-4178-af4e-ae9cde9d641d">画图</a>
<ul>
<li><a href="#h:fe2bfc54-0aca-46f0-a37d-fffd91455d67">artist 画文本图内置包</a></li>
<li><a href="#h:a424b9f2-9f05-452c-a18d-3f44a7fd407a">figlet 插件</a></li>
</ul>
</li>
<li><a href="#h:b41e16e7-abc5-4263-8f27-8d447c46de3c">pandoc 文本转换器</a></li>
</ul>
</li>
<li><a href="#h:25f5f221-bf9b-449d-b79d-b00488819071">插件整理</a>
<ul>
<li><a href="#h:b16c2928-0c0d-4a2d-858b-20163f0c6f8c">dired 目录相关插件</a>
<ul>
<li><a href="#h:aa73cb3f-9efb-4998-86f7-344530eb68c7">旧版dired插件</a></li>
</ul>
</li>
<li><a href="#h:da79e80e-8473-4df6-b5bc-76cb34c57418">pcre2el正则插件</a></li>
<li><a href="#h:066bcbd8-3627-4128-aaf3-8c20e1772a6c">Atomic Chrome已弃用</a></li>
<li><a href="#h:786fa5ff-edba-4acb-a6c9-6ac231217b0e">自定义菜单插件</a></li>
</ul>
</li>
<li><a href="#h:6ed13efd-21da-4dd9-b227-449a8ebfc079">插件-开发环境</a>
<ul>
<li><a href="#h:ec846e9b-5edd-4130-badf-ea611b910d9c">编程辅助</a>
<ul>
<li><a href="#h:e72a8e09-4aaf-4854-8bca-e59e0c962557">函数跳转与注释</a></li>
<li><a href="#h:204ed4b3-8ea4-495e-aeaa-94de64d687f5">Completion 自动补全</a>
<ul>
<li><a href="#h:a80eff87-e0fb-411d-8af7-89677a5c5fcf">基本的补全</a></li>
<li><a href="#h:8b6ae587-c4fc-4458-b258-9851adc8daad">auto-complete 补全插件</a></li>
<li><a href="#h:4682a9d6-c356-4159-b100-1a986447d85b">Company 补全插件</a></li>
<li><a href="#h:92d4beba-812e-45d0-b60f-82ce52a1de87">缩写补全</a></li>
<li><a href="#h:e69d7361-1893-4185-8dbe-60c1ff69908b">hippie-expand 补全</a></li>
<li><a href="#h:93e27e60-418a-42ca-8f0e-c9506b4681e1">补全完善</a></li>
</ul>
</li>
<li><a href="#h:eae1a7d1-d933-4ec2-b5b1-1ff83e3e5753">Syntax Checking 语法检查</a>
<ul>
<li><a href="#h:f0cb2f15-2af7-4070-908e-774c58a5a081">flycheck 语法检查插件</a></li>
</ul>
</li>
<li><a href="#h:ce07a33e-4709-4681-92fb-9732a0220781">Format (style, highlight, indent )</a></li>
<li><a href="#h:4d68d59b-bc15-41e6-bbca-2b21aa121246">Navigation 导航</a>
<ul>
<li><a href="#h:3a90c273-103e-43b2-9884-a6584187b642">dumb-jump跳转到定义插件</a></li>
</ul>
</li>
<li><a href="#h:763bc375-0e56-4aca-99ab-c8a191bca30d">Code Templates &amp; Snippets 代码模板和片段</a>
<ul>
<li><a href="#h:343d2423-685d-4a96-b9e9-ec9d6927c66d">yasnippet代码片段模板</a></li>
</ul>
</li>
<li><a href="#h:226791fb-7946-4f79-8e3b-04991d3c7c8c">代码调试</a></li>
<li><a href="#h:461dccbb-9553-46cf-9317-d1716ab9c1a7">Project 项目管理</a>
<ul>
<li><a href="#h:958269d3-4e72-499e-9a6d-b22fc0cf234f">插件-projectile</a></li>
</ul>
</li>
<li><a href="#h:2f4d3338-fb22-4da4-bb66-3fbf94b4a31b">局部变量</a></li>
<li><a href="#h:a8f3a177-17f2-4cb1-9079-6ef6b2bef06f">环境变量</a></li>
<li><a href="#h:e2161054-41b8-490c-930b-f7bfbdeffbaf">版本管理</a>
<ul>
<li><a href="#h:81039ec5-0485-4320-9700-20246c1409ff">Magi和git相关插件</a></li>
</ul>
</li>
<li><a href="#h:918e5f51-00fa-4640-b907-5e17c4dc0e24">工作区管理</a>
<ul>
<li><a href="#h:ca1206f5-382e-4733-b2d2-b5791cfb6276">treemacs插件</a></li>
<li><a href="#h:693f9055-02bf-4136-b2d7-288cc6902192">lsp-treemacs</a></li>
</ul>
</li>
<li><a href="#h:afef20f4-f16c-4a10-9357-397bf5a077d0">终端</a></li>
<li><a href="#h:c2b2ef9b-d16c-4091-a339-3879d3b2f8a1">远程访问</a></li>
<li><a href="#h:1b04e0fe-d1f4-4819-8820-728077cf762d">Doc 文档</a></li>
</ul>
</li>
<li><a href="#h:1cf85fd5-46a3-483d-bf93-878ebc13272e">编程语言</a>
<ul>
<li><a href="#h:c540b2d7-075e-40f7-b370-0cf0ea80a9e5">代码分析</a>
<ul>
<li><a href="#h:16e834a4-bae3-4286-89c4-651d756171ff">lsp-mode</a></li>
<li><a href="#h:9195a3ae-6d80-4f90-9845-ea1ed0d03133">eglot</a></li>
</ul>
</li>
<li><a href="#h:7acd0544-2ad0-44ce-9120-301d3507093c">LSP-python语言环境</a>
<ul>
<li><a href="#h:56ad8f41-8b2b-4326-924b-1e1a0ca0d82d">方法2python-palantir</a></li>
<li><a href="#h:388b9233-a1ea-453e-8ef1-97db186a7718">旧方法python jedi</a></li>
<li><a href="#h:8873e0c7-d4e1-4362-9f6b-85b82ef38c44">旧方法python elpy</a></li>
</ul>
</li>
<li><a href="#h:90a4fd8b-24f7-41ac-ac82-decd85de8834">LSP-go语言环境</a></li>
<li><a href="#h:c60aafb9-64f9-41b5-bc7f-86d8c7f84f32">LSP-c++语言环境</a>
<ul>
<li><a href="#h:22dbe2b5-eb58-445a-b4b4-fc25095dc143">非lsp</a></li>
</ul>
</li>
<li><a href="#h:23b168ff-d6ce-4c30-bd71-63e4d97f635d">前端开发</a>
<ul>
<li><a href="#h:51861f70-f1c7-433d-991a-08c39500b4eb">web-mode 插件</a></li>
<li><a href="#h:4b6fa779-2b9b-4336-9074-644a7e3dee82">js2-refactor 插件</a></li>
<li><a href="#h:11d04d3c-c69b-4844-a77d-a57ac5101ec0">优化 occur 与 imenu</a></li>
<li><a href="#h:33d41d7f-a1d8-4267-9104-ee44cc8b435a">JavaScript IDE</a>
<ul>
<li><a href="#h:1590c98a-ffe1-4371-b60d-3881dd15f881">js2-mode插件</a></li>
<li><a href="#h:a69ad9e2-481d-4814-9de6-96d027af0277">nodejs-repl插件</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:b9993db1-f53e-4934-818b-4011d370121b">插件应用</a>
<ul>
<li><a href="#h:d0473065-b04f-4f5f-9ce1-a64eeca584ce">Org文件导出为其他格式</a>
<ul>
<li><a href="#h:42cb0610-ab99-405a-8300-9dc3db1abb6d">org文件能导出为什么格式</a></li>
<li><a href="#h:dd8caa86-a2d0-4615-bea0-3bb866bffb87">org文件导出通用设置</a></li>
<li><a href="#h:efaf8a22-8faa-4f4c-b2e4-f91e4328e3fd">org文件导出为网页</a>
<ul>
<li><a href="#h:3ed8b644-9365-4bd5-8a57-34ed5a5fad05">ox-html导出设置</a></li>
<li><a href="#h:1e7e3929-94af-4f6c-adfb-3b7103748ca3">修改导出的样式</a></li>
</ul>
</li>
<li><a href="#h:193d1135-9a23-4c9f-a321-56f8d477700c">org文件导出为PDF</a>
<ul>
<li><a href="#h:667c634a-0083-4994-9336-b856a3acc0ef">ox-latex导出PDF设置</a></li>
</ul>
</li>
<li><a href="#h:f6b77b0d-8a88-475f-8824-66100d48dcea">org文件导出为Reveal.js幻灯片</a></li>
<li><a href="#h:aa8aacee-201b-48fc-885d-8d9bb07fd143">org文件导出为Markdown</a></li>
<li><a href="#h:9a6e5c9c-5087-496b-bcc4-61a3921e7892">org文件导出为Office文件</a></li>
<li><a href="#h:adf5c0c8-8b19-4b5c-acb3-2725e4711a18">org文件导出为博客站点</a></li>
</ul>
</li>
<li><a href="#h:1be7d378-925e-4d53-b9d0-efaa60c7024d">通过 Org mode写博客</a>
<ul>
<li><a href="#h:ce091335-e54f-42b7-8ed1-af64cd767ee5">通过ox-publish写博客</a></li>
<li><a href="#h:518a21d7-1504-456d-bfa6-271be6e3b42b">通过 ox-hugo 来写博客</a></li>
</ul>
</li>
<li><a href="#h:17da42b2-5694-413d-aa59-ed71c39fbee8">org-mode 写文档小技巧</a>
<ul>
<li><a href="#h:7733b0cb-b324-4929-9994-d7132f20261c">截图</a>
<ul>
<li><a href="#h:07656bfa-f29d-4ae3-acbc-b6f55e6ad62a">一个小函数</a></li>
<li><a href="#h:7eb13b73-f15d-4980-a7e4-3220a908bd23">org-download</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:bd070f19-2283-4563-9779-45e95f01cb8b">在Org mode里用纯文本画图</a>
<ul>
<li><a href="#h:04fdfc58-954d-495d-90de-dd7c9f11a551">plantuml</a>
<ul>
<li><a href="#h:2080c3ce-fad8-4539-b959-f6e370635542">PlantUML的安装和配置</a></li>
<li><a href="#h:25de2b1a-485f-4ade-a405-d2722e159349">PlantUML各种图形的示例</a>
<ul>
<li><a href="#h:b0294d97-9d21-4d20-b3e5-f0738b953134">时序图</a></li>
<li><a href="#h:3f0bb6c4-ce4e-4473-85a2-245f3d79273d">类图</a></li>
<li><a href="#h:53f989f7-a276-49a9-8f15-ad9d79fece8c">组件图</a></li>
<li><a href="#h:b6d9e0ea-8d0b-430e-ad91-2b98a46b3e67">活动图</a></li>
<li><a href="#h:488ec2b6-d280-4218-ba75-f79363f6e784">甘特图</a></li>
<li><a href="#h:0abdb679-2523-4768-8ca9-4f47b15714ee">思维脑图</a></li>
<li><a href="#h:2ab8cb15-3443-4065-9b91-365c3db56bd9">JSON结构</a></li>
<li><a href="#h:bf7ad5ab-ffde-4047-8d23-3b7c9eb22817">简单的原型</a></li>
</ul>
</li>
<li><a href="#h:61c8febf-559a-4c2f-89fd-cf27210e150b">gnuplot绘图</a></li>
<li><a href="#h:e7eae0f3-b329-4a74-94ea-936967f0968c">Lilypond乐谱绘图</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:49a632ed-9440-4965-9019-b152464b2e3e">附录-Emacs Lisp Intro</a>
<ul>
<li><a href="#h:5271f2ed-8270-4180-9537-2daedace7f8f">Preface</a></li>
<li><a href="#h:29f9378f-7a79-4f81-a6a2-6c42e58c380e">List Processing</a>
<ul>
<li><a href="#h:aabf0d5e-fc9b-460b-b7cb-e1934258df85">Lisp Lists</a></li>
<li><a href="#h:b42e91ae-e744-465d-9686-f26ae2138742">Run a Program</a></li>
<li><a href="#h:ad809028-01ea-405d-b001-4b9b03b0f58f">Generate an Error Message</a></li>
<li><a href="#h:97ce27cd-c7a0-40b4-b62e-a318cde1a47c">Symbol Names and Function Definitions</a></li>
<li><a href="#h:386a16af-0a03-4cb2-bb18-895ab109d091">The Lisp Interpreter</a></li>
<li><a href="#h:f4cc5af3-b945-4b17-8960-345f14323f7f">Evaluation</a></li>
<li><a href="#h:db594656-28b0-41f9-8883-c3c7df407bf9">Variables</a></li>
<li><a href="#h:6404a22c-d5de-4753-9a0e-c87113e5b56c">Arguments</a></li>
<li><a href="#h:a366eb77-7d50-4342-a77b-343e89eba604">set &amp; setq</a></li>
</ul>
</li>
<li><a href="#h:90137c13-00cf-41dd-85c8-5761e23a66c7">Practicing Evaluation</a></li>
<li><a href="#h:c11e43fe-6e15-42e0-b305-d72c6563bbf0">Writing Defuns</a>
<ul>
<li><a href="#h:3ccde56c-788c-4a93-928d-49cfbbec02ec"><b><b>如何定义函数</b></b></a></li>
<li><a href="#h:30419e25-cfe4-4800-aa52-414257f4ca99"><b><b>函数安装</b></b></a></li>
<li><a href="#h:2941cb28-b629-48fe-b858-fe9981ed4003"><b><b>交互式函数interactive</b></b></a></li>
<li><a href="#h:f789fc67-40e1-4379-88c5-50726c14e1fe"><b><b>永久安装代码</b></b></a></li>
<li><a href="#h:6c52e80f-c778-4e52-9574-99cd851865f8"><b><b>let函数</b></b></a></li>
<li><a href="#h:d71d5f2a-e223-4b75-b5a5-32f45c00fc12"><b><b>if判断</b></b></a></li>
<li><a href="#h:a4f11428-9aa3-4f39-9c23-a5a83c0c7c63"><b><b>判断真和假</b></b></a></li>
<li><a href="#h:7963ea63-0c2b-41f9-b054-bc01ba68631f"><b><b>`save-excursion`函数</b></b></a></li>
</ul>
</li>
<li><a href="#h:1c88e549-ba80-4658-8618-57a40ac5d592">Buffer Walk Through</a>
<ul>
<li><a href="#h:2f84ec1c-8795-4480-96f9-131fc3d3c114">查找更多的信息</a></li>
<li><a href="#h:85d38f3f-df59-4e04-8fa0-c856ccd00c71">简化的beginning-of-buffer函数定义</a></li>
<li><a href="#h:86e9ea5e-a031-4b19-9040-3783097e75ad">mark-whole-buffer函数定义</a></li>
<li><a href="#h:6764a003-9c2a-42bd-b2ce-5ec533a5a3df">append-to-buffer函数定义</a></li>
</ul>
</li>
<li><a href="#h:0c49d31a-04be-49c5-8e49-3620afb04e4e">More Complex</a>
<ul>
<li><a href="#h:d84c84fd-137a-4717-b8f8-4a680ffad587">copy-to-buffer 函数定义</a></li>
<li><a href="#h:4b41f977-3a86-4d7e-bb9c-1a58c0342fb2">insert-buffer函数定义</a></li>
<li><a href="#h:47aed123-8fae-4564-8240-6e9c0a434651">beginning-of-buffer函数的定义</a></li>
</ul>
</li>
<li><a href="#h:1eeba82f-1be0-486f-ad22-e0e08e6b3d52">Narrowing &amp; Widening</a>
<ul>
<li><a href="#h:34bffa38-96e1-45f2-89c7-267090157987">save-restriction特殊表</a></li>
<li><a href="#h:b164264c-3529-47d5-8249-0d1fb28237df">what-line函数</a></li>
</ul>
</li>
<li><a href="#h:7e410508-b802-49dd-9ceb-1f2bdad42baa">car cdr &amp; cons</a>
<ul>
<li><a href="#h:218085ed-db04-4372-96ab-8d53d94bc6bb">car 和cdr函数</a></li>
<li><a href="#h:21414547-8e79-4294-9858-be9e865e9186">cons函数</a></li>
<li><a href="#h:bfedcd02-b948-4aa4-800e-d0d8d9be2910">nthcdr函数</a></li>
<li><a href="#h:1915493a-5415-49a8-87f5-7e1aee1917e3">setcar函数</a></li>
<li><a href="#h:c071dbef-4b9a-4d54-a40d-3a20b37a305a">setcdr函数</a></li>
</ul>
</li>
<li><a href="#h:a1d957ce-32e7-4467-a207-0b7ebcadb658">Cutting &amp; Storing Text</a>
<ul>
<li><a href="#h:2bff4fc7-a36c-4a1b-be7d-6bf455bdc1fd">zap-to-char函数</a></li>
<li><a href="#h:01c488ec-6859-4afd-bb93-c8d0ef0c9da8">kill-region函数</a></li>
<li><a href="#h:a6890973-85d0-45f4-a43a-2a9bf9f1f7dd">delete-region函数</a></li>
<li><a href="#h:500c2883-5a94-4b6b-b53b-8e28e9473dbb">用defvar初始化变量</a></li>
<li><a href="#h:f96da67c-9052-4ab5-b161-3ac9b652fef0">copy-region-as-kill函数</a></li>
</ul>
</li>
<li><a href="#h:0dabbb1c-d3b9-464f-9596-c28619eb6566">List Implementation</a></li>
<li><a href="#h:eca26168-289a-40ff-ac18-86b7ffee9d7e">Yanking</a>
<ul>
<li><a href="#h:843e12cf-bc63-4717-9068-614e250cfebe">kill环总览</a></li>
<li><a href="#h:eb548d6f-4297-4189-98d0-b29c9220100e">kill-ring-yank-pointer变量</a></li>
</ul>
</li>
<li><a href="#h:6b23e463-dc2e-4f4f-bd27-f5b3ad02c2ff">Loops &amp; Recursion</a></li>
<li><a href="#h:737a51d4-6566-4a82-8c68-9eeaea8330a8">Regexp Search</a></li>
<li><a href="#h:8b7d63a8-c0fd-4ea2-93cc-4c6b107a87d6">Counting Words</a></li>
<li><a href="#h:36bc8678-0341-4d13-a897-fb6143b3b766">Words in a defun</a></li>
<li><a href="#h:8f96f424-98ee-4f3f-93ed-9f59d74604a0">Readying a Graph</a></li>
<li><a href="#h:f4c4baa4-872d-43b5-8f52-e5833f264bc9">Emacs Initialization</a></li>
<li><a href="#h:9faeba3d-c813-42a3-9c21-ea3ecccaf003">Debugging</a></li>
<li><a href="#h:59de3f3f-f5af-4ed2-9902-b9c229b6a336">Conclusion</a></li>
<li><a href="#h:076f3d0b-c1b2-4ce4-b093-0d9d89ae0680">the-the</a></li>
<li><a href="#h:34e83b84-e8ce-4e81-8d92-b0e23e87ea6d">Kill Ring</a></li>
<li><a href="#h:20282976-9386-4382-8e34-cc736ea12cad">Full Graph</a></li>
<li><a href="#h:392ad25e-e75f-4f2d-bf9c-c08bc32a7987">Free Software and Free Manuals</a></li>
<li><a href="#h:e46a440f-e390-402c-a033-a6607bb6c582">GNU Free Documentation License</a></li>
</ul>
</li>
<li><a href="#h:601b8c3a-9bae-4dfd-b014-c3115c519639">TMP</a>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#h:677ec3f9-d41d-42ab-81c0-aa3c3a55f8fe">代码缩进</a></li>
<li><a href="#h:2879a827-5551-4b9a-99e0-9268a81aaa2d">插件-显示缩进线</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:85b024f2-2e62-4ba2-9672-e46c4975fa72">参考</a></li>
</ul>
</div>
</nav>
<ul class="org-ul">
<li>TAGS: <a href="../index.html">Emacs</a></li>
</ul>


<p>
<b>上次修订和导出时间为 2026-01-07 00:53:53 +0800 字数为 69899.</b>
</p>

<p>
Emacs 是一个先进的、可扩展的、可定制的、自记录的编辑器。根据个人经验
我把学习过程分为以下三个阶段：
</p>

<ul class="org-ul">
<li><a href="#原生 emacs">原生 emacs</a> 使用和 <a href="#Org 管理">Org 管理</a> 。 <code>GNU Emacs 手册</code> 、 <code>Org 手册</code></li>
<li>Elisp 编程。 <code>Emacs Lisp 参考手册</code></li>
</ul>
<section id="outline-container-h:47ad94b2-91f9-4f33-a8ff-9f6bb7141cb3" class="outline-2">
<h2 id="h:47ad94b2-91f9-4f33-a8ff-9f6bb7141cb3">作为文本编辑器</h2>
<div class="outline-text-2" id="text-h:47ad94b2-91f9-4f33-a8ff-9f6bb7141cb3">
<p>
编辑器 用来做什么? 编辑文本 写代码 写书 收发邮件 浏览网页 看图片 看视频 …
</p>

<p>
从 编辑文本 开始 : 需要什么?
</p>

<ul class="org-ul">
<li>Move|Jump 移动或跳转 :
<ul class="org-ul">
<li>要在 Buffer中移动 : 字符 单词 行</li>
<li>跳到 不同的 Window中 或 Frame中</li>
</ul></li>
<li>Edit 编辑
<ul class="org-ul">
<li>选中 : 选择需要编辑的部分文本</li>
<li>插入</li>
<li>删除</li>
<li>复制 粘贴 剪切</li>
<li>撤销 重做</li>
<li>处理 : 执行一些特定的功能 如 转换大小写</li>
</ul></li>
<li>Search 搜索</li>
<li>Repeat 重复</li>
<li>Assist
<ul class="org-ul">
<li>Manipulating pairs : smartparens</li>
<li>Narrowing</li>
<li>Folding</li>
</ul></li>
</ul>

<p>
Emacs 是基于文本的 所以 对文本的操作 可以贯穿各种场景 然后根据特定的需要 使用不同的模式 提供更多的功能
</p>
<ul class="org-ul">
<li>主模式
<ul class="org-ul">
<li>Org</li>
<li>Dired</li>
</ul></li>
<li>次要模式
<ul class="org-ul">
<li>abbrew</li>
</ul></li>
</ul>

<p>
再到 我要写代码 建立开发环境 需要什么?
</p>
<ul class="org-ul">
<li>Completion : company</li>
<li>Syntax Checking : flycheck</li>
<li>Format (style, highlight, indent )</li>
<li>Navigation (tag, definition, symbols)</li>
<li>Code Templates &amp; Snippets : yasnippet</li>
<li>Project : progectile, Speedbar</li>
<li>Doc</li>
<li>Enhancement Edit</li>
<li>Assist</li>
<li>Compilation</li>
<li>Debugging</li>
</ul>

<p>
特定的语言 又需要什么?
</p>
<ul class="org-ul">
<li>C</li>
</ul>
</div>
<div id="outline-container-h:0b45f861-a71f-4982-881c-0636c01c0cad" class="outline-3">
<h3 id="h:0b45f861-a71f-4982-881c-0636c01c0cad">快捷键速记</h3>
<div class="outline-text-3" id="text-h:0b45f861-a71f-4982-881c-0636c01c0cad">
<p>
先熟练光标移动：
</p>
<ul class="org-ul">
<li><code>C-a</code> 移至行首</li>
<li><code>C-e</code> 移至行尾</li>
<li><code>M-f</code> 移至单词右边</li>
<li><code>M-b</code> 移至单词左边</li>
<li><code>M-a</code> 句首</li>
<li><code>M-e</code> 句尾</li>
<li><code>C-M-f</code> 向前移动穿过一个平衡表达式</li>
<li><code>C-M-b</code> 向后移动穿过一个平衡表达式</li>
</ul>

<p>
快速定位：
</p>
<ul class="org-ul">
<li><code>C-s</code> 向后查找</li>
<li><code>C-r</code> 向前查找</li>
<li><code>M-g g</code> 跳到特定的行</li>
<li><code>M-&lt;</code> 缓冲区-首</li>
<li><code>M-&gt;</code> 缓冲区-尾</li>
</ul>

<p>
如果感兴趣入门手册里没提到的，可以试试这些键绑定：
</p>
<ul class="org-ul">
<li><code>C-M-@</code> 可以标记成对的特殊的字符内容，如“”内内容</li>
<li><code>C-x h</code> 即mark-whole-buffer 选定全文件</li>
<li><code>M-)</code> 移动到下一个 ) 后，删除它之前的缩进，然后在它之后缩进</li>
<li><code>M-m</code> 到本行第一个非空字符</li>
<li><code>M-^</code> 连接-前后行</li>
<li><code>M-\</code> 删除连续-空格</li>
<li><code>M-SPC</code> 以智能方式操作光标周围的空白。</li>
<li><code>C-x C-t</code> 交换光标所在行和上一行</li>
<li>调字号： 激活使用 C-x C-0 (重置)、 C-x C-= (放大)、 C-x C&#x2013; (缩小) 、 C-x C-+(放大) , 再按放大 + 或者 = 、缩小 -、重置字号 0。</li>
<li>复制一行： <code>M-x duplicate-line</code></li>
<li>执行外部命令： <code>s-L</code> 或者 <code>M-!</code>  或者 <code>M-x shell-command</code></li>
<li>编译模式: 可以运行外部命令，收集外部程序输出，点击可以直接跳到相应位置 <code>M-x compile</code>  执行命令 <code>grep -rn xxxx</code></li>
</ul>
</div>
</div>
<div id="outline-container-h:0c2edd01-dbc7-4c48-992f-d49d70cda097" class="outline-3">
<h3 id="h:0c2edd01-dbc7-4c48-992f-d49d70cda097">移动 &amp; 跳转</h3>
<div class="outline-text-3" id="text-h:0c2edd01-dbc7-4c48-992f-d49d70cda097">
<p>
光标的定位 (屏幕可视范围内)
</p>
</div>
<div id="outline-container-h:591f69fe-8fb8-44ac-8480-461c9e69e93c" class="outline-4">
<h4 id="h:591f69fe-8fb8-44ac-8480-461c9e69e93c">Buffer 缓冲区</h4>
<div class="outline-text-4" id="text-h:591f69fe-8fb8-44ac-8480-461c9e69e93c">

<figure id="orge61f738">
<img src="./images/Snipaste_2023-06-19_00-30-38.png" alt="Snipaste_2023-06-19_00-30-38.png" width="60%">

</figure>
</div>
<div id="outline-container-h:f1c02a9b-3a7a-4dfe-bb7b-8582589e6ebf" class="outline-5">
<h5 id="h:f1c02a9b-3a7a-4dfe-bb7b-8582589e6ebf">左右移动</h5>
<div class="outline-text-5" id="text-h:f1c02a9b-3a7a-4dfe-bb7b-8582589e6ebf">
<ul class="org-ul">
<li>字符左右
<ul class="org-ul">
<li>C-b 字符左(backward-char)</li>
<li>C-f 字符右(forward-char)</li>
</ul></li>

<li>单词左右
<ul class="org-ul">
<li>M-b 单词后(backward-word)
<ul class="org-ul">
<li>M-&lt;left&gt; 单词后(backward-word)</li>
</ul></li>
<li>M-f 单词前(forward-word)
<ul class="org-ul">
<li>M-&lt;right&gt; 单词前(forward-word)</li>
</ul></li>
</ul></li>

<li>行-首|尾
<ul class="org-ul">
<li>C-a 行-首(beginning-of-line)</li>
<li><p>
C-e 行-首(end-of-line)
</p>

<p>
而代码经常是有缩进的，但 <code>C-a</code> 会直接移动到整个行首，并不能直接编辑开头的文字，
这种情况可使用 <code>M-m</code> 来移动到文字的开头。插件 mwim ，避免这个琐碎的小区别。
</p></li>
</ul></li>

<li>句子-首|尾
<ul class="org-ul">
<li>M-a 句子-首(backward-sentence)</li>
<li>M-e 句子-尾(forward-sentence)</li>
</ul></li>

<li>段落-首|尾
<ul class="org-ul">
<li>M-{|} == (backward|forward)-paragraph</li>
</ul></li>

<li>环境-首|尾
<ul class="org-ul">
<li>C-M-{a|e} {beginning|end}-of-defun  和段落-首尾一样效果</li>
</ul></li>

<li>到本行第一个非空字符
<ul class="org-ul">
<li>M-m == back-to-indentation</li>
</ul></li>

<li><a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-by-Parens.html#index-forward_002dlist">括号结构中的移动</a>
<ul class="org-ul">
<li>C-M-{n|p|u|d}, 即 forward-list|backward-list|backward-up-list|down-list  向 {前|后|上|下} 移动超过括号组 forward-list）。</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:9c42fa26-8f2c-4bf1-afad-ec21b4b59f40" class="outline-5">
<h5 id="h:9c42fa26-8f2c-4bf1-afad-ec21b4b59f40">上下移动</h5>
<div class="outline-text-5" id="text-h:9c42fa26-8f2c-4bf1-afad-ec21b4b59f40">
<ul class="org-ul">
<li>上|下
<ul class="org-ul">
<li>C-p|n == (previous|next)-line</li>
</ul></li>

<li>翻页-上|下
<ul class="org-ul">
<li><p>
M|C-v == PgUp|PgDn | scroll-(up|down)-command
</p>

<p>
但 Emacs 会保留三行不会被翻过去，这样看起来更为舒服。
</p></li>
</ul></li>

<li>缓冲区-首|尾
<ul class="org-ul">
<li><p>
M-&lt;|&gt; == (beginning|end)-of-buffer
</p>

<p>
注意这里需要同时按下 Meta 键、 Shift 键和逗号/句号键。
</p></li>
</ul></li>

<li>移动页
<ul class="org-ul">
<li><p>
C-l
</p>

<p>
第一次按光标所在行在窗口中央，之后再按窗口最上面、窗口最下面，如此循环。
</p></li>
</ul></li>

<li>当前缓冲区可视区域-(Top|Center|Bottom)
<ul class="org-ul">
<li><p>
M-r == move-to-window-line-top-bottom
</p>

<p>
按第一次——光标移动到窗口中间行；接着按第二次——光标移动到窗口最上面一行；接着按第三次——光标移动到窗口最下面一行
</p></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:53c17808-09fd-42b4-99a6-f8d9ef6dfb1e" class="outline-5">
<h5 id="h:53c17808-09fd-42b4-99a6-f8d9ef6dfb1e">跳转</h5>
<div class="outline-text-5" id="text-h:53c17808-09fd-42b4-99a6-f8d9ef6dfb1e">
<ul class="org-ul">
<li>N-行
<ul class="org-ul">
<li><p>
M-g (g|M-g) == goto-line
</p>

<p>
跳到特定的行， <code>M-g M-g +加行号</code> 回车即可
</p></li>
</ul></li>

<li><p>
函数定义跳转 <code>M-.</code>  再使用 <code>M-,</code> 跳回原来位置
</p>

<p>
如果是指向的是C语言的源代码，需要从官网下载源代码，添加src路径
</p>

<p>
<a href="http://gnu.mirrors.hoobly.com/emacs/">http://gnu.mirrors.hoobly.com/emacs/</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> find-function-C-source-directory <span style="color: #8b2252;">"~/emacs-27.2/src"</span>)
</pre>
</div>

<p>
包含Lisp代码的文件习惯上被称为`库`
</p></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:fc147951-6c13-4229-a622-b3b4e52ece34" class="outline-4">
<h4 id="h:fc147951-6c13-4229-a622-b3b4e52ece34">Window 窗口</h4>
<div class="outline-text-4" id="text-h:fc147951-6c13-4229-a622-b3b4e52ece34">
<ul class="org-ul">
<li>跳转 C-x o == other-window</li>
</ul>
</div>
</div>
<div id="outline-container-h:9707c29e-27b7-4fb6-aa81-dea75c457473" class="outline-4">
<h4 id="h:9707c29e-27b7-4fb6-aa81-dea75c457473">Frame 框架</h4>
<div class="outline-text-4" id="text-h:9707c29e-27b7-4fb6-aa81-dea75c457473">
<ul class="org-ul">
<li>M-x select-frame-by-name</li>
</ul>

<p>
插件
</p>
<ul class="org-ul">
<li>Wind Move
<ul class="org-ul">
<li>M-x windmove-(left|right|up|down)</li>
</ul></li>
<li>Ace Window
<ul class="org-ul">
<li>M-x ace-window (Me: == S-o)</li>
</ul></li>
<li>Avy
<ul class="org-ul">
<li>M-x avy-goto-(char|word-1|line)</li>
</ul></li>
</ul>

<p>
补充
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622; sentence-end &#21487;&#20197;&#35782;&#21035;&#20013;&#25991;&#26631;&#28857;</span>
(<span style="color: #a020f0;">setq</span> sentence-end
      <span style="color: #8b2252;">"</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[&#12290;&#65281;&#65311;]</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">&#8230;&#8230;</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">[.?!][]\"')}]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">$</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">[ \t]</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t\n]*"</span>)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:55b331ce-48ce-4cfc-9ff7-b624f4d05212" class="outline-3">
<h3 id="h:55b331ce-48ce-4cfc-9ff7-b624f4d05212">文本编辑</h3>
<div class="outline-text-3" id="text-h:55b331ce-48ce-4cfc-9ff7-b624f4d05212">
<ul class="org-ul">
<li>选中 (标记) : 选择需要编辑的部分文本</li>
<li>插入</li>
<li>删除 剪切 复制 粘贴</li>
<li>撤销 重做</li>
<li>处理 : 执行一些特定的功能 如 转换大小写</li>
<li>特性 : 矩形区块</li>
</ul>
</div>
<div id="outline-container-h:bcf530e5-4eeb-4cba-97e4-0996fc689d9c" class="outline-4">
<h4 id="h:bcf530e5-4eeb-4cba-97e4-0996fc689d9c">Mark 标记</h4>
<div class="outline-text-4" id="text-h:bcf530e5-4eeb-4cba-97e4-0996fc689d9c">
<p>
速记-选中区域
</p>
<pre class="example" id="orge92d4e2">
方法1：拉去鼠标左键
方法2：Shift + 方向键
方法3：左键点击标记位置，右键点击光标位置
方法4：
1. 激活标记：C-@ 或者 C-空格
2. 用方向键/Emacs快捷键移动光标  或者 C-n 向下移动光标

C-x C-x 交换标记和光标的位置
</pre>

<p>
<b>选中 需要编辑的部分文本</b>
</p>

<ul class="org-ul">
<li>标记
<ul class="org-ul">
<li><p>
点
</p>
<ul class="org-ul">
<li><p>
C-(&lt;SPC&gt;|@) == set-mark-command (激活)
</p>

<p>
在 emacs 中一个区域的范围是由2个点决定的。第一个点是标记(mark)，
任何在标记和光标之间的东西都是区域的一部分。在状态栏下面的
minibuffer中会有提示信息"Mark set" 。即使这个区域的高亮消失了，
那个标记还会存在在那里，还是能对标记和光标之间的内容进行操作。
</p>

<p>
C-g 取消标记。对于很多场景下C-SPC 快捷键被占用（输入法，Spotlight 等）
</p></li>

<li>C-@ C-@ (不激活 但进入标记环)</li>
</ul>

<p>
光标移动到别的位置（甚至以后学过之后，到别的文件），这时候按下 C-x C-SPC 或 C-u C-SPC，即可立刻跳转回刚刚的位置
</p></li>

<li><p>
段落
</p>
<ul class="org-ul">
<li>M-h == mark-paragraph</li>
</ul>

<p>
说明：在不同模式下段落的范围不一样
</p></li>

<li>缓冲区
<ul class="org-ul">
<li>C-x h == mark-whole-buffer</li>
</ul></li>
<li>Mouse shift-selection
<ul class="org-ul">
<li>Shift-&lt;Mouse&gt;</li>
</ul></li>
</ul></li>

<li>标记环 (Mark Ring : 标记的点 进入 标记环) [Global|Local]
<ul class="org-ul">
<li>最后标记点
<ul class="org-ul">
<li>C-u C-@ (当前缓冲)</li>
<li>C-x C-@ == pop-global-mark</li>
</ul></li>
<li>列表</li>
</ul></li>

<li>互换位置-插入点和标记点
<ul class="org-ul">
<li>C-x C-x == exchange-point-and-mark</li>
</ul></li>
</ul>

<p>
一些系统对有些键位会做映射。例如 macOS 就会将 C-/ 映射为 C-_ ， C-SPC 映射为 C-@。不影响日常使用，但是想覆盖键位时需要注意。
</p>


<p>
<b>Special</b>
</p>

<ul class="org-ul">
<li>标记 表达式 
<ul class="org-ul">
<li>C-M-@ == mark-sexp 可以标记成对的特殊的字符内容，如“”内内容</li>
</ul></li>
<li>标记 定义
<ul class="org-ul">
<li>C-M-h == mark-defun</li>
</ul></li>
</ul>

<p>
范例：选定全文件
</p>
<ul class="org-ul">
<li>方法1：
<ul class="org-ul">
<li>M-&lt; 跳到文件头</li>
<li>C-@ 设定标记</li>
<li>M-&gt; 跳到文件尾</li>
</ul></li>
<li>方法2：
<ul class="org-ul">
<li>C-x h 即mark-whole-buffer</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:d5fb0d7f-61f9-4008-bedb-74619ea1379d" class="outline-4">
<h4 id="h:d5fb0d7f-61f9-4008-bedb-74619ea1379d">Insert 插入</h4>
<div class="outline-text-4" id="text-h:d5fb0d7f-61f9-4008-bedb-74619ea1379d">
<p>
input输入
</p>

<ul class="org-ul">
<li>可见的(图形字符):  a..z , 1..0, !..?</li>
<li>控制字符: &lt;SPC&gt;, &lt;RET&gt;, &lt;TAB&gt;, &lt;DEL&gt;, &lt;ESC&gt;, &lt;F1&gt;, &lt;Home&gt;, &lt;LEFT&gt;
<ul class="org-ul">
<li><p>
插入空白行: &lt;RET&gt; | C-j | C-o 
</p>

<p>
在光标所在行下方创建一个新的空行： <code>C-o</code> ；将光标所在前后所有连续空行变为一个空行： <code>C-x C-o</code> 。
</p></li>
</ul></li>

<li>修饰键: &lt;Control&gt;, &lt;META&gt;</li>
<li>输入 对应 命令</li>
<li>非键盘: mouse(鼠标) (一般作为定位 特殊模式 拖拽绘制字符)</li>
<li>引用插入（输入一些看不见的字符）
<ul class="org-ul">
<li>C-q == quoted-insert</li>
<li>不可见(非图形字符)
<ul class="org-ul">
<li>&lt;Ret&gt;, C-l(分页符)</li>
<li>033 Enter (Ascii 八进制) = f(原样输出f)</li>
</ul></li>
</ul></li>
<li>Unicode
<ul class="org-ul">
<li>C-x 8 RET</li>
<li>速记 : C-x 8 C-h £</li>
<li>∑ (2211) ⤶ (2936)</li>
</ul></li>
</ul>

<p>
拓展
</p>

<p>
Input Method 输入法
</p>
<ul class="org-ul">
<li>内置
<ul class="org-ul">
<li>触发 : toggle-input-medthod == C-\</li>
<li>切换 : select-input-medthod == C-u C-\ | C-x Ret C-\</li>
<li><p>
范例：Tex α x₃ X³
</p>
<div class="org-src-container">
<pre class="src src-shell">\alpha &#945;  \Gamma &#915;
\rightarrow &#8594;  \Leftarrow &#8656; 
\oplus &#8853;  \int &#8747;
x_3 x&#8323;  v^x v&#739;
</pre>
</div></li>

<li><p>
范例：greek-babel αΑ Γγ η
</p>
<div class="org-src-container">
<pre class="src src-shell">&#913;&#945; &#914;&#946; &#915;&#947; &#916;&#948; &#917;&#949; &#918;&#950;  &#919;&#951; &#920;&#952; &#921;&#953; &#922;&#954; &#923;&#955; &#924;&#956; 
Aa Bb Gg Dd Ee Zz  Hh Jj Ii Kk Ll Mm 

&#925;&#957; &#926;&#958; &#927;&#959; &#928;&#960; &#929;&#961; &#931;&#963;&#962; &#932;&#964; &#933;&#965; &#934;&#966; &#935;&#967; &#936;&#968; &#937;&#969;
Nn Xx Oo Pp Rr Ssc Tt Uu Ff Qq Yy Ww
</pre>
</div></li>
</ul></li>

<li>使用操作系统的 输入法 或 其它工具</li>

<li><p>
Abbrev mode缩写模式
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21035;&#21517;</span>
(<span style="color: #a020f0;">setq-default</span> abbrev-mode t)
(define-abbrev-table 'global-abbrev-table '(
                        <span style="color: #b22222;">;; </span><span style="color: #b22222;">signature</span>
                        (<span style="color: #8b2252;">"8jv"</span> <span style="color: #8b2252;">"jaspervincent"</span>)
                        <span style="color: #b22222;">;; </span><span style="color: #b22222;">Microsoft</span>
                        (<span style="color: #8b2252;">"8ms"</span> <span style="color: #8b2252;">"Microsoft"</span>)
                        ))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36755;&#20837;8jv&#31354;&#26684;&#65292;&#23601;&#34917;&#20840;&#20986;jaspervincent  &#31354;&#26684;&#20063;&#21487;&#20197;&#25442;&#25104;&#38750;26&#20010;&#23383;&#27597;</span>
</pre>
</div></li>

<li>来源 : 文件 | 其它缓冲
<ul class="org-ul">
<li>C-x i == insert-file</li>
<li>insert-buffer</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:1938c7af-172c-4a5a-af02-980b43618c2d" class="outline-4">
<h4 id="h:1938c7af-172c-4a5a-af02-980b43618c2d">删除 剪切 复制 粘贴</h4>
<div class="outline-text-4" id="text-h:1938c7af-172c-4a5a-af02-980b43618c2d">
<p>
速记
</p>
<pre class="example" id="org7a68d84">
C-w 剪切
M-w 复制
C-y 粘贴
M-y 从剪贴析中选择

C-k 剪切光标到行末
C-S-&lt;backspace&gt; 剪切光标所在行  S 为Shitf 键。等同于 C-a C-k C-k
用 C-k 和 C-S-&lt;backspace&gt;删除的内容会保留在剪贴板中，可以用C-y/M-y进行粘贴

单词操作:
- &lt;backspace&gt;：向左删除字符
- C-&lt;backspace&gt;：向左删除单词(保存到剪贴板)
- C-d/Delete：向右删除字符
- Alt-d：向右删除单词(保存到剪贴板)
</pre>

<p>
<b>删除(delete) |剪切(kill)</b>
</p>

<p>
区别 : kill 会把kill掉内容放到 kill ring 里
</p>

<p>
注意，这里有“删除”和“移除“两种说法，”删除“对应于 "delete"，是真的删除，而“移除”对应于 "kill"，相当于“剪切”，之后可以再次插入到其它位置，即 "insert"，相当于粘贴。
</p>


<ul class="org-ul">
<li>删除(delete) | 剪切(kill)
<ul class="org-ul">
<li>区别 : kill 会把kill掉内容放到 kill ring 里。</li>
<li>注意，这里有“删除”和“移除“两种说法，”删除“对应于 "delete"，是真的删除，而“移除”对应于 "kill"，相当于“剪切”，之后可以再次插入到其它位置，即 "insert"，相当于粘贴。</li>
<li>字符|词 - 左|右
<ul class="org-ul">
<li>delete-backward-char == &lt;Del&gt;</li>
<li>delete-char == C-d</li>
<li>按下删除键（在 Emacs 中删除键写为 &lt;backspace&gt; ）即可删掉光标左侧的字符。如果想要删掉右侧的字符，就按下 C-d 键</li>
<li>&#x2014;</li>
<li>backward-kill-word == (C|M)-&lt;Del&gt; 移除光标左侧一整个词</li>
<li>kill-word == M-d 移除光标右边一整个词</li>
</ul></li>
<li>行 - 右|左|整行
<ul class="org-ul">
<li>右: kill-line == C-k 移除右侧直到行结尾</li>
<li>左: C-u 0 C-k 或者 M-0 C-k</li>
<li>整: kill-whole-line  == C-S-&lt;backspace&gt; 剪切光标所在行  S 为Shitf 键。等同于 C-a C-k C-k</li>
</ul></li>
<li>句
<ul class="org-ul">
<li>kill-sentence == M-k 移除右侧直到句子结尾</li>
<li>backward-kill-sentence == C-x &lt;DEL&gt;</li>
</ul></li>
<li><p>
区域
</p>
<ul class="org-ul">
<li>kill-region == C-w  (-&gt; <a href="https://github.com/purcell/whole-line-or-region/blob/master/whole-line-or-region.el">whole-line-or-region</a>)</li>
</ul>
<p>
先用C-@开始标记区域
</p></li>
</ul></li>
<li>复制-区域
<ul class="org-ul">
<li>kill-ring-save == M-w (-&gt; <a href="https://github.com/purcell/whole-line-or-region/blob/master/whole-line-or-region.el">whole-line-or-region</a>)</li>
</ul></li>
<li>粘贴 (从 Kill ring (剪切环))
<ul class="org-ul">
<li>最近一个: yank == C-y</li>
<li>yank-pop == M-y 在C-y之后使用,不断往上追溯替换粘贴的内容。</li>
<li>指定位置: (C-u|M-) [Num] C-y</li>
</ul></li>
</ul>


<p>
Emacs 内部维护了一个环形“剪贴板历史”，当你想插入之前移除的内容时（即
粘贴之前剪切的内容），按下 <code>C-y</code> ，这被称为 "yank"，它会将最近一次移除
的内容插入回来。那么如何粘贴历史记录呢？在一次 "yank" 的基础上，再按
<code>M-y</code> ，就可以得到倒数第二次移除的内容，再按一次 <code>M-y</code> 即可得到倒数第
三次移除的内容，以此类推。插件 counsel 辅助这个过程。
</p>

<p>
<a href="https://github.com/purcell/whole-line-or-region/blob/master/whole-line-or-region.el">whole-line-or-region</a>
</p>


<p>
范例：剪切3行的三种方法
</p>
<ul class="org-ul">
<li>方法1：C-a (至行首)，C-空格 (标记)，
<ul class="org-ul">
<li>C-n, C-n, C-e (移动光标)，</li>
<li>C-w 剪切区域</li>
</ul></li>
<li>方法2：C-a (至行首)，连续按 C-k</li>
<li>方法3：连续按 C-S-&lt;backspace&gt;</li>
</ul>

<p>
Special
</p>
<ul class="org-ul">
<li>表达式 (exp) "exp" exp
<ul class="org-ul">
<li>C-M-k == kill-sexp 不同模式不一样</li>
</ul></li>
</ul>

<p>
其他
</p>
<ul class="org-ul">
<li>删除到字符之前
<ul class="org-ul">
<li>右: M-z [char] == zap-to-char</li>
<li>左: M– M-z</li>
</ul></li>
<li>删除连续-空格
<ul class="org-ul">
<li>delete-horizontal-space == M-\</li>
</ul></li>
<li>删除空白行 (位置相关: 一个到无 | 多个到一个 | 跟随的全部)
<ul class="org-ul">
<li>delete-blank-lines == C-x C-o</li>
</ul></li>
<li>删除重复行
<ul class="org-ul">
<li>delete-duplicate-lines (keeps first)
<ul class="org-ul">
<li>C-u : keeps last</li>
<li>C-u C-u : only adjacent lines (邻近)</li>
<li>C-u C-u C-u : retains repeated blank lines 保留重复的空白行</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:4b4fe1aa-35d3-4039-a69e-8e9c124e3ac5" class="outline-4">
<h4 id="h:4b4fe1aa-35d3-4039-a69e-8e9c124e3ac5">Undo/Redo 撤销 重做</h4>
<div class="outline-text-4" id="text-h:4b4fe1aa-35d3-4039-a69e-8e9c124e3ac5">
<p>
速记：
</p>
<div class="org-src-container">
<pre class="src src-sh">C-g &#20013;&#26029;&#24403;&#21069;&#21629;&#20196;
C-/ &#25764;&#28040;

&#24674;&#22797;&#30340;&#35805;&#38656;&#35201;&#25764;&#28040;&#25105;&#20204;&#30340;&#25764;&#28040;&#65306;
- &#20013;&#26029;&#25764;&#28040;&#65306;&#22914;&#25353;&#19968;&#19979;&#31354;&#26684;&#20013;&#26029;&#25764;&#28040;
- C-/ &#23601;&#20250;&#26159;&#25764;&#28040;&#20043;&#21069;&#25764;&#28040;
</pre>
</div>

<ul class="org-ul">
<li>撤销/重做
<ul class="org-ul">
<li>Undo: undo == C-/ 或者 C-_ 或者 C-x u 
<ul class="org-ul">
<li>撤销刚刚的操作。对字符进行编辑例外，例如你按了 5 次删除键删除了 5 个字符，按一下撤销即可复原。</li>
<li>C-x z 重复之前的操作 重复多次可以只按zzzz</li>
</ul></li>
<li>Redo 反撤销: C-g C-/ 或者 C-g C-_ 或者 C-g C-x u</li>
</ul></li>
</ul>

<p>
Emacs 对于历史记录也维护成了一个环。但 Emacs 并没有直接的重做操作，而是先按一下 C-g ，即没有操作，此时再按撤销键时，会撤销上次的“撤销”，相当于重做；也可以理解为按下 C-g 后这个环的移动方向会改变。所以 Emacs 其实不分 undo 和 redo，而是靠改变历史记录的移动方向来控制。
</p>

<p>
redo 的思维就是 “undo undo”.
</p>

<p>
拓展
</p>
<ul class="org-ul">
<li>undo-tree 撤销树插件</li>
</ul>
</div>
</div>
<div id="outline-container-h:fde9b04a-5287-477e-87e4-0047169d80e7" class="outline-4">
<h4 id="h:fde9b04a-5287-477e-87e4-0047169d80e7">Multiple 多重</h4>
<div class="outline-text-4" id="text-h:fde9b04a-5287-477e-87e4-0047169d80e7">
<p>
<b>1.rectangle 矩阵编辑</b>
</p>

<p>
参考：
</p>
<ul class="org-ul">
<li>官方参考：<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles.html">https://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles.html</a></li>
<li>博客：<a href="http://www.langdebuqing.com/emacs%20notebook/emacs%20%E5%A4%9A%E8%A1%8C%E7%BC%96%E8%BE%91.html">http://www.langdebuqing.com/emacs%20notebook/emacs%20%E5%A4%9A%E8%A1%8C%E7%BC%96%E8%BE%91.html</a></li>
<li>Emacs Rocks!关于矩阵操作的视频：<a href="http://emacsrocks.com/e01.html">http://emacsrocks.com/e01.html</a></li>
</ul>

<p>
在开始进行矩阵编辑之前, 首先要标记所要编辑的矩阵. 矩阵的选择, 是指两个对角的点所在的范围里.
</p>

<p>
在矩阵编辑中, 所有的指令, 都是以 <code>C-x r</code> 开头的.
</p>

<p>
矩阵的选择
</p>

<ol class="org-ol">
<li>标记对角的起点. [C-@]</li>
<li>标记对角的终点. [移动光标到对角的另一点的位置即可]</li>

<li>rectangle 矩形区块
<ul class="org-ul">
<li>插入
<ul class="org-ul">
<li>空格: open-rectangle == C-x r o</li>
<li>字符串: M-x string-insert-rectangle</li>
<li>行号: rectangle-number-lines == C-x r N
<ul class="org-ul">
<li>为矩阵内的每一行,添加行数数字。行数, 是以所选择的内容为起始数字, 第一行为1.</li>
<li>C-u C-x r N : 设置开始的行号和格式化
<ul class="org-ul">
<li>如，选中区域行号从2开始，行号前留5个字符空格。"Number to count from (default 1): 2"，"Format string: %5d "</li>
</ul></li>
</ul></li>
</ul></li>
<li>替代
<ul class="org-ul">
<li>空格: clear-rectangle == C-x r c</li>
<li>字符串: string-rectangle == C-x r t</li>
</ul></li>
<li>删除
<ul class="org-ul">
<li>delete-rectangle == C-x r d</li>
<li>空格: M-x delete-whitespace-rectangle</li>
</ul></li>
<li>剪切 | 复制 | 粘贴
<ul class="org-ul">
<li>C-x r k == kill-rectangle</li>
<li>C-x r M-w == copy-rectangle-as-kill</li>
<li>C-x r y == yank-rectangle 从光标位置向下粘贴</li>
</ul></li>
</ul></li>
</ol>


<p>
示例一：添加多行注释
</p>

<p>
先按快捷键 <code>Ctrl-Space</code> 进入选中模式，选中一个区域，再按快捷键 <code>C-x r t</code> ，然后输入 <code>;; RET</code>
</p>

<p>
<img src="./images/emacs-rectangle.gif" alt="emacs-rectangle.gif">]]
</p>

<p>
将to改为大写：使用 <code>C-s</code> 搜索关键词如 <code>to</code> ，再按快捷键 <code>C-x r t</code> ，然后输入 <code>TO RET</code> 。
</p>

<p>
示例二：删除多行注释
先按快捷键 <code>Ctrl-Space</code> 进入多行编辑模式，选中一个区域，再按快捷键 <code>C-x r k</code>
</p>

<p>
<img src="./images/emacs-rectangle2.gif" alt="emacs-rectangle2.gif">]]
</p>

<p>
<b>2.CUA 块的编辑</b>
</p>

<p>
有时候比矩阵编辑更方便
</p>

<p>
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/CUA-Bindings.html">https://www.gnu.org/software/emacs/manual/html_node/emacs/CUA-Bindings.html</a>
</p>

<pre class="example" id="orgea8ddf7">
开启块编辑  M-x cua-mode
定义块 C-RET cua-set-rectangle-mark，后面方向键或快捷键选区域
取消、结束 C-c
复制 M-m cua-copy-rectangle-as-text
剪切 M-k cua-cut-rectangle-as-text
粘贴 C-x r y == yank-rectangle  从光标位置向下粘贴
加编号 M-n cua-sequence-rectangle   开始数字、步长、格式(%d. )
</pre>

<p>
后面用ivy插件可弃用这个了。
</p>

<p>
<b>2.Keyboard Macro 键盘宏编辑</b>
</p>

<p>
定义: 所谓宏，就是一些命令组织在一起，作为一个单独命令完成一个特定任务.
</p>

<p>
这样可以做一些重复性工作
</p>

<p>
宏操作
</p>

<ul class="org-ul">
<li>开始|结束
<ul class="org-ul">
<li><code>(start|end)-kbd-macro == C-x (|) 或者 &lt;F3&gt;|&lt;F4&gt;</code>
<ul class="org-ul">
<li>一般使用`F3|F4` : 开始|结束定义一个键盘操作宏.</li>
</ul></li>
<li>追加: <code>C-u C-x (</code></li>
</ul></li>
<li>终止
<ul class="org-ul">
<li>C-g == keyboard-quit</li>
</ul></li>
<li>执行
<ul class="org-ul">
<li>C-x e == kmacro-end-and-call-macro 或者 F4 : 执行键盘宏
<ul class="org-ul">
<li>C-u 37 C-x e : 重复执行37次该宏</li>
</ul></li>
<li>M-x call-last-kbd-macro</li>
</ul></li>
</ul>


<p>
范例：重复写入hello world
</p>
<ul class="org-ul">
<li><code>C-x (</code> 输入hello world 回车</li>
<li><code>C-x )</code> 结束定义</li>
<li><code>C-x e</code> 执行键盘宏</li>

<li>保存解盘宏
<ul class="org-ul">
<li><code>M-x kmacro-name-last-macro</code> 回车 宏名字 ： 给宏起一个名字</li>
<li>M-x insert-kbd-macro RET 宏名字 RET： 插入指定名字的宏</li>
<li>M-x &lt;name&gt; 执行自定义宏</li>
</ul></li>
<li>编辑最近一次的录制好的宏
<ul class="org-ul">
<li><code>C-x C-k C-e</code> 或者 <code>kmacro-edit-macro</code></li>
</ul></li>
<li>编辑指定名字的宏
<ul class="org-ul">
<li><code>C-x C-k e 宏名字 RET</code> 或者 <code>edit-kbd-macro</code></li>
</ul></li>
</ul>

<p>
参考：
</p>
<ul class="org-ul">
<li>Emacs manual on macros：<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macros.html#Keyboard-Macros">https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macros.html#Keyboard-Macros</a>)</li>
<li>Xah Lee 博客 Emacs: Keyboard Macro：<a href="http://xahlee.info/emacs/emacs/emacs_macro_example.html">http://xahlee.info/emacs/emacs/emacs_macro_example.html</a></li>
<li><a href="http://emacs-fu.blogspot.com/2010/07/keyboard-macros.html">http://emacs-fu.blogspot.com/2010/07/keyboard-macros.html</a></li>
</ul>

<p>
拓展
</p>
<ul class="org-ul">
<li>multiple-cursors 多光标插件</li>
</ul>
</div>
</div>
<div id="outline-container-h:5541d898-6743-4585-abcb-d997038c741d" class="outline-4">
<h4 id="h:5541d898-6743-4585-abcb-d997038c741d">其它</h4>
<div class="outline-text-4" id="text-h:5541d898-6743-4585-abcb-d997038c741d">
<ul class="org-ul">
<li>缩进
<ul class="org-ul">
<li>按上一行的格式: indent-region = M-C-\ = &lt;Tab&gt;</li>
<li>区域: indent-rigidly = C-x &lt;Tab&gt; = C-x C-i   再按左右方向键缩进</li>
</ul></li>

<li>行操作
<ul class="org-ul">
<li>新行
<ul class="org-ul">
<li>open-line == C-o</li>
<li>newline-and-maybe-indent == C-j   新行且有缩进效果，但lisp-interaction-mode 中除外，因为被解释成eval并输出结果</li>
</ul></li>
<li>分割
<ul class="org-ul">
<li>split-line == M-C-o</li>
</ul></li>
<li>连接-前|后行
<ul class="org-ul">
<li>delete-indentation == M-^ (反向: C-u ..)</li>
</ul></li>
<li>将光标所在前后所有连续空行变为一个空行
<ul class="org-ul">
<li>delete-blank-lines == C-x C-o</li>
</ul></li>
</ul></li>

<li>调换-前|后
<ul class="org-ul">
<li>交换光标左右的字符： transpose-chars, C-t；</li>
<li>交换光标前后的词： transpose-words, M-t；</li>
<li>交换光标所在行和上一行：C-x C-t。</li>
<li>还有交换句子、段落、选择区域等，但没有快捷键，详见<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Transpose.html">文档</a>。</li>
</ul></li>

<li>转换-大小写
<ul class="org-ul">
<li>(capitalize|uppercase|downcase)-word == M-(c|u|l) (反向: M– ..)  首字母大写|整个词大写|整个词小写</li>
<li>(upcase|downcase)-region == C-x C-(u|l)   区域的大小写</li>
</ul></li>

<li>调字号： 激活使用 C-x C-0 (重置)、 C-x C-= (放大)、 C-x C&#x2013; (缩小) 、 C-x C-+(放大) , 再按放大 + 或者 = 、缩小 -、重置字号 0。</li>

<li>文本编辑之注释
<ul class="org-ul">
<li><code>C-x C-;</code></li>
<li><code>M-;</code></li>
</ul></li>
</ul>
</div>
<div id="outline-container-h:5bd95c5e-7fdd-423b-a7ba-da315d234a66" class="outline-5">
<h5 id="h:5bd95c5e-7fdd-423b-a7ba-da315d234a66">限制每行宽度，方便折行</h5>
<div class="outline-text-5" id="text-h:5bd95c5e-7fdd-423b-a7ba-da315d234a66">
<p>
<b>一行转换为多行：</b>
</p>

<p>
参考 ：<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Fill-Commands.html">https://www.gnu.org/software/emacs/manual/html_node/emacs/Fill-Commands.html</a>
</p>

<p>
需要执行填充模式中的函数来实现。填充模式中默认行宽为 70。可以修改变量
控制行宽。 <code>(setq-default fill-column 80)</code> 或 <code>M-x set-fill-column RET</code>
</p>


<p>
任选一种方法实现：
</p>

<ul class="org-ul">
<li>不要写那么长。</li>
<li>写完后用 <code>M-x fill-region</code> 或 <code>M-x fill-paragraph</code> <code>M-q</code> 重排一下。</li>
<li>启用 <code>M-x display-fill-column-indicator-mode</code> ，显示参考线。PS: 对英
语效果友好。</li>
<li>启用 whitespace-mode 并设置，给超过宽度的内容显示刺眼的背景。</li>
<li>如果你控制不了自己的手，还是写很长，就让编辑器帮你断行：启用 auto-fill-mode。</li>
</ul>


<p>
<b>将多行转换为一行:</b>
</p>

<ul class="org-ul">
<li>通过 <code>M-h</code> 选中段落，或者 <code>C-@</code> 选中要合并的多行后，按下 <code>M-^</code> ，即
可转换为一行</li>
</ul>
</div>
</div>
<div id="outline-container-h:07fbd30c-a7b4-49ca-9028-a271825bc47f" class="outline-5">
<h5 id="h:07fbd30c-a7b4-49ca-9028-a271825bc47f">align 对齐</h5>
<div class="outline-text-5" id="text-h:07fbd30c-a7b4-49ca-9028-a271825bc47f">
<ul class="org-ul">
<li>align (align-rules-list)</li>
<li>align-(current|entire|newline-and-indent)</li>
<li>align-regexp (C-u ..)</li>
</ul>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#25353;&#25324;&#21495;&#23545;&#40784;&#65292;&#31532;&#19968;&#20010;&#20986;&#29616;&#30340;&#25324;&#21495;&#23545;&#40784;</span>
&#36873;&#20013;&#21306;&#22495;&#65292;M-x align-regexp &#36755;&#20837; (
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25152;&#26377;&#25324;&#21495;&#23545;&#40784;</span>
&#36873;&#20013;&#21306;&#22495;&#65292;C-u M-x align-regexp &#36755;&#20837; &#31354;&#26684;
</pre>
</div>

<p>
插件：
</p>
<ul class="org-ul">
<li><a href="https://github.com/mkcms/interactive-align">ialign</a> 可视化，效果直接显示出来</li>
</ul>
</div>
</div>
<div id="outline-container-h:00f1c65b-6bcf-4f34-9518-03a5c978e5fe" class="outline-5">
<h5 id="h:00f1c65b-6bcf-4f34-9518-03a5c978e5fe">sort 排序</h5>
<div class="outline-text-5" id="text-h:00f1c65b-6bcf-4f34-9518-03a5c978e5fe">
<ul class="org-ul">
<li>按-行|列|段|页
<ul class="org-ul">
<li>sort-(lines|columns|paragraph|pages) 
<ul class="org-ul">
<li>paragraph &lt;- paragraph-start, paragraph-separate</li>
<li>反序: C-u ..</li>
</ul></li>
</ul></li>
<li>sort-numeric-fields     (base: sort-numeric-base) 按数字排序</li>
<li>sort-fields (第几字段: C-u [N] | M-[N])</li>
<li>正则表达式 : sort-regexp-fields
<ul class="org-ul">
<li>word : (\w) \1</li>
<li>words : (\w+) \1</li>
</ul></li>
<li>反序
<ul class="org-ul">
<li>M-x reverse-region</li>
</ul></li>
<li>忽略大小写 : sort-fold-case = t</li>
</ul>


<p>
范例-排序sort-lines
</p>
<div class="org-src-container">
<pre class="src src-text">1
2
4
9
3
5
</pre>
</div>
<p>
选中， <code>M-x sort-lines</code>
</p>
</div>
</div>
<div id="outline-container-h:612f9b3a-00fe-41e0-9171-876d2bde7124" class="outline-5">
<h5 id="h:612f9b3a-00fe-41e0-9171-876d2bde7124">Narrowing缩小编辑</h5>
<div class="outline-text-5" id="text-h:612f9b3a-00fe-41e0-9171-876d2bde7124">
<ul class="org-ul">
<li>Narrowing : 当前缓冲 进入部分编辑 不影响缓冲其它部分 
<ul class="org-ul">
<li>进入: narrow-to-(region|page|defun) == C-x n (n|p|d)
<ul class="org-ul">
<li>org-narrow-to-(subtree|block|element) == C-x n (s|b|e)</li>
</ul></li>
<li>退出: widen == C-x n w</li>
</ul></li>
</ul>

<p>
上面的并不高效，可以添加如下配置
</p>

<ul class="org-ul">
<li>参考 <a href="https://endlessparentheses.com/emacs-narrow-or-widen-dwim.html">https://endlessparentheses.com/emacs-narrow-or-widen-dwim.html</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32553;&#23567;&#32534;&#36753;&#21306;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">narrow-or-widen-dwim</span> (p)
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (<span style="color: #a020f0;">declare</span> (interactive-only))
  (<span style="color: #a020f0;">cond</span> ((<span style="color: #a020f0;">and</span> (buffer-narrowed-p) (not p)) (widen))
        ((region-active-p) (narrow-to-region (region-beginning) (region-end)))
        ((derived-mode-p 'org-mode)
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">`</span><span style="color: #008b8b;">org-edit-src-code</span><span style="color: #b22222;">' is not a real narrowing</span>
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">command. Remove this first conditional if</span>
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">you don't want it.</span>
         (<span style="color: #a020f0;">cond</span> ((<span style="color: #a020f0;">ignore-errors</span> (org-edit-src-code))
                (delete-other-windows))
               ((org-at-block-p) (org-narrow-to-block))
               (t (org-narrow-to-subtree))))
        (t (narrow-to-defun))))
(define-key ctl-x-map <span style="color: #8b2252;">"n"</span> #'narrow-or-widen-dwim)
</pre>
</div>

<p>
这样使用 <code>C-x n</code> 就可以切换缩小和恢复操作了
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">init.el&#28155;&#21152;&#20102;&#22914;&#19979;&#20869;&#23481;</span>
(put 'narrow-to-region 'disabled nil)
(put 'narrow-to-page 'disabled nil)
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-h:7fef27f0-cd34-4881-88dd-8b5ecc8b4a72" class="outline-3">
<h3 id="h:7fef27f0-cd34-4881-88dd-8b5ecc8b4a72">Search 搜索 &amp; Replace 替换</h3>
<div class="outline-text-3" id="text-h:7fef27f0-cd34-4881-88dd-8b5ecc8b4a72">
<p>
Emacs 原生提供了强大的搜索和替换功能。
</p>

<p>
速记：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">C-s &#21521;&#21518;&#26597;&#25214;
C-r &#21521;&#21069;&#26597;&#25214;
M-% &#26367;&#25442;
</pre>
</div>

<p>
替换时按下`y`确认替换，`n`跳过本处的替换，`!`全部替换。
</p>

<p>
<b>search</b>
</p>

<ul class="org-ul">
<li>isearchn (Incremental search)
<ul class="org-ul">
<li>前|后 (重复-切换搜索到的词)
<ul class="org-ul">
<li>isearch-(forward|backward) == C-(s|r)</li>
<li>isearch-(forward|backward)-regexp == C-M-(s|r)</li>
<li>isearch-forward-(word|symbol) == M-s (w|_)</li>
<li>isearch-forward-symbol-at-point == M-s .</li>
</ul></li>
<li><p>
Activated (C-s ..)
</p>

<p>
如果你想让光标跳到下一个匹配位置，就再按一次 C-s。
</p>

<p>
如果想停留在当前位置，退出搜索，按下回车键。
</p>

<p>
如果想放弃搜索，回到搜索前的位置，按下 C-g。
</p>
<ul class="org-ul">
<li>Paste : C-y</li>
<li>History : M-n|p</li>
<li>大小写敏感 : M-c</li>
<li>C-w  (光标处到下一个词的词尾)</li>
<li>C-(s|r) ( 同向: 重复上一次搜索; 反向: 切换搜索方向)</li>
<li>非增量 : RET</li>
<li>Regex : M-r</li>
</ul></li>
</ul></li>
<li>occor
<ul class="org-ul">
<li>M-s o == occur
<ul class="org-ul">
<li>-&gt; <b>Occur</b> buffer</li>
<li>e : occur-edit-mode : Edit current <b>Occur</b> buffer
<ul class="org-ul">
<li>exit : C-c C-c</li>
</ul></li>
<li>next|previous : M-g (n|p)</li>
<li>repeat : C-x z</li>
<li>next|previous line : C-n|p</li>
<li>beginning|end of buffer : &lt;|&gt;</li>
<li>refresh : g</li>
<li>Jump to match : o</li>
<li>Jump to match but point remainon <b>Occur</b> : C-o</li>
<li>help : h</li>
<li>quit : q</li>
</ul></li>
<li>multi-occur (multiple buffers)
<ul class="org-ul">
<li>M-x multi-occur</li>
<li>M-x multi-occur-in-matching-buffers</li>
</ul></li>
</ul></li>
<li>grep
<ul class="org-ul">
<li>M-x grep</li>
<li>Asynchronously : M-x lgrep</li>
<li>M-x grep-find | find-grep</li>
</ul></li>
</ul>

<p>
<b>replace</b>
</p>

<ul class="org-ul">
<li>所有: replace-(string|regexp)</li>
<li>问询
<ul class="org-ul">
<li>query-replace == M-%</li>
<li>query-replace-regexp == C-M-%</li>
<li>选项
<ul class="org-ul">
<li>退出 : &lt;Enter&gt;|q</li>
<li>替换当前 : &lt;SPC&gt;|y</li>
<li>替换-所有 : !</li>
<li>跳过 : &lt;backspace&gt;|n</li>
<li>退回-到前一次替换 : ^</li>
<li>替换当前 且 退出 : .</li>
<li>替换当前 且 光标移动到此处 且 退出 : ,</li>
<li>撤销-前一个|所有 : u|U</li>
<li>递归编辑 : C-r
<ul class="org-ul">
<li>退出 : C-M-c</li>
</ul></li>
<li>删除-这个匹配 并 进入递归编辑 : C-w</li>
<li>退出-递归编辑 和 问询 : C-]</li>
<li>编辑-替换的字符串 : E</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:09132711-50b2-47e3-ae46-3e6af8715471" class="outline-3">
<h3 id="h:09132711-50b2-47e3-ae46-3e6af8715471">Repeat 重复</h3>
<div class="outline-text-3" id="text-h:09132711-50b2-47e3-ae46-3e6af8715471">
<p>
Emacs 提供了一个机制可以把一个命令重复执行任意次数。具体来说，先按下 <code>C-u</code> ，再按数字表示次数，再按下命令的快捷键。例如： <code>C-u 12 C-n</code> 表示向下 12 行。如果不加数字，默认是 4 次。
</p>

<p>
注意，有些特殊命令不表示次数，例如与 M-x 组合时表示传参。
</p>

<p>
注意，C-u 其实是前缀参数（prefix argument）中的 universal-arument 的快捷键。其后加数字在大部分基本命令中是表示次数，但其它命令不一定表示次数，例如与 M-x 组合时的 C-u M-x 是基于前缀字符串搜索命令。可以类比我们的键盘上，按下 1 是输入数字 1，但按下 shift+1 得到的是叹号，C-u 就类似 shift 的作用，并且由于可以接数字等额外参数，C-u 非常强大。具体每个命令的前缀参数有何作用在其文档中都有说明，如何查看文档参考本文“获得帮助”小节。
</p>

<ul class="org-ul">
<li>多次运行同一个命令
<ul class="org-ul">
<li>universal-argument == C-u [N] (缺省次数: 4)</li>
<li>digit-argument == (C|M)-[N]</li>
<li>C-u [C-u]*  (4^n)</li>
</ul></li>
<li>上一条命令 (一次或多次)
<ul class="org-ul">
<li>repeat == C-x z &#x2026; z</li>
</ul></li>
<li>复杂命令
<ul class="org-ul">
<li>repeat-complex-command == C-x ESC ESC | C-x M-:</li>
</ul></li>
</ul>

<p>
拓展
</p>
<ul class="org-ul">
<li>Keyboard Macro 键盘宏</li>
<li>Multiple cursors <a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a> multiple-cursors config kbd</li>
</ul>
</div>
</div>
<div id="outline-container-h:cff1a2fd-ca05-47a6-adc9-4a22b242ba77" class="outline-3">
<h3 id="h:cff1a2fd-ca05-47a6-adc9-4a22b242ba77">Assist 辅助</h3>
<div class="outline-text-3" id="text-h:cff1a2fd-ca05-47a6-adc9-4a22b242ba77">
</div>
<div id="outline-container-h:c6d3e953-ca54-4aee-81d1-5259d416370c" class="outline-4">
<h4 id="h:c6d3e953-ca54-4aee-81d1-5259d416370c">Information 信息</h4>
<div class="outline-text-4" id="text-h:c6d3e953-ca54-4aee-81d1-5259d416370c">
<ul class="org-ul">
<li>词数
<ul class="org-ul">
<li>count-words-region 或者 M-=  (缓冲: C-u ..)</li>
<li>M-x count-words (缓冲|选中区域)</li>
</ul></li>
<li>行数
<ul class="org-ul">
<li>M-x count-lines-region</li>
</ul></li>
<li>字符信息
<ul class="org-ul">
<li>what-cursor-position <code>==</code> C-x =  (编码 第几个字符 第几列)</li>
<li>M-x describe-char  (详细信息)</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:e65e48e4-eade-449e-a79e-83acf3478043" class="outline-4">
<h4 id="h:e65e48e4-eade-449e-a79e-83acf3478043">Abbrev 缩写</h4>
<div class="outline-text-4" id="text-h:e65e48e4-eade-449e-a79e-83acf3478043">
<ul class="org-ul">
<li>添加
<ul class="org-ul">
<li>全局: add-global-abbrev <code>==</code> C-x a g</li>
<li>当前主要模式: add-mode-abbrev <code>==</code> C-x a l</li>
<li>inverse-add-(global|mode)-abbrev <code>==</code> C-x a i (g|l)</li>
<li>M-x define-(global|mode)-abbrev</li>
<li>前缀
<ul class="org-ul">
<li>0 : region as expansion</li>
<li>C-u [N] : N words</li>
</ul></li>
</ul></li>
<li>删除
<ul class="org-ul">
<li>Arg: C-u -</li>
<li>全部: M-x kill-all-abbrevs</li>
</ul></li>
<li>扩展
<ul class="org-ul">
<li>abbrev-prefix-mark <code>==</code> M-'</li>
<li>expand-abbrev <code>==</code> C-x a e</li>
<li>M-x expand-region-abbrevs</li>
<li>M-x unexpand-abbrev</li>
</ul></li>
<li>查看和编辑
<ul class="org-ul">
<li>M-x list-abbrevs (C-u [N] .. : local, N:次数)</li>
<li>M-x edit-abbrevs</li>
</ul></li>
<li>保存
<ul class="org-ul">
<li>M-x write-abbrev-file &lt;RET&gt; file &lt;RET&gt;</li>
<li>M-x read-abbrev-file &lt;RET&gt; file &lt;RET&gt;</li>
<li>M-x define-abbrevs</li>
<li>M-x insert-abbrevs</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:8893f083-d707-4a2e-bfb5-7d755faef26f" class="outline-4">
<h4 id="h:8893f083-d707-4a2e-bfb5-7d755faef26f">Register 寄存器</h4>
<div class="outline-text-4" id="text-h:8893f083-d707-4a2e-bfb5-7d755faef26f">
<p>
寄存器 : 存储 文本 矩形区块 位置 值 设置
</p>
<ul class="org-ul">
<li>View
<ul class="org-ul">
<li>M-x view-register &lt;RET&gt;</li>
</ul></li>
<li>Jump
<ul class="org-ul">
<li>jump-to-register == C-x r j</li>
</ul></li>
<li>Position
<ul class="org-ul">
<li>Save: point-to-register == C-x r &lt;SPC&gt;</li>
</ul></li>
<li>Text|Rectangle
<ul class="org-ul">
<li>Save: copy-[rectangle]-to-register == C-x r (s|r)  (C-u .. : copy-to and del)</li>
<li>Insert: insert-register == C-x r i</li>
</ul></li>
<li>Text
<ul class="org-ul">
<li>Append: M-x append-to-register &lt;RET&gt;
<ul class="org-ul">
<li>increment-register == C-x r +</li>
</ul></li>
<li>Prepend: M-x prepend-to-register &lt;RET&gt;</li>
</ul></li>
<li>Frame&amp;Window Configuration
<ul class="org-ul">
<li>Save
<ul class="org-ul">
<li>window-configuration-to-register == C-x r w</li>
<li>frameset-to-register == C-x r f</li>
</ul></li>
<li>Restore: C-x r j  (C-u .. : del frame invisible)</li>
</ul></li>
<li>Number
<ul class="org-ul">
<li>Save: number-to-register ==  C-u [N] C-x r n</li>
<li>Increment: C-u [N] C-x r +</li>
<li>Insert: insert-register == C-x r i</li>
</ul></li>
<li>Keyboard Macro
<ul class="org-ul">
<li>Save: kmacro-to-register ==  C-x C-k x</li>
<li>Exe: C-x r j</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:d0c6bf5a-27ff-4361-bf4e-93938e74180c" class="outline-4">
<h4 id="h:d0c6bf5a-27ff-4361-bf4e-93938e74180c">Bookmark 书签</h4>
<div class="outline-text-4" id="text-h:d0c6bf5a-27ff-4361-bf4e-93938e74180c">
<p>
就和电子书中的书签功能一样，在当前光标位置打上一个书签，之后可以随时跳转回来。主要涉及到如下命令
</p>

<p>
书签 : 保存缓冲区中位置
</p>
<ul class="org-ul">
<li>设置-光标位置
<ul class="org-ul">
<li>bookmark-set == C-x r m  设置书签。可以为书签起个标记名称，默认为文件名。也可以为目录打书签。</li>
<li>bookmark-set-no-overwrite == C-x r M</li>
</ul></li>
<li><p>
移动到-指示的位置
</p>
<ul class="org-ul">
<li>bookmark-jump == C-x r b</li>
</ul>
<p>
如果安装了 ivy counsel，应当已被覆盖为 counsel-bookmark）
</p></li>
<li>显示-书签列表
<ul class="org-ul">
<li>list-bookmarks == C-x r l</li>
</ul></li>
<li>删除
<ul class="org-ul">
<li>M-x bookmark-delete</li>
</ul></li>
<li>重命名
<ul class="org-ul">
<li>M-x bookmark-rename</li>
</ul></li>
<li>保存 加载
<ul class="org-ul">
<li>到默认文件: bookmark-save</li>
<li>新文件: bookmark-write</li>
<li>加载: bookmark-load</li>
</ul></li>
<li>插入
<ul class="org-ul">
<li>文件内容: bookmark-insert</li>
<li>文件名字: bookmark-insert-location</li>
</ul></li>
</ul>

<p>
范例：随时打开指定目录
</p>
<ul class="org-ul">
<li>C-x C-f ~/.emacs.d/</li>
<li>M-x bookmark-set 回车 设置书签，同时emacs.d/目录下会生成一个书签文件 bookmarks</li>
<li>C-x C-c 关闭emacs</li>
<li>打开emacs M-x bookmark-jump 打开书签</li>
</ul>
</div>
</div>
<div id="outline-container-h:f223b93c-8a74-4fd4-84e2-e68d4fa31a2d" class="outline-4">
<h4 id="h:f223b93c-8a74-4fd4-84e2-e68d4fa31a2d">Other 其它</h4>
<div class="outline-text-4" id="text-h:f223b93c-8a74-4fd4-84e2-e68d4fa31a2d">
<p>
Highlight 高亮
</p>
<ul class="org-ul">
<li>光标所在行
<ul class="org-ul">
<li>M-x hl-line-mode (当前缓冲)
<ul class="org-ul">
<li>(global-hl-line-mode 1)</li>
</ul></li>
</ul></li>
</ul>

<p>
自动加载外部修改过的文件
</p>
<ul class="org-ul">
<li>global-auto-revert-mode</li>
</ul>

<p>
自动保存
</p>
<ul class="org-ul">
<li>M-x auto-save
<ul class="org-ul">
<li>重开: M-1 ..</li>
</ul></li>
</ul>

<p>
统计行数
</p>
<ul class="org-ul">
<li><code>C-x l</code></li>
</ul>

<p>
从当前光标开始删除到下一个指定的字符为止(包括这个字符)
</p>
<ul class="org-ul">
<li>zap-to-char == M-z</li>
</ul>
<p>
也是vim里的ct命令.
</p>

<p>
删除两个单词之间的空格
</p>
<ul class="org-ul">
<li>M-x cycle-spacing 或者 Alt+Space
<ul class="org-ul">
<li>Ubuntu下要禁用Alt+Space快捷捷才行.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:bc07c3b3-9361-4638-b9b5-c7b646f0382b" class="outline-3">
<h3 id="h:bc07c3b3-9361-4638-b9b5-c7b646f0382b">多文件操作</h3>
<div class="outline-text-3" id="text-h:bc07c3b3-9361-4638-b9b5-c7b646f0382b">
</div>
<div id="outline-container-h:0abc1cc9-4985-4d62-b3ba-ac1ef9fd4e67" class="outline-4">
<h4 id="h:0abc1cc9-4985-4d62-b3ba-ac1ef9fd4e67">文件与 Buffer</h4>
<div class="outline-text-4" id="text-h:0abc1cc9-4985-4d62-b3ba-ac1ef9fd4e67">
<p>
速记
</p>
<pre class="example" id="org25a639b">
C-x C-f  打开-文件
C-x C-s  保存到文件
C-x C-b  列出缓存区
C-x b    切换缓存区
</pre>
</div>
<div id="outline-container-h:2ae249b5-9f47-4856-9966-01aa1dcfb816" class="outline-5">
<h5 id="h:2ae249b5-9f47-4856-9966-01aa1dcfb816">打开多文件</h5>
<div class="outline-text-5" id="text-h:2ae249b5-9f47-4856-9966-01aa1dcfb816">
<p>
之前我们是在命令行中使用 <code>emacs &lt;filename&gt;</code> 的方式来打开文件。而想要在 Emacs 内打开一个文件如下：
</p>

<p>
快捷键：
</p>
<ul class="org-ul">
<li>打开文件：find-file == C-x C-f</li>
<li>find-file-read-only == C-x C-r</li>
<li>替换：find-alternate-file == C-x C-v (替换缓冲区关联的文件)</li>
<li>已打开切换只读模式：read-only-mode == C-x C-q</li>
</ul>

<p>
按下 <code>C-x C-f=（=find-file=），此时 Echo area 会出现 “Find file: “，
后面为一个路径，输入文件对应的路径即可打开相应文件。如果想新建文件，只
需要输入一个不存在的文件名即可。输入时可以使用 =&lt;tab&gt;</code> 键自动补全，就
和 Linux 中类似。
</p>

<p>
保存文件对应命令 C-x C-s。
</p>

<p>
打开文件并只读不改： <code>C-x C-r</code> 。打开另一相近文件： <code>C-x C-v</code> ，此时下
面的路径会自动以当前文件全名作为初始路径（而不是目录的路径），这样方便
稍微修改一些文件名打开另一文件。 已打开的文件切换为只读模式： <code>C-x
C-q</code> 再执行取消只读.
</p>

<p>
Emacs 可以打开多个文件，同样使用 <code>C-x C-f</code> 打开即可。 但是你如果打开了
第二个文件，便会发现第一个文件就消失不见了，应当去哪里找呢？事实上，所
有打开的文件都会被放入一个被称为 Buffer 的对象中，当打开了第二个文件时，
第一个文件所在的 Buffer 会切入后台，而第二个文件的 Buffer 会占据当前的
Window。Buffer 的名字显示在 Mode line 中间，通常是文件名本身。
</p>

<p>
Emacs 也可以用这个方式打开目录（文件夹），会显示出目录内的文件（此即 Linux 的设计理念，一切皆为文件，即使是目录也本质上是一个文件），可以用光标选择想打开的文件。
</p>
</div>
</div>
<div id="outline-container-h:c015e3ce-3561-4149-acd8-f83ac5eac352" class="outline-5">
<h5 id="h:c015e3ce-3561-4149-acd8-f83ac5eac352">Buffer 的切换</h5>
<div class="outline-text-5" id="text-h:c015e3ce-3561-4149-acd8-f83ac5eac352">
<p>
快捷键：
</p>
<ul class="org-ul">
<li>switch-to-buffer == C-x b (-&gt; Helm-mini) 切换缓存区，按?可以显示缓存区列表，C-g退出</li>
<li>switch-to-buffer-other-(window|frame) == C-x (4|5) b</li>
<li>list-buffers == C-x C-b (-&gt; helm-buffers-list) 开启buffer管理</li>
<li>(previous|next)-buffer == C-x (left|right)  切換到(上|下)一個 buffer</li>
</ul>

<p>
鼠标操作：
</p>
<ul class="org-ul">
<li>方法1：菜单中点击 buffer</li>
<li>方法2：鼠标左键或右键点击文件向前或向后切换buffer</li>
<li>C-mouse-1 （`mouse-1` 表示鼠标左键）</li>
</ul>

<p>
切换 Buffer 有三类方法，简短的方法是使用 <code>C-x b</code> ，输入 Buffer 的名字
后按回车即可切换。 Echo area 中会提示你，如果什么也不输直接按回车，可
以跳转到当前默认的 Buffer 中，这样方便在两个文件中来回切换。
</p>

<p>
显然这样如果 Buffer 多了会记不住名字也不便于管理，于是可以使用第二个方
法， <code>C-x C-b</code> ，此时会弹出一个 Window，名为 "<b>Buffer List</b>" ，列出了
当前所打开的所有 Buffer。其中可以看到多个以星号（*） 开头结尾的 Buffer，
那些都是 Emacs 用于输出一些信息的 Buffer，并不是由于打开文件而产生。例
如 “*Messages*” 是 Emacs 的一些输出信息。“*scratch*” 是可以编写一
些 Elisp 代码的地方。Buffer 开头如果是 %，表示这个 Buffer 被修改过而没
有保存。
</p>

<p>
如果当前光标没有在 "<b>Buffer List</b>" 中可以用 C-x o 键切换过去。
</p>


<figure id="org790550c">
<img src="./images/Snipaste_2023-06-28_17-34-23.png" alt="Snipaste_2023-06-28_17-34-23.png" width="60%">

</figure>

<p>
可以通过光标选择切换到某个 Buffer。同时在这个 "<b>Buffer List</b>" 中有很多
功能可以使用。按问号（?）可以显示帮助。常见的操作例如 q 退出， d 标记
一个 Buffer 打算关闭，s 标记一个 Buffer 打算保存，u 取消标记，x 执行刚
刚标记过的删除和保存操作。事实上，在这里上下移动光标也不需要 C-p 和
C-n，直接按 p 和 n 即可。
</p>

<p>
此外，第三种方法是使用 <code>C-mouse-1</code> （ <code>mouse-1</code> 表示鼠标左键）然后用鼠标菜单切换 Buffer。
</p>

<p>
事实上，在输入 <code>M-x</code> 后、 <code>C-x b</code> 后在 Echo area 显示的等待输入的区域被称为 Minibuffer， 所以它们的输入方式是共通的，都可以用相同的补全机制等。
</p>

<p>
想要关闭当前的 Buffer？直接在当前的 Buffer 处按下 <code>C-x k</code> 即可。
</p>
</div>
</div>
<div id="outline-container-h:cc42a9cf-e4ac-4982-9511-9fbf7417af07" class="outline-5">
<h5 id="h:cc42a9cf-e4ac-4982-9511-9fbf7417af07">文件备份</h5>
<div class="outline-text-5" id="text-h:cc42a9cf-e4ac-4982-9511-9fbf7417af07">
<p>
使用 Emacs 打开文件后，会发现目录下会多一个和打开的文件同名但是后面多
了个 <code>~</code> 字符的文件，例如打开了 <code>names.txt</code> 后会出现 <code>names.txt~</code> ，
这是 Emacs 的备份机制，防止程序或系统崩溃，或是用户误操作破坏了文件。
可以设置关闭或文件数量上限等等，详见<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Backup.html">文档</a>。
</p>

<p>
关闭备份需要设置： <code>(setq make-backup-files nil)</code> 。
</p>
</div>
</div>
<div id="outline-container-h:2116dc7f-25fc-45b8-81bd-6f8bb3a65357" class="outline-5">
<h5 id="h:2116dc7f-25fc-45b8-81bd-6f8bb3a65357">文件保存</h5>
<div class="outline-text-5" id="text-h:2116dc7f-25fc-45b8-81bd-6f8bb3a65357">
<ul class="org-ul">
<li>全部: save-some-buffers == C-x s</li>
<li>当前: save-buffer == C-x C-s</li>
<li>另存为：write-file == C-x C-w</li>
</ul>
</div>
</div>
<div id="outline-container-h:f9964062-e8cb-40a9-91c5-47122232a8a7" class="outline-5">
<h5 id="h:f9964062-e8cb-40a9-91c5-47122232a8a7">批量管理 Buffer</h5>
<div class="outline-text-5" id="text-h:f9964062-e8cb-40a9-91c5-47122232a8a7">
<div class="org-src-container">
<pre class="src src-shell">C-x C-b ;; &#36827;&#20837;Buffer&#21015;&#34920;  &#21629;&#20196;&#65306;list-buffers
m ;; &#65288;&#23567;&#20889;m&#65289;&#26631;&#35760;&#32531;&#20914;&#21306;&#65288;&#24403;&#21069;&#20809;&#26631;&#22788;&#65289;
u ;; &#21462;&#28040;&#24403;&#21069;&#34892;&#26631;&#35760;
U ;; &#21462;&#28040;&#20840;&#37096;&#26631;&#35760;
d ;; &#26631;&#35760;&#21024;&#38500;
s ;; &#26631;&#35760;&#19968;&#20010; Buffer &#25171;&#31639;&#20445;&#23384;
D ;; &#20851;&#38381;&#24050;&#26631;&#35760;&#30340;&#32531;&#20914;&#21306;
S ;; &#20445;&#23384;&#24050;&#26631;&#35760;&#30340;&#32531;&#20914;&#21306;
x ;; &#25191;&#34892;&#21018;&#21018;&#26631;&#35760;&#36807;&#30340;&#21024;&#38500;&#21644;&#20445;&#23384;&#25805;&#20316;

g ;; &#26356;&#26032;&#21015;&#34920;
o ;; &#22312;&#26032;&#31383;&#21475;&#20013;&#26597;&#30475;&#32531;&#20914;&#21306;
RET ;; &#26597;&#30475;&#35813;&#32531;&#20914;&#21306;
<span style="color: #ff00ff;">` ;; &#20999;&#25442;&#21015;&#34920;&#26174;&#31034;&#24418;&#24335;</span>
<span style="color: #ff00ff;">? ;; &#26597;&#30475;&#25353;&#38190;&#24110;&#21161;</span>


<span style="color: #ff00ff;">&#21629;&#20196;&#32452;&#21512;&#31034;&#20363;&#65306;</span>
<span style="color: #ff00ff;">*uSD&#65306;&#26631;&#35760;&#25152;&#26377;&#26410;&#20445;&#23384;&#32531;&#20914;&#21306;&#65292;&#20445;&#23384;&#65292;&#28982;&#21518;&#20851;&#38381;</span>

<span style="color: #ff00ff;">&#22312;&#36825;&#37324;&#19978;&#19979;&#31227;&#21160;&#20809;&#26631;&#20063;&#19981;&#38656;&#35201; C-p &#21644; C-n&#65292;&#30452;&#25509;&#25353; p &#21644; n &#21363;&#21487;</span>
</pre>
</div>

<p>
Buffer列表list-buffers的替代品
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20351;&#29992;ibuffer&#20195;&#26367;list-buffers&#65292;&#26377;&#39068;&#33394;&#65292;&#36827;&#20837;ibuffer&#20013;</span>
(<span style="color: #a020f0;">defalias</span> '<span style="color: #0000ff;">list-buffers</span> 'ibuffer)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25110;&#20351;&#29992;ibuffer-other-window, &#26377;&#39068;&#33394;&#65292;&#20391;&#36793;&#26032;&#24320;&#20010;&#31383;&#21475;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(defalias 'list-buffers 'ibuffer-other-window)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:019640c4-5bd3-4e8f-93e1-3e89aef44bd4" class="outline-5">
<h5 id="h:019640c4-5bd3-4e8f-93e1-3e89aef44bd4">关闭窗口</h5>
<div class="outline-text-5" id="text-h:019640c4-5bd3-4e8f-93e1-3e89aef44bd4">
<ul class="org-ul">
<li>kill-buffer == C-x k  关闭缓冲区</li>
<li>M-x kill-(some|matching)-buffers</li>
<li>M-x clean-buffer-list (未修改&gt;=3天)</li>
</ul>

<p>
窗口关闭：
</p>
<ul class="org-ul">
<li>方法1：鼠标停在状态栏，右键</li>
<li>方法2：菜单栏选择 Remove Other Windows 只保留当前buffer，New Window Below 水平</li>
<li>方法3：鼠标滚轮按住状态栏，拖动</li>
</ul>
</div>
</div>
<div id="outline-container-h:01f28d2a-575e-4253-8d6e-8855065d0fc0" class="outline-5">
<h5 id="h:01f28d2a-575e-4253-8d6e-8855065d0fc0">其它</h5>
<div class="outline-text-5" id="text-h:01f28d2a-575e-4253-8d6e-8855065d0fc0">
<div class="org-src-container">
<pre class="src src-shell">eval-expression&#65306;&#26597;&#30475;&#34920;&#36798;&#24335;&#30340;&#32467;&#26524;
eval-buffer &#65306;&#25226;&#32531;&#20914;&#21306;&#25152;&#26377;&#20195;&#30721;&#20840;&#37096;&#36816;&#34892;&#19968;&#36941;
erase-buffer&#65306;&#28165;&#31354;&#24403;&#21069;&#32531;&#20914;&#21306;

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#37325;&#21629;&#21517;</span>
M-x rename-(buffer|uniquely)


<span style="color: #b22222;">#</span><span style="color: #b22222;">&#24674;&#22797;</span>
M-x revert-buffer (&#24674;&#22797;&#21040;&#19978;&#19968;&#27425;&#23384;&#30424;&#26102;)
M-x recover-file (&#20174;&#33258;&#21160;&#20445;&#23384;&#24674;&#22797;)
M-x recover-session

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#37325;&#23450;&#20301;</span>
recenter-top-bottom == C-l

<span style="color: #b22222;">#</span><span style="color: #b22222;">Indirect Buffers : shares the text of some other buffer</span>
<span style="color: #0000ff;">M-x</span> (make|clone)-indirect-buffer
clone-indirect-buffer-other-window == C-x 4 c

<span style="color: #b22222;">#</span><span style="color: #b22222;">Tab &#26631;&#31614;&#39029;&#31649;&#29702;</span>
C-x t 2 ;; &#26032;&#24314;Tab
      1 ;; &#20851;&#38381;&#20854;&#23427;Tab
      0 ;; &#20851;&#38381;&#24403;&#21069;Tab
      b ;; &#22312;&#26032;Tab&#20013;&#25171;&#24320;Buffer
</pre>
</div>

<p>
窗口大小：
</p>
<ul class="org-ul">
<li>鼠标在状态栏，上下拖动</li>
</ul>

<p>
<b>插件</b>
</p>

<p>
ido自动匹配buffer插件
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">ido&#33258;&#21160;&#21305;&#37197;buffer C-x b&#26102;&#33258;&#21160;&#21305;&#37197;</span>
(<span style="color: #a020f0;">setq</span> ido-enable-flex-matching t) 
(<span style="color: #a020f0;">setq</span> ido-erverywhere t)
(ido-mode 1)
</pre>
</div>

<p>
使用向上,下键切换上次/下次的文件/buffer，按回车直接选择第一个匹配项
</p>

<p>
tabbar标签栏插件
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">if you like a tabbar</span>
<span style="color: #b22222;">;</span><span style="color: #b22222;">(use-package tabbar</span>
<span style="color: #b22222;">;  </span><span style="color: #b22222;">:ensure t</span>
<span style="color: #b22222;">;  </span><span style="color: #b22222;">:config</span>
<span style="color: #b22222;">;  </span><span style="color: #b22222;">(tabbar-mode t))</span>
</pre>
</div>

<p>
ibuffer插件
</p>

<p>
开箱即用， C-x C-b 绑定到 Emacs list-buffers 命令。
</p>

<p>
可以参考<a href="http://martinowen.net/blog/2010/02/03/tips-for-emacs-ibuffer.html">Martin Owen文章</a>给buffer设置不同的组
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">ibuffer</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">buffer&#21015;&#34920;&#32465;&#23450;ibuffer&#65292;&#32473;buffer&#24402;&#31867;&#35774;&#32622;&#19981;&#21516;&#30340;&#32452;</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-x C-b"</span>) 'ibuffer)
(<span style="color: #a020f0;">setq</span> ibuffer-saved-filter-groups
      (<span style="color: #a020f0;">quote</span> ((<span style="color: #8b2252;">"default"</span>
               (<span style="color: #8b2252;">"dired"</span> (mode . dired-mode))
               (<span style="color: #8b2252;">"org"</span> (name . <span style="color: #8b2252;">"^.*org$"</span>))
               (<span style="color: #8b2252;">"magit"</span> (mode . magit-mode))
               (<span style="color: #8b2252;">"IRC"</span> (<span style="color: #a020f0;">or</span> (mode . circe-channel-mode) (mode . circe-server-mode)))
               (<span style="color: #8b2252;">"web"</span> (<span style="color: #a020f0;">or</span> (mode . web-mode) (mode . js2-mode)))
               (<span style="color: #8b2252;">"shell"</span> (<span style="color: #a020f0;">or</span> (mode . eshell-mode) (mode . shell-mode)))
               (<span style="color: #8b2252;">"mu4e"</span> (<span style="color: #a020f0;">or</span>

                        (mode . mu4e-compose-mode)
                        (name . <span style="color: #8b2252;">"</span><span style="color: #ff0000; font-weight: bold;">\</span><span style="color: #8b2252;">*mu4e</span><span style="color: #ff0000; font-weight: bold;">\</span><span style="color: #8b2252;">*"</span>)
                        ))
               (<span style="color: #8b2252;">"programming"</span> (<span style="color: #a020f0;">or</span>
                               (mode . clojure-mode)
                               (mode . clojurescript-mode)
                               (mode . python-mode)
                               (mode . c++-mode)))
               (<span style="color: #8b2252;">"emacs"</span> (<span style="color: #a020f0;">or</span>
                         (name . <span style="color: #8b2252;">"^\\*scratch\\*$"</span>)
                         (name . <span style="color: #8b2252;">"^\\*Messages\\*$"</span>)))
               ))))
(add-hook 'ibuffer-mode-hook
          (<span style="color: #a020f0;">lambda</span> ()
            (ibuffer-auto-mode 1)
            (ibuffer-switch-to-saved-filter-groups <span style="color: #8b2252;">"default"</span>)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">don't show these&#19981;&#23637;&#31034;&#22312;&#32531;&#23384;&#21015;&#34920;&#20013;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(add-to-list 'ibuffer-never-show-predicates "zowie")</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Don't show filter groups if there are no buffers in that group</span>
(<span style="color: #a020f0;">setq</span> ibuffer-show-empty-filter-groups nil)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">Don't ask for confirmation to delete marked buffers</span>
(<span style="color: #a020f0;">setq</span> ibuffer-expert t)
</pre>
</div>


<p>
<img src="./images/image-20210728060521172.png" alt="image-20210728060521172.png">]]
</p>

<p>
可以使用`m`来标记缓存，使用`H`新建多个emacs进程来打开这些缓存，使用`C-x 50`退出。
</p>
</div>
</div>
</div>
<div id="outline-container-h:dbfd2b46-8c3c-4f2d-9832-df3e414b7139" class="outline-4">
<h4 id="h:dbfd2b46-8c3c-4f2d-9832-df3e414b7139">Window &amp; Frame 窗口和框架</h4>
<div class="outline-text-4" id="text-h:dbfd2b46-8c3c-4f2d-9832-df3e414b7139">
<p>
frame &amp; window区别
</p>

<ul class="org-ul">
<li>一个frame包含1个或多个window</li>
<li>每个window显示各自的buffer</li>
</ul>

<p>
速记
</p>
<pre class="example" id="orgfd0f8a2">
C-x 2  水平切
C-x 3  垂直切
C-x 1  留一个窗口
C-x 0  将游标顺移到下一个窗口
</pre>
</div>
<div id="outline-container-h:2530a569-f3b8-45c3-8505-a961eea5b19f" class="outline-5">
<h5 id="h:2530a569-f3b8-45c3-8505-a961eea5b19f">多Window</h5>
<div class="outline-text-5" id="text-h:2530a569-f3b8-45c3-8505-a961eea5b19f">
</div>
<div id="outline-container-h:3ff48b65-a847-4d78-8b25-113bec2e273a" class="outline-6">
<h6 id="h:3ff48b65-a847-4d78-8b25-113bec2e273a">划分-垂直|水平</h6>
<div class="outline-text-6" id="text-h:3ff48b65-a847-4d78-8b25-113bec2e273a">
<ul class="org-ul">
<li>split-window-(below|vertically) == C-x 2 上下分割出两个 Window</li>
<li>split-window-(right|horizontally) == C-x 3 左右分割出两个 Window</li>
</ul>

<p>
分割后，默认会把当前的 Buffer 也显示到新的 Window，即显示了两个一样的
Window。再次强调一下，Buffer 对应真正打开的文件，而 Window 是把 Buffer
显示出来的元件，所以一个文件只会开一个 Buffer，但可以有多个 Window 显
示。于是，在新的 Window 里用 <code>C-x C-f</code> 打开另一个文件即可看到两个文件
了，当然也可以正常用 Buffer 切换。
</p>
</div>
</div>
<div id="outline-container-h:172e125e-7be1-46ca-8108-0410ca018681" class="outline-6">
<h6 id="h:172e125e-7be1-46ca-8108-0410ca018681">关闭</h6>
<div class="outline-text-6" id="text-h:172e125e-7be1-46ca-8108-0410ca018681">
<ul class="org-ul">
<li>当前: delete-window == C-x 0 关闭光标所在处的 Window</li>
<li>其它: delete-other-windows == C-x 1  即仅保留当前窗口。其它 Window 的 Buffer 依然没有关闭，可以通过 "<b>Buffer List</b>" 查看。</li>
<li>当前窗口及其缓冲区: kill-buffer-and-window == C-x 4 0</li>
</ul>

<p>
关于分屏的更多内容你可以在<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window.html">这里</a>找到
</p>
</div>
</div>
<div id="outline-container-h:ab31201a-2a22-4793-88ae-614ccfc64ccd" class="outline-6">
<h6 id="h:ab31201a-2a22-4793-88ae-614ccfc64ccd">切换分屏</h6>
<div class="outline-text-6" id="text-h:ab31201a-2a22-4793-88ae-614ccfc64ccd">
<p>
默认可通过以下快捷键进行窗口的循环跳转： <code>C-x o</code> 逆时针 <code>C-u - C-x o</code>
</p>

<p>
那么如果在已经分割之后再分割呢？Emacs 会继续做二等分，变成 3 个、4 个等窗口。此时窗口的切换和关闭就没有那么方便了。 使用插件可以辅助这一过程。
</p>

<ul class="org-ul">
<li>ace-window  窗口间的跳转插件 (推荐)</li>
<li>window-numbering 插件,M-num 快速跳转到指定的窗口</li>
</ul>
</div>
</div>
<div id="outline-container-h:a9414008-de96-4a5f-a53f-4bc37e2fbb40" class="outline-6">
<h6 id="h:a9414008-de96-4a5f-a53f-4bc37e2fbb40">打开多文件</h6>
<div class="outline-text-6" id="text-h:a9414008-de96-4a5f-a53f-4bc37e2fbb40">
<ul class="org-ul">
<li>find-file-other-window == C-x 4 f</li>
<li>find-file-read-only-other-window == C-x 4 r</li>
</ul>

<p>
那么既然开一个新的窗口并打开新的文件这个需求很常见，对此如果只有以上快
捷键，需要先 <code>C-x 3</code> 分割出一个窗口， <code>C-x o</code> 切换到新窗口， <code>C-x C-f</code>
打开新文件，过于繁琐。所以 Emacs 提供了一个快捷键： <code>C-x 4 f</code> 来达到
“在另一个窗口打开新的文件，如果只有一个窗口就分割成两个”的效果。
</p>

<p>
此外，还有 <code>C-x 4 b</code> 表示“在另一个窗口切换到另一 Buffer，如果只有一个窗口就分割成两个” 。 <code>C-x 4 d</code> 表示 “在另一个窗口打开目录，如果只有一个窗口就分割成两个”。
</p>

<p>
可以总结出 <code>C-x 4</code> 为前缀时，就表达“在另一个窗口做……“。
</p>
</div>
</div>
<div id="outline-container-h:5dc18fd4-21d8-4513-b195-27fe90e9e6f1" class="outline-6">
<h6 id="h:5dc18fd4-21d8-4513-b195-27fe90e9e6f1">滚动</h6>
<div class="outline-text-6" id="text-h:5dc18fd4-21d8-4513-b195-27fe90e9e6f1">
<ul class="org-ul">
<li>第二窗口向下翻页：scroll-other-window == C-M-v</li>
<li>第二窗口向上翻页：C-M-S-v （同时按下 Control，Meta， Shift 和 v）</li>
</ul>

<p>
在打开两个窗口时，如果我们光标在第一个窗口，而希望第二个窗口翻页，那么就可以用 <code>C-M-v</code> 向下翻页。用 <code>C-M-S-v</code> （同时按下 Control，Meta， Shift 和 v）向上翻页。
</p>
</div>
</div>
<div id="outline-container-h:86301d75-fd80-49b5-877d-7d6911e6b860" class="outline-6">
<h6 id="h:86301d75-fd80-49b5-877d-7d6911e6b860">调整大小</h6>
<div class="outline-text-6" id="text-h:86301d75-fd80-49b5-877d-7d6911e6b860">
<ul class="org-ul">
<li>enlarge-window == C-x ^ 增高当前窗口,可以配合 C-u num 来使用</li>
<li>shrink-window  未绑定按键 减少当前窗口高度</li>
<li>(enlarge|shrink)-window-horizontally == C-x (}|{)  增加/减小当前窗口宽度</li>
<li>shrink-window-if-larger-than-buffer == C-x -</li>
<li>平衡-所有可见窗口大小: balance-windows == C-x +</li>
</ul>
</div>
</div>
<div id="outline-container-h:2bbc35d0-96eb-4764-bfd9-a40f084e756a" class="outline-6">
<h6 id="h:2bbc35d0-96eb-4764-bfd9-a40f084e756a">其它</h6>
<div class="outline-text-6" id="text-h:2bbc35d0-96eb-4764-bfd9-a40f084e756a">
<p>
<b>窗口撤销</b>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> winner
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:hook</span> (after-init . winner-mode))
</pre>
</div>

<p>
内置包使用 <code>(winner-mode 1)</code> 开启。
</p>
<ul class="org-ul">
<li><code>winner-redo C-c left</code>  回退窗口</li>
<li><code>winner-undo C-c right</code>  撤消回退</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:4f162147-9a37-4bfe-a0c6-48afaa3d2d1f" class="outline-5">
<h5 id="h:4f162147-9a37-4bfe-a0c6-48afaa3d2d1f">多Frame</h5>
<div class="outline-text-5" id="text-h:4f162147-9a37-4bfe-a0c6-48afaa3d2d1f">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#25171;&#24320;-&#25991;&#20214;</span>
find-file-other-frame == C-x 5 f
find-file-read-only-other-frame == C-x 5 r

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26032;&#24314;</span>
make-frame-command == C-x 5 2

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20999;&#25442;</span>
other-frame == C-x 5 o
switch-to-buffer-other-frame == C-x 5 b

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21024;&#38500;</span>
&#24403;&#21069;: delete-frame == C-x 5 0
&#20854;&#23427;: delete-other-frames == C-x 5 1
</pre>
</div>

<p>
既然能多 Window，自然能多个 Frame。打开一个新的 Frame 可以使用快捷键
<code>C-x 5 2</code> ； 在一个新的 Frame 打开文件，可以使用快捷键 <code>C-x 5 f</code> 。
<code>C-x 5</code> 和 <code>C-x 4</code> 基本类似，只是前者在 Frame 间操作，后者在 Window 间
操作。 图形界面使用较多。
</p>

<p>
有的人在日常使用中，对多文件的打开更偏爱在单个 Frame 中用多个 Window，很少在多 Frame 中间频繁切换。
</p>

<p>
<b>插件</b>
</p>
<ul class="org-ul">
<li>ace-window</li>
</ul>

<p>
popwin光标自动切到弹出的窗口里
</p>

<ul class="org-ul">
<li>popwin光标自动切到弹出的窗口里 <a href="https://github.com/emacsorphanage/popwin">https://github.com/emacsorphanage/popwin</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">mypackages</span> '(
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">--- popwin ---</span>
         popwin
         ) <span style="color: #ff0000; font-weight: bold;">"Default packages"</span><span style="color: #ff0000; font-weight: bold;">)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">popwin &#20809;&#26631;&#33258;&#21160;&#20999;&#21040;&#24377;&#20986;&#30340;&#31383;&#21475;&#37324;</span>
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">popwin</span>)
(popwin-mode t)
</pre>
</div>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20809;&#26631;&#33258;&#21160;&#20999;&#21040;&#24377;&#20986;&#30340;&#31383;&#21475;&#37324;</span>
(<span style="color: #a020f0;">use-package</span> popwin
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span> (popwin-mode))
</pre>
</div>

<p>
MiniBuffer 交互优化
</p>

<p>
显示在左下角的 MiniBuffer 移动视线范围大，移动到中央位置，更合适一些。
</p>

<ul class="org-ul">
<li>ivy-posframe <a href="https://github.com/tumashu/ivy-posframe">https://github.com/tumashu/ivy-posframe</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#31383;&#21475;&#20132;&#20114;&#20248;&#21270;,&#31227;&#21160;&#21040;&#20013;&#22830;&#20301;&#32622;</span>
(<span style="color: #a020f0;">use-package</span> ivy-posframe
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (<span style="color: #a020f0;">setq</span> ivy-posframe-display-functions-alist
    '((swiper . ivy-posframe-display-at-frame-center)
      (complete-symbol . ivy-posframe-display-at-point)
      (counsel-M-x . ivy-posframe-display-at-frame-center)
      (counsel-find-file . ivy-posframe-display-at-frame-center)
      (ivy-switch-buffer . ivy-posframe-display-at-frame-center)
      (t . ivy-posframe-display-at-frame-center))))
</pre>
</div>

<p>
hydra 窗口
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-h:d6597f58-35ff-4300-aba1-38679aca070e" class="outline-3">
<h3 id="h:d6597f58-35ff-4300-aba1-38679aca070e">目录（文件夹）操作</h3>
<div class="outline-text-3" id="text-h:d6597f58-35ff-4300-aba1-38679aca070e">
<p>
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired.html">Dired</a>，即 Directory Editor，是 Emacs 自带的用以处理目录和文件的功能。常见的操作例如删除文件、将文件从一处拷贝至另一处，更高级的操作如对比两个文件的异同、更改权限、链接文件等等，都可以通过 Dired 实现。
</p>

<p>
启动 Dired 非常简单，只需要按下 <code>C-x C-f</code> ，输入一个目录（文件夹）而非
文件，就会进入 Dired。更标准的方式是按  <code>C-x d</code> 或调用 <code>M-x dired</code> 命令然后
输入一个目录的名字启动，但前者与打开文件的快捷键相同，更易记忆。
</p>

<p>
当已经打开了一个文件时，输入dired-jump(<code>C-x C-j</code>) 可以打开当前文件所在的目录。
</p>

<p>
Dired 会把目录下的文件都列出来，随后用户可以对文件进行操作。此时可以按下 h （Help）来打开帮助，读者可以翻到下面的 "Keybindings"，里面列出了所有在 Dired 中可以使用的命令。
</p>

<ul class="org-ul">
<li>h: 帮助</li>
<li>p/n: 上下移动光标</li>
<li>o: 新开窗口打开</li>
<li>j: 在当前文件所在目录查找文件</li>
<li>+ 创建目录</li>
<li>g 刷新目录  通过在C-x C-f创建完文件后按g刷新显示</li>
<li>C 拷贝</li>
<li>D 立即删除</li>
<li>R 重命名</li>
<li>d 标记删除</li>
<li>u 取消标记 大U全部取消</li>
<li>x 执行所有的标记</li>
<li>s 排序 。按修改时间或名称</li>
<li>S-6 上级目录</li>
<li>C-x C-q 目录下进入编辑模式，可改文件名</li>
<li>%m 正则匹配，可以安装正则插件p</li>
<li>dired-jump <code>=</code> C-X C-j 打开d:/</li>
</ul>

<p>
可以执行的命令全都在 "Keybindings" 中罗列，读者只需要自行查阅即可。
</p>

<p>
这里举一个简单的例子，我们想要将 a.txt 和 b.txt 文件挪到 subdir 中，首
先我们可以对 subdir 按下 i 来展开这个子目录， 随后对两个文本文件按下 m
标记， 然后按下 R（Rename） ，在回显区输入 ~/Code/Emacs/Test/subdir/，
按下回车。
</p>
</div>
</div>
<div id="outline-container-h:05fe055a-65be-4734-87bb-0c87ac2f741b" class="outline-3">
<h3 id="h:05fe055a-65be-4734-87bb-0c87ac2f741b">插入 tabel.el 表格</h3>
<div class="outline-text-3" id="text-h:05fe055a-65be-4734-87bb-0c87ac2f741b">
<p>
从 Emacs 22 起，内置了一个强大的基于文本的表格（tabel.el 表格），详情可参考<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Based-Tables.html">Editing Text-based Tables</a>。
注意
</p>
<ol class="org-ol">
<li>tabel.el 表格不支持“#+CAPTION”的用法</li>
<li>表格不能对齐的原因是没有采用等宽字体</li>
<li>取消自动换行，用M-x toggle-truncate-line命令取消</li>
</ol>

<p>
<b>1.创建表</b>
</p>

<p>
M-x table-insert 。此命令提示输入表格列数、表格行数、单元格宽度和单元格高度。
</p>
<div class="org-src-container">
<pre class="src src-sh">Number of columns (default 3): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#25968;&#65292;&#21363;&#27700;&#24179;&#21333;&#20803;&#26684;&#25968;</span>
Number of rows (default 3): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#34892;&#25968;&#65292;&#21363;&#22402;&#30452;&#21333;&#20803;&#26684;&#25968;</span>
Cell width(s) (default 5): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23485;&#24230;&#65292;&#21363;&#21333;&#20803;&#26684;&#23485;&#24230;</span>
Cell height(s) (default 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#39640;&#24230;&#65292;&#21363;&#21333;&#20803;&#26684;&#39640;&#24230;</span>
</pre>
</div>

<p>
范例： 创建表格，默认的
</p>
<ul class="org-ul">
<li>M-x table-insert 一路回车</li>
</ul>

<!-- This HTML table template is generated by emacs 31.0.50 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
</table>


<p>
<b>2.识别表</b>
</p>
<ul class="org-ul">
<li>M-x table-recognize-table 进入编辑模式。org-mode模式中进入编辑模式为 C-'</li>
<li>M-x table-unrecognize-table 退出编辑模式</li>
</ul>


<p>
<b>3.在表格中执行命令</b>
</p>

<p>
以下命令可放大或缩小单元格
</p>
<ul class="org-ul">
<li>M-x table-heighten-cell (C-}) 垂直放大当前单元格</li>
<li>M-x table-shorten-cell (C-{) 垂直收缩当前单元格</li>
<li>M-x table-narrow-cell (C-&lt;) 水平收缩当前单元格</li>
<li>M-x table-widen-cell (C-&gt;) 水平放大当前单元格</li>
<li>M-x table-justify (C-:) 表格对齐。选择对齐方式cell(仅当前单元格)、column(当前表格列中的所有单元格)和row(当前表格行中的所有单元格)。如cell&#x2013;&gt;(Left/Center/Right)</li>
</ul>

<p>
以下命令可合并或拆分单元格
</p>
<ul class="org-ul">
<li><p>
M-x table-span-cell (C-*) 合并表格
</p>

<p>
提示输入方向（right右、left左、above上方或below下方），并将当前单元与该方向上的相邻单元合并。
</p></li>

<li><p>
M-x table-split-cel 分裂表格
</p>

<p>
按提示分割：有vertically水平，horizontally垂直
</p>
<ul class="org-ul">
<li>M-x table-split-cell-vertically (C&#x2013;) 水平分割单元格。注意cell中必须已经存在多行字符串才有效</li>
<li>M-x table-split-cell-horizontally (C-|) 垂直分割单元格
<ul class="org-ul">
<li>按split分割，按光标位置自动将当前单元格分割；按left当前单元格向左移动向边新增一列；按right当前单元格向右移动左边新增一列</li>
</ul></li>
</ul></li>
</ul>


<p>
范例： 垂直放大第1行，放大2行。第2列单元格加宽些
</p>
<ul class="org-ul">
<li>进入编辑模式</li>
<li>光标在第1行单元格内，按 C-}</li>
<li>光标在第2列单元格内，按 C-&gt;</li>
</ul>

<!-- This HTML table template is generated by emacs 31.0.50 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;1&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;2&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;3&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
</table>


<!-- This HTML table template is generated by emacs 31.0.50 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;1&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;2&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;3&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
</table>

<p>
范例：编辑上面表格，合并第1和第2列; 水平切分第1单元格; 第1列左对齐
</p>
<ul class="org-ul">
<li>进入编辑模式</li>
<li>光标在第1列单元格内，按 C-*，选right向右合并。</li>
<li>光标在第1列第3行内，按 C&#x2013;，水平切分第1单元格。</li>
<li>光标在第1列单元格内，按 C-: 选left 向左对齐。</li>
</ul>

<!-- This HTML table template is generated by emacs 31.0.50 -->
<table border="1">
  <tr>
    <td colspan="2" align="left" valign="top">
      1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td rowspan="2" align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td colspan="2" align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      2&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      3&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
</table>

<p>
<b>4.表行和列</b>
</p>
<ul class="org-ul">
<li>M-x table-insert-row 在当前 table 行之前插入一行单元格。</li>
<li>M-x table-insert-column 在当前表列的左侧插入一列单元格</li>
<li>M-x table-delete-column 删除 point 处的单元格列</li>
<li>M-x table-delete-row 删除 point 处的单元格行</li>
</ul>

<p>
<b>5.在纯文本和 Tables 之间转换</b>
</p>

<ul class="org-ul">
<li>M-x table-capture 纯文本转换为 table.el 的表格。输入表格列分隔符、行分隔符正则表达式等参数。换行为Ctrl-q, Ctrl-j</li>
<li>M-x table-release 则相反：将table.el表格转换回纯文本，并删除其单元格边框。注意光标需要在表格内。</li>
<li>C-c |  纯文本转换为orgmode表格</li>
<li>M-x org-table-create-with-table.el (C-c ~) table.el 表格与org-mode 表格相互转换</li>
</ul>

<p>
范例：将下面文本转换为table.el文本表格。
</p>
<pre class="example" id="org626e6e7">
table-capture is a powerful command.
Here are some things it can do:

Parse Cell Items   Using row and column delimiter regexps,
                   it parses the specified text area and
                   extracts cell items into a table.
</pre>

<ul class="org-ul">
<li>选中文本，M-x table-capture，列和行分隔符 regexp 的字符串为空，将创建一个具有单个单元格的表</li>
</ul>

<!-- This HTML table template is generated by emacs 31.0.50 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      table-capture&nbsp;is&nbsp;a&nbsp;powerful&nbsp;command.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      Here&nbsp;are&nbsp;some&nbsp;things&nbsp;it&nbsp;can&nbsp;do:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      Parse&nbsp;Cell&nbsp;Items&nbsp;Using&nbsp;row&nbsp;and&nbsp;column&nbsp;delimiter&nbsp;regexps,&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;parses&nbsp;the&nbsp;specified&nbsp;text&nbsp;area&nbsp;and&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extracts&nbsp;cell&nbsp;items&nbsp;into&nbsp;a&nbsp;table.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
</table>

<ul class="org-ul">
<li>进入编辑模式 C-’</li>
<li>光标在第3行，空白单元格内。按 M-x table-split-cell-vertically (C&#x2013;) 水平分割单元格</li>
<li>光标在 Items 后空白处，M-x table-split-cell-horizontally (C-|) 垂直分割单元格
<ul class="org-ul">
<li>按split分割，按光标位置自动将当前单元格分割。</li>
<li>注意光标这里与下文本宽度一样，有利切分</li>
</ul></li>
<li>光标在最后一行内，按M-x table-shorten-cell (C-{) 垂直收缩当前单元格</li>
</ul>
<!-- This HTML table template is generated by emacs 31.0.50 -->
<table border="1">
  <tr>
    <td colspan="2" align="left" valign="top">
      table-capture&nbsp;is&nbsp;a&nbsp;powerful&nbsp;command.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      Here&nbsp;are&nbsp;some&nbsp;things&nbsp;it&nbsp;can&nbsp;do:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      Parse&nbsp;Cell&nbsp;Items<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;Using&nbsp;row&nbsp;and&nbsp;column&nbsp;delimiter&nbsp;regexps,<br />
      &nbsp;&nbsp;it&nbsp;parses&nbsp;the&nbsp;specified&nbsp;text&nbsp;area&nbsp;and&nbsp;&nbsp;<br />
      &nbsp;&nbsp;extracts&nbsp;cell&nbsp;items&nbsp;into&nbsp;a&nbsp;table.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
</table>

<p>
范例： 处理CSV格式文本
</p>
<pre class="example" id="org4a9cd1d">
,単位,最小,最大,平均
CPU使用率,%,10,90,50
磁盘使用率,Gb,100,200,150
内存使用率,Mb,200,500,250
</pre>

<p>
选择区域中文本并执行 M-x table-capture。 由于 minibuffer 需要输入如下：
</p>
<ul class="org-ul">
<li>Column delimiter regexp 列分隔符:,  逗号。</li>
<li>Row delimiter regexp 行分隔符: Ctrl-q，Ctrl-j 为换行</li>
<li>Justify对齐: center 居中</li>
<li>Minimum cell width最小单元格宽度: 15</li>
</ul>

<!-- This HTML table template is generated by emacs 31.0.50 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;単位&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最小&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最大&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;平均&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;CPU使用率&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;磁盘使用率&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;内存使用率&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;250&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
</table>

<ul class="org-ul">
<li>Org-mode模式下，按 M-x org-table-create-with-table.el (C-c ~) table.el 表格与org-mode 表格相互转换</li>
</ul>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">単位</td>
<td class="org-right">最小</td>
<td class="org-right">最大</td>
<td class="org-right">平均</td>
</tr>

<tr>
<td class="org-left">CPU使用率</td>
<td class="org-left">%</td>
<td class="org-right">10</td>
<td class="org-right">90</td>
<td class="org-right">50</td>
</tr>

<tr>
<td class="org-left">磁盘使用率</td>
<td class="org-left">Gb</td>
<td class="org-right">100</td>
<td class="org-right">200</td>
<td class="org-right">150</td>
</tr>

<tr>
<td class="org-left">内存使用率</td>
<td class="org-left">Mb</td>
<td class="org-right">200</td>
<td class="org-right">500</td>
<td class="org-right">250</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="outline-container-原生 emacs" class="outline-2">
<h2 id="原生 emacs">原生 Emas</h2>
<div class="outline-text-2" id="text-原生 emacs">
<p>
使用它的理由：<a href="http://emacs.sexy/">性感的 Emacs（Emacs is Sexy）</a>
</p>

<ul class="org-ul">
<li>GNU Emacs 于 1984 年，Richard Stallman 发起并维护</li>
<li>GNU 顶级项目</li>
<li>竞争对手 VIM，VSCode 等</li>
<li>跨平台，内核解释器 C 写成，通过 ELisp 语言进行扩展</li>
</ul>
</div>
<div id="outline-container-h:4a3be98f-297b-4bd3-9abc-18228235354f" class="outline-3">
<h3 id="h:4a3be98f-297b-4bd3-9abc-18228235354f">Emacs 的主要相关资料</h3>
<div class="outline-text-3" id="text-h:4a3be98f-297b-4bd3-9abc-18228235354f">
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs/">https://www.gnu.org/software/emacs/</a> ：官方主页，可在此下载安装包。</li>

<li><a href="https://www.gnu.org/software/emacs/documentation.html">https://www.gnu.org/software/emacs/documentation.html</a>: <code>GNU Emacs
  manual</code> 和 <code>Emacs Lisp Reference Manual</code> 最准确、最全面。有能力可以
直接按照官方文档进行学习。</li>

<li><a href="https://www.emacswiki.org">https://www.emacswiki.org</a>: Emacs Wik，关于 Emacs 插件、Emacs Lisp
的一些使用方法。</li>

<li><a href="https://emacs.stackexchange.com/">https://emacs.stackexchange.com/</a>: Emacs StackExchange 问答论坛，有
着大量关于 Emacs 的提问和精品回答。</li>

<li><a href="https://www.gnu.org/software/emacs/refcards/index.html">https://www.gnu.org/software/emacs/refcards/index.html</a>: Emacs Reference Card，
即 Emacs 备忘表（Cheatsheet）。前两个 PDF 是基本内容，<a href="https://www.gnu.org/software/emacs/refcards/pdf/refcard.pdf">基本操作卡片</a>和<a href="https://www.gnu.org/software/emacs/refcards/pdf/survival.pdf">生存卡片</a>。</li>

<li><a href="https://emacs-china.org/">https://emacs-china.org/</a>: Emacs-chin，国内社区，比较活跃。</li>
</ul>
</div>
</div>
<div id="outline-container-h:4000e4e5-df2b-4e72-af1e-ee4ad4f3904e" class="outline-3">
<h3 id="h:4000e4e5-df2b-4e72-af1e-ee4ad4f3904e">站在巨人肩膀上</h3>
<div class="outline-text-3" id="text-h:4000e4e5-df2b-4e72-af1e-ee4ad4f3904e">
<p>
<b>有一些 Emacs 发行版，预装了很多插件</b>
</p>

<p>
<a href="https://github.com/doomemacs/doomemacs">Doom Emacs</a> 和 <a href="https://www.spacemacs.org/">Spacemacs</a>，它们尤其对 Vim 转到 Emacs 的用户比较友好，因
为它们预装了 evil 插件，可以在 Emacs 上使用 Vi 的操作。
</p>

<p>
<b>使用大佬的配置</b>
</p>

<ul class="org-ul">
<li><a href="http://xahlee.info/">李杀</a>
<ul class="org-ul">
<li>Emacs Lisp 教程：<a href="http://xahlee.info/emacs/emacs/practical_elisp.html">http://xahlee.info/emacs/emacs/practical_elisp.html</a></li>
</ul></li>

<li><a href="https://github.com/purcell/emacs.d">Steve Purcell</a>
<ul class="org-ul">
<li><a href="https://www.emacswiki.org/emacs/StevePurcell">Steve Purcell</a> 是 <a href="https://melpa.org/">MELPA</a> 的维护者（MELPA 是 emacs 插件仓库）。</li>
</ul></li>

<li><a href="https://blog.binchen.org/">陈斌</a>
<ul class="org-ul">
<li>配置：<a href="https://github.com/redguardtoo/emacs.d">https://github.com/redguardtoo/emacs.d</a></li>
<li><a href="https://github.com/redguardtoo/mastering-emacs-in-one-year-guide/blob/master/guide-zh.org">一年成为Emacs高手</a></li>
<li><a href="https://emacs.liujiacai.net/podcast/005/">播客采访-陈斌</a></li>
<li>收费教程：<a href="https://edu.51cto.com/course/19329.html">如何提高编程速度 - Emacs高手教授轻松学习所有编辑器和IDE的秘诀</a></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:6e3e5604-dc5f-49c9-8acd-d7d6ddf84703" class="outline-3">
<h3 id="h:6e3e5604-dc5f-49c9-8acd-d7d6ddf84703">大佬答疑</h3>
<div class="outline-text-3" id="text-h:6e3e5604-dc5f-49c9-8acd-d7d6ddf84703">
<p>
<a href="https://emacs-china.org/u/ldbeth/">LdBeth</a>
</p>
<ul class="org-ul">
<li>大家说一说喜欢Emacs而不是vim的原因吧。
<ul class="org-ul">
<li>我一开始转到 Emacs 时也这么想过，后来发现是伪命题，我从 evil 转到原生键位后，把文件是否修改过放在 modeline 原本显示 evil 编辑模式的地方，到现在从未出过误修改的事情 我 vim 同时和 emacs 用了 2~3 年，期间也折腾过 vim 键位的浏览器什么的，现在 emacs 用了 11 年，完全不觉得需要 vim 键位</li>
<li>没有emacs的情况我用ed，因为plan9默认没有vi</li>
<li>写报告我都是写 HTML 的，从来不用 org 写东西</li>
</ul></li>
</ul>
</div>
<div id="outline-container-h:4220e050-30e9-4fe9-98d6-adf502c5545a" class="outline-4">
<h4 id="h:4220e050-30e9-4fe9-98d6-adf502c5545a">创建属于自己的配置</h4>
<div class="outline-text-4" id="text-h:4220e050-30e9-4fe9-98d6-adf502c5545a">
<p>
你可以使用大佬配置一段时间后总结出自己的配置，也可以从原生 Emacs入手，
即少量的配置。
</p>

<p>
路线一：
</p>
<ul class="org-ul">
<li><a href="#原生 emacs">原生 emacs</a></li>
<li>学习 emacs-lisp</li>
<li>自己做插件</li>
</ul>

<p>
路线二：
</p>
<ul class="org-ul">
<li><a href="#原生 emacs">原生 emacs</a></li>
<li><a href="#Org 管理">Org 管理</a></li>
<li>学习 emacs-lisp</li>
<li>不同场景插件包使用</li>
<li>自己做插件</li>
</ul>
</div>
</div>
</div>
</section>
<section id="outline-container-h:34f31360-59da-42ab-9286-962f47128f04" class="outline-2">
<h2 id="h:34f31360-59da-42ab-9286-962f47128f04">安装</h2>
<div class="outline-text-2" id="text-h:34f31360-59da-42ab-9286-962f47128f04">
<ul class="org-ul">
<li><a href="#h:04da44fe-12b5-4de9-afc1-126ff7ecfc15">源码安装 emacs</a>: 新手不推荐从源码进行编译安装，因为这会比较困难</li>
<li><a href="#h:b208cce7-bae0-468a-9080-ea0d8ba6ad60">二进制包安装</a></li>
</ul>

<p>
版本动态：
</p>
<ul class="org-ul">
<li>Emacs 30, 可以使用内置vc下载github代码</li>
<li>Emacs 28.1 正式发布，新增使用 GCC JIT 对 Emacs Lisp 字节码的执行进行
加速，可以显著提高 Emacs 的运行速度。</li>
<li>2023年4月底正式版本 28.2</li>
</ul>
</div>
<div id="outline-container-h:b208cce7-bae0-468a-9080-ea0d8ba6ad60" class="outline-3">
<h3 id="h:b208cce7-bae0-468a-9080-ea0d8ba6ad60">二进制包安装</h3>
<div class="outline-text-3" id="text-h:b208cce7-bae0-468a-9080-ea0d8ba6ad60">
<p>
<b>Unix</b>
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">Ubuntu</span>
sudo apt-get install emacs
<span style="color: #b22222;"># </span><span style="color: #b22222;">Fedora</span>
sudo dnf install emacs git ripgrep
<span style="color: #b22222;"># </span><span style="color: #b22222;">Arch</span>
sudo pacman -S emacs git ripgrep
</pre>
</div>

<p>
<b>MacOS</b>
</p>

<div class="org-src-container">
<pre class="src src-shell">brew install --cask emacs

<span style="color: #b22222;"># </span><span style="color: #b22222;">emacs-plus&#30340;Github&#39029;&#38754; https://github.com/d12frosted/homebrew-emacs-plus</span>
brew install emacs-plus@30 --with-xwidgets --with-imagemagick
</pre>
</div>

<p>
或者也可以在官网通过下载后拖动到 Applications 目录中即可使用。<a href="https://www.gnu.org/software/emacs/">https://www.gnu.org/software/emacs/</a>
</p>

<p>
<b>Windows emacs</b>
</p>

<p>
方法1：官网ftp下载
</p>

<p>
这是官方的 GNU Emacs，由自由软件基金会为 Windows 构建。下载地址：<a href="http://ftp.gnu.org/pub/gnu/emacs/windows/">http://ftp.gnu.org/pub/gnu/emacs/windows/</a>
</p>

<p>
这里下载 emacs-{最新版本}-x86_64.zip 包，解压到 <code>D:\Program Files\</code> ; GUI 启动：到 bin 目录下点击 runemacs 启动。addpm.exe 可把应用加到菜单中
</p>

<p>
方法2：用 <code>msys2</code> 安装
</p>

<p>
本文emacs安装在windows环境中，使用 <a href="https://www.msys2.org/">msys2</a> 工具安装。如安装到 <code>D:\msys64</code>, 并设置PATH变量(<code>D:\msys64\mingw64\bin</code>, <code>D:\msys64\usr\bin</code>)
</p>

<p>
更新msys2, 如下更新命令执行2遍
</p>
<div class="org-src-container">
<pre class="src src-sh">pacman -Suy
</pre>
</div>

<p>
添加msys2右键菜单： 创建 emacs-shell.reg注册表添加如下内容，双击执行即可
</p>
<pre class="example" id="orgbe47322">
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\Directory\Background\shell\MSYS2]
@="MSYS2 Bash Here"
"Icon"="d:\\msys64\\msys2.ico"

[HKEY_CLASSES_ROOT\Directory\Background\shell\MSYS2\command]
@="d:\\msys64\\msys2_shell.cmd -mingw64 -here"
</pre>

<p>
安装emacs
</p>
<div class="org-src-container">
<pre class="src src-sh">pacman -S mingw-w64-x86_64-emacs
</pre>
</div>

<p>
通过 <code>msys2</code> 安装的好处是上面还可以很方便安装其它开源软件, 如 <code>git</code>,
<code>epdfinfo</code> 等。
</p>

<p>
<b>windows FAQ</b>
</p>

<ul class="org-ul">
<li>Microsoft Windows 上的 emacs 初始化文件在哪里？</li>
</ul>

<p>
Microsoft Windows 中的 Emacs 初始化文件位置在 {Windows 10, Windows 8,
Windows 7, Windows Vista} 上，默认情况下，emacs 会查看以下目录/文件。
</p>

<div class="org-src-container">
<pre class="src src-sh">$<span style="color: #a0522d;">HOMEPATH</span>/AppData/Roaming/.emacs
.emacs &#25991;&#20214;&#26159;&#26087;&#30340; emacs &#32422;&#23450;&#65292;&#22312; 1990 &#24180;&#20195;&#21644; 2000 &#24180;&#20195;&#20351;&#29992;&#12290;

$<span style="color: #a0522d;">HOMEPATH</span>/AppData/Roaming/.emacs.d/init.el
.emacs.d/init.el &#26159;&#29616;&#20195;&#32422;&#23450;&#12290;
</pre>
</div>

<p>
如果您有名为 HOME 的环境变量，那么它位于：
</p>

<ul class="org-ul">
<li>$HOME/.emacs</li>
<li>$HOME/.emacs.d/init.el</li>
</ul>

<p>
HOME 是标准的 unix/linux 环境变量。 （默认情况下，Windows 中不存在。）
</p>

<p>
<b>windows 设置环境变量</b>
</p>

<p>
调用 2 个环境变量，HOME 和 PATH。HOME 找到 emacs 的用户目录，PATH 找到
emacs 和 cygwin 里的命令。请提前安装 cygwin 服务。
</p>

<p>
方法1：右击桌面 我的电脑 &gt; 属性 &gt; 高经系统设置 &gt; 高级 &gt; 环境变量 &gt; 用户
变量 &gt; 编辑
</p>

<p>
配置文件位置在： <code>/c/Users/me/AppData/Roaming</code> 用户主目录在这里。
</p>

<p>
如
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">HOME</span>
c:/Users/jasper
<span style="color: #b22222;"># </span><span style="color: #b22222;">Path</span>
D:\Program Files\emacs-27.2-x86_64\bin
D:\cygwin64\bin
</pre>
</div>

<p>
方法2：win10 powershell 执行
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #b22222;"># </span><span style="color: #b22222;">HOME &#29615;&#22659;&#21464;&#37327;</span>
[Environment]::SetEnvironmentVariable(<span style="color: #8b2252;">"HOME"</span>, <span style="color: #8b2252;">"c:/Users/jasper/"</span>, <span style="color: #8b2252;">"User"</span>)
<span style="color: #b22222;"># </span><span style="color: #b22222;">Path</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#21491;&#20987;&#26700;&#38754; &#25105;&#30340;&#30005;&#33041; ...</span>
</pre>
</div>

<p>
运行它后，重新启动 PowerShell 使用 <code>dir env:</code> 查看是否生效
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#30475;&#24403;&#21069;&#29615;&#22659;&#21464;&#37327;&#21644;PATH</span>
Get-ChildItem env:
$<span style="color: #a0522d;">env</span>:path -split <span style="color: #8b2252;">";"</span>
</pre>
</div>

<p>
当前使用版本：
</p>

<p>
启动 Emacs，然后查看版本。 <code>M-x emacs-version</code>
或者在命令行中查看版本。 <code>emacs --version</code>
</p>
</div>
</div>
<div id="outline-container-h:04da44fe-12b5-4de9-afc1-126ff7ecfc15" class="outline-3">
<h3 id="h:04da44fe-12b5-4de9-afc1-126ff7ecfc15">源码安装</h3>
<div class="outline-text-3" id="text-h:04da44fe-12b5-4de9-afc1-126ff7ecfc15">
<ul class="org-ul">
<li><a href="https://savannah.gnu.org/projects/emacs/">https://savannah.gnu.org/projects/emacs/</a> (官方地址，推荐)</li>
<li><a href="https://github.com/emacs-mirror/emacs">https://github.com/emacs-mirror/emacs</a> (github镜像)</li>
</ul>

<p>
下载源码，查看INSTALL文件中不同操作系统安装指引
</p>

<p>
<b>windows</b>
nt/INSTALL.W64
</p>

<p>
参考：<a href="https://eason0210.github.io/post/install-gccemacs/">https://eason0210.github.io/post/install-gccemacs/</a>
</p>

<p>
在 Mingw64 终端中执行以下命令安装依赖。
</p>
<div class="org-src-container">
<pre class="src src-sh">pacman -S --needed base-devel <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-toolchain <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-xpm-nox <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-gmp <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-gnutls <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-libtiff <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-giflib <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-libpng <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-libjpeg-turbo <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-librsvg <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-libwebp <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-lcms2 <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-libxml2 <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-zlib <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-harfbuzz <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-libgccjit <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-sqlite3 <span style="color: #8b2252;">\</span>
mingw-w64-x86_64-tree-sitter
</pre>
</div>

<p>
下载 Emacs 源代码
</p>
<div class="org-src-container">
<pre class="src src-sh">git clone -b master git://git.sv.gnu.org/emacs.git
<span style="color: #483d8b;">cd</span> emacs

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#25191;&#34892;./autogen.sh&#36807;&#31243;&#20013;&#20986;&#38169;&#65292;&#21487;&#33021;&#26159;&#22240;&#20026;&#20811;&#38534;&#20195;&#30721;&#21518; checkout &#26102;&#29992;&#20102; CRLF.</span>
git config core.autocrlf false
</pre>
</div>

<p>
编译 Emacs
</p>
<div class="org-src-container">
<pre class="src src-sh">./autogen.sh  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#25552;&#31034;&#29256;&#26412;&#19981;&#22815; pacman -Su autoconf</span>
./configure --prefix=/d/programs/emacs --without-dbus

<span style="color: #483d8b;">echo</span> $(<span style="color: #ff00ff;">nproc</span>)

make -j4
make install
<span style="color: #b22222;">#</span><span style="color: #b22222;">make install prefix=/d/opt/emacs #&#25351;&#23450;&#23433;&#35013;&#30446;&#24405;</span>
</pre>
</div>
<ol class="org-ol">
<li><code>echo $(nproc)</code> 会显示当前系统的 CPU 核心数；然后在 <code>make -j4</code> 就是使用 4 个核心进行编译, 推荐使用总数的一半，既提高了编译速度，也不影响其他应用的运行。</li>
<li>如果需要卸载的话在源码目录里面 <code>make uninstall</code> 就可以了。建议安装在指定目录，注意在路径中使用斜杠"/", 而不是反斜杠"\"。</li>
<li>如果编译过程出错了，记得 <code>make clean</code> 之后重新 <code>configure</code> 再 <code>make</code> 。</li>
</ol>

<p>
测试运行 Emacs
</p>

<p>
<code>bin\runemacs.exe -Q</code>
</p>

<p>
从 mingw64 shell 外部运行 Emacs 时，您需要
将 d：\msys64\mingw64\bin 添加到您的 Windows PATH，或复制所需的
DLL 添加到 Emacs 的 bin/ 目录中。 否则，TLS 等功能会导致
取决于那些DLL将丢失
</p>

<p>
将 <code>d:\programs\emacs\bin</code> 加入到环境变量。 如果和msys2中的emacs同存，将path中的源码安装的路径放在msys2的emacs前面。
</p>

<p>
创建快捷方式
</p>

<p>
请右键选择新建快捷方式，选择bin\runemacs.exe, 并起个名。 右键快捷方式 <code>属性</code> ，目标处添加命令行选项 <code>--debug-init</code> 
</p>
</div>
</div>
<div id="outline-container-h:8ece3a6c-013e-4dd8-a4e2-81cdd73670a6" class="outline-3">
<h3 id="h:8ece3a6c-013e-4dd8-a4e2-81cdd73670a6">启动 emacs</h3>
<div class="outline-text-3" id="text-h:8ece3a6c-013e-4dd8-a4e2-81cdd73670a6">
<p>
Emacs 可以在 GUI 模式（图形用户界面）下运行，也可以在文本终端内运行
</p>

<dl class="org-dl">
<dt>图形界面启动</dt><dd><code>emacs</code> 图形界面可以直接打开程序。命令行输入命令启动 Emacs。</dd>

<dt>文本终端启动</dt><dd><code>emacs -nw</code> 打开非图形界面版的 Emacs。可以结合挂起
一起使用。挂起 emacs <code>C-x C-z</code> (即 <code>Ctrl+x Ctrl+z</code>)，终端输入 <code>fg</code>
恢复到前台。 PS: <code>C</code> 为表示 Ctrl 键</dd>

<dt>启动并打开文件</dt><dd><code>emacs filename</code></dd>

<dt>不加载任何配置</dt><dd><code>emacs -q</code></dd>
</dl>


<p>
启动后可以看到这样的界面，可以看到其中有一个 "Emacs tutorial"，如果读
者英文不错，可以直接点击进入。
</p>
</div>
<div id="outline-container-h:2acc52d9-0fcd-48e3-bf1e-1b9e062cb39e" class="outline-4">
<h4 id="h:2acc52d9-0fcd-48e3-bf1e-1b9e062cb39e">以服务端形式启动 emacs</h4>
<div class="outline-text-4" id="text-h:2acc52d9-0fcd-48e3-bf1e-1b9e062cb39e">
<p>
参考官方 ：<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Server.html#Emacs-Server">https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Server.html#Emacs-Server</a>
</p>

<p>
<a href="https://github.com/daviwil/emacs-from-scratch/blob/d24357b488862223fecaebdad758b136b0ca96e7/show-notes/Emacs-Tips-08.org">https://github.com/daviwil/emacs-from-scratch/blob/d24357b488862223fecaebdad758b136b0ca96e7/show-notes/Emacs-Tips-08.org</a>
</p>

<p>
在 Unix-like 的操作系统中，可以通过设置 EDITOR 环境变量来配置命令行工
具（比如 git commit）默认的文本编辑器，比如
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">export</span> <span style="color: #a0522d;">EDITOR</span>=vim
<span style="color: #483d8b;">export</span> <span style="color: #a0522d;">EDITOR</span>=emacs
</pre>
</div>

<p>
但通过这种方式，每一次都会新创建一个编辑器实例，这时就用到了 <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Server.html">Emacs Server 模式</a>。
</p>

<p>
Server 模式只需要启动一次，后续使用时通过 emacsclient 进行连接即可。
</p>

<ul class="org-ul">
<li>Emacs 中: <code>M-x server-start</code></li>
<li><p>
配置文件添加如下：
</p>
<div class="org-src-container">
<pre class="src src-sh">(unless (server-running-p)
 (server-start))
</pre>
</div></li>
<li>命令行</li>
</ul>

<p>
通过在命令行执行
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #b22222;"># </span><span style="color: #b22222;">3 &#31181;&#21551;&#21160;&#23432;&#25252;&#26041;&#24335;</span>
emacs --daemon
emacs --daemon=work <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21487;&#22810;&#36827;&#31243;&#23432;&#25252;</span>
emacs --fg-daemon <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21069;&#21488;</span>

emacsclient -e <span style="color: #8b2252;">"(kill-emacs)"</span> <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20851;&#38381; emacs &#23432;&#25252;&#36827;&#31243;</span>
emacsclient -f work -c -n <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25351;&#23450;&#23432;&#25252;&#36827;&#31243;&#36830;&#25509;</span>
</pre>
</div>

<p>
也通过 emacsclient 来直接启动 server 模式，命令如下：
</p>

<div class="org-src-container">
<pre class="src src-bash">emacsclient -a <span style="color: #8b2252;">""</span> -c -n <span style="color: #8b2252;">"$@"</span>
</pre>
</div>

<p>
各参数的解释：
</p>
<ul class="org-ul">
<li><code>-c</code> 新建一个frame。这个参数也让 <code>emacsclientw</code> 不要求提供文件名。</li>
<li><code>-n</code> 表示执行完该命令后，立刻退出，不用等待 server 返回。这也非常重
要，否则终端就不会立刻返回了。</li>
<li><code>-a</code> 是 alternate-editor 的简写，意思是在连接 server 失败时的替代编
辑器，当为空值时，会自动执行 emacs &#x2013;daemon ，然后再去连接。这样就解
决了完美解决了重复调用 daemon 时的错误，而且也能在第一次调用时启动
server 模式</li>
</ul>


<p>
做成别名方便调用
</p>
<div class="org-src-container">
<pre class="src src-bash">vim ~/.bash_profile
<span style="color: #483d8b;">alias</span> <span style="color: #a0522d;">e</span>=<span style="color: #8b2252;">'emacsclient -a "" -c -n "$@"'</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;</span>
e ~/.bashrc
</pre>
</div>

<p>
<b>像 Vim 一样读取 stdin</b>
</p>

<p>
在 Vim 中可以用 <code>vim -</code> 读取标准输入的内容，比如
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">echo</span> 123 | vim -
</pre>
</div>

<p>
很遗憾，默认 emacs/emacsclient 命令是不支持这种方式的，但可以通过<a href="https://superuser.com/questions/31404/how-to-make-emacs-read-buffer-from-stdin-on-start/843744#843744">间接的方式</a>实现
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">cat ~/bin/e</span>
<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">_emacsclient</span>
{
  emacsclient -a <span style="color: #8b2252;">""</span> -c -n <span style="color: #8b2252;">"$@"</span>
}

<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">main</span>
{
  <span style="color: #b22222;"># </span><span style="color: #b22222;">If the argument is - then write stdin to a tempfile and open the</span>
  <span style="color: #b22222;"># </span><span style="color: #b22222;">tempfile.</span>
  <span style="color: #a020f0;">if</span> [[ $<span style="color: #a0522d;">#</span> -ge 1 ]] &amp;&amp; [[ <span style="color: #8b2252;">"$1"</span> == - ]]; <span style="color: #a020f0;">then</span>
    <span style="color: #a0522d;">tempfile</span>=<span style="color: #8b2252;">"$(</span><span style="color: #ff00ff;">mktemp -t emacs-stdin-$USER.XXXXXXX</span><span style="color: #8b2252;">)"</span>
    cat - &gt; <span style="color: #8b2252;">"$tempfile"</span>
    _emacsclient --eval <span style="color: #8b2252;">"(find-file \"$tempfile\")"</span> <span style="color: #8b2252;">\</span>
          --eval <span style="color: #8b2252;">'(set-visited-file-name nil)'</span> <span style="color: #8b2252;">\</span>
          --eval <span style="color: #8b2252;">'(rename-buffer "*stdin*" t))'</span>
  <span style="color: #a020f0;">else</span>
    _emacsclient <span style="color: #8b2252;">"$@"</span>
  <span style="color: #a020f0;">fi</span>
}

main <span style="color: #8b2252;">"$@"</span>
</pre>
</div>

<p>
上述脚本通过重定向到一个临时文件的方式来解决，这样 emacsclient 就能够
像 Vim 一样读取 stdin 了。参考：<a href="https://emacstalk.codeberg.page/post/020/">https://emacstalk.codeberg.page/post/020/</a>
</p>

<p>
<b>mac 设置 emacsclient 为文件默认打开程序</b>
</p>

<p>
参考： <a href="https://emacstalk.codeberg.page/post/006/">https://emacstalk.codeberg.page/post/006/</a>
</p>


<p>
对于 Emacs 熟练用户来说，大部分都会选择启动 server 模式，这样可以加速
后续的启动时间，为与其他命令行工具组合使用奠定基础。 本文介绍一种将
emacsclient 设置为文件默认打开程序的方式，适用平台 macOS。
</p>

<ul class="org-ul">
<li>打开 Automator ，新创建 <code>应用</code> 类型文档</li>

<li><p>
Action 选择 Run Shell Script ， Pass input 设为 as arguments ，并输入以下内容：
</p>
<div class="org-src-container">
<pre class="src src-sh">/Applications/Emacs.app/Contents/MacOS/bin/emacsclient -n -c <span style="color: #8b2252;">"$@"</span>
</pre>
</div>

<p>
上面的 shell 命令，不需要 <code>&amp;</code> ，只需要加上 <code>-n</code> 选项后，即可在执行后，
立刻退出该应用
</p></li>

<li>导出应用</li>
<li>在 Finder 中找到需要修改打开程序的文件，按 <code>M-i</code> ，在 Open With 子栏
中选择刚才导出的应用，并点击 Change All</li>
</ul>

<p>
这样以后在打开相同后缀名的文件时，就会用 emacsclient 打开了。
</p>

<p>
<b>windows 右键菜单添加 Open With Emacs 功能</b>
</p>

<p>
创建注册表文件 emacs-context.reg
</p>

<div class="org-src-container">
<pre class="src src-sh">Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT<span style="color: #8b2252;">\*</span>\shell]
[HKEY_CLASSES_ROOT<span style="color: #8b2252;">\*</span>\shell\openwemacs]
@=<span style="color: #8b2252;">"&amp;Edit with Emacs"</span>
[HKEY_CLASSES_ROOT<span style="color: #8b2252;">\*</span>\shell\openwemacs\command]
@=<span style="color: #8b2252;">"D:\\msys64\\mingw64\\bin\\emacsclientw.exe -n \"%1\""</span>
[HKEY_CLASSES_ROOT\Directory\shell\openwemacs]
@=<span style="color: #8b2252;">"Edit &amp;with Emacs"</span>
[HKEY_CLASSES_ROOT\Directory\shell\openwemacs\command]
@=<span style="color: #8b2252;">"D:\\msys64\\mingw64\\bin\\emacsclientw.exe -n \"%1\""</span>
</pre>
</div>

<p>
使用这个 OpenWithEmacs 的功能，Emacs 需要开启 Server Mode，代码如下：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(server-mode 1)
</pre>
</div>

<p>
双击注册文件。这时右键打开文件就可以选择emacs打开了。
</p>
</div>
</div>
</div>
<div id="outline-container-h:eac8b743-ad6d-4f05-b87a-6e7ea0fd059b" class="outline-3">
<h3 id="h:eac8b743-ad6d-4f05-b87a-6e7ea0fd059b">退出 Emacs</h3>
<div class="outline-text-3" id="text-h:eac8b743-ad6d-4f05-b87a-6e7ea0fd059b">
<p>
在 emacs 中，键入 <code>C-x C-c</code> (<code>M-x save-buffers-kill-terminal</code> M 为PC/Mac: Alt/Option 键 )
</p>

<p>
或者，只需 <code>M-x Kill-emacs</code> （这不会要求您保存未保存的文件。并且还会
退出 emacs 守护进程）
</p>

<p>
如果您按下的按键看起来很奇怪，请按 <code>C-g</code> 。 这将取消您可能误按的按键序列。
</p>
</div>
</div>
<div id="outline-container-h:0aa6b359-22fa-40b7-8a7d-74688d667915" class="outline-3">
<h3 id="h:0aa6b359-22fa-40b7-8a7d-74688d667915">多版本emacs启动</h3>
<div class="outline-text-3" id="text-h:0aa6b359-22fa-40b7-8a7d-74688d667915">
<div class="org-src-container">
<pre class="src src-sh">--batch                    <span style="color: #a020f0;"> do</span> not<span style="color: #a020f0;"> do</span> interactive display; implies -q
--debug-init                enable Emacs Lisp debugger for init file
--no-init-file, -q          load neither ~/.emacs nor default.el &#21516;--no-init 
--no-site-file             <span style="color: #a020f0;"> do</span> not load site-start.el
--no-site-lisp, -nsl       <span style="color: #a020f0;"> do</span> not add site-lisp directories to load-path
--no-splash                <span style="color: #a020f0;"> do</span> not display a splash screen on startup
--no-x-resources           <span style="color: #a020f0;"> do</span> not load X resources
--quick, -Q                 equivalent to:   &#27809;&#26377; *Message* &#20869;&#23481;
                              -q --no-site-file --no-site-lisp --no-splash
                              --no-x-resources

--script FILE               run FILE as an Emacs Lisp script &#21482;&#36816;&#34892; List &#33050;&#26412;
--load, -l FILE         load Emacs Lisp FILE using the load <span style="color: #a020f0;">function</span> <span style="color: #0000ff;">&#22270;&#24418;&#30028;&#38754;&#21152;&#36733;</span>
--funcall, -f FUNC      call Emacs Lisp <span style="color: #a020f0;">function</span> <span style="color: #0000ff;">FUNC</span> with no arguments &#36816;&#34892;&#20989;&#25968;
</pre>
</div>

<p>
区别：
</p>
<ul class="org-ul">
<li>有 <code>--script</code> 参数指定配置文件会以交互式终端运行代码，会产生非空
<code>~/org-timestamps=文件夹。有时会影响某些插件功能，比如 =htmlize</code> 插
件导出 html 页面代码块无法高亮问题</li>
<li>有 <code>--load</code> 参数指定配置文件会以图形界面运行代码，会产生空 <code>~/.emac
  s.d</code> 和非空 <code>~/org-timestamps</code> 文件夹。</li>
<li>有 <code>--batch</code> 参数不会产生 <code>~/.emacs.d</code> 文件夹。同样非交互终端会影响
某些插件，如 <code>htmlize</code> 高亮显示</li>
</ul>

<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">## </span><span style="color: #b22222;">windows</span>
env <span style="color: #a0522d;">HOME</span>=~/emacs-demo emacs --debug-init

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25351;&#23450;&#21152;&#36733;&#30340;&#25991;&#20214;</span>
$ env <span style="color: #a0522d;">HOME</span>=./ emacs -q --load build-site.el  --debug-init
$ env <span style="color: #a0522d;">HOME</span>=./ emacs --batch --no-init-file  --load build-site.el --funcall org-publish-all

<span style="color: #b22222;">## </span><span style="color: #b22222;">Linux/MacOS</span>
(<span style="color: #a0522d;">HOME</span>=$(<span style="color: #ff00ff;">pwd</span>) emacs --debug-init)
</pre>
</div>
</div>
</div>
</section>
<section id="outline-container-h:d75895f0-3e35-4c6e-ba3a-691b52a6ba07" class="outline-2">
<h2 id="h:d75895f0-3e35-4c6e-ba3a-691b52a6ba07">用户界面</h2>
<div class="outline-text-2" id="text-h:d75895f0-3e35-4c6e-ba3a-691b52a6ba07">
<p>
首先我们需要了解 Emacs 界面的一些术语。了解术语更多是为了在网上搜资料、
看文档、配置时能够更准确地抓住关键。
</p>


<p alt="cat/spider image" title="Action!" width="90%">
<img src="./images/Snipaste_2022-06-01_23-00-01.png" alt="cat/spider image" title="Action!" width="90%">]]
</p>



<figure id="org678db9c">
<img src="./images/img_20240115_095258.png" alt="img_20240115_095258.png" width="90%">

<figcaption><span class="figure-number">Figure 1: </span>终端界面</figcaption>
</figure>

<dl class="org-dl">
<dt><code>Frame</code></dt><dd><p>
如果用图形界面打开 Emacs 程序，那么一整个程序窗口被称为 Frame。
</p>

<p>
如果打开了多个窗口就有多个 Frame；如果在终端内打开 Emacs，那么 Emacs
所占据的整个终端的界面被称为 Frame。上图都是一个 Frame。
</p></dd>

<dt><code>Menu bar</code></dt><dd><p>
即菜单栏，在 Frame 的最上方。默认包括了 File、Edit……
等等下拉菜单。
</p>

<p>
在终端中不能用鼠标时，需要用 <code>menu-bar-open</code> 命令打开，对应快捷键 <code>&lt;
  f10&gt;</code> 。此外还有一个 <code>M-`</code> 键（对应命令 <code>tmm-menubar</code> ）可以从下方
展开互动界面打开菜单。
</p></dd>

<dt><code>Tool bar</code></dt><dd><p>
即工具栏。只在图形界面时可以使用，就是上面图中那一些图标。
</p>

<p>
由于它十分丑陋且功能又很基本，所以正常笔者会关掉工具栏——在配置文件中
加入代码 <code>(tool-bar-mode -1)</code> 。
</p></dd>

<dt><code>Window</code></dt><dd><p>
Tool bar 以下（如果有）、Echo area 以上这一整个区域，就
是 Window，即窗口。
</p>

<p>
这也是Buffer，即编辑区域。编写操作都会在这里进行。
</p>

<p>
可以看到 Emacs 的窗口和我们日常使用电脑所说的窗口不是一个东西，一定
要注意，不然在配置、调用命令或者在网上搜索信息时会搞错。我们日常称为
窗口的在 Emacs 中被称为 Frame，而 Frame 内的核心区域才被称为 Window。
</p></dd>
</dl>


<dl class="org-dl">
<dt><code>Mode line</code></dt><dd><p>
位于回显区正上方的一行被称为“状态栏”。 或叫 "模式行"。
</p>

<p>
状态栏上会显示一些信息，比如：
</p>

<p>
<code>-:**- TUTORIAL.cn 63% L749 (Fundamental)</code>
</p>

<p>
<code>63%</code> 显示的是光标在全文中的位置。
</p>

<p>
<code>L749</code> 光标所在行的行号
</p>

<p>
<code>*</code> 表示文件被修改
</p>

<p>
<code>(Fundamental)</code> 当前正使用的编辑模式。缺省的模式是 Fundamental，就是
你现在正在使用的这个。它是一种“主模式”。主模式都是可以用 M-x 启动
的扩展命令，M-x fundamental-mode 就可以切换到 Fundamental模式。
</p>

<p>
它的内容可以自定义，也可以使用 smart-mode-line 插件进行管理。
</p></dd>

<dt><code>Echo Area</code></dt><dd>整个界面下方的一行就是"回显区"，用以打印各种简短的信
息。也叫 <code>minibuffer</code> 。例如输出信息， <code>M-x</code> 操作等。</dd>

<dt><code>Scroll bar</code></dt><dd><p>
图形界面时 Window 的最右侧有一滚动条。
</p>

<p>
如果不需要用滚动条，在配置中加入
<code>(when (display-graphic-p) (toggle-scroll-bar -1))</code> 表示在是用图形界
面时关闭滚动条。
</p></dd>

<dt><code>Cursor</code></dt><dd>光标。光标是一个 1 字符宽的方块，但其真正表达的位置是其
左侧的长边，即两字符之间。</dd>

<dt><code>Point</code></dt><dd>光标所在的位置称为 Point。区别于光标的是，光标有且只有一
个，但 Point 是针对 Buffer 的，每个 Buffer 都有一个 Point。许多命令
的触发都要读取 Point 信息。</dd>
</dl>

<p>
附录
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">操作描述</th>
<th scope="col" class="org-left">快捷键</th>
<th scope="col" class="org-left">命令名</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">下拉菜单栏</td>
<td class="org-left">&lt;f10&gt;</td>
<td class="org-left">menu-bar-open</td>
</tr>

<tr>
<td class="org-left">互动菜单栏</td>
<td class="org-left">M-`</td>
<td class="org-left">tmm-menubar</td>
</tr>
</tbody>
</table>

<p>
Mode Line
</p>
<ul class="org-ul">
<li>smart-mode-line</li>
</ul>
</div>
</section>
<section id="outline-container-h:49e40af4-8439-42d9-bdd6-e9291c30d9a0" class="outline-2">
<h2 id="h:49e40af4-8439-42d9-bdd6-e9291c30d9a0">基本操作速记</h2>
<div class="outline-text-2" id="text-h:49e40af4-8439-42d9-bdd6-e9291c30d9a0">
<p>
功能键
</p>
<ul class="org-ul">
<li>Meta：缩写 <code>M</code> ，对应键盘按键(PC/Mac)：Alt / Option</li>
<li>Control：缩写 <code>C</code> ，对应键盘按键(PC/Mac)：Ctrl / Controll</li>
</ul>

<p>
初学不用记太多，先学习一点点光标移动。
</p>

<p>
光标移动，形成肌肉记忆之前可通过速记法来记忆
</p>
<ul class="org-ul">
<li>C-n，下移至下一行(速记：Nextline)。</li>
<li>C-p，上移至前一行(速记：Previous line)。</li>
<li>C-f，前移一个字符(速记：Forward)。</li>
<li>C-b，后移一个字符(速记：Backforward)。</li>
<li>C-a，移至行首， a 代表 ahead。</li>
<li>C-e，移至行尾， e 代表 end。</li>
<li>C-k，从光标位置到行尾删除(速记：Kill)。</li>
<li>M-&lt;，回到编辑区域最开始位置(速记：&lt;)。</li>
<li>M-&gt;，去往编辑区域最后的位置(速记：&gt;)。</li>
<li>C-v，向下翻一屏。</li>
<li>M-v，向上翻一屏。</li>
</ul>
</div>
</section>
<section id="outline-container-h:3d891b51-d4f8-4492-9af3-165c488e332a" class="outline-2">
<h2 id="h:3d891b51-d4f8-4492-9af3-165c488e332a">功能键</h2>
<div class="outline-text-2" id="text-h:3d891b51-d4f8-4492-9af3-165c488e332a">
<p>
Emacs 中有五个功能键： Control、 Meta、 Shift、 Super、 Hyper。那是几
十年前的键盘上的按键名称，其中的 Hyper 键更是在现代键盘上消失了。
</p>

<ul class="org-ul">
<li>Meta：缩写 <code>M</code> ，对应键盘按键(PC/Mac)：Alt / Option</li>
<li>Control：缩写 <code>C</code> ，对应键盘按键(PC/Mac)：Ctrl / Controll</li>
<li>Shift： <code>S</code> ，对应键盘按键(PC/Mac)：Shift / Shift</li>
<li>Super： <code>s</code> ，对应键盘按键(PC/Mac)：Win / Command</li>
<li>Hyper： <code>H</code> ，对应键盘按键(PC/Mac)：无</li>
</ul>

<p>
其它键说明：
</p>

<ul class="org-ul">
<li><code>DEL</code>: 意指退格键 (不是 删除(Delete) key)，从 <code>&lt;backspace&gt;</code> 翻译而来</li>
<li><code>RET</code>: 意指回车键</li>
<li><code>SPC</code>: 意指空格键</li>
<li><code>ESC</code>: 意指Escape键</li>
<li><code>TAB</code>: 意指Tab键</li>
<li><code>&lt;left&gt;</code>: 左方向键</li>
<li><code>&lt;right&gt;</code>: 右方向键</li>
</ul>

<p>
那么我们知道， Super 键在现代系统中起到了重要作用，因此 Emacs 平常不使
用和 Super 键相关的快捷键，Emacs 的绝大多数快捷键都是使用 Control 和
Meta 键，而其中一大部分都是只使用 Control 键。
</p>

<blockquote>
<p>
尽管 Hyper 键已经消失了，但是 Emacs 依然可以使用这个功能键，例如如果读
者手上的键盘有一些不常用的按键，可以考虑设定为 Hyper 键，拓宽快捷键。
</p>

<p>
事实上 Emacs 中也有 Alt 键，但现在键盘上的 Alt 键都是被映射为 Meta，
Alt 键也几乎不去使用了，为避免混淆就没有放到正文中介绍. 
</p>
</blockquote>

<p>
Emacs 用连字符表示 <code>同时按下</code> 。
</p>

<ul class="org-ul">
<li>我们用 <code>C-a</code> 表示先按下 Control 键不要松，再按下 a 键。 <code>C-x b</code> 则
表示先按下 Control 键不松，按下 x 键，松开这两个键，按下 b 键。</li>
<li><code>C-S-&lt;mouse-1&gt;</code> 表示同时按下 Control 键和 Shift 键，然后鼠标左键点
击。这里提到了鼠标是因为 Emacs 图形界面支持鼠标操作，并且在有些场景
下的确使用鼠标更为方便（例如无规律的多光标选择）。</li>
<li>特别的， <code>Meta</code> 键做前缀有两种按法，例如 <code>M-x</code> 可以按住 Meta 键不要
松，再按下 x 键，也可以先按一下 <code>Esc</code> 键松开，再按一下 x 键。后者是
为了在应对无法使用 Meta 键的硬件或系统，但实际操作有很多不便。因此读
者尽可能使用 <code>Alt/Option</code> 作为 Meta 键来按。</li>
</ul>

<pre class="example" id="org426ace6">
一些终端例如 Mac 自带的终端默认不会把 Option 键作为 Meta 传入，但只需
打开它的偏好设置，其中 "Profiles - Keyboard" 中有一项 "将 Option 用作
Meta 键"，勾选即可。iTerm2 同理。
</pre>

<p>
长时间使用 Control 键可能会小指疼，这时可以改用 <code>手掌</code> 来按。不过这里
还是会介绍几个方案给需要的朋友。
</p>
</div>
<div id="outline-container-h:bb2e9786-ff6d-4e7f-b275-81c82418b9bd" class="outline-3">
<h3 id="h:bb2e9786-ff6d-4e7f-b275-81c82418b9bd">改键-Control 键改到了大小写锁定键上</h3>
<div class="outline-text-3" id="text-h:bb2e9786-ff6d-4e7f-b275-81c82418b9bd">
<p>
交换 <code>&lt;大写锁定键&gt;</code> 与 <code>&lt;control&gt;</code>.
</p>

<p>
Emacs 常常使用 以 <code>&lt;control&gt;</code> 开始的快捷键。 在 Emacs 诞生之初时通用的
键盘, <code>&lt;control&gt;</code> 确实是在当今键盘 <code>&lt;caps lock&gt;</code> 的位置的。 交换这两个
键的具体操作在不同系统上也不一样。
</p>

<dl class="org-dl">
<dt>windows</dt><dd>需要去修改注册表. 方法如下
<ul class="org-ul">
<li><code>&lt;Win&gt; + r</code> 输入 <code>regedit</code> 打开注册表</li>
<li>找到 <code>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout]</code></li>
<li><p>
打开或新建 <code>Scancode</code> 文件, 把内容修改为
</p>
<div class="org-src-container">
<pre class="src src-sh">00 00 00 00 00 00 00 00
03 00 00 00 1d 00 3a 00 
3a 00 1d 00 00 00 00 00
</pre>
</div></li>
<li>保存 <code>Scancode</code> 文件并重启电脑</li>
</ul></dd>

<dt>ubuntu</dt><dd><p>
在 Ubuntu 下, 可以使用图形界面的 <code>gnome-tweaks</code> 找到交换
<code>&lt;caps lock&gt;</code> 和 <code>&lt;control&gt;</code> 的设置。安装 <code>gnome-tweaks</code> 可以通过
<code>apt</code> 进行:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo apt install gnome-tweaks
</pre>
</div>

<p>
然后打开 <code>gnome-tweaks</code> 的键盘设置, 在高级选项里有关于 <code>&lt;control&gt;</code>
键的设置。你不仅仅可以交换它与 <code>&lt;caps lock&gt;</code>, 也可以进行许多别的设置。
</p>

<p>
又或者, 在很多 Linux 系统的命令行下输入
</p>

<div class="org-src-container">
<pre class="src src-sh">setxkbmap -option ctrl:swapcaps
</pre>
</div>

<p>
也可以交换 <code>&lt;caps lock&gt;</code> 与 <code>&lt;control&gt;</code> 。
</p></dd>

<dt>MacOS</dt><dd>在 MacOS 中, 大家可以在 <code>system</code> -&gt; <code>keyboard</code> -&gt;  <code>functional keys</code> 中调整所有功能键的键位.</dd>
</dl>


<p>
推荐一款改键软件 <a href="https://karabiner-elements.pqrs.org/">Karabiner-Elements</a>，它甚至可以将 Emacs 常用键位完全
拓展到全局。
</p>
</div>
</div>
<div id="outline-container-h:5c99dba9-0317-4d27-bd8b-f34b8f99c124" class="outline-3">
<h3 id="h:5c99dba9-0317-4d27-bd8b-f34b8f99c124">改键-Mac-Windows统一键位</h3>
<div class="outline-text-3" id="text-h:5c99dba9-0317-4d27-bd8b-f34b8f99c124">
<p>
改键的作用除了可以让你的小拇指更健康以外，还可以统一我们的交流语言，
让大家后面学习过程可以更轻松。
</p>

<ul class="org-ul">
<li>M(eta)：统一对应键盘按键(PC/Mac)：left windows/option</li>
<li>s(uper)：统一对应键盘按键(PC/Mac)：left Alt/command</li>
<li>C(trl)：统一对应键盘按键(PC/Mac): Caps Lock</li>
</ul>

<p>
Mac 只需要改大写键，Windows 对齐mac的布局。
</p>
<dl class="org-dl">
<dt>MacOS</dt><dd>在 MacOS 中, 大家可以在 <code>system</code> -&gt; <code>keyboard</code> -&gt;  <code>functional keys</code> 中调整所有功能键的键位.</dd>
</dl>

<p>
<b>Windows 改键方法:</b>
</p>

<p>
SharpKeys， AutoHotkey 工具任选一种。
</p>

<p>
使用 SharpKeys 来把 Left Window 键改成 Left Alt 键，Left Alt 键改成 A
pp 键，大小写键改成 Ctrl 键。
</p>

<p>
官方下载：<a href="https://github.com/randyrants/sharpkeys">https://github.com/randyrants/sharpkeys</a>，安装后 win 菜单搜
索 sharpkey，修改完成后写入注册表重新开机生效。
</p>


<figure id="org38c0312">
<img src="./images/image-20220116230304667.png" alt="image-20220116230304667.png">

</figure>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">原键</td>
<td class="org-left">目标键</td>
<td class="org-left">说明</td>
</tr>

<tr>
<td class="org-left">Caps Lock(00_3A)</td>
<td class="org-left">Left Ctrl(01_1D)</td>
<td class="org-left">大小写键改成Ctrl键</td>
</tr>

<tr>
<td class="org-left">Left Alt(00_38)</td>
<td class="org-left">Application(E0_5D)</td>
<td class="org-left">左Alt键改成App键</td>
</tr>

<tr>
<td class="org-left">Left Windows(E0_5B)</td>
<td class="org-left">Left Alt(00_38)</td>
<td class="org-left">左视窗键改成左Alt键</td>
</tr>

<tr>
<td class="org-left">Right Alt(E0_38)</td>
<td class="org-left">Left Windows(E0_5B)</td>
<td class="org-left">右Alt键改成左视窗键</td>
</tr>
</tbody>
</table>


<p>
使用 AutoHotkey  把大写锁定键替换为 Control 键的教程：<a href="https://www.emacswiki.org/emacs/MovingTheCtrlKey">移动 Control 键 (Moving The Ctrl Key)</a>
</p>

<p>
这里win10使用的AutoHotkey工具。
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#21019;&#24314;&#25991;&#20214;capslock.ahk &#28155;&#21152;&#20869;&#23481;</span>
CapsLock::Ctrl
<span style="color: #b22222;">#</span><span style="color: #b22222;">capslock.ahk&#28982;&#21518;&#28857;&#20987;RunScript&#23601;&#22909;&#21862; </span>
</pre>
</div>

<p>
Emacs 默认 Alt 键就是 Meta，而 App 键我们改成 super 键，可以通过下面
的 Elisp 代码来完成。
</p>


<p>
window 配置
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> w32-apps-modifier 'super)       <span style="color: #b22222;">; </span><span style="color: #b22222;">&#36890;&#36807;SharpKeys&#25913;&#25104;&#20102; Application</span>
</pre>
</div>

<p>
将配置放到 emacs 配置文件中，默认是没有这里直接新建一个 <code>$HOME/.emacs
.d/init.el</code> C-y 复制 , 语句后执行 C-x C-e 生效。
</p>

<p>
<b>MAC 改键方法：</b>
</p>

<p>
Mac 下面大小写键改成 Ctrl 键，Mac 系列只需要修改这个按键，其他的按键可
以通过 Elisp 来修改：
</p>

<p>
键盘设置 &#x2013;&gt; Modifier keys
</p>

<p>
<a href="https://book.emacs-china.org/Images/mac-change-ctrl.png">chang-ctrl</a>
</p>


<p>
mac 配置
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;  </span><span style="color: #b22222;">Opt -&gt; meta : M, Cmd -&gt; super : s</span>
(<span style="color: #a020f0;">setq</span> mac-option-modifier 'meta
      mac-command-modifier 'super)
</pre>
</div>


<p>
<b>定义常用操作</b>
</p>

<p>
现在我们可以把 Mac 下面的复制、粘贴、剪切、全选等命令移植到 Emacs 中
来了，并且这一套按键是跨平台的。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #8b2252;">"s-a"</span>) 'mark-whole-buffer) <span style="color: #b22222;">;;</span><span style="color: #b22222;">&#23545;&#24212;Windows&#19978;&#38754;&#30340;Ctrl-a &#20840;&#36873;</span>
(global-set-key (kbd <span style="color: #8b2252;">"s-c"</span>) 'kill-ring-save) <span style="color: #b22222;">;;</span><span style="color: #b22222;">&#23545;&#24212;Windows&#19978;&#38754;&#30340;Ctrl-c &#22797;&#21046;</span>
(global-set-key (kbd <span style="color: #8b2252;">"s-s"</span>) 'save-buffer) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23545;&#24212;Windows&#19978;&#38754;&#30340;Ctrl-s &#20445;&#23384;</span>
(global-set-key (kbd <span style="color: #8b2252;">"s-v"</span>) 'yank) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#23545;&#24212;Windows&#19978;&#38754;&#30340;Ctrl-v &#31896;&#36148;</span>
(global-set-key (kbd <span style="color: #8b2252;">"s-z"</span>) 'undo) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#23545;&#24212;Windows&#19978;&#38754;&#30340;Ctrol-z &#25764;&#38144;</span>
</pre>
</div>


<p>
按键绑定设置
</p>
<ul class="org-ul">
<li>Global : global-(set|unset)-key</li>
<li>Local : local-(set|unset)-key</li>
</ul>
</div>
</div>
</section>
<section id="outline-container-h:e7c6d8c5-cd42-420f-9817-c0e1dc7fcf8f" class="outline-2">
<h2 id="h:e7c6d8c5-cd42-420f-9817-c0e1dc7fcf8f">Mode模式</h2>
<div class="outline-text-2" id="text-h:e7c6d8c5-cd42-420f-9817-c0e1dc7fcf8f">
<p>
Emacs 的核心要素之一就是模式（mode）。一个模式就对应着一组环境，不同模
式可以分别进行配置，应对不同的场景。例如，编写 C++ 代码时就对应 c++-mo
de，编写 Python时使用 python-mode。在不同的语言的 mode 中，编译、执行
的方式都是不同的，这样只要事先定义好 mode，就可以在使用过程中方便切换
各种需求场景。
</p>

<p>
Emacs mode 分两类，主模式（Major mode）和次模式（Minor mode）。
</p>
</div>
<div id="outline-container-h:f606f195-b6e3-4406-b02f-393f13fd2751" class="outline-3">
<h3 id="h:f606f195-b6e3-4406-b02f-393f13fd2751">主要模式</h3>
<div class="outline-text-3" id="text-h:f606f195-b6e3-4406-b02f-393f13fd2751">
<p>
主模式默认根据 Buffer 的文件类型来选择，一个 Buffer 只能对应一个主模式。
</p>

<p>
例如，Emacs 发现你打开了 .cpp 为后缀的文件，就会把 Buffer 自动设置成
c++-mode，发现你打开了 .py 后缀的文件，就把相应 Buffer 自动设置为 pyth
on-mode，最直观的区别是 Emacs 为不同语言的源码提供了不同的语法高亮。
主模式的名字会显示在 Mode line 上。
</p>

<p>
我们也可以手动切换主模式，只需要按下 M-x ，输入相应的模式名称即可。通
常来说其实我们不需要手动设置。
</p>

<p>
最基本的主模式是 Fundamental mode，就是没有进行任何配置的模式。
</p>

<p>
在 Emacs 中，Major Mode 又分为三种，
</p>

<ul class="org-ul">
<li><code>text-mode</code> ，用于编辑文本文件</li>
<li><code>special-mode</code> ，特殊模式（很少见）</li>
<li><code>prog-mode</code> ，所有的编程语言的父模式</li>
</ul>

<p>
在每一个模式（mode）中它的名称与各个变量还有函数都是有特定的命名规则，
比如所有的模式都被命名为 <code>ModeName-mode</code> ，里面所设置的快捷键则为 <code>Mo
deName-mode-key-map</code> ，而所有的钩子则会被命名为 <code>ModeName-mode-hook</code> 。
</p>

<p>
使用 <code>C-h m</code> 查看用了哪些 mode。
</p>
</div>
</div>
<div id="outline-container-h:6f5ee859-2548-4b70-a848-0e2103e6c258" class="outline-3">
<h3 id="h:6f5ee859-2548-4b70-a848-0e2103e6c258">次要模式</h3>
<div class="outline-text-3" id="text-h:6f5ee859-2548-4b70-a848-0e2103e6c258">
<p>
同一个 Buffer 可以有多个次模式，次模式可以进一步调整、增加一些配置。
通常来说，插件都是靠次模式来起作用的。当我们安装插件时，插件的官网会提
示如何设置这个插件，其中大多都会使用次模式。
</p>
</div>
</div>
<div id="outline-container-h:b4307ff6-7c54-4f13-b10f-514d345c1108" class="outline-3">
<h3 id="h:b4307ff6-7c54-4f13-b10f-514d345c1108">Mode hook</h3>
<div class="outline-text-3" id="text-h:b4307ff6-7c54-4f13-b10f-514d345c1108">
<p>
每一个主模式都对应着一个 Mode hook，hook 是挂钩的意思，Mode hook 的作
用就是当启动一个主模式时，自动执行一些已经“挂钩”到这个主模式的函数或
次模式。由此，我们可以自由地向一个主模式上挂上各种功能，在启动这个主模
式时就可以自动跟随着一起启动。
</p>

<p>
Mode hook 的名字通常就是“主模式名-hook”。例如，我们希望在主模式“文
本文件模式” text-mode 时启动次模式“检查拼写” flyspell-mode ，我们就
可以这样写配置：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'text-mode-hook 'flyspell-mode)
</pre>
</div>

<p>
这样当我们打开 txt 文件时，会自动开启检查拼写功能。
</p>

<p>
text-mode 是基于文本的文件的一个主模式，有一些其它主模式是由它派生，例
如 html-mode。而相对的，还有编程模式 prog-mode，各种编程语言对应的主模
式都是由它派生，包括我们上文提到的 c++-mode 和 python-mode。那么如果我
们希望在任何编程语言时都有一些共同需要的功能，例如编程时我们希望有代码
块折叠功能，就为 prog-mode-hook 挂上相应功能就好。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'prog-mode-hook #'hs-minor-mode)
</pre>
</div>
</div>
</div>
</section>
<section id="outline-container-h:e9266f36-1100-4519-8b9f-261656d06be4" class="outline-2">
<h2 id="h:e9266f36-1100-4519-8b9f-261656d06be4">Help 帮助</h2>
<div class="outline-text-2" id="text-h:e9266f36-1100-4519-8b9f-261656d06be4">
</div>
<div id="outline-container-h:b667c79b-8e69-42d9-9083-09b3212539ce" class="outline-3">
<h3 id="h:b667c79b-8e69-42d9-9083-09b3212539ce">minibuffer增强vertico</h3>
<div class="outline-text-3" id="text-h:b667c79b-8e69-42d9-9083-09b3212539ce">
<p>
vertico垂直展示内容更友好。
</p>

<p>
刷新包缓存 <code>M-x package-refreesh-contents</code> ， 安装包 <code>M-x package-install</code> 输入 <code>vertico</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(vertico-mode 1)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2e12e3a1-c7e4-4195-bff4-3d76ed3c9628" class="outline-3">
<h3 id="h:2e12e3a1-c7e4-4195-bff4-3d76ed3c9628">帮助系统是你最好的朋友</h3>
<div class="outline-text-3" id="text-h:2e12e3a1-c7e4-4195-bff4-3d76ed3c9628">
<p>
要成为一个称职的用户，你需要掌握帮助系统。
</p>

<p>
所有帮助命令都以 <code>C-h</code> 键开头。开始使用这些：
</p>

<dl class="org-dl">
<dt>C-h f</dt><dd>函数的帮助信息</dd>
<dt>C-h v</dt><dd>变量的帮助信息</dd>
<dt>C-h o</dt><dd>函数、变量、或的帮助信息</dd>
<dt>C-h k</dt><dd>快捷键绑定的帮助信息</dd>
<dt>C-h w</dt><dd>有关给定命令绑定到何处的帮助</dd>
<dt>C-h m</dt><dd>当前模式(主要和次要模式)的帮助</dd>
</dl>

<p>
当光标在函数或变量的符号（专有名称）上时， <code>C-h f</code> 、 <code>C-h v</code> 或 <code>C-h o</code>
将使用该选项作为默认选项。
</p>

<p>
因为 emacs 是自文档编辑器，里面的函数变量都能找到它的文档，后续在使用
emacs 过程中会非常有帮助。
</p>

<p>
请注意，当函数或变量的符号包含两个短划线时 <code>--</code> 那么这意味着它打算在文
件/包中使用。如果您计划将它们合并到您的设置中，请小心，因为它们可能会
在没有事先通知的情况下更改。
</p>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-sh">&#22914;&#26597;&#30475;C-x C-s&#65292;&#20351;&#29992;C-h k&#20877;&#36755;&#20837;C-x C-s
&#22914;save-buffer&#21151;&#33021;&#65292;&#20351;&#29992;C-h f&#20877;&#36755;&#20837;save-buffer
</pre>
</div>
</div>
</div>
<div id="outline-container-h:e909acaa-aab6-49e9-8dc0-88a81988c4c7" class="outline-3">
<h3 id="h:e909acaa-aab6-49e9-8dc0-88a81988c4c7">C-h 作为前缀和后缀</h3>
<div class="outline-text-3" id="text-h:e909acaa-aab6-49e9-8dc0-88a81988c4c7">
<p>
<code>C-h</code> 除了被用作前缀，还可以选择使用此键作为任何尚未结束的序列的后缀。
</p>

<p>
例如，Emacs 有很多以 <code>C-x r</code> 开头的命令。这些操作与寄存器、书签和矩形
操作有关。为了生成一个帮助缓冲区，向我们显示该序列的所有扩展，我们附加
<code>C-h</code> 到它，所以 <code>C-x r C-h</code> 。
</p>

<p>
您甚至可以使用 <code>C-h</code> 作为 <code>C-h</code> 的前缀的后缀作。这是一种奇特的说法，它
将 <code>C-h C-h</code> 提供有关可用帮助功能的特殊视图。
</p>

<p>
如果你使用的 <code>embark</code> 软件包，并且不想为 <code>C-h</code> 后缀生成帮助缓冲区，请
将以下内容添加到您的配置中：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> prefix-help-command #'embark-prefix-help-command)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:f6700e93-3360-4f91-aedf-0000298455f4" class="outline-3">
<h3 id="h:f6700e93-3360-4f91-aedf-0000298455f4">如何阅读手册</h3>
<div class="outline-text-3" id="text-h:f6700e93-3360-4f91-aedf-0000298455f4">
<p>
Emacs 是一款功能强大的软件。只有在您熟悉它之后，它的潜力才会被释放出来。
这需要承诺、耐心和毅力。
</p>

<p>
换句话说：你一步一步地学习 Emacs。该过程的一部分涉及阅读通过内置信息阅
读器提供的大量文档。通过 <code>C-h i</code> 访问它，然后使用 <code>C-h m</code> 来了解有关
该模式的所有信息。
</p>

<ul class="org-ul">
<li><code>C-h i</code> 内置很多文档。使用 <code>C-h m</code> 查看可操作的快捷键</li>
<li><code>C-h m</code> 提供关于这个主模式下快捷键说明
<ul class="org-ul">
<li>m 指定菜单名</li>
<li>n 下一节点</li>
<li>p 上一节点</li>
<li>^ 向上移动一个节点</li>
<li>d 到 Info 节点</li>
</ul></li>
</ul>

<p>
范例：查看Elisp文档
</p>
<ul class="org-ul">
<li><code>C-h i</code> 内置文档。</li>
<li><code>m</code> Elisp : 搜索 Elisp 节点, 回车进入文档</li>
<li><code>m</code> list : 搜索 Elisp 文档中 list 章节</li>
<li><code>m</code> cons cells : 搜索 list 章节中 cons cells 小节</li>
<li>&#x2026;</li>
</ul>

<p>
对新手更好的文档是Emacs 手册，它是一个你经常访问的特殊文件，所以它有自己的键绑定：
<code>C-h r</code> （将“r”视为“read”的助记符）。
</p>

<p>
与所有技术文档一样，您不会一次性阅读它们。它们不是故事。相反，你一次研
究一个片段。一旦你了解了它，你就会进入下一个，逐渐拓宽你的知识（或
完善你的设置）。
</p>
</div>
</div>
<div id="outline-container-h:2db47280-0185-4394-8788-be852cc3725a" class="outline-3">
<h3 id="h:2db47280-0185-4394-8788-be852cc3725a">用 Emacs Lisp 思考</h3>
<div class="outline-text-3" id="text-h:2db47280-0185-4394-8788-be852cc3725a">
<p>
让我们从一个非常简单的场景开始。
</p>

<ul class="org-ul">
<li>假设您要编写一个将绑定到键的函数。</li>
<li>这些被称为“命令”，因为它们是交互式的。</li>
<li>此命令将在给定方向上一次将点（光标）移动 15 行。</li>
<li>键入 <code>C-h k</code> 并用 <code>C-n</code> or <code>C-p</code> （移动到下一行/上一行的命令）跟踪它。你
将了解到它们分别称为 <code>next-line</code> 和 <code>previous-line</code> 。帮助缓冲区告诉
你，这些命令接受一个数值参数来一次移动 N 行。它还包括指向源代码的直
接链接。通过查看源代码，您最终会推断出函数是用 <code>defun</code> 关键字（技术
上是 Lisp 宏）声明的。</li>
</ul>

<p>
考虑到这些，你可以切换到 <code>*scratch*</code> 缓冲区并开始试验：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-next-15-lines</span> ()
  <span style="color: #8b2252;">"Move to the next 15 lines."</span>
  (<span style="color: #a020f0;">interactive</span>)                   <span style="color: #b22222;">; </span><span style="color: #b22222;">this turns a function into a command</span>
  (next-line 15))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-previous-15-lines</span> ()
  <span style="color: #8b2252;">"Move to the previous 15 lines."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (previous-line 15))
</pre>
</div>

<p>
如果你仔细阅读上述帮助缓冲区，你将意识到你的代码可以改进，因为自定义代
码的正确命令是使用 <code>forward-line</code> 。因此，您可以相应地更新内容：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-next-15-lines</span> ()
  <span style="color: #8b2252;">"Move to the next 15 lines."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (forward-line 15))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-previous-15-lines</span> ()
  <span style="color: #8b2252;">"Move to the previous 15 lines."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (forward-line -15))
</pre>
</div>

<p>
现在将它们绑定到 Ctrl+Shift，然后绑定到 n/p。要了解 Emacs 如何表示任何
键，请使用 <code>C-h k</code> 并键入它。你会得到 <code>C-S-n</code> 和 <code>C-S-p</code> 。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key global-map (kbd <span style="color: #8b2252;">"C-S-n"</span>) #'my-next-15-lines)
(define-key global-map (kbd <span style="color: #8b2252;">"C-S-p"</span>) #'my-previous-15-lines)
</pre>
</div>

<p>
请注意，这 <code>global-map</code> 适用于所有主要模式。许多命令仅适用于特定模式，
因此有自己的键盘映射。 <code>C-h k</code> 缓冲区会相应地通知您。
</p>
</div>
</div>
<div id="outline-container-h:553b643e-59de-4b80-b69b-c3aeecc58c1e" class="outline-3">
<h3 id="h:553b643e-59de-4b80-b69b-c3aeecc58c1e">试验 Elisp 条件</h3>
<div class="outline-text-3" id="text-h:553b643e-59de-4b80-b69b-c3aeecc58c1e">
<p>
在前面的示例的基础上，让我们将一些变量和条件添加到组合中。下面是一个基
本变量：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-first-toggle</span> nil
  <span style="color: #8b2252;">"If non-nil, do stuff."</span>)
</pre>
</div>

<p>
[ 通过移动到代码的末尾并键入代码 <code>C-x C-e</code> ，或者在 Elisp 缓冲区中键入
<code>C-M-x</code> 。也有 <code>M-:</code> 。]
</p>

<p>
让我们进入 <b>scratch</b> 并开始实验：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> my-first-toggle
    (message <span style="color: #8b2252;">"It is true"</span>)
  (message <span style="color: #8b2252;">"It is not true"</span>))
</pre>
</div>

<p>
<code>C-j</code> 运行最近距离的代码
</p>

<p>
虽然这可能不切实际，但让我们添加第三个命令，它重用前两个命令：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-next-15-lines</span> ()
  <span style="color: #8b2252;">"Move to the next 15 lines."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (forward-line 15))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-previous-15-lines</span> ()
  <span style="color: #8b2252;">"Move to the previous 15 lines."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (forward-line -15))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-next-or-prev-15-lines</span> ()
  <span style="color: #8b2252;">"Move to the next or previous 15 lines.</span>
<span style="color: #8b2252;">The motion depends on the value of `</span><span style="color: #008b8b;">my-first-toggle</span><span style="color: #8b2252;">'."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">if</span> my-first-toggle
      (my-next-15-lines)
    (my-previous-15-lines)))
</pre>
</div>

<p>
在这种情况下，更现实的方案是让命令接受参数（即控制其行为的参数）。最简
单的是 C-u 前缀参数，您可以在命令的键之前键入该参数。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-next-or-prev-15-lines</span> (<span style="color: #228b22;">&amp;optional</span> arg)
  <span style="color: #8b2252;">"Move to the next or previous 15 lines.</span>
<span style="color: #8b2252;">With optional prefix ARG, move to the next lines.  Else to the previous ones."</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  <span style="color: #b22222;">;;</span><span style="color: #b22222;">(if arg</span>
  (<span style="color: #a020f0;">if</span> my-first-toggle
      (my-next-15-lines)
    (my-previous-15-lines)))
</pre>
</div>

<p>
键入 <code>C-h f</code> 并搜索 <code>interactive</code> 。它会告诉你它接受的其他预设（你总是
可以编写自己的预设，但那是高级的东西）。
</p>

<p>
请注意该 <code>&amp;optional</code> 类型的使用。如果没有它，如果该命令未使用 prefix
参数调用即arg，则该命令将返回错误。
</p>
</div>
</div>
<div id="outline-container-h:306e619f-5246-4c28-bbbc-40dc9847813c" class="outline-3">
<h3 id="h:306e619f-5246-4c28-bbbc-40dc9847813c">练习并保持耐心</h3>
<div class="outline-text-3" id="text-h:306e619f-5246-4c28-bbbc-40dc9847813c">
<p>
学习基础知识。永远有用的技能是使用帮助系统。
</p>

<p>
要有耐心。专业知识没有捷径可走。所有专家都是从菜鸟开始的。这也意味着你
通过反复试验的过程从错误中吸取教训：没关系。
</p>

<p>
通过尝试理解小模式来修补 Elisp。然后尝试将它们组合成更大的设计的方法。
</p>

<p>
用其他学习材料补充官方资源，例如博客文章、视频和其他人的代码。
</p>

<p>
永远——永远——阅读文档！
</p>

<p>
完整内容
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;;; </span><span style="color: #b22222;">C-h k  find command of =C-n=  or =C-p=</span>

<span style="color: #b22222;">;;; </span><span style="color: #b22222;">&#23450;&#20041;&#20989;&#25968;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-next-15-lines</span> ()
  <span style="color: #8b2252;">"Move to the next 15 lines."</span>
  (<span style="color: #a020f0;">interactive</span>)                   <span style="color: #b22222;">; </span><span style="color: #b22222;">this turns a function into a command</span>
  (next-line 15)               <span style="color: #b22222;">; </span><span style="color: #b22222;">instead of forward-line</span>
  (forwad-line 15))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-previous-15-lines</span> ()
  <span style="color: #8b2252;">"Move to the previous 15 lines."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (previous-line 15))

<span style="color: #b22222;">;;; </span><span style="color: #b22222;">&#32465;&#23450;&#24555;&#25463;&#38190;</span>
(define-key global-map (kbd <span style="color: #8b2252;">"C-S-n"</span>) #'my-next-15-lines)
(define-key global-map (kbd <span style="color: #8b2252;">"C-S-p"</span>) #'my-previous-15-lines)

<span style="color: #b22222;">;;; </span><span style="color: #b22222;">&#35843;&#29992;</span>
(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-first-toggle</span> nil
  <span style="color: #8b2252;">"If non-ni, do stuff."</span>)

(<span style="color: #a020f0;">if</span> my-first-toggle
    (message <span style="color: #8b2252;">"It is true"</span>)
  (message <span style="color: #8b2252;">"It is no true"</span>))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-next-or-prev-15-lines</span> ()
  <span style="color: #8b2252;">"Move to the next or previous 15 lines.</span>
<span style="color: #8b2252;">The motion depends on the value of `</span><span style="color: #008b8b;">my-first-toggle</span><span style="color: #8b2252;">'."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">if</span> my-first-toggle
      (my-next-15-lines)
    (my-previous-15-lines)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21487;&#36873;&#21442;&#25968;arg</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-next-or-prev-15-lines</span> (<span style="color: #228b22;">&amp;optional</span> arg)
  <span style="color: #8b2252;">"Move to the next or previous 15 lines.</span>
<span style="color: #8b2252;">With optional prefix ARG, move to the next lines.  Else to the previous ones."</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (<span style="color: #a020f0;">if</span> my-first-toggle
  (<span style="color: #a020f0;">if</span> my-first-toggle
      (my-next-15-lines)
    (my-previous-15-lines)))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:87ba839c-5166-4cb4-93a1-3ed77aa2e349" class="outline-3">
<h3 id="h:87ba839c-5166-4cb4-93a1-3ed77aa2e349">其它</h3>
<div class="outline-text-3" id="text-h:87ba839c-5166-4cb4-93a1-3ed77aa2e349">
<ul class="org-ul">
<li><p>
Emacs 快速指南： <code>C-h t</code> 请 30 分钟内读完。
</p>

<p>
<code>M-x help-with-tutorial-spec-language</code>  查看不同语言的教程，中文是Chinese-GB
</p></li>

<li>emacs 手册： <code>C-h r</code> 。 <code>C-h m</code> 查看帮助信息。 <code>n p ^</code> 下上页，上一节
<ul class="org-ul">
<li>Online : <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/index.html">Emacs manual</a></li>
</ul></li>

<li>命令历史: M-x list-command-history</li>
</ul>

<div class="org-src-container">
<pre class="src src-bash">C-h ?                      &#65306;&#24110;&#21161;&#30340;&#24110;&#21161;&#65292;&#21015;&#20986;&#24110;&#21161;&#39033;&#12290;&#21516; C-h C-h
C-h a topics &lt;RET&gt;                      &#22312;&#24110;&#21161;&#20013;&#25628;&#32034;&#30456;&#20851;&#20027;&#39064;
C-h C-f                                 &#26597;&#30475;FAQ
C-h c &#65306;&#31616;&#35201;&#25551;&#36848;&#24555;&#25463;&#38190;&#21151;&#33021;&#12290;&#20363;&#22914; C-h c C-p&#65292;&#20250;&#22312;&#26368;&#19979;&#38754;&#20986;&#29616;&#65306;<span style="color: #8b2252;">"C-p runs the command previous-line"</span>&#65292;&#21578;&#35785;&#20320; C-p &#38190;&#23545;&#24212;&#30340;&#21629;&#20196;&#26159; <span style="color: #8b2252;">"previous-line"</span>&#12290;
C-h d&#65306;&#21015;&#20986;&#21547;&#26576;&#19968;&#20851;&#38190;&#35789;&#30340;&#31526;&#21495;&#30340;&#25991;&#26723;
C-h b    &#65306;&#38190;&#32465;&#23450;
</pre>
</div>

<p>
下面的这些函数可以让你找到不同函数，变量以及快捷键所定义的文件位置。
因为非常常用 所以我们建议将其设置为与查找文档类似的快捷键（如下所示），
</p>

<p>
可以把它们绑定到配置中
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;  </span><span style="color: #b22222;">&#26597;&#35810;&#20989;&#25968;&#12289;&#21464;&#37327;&#12289;key &#25991;&#20214;&#20301;&#32622;</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-h C-f"</span>) 'find-function)
(global-set-key (kbd <span style="color: #8b2252;">"C-h C-v"</span>) 'find-variable)
(global-set-key (kbd <span style="color: #8b2252;">"C-h C-k"</span>) 'find-function-on-key)
</pre>
</div>

<p>
Emacs Lisp学习:
</p>

<p>
叶文彬的Emacs Lisp教程， 本版可以下载PDF及 
</p>

<ul class="org-ul">
<li>代码： <a href="http://www.newsmth.net/nForum/article/Emacs/58338?s=58338">http://www.newsmth.net/nForum/article/Emacs/58338?s=58338</a></li>
<li>HTML版本： <a href="http://smacs.github.io/elisp/">http://smacs.github.io/elisp/</a></li>
</ul>

<p>
参考：
</p>
<ul class="org-ul">
<li><a href="https://protesilaos.com/codelog/2022-01-31-learning-emacs/">https://protesilaos.com/codelog/2022-01-31-learning-emacs/</a></li>
</ul>
</div>
</div>
</section>
<section id="outline-container-h:f5059331-4004-44f1-b2b6-814a099fc25a" class="outline-2">
<h2 id="h:f5059331-4004-44f1-b2b6-814a099fc25a">改变外观</h2>
<div class="outline-text-2" id="text-h:f5059331-4004-44f1-b2b6-814a099fc25a">
<p>
图形化配置
</p>
<ul class="org-ul">
<li>执行命令 <code>M-x customize</code></li>
<li>在搜索框中，搜索要修改的配置，如
<ul class="org-ul">
<li>关闭菜单栏，搜索 <code>menu-bar-mode</code> ，点击 <code>Toggle</code> 为off，再点击 <code>State</code> 为 <code>Set for Current Seesion</code> 保存到当前会话。</li>
<li>关闭工具栏，搜索 <code>tool-bar-mode</code> ，操作同上。</li>
<li>关闭滚动条，搜索 <code>scroll-bar-mode</code> ，点击 <code>value Menu</code> 为nil，再点击 <code>State</code> 保存。</li>
</ul></li>
</ul>

<p>
图形化配置的优劣势
</p>
<ul class="org-ul">
<li>优点：不用写Elisp代码</li>
<li>缺点：
<ul class="org-ul">
<li>搜索</li>
<li>生成配置代码只能是单一文件配置，显得凌乱。</li>
<li>扩展的配置不容易进行。</li>
<li>涉及到复杂逻辑的不方便配置。如条件判断。</li>
</ul></li>
</ul>
</div>
</section>
<section id="outline-container-h:8a9fb813-3ce3-4636-8dbe-1f60d69dbe40" class="outline-2">
<h2 id="h:8a9fb813-3ce3-4636-8dbe-1f60d69dbe40">其他基础讲解</h2>
<div class="outline-text-2" id="text-h:8a9fb813-3ce3-4636-8dbe-1f60d69dbe40">
</div>
<div id="outline-container-h:6edd8b84-4a53-4c8c-9cad-960faadccd28" class="outline-3">
<h3 id="h:6edd8b84-4a53-4c8c-9cad-960faadccd28">基础</h3>
<div class="outline-text-3" id="text-h:6edd8b84-4a53-4c8c-9cad-960faadccd28">
<p>
在Emacs 中大家需要理解的一个核心概念就是命令。在 Emacs 中所有的操作，
无论简单复杂都是命令。
</p>

<p>
Emacs 这个单词就来自于 macro, 即宏命令。比如说我们想执行打开一个文件的
操作, 有3种方式等价的操作方式:
</p>

<ul class="org-ul">
<li>从菜单栏里: <code>file</code> -&gt; <code>visit new file</code></li>
<li><code>M-x find-file</code></li>
<li>用快捷键 <code>C-x C-f</code> 并输入文件名</li>
</ul>

<p>
Emacs 中有许多有用的命令。你未来也可以自己通过 <code>elisp</code> 语言编写自己命
令。Emacs 把其中最常用的命令都绑定了快捷键，用户自己也可以设置自己的
快捷键。当我们用熟了之后, 很多快捷键就会像打字一样形成肌肉记忆。作为
新手, 我们有很多键盘的快捷操作可以用鼠标代替。
</p>

<p>
<b>新手必知的几个快捷键</b>
</p>

<p>
在表中， <code>C</code> 表示 <code>control</code> 键， <code>M</code> 表示 <code>alt</code> 。这也是 Emacs 快捷键
通用写法。 最右边一列是快捷键对应的命令名，也就是第一列所有的快捷键都
等价于 <code>M-x</code> 加上第三列。 
</p>

<ul class="org-ul">
<li><code>C-g</code>: 中止当前一!切!命!令!  <code>keyboard-quit</code></li>
<li><code>C-/</code>: 撤销命令 <code>undo</code></li>
</ul>

<p>
文件操作
</p>

<ul class="org-ul">
<li><code>C-x C-f</code>: 打开文件，没有则会创建 <code>find-file</code></li>
<li><code>C-x C-s</code>: 保存文件 <code>save-buffer</code></li>
<li><code>C-x b</code>: 切换文件 (缓冲区) <code>switch-to-buffer</code></li>
<li><code>C-x 1</code>: 关闭其它窗口 <code>delete-other-window</code></li>
</ul>

<p>
文本处理
</p>

<ul class="org-ul">
<li><code>M-w</code>: 复制 <code>kill-ring-save</code></li>
<li><code>C-w</code>: 剪切 <code>kill-region</code></li>
<li><code>C-y</code>: 粘贴 <code>yank</code></li>
</ul>

<p>
<b>elisp代码执行：</b>
</p>
<ul class="org-ul">
<li><code>C-x C-e</code> ： <code>eval-last-sexp</code> 执行光标所在代码</li>
<li><code>M-x eval-region</code> ：执行选中区域代码</li>
<li><code>M-x eval-buffer</code> ：执行当前缓冲区代码</li>
<li><code>M-x load-file &lt;ENTER&gt; FILE_NAME</code> ：执行指定文件代码</li>
<li><code>C-j</code> : 执行最近距离代码，并打印输出以当前位置</li>
<li><code>C-M-x</code> : runs the command eval-defun</li>
<li><code>M-:</code> : runs the command eval-expression</li>
<li><code>M-x ielm</code> 类似于ipython交互式运行</li>
</ul>

<p>
文件夹
</p>

<ul class="org-ul">
<li><code>C-x C-f</code>: 打开文件 <code>find-file</code>
<ul class="org-ul">
<li><code>S-6</code>: 上级目录</li>
</ul></li>
<li><code>C-x C-q</code> 目录下进入编辑模式，可改文件名</li>
<li><code>C-c C-c</code>: 完成</li>
<li><code>C-c C-k</code>: 取消</li>
</ul>

<p>
窗口操作
</p>

<ul class="org-ul">
<li><code>C-x 1</code>: 仅保留当前窗口</li>
<li><code>C-x 2</code>: 将当前窗口分到上边</li>
<li><code>C-x 3</code>: 将当前窗口分到右边</li>
<li><code>C-x 0</code>: 关闭当前窗口</li>
<li><code>C-x C-0, C-x C--, C-x C-+</code>: 开启放大缩小功能， <code>=</code> 放大， <code>-</code> 缩小，
<code>0</code> 还原 <code>text-scale-adjus</code></li>
</ul>

<p>
其它：
</p>
<ul class="org-ul">
<li>C-u 重复次数: 如C-u 8 C-f，移动8个字符</li>
<li><code>C-h f/v/k</code>: 查询命令/变量/快捷键 <code>describe-function/variable/key</code></li>
<li><code>C-h m</code>: 来显示当前所有开启 的全部 Minor Mode 的信息</li>
</ul>


<p>
查看所有buffer： 点击菜单栏中的buffer
</p>

<p>
切换buffer
</p>

<ul class="org-ul">
<li>方法1： 菜单中点击 buffer</li>
<li>方法2：鼠标左键或右键点击文件向前或向后切换buffer</li>
</ul>

<p>
窗口大小：
</p>

<ul class="org-ul">
<li>鼠标在状态栏，上下拖动</li>
</ul>

<p>
窗口关闭：
</p>

<ul class="org-ul">
<li>方法1：鼠标停在状态栏，右键</li>
<li>方法2：菜单栏选择 Remove Other Windows 只保留当前buffer，New Window Below 水平</li>
<li>方法3：鼠标滚轮按住状态栏，拖动</li>
<li>方法4：快捷键 C-x 1</li>
</ul>

<p>
主题：
</p>

<ul class="org-ul">
<li>Options &#x2013;&gt; Customize Emacs &#x2013;&gt; Custom Themes &#x2013;&gt; tongo-dark</li>
<li>保存 Save Theme Settings 再状态栏文件切换buffer</li>
</ul>
</div>
</div>
<div id="outline-container-h:79545c10-0087-429c-b9d5-6af86545ce7d" class="outline-3">
<h3 id="h:79545c10-0087-429c-b9d5-6af86545ce7d">中止命令与撤销命令</h3>
<div class="outline-text-3" id="text-h:79545c10-0087-429c-b9d5-6af86545ce7d">
<p>
在 Emacs 中发生误操作时，你需要知道如何中止与撤销命令。 当你的快捷键输
入一半想反悔时 (是的，Emacs 的快捷键可以很长!)，可以使用 <code>C-g</code> 重新来
输入，又或者 Emacs 在执行命令时卡住了，你可以通过 <code>C-g</code> 来让它恢复正常。
</p>

<p>
如果你需要撤回上一条命令, 则需要使用 <code>C-/</code> 。但值得注意的是， 撤回撤回
命令的命令也是同一个键；这偶尔会让人抓狂。不过幸好有 undo-tree 可视化
撤销状态插件
</p>
</div>
</div>
<div id="outline-container-h:6699d55e-d5fb-4a8d-98ec-c224611a7e3a" class="outline-3">
<h3 id="h:6699d55e-d5fb-4a8d-98ec-c224611a7e3a">文件与窗口相关命令</h3>
<div class="outline-text-3" id="text-h:6699d55e-d5fb-4a8d-98ec-c224611a7e3a">
<p>
下面我们介绍 Emacs 中最基础的几个管理界面的快捷键。
</p>

<p>
首先是打开文件，~C-x C-f~ ，命令名是 <code>find-file</code>. 这里的 <code>find</code> 隐含
Emacs 会根据不同情况执行不同操作: 若文件存在, 则是普通的打开文件; 若文
件不存在, 则是打开一个新文件。
</p>

<p>
第二个是保存文件， <code>C-x C-s</code> ，对应 <code>save-buffer</code> ，即把当前缓冲区 (更
新后) 的内容写进文件里。
</p>

<p>
大多数情况将缓冲区 (buffer) 等同于文件不会影响你的 Emacs 使用。 这里简
单讲讲它们的不同。文件存在于电脑硬盘上，而Emacs 的缓冲区只显示文件内容。
当你把文件内容读入缓冲区以后，又在 Emacs 外修改了文件的内容，缓冲区中
的内容并不会改变，除非你明确指示 Emacs 重新读取。而在 Windows 中，一个
文件同时只能被一个 Windows 程序打开。 Emacs 的缓冲区也不一定对应着文
件，在模式栏大家可以看到当前缓冲区的名字。 名字被两个 <code>*</code> 号包含的一般
是非文件的缓冲区，例如 <code>*Message*</code> 用于显示 Emacs 给用户的信息，编译 L
aTeX 时 <code>*Output*</code> 会存放编译输出结果等。
</p>

<p>
第三个命令是切换缓冲区/文件， <code>C-x b</code> ，对应 <code>switch-to-buffer</code> 。 执
行后在最下方的小缓冲区会提示输入你想要切换的缓冲区名字，默认是上一个显
示的缓冲区，直接回车就行。
</p>

<p>
在 Emacs 中同时显示多个缓冲区的方法是打开多个窗口 (window)，然后在每个
窗口中显示一个缓冲区。有时 Emacs 自动创建新的窗口，例如展示帮助信息时。
新手最常用的操作是保留当前光标所在窗口，而关掉其它所有窗口。这可以通过，
<code>C-x 1</code> ，即 <code>delete-other-window</code> 实现。我们可以用鼠标辅助我们在不同窗
口间切换。
</p>
</div>
</div>
<div id="outline-container-h:b3c7b935-67a3-498b-b466-c31d4741724a" class="outline-3">
<h3 id="h:b3c7b935-67a3-498b-b466-c31d4741724a">帮助命令</h3>
<div class="outline-text-3" id="text-h:b3c7b935-67a3-498b-b466-c31d4741724a">
<p>
Emacs 中查询帮助信息的快捷键是 <code>C-h &lt;字母&gt;</code> 。常用的有 <code>C-h f</code> ，查询
命令， <code>C-h v</code> ，查询变量，以及 <code>C-h k</code> ，查询快捷键。通常 <code>C-h</code> 命令
会自动创建新的窗口显示帮助信息。我们可以先把光标移到我们工作的缓冲区，
然后用 <code>C-x 1</code> 关闭掉帮助信息窗口。注意此时帮助信息的缓冲区并没有关闭，
重新显示可以通过 <code>C-x b</code> 并查找以 <code>*help*</code> 命名的缓冲区。 
</p>
</div>
</div>
<div id="outline-container-h:2e63c556-923d-4480-91d9-d41e5e5a9399" class="outline-3">
<h3 id="h:2e63c556-923d-4480-91d9-d41e5e5a9399">复制/剪切/粘贴</h3>
<div class="outline-text-3" id="text-h:2e63c556-923d-4480-91d9-d41e5e5a9399">
<p>
Emacs 有自己一套复制/剪切/粘贴的快捷键: <code>M-w</code> / <code>C-w</code> / <code>C-y</code> 。 这和
一般程序的 <code>C-c</code> / <code>C-x</code> / <code>C-v</code> 不同，需要大家习惯。所有复制或剪切的
内容都会进入一个叫 <code>kill-ring</code> 的地方，它相当于一个剪粘版的历史记录。
粘贴快捷键 <code>C-y</code> 会粘贴最近一条记录，如果你想访问之前的记录，可以紧跟
着 <code>C-y</code> 再按下一次或多次 ~M-y~。 
</p>
</div>
</div>
<div id="outline-container-h:ad604d9e-e211-43ed-a7ca-187eb81b8a66" class="outline-3">
<h3 id="h:ad604d9e-e211-43ed-a7ca-187eb81b8a66">新手快速配置和安装最简插件</h3>
<div class="outline-text-3" id="text-h:ad604d9e-e211-43ed-a7ca-187eb81b8a66">
</div>
<div id="outline-container-h:85160bfd-f118-4318-a388-c21cba012341" class="outline-4">
<h4 id="h:85160bfd-f118-4318-a388-c21cba012341">Emacs 插件管理</h4>
<div class="outline-text-4" id="text-h:85160bfd-f118-4318-a388-c21cba012341">
<p>
接下来我们介绍如何更好地管理 Emacs 插件, 或叫 Emacs 包 (package)。插件
可以给我们带来更多的功能，是 Emacs 使用中不可缺少的一环。 插件的安装和
设置与其它的 Emacs 设置一样，都放在 Emacs 的启动文件 <code>~/.emacs.d/ini
t.el</code> 中。关于插件安装与设置，我推荐大家使用现在常用的 <code>use-package</code>
语法，它的语法更简洁，还可以很方便地自动安装插件。
</p>

<p>
<b>use-package管理插件的插件</b>
</p>

<ul class="org-ul">
<li>更简洁的语法</li>
<li>更方便自动安装</li>
</ul>

<p>
<b>两种下载和安装插件的方式</b>
</p>

<ul class="org-ul">
<li><code>package.el</code> ：内置</li>
<li><code>straight.el</code> : 需要访问 github.com 以及使用 <code>git</code>
<ul class="org-ul">
<li>msys2 安装 不行</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">pacman -S git
</pre>
</div>

<p>
我们在 <code>package.el</code> 和 <code>straight.el</code> 的设置示例中都手动检查并安装了 <code>us
e-package</code> 。Emacs 29 后 <code>use-package</code> 已经是内置插件，相关代码可以省
去。
</p>
</div>
<div id="outline-container-h:e0f63fce-9a35-4a2b-a871-62cddb689901" class="outline-5">
<h5 id="h:e0f63fce-9a35-4a2b-a871-62cddb689901"><code>package.el</code> 设置示例</h5>
<div class="outline-text-5" id="text-h:e0f63fce-9a35-4a2b-a871-62cddb689901">
<p>
以下我们提供了 <code>package.el</code> 的一个设置示例。大家需要把如下代码放入设置
文件 <code>~/.emacs.d/init.el</code> 中。
</p>

<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">-*- lexical-binding: t; -*-</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#38745;&#24577;&#20316;&#29992;&#22495;&#22768;&#26126;&#24517;&#39035;&#25918;&#22312;&#39318;&#34892;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25226; Emacs &#33258;&#21160;&#28155;&#21152;&#30340;&#20195;&#30721;&#25918;&#21040; custom.el &#20013;</span>
(<span style="color: #a020f0;">setq</span> custom-file (expand-file-name <span style="color: #8b2252;">"custom.el"</span> user-emacs-directory))
<span style="color: #b22222;">;;</span><span style="color: #b22222;">======================================== </span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20351;&#29992; package.el &#35774;&#32622; Emacs &#25554;&#20214;&#31649;&#29702;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">======================================== </span>
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">package</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#21152;&#36733; package.el</span>
(<span style="color: #a020f0;">setq</span> package-check-signature nil) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#22914;&#26524;&#26816;&#26597;&#31614;&#21517;&#26377;&#38382;&#39064;&#21487;&#20197;&#21152;&#20837;&#36825;&#19968;&#34892;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#28155;&#21152;&#20179;&#24211;&#20301;&#32622;</span>
(add-to-list 'package-archives '(<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"http://melpa.org/packages/"</span>) t)
(add-to-list 'package-archives '(<span style="color: #8b2252;">"melpa-stable"</span> . <span style="color: #8b2252;">"http://stable.melpa.org/packages/"</span>) t)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22269;&#20869;&#29992;&#25143;&#20063;&#21487;&#20197;&#20351;&#29992;&#28165;&#21326;&#30340;&#38236;&#20687;&#32593;&#31449;. &#29992;&#19979;&#38754;&#30340;&#20195;&#30721;&#20195;&#26367;&#19978;&#38754;&#20004;&#34892;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq package-archives</span>
<span style="color: #b22222;">;;       </span><span style="color: #b22222;">'(("gnu" . "http://mirrors.tuna.tsinghua.edu.cn/elpa/gnu/")</span>
<span style="color: #b22222;">;;         </span><span style="color: #b22222;">("nongnu" . "http://mirrors.tuna.tsinghua.edu.cn/elpa/nongnu/")</span>
<span style="color: #b22222;">;;         </span><span style="color: #b22222;">("melpa-stable" . "http://mirrors.tuna.tsinghua.edu.cn/elpa/stable-melpa/")</span>
<span style="color: #b22222;">;;         </span><span style="color: #b22222;">("melpa"  . "http://mirrors.tuna.tsinghua.edu.cn/elpa/melpa/")))</span>
(<span style="color: #a020f0;">unless</span> (<span style="color: #a020f0;">bound-and-true-p</span> package--initialized)
  (package-initialize)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21047;&#26032;&#36719;&#20214;&#28304;&#32034;&#24341;</span>

<span style="color: #b22222;">;;</span><span style="color: #b22222;">&#38450;&#27490;&#21453;&#22797;&#35843;&#29992; package-refresh-contents &#20250;&#24433;&#21709;&#21152;&#36733;&#36895;&#24230;</span>
(<span style="color: #a020f0;">when</span> (not package-archive-contents)
  (package-refresh-contents))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#33258;&#21160;&#23433;&#35013; use-package. &#22312;Emacs 29&#20013;&#24050;&#20869;&#32622;&#25925;&#21487;&#30465;&#30053;</span>
(<span style="color: #a020f0;">unless</span> (package-installed-p 'use-package)
  (package-install 'use-package))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#33258;&#21160;&#23433;&#35013;&#25152;&#26377;&#20351;&#29992; use-package &#22768;&#26126;&#30340;&#25554;&#20214;</span>
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">use-package-ensure</span>)
(<span style="color: #a020f0;">setq</span> use-package-always-ensure t)
<span style="color: #b22222;">;;</span><span style="color: #b22222;">======================================== </span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Emacs &#25554;&#20214;&#31649;&#29702;&#35774;&#32622;&#23436;&#27605;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">========================================</span>


<span style="color: #b22222;">;;</span><span style="color: #b22222;">========================================</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36825;&#27573;&#20195;&#30721;&#25918;&#22312;&#26368;&#21518;, &#21152;&#36733; Emacs &#33258;&#21160;&#35774;&#32622;&#30340;&#21464;&#37327;</span>
(<span style="color: #a020f0;">if</span> (file-exists-p custom-file) (load-file custom-file))
<span style="color: #b22222;">;;</span><span style="color: #b22222;">========================================</span>
</pre>
</div>

<p>
这段代码的第一部分先启用了 <code>package.el</code> ，然后通过 <code>package-archives</code>
变量设置了下载插件的网址。在国内也可以使用清华的软件源。接下来 <code>packag
e-refresh-contents</code> 刷新了插件列表。然后我们自动检测 <code>use-package</code> 是
否安装，如果没有安装则自动下载安装。最后，我们设置了 <code>use-package-alwa
ys-ensure</code> 变量为 <code>t</code> ，这样以后我们所有用 <code>use-package</code> 声明的插件都
会自动安装。
</p>
</div>
</div>
<div id="outline-container-h:f939df29-1aef-4800-8053-dbd1349b6340" class="outline-5">
<h5 id="h:f939df29-1aef-4800-8053-dbd1349b6340"><code>straight.el</code> 设置示例</h5>
<div class="outline-text-5" id="text-h:f939df29-1aef-4800-8053-dbd1349b6340">
<ul class="org-ul">
<li>先安装git</li>
</ul>

<p>
因为 <code>straight.el</code> 与 <code>package.el</code> 难以共存，所以我们必须早早手动禁用
内置的 <code>package.el</code> 。这必须修改一个我们平时很少用的 <code>~emacs.d/early-init.el</code>.
</p>

<ul class="org-ul">
<li>在 <code>early-init.el</code> 中加入，并重启emacs</li>
</ul>

<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22312;&#25191;&#34892; init.el &#21069;&#31105;&#29992; package.el</span>
(<span style="color: #a020f0;">setq</span> package-enable-at-startup nil)
</pre>
</div>

<ul class="org-ul">
<li>在 <code>init.el</code> 中加入以下代码:</li>
</ul>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">-*- lexical-binding: t; -*-</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">========================================</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25226; Emacs &#33258;&#21160;&#28155;&#21152;&#30340;&#20195;&#30721;&#25918;&#21040; custom.el &#20013;</span>
(<span style="color: #a020f0;">setq</span> custom-file (expand-file-name <span style="color: #8b2252;">"custom.el"</span> user-emacs-directory))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20351;&#29992; straight.el &#35774;&#32622; Emacs &#25554;&#20214;&#31649;&#29702;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">======================================== </span>
(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">bootstrap-version</span>)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20462;&#22797; Emacs 29 &#20462;&#25913;&#20102; native-compile &#30456;&#20851;&#21464;&#37327;&#23548;&#33268;&#30340; bug</span>
(<span style="color: #a020f0;">unless</span> (version&lt;= emacs-version <span style="color: #8b2252;">"28.2"</span>)
  (<span style="color: #a020f0;">setq</span> straight-repository-branch <span style="color: #8b2252;">"develop"</span>))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20197;&#19979;&#20195;&#30721;&#20174; straight.el &#20027;&#39029; https://github.com/radian-software/straight.el &#19978;&#22797;&#21046; </span>
(<span style="color: #a020f0;">let</span> ((bootstrap-file
       (expand-file-name <span style="color: #8b2252;">"straight/repos/straight.el/bootstrap.el"</span> user-emacs-directory))
      (bootstrap-version 6))
  (<span style="color: #a020f0;">unless</span> (file-exists-p bootstrap-file)
    (<span style="color: #a020f0;">with-current-buffer</span>
        (url-retrieve-synchronously
         <span style="color: #8b2252;">"https://raw.githubusercontent.com/radian-software/straight.el/develop/install.el"</span>
         'silent 'inhibit-cookies)
      (goto-char (point-max))
      (eval-print-last-sexp)))
  (load bootstrap-file nil 'nomessage))

(straight-use-package 'use-package) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#29992; straight.el &#23433;&#35013; use-package &#22768;&#26126;&#30340;&#25554;&#20214;</span>
(<span style="color: #a020f0;">setq</span> straight-use-package-by-default t) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#33258;&#21160;&#23433;&#35013;&#25152;&#26377;&#25554;&#20214;, &#30456;&#24403;&#20110;&#21152;&#20837; :straight t</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">======================================== </span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Emacs &#25554;&#20214;&#31649;&#29702;&#35774;&#32622;&#23436;&#27605;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">========================================</span>

<span style="color: #b22222;">;;</span><span style="color: #b22222;">========================================</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36825;&#27573;&#20195;&#30721;&#25918;&#22312;&#26368;&#21518;, &#21152;&#36733; Emacs &#33258;&#21160;&#35774;&#32622;&#30340;&#21464;&#37327;</span>
(<span style="color: #a020f0;">if</span> (file-exists-p custom-file) (load-file custom-file))
<span style="color: #b22222;">;;</span><span style="color: #b22222;">========================================</span>
</pre>
</div>

<p>
这里大部分的代码是 <code>straight.el</code> 的 <code>github</code> 主页上提供的下载与安装 <code>s
traight</code> 的代码，然后再用 <code>straight</code> 安装 <code>use-package</code> 。最后我用把
<code>straight-use-package-by-default</code> 变量设为 <code>t</code> ，这是在使用
<code>straight</code> 时进行插件自动安装的设置。
</p>
</div>
</div>
</div>
<div id="outline-container-h:3a24a351-22a7-4da1-bbfd-6fbc531b48ea" class="outline-4">
<h4 id="h:3a24a351-22a7-4da1-bbfd-6fbc531b48ea">推荐插件</h4>
<div class="outline-text-4" id="text-h:3a24a351-22a7-4da1-bbfd-6fbc531b48ea">
</div>
<div id="outline-container-h:32bbc13c-49b8-4582-afea-016055ad9940" class="outline-5">
<h5 id="h:32bbc13c-49b8-4582-afea-016055ad9940">安装插件的方法</h5>
<div class="outline-text-5" id="text-h:32bbc13c-49b8-4582-afea-016055ad9940">
<ul class="org-ul">
<li>把相关的 <code>use-package</code> 代码块复制到 <code>init.el</code></li>
<li>重启emacs，或者在 <code>init.el</code> 界面使用 <code>M-x eval-buffer</code> 加载代码块。</li>
</ul>
</div>
</div>
<div id="outline-container-h:28691e33-d352-4276-9cfd-6b6cf0a2e182" class="outline-5">
<h5 id="h:28691e33-d352-4276-9cfd-6b6cf0a2e182">更快熟悉 emacs</h5>
<div class="outline-text-5" id="text-h:28691e33-d352-4276-9cfd-6b6cf0a2e182">
<ul class="org-ul">
<li>快捷键提示 <code>which-key</code> 插件</li>
<li>显示当前快捷键及绑定命令 <code>keycast</code> 插件</li>
<li>更好的帮助界面 <code>helpful</code> 插件</li>
</ul>
</div>
<div id="outline-container-h:cfcb87e8-1fc8-498e-8f7f-ec5e97da76e7" class="outline-6">
<h6 id="h:cfcb87e8-1fc8-498e-8f7f-ec5e97da76e7">插件组合1: 更多的帮助信息</h6>
<div class="outline-text-6" id="text-h:cfcb87e8-1fc8-498e-8f7f-ec5e97da76e7">
<p>
<code>which-key</code> + <code>keycast</code> + <code>helpful</code>. 安装代码如下
</p>

<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">use-package</span> which-key
  <span style="color: #483d8b;">:custom</span> (which-key-idle-delay 0.5) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#24310;&#36831;&#26102;&#38388;, &#20197;&#31186;&#20026;&#21333;&#20301;</span>
  <span style="color: #483d8b;">:config</span> (which-key-mode)) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#21551;&#29992; which-key &#27169;&#24335;</span>

(<span style="color: #a020f0;">use-package</span> keycast
  <span style="color: #483d8b;">:config</span> (keycast-header-line-mode 1)) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#22312;&#26631;&#39064;&#26174;&#31034;</span>

(<span style="color: #a020f0;">use-package</span> helpful
  <span style="color: #483d8b;">:bind</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#37325;&#26032;&#23450;&#21521; C-h &#24320;&#22987;&#30340;&#21629;&#20196;</span>
  (([remap describe-function] . #'helpful-callable)
   ([remap describe-variable] . #'helpful-variable)
   ([remap describe-key] . #'helpful-key)
   ([remap describe-command] . #'helpful-command)
   ([remap describe-symbol] . #'helpful-symbol)
   (<span style="color: #8b2252;">"C-h C-d"</span> . #'helpful-at-point)
   (<span style="color: #8b2252;">"C-h F"</span> . #'helpful-function)))
</pre>
</div>

<p>
<code>which-key</code> 可以在按下快捷键的时候自动提示你接下来可能的快捷键。比如按
下 <code>C-h</code> ，就会提示接下来你按 <code>v</code> ， <code>f</code> ， <code>k</code> 等可以查看哪种类型的帮
助。如果把鼠标悬停在选项上也会在浮窗中显示对应命令的帮助。
</p>

<p>
<code>keycast</code> 则会显示当前你使用的快捷键及对应的命令名。它有 4 种显示的位
置。 代码中我们选择在 <code>headrer-line</code> ，也就是 Emacs 窗口的最上方显示。
如果大家想在别的地方显示，比如模式栏，可以把 <code>(keycast-header-line-mod
e 1)</code> 改成 <code>(keycast-mode-line-mode 1)</code> 。 
</p>

<p>
这两个插件可以帮助新手快速熟悉 Emacs 的快捷键和命令。对于老用户来说，
也可以帮你快速熟悉新安装的插件。
</p>

<p>
<code>helpful</code> 则优化了帮助界面的信息显示，包括更多有用的信息和高亮。
</p>
</div>
</div>
</div>
<div id="outline-container-h:e52a1a4e-4459-41ba-a4a5-176ffb4ed5f2" class="outline-5">
<h5 id="h:e52a1a4e-4459-41ba-a4a5-176ffb4ed5f2">更好的补全界面</h5>
<div class="outline-text-5" id="text-h:e52a1a4e-4459-41ba-a4a5-176ffb4ed5f2">
<p>
<code>vertico + marginalia + orderless</code>
</p>

<ul class="org-ul">
<li>tab 补全</li>
<li>C-n/C-p 上下浏览备选项</li>
</ul>
</div>
<div id="outline-container-h:dbd2dea6-7cc9-42d5-9266-436f5af34561" class="outline-6">
<h6 id="h:dbd2dea6-7cc9-42d5-9266-436f5af34561">插件组合2: 更好的补全界面</h6>
<div class="outline-text-6" id="text-h:dbd2dea6-7cc9-42d5-9266-436f5af34561">
<p>
在 Emacs 中输入命令或打开文件，切换缓冲区等等都会用到小缓冲区补全。
第二组插件是针对小缓冲区补全的。代码如下
</p>

<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">use-package</span> vertico <span style="color: #b22222;">; </span><span style="color: #b22222;">&#31446;&#24335;&#23637;&#24320;&#23567;&#32531;&#20914;&#21306;</span>
  <span style="color: #483d8b;">:custom</span> (verticle-cycle t)
  <span style="color: #483d8b;">:config</span> (vertico-mode))

(<span style="color: #a020f0;">use-package</span> marginalia <span style="color: #b22222;">; </span><span style="color: #b22222;">&#26356;&#22810;&#20449;&#24687;</span>
  <span style="color: #483d8b;">:config</span> (marginalia-mode))

(<span style="color: #a020f0;">use-package</span> orderless <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20081;&#24207;&#34917;&#20840;</span>
  <span style="color: #483d8b;">:custom</span>
  (completion-styles '(orderless basic))
  (completion-category-defaults nil)
  (completion-category-overrides '((file (styles partial-completion)))))
</pre>
</div>

<p>
<code>vertico</code> 把每个补全选项放在单独的一行，配合 <code>marginalia</code> 会在每个选项
的右边加入更多相关信息。
</p>

<p>
在小缓冲区中输入时，我们可以按 <code>&lt;tab&gt;</code> 补全当前的输入。加入 <code>vertico</code>
之后，我们可以用 <code>C-n</code> 和 <code>C-p</code> 或者上下移动键来选择不同的补全选项。
<code>C-n</code> 和 <code>C-p</code> 也是 Emacs 中上下移动光标的快捷键。
</p>

<p>
最后的 <code>orderless</code> 允许我们在小缓冲区补全时忽略单词的顺序。例如， 如
果我们输入 <code>M-x</code> ，想要匹配 <code>find-file</code> 命令，在默认情况下必须先输入
<code>find</code> ，再输入 <code>file</code> 才能找到 <code>find-file</code> 。如果你用了 <code>orderless</code> ，
则可以通过 <code>file find</code> 找到，或者部分的单词 <code>fil fin &lt;tab&gt;</code> 找到。 
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-h:e272d9da-8c8e-498a-96c7-07e1dcebfbed" class="outline-4">
<h4 id="h:e272d9da-8c8e-498a-96c7-07e1dcebfbed">org mode 必要的配置</h4>
<div class="outline-text-4" id="text-h:e272d9da-8c8e-498a-96c7-07e1dcebfbed">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-src-preserve-indentation t)             <span style="color: #b22222;">; </span><span style="color: #b22222;">&#32534;&#36753;&#28304;&#20195;&#30721;&#26102;&#20445;&#30041;&#21407;&#26377;&#30340;&#32553;&#36827;&#65292;t&#20195;&#34920;&#21551;&#29992;&#35813;&#21151;&#33021;&#12290;&#40664;&#35748;nil&#19981;&#20445;&#30041;. </span>
(<span style="color: #a020f0;">setq</span> org-src-tab-acts-natively t)                <span style="color: #b22222;">; </span><span style="color: #b22222;">&#28304;&#20195;&#30721;&#32534;&#36753;&#27169;&#24335;&#19979;&#65292;Tab&#38190;&#30340;&#34892;&#20026;&#19982;&#21407;&#29983;&#20195;&#30721;&#32534;&#36753;&#22120;&#19968;&#33268;&#65292;t&#20195;&#34920;&#21551;&#29992;&#35813;&#21151;&#33021;,  &#40664;&#35748;t</span>
(<span style="color: #a020f0;">setq</span> org-edit-src-content-indentation 0)          <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20195;&#30721;&#22359;&#37324;&#32553;&#36827;&#65292;0&#19981;&#32553;&#36827;&#65292;&#40664;&#35748;&#26159;2 (&#37325;&#35201;)</span>
</pre>
</div>
</div>
</div>
</div>
</section>
<section id="outline-container-h:51a717a4-822a-434a-acc9-e33498aee9b4" class="outline-2">
<h2 id="h:51a717a4-822a-434a-acc9-e33498aee9b4">配置</h2>
<div class="outline-text-2" id="text-h:51a717a4-822a-434a-acc9-e33498aee9b4">
</div>
<div id="outline-container-h:8a3b1d5a-e03d-4de2-b98e-4eb69d5e64f3" class="outline-3">
<h3 id="h:8a3b1d5a-e03d-4de2-b98e-4eb69d5e64f3">体验配置文件配置</h3>
<div class="outline-text-3" id="text-h:8a3b1d5a-e03d-4de2-b98e-4eb69d5e64f3">
<p>
创建文件 <code>～/.emacs</code> 并写入以下内容：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(menu-bar-mode -1)
(tool-bar-mode -1)
(scroll-bar-mode -1)
</pre>
</div>

<p>
Emacs 功能强大，但是部分功能默认情况下并未开启。下面就有几个例子，
</p>

<p>
编辑器内显示行号可使用 M-x linum-mode 来开启。
</p>

<p>
配置文件
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-display-line-numbers-mode 1) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#26174;&#31034;&#34892;&#21495; 29&#29256;&#26412;&#12290;29&#20043;&#21069;&#29992;(global-linum-mode 1)</span>
(<span style="color: #a020f0;">setq</span> inhibit-startup-screen t) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#23581;&#35797;&#20851;&#25481;&#21551;&#21160;&#30028;&#38754;</span>
(toggle-frame-maximized)                     <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20840;&#23631;&#32534;&#36753;&#22120;</span>
(<span style="color: #a020f0;">setq-default</span> cursor-type 'bar)              <span style="color: #b22222;">; </span><span style="color: #b22222;">&#26356;&#25913;&#20809;&#26631;&#30340;&#26679;&#24335;</span>
(set-face-attribute 'default nil <span style="color: #483d8b;">:height</span> 150) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20462;&#25913;&#23383;&#21495;&#65292;&#22823;&#23567;&#20026;16pt</span>
(global-hl-line-mode t)                      <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#39640;&#20142;&#24403;&#21069;&#34892;</span>
(electric-pair-mode t)                       <span style="color: #b22222;">; </span><span style="color: #b22222;">&#25324;&#21495;&#34917;&#20840;</span>
(<span style="color: #a020f0;">setq</span> make-backup-files nil)                 <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20851;&#38381;&#25991;&#20214;&#33258;&#21160;&#22791;&#20221;&#12290;&#22914;&#26524;&#26159;&#26377;git&#26469;&#31649;&#29702;&#25991;&#20214;&#65292;&#22791;&#20221;&#25991;&#20214;&#27809;&#26377;&#22826;&#22823;&#24847;&#20041;&#12290;~ &#20026;&#21518;&#32512;&#30340;&#25991;&#20214;&#20026;&#33258;&#21160;&#29983;&#25104;&#30340;&#22791;&#20221;&#25991;&#20214;</span>
(<span style="color: #a020f0;">setq</span> auto-save-default nil)   <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20851;&#38381;&#33258;&#21160;&#20445;&#23384;&#25991;&#20214;&#65292;#&#20026;&#21518;&#32512;&#30340;&#25991;&#20214;</span>
(fset 'yes-or-no-p 'y-or-n-p)                <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26576;&#20010;&#21629;&#20196;&#26102;&#38656;&#35201;&#36755;&#20837; (yes or no) </span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:6ff9076a-7e15-4eed-b2b1-31ddc2ca21e6" class="outline-3">
<h3 id="h:6ff9076a-7e15-4eed-b2b1-31ddc2ca21e6">配置文件位置</h3>
<div class="outline-text-3" id="text-h:6ff9076a-7e15-4eed-b2b1-31ddc2ca21e6">
<p>
配置文件是一个包含了 Emacs Lisp 源码的文件，描述了 Emacs 应当以什么样的方式启动。在 Emacs 启动的时候会执行其中的代码，可以理解为启动时刻运行的脚本。
</p>

<p>
当启动 Emacs 时，Emacs 会自动依次寻找以下几个文件之一作为配置文件：
</p>
<div class="org-src-container">
<pre class="src src-text">~/.emacs
~/.emacs.el
~/.emacs.d/init.el &#25110;&#32773; ~/.config/emacs/init.el (&gt;=27)
</pre>
</div>
<p>
找到就不再找了。
</p>

<p>
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Early-Init-File.html">early-init.el</a>:
</p>
<ul class="org-ul">
<li>在正常初始化文件处理之前，先让自定义生效。这些自定义可以放在早期初始化文件中， ~/.config/emacs/early-init.el 或者 ~/.emacs.d/early-init.el 。</li>
</ul>

<p>
如果想用其它位置的自定义配置文件详见<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Find-Init.html">文档</a> 。
</p>

<p>
可以预见，随着我们需要的功能越来越复杂，配置源码会越来越长，我们会希望能够分多个源文件进行不同功能的管理。所以使用 <code>~/.emacs.d/init.el</code> 作为配置文件是最为常见的。 我们可以将其它各种源文件都放置在 <code>~/.emacs.d</code>  目录下，方便管理。
</p>

<p>
<b>注意：</b> 如果希望把配置放在 <code>~/.emacs.d/init.el</code> 文件中，那么需要手工删除 <code>~/.emacs</code> 文件。
</p>
</div>
</div>
<div id="outline-container-h:42011591-c1ee-48af-95f7-eaa0b83e604d" class="outline-3">
<h3 id="h:42011591-c1ee-48af-95f7-eaa0b83e604d">Emacs Lisp 简介</h3>
<div class="outline-text-3" id="text-h:42011591-c1ee-48af-95f7-eaa0b83e604d">
<p>
<b>为什么要了解 Emacs Lisp</b>
</p>

<p>
Emacs Lisp 是世界上第二古老高级编程语言 Lisp 专为 Emacs 打造的方言。官方提供了 Emacs Lisp 的<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/index.html">入门</a>介绍和<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/index.html">参考手册</a>。简单来说 Emacs Lisp 编程语言就是用来为 Emacs 编写逻辑，Emacs 的底层和绝大部分插件都是用这个语言写出来的。同时，作为用户，我们也可以使用 Emacs Lisp 编写一些自定义逻辑，甚至进一步形成插件。
</p>

<p>
Emacs Lisp 发源于 Lisp，而 Lisp 就是 “List Processing“ 的缩写，可以看出，Lisp 语言的核心就是列表（List）。在 Lisp 中，每一对小括号表达了一个列表。在执行 Lisp 时，会把列表的第一个元素作为函数名，后面的元素都是函数的参数。元素可以是一个“词”，也可以是另一个列表。可以类比 Shell 命令的写法，也是第一个词是命令名，而后面的是命令的参数。
</p>

<p>
例如， <code>2+3+4</code> 在 Lisp 中写为：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(+ 2 3 4)
</pre>
</div>

<p>
因为 <code>+</code> 就是个函数，后面是它的参数。 再如 <code>4+(3-2)</code> 写为：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(+ 4 (- 3 2))
</pre>
</div>

<p>
那么在 Emacs 中基本都是做一些定义函数、变量等操作的 ，定义函数就用 defun 关键字， 设置变量的值用 setq 关键字。
</p>

<p>
这里就可以看出，Lisp 的变量名、函数名要比 C/C++、Python、Java 等主流语言的变量名的要求更宽松，Lisp 的变量名可以包含许多字符，所以如果看到了一些奇奇怪怪的名字，不要感到惊讶，就是变量名。
</p>

<p>
还有一些常见关键字如 <code>let</code> 为一组变量圈出一个作用域、 <code>if/when/unless</code> 表示条件语句。 t 表示 true，nil 表示空（相当于 C 语言的 NULL、Python 的 None）。
</p>

<p>
另外有一些不起眼的字符在 Lisp 中也是有意义的，例如单引号表达了后面的元素不进行执行而直接返回它本身：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">'(Tom Amy John)
</pre>
</div>

<p>
当括号前面有一个单引号时，表达了一个包含了三个元素的“数组”，而不是在执行一个叫 Tom 的函数。而
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">'ivy-set-prompt
</pre>
</div>

<p>
表示把 ivy-set-prompt 这个函数作为一个对象传递给其它部分，也没有执行这个函数。
</p>

<p>
反引号（`）backquote（或称 backtick、grave accent）在 Lisp 中也有含义，和单引号类似，读者只需要知道有这回事就好，基本上不需要我们去编写这些内容。
</p>

<p>
Emacs Lisp 源码文件的后缀名是 <code>.el</code> 。
</p>

<p>
分号（;）以后的内容都是注释。
</p>

<p>
由于 Lisp 的整个语言结构就是列表的嵌套，所以它设定了一个非常强大的宏系统，可以用代码生成代码，甚至定义出一个与之前不太一样的新语言，常被称为方言。Emacs Lisp 就是这样诞生的。再加上其变量名可使用的字符很多，所以读者如果发现了一些不同寻常的写法，例如下文提到的 use-package，不要觉得惊讶，也请记住 Lisp 的语法本质始终都是列表。
</p>
</div>
<div id="outline-container-h:dc18adb8-9cbd-4b66-a518-3b0fdb0e31a8" class="outline-4">
<h4 id="h:dc18adb8-9cbd-4b66-a518-3b0fdb0e31a8">学习基础的Elisp</h4>
<div class="outline-text-4" id="text-h:dc18adb8-9cbd-4b66-a518-3b0fdb0e31a8">
<p>
请务必完成<a href="https://learnxinyminutes.com/docs/elisp/">这篇教程（Learn X in Y Minutes）</a>来了解 Elisp 的使用（阅读时间大约 15 分钟），你也可以在<a href="https://learnxinyminutes.com/docs/zh-cn/elisp-cn/">这里</a>找到它的中文版。Emacs Lisp 为一个函数式的语言，所以它全部 功能都是由函数来实现的。
</p>
</div>
</div>
<div id="outline-container-h:54de14a9-13a2-4ca2-b647-d8e3897166a4" class="outline-4">
<h4 id="h:54de14a9-13a2-4ca2-b647-d8e3897166a4">elisp一些关键词</h4>
<div class="outline-text-4" id="text-h:54de14a9-13a2-4ca2-b647-d8e3897166a4">
<p>
在这一部分我们首先需要知道的是什么是 <code>features</code> 。在 Emacs 中每一个 <code>feature</code> 都 是一个 Elisp 符号，用于代表一个 Lisp 插件（Package）。
</p>

<p>
当一个插件调用 <code>(provide 'symbol_name)</code> 函数时，Emacs 就会将这个符号加入到 <code>features</code> 的列表中去。你可以在<a href="http://ergoemacs.org/emacs/elisp_feature_name.html">这里</a>读到更多关于 feature 的内容。
</p>

<p>
接着我们需要弄明白的是 <code>load-file</code> , <code>load</code> , <code>require</code> , <code>autoload</code> 之间的区别。 （他们之间区别的链接已经再前面贴过了，你也可以在<a href="http://ergoemacs.org/emacs/elisp_library_system.html">这里</a>找到之前同样的链接）
</p>

<p>
简单来说， <code>load-file</code> 用于打开某一个指定的文件，用于当你不想让 Emacs 来去决定加 载某个配置文件时（ <code>.el</code> 或者 <code>.elc</code> 文件）。
</p>

<p>
<code>load</code> 搜索 <code>load-path</code> 中的路径并打开第一个所找到的匹配文件名的文件。此方法用于 你预先不知道文件路径的时候。
</p>

<p>
<code>require</code> 加载还未被加载的插件。首先它会查看变量 <code>features</code> 中是否存在所要加载的 符号如果不存在则使用上面提到的 <code>load</code> 将其载入。（有点类似于其他编程语言中的 <code>import</code> ）
</p>

<p>
<code>autoload</code> 用于仅在函数调用时加载文件，使用此方法可以大大节省编辑器的启动时间。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">init-better-defaults.el &#25110;elc&#25991;&#20214;&#20869;&#23481;</span>
<span style="color: #b22222;">;;;</span><span style="color: #b22222;">**autoload</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">test-autoload</span>()
  (<span style="color: #a020f0;">interactive</span>)
  (message <span style="color: #8b2252;">"test autoload))</span>

<span style="color: #8b2252;">;; init.el&#25991;&#20214;&#20869;&#23481;</span>
<span style="color: #8b2252;">(autoload 'test-autoload "</span>init-better-defaults<span style="color: #8b2252;">")</span>
<span style="color: #8b2252;">(test-autoload)</span>
</pre>
</div>

<p>
<code>require</code> 依赖 <code>load=，=load</code> 依赖 <code>load-file</code>
</p>



<p>
<code>quote</code> 的意思是不要执行后面的内容，返回它原本的内容，用 <code>'</code> 引号表示（具体请参考下面的例子）
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(print '(+ 1 1)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">-&gt; (+ 1 1)</span>
(print (+ 1 1))  <span style="color: #b22222;">;; </span><span style="color: #b22222;">-&gt; 2</span>
</pre>
</div>

<p>
更多关于 <code>quote</code> 的内容可以在<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Quoting.html">这里</a>找到，或者在<a href="http://stackoverflow.com/questions/134887/when-to-use-quote-in-lisp">这里</a>找到 StackOverflow 上对于它的讨论。
</p>
</div>
</div>
<div id="outline-container-h:911f6338-d346-4e5e-a69b-228478de6aa5" class="outline-4">
<h4 id="h:911f6338-d346-4e5e-a69b-228478de6aa5">几种运行elisp代码的方法</h4>
<div class="outline-text-4" id="text-h:911f6338-d346-4e5e-a69b-228478de6aa5">
<p>
<b>elisp代码执行：</b>
</p>

<ul class="org-ul">
<li><code>C-x C-e</code> ： <code>eval-last-sexp</code> 这是最常用的，每次都要移动光标到要运行的代码后面。</li>
<li><code>M-x eval-region</code> ：执行选中区域代码</li>
<li><code>M-x eval-buffer</code> ：执行当前缓冲区代码</li>
<li><code>M-x load-file &lt;ENTER&gt; FILE_NAME</code> ：执行指定文件代码</li>
<li><code>C-j</code> : 执行最近距离代码，并打印输出以当前位置</li>
<li><code>C-M-x</code> : runs the command eval-defun 执行整个代码块。写函数经常修改
然后运行，如果每次跑到最外面去 <code>C-x C-e</code> ，就很麻烦。光标只要在运行的代码块里就行了。</li>
<li><code>M-:</code> : runs the command eval-expression</li>
<li><code>M-x ielm</code> 类似于ipython交互式运行</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:fe108c1c-fe43-495f-95d0-dd763e3b42a8" class="outline-3">
<h3 id="h:fe108c1c-fe43-495f-95d0-dd763e3b42a8">工程化管理配置</h3>
<div class="outline-text-3" id="text-h:fe108c1c-fe43-495f-95d0-dd763e3b42a8">
<p>
将不同的配置代码放置到不同的文件中，使其模块化，这让我们的后续维护变得更加简单。 下面是我们 `~/.emacs.d/` 目录中的样子，
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #483d8b;">.</span>
&#9500;&#9472;&#9472; auto-save-list <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33258;&#21160;&#29983;&#25104;&#30340;&#20445;&#23384;&#25968;&#25454;</span>
&#9500;&#9472;&#9472; bookmarks
&#9500;&#9472;&#9472; custom.el    <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23384;&#25918;&#20351;&#29992;&#32534;&#36753;&#22120;&#25509;&#21475;&#20135;&#29983;&#30340;&#37197;&#32622;&#20449;&#24687;</span>
&#9500;&#9472;&#9472; elpa         <span style="color: #b22222;"># </span><span style="color: #b22222;">&#19979;&#36733;&#30340;&#25554;&#20214;&#30446;&#24405;</span>
&#9500;&#9472;&#9472; history
&#9500;&#9472;&#9472; init.el     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25105;&#20204;&#30340;&#37197;&#32622;&#25991;&#20214;</span>
&#9500;&#9472;&#9472; lisp
&#9474;  &#9500;&#9472;&#9472; init-basic.el
&#9474;  &#9500;&#9472;&#9472; init-elpa.el
&#9474;  &#9500;&#9472;&#9472; init-org.el
&#9474;  &#9500;&#9472;&#9472; init-recentf.el
&#9474;  &#9500;&#9472;&#9472; init-site-lisp.el
&#9474;  &#9500;&#9472;&#9472; init-themes.el
&#9474;  &#9492;&#9472;&#9472; init-utils.el
&#9500;&#9472;&#9472; recentf <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26368;&#36817;&#35775;&#38382;&#30340;&#25991;&#20214;&#21015;&#34920;</span>
&#9492;&#9472;&#9472; site-lisp  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#38745;&#24577;&#21253;&#30446;&#24405;</span>
</pre>
</div>

<p>
lisp 和 site-lisp 分别为存放不同功能的文件的目录和非插件源包目录。
默认自定义配置会保存在 init.el 文件中，拆分出自定义部分到 custom.el 方便管理。
</p>


<p>
创建必要的文件
</p>
<div class="org-src-container">
<pre class="src src-shell">mkdir lisp site-lisp
touch custom.el
</pre>
</div>
</div>
<div id="outline-container-h:b22de275-5fe1-4a6b-9558-2b9617f1c358" class="outline-4">
<h4 id="h:b22de275-5fe1-4a6b-9558-2b9617f1c358">使用git管理你的文件</h4>
<div class="outline-text-4" id="text-h:b22de275-5fe1-4a6b-9558-2b9617f1c358">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #483d8b;">cd</span> ~/.emacs.d
git init
vim .gitignore

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25552;&#20132;&#20462;&#25913;</span>
git add .
git commit -m <span style="color: #8b2252;">'first commit'</span>
git push 

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#27599;&#27425;&#21151;&#33021;&#22635;&#20889;&#23436;&#25552;&#20132; tag</span>
git tag basic.v.1.0
git push tags

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#24555;&#36895;&#24674;&#22797;</span>
git reset --hard HEAD
</pre>
</div>

<p>
gitingnore 文件
</p>

<div class="org-src-container">
<pre class="src src-shell">*.elc
CVS
.svn
*~
<span style="color: #8b2252;">\#</span>*
<span style="color: #483d8b;">.</span><span style="color: #8b2252;">\#</span>*
/auto-save-list
/bookmarks
/custom.el
/elpa
/elpa-*
/history
/recentf
site-lisp/package/
/eshell/
/server/
/transient/
</pre>
</div>

<p>
重新加载文件
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#37325;&#26032;&#21152;&#36733;&#25991;&#20214; M-x global-auto-revert-mode </span>
(global-auto-revert-mode t)
</pre>
</div>

<p>
emacs 下创建目录使用 `M-x make-directory`
</p>
</div>
</div>
<div id="outline-container-h:8ce545ab-324f-47f3-a587-bd2ffd45a621" class="outline-4">
<h4 id="h:8ce545ab-324f-47f3-a587-bd2ffd45a621">使用多文件存储配置文件</h4>
<div class="outline-text-4" id="text-h:8ce545ab-324f-47f3-a587-bd2ffd45a621">
<p>
Elisp 中并没有命名空间（Namespace），换句话说就是所有的变量均为全局变量，所以其 命名方法就变的非常重要。下面是一个简单的命名规则，
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#33258;&#23450;&#20041;&#21464;&#37327;&#21487;&#20197;&#20351;&#29992;&#33258;&#24049;&#30340;&#21517;&#23383;&#20316;&#20026;&#21629;&#21517;&#26041;&#24335;&#65288;&#21487;&#20197;&#26159;&#21464;&#37327;&#21517;&#25110;&#32773;&#20989;&#25968;&#21517;&#65289;</span>
my/XXXX

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#27169;&#24335;&#21629;&#21517;&#35268;&#21017;</span>
ModeName-mode

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#27169;&#24335;&#20869;&#30340;&#21464;&#37327;&#21017;&#21487;&#20197;&#20351;&#29992;</span>
ModeName-VariableName
</pre>
</div>

<p>
遵守上面的命名规则可以最大程度的减少命名冲突发生的可能性。
</p>

<p>
现在我们想将原本混合在一起的配置文件分为下面的几个模块（每一个模块为一个独立的配 置文件并将其保存在指定的子目录中），它们分别是
</p>

<ul class="org-ul">
<li>Packages：
<ul class="org-ul">
<li>init-packages.el        插件源</li>
</ul></li>
<li>Core：
<ul class="org-ul">
<li>init-basic.el           基础配置
<ul class="org-ul">
<li>custom.el               存放使用编辑器接口产生的配置信息</li>
<li>init-funcs              自定义函数</li>
</ul></li>
<li>init-completion         补全</li>
<li>init-tools              工具包</li>
</ul></li>
<li>uis：
<ul class="org-ul">
<li>init-ui.el              视觉层配置</li>
<li>init-better-defaults.el 增强内置功能</li>
</ul></li>
<li>Tools：
<ul class="org-ul">
<li>init-org.el             Org 模式相关的全部设定</li>
</ul></li>
<li>Languages：
<ul class="org-ul">
<li>init-c.el                  C语言</li>
</ul></li>
<li>personal：
<ul class="org-ul">
<li>init-keybindings.el     快捷键绑定</li>
</ul></li>
</ul>
</div>
<div id="outline-container-h:94ef3913-683b-4744-9add-41e43bcce276" class="outline-5">
<h5 id="h:94ef3913-683b-4744-9add-41e43bcce276">关于自定义的配置</h5>
<div class="outline-text-5" id="text-h:94ef3913-683b-4744-9add-41e43bcce276">
<p>
建议写入一个单独的文件，对外开源的时候，该文件不被提交到 Git 中。如， custom.el
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> custom-file (expand-file-name <span style="color: #8b2252;">"~/.emacs.d/custom.el"</span>)) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#27809;&#26377;&#21017;&#33258;&#21160;&#21019;&#24314;</span>
</pre>
</div>

<p>
兼容27版本后 ~/.config/emacs/init.el 配置
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> custom-file (expand-file-name <span style="color: #8b2252;">"custom.el"</span> user-emacs-directory))
</pre>
</div>


<p>
init.el 文件结尾记得要加载自定义配置
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(load custom-file 'no-error 'no-message)
</pre>
</div>

<p>
这样就会把通过图形界面做的一些配置，写入到这里了
</p>


<div class="org-src-container">
<pre class="src src-shell">&#9500;&#9472;&#9472; init.el
&#9500;&#9472;&#9472; lisp
&#9474;  &#9500;&#9472;&#9472; init-basic.el      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22522;&#30784;&#37197;&#32622;</span>
&#9474;  &#9500;&#9472;&#9472; init-elpa.el       <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25554;&#20214;&#28304;</span>
&#9474;  &#9500;&#9472;&#9472; init-org.el        <span style="color: #b22222;"># </span><span style="color: #b22222;">org mode</span>
&#9474;  &#9500;&#9472;&#9472; init-recentf.el    <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26368;&#36817;&#25171;&#24320;&#25991;&#20214;  </span>
&#9474;  &#9500;&#9472;&#9472; init-site-lisp.el  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#38750; elpa &#28304;</span>
&#9474;  &#9500;&#9472;&#9472; init-themes.el     <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20027;&#39064;</span>
&#9474;  &#9492;&#9472;&#9472; init-utils.el      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33258;&#23450;&#20041;&#24037;&#20855;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">----------</span>
&#9500;&#9472;&#9472; custom.el
&#9500;&#9472;&#9472; early-init.el
&#9500;&#9472;&#9472; init.el
&#9500;&#9472;&#9472; lisp
&#9474;   &#9500;&#9472;&#9472; init-basic.el
&#9474;   &#9500;&#9472;&#9472; init-better-defaults.el
&#9474;   &#9500;&#9472;&#9472; init-c.el
&#9474;   &#9500;&#9472;&#9472; init-completion.el
&#9474;   &#9500;&#9472;&#9472; init-const.el
&#9474;   &#9500;&#9472;&#9472; init-custom.el
&#9474;   &#9500;&#9472;&#9472; init-funcs.el
&#9474;   &#9500;&#9472;&#9472; init-keybindings.el
&#9474;   &#9500;&#9472;&#9472; init-lisp.el
&#9474;   &#9500;&#9472;&#9472; init-org.el
&#9474;   &#9500;&#9472;&#9472; init-package.el
&#9474;   &#9500;&#9472;&#9472; init-tools.el
&#9474;   &#9500;&#9472;&#9472; init-ui.el
&#9474;   &#9492;&#9472;&#9472; init-writing.el
</pre>
</div>

<p>
下面为将配置文件进行模块化后的目录结构，
</p>
</div>
</div>
<div id="outline-container-h:8b4ed8a2-622d-4e09-80e1-632c9fe36b67" class="outline-5">
<h5 id="h:8b4ed8a2-622d-4e09-80e1-632c9fe36b67">文件加载与调用</h5>
<div class="outline-text-5" id="text-h:8b4ed8a2-622d-4e09-80e1-632c9fe36b67">
<p>
先设置加载的目标目录到 `load-path` 中。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'load-path <span style="color: #8b2252;">"~/.emacs.d/lisp/"</span>)
</pre>
</div>

<p>
兼容27版本后`~/.config/emacs/init.el `配置
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'load-path
    (expand-file-name (concat user-emacs-directory <span style="color: #8b2252;">"lisp"</span>)))
</pre>
</div>

<p>
各个文件通过 provide 暴露对外调用的名称。如：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">init-basic</span>)
</pre>
</div>

<p>
然后在 init.el 文件中通过 `require` 调用：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">require 'init-basic
</pre>
</div>
</div>
</div>
<div id="outline-container-h:0b7eb58f-9851-4463-8f6f-86171466b26f" class="outline-5">
<h5 id="h:0b7eb58f-9851-4463-8f6f-86171466b26f">配置生效</h5>
<div class="outline-text-5" id="text-h:0b7eb58f-9851-4463-8f6f-86171466b26f">
<p>
最简单让配置生效的办法就是重启 Emacs。
</p>

<p>
此外，如果你在频繁的改一些配置，尤其是调整一些参数等，频繁的重启很麻烦。事实上 Emacs Lisp 语言是逐句执行的。所以例如我们新加入了一段配置，我们便可以直接选中这部分代码，然后按下 <code>M-x eval-region</code> ，表达了“运行选中的这部分代码”的含义，这样这段代码立刻就会生效了。当然，还有 <code>M-x eval-buffer</code> 可以直接重新执行一下当前 Buffer 的所有代码。
</p>
</div>
</div>
<div id="outline-container-h:5ad76dc7-63a0-4947-84a7-683020691320" class="outline-5">
<h5 id="h:5ad76dc7-63a0-4947-84a7-683020691320">结尾</h5>
<div class="outline-text-5" id="text-h:5ad76dc7-63a0-4947-84a7-683020691320">
<p>
最后，配置文件的结尾要有一句：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">init</span>)

<span style="color: #b22222;">;;; </span><span style="color: #b22222;">init.el ends here</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:71917c6d-e323-495b-a7f2-f55cb1f3582d" class="outline-4">
<h4 id="h:71917c6d-e323-495b-a7f2-f55cb1f3582d">使用 Org-mode 管理 Emacs 配置</h4>
<div class="outline-text-4" id="text-h:71917c6d-e323-495b-a7f2-f55cb1f3582d">
<p>
Org-mode 下的文学编程将颠覆你对于 Emacs 的看法。因为我们也可以使用 Org 来管理 Emacs 的配置文件。
</p>

<p>
我们可以让我们的配置文件更加清晰有序，并且可以添加很多注释之外的资料、链接等，让我们的配置更加易读和可管理。
</p>

<p>
我们通常可以有如下几种方式来管理配置文件：
</p>

<ul class="org-ul">
<li>将所有配置都放到 ~/.emacs 文件里（比较老的方式，不推荐）</li>
<li>将所有配置文件都统一放到 ~/.emacs.d/init.el 里；</li>
<li>将所有配置文件通过一个org文件来管理，通过 org-babel-load-file 函数来加载；</li>
<li>将所有配置文件模块化，通过 init.el 来统一加载（这是众多大佬采用的方式）；</li>
<li>将所有配置文件通过一个 org 文件来管理，通过 tangle 的技术实现模块化（最优解）；</li>
</ul>

<p>
这里我们讲解我个人认为的最优解——将所有配置文件放到一个 org 文件来管理，并通过 Org mode 的 tangle 功能实现模块化。
</p>
</div>
<div id="outline-container-h:a2a93741-1976-48e2-b4ab-4241c4e60bfb" class="outline-5">
<h5 id="h:a2a93741-1976-48e2-b4ab-4241c4e60bfb">通过Org mode 的 tangle 功能管理模块化配置</h5>
<div class="outline-text-5" id="text-h:a2a93741-1976-48e2-b4ab-4241c4e60bfb">
<ul class="org-ul">
<li>创建org文件。如 <code>~/.emacs.d/emacs-config.org</code></li>
<li><p>
代码块
它能够自动的将代码块里的代码，写入到指定的文件里去，不指定默认在当前目录生成与文件同名.el文件。
</p>

<p>
而且它的配置方式也非常灵活：
</p>
<ul class="org-ul">
<li>代码块配置tangle</li>
<li>标题行配置tangle</li>
</ul></li>

<li>执行 <code>M-x org-babel-tangle</code> 命令来触发 tangle 这个动作。</li>
</ul>

<p>
<b>范例-代码块配置tangle</b>
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">+BEGIN_SRC emacs-lisp :tangle ~/.emacs.d/test.el</span>
(+ 1 2)
<span style="color: #b22222;">#</span><span style="color: #b22222;">+END_SRC</span>
</pre>
</div>

<p>
执行 <code>M-x org-babel-tangle</code> ，代码 (+ 1 2) 将写入到 ~/.emacs.d/test.el 这个文件里。
</p>

<p>
<b>范例-标题行配置tangle</b>
</p>
<div class="org-src-container">
<pre class="src src-sh">* early-init.el
:PROPERTIES:
:HEADER-ARGS: :tangle early-init.el
:END
</pre>
</div>

<p>
<b>不想写入文件</b>
</p>
<ul class="org-ul">
<li>直接在对应代码块或者标题参数行写上 :tangle no</li>
</ul>

<p>
<b>创建目录</b>
</p>
<ul class="org-ul">
<li>目录不存在，则 <code>mkdirp yes</code> 创建目录， <code>mkdirp no</code> 禁止创建目录</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">+begin_src emacs-lisp :tangle "emacs-modules/emacs-theme.el" :mkdirp yes</span>
</pre>
</div>

<p>
<b>范例-init.el</b>
</p>
<div class="org-src-container">
<pre class="src src-org"><span style="color: #7f7f7f;">#+TITLE:</span> <span style="color: #191970; font-weight: bold;">Emacs&#37197;&#32622;&#25991;&#20214;</span>
<span style="color: #7f7f7f;">#+AUTHOR:</span> <span style="color: #191970;">Jasper</span>
<span style="color: #7f7f7f;">#+DATE:</span> <span style="color: #191970;">2023/06/30 14:23:50</span>

<span style="color: #b22222;">#+STARTUP: overview</span>

<span style="color: #0000ff;">* init.el</span>
<span style="color: #0000ff;">:PROPERTIES:</span>
<span style="color: #a020f0;">:HEADER-ARGS:</span> <span style="color: #000000; background-color: #ffffff;">:tangle initxxxx.el</span>
<span style="color: #0000ff;">:END:</span>
<span style="color: #7f7f7f;">=init.el=</span> &#26159;Emacs&#30340;&#20027;&#35201;&#37197;&#32622;&#25991;&#20214;&#12290;

<span style="color: #a0522d;">** init.el &#25991;&#20214;&#22836;</span>
<span style="color: #b22222;">#+BEGIN_SRC emacs-lisp</span>
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">init.el --- The main init entry for Emacs -*- lexical-binding: t -*-</span>
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">Commentary:</span>

<span style="color: #b22222;">;;; </span><span style="color: #b22222;">Code:</span>

<span style="color: #b22222;">#+END_SRC</span>

<span style="color: #a0522d;">** package&#21253;&#31649;&#29702;&#37197;&#32622;</span>
<span style="color: #b22222;">#+begin_src emacs-lisp</span>
<span style="color: #7f7f7f;">(</span><span style="color: #a020f0;">require</span><span style="color: #7f7f7f;"> '</span><span style="color: #008b8b;">package</span><span style="color: #7f7f7f;">)</span>
<span style="color: #7f7f7f;">(</span><span style="color: #a020f0;">setq</span><span style="color: #7f7f7f;"> package-archives</span>
<span style="color: #7f7f7f;">          '((</span><span style="color: #8b2252;">"melpa"</span><span style="color: #7f7f7f;">  . </span><span style="color: #8b2252;">"<a href="https://melpa.org/packages/">https://melpa.org/packages/</a>"</span><span style="color: #7f7f7f;">)</span>
<span style="color: #7f7f7f;">            (</span><span style="color: #8b2252;">"gnu"</span><span style="color: #7f7f7f;">    . </span><span style="color: #8b2252;">"<a href="https://elpa.gnu.org/packages/">https://elpa.gnu.org/packages/</a>"</span><span style="color: #7f7f7f;">)</span>
<span style="color: #7f7f7f;">            (</span><span style="color: #8b2252;">"nongnu"</span><span style="color: #7f7f7f;"> . </span><span style="color: #8b2252;">"<a href="https://elpa.nongnu.org/nongnu/">https://elpa.nongnu.org/nongnu/</a>"</span><span style="color: #7f7f7f;">)))</span>

<span style="color: #7f7f7f;">(package-initialize)</span>
<span style="color: #b22222;">#+end_src</span>

<span style="color: #a0522d;">** &#23433;&#35013;use-package&#25554;&#20214;</span>
<span style="color: #3a5fcd; text-decoration: underline;"><a href="https://github.com/jwiegley/use-package">use-package</a></span> &#26159;&#19968;&#20010;&#35753;Emacs&#37197;&#32622;&#26356;&#21152;&#32467;&#26500;&#21270;&#26356;&#21152;&#28165;&#26224;&#30340;&#19968;&#20010;&#23439;&#25554;&#20214;&#12290;

<span style="color: #b22222;">#+begin_src emacs-lisp</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23433;&#35013; `</span><span style="color: #008b8b;">use-package</span><span style="color: #b22222;">'</span>
<span style="color: #7f7f7f;">(</span><span style="color: #a020f0;">unless</span><span style="color: #7f7f7f;"> (package-installed-p 'use-package)</span>
<span style="color: #7f7f7f;">  (package-refresh-contents)</span>
<span style="color: #7f7f7f;">  (package-install 'use-package))</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#37197;&#32622; `</span><span style="color: #008b8b;">use-package</span><span style="color: #b22222;">'</span>
<span style="color: #7f7f7f;">(</span><span style="color: #a020f0;">eval-and-compile</span>
<span style="color: #7f7f7f;">  (</span><span style="color: #a020f0;">setq</span><span style="color: #7f7f7f;"> use-package-always-ensure nil)</span>
<span style="color: #7f7f7f;">  (</span><span style="color: #a020f0;">setq</span><span style="color: #7f7f7f;"> use-package-always-defer nil)</span>
<span style="color: #7f7f7f;">  (</span><span style="color: #a020f0;">setq</span><span style="color: #7f7f7f;"> use-package-expand-minimally nil)</span>
<span style="color: #7f7f7f;">  (</span><span style="color: #a020f0;">setq</span><span style="color: #7f7f7f;"> use-package-enable-imenu-support t)</span>
<span style="color: #7f7f7f;">  (</span><span style="color: #a020f0;">if</span><span style="color: #7f7f7f;"> (daemonp)</span>
<span style="color: #7f7f7f;">          (</span><span style="color: #a020f0;">setq</span><span style="color: #7f7f7f;"> use-package-always-demand t)))</span>

<span style="color: #7f7f7f;">(</span><span style="color: #a020f0;">eval-when-compile</span>
<span style="color: #7f7f7f;">  (</span><span style="color: #a020f0;">require</span><span style="color: #7f7f7f;"> '</span><span style="color: #008b8b;">use-package</span><span style="color: #7f7f7f;">))</span>

<span style="color: #a0522d;">** init.el &#25991;&#20214;&#23614;</span>
<span style="color: #b22222;">#+BEGIN_SRC emacs-lisp</span>

<span style="color: #7f7f7f;">(</span><span style="color: #a020f0;">provide</span><span style="color: #7f7f7f;"> '</span><span style="color: #008b8b;">init</span><span style="color: #7f7f7f;">)</span>
<span style="color: #b22222;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">init.el ends here</span>
<span style="color: #b22222;">#+END_SRC</span>
</pre>
</div>

<p>
执行 <code>M-x org-babel-tangle</code> 后，~/.emacs.d 目录下的结构大致如下：
</p>
<div class="org-src-container">
<pre class="src src-sh">/Users/jasper/.emacs.d/
&#9500;&#9472;&#9472; init.el
&#9500;&#9472;&#9472; emacs-config.org
</pre>
</div>


<p>
如果想加载 org 文件代码，在 <code>init.el</code> 如下配置：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-install</span>)
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ob-tangle</span>)
(org-babel-load-file (expand-file-name <span style="color: #8b2252;">"emacs-config.org"</span> user-emacs-directory))
</pre>
</div>

<p>
重启启动 emacs 同时根据 org 文件生成对应的el文件
</p>


<p>
这里推荐一些使用org-mode进行配置管理的优秀范例：
</p>

<p>
<a href="https://github.com/wowhxj/emacs-from-scratch">https://github.com/wowhxj/emacs-from-scratch</a>
</p>
</div>
</div>
</div>
<div id="outline-container-h:cb512e5c-d90f-4d19-b65d-d71c0fb33028" class="outline-4">
<h4 id="h:cb512e5c-d90f-4d19-b65d-d71c0fb33028">关于 lexical binding</h4>
<div class="outline-text-4" id="text-h:cb512e5c-d90f-4d19-b65d-d71c0fb33028">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#40664;&#35748;&#27809;&#26377;&#28608;&#27963;&#12290;&#22312;&#25991;&#20214;&#26368;&#24320;&#22836;&#28155;&#21152;&#25991;&#20214;&#20316;&#29992;&#22495;&#30340;&#21464;&#37327;&#35774;&#32622;&#65292;&#35774;&#32622;&#21464;&#37327;&#30340;&#32465;&#23450;&#26041;&#24335;&#12290;&#35774;&#32622;&#22312;&#24403;&#21069;&#25991;&#20214;&#20316;&#29992;&#22495;&#20869;&#26159;&#28608;&#27963;&#30340;&#12290;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">-*- lexical-binding: t -*-</span>
(<span style="color: #a020f0;">let</span> ((x 1))    <span style="color: #b22222;">; </span><span style="color: #b22222;">x is lexically bound.</span>
  (+ x 3))
     &#8658; 4       <span style="color: #b22222;">; </span><span style="color: #b22222;">1 + 3 &#30340;&#20540;&#20026; 4</span>

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">getx</span> ()
  x)            <span style="color: #b22222;">; </span><span style="color: #b22222;">x is used free in this function.</span>

(<span style="color: #a020f0;">let</span> ((x 1))    <span style="color: #b22222;">; </span><span style="color: #b22222;">x is lexically bound. getx &#26159;&#29992;&#19981;&#21040; let &#23450;&#20041;&#30340; x &#30340;</span>
  (getx))
<span style="color: #b22222;">;;</span><span style="color: #b22222;">error&#8594; Symbol's value as variable is void: x</span>
</pre>
</div>

<p>
关于<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Lexical-Binding.html">lexical binding</a>更多的细节，可以自行阅读 Emacs 的官方文档。程序代码使用 lexical binding 会更利于并发，编辑器会执行一些优化让代码执行的更快。很多插件要求安装 lexical binding。
</p>

<p>
范例：init.el
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">init.el --- Load the full configuration -*- lexical-binding: t -*-</span>
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">Commentary:</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">This file bootstraps the configuration, which is divided into</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">a number of other files.</span>

<span style="color: #b22222;">;;; </span><span style="color: #b22222;">Code:</span>

(+ 1 2)

<span style="color: #b22222;">;;; </span><span style="color: #b22222;">init.el ends here</span>
</pre>
</div>

<p>
三个分号开头的注释表示“节”，两个分号开头的注释表示“段落”。（一个分号开头的是一行代码后面的行内注释）。
</p>
</div>
</div>
<div id="outline-container-h:0bf268dd-e6af-4ce1-ac45-0e426f705241" class="outline-4">
<h4 id="h:0bf268dd-e6af-4ce1-ac45-0e426f705241">配置快捷键</h4>
<div class="outline-text-4" id="text-h:0bf268dd-e6af-4ce1-ac45-0e426f705241">
<p>
首先介绍一下如何配置全局的快捷键：
</p>
<div class="org-src-container">
<pre class="src src-sh">(global-set-key (kbd &lt;KEY&gt;) &lt;FUNCTION&gt;)
</pre>
</div>

<p>
其中 <code>&lt;KEY&gt;</code> 和 <code>&lt;FUNCTION&gt;</code> 替换为你想要设置的快捷键和功能。
</p>

<p>
范例-一个常见设置是修改回车键为“新起一行并做缩进”：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lsip">(global-set-key (kbd "RET") 'newline-and-indent)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:458312fc-ed1b-469f-aff7-8f1800137b0c" class="outline-3">
<h3 id="h:458312fc-ed1b-469f-aff7-8f1800137b0c">插件管理</h3>
<div class="outline-text-3" id="text-h:458312fc-ed1b-469f-aff7-8f1800137b0c">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>
</div>
<div id="outline-container-h:40fc6264-04bf-45e3-a5d8-11e900e91819" class="outline-4">
<h4 id="h:40fc6264-04bf-45e3-a5d8-11e900e91819">MELPA 插件源</h4>
<div class="outline-text-4" id="text-h:40fc6264-04bf-45e3-a5d8-11e900e91819">
<ul class="org-ul">
<li>MELPA <a href="https://melpa.org/">https://melpa.org/</a></li>
</ul>

<p>
Emacs 最大的插件仓库就是 MELPA 了，也就是上文提到的 Steve Purcell 所维护的项目。此外也有一个默认仓库 GNU ELPA。
</p>

<p>
<a href="https://melpa.org/#/getting-started">MELPA 的官网</a>有直接介绍如何配置
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">package</span>)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24341;&#29992;&#21253;&#31649;&#29702;&#22120;</span>
(add-to-list 'package-archives '(<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"https://melpa.org/packages/"</span>) t)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#21253;&#30340;&#28304;</span>
(package-initialize)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21021;&#22987;&#21270;&#21253;</span>
</pre>
</div>

<p>
只需这三行，就可以把仓库地址 <a href="https://melpa.org/packages">https://melpa.org/packages</a> 存储到 package-archives 列表中，并命名为 “melpa”。
</p>

<p>
由于国内网络问题，直接访问速度较慢，有如下两个方案。
</p>

<p>
<b>1. 使用代理</b>
把下面的代码加在配置文件中，修改为自己的代理服务器 IP 和代理服务器端口号。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> gnutls-algorithm-priority <span style="color: #8b2252;">"NORMAL:-VERS-TLS1.3"</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#19981;&#21152;&#36825;&#19968;&#21477;&#21487;&#33021;&#26377;&#38382;&#39064;&#65292;&#24314;&#35758;&#35835;&#32773;&#23581;&#35797;&#19968;&#19979;</span>
(<span style="color: #a020f0;">setq</span> url-proxy-services '((<span style="color: #8b2252;">"no_proxy"</span> . <span style="color: #8b2252;">"^</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">192\\.168\\..*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">"</span>)
                           (<span style="color: #8b2252;">"http"</span> . <span style="color: #8b2252;">"&lt;&#20195;&#29702; IP&gt;:&lt;&#20195;&#29702;&#31471;&#21475;&#21495;&gt;"</span>)
                           (<span style="color: #8b2252;">"https"</span> . <span style="color: #8b2252;">"&lt;&#20195;&#29702; IP&gt;:&lt;&#20195;&#29702;&#31471;&#21475;&#21495;&gt;"</span>)))
</pre>
</div>

<p>
<b>2. 使用国内镜像</b>
</p>
<ul class="org-ul">
<li>官方镜像：</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'package-archives '("melpa" . "https://melpa.org/packages/"))</span>

(<span style="color: #a020f0;">setq</span> package-archives '((<span style="color: #8b2252;">"gnu"</span>   . <span style="color: #8b2252;">"https://elpa.gnu.org/packages/"</span>)
                         (<span style="color: #8b2252;">"nongnu"</span> . <span style="color: #8b2252;">"https://elpa.nongnu.org/nongnu/"</span>)
                         (<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"https://melpa.org/packages/"</span>))

(<span style="color: #a020f0;">unless</span> (<span style="color: #a020f0;">bound-and-true-p</span> package--initialized)
  (package-initialize)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21047;&#26032;&#36719;&#20214;&#28304;&#32034;&#24341;</span>

<span style="color: #b22222;">;;</span><span style="color: #b22222;">&#38450;&#27490;&#21453;&#22797;&#35843;&#29992; package-refresh-contents &#20250;&#24433;&#21709;&#21152;&#36733;&#36895;&#24230;</span>
(<span style="color: #a020f0;">when</span> (not package-archive-contents)
  (package-refresh-contents))
</pre>
</div>

<ul class="org-ul">
<li>腾讯镜像：</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> package-archives '((<span style="color: #8b2252;">"gnu"</span>   . <span style="color: #8b2252;">"http://mirrors.cloud.tencent.com/elpa/gnu/"</span>)
                         (<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"http://mirrors.cloud.tencent.com/elpa/melpa/"</span>)))
</pre>
</div>

<ul class="org-ul">
<li>清华源 <a href="https://mirrors.tuna.tsinghua.edu.cn/help/elpa/">https://mirrors.tuna.tsinghua.edu.cn/help/elpa/</a></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> package-archives '(
    (<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"http://mirrors.tuna.tsinghua.edu.cn/elpa/melpa/"</span>)
    (<span style="color: #8b2252;">"gnu"</span> . <span style="color: #8b2252;">"http://mirrors.tuna.tsinghua.edu.cn/elpa/gnu/"</span>)
    (<span style="color: #8b2252;">"org"</span> . <span style="color: #8b2252;">"http://mirrors.tuna.tsinghua.edu.cn/elpa/org/"</span>)))
</pre>
</div>


<ul class="org-ul">
<li>emacs 中国社区的源 <a href="https://elpa.emacs-china.org/">https://elpa.emacs-china.org/</a></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> package-archives '(
                         (<span style="color: #8b2252;">"gnu"</span>   . <span style="color: #8b2252;">"http://elpa.zilongshanren.com/gnu/"</span>)
                         (<span style="color: #8b2252;">"nongnu"</span> . <span style="color: #8b2252;">"http://elpa.zilongshanren.com/nongnu/"</span>)
                         (<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"http://elpa.zilongshanren.com/melpa/"</span>)))
</pre>
</div>

<p>
假如不清楚需要用哪些 ELPA 的话
</p>
<ul class="org-ul">
<li><code>gnu</code> 一般是必备的，其它的 elpa 中的包会依赖 <code>gnu</code> 中的包</li>
<li><code>melpa</code> 滚动升级，收录了的包的数量最大</li>
<li><code>melpa-stable</code> 依据源码的 Tag （Git）升级，数量比 <code>melpa</code> 少，因为很多包作者根本不打 Tag</li>
<li><code>org</code> 仅仅为了 <code>org-plus-contrib</code> 这一个包，org 重度用户使用</li>
</ul>

<p>
安装扩展前，需要先刷新软件源的索引。
</p>

<p>
随后重启 Emacs 后，输入命令 <code>package-list-packages</code> 就可以列出来仓库中的所有插件，可以选中相应的插件，会弹出介绍的界面和安装按钮。此外，还可以直接输入命令 <code>package-install</code> 后输入插件名就可以安装相应插件。
</p>

<p>
默认情况下，插件会被安装到 <code>~/.emacs.d/elpa/</code> 目录下。
</p>

<p>
想要删除已安装的插件，输入命令 <code>package-delete</code> ，然后输入已安装的插件名即可。
</p>
</div>
</div>
<div id="outline-container-h:f8d3c1b8-c336-4fea-9664-766d3c206223" class="outline-4">
<h4 id="h:f8d3c1b8-c336-4fea-9664-766d3c206223">命令安装</h4>
<div class="outline-text-4" id="text-h:f8d3c1b8-c336-4fea-9664-766d3c206223">
<ul class="org-ul">
<li>刷新软件源 <code>M-x package-refresh-contents</code></li>
<li>查看软件 <code>M-x package-list-packages</code></li>
<li>按 <code>U</code> 可以看到有多个包要更新，按 <code>x</code> 执行更新</li>
<li>重新打开emacs，到包管理中按 <code>U</code> 提示没有包要更新了</li>
</ul>

<p>
在表单中可以使用 <code>I</code> 来标记安装 <code>D</code> 来标记删除， <code>U</code> 来更新，并用 <code>X</code> 来确认。
</p>

<p>
或者菜单栏 <code>Options &gt; Manage Emacs Packages</code>
</p>

<ul class="org-ul">
<li><code>i/u</code>  包位置输入，安装/取消包，前面标记I</li>
</ul>

<p width="80%">
<img src="./images/image-20210618162427569.png" alt="image-20210618162427569.png" width="80%">]]
</p>

<ul class="org-ul">
<li><code>d</code> 删除插件包，前面标记D。再按 <code>x</code> 提示是否要删除。</li>
<li><code>大U</code> 更新包。旧包标记为D，新包标记为I</li>
<li><code>C-s</code> 搜索插件包。如 <code>C-s company</code>  使用 <code>C-s C-s C-s</code> 向下匹配</li>
</ul>

<p>
使用 <code>M-x customize-group</code> 后选择对应的插件名称，可以进入可视化选项区对指定的插 件做自定义设置。当选择 Save for future session 后，刚刚做的设计就会被保存在你的 配置文件（ <code>init.el</code> ）中。关于各个插件的安装与使用方法通常都可以在其官方页面找 到（GitHub Pages 或者是项目仓库中的 README 文件）。我们强烈建议大家在安装这些插 件后阅读使用方法来更好的将它们使用到你的日常工作当中使效率最大化。
</p>

<p>
一些常用的操作，以下操作使用`M-x`调用
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">list-packages &#25110; package-list-packages  &#26597;&#30475;&#20840;&#37096;&#36719;&#20214;&#21253;&#21015;&#34920;
package-install                         &#23433;&#35013;&#36719;&#20214;&#21253;
package-delete                          &#21024;&#38500;&#36719;&#20214;&#21253;
package-autoremove                      &#26080;&#29992;&#36719;&#20214;&#21253;&#33258;&#21160;&#21024;&#38500;
package-refresh-contents                &#21047;&#26032;&#36719;&#20214;&#21253;&#20449;&#24687;&#32034;&#24341;
describe-package                        &#21253;&#20449;&#24687;
</pre>
</div>

<p>
<b><a href="http://company-mode.github.io/">Company</a> 补全插件</b>
</p>

<p>
使用默认的插件管理系统（可在菜单栏 `Options &gt; Manage Emacs Packages` 中找到）安 装 <a href="http://company-mode.github.io/">Company</a> 插件，他是一个用于代码补全的插件。它的名字代表补全一切的意思（ <b>Comp</b> lete <b>Any</b> thing）。因为默认的插件管理系统提供的插件十分有限，所以我们会在之后的 几天中继续将其强化。
</p>

<p>
点击安装
</p>

<p>
<img src="./images/image-20210618032138785.png" alt="image-20210618032138785.png">]]
</p>

<p>
使用的下面的配置将 Company-mode 在全局模式下激活
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">; </span><span style="color: #b22222;">&#24320;&#21551;&#20840;&#23616; Company &#34917;&#20840;</span>
(global-company-mode 1)
(<span style="color: #a020f0;">setq</span> company-idle-delay 0)                <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#34917;&#20840;&#26102;&#38388;&#24555;&#20123;</span>
(<span style="color: #a020f0;">setq</span> company-minimum-prefix-length 1)     <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26368;&#23569;&#36755;&#20837;1&#20010;&#23383;&#31526;&#24320;&#21551;   </span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:26317ee7-91b3-4780-b08a-43a67457acc2" class="outline-4">
<h4 id="h:26317ee7-91b3-4780-b08a-43a67457acc2">手工安装插件</h4>
<div class="outline-text-4" id="text-h:26317ee7-91b3-4780-b08a-43a67457acc2">
<p>
以 <a href="https://github.com/manateelazycat/awesome-tab">awesome-tab</a>  为例
</p>

<p>
创建目录，使用内容Dir包。 <code>C-x d</code> 回车， <code>+</code> 创建目录输入目录名site-lisp 回车， <code>q</code> 退出
</p>

<p>
使用 <code>M-x eshell</code> 克隆代码
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">cd</span> site-lisp
git clone --depth=1 https://github.com/manateelazycat/awesome-tab.git
</pre>
</div>

<p>
配置文件
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'load-path (expand-file-name <span style="color: #8b2252;">"~/.emacs.d/site-lisp/awesome-tab/"</span>))
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">awesome-tab</span>)
(awesome-tab-mode t)

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">awesome-tab-buffer-groups</span> ()
<span style="color: #8b2252;">"`</span><span style="color: #008b8b;">awesome-tab-buffer-groups</span><span style="color: #8b2252;">' control buffers' group rules.</span>
<span style="color: #8b2252;">Group awesome-tab with mode if buffer is derived from `</span><span style="color: #008b8b;">eshell-mode</span><span style="color: #8b2252;">' `</span><span style="color: #008b8b;">emacs-lisp-mode</span><span style="color: #8b2252;">' `</span><span style="color: #008b8b;">dired-mode</span><span style="color: #8b2252;">' `</span><span style="color: #008b8b;">org-mode</span><span style="color: #8b2252;">' `</span><span style="color: #008b8b;">magit-mode</span><span style="color: #8b2252;">'.</span>
<span style="color: #8b2252;">All buffer name start with * will group to \"Emacs\".</span>
<span style="color: #8b2252;">Other buffer group by `</span><span style="color: #008b8b;">awesome-tab-get-group-name</span><span style="color: #8b2252;">' with project name."</span>
(list
(<span style="color: #a020f0;">cond</span>
    ((<span style="color: #a020f0;">or</span> (string-equal <span style="color: #8b2252;">"*"</span> (substring (buffer-name) 0 1))
        (memq major-mode '(magit-process-mode
                            magit-status-mode
                            magit-diff-mode
                            magit-log-mode
                            magit-file-mode
                            magit-blob-mode
                            magit-blame-mode)))
    <span style="color: #8b2252;">"Emacs"</span>)
    ((derived-mode-p 'eshell-mode)
    <span style="color: #8b2252;">"EShell"</span>)
    ((derived-mode-p 'dired-mode)
    <span style="color: #8b2252;">"Dired"</span>)
    ((memq major-mode '(org-mode org-agenda-mode diary-mode))
    <span style="color: #8b2252;">"OrgMode"</span>)
    ((derived-mode-p 'eaf-mode)
    <span style="color: #8b2252;">"EAF"</span>)
    (t
    (awesome-tab-get-group-name (current-buffer))))))
</pre>
</div>

<p>
自动加载 site-lisp 中的包
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">cl-lib</span>)

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">sanityinc/add-subdirs-to-load-path</span> (parent-dir)
  <span style="color: #8b2252;">"Add every non-hidden subdir of PARENT-DIR to `</span><span style="color: #008b8b;">load-path</span><span style="color: #8b2252;">'."</span>
  (<span style="color: #a020f0;">let</span> ((default-directory parent-dir))
    (<span style="color: #a020f0;">setq</span> load-path
          (append
           (cl-remove-if-not
            #'file-directory-p
            (directory-files (expand-file-name parent-dir) t <span style="color: #8b2252;">"^[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\\.]"</span>))
           load-path))))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">Add both site-lisp and its immediate subdirs to `</span><span style="color: #008b8b;">load-path</span><span style="color: #b22222;">'</span>
(<span style="color: #a020f0;">let</span> ((site-lisp-dir (expand-file-name <span style="color: #8b2252;">"site-lisp/"</span> user-emacs-directory)))
  (<span style="color: #a020f0;">push</span> site-lisp-dir load-path)
  (sanityinc/add-subdirs-to-load-path site-lisp-dir))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:16ef6070-8dca-4ab3-b988-2c24bf47e232" class="outline-4">
<h4 id="h:16ef6070-8dca-4ab3-b988-2c24bf47e232">配置安装</h4>
<div class="outline-text-4" id="text-h:16ef6070-8dca-4ab3-b988-2c24bf47e232">
<p>
你可以直接将下面的代码复制到你的配置文件顶端，从而直接使用 Melpa 作为插件的源。 你可以将你需要的插件名字写在 `my/packages` 中，Emacs 在启动时会自动下载未被安装 的插件。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">package</span>)
(<span style="color: #a020f0;">setq</span> package-archives '(
                         (<span style="color: #8b2252;">"gnu"</span>   . <span style="color: #8b2252;">"http://elpa.zilongshanren.com/gnu/"</span>)
                         (<span style="color: #8b2252;">"nongnu"</span> . <span style="color: #8b2252;">"http://elpa.zilongshanren.com/nongnu/"</span>)
                         (<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"http://elpa.zilongshanren.com/melpa/"</span>)))
(package-initialize)

<span style="color: #b22222;">;;</span><span style="color: #b22222;">&#38450;&#27490;&#21453;&#22797;&#35843;&#29992; package-refresh-contents &#20250;&#24433;&#21709;&#21152;&#36733;&#36895;&#24230;</span>
(<span style="color: #a020f0;">when</span> (not package-archive-contents)
  (package-refresh-contents))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">(package-install 'use-package)</span>

(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">init-packages</span>)
</pre>
</div>

<p>
安装包使用 `package-install` 如安装 use-package
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(package-install 'use-package)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:b674aeac-6dc2-486b-8fe0-a6fcc4da339f" class="outline-4">
<h4 id="h:b674aeac-6dc2-486b-8fe0-a6fcc4da339f">加载其它文件</h4>
<div class="outline-text-4" id="text-h:b674aeac-6dc2-486b-8fe0-a6fcc4da339f">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">load other file &#22686;&#21152;&#20102;&#25991;&#20214;&#23384;&#22312;&#21028;&#26029;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">load-if-exists</span> (f)
  <span style="color: #8b2252;">"load the elisp file only if it exists and is readable"</span>
  (<span style="color: #a020f0;">if</span> (file-readable-p f)
      (load-file f)))

(load-if-exists <span style="color: #8b2252;">"~/Dropbox/shared/mu4econfig.el"</span>)
(load-if-exists <span style="color: #8b2252;">"~/Dropbox/shared/tmpstuff.el"</span>)
(load-if-exists <span style="color: #8b2252;">"~/Dropbox/shared/not-for-github.el"</span>)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:8bef14f2-1296-47b9-b98e-d2c6fde1339a" class="outline-3">
<h3 id="h:8bef14f2-1296-47b9-b98e-d2c6fde1339a">Macro</h3>
<div class="outline-text-3" id="text-h:8bef14f2-1296-47b9-b98e-d2c6fde1339a">
</div>
<div id="outline-container-h:fd17d13e-81c1-4ac0-b1b3-d1e1b8b95136" class="outline-4">
<h4 id="h:fd17d13e-81c1-4ac0-b1b3-d1e1b8b95136">什么是 Macro</h4>
<div class="outline-text-4" id="text-h:fd17d13e-81c1-4ac0-b1b3-d1e1b8b95136">
<p>
宏是一种可以生成代码的代码. 类比与 C 语言中的宏以及 C++中的模板. 先看一个简单的例子:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> my-var 1)
(<span style="color: #a020f0;">setq</span> my-var (+ 1 my-var)) <span style="color: #b22222;">; </span><span style="color: #b22222;">C-x C-e &#25191;&#34892;&#22810;&#27425;</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23450;&#20041;&#23439;&#21644;&#23450;&#20041;&#20989;&#25968;&#24046;&#19981;&#22810;&#65292;&#21482;&#26159;&#20851;&#38190;&#23383;&#19981;&#19968;&#26679;&#12290;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23450;&#20041;&#23439; &#21464;&#37327;var + 1</span>
(<span style="color: #a020f0;">defmacro</span> <span style="color: #0000ff;">inc</span> (var)
  (list 'setq var (list '1+ var)))

(macroexpand '(inc my-var)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">DSL &#23439;&#23637;&#24320;&#12290;&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#23637;&#24320;&#21518;&#21644;&#19978;&#38754;&#30340;&#19968;&#26679;&#12290;</span>


(inc my-var) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#23439;&#20250;&#20570;&#19968;&#20010;&#23439;&#23637;&#31034;&#12290;&#32467;&#26524;&#22312;&#21464;&#65292;&#24433;&#21709;&#22806;&#37096;</span>

<span style="color: #b22222;">;;; </span><span style="color: #b22222;">pass by value</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20989;&#25968;&#21482;&#26159;&#36827;&#34892;&#20256;&#20540;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">inc-2</span> (var)
  (<span style="color: #a020f0;">setq</span> var (1+ var)))

(inc-2 my-var) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#27704;&#36828;&#31561;&#20110;&#19968;&#20010;&#20540;&#65292;&#19981;&#24433;&#21709;&#22806;&#37096;</span>


<span style="color: #b22222;">;;; </span><span style="color: #b22222;">quote &#26159;'&#24341;&#21495;&#65292; backquote &#26159;`</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">backqote&#26377;&#22806;&#37096;&#30340;&#20316;&#29992;&#65292;&#22312;&#34920;&#31034;&#21069;&#21152;&#20010;,&#36887;&#21495;&#21487;&#21160;&#24577;&#27714;&#20540;; &#34920;&#36798;&#24335;&#21069;&#21152;,@&#21487;&#25286;&#25955;&#27714;&#20540;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Backquote allows you to:</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">quote a list, and</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">selectively evaluate elements of the list (with comma ,), or:</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">splice (eval &amp; spread) the element with ,@</span>

`(a list of ,(+ 2 3) elements) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#22312;&#34920;&#31034;&#21069;&#21152;&#20010;,&#36887;&#21495;&#21487;&#21160;&#24577;&#27714;&#20540;</span>

(<span style="color: #a020f0;">setq</span> some-list '(2 3)) <span style="color: #b22222;">;</span><span style="color: #b22222;">(a list of 5 elements)</span>

`(1 ,@some-list 4 ,@some-list) <span style="color: #b22222;">;</span><span style="color: #b22222;">backquote&#20013;&#34920;&#36798;&#24335;&#21069;&#26377;,@&#20250;&#25286;&#35299;&#20986;&#26469;&#12290;(1 2 3 4 2 3)</span>
</pre>
</div>

<ul class="org-ul">
<li>` backquto</li>
<li>' quote</li>
</ul>
<p>
它们都是 quete，不同点在于 backquote  与逗号 <code>,</code> 一起使用，后面动态求值； 与 <code>,@</code> 展示元素
</p>

<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">`(a list of ,(+ 2 3) elements) <span style="color: #b22222;">;</span><span style="color: #b22222;">C-x C-e (a list of 5 elements)</span>

'(a list of (+ 2 3) elements) <span style="color: #b22222;">;</span><span style="color: #b22222;">C-x C-e (a list of (+ 2 3) elements)</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#19982; `,@` &#19968;&#36215;&#20351;&#29992;&#26102;&#20026;&#23637;&#31034;&#20803;</span>
(<span style="color: #a020f0;">setq</span> some-list '(2 3))
`(1 ,@some-list 4 ,@some-list) <span style="color: #b22222;">; </span><span style="color: #b22222;">C-x C-e (1 2 3 4 2 3)</span>
</pre>
</div>

<p>
backquote <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Backquote.html">https://www.gnu.org/software/emacs/manual/html_node/elisp/Backquote.html</a>
</p>

<p>
关于 backquote 的更多讨论, 可以见以下地址: <a href="https://emacs-china.org/t/lisp/357">lisp 中的`与，是怎么用的？</a>
</p>
</div>
</div>
<div id="outline-container-h:aea2b10a-1141-454e-b561-78de3f7d4112" class="outline-4">
<h4 id="h:aea2b10a-1141-454e-b561-78de3f7d4112">为什么使用宏</h4>
<div class="outline-text-4" id="text-h:aea2b10a-1141-454e-b561-78de3f7d4112">
<p>
使用宏可以减少重复的代码, 以下是一个使用宏来定义函数的例子:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">prelude-search</span> (query-url prompt)
  <span style="color: #8b2252;">"Open the search url constructed with the QUERY-URL.</span>
<span style="color: #8b2252;">PROMPT sets the `read-string prompt."</span>
  (browse-url
   (concat query-url
     (url-hexify-string
      (<span style="color: #a020f0;">if</span> mark-active
    (buffer-substring (region-beginning) (region-end))
        (read-string prompt))))))

(<span style="color: #a020f0;">defmacro</span> <span style="color: #0000ff;">prelude-install-search-engine</span> (search-engine-name search-engine-url search-engine-prompt)                   <span style="color: #b22222;">; </span><span style="color: #b22222;">#1</span>
  <span style="color: #8b2252;">"Given some information regarding a search engine, install the interactive command to search through them"</span>    
  `(<span style="color: #a020f0;">defun</span> ,(intern (format <span style="color: #8b2252;">"prelude-%s"</span> search-engine-name)) ()                                                       <span style="color: #b22222;">; </span><span style="color: #b22222;">#2</span>
       ,(format <span style="color: #8b2252;">"Search %s with a query or region if any."</span> search-engine-name)                                        <span style="color: #b22222;">; </span><span style="color: #b22222;">#3</span>
       (<span style="color: #a020f0;">interactive</span>)
       (prelude-search ,search-engine-url ,search-engine-prompt)))                                                    <span style="color: #b22222;">; </span><span style="color: #b22222;">#4</span>

(prelude-install-search-engine <span style="color: #8b2252;">"google"</span>     <span style="color: #8b2252;">"http://www.google.com/search?q="</span>              <span style="color: #8b2252;">"Google: "</span>)                <span style="color: #b22222;">; </span><span style="color: #b22222;">#5</span>
(prelude-install-search-engine <span style="color: #8b2252;">"youtube"</span>    <span style="color: #8b2252;">"http://www.youtube.com/results?search_query="</span> <span style="color: #8b2252;">"Search YouTube: "</span>)
(prelude-install-search-engine <span style="color: #8b2252;">"github"</span>     <span style="color: #8b2252;">"https://github.com/search?q="</span>                 <span style="color: #8b2252;">"Search GitHub: "</span>)
(prelude-install-search-engine <span style="color: #8b2252;">"duckduckgo"</span> <span style="color: #8b2252;">"https://duckduckgo.com/?t=lm&amp;q="</span>              <span style="color: #8b2252;">"Search DuckDuckGo: "</span>)
</pre>
</div>

<p>
下面对以上代码进行讲解:
</p>

<p>
第#1 行, 通过 <b>prelude-install-search-engine</b> 定义了一个需要 3 个参数的宏, 这个 宏的作用是生成一个函数.
</p>

<p>
第#2 行, 通过 <b>intern</b> 生成一个符号作为函数名, 名称为　<b>prelude-xxx</b> , 其中 xxx 为第一个参数的值.
</p>

<p>
第#3 行, 生成了这个函数的描述.
</p>

<p>
第#4 行, 调用 <b>prelude-search</b> 函数进行搜索处理.
</p>

<p>
第#5 行, 调用这个宏定义了一个名为　<b>prelude-google</b> 的函数.
</p>

<p>
从以上代码可以知道, 我们利用宏生成了４个名称不同的函数, 避免了手动编写函数的问题 (因为这４个函数的代码非常相似, 根据 DRY 原则应该尽量避免做这种重复工作).
</p>

<p>
关于宏的更多内容, 可以阅读 <b><b>Paul Graham</b></b> 的著作<a href="http://www.paulgraham.com/onlisp.html">《On Lisp》</a>
</p>

<div class="org-src-container">
<pre class="src src-shell">prelude-duckduckgo
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:a9256bed-c776-47db-a733-3e9adfd7de07" class="outline-3">
<h3 id="h:a9256bed-c776-47db-a733-3e9adfd7de07">插件设置 (use-package)</h3>
<div class="outline-text-3" id="text-h:a9256bed-c776-47db-a733-3e9adfd7de07">
<ul class="org-ul">
<li>Use-package <a href="https://github.com/jwiegley/use-package">https://github.com/jwiegley/use-package</a></li>
</ul>

<p>
Use-package 是一个宏, 它能让你将一个包的 <b>require</b> 和它的相关的初始化、 按键绑定、配置等用宏组织在一起, 避免对同一个包的配置代码散落在不同的文件中.
</p>

<p>
在29版本后内置，可直接使用。
</p>

<p>
在 init.el 较靠前的位置（或其它你认为合适的文件中）写上：
</p>

<p>
简易的配置
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">package</span>)
(<span style="color: #a020f0;">setq</span> package-enable-at-startup nil)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'package-archives '("melpa" . "https://melpa.org/packages/"))</span>

(<span style="color: #a020f0;">setq</span> package-archives '((<span style="color: #8b2252;">"gnu"</span>   . <span style="color: #8b2252;">"https://elpa.gnu.org/packages/"</span>)
                         (<span style="color: #8b2252;">"nongnu"</span> . <span style="color: #8b2252;">"https://elpa.nongnu.org/nongnu/"</span>)
                         (<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"https://melpa.org/packages/"</span>)))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq package-archives '(("gnu"   . "http://elpa.zilongshanren.com/gnu/")</span>
<span style="color: #b22222;">;;                         </span><span style="color: #b22222;">("nongnu" . "http://elpa.zilongshanren.com/nongnu/")</span>
<span style="color: #b22222;">;;                         </span><span style="color: #b22222;">("melpa" . "http://elpa.zilongshanren.com/melpa/")))</span>
<span style="color: #b22222;">;;</span>
(package-initialize) <span style="color: #b22222;">;;</span>

(<span style="color: #a020f0;">unless</span> (package-installed-p 'use-package)
  (package-refresh-contents)
  (package-install 'use-package))
</pre>
</div>


<p>
更友好的配置
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">add melpa to package-archives</span>
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">package</span>)
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">cl-lib</span>)

(<span style="color: #a020f0;">setq</span> package-check-signature nil 
      load-prefer-newer t) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20010;&#21035;&#26102;&#20505;&#20250;&#20986;&#29616;&#31614;&#21517;&#26657;&#39564;&#22833;&#36133;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'package-archives '("melpa" . "https://melpa.org/packages/"))</span>

(<span style="color: #a020f0;">setq</span> package-archives '((<span style="color: #8b2252;">"gnu"</span>   . <span style="color: #8b2252;">"https://elpa.gnu.org/packages/"</span>)
                         (<span style="color: #8b2252;">"nongnu"</span> . <span style="color: #8b2252;">"https://elpa.nongnu.org/nongnu/"</span>)
                         (<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"https://melpa.org/packages/"</span>)))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq package-archives '(("gnu"   . "http://elpa.zilongshanren.com/gnu/")</span>
<span style="color: #b22222;">;;                         </span><span style="color: #b22222;">("nongnu" . "http://elpa.zilongshanren.com/nongnu/")</span>
<span style="color: #b22222;">;;                         </span><span style="color: #b22222;">("melpa" . "http://elpa.zilongshanren.com/melpa/")))</span>
<span style="color: #b22222;">;;</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">don't bother with the initialize, although it may cause much startup time,</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">there's no way to avoid this if you use package.el instead of other package</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">manager, like straight.el</span>
(<span style="color: #a020f0;">unless</span> (<span style="color: #a020f0;">bound-and-true-p</span> package--initialized)
  (package-initialize)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21047;&#26032;&#36719;&#20214;&#28304;&#32034;&#24341;</span>

<span style="color: #b22222;">;;</span><span style="color: #b22222;">&#38450;&#27490;&#21453;&#22797;&#35843;&#29992; package-refresh-contents &#20250;&#24433;&#21709;&#21152;&#36733;&#36895;&#24230;</span>
(<span style="color: #a020f0;">when</span> (not package-archive-contents)
  (package-refresh-contents))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">these code run only once, when use-package is not installed</span>
(<span style="color: #a020f0;">unless</span> (package-installed-p 'use-package)
  (package-refresh-contents)
  (package-install 'use-package))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">make use-package default behavior better</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">with `</span><span style="color: #008b8b;">use-package-always-ensure</span><span style="color: #b22222;">' you won't need ":ensure t" all the time</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">with `</span><span style="color: #008b8b;">use-package-always-defer</span><span style="color: #b22222;">' you won't need ":defer t" all the time</span>
(<span style="color: #a020f0;">setq</span> use-package-always-ensure nil
      use-package-always-defer t
      use-package-enable-imenu-support t
      use-package-expand-minimally t)
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">use-package</span>)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">diminish &amp; delight, as use-package optional dependency</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(use-package diminish)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(use-package delight)</span>
</pre>
</div>


<p>
<b>基本格式</b>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26368;&#31616;&#27905;&#30340;&#26684;&#24335;</span>
(<span style="color: #a020f0;">use-package</span> restart-emacs)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24120;&#29992;&#30340;&#26684;&#24335;</span>
(<span style="color: #a020f0;">use-package</span> smooth-scrolling
             <span style="color: #483d8b;">:ensure</span> t                              <span style="color: #b22222;">; </span><span style="color: #b22222;">&#30830;&#35748;&#23433;&#35013;&#65292;nil&#34920;&#31034;&#19981;&#38656;&#35201;&#23433;&#35013;&#12290;nil &#21487;&#37197;&#32622;&#20869;&#32622;&#21253;&#12290;</span>
             <span style="color: #483d8b;">:pin</span> melpa                             <span style="color: #b22222;">; </span><span style="color: #b22222;">&#25351;&#21521;&#25554;&#20214;&#28304;</span>
             <span style="color: #483d8b;">:defer</span> nil                             <span style="color: #b22222;">; </span><span style="color: #b22222;">&#26159;&#21542;&#35201;&#24310;&#36831;&#21152;&#36733;</span>
             <span style="color: #483d8b;">:diminish</span> (flymake <span style="color: #8b2252;">" Flym."</span>)           <span style="color: #b22222;">; </span><span style="color: #b22222;">&#29366;&#24577;&#26639;&#26174;&#31034;&#30340;&#26679;&#24335;</span>
             <span style="color: #483d8b;">:after</span> yasnippet                       <span style="color: #b22222;">; </span><span style="color: #b22222;">&#21035;&#30340;&#21253;&#23433;&#35013;&#21518;&#21551;&#21160;</span>
             <span style="color: #483d8b;">:init</span>                                  <span style="color: #b22222;">; </span><span style="color: #b22222;">&#22312;&#21152;&#36733;&#25554;&#20214;&#21069;&#25191;&#34892;&#19968;&#20123;&#21629;&#20196;</span>
             (<span style="color: #a020f0;">setq</span> smooth-scrolling-margin 2)
             <span style="color: #483d8b;">:custom</span>
             (ivy-use-virtual-buffers t)
             <span style="color: #483d8b;">:config</span>                                <span style="color: #b22222;">; </span><span style="color: #b22222;">&#22312;&#21152;&#36733;&#25554;&#20214;&#21518;&#25191;&#34892;&#19968;&#20123;&#21629;&#20196;</span>
             (smooth-scrolling-mode t)
             <span style="color: #483d8b;">:commands</span> (isearch-moccur isearch-all)    
             <span style="color: #483d8b;">:bind</span>                                  <span style="color: #b22222;">; </span><span style="color: #b22222;">&#24555;&#25463;&#38190;&#30340;&#32465;&#23450;</span>
             ((<span style="color: #8b2252;">"M-n"</span> . xx) (<span style="color: #8b2252;">"M-p"</span> . xx2))
             <span style="color: #483d8b;">:bind*</span>                              <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20250;&#22312;&#21253;&#21152;&#36733;&#20043;&#21069;&#23601;&#24314;&#31435;&#38190;&#32465;&#23450;</span>
             (<span style="color: #8b2252;">"M-RET"</span> . hkey-either)
             <span style="color: #483d8b;">:hook</span>                                 <span style="color: #b22222;">; </span><span style="color: #b22222;">hook&#27169;&#24335;&#30340;&#32465;&#23450;</span>
             (prog-mode . flycheck-mode))
</pre>
</div>

<p>
所有的冒号开头的词是 use-package 的一些设置关键词。
</p>

<p>
建议添加的配置（部分来自 use-package 官方建议）：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">use-package &#40664;&#35748;&#37197;&#32622;</span>
(<span style="color: #a020f0;">eval-and-compile</span>
  (<span style="color: #a020f0;">setq</span> use-package-always-ensure t) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#19981;&#29992;&#27599;&#20010;&#21253;&#37117;&#25163;&#21160;&#28155;&#21152;:ensure t&#20851;&#38190;&#23383;</span>
  (<span style="color: #a020f0;">setq</span> use-package-always-defer t) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#40664;&#35748;&#37117;&#26159;&#24310;&#36831;&#21152;&#36733;&#65292;&#19981;&#29992;&#27599;&#20010;&#21253;&#37117;&#25163;&#21160;&#28155;&#21152;:defer t</span>
  (<span style="color: #a020f0;">setq</span> use-package-always-demand nil)
  (<span style="color: #a020f0;">setq</span> use-package-expand-minimally t)
  (<span style="color: #a020f0;">setq</span> use-package-verbose t))
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">use-package</span>)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">yes or no &#31616;&#21270;&#20026;y n</span>
(<span style="color: #a020f0;">use-package</span> emacs <span style="color: #483d8b;">:config</span> (<span style="color: #a020f0;">defalias</span> '<span style="color: #0000ff;">yes-or-no-p</span> 'y-or-n-p))
</pre>
</div>

<p>
<b>特点</b> ：
</p>
<ul class="org-ul">
<li><p>
更安全的 require
</p>

<p>
在 Emacs 中, 当我们要引入一个包时, 通常会使用以下代码 <code>(require 'package-name)</code> 。但是当 package-name 不在 load-path 中时, 以上代码会抛出错误. 使用 Use-package 可以避免 <code>(use-package package-name)</code> 。
</p>

<p>
以上代码 <code>macroexpand</code> 展开的结果如下:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(pp (macroexpand '(use-package init-xxx))) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23637;&#31034;&#21518;&#36755;&#20986;&#26684;&#24335;&#21270;. &#21487;&#20197;&#30475;&#21040;&#26377;&#20570;&#38169;&#35823;&#22788;&#29702;&#12290;</span>
</pre>
</div>

<p>
<code>*Message*</code> 可以看到类似格式化的展开结果
</p>
<div class="org-src-container">
<pre class="src src-text">(use-package-ensure-elpa 'init-xxx
                             '(t)
                             'nil)
"(use-package-ensure-elpa 'init-xxx
                             '(t)
                             'nil)
"
</pre>
</div></li>

<li><p>
将配置集中
</p>

<p>
通过 <code>init</code> 和 <code>config</code> 把配置关联进来
</p>

<p>
init 后的代码在包的 require 之前执行, 如果这段代码出错则跳过包的 require。config 后的代码在包的 require 之后执行
</p>

<p>
init 与 config 之后只能接单个表达式语句, 如果需要执行多个语句, 可以用 progn 。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> package-name
             <span style="color: #483d8b;">:init</span>
             (<span style="color: #a020f0;">setq</span> my-var1 <span style="color: #8b2252;">"xxx"</span>)
             <span style="color: #483d8b;">:config</span>
             (<span style="color: #a020f0;">progn</span>
               (<span style="color: #a020f0;">setq</span> my-var2 <span style="color: #8b2252;">"xxx"</span>)
               (<span style="color: #a020f0;">setq</span> my-var3 <span style="color: #8b2252;">"xxx"</span>)
               )
             )
</pre>
</div></li>

<li><p>
autoload
</p>

<p>
使用 autoload 则可以在真正需要这个包时再 require, 提高启动速度, 避免无谓的 require。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> package-name
             <span style="color: #483d8b;">:commands</span>
             (global-company-mode)
             <span style="color: #483d8b;">:defer</span> t
             )
</pre>
</div>

<p>
使用 commands 可以让 package 延迟加载, 如以上代码会首先判断 package 的符号是否 存在, 如果存在则在 package-name 的路径下加载. defer 也可以让 package-name 进行延迟加载.
</p></li>

<li><p>
键绑定
</p>

<p>
在之前的代码中, 如果我们需要绑定一个键, 需要使用 global-key-bind 或 define-key 实现, 而使用 <b>Use-package</b> 实现更简单:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> company
             <span style="color: #483d8b;">:ensure</span> t
             <span style="color: #483d8b;">:init</span>
             (global-company-mode t)                    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20840;&#23616;&#24320;&#21551; company &#34917;&#20840;</span>
             <span style="color: #483d8b;">:config</span>
             (<span style="color: #a020f0;">setq</span> company-idle-delay 0)                <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#34917;&#20840;&#26102;&#38388;&#24555;&#20123;</span>
             (<span style="color: #a020f0;">setq</span> company-minimum-prefix-length 1)     <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26368;&#23569;&#36755;&#20837;1&#20010;&#23383;&#31526;&#24320;&#21551;              </span>
             <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> company-active-map
                         (<span style="color: #8b2252;">"C-n"</span> . 'company-select-next)
                         (<span style="color: #8b2252;">"C-p"</span> . 'company-select-previous)))  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20351;&#29992; `C-n` &#19982; `C-p` &#26469;&#36873;&#25321;&#34917;&#20840;&#39033;&#65292;&#40664;&#35748;&#36873;&#25321;&#19978;&#19968;&#26465;&#21644;&#19979;&#19968;&#26465;&#20505;&#36873;&#39033;&#21629;&#20196; M-n M-p</span>
</pre>
</div></li>
</ul>
</div>
<div id="outline-container-h:e7e771a2-0f8b-44b6-a1dd-e583bb276916" class="outline-4">
<h4 id="h:e7e771a2-0f8b-44b6-a1dd-e583bb276916">配置quelpa</h4>
<div class="outline-text-4" id="text-h:e7e771a2-0f8b-44b6-a1dd-e583bb276916">
<p>
<a href="https://github.com/quelpa/quelpa">quelpa</a> 是配合 package.el 使用的，基于git的一个包管理器。我们在后面会发现，有不少优秀的插件，并没有提交到上面我们设置的仓库源（比如懒猫大大的很多插件），而是在 Github 上或者其他基于 Git 的仓库里，那我们就可以通过 quelpa 来安装这些插件，并且可以与 use-package 结合使用
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23433;&#35013; `</span><span style="color: #008b8b;">quelpa</span><span style="color: #b22222;">'</span>
(<span style="color: #a020f0;">use-package</span> quelpa
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:commands</span> quelpa
  <span style="color: #483d8b;">:config</span>
  <span style="color: #483d8b;">:custom</span>
  (quelpa-git-clone-depth 1)
  (quelpa-update-melpa-p nil)
  (quelpa-self-upgrade-p nil)
  (quelpa-checkout-melpa-p nil))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">`</span><span style="color: #008b8b;">quelpa</span><span style="color: #b22222;">' &#19982; `</span><span style="color: #008b8b;">use-package</span><span style="color: #b22222;">' &#38598;&#25104;</span>
(<span style="color: #a020f0;">use-package</span> quelpa-use-package
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:073e09f4-4662-43c8-98f1-e18f71f9196b" class="outline-3">
<h3 id="h:073e09f4-4662-43c8-98f1-e18f71f9196b">配置变量</h3>
<div class="outline-text-3" id="text-h:073e09f4-4662-43c8-98f1-e18f71f9196b">
<p>
除了使用配置文件，Emacs 还提供了一个更为方便的办法管理一些变量（customizable variables），或称用户选项（user options）
</p>
<p width="80%">
<img src="./images/Snipaste_2022-06-03_20-06-42.png" alt="Snipaste_2022-06-03_20-06-42.png" width="80%">]]
</p>

<p>
最简单的进入办法，就是按下 M-x 输入 customize 后回车确认。
</p>

<p>
变量是分组（group）管理的，只需要点进去寻找或搜索相关的变量就可以进行设置。对于每一个变量，点左侧的箭头展开内容，可以看到有的变量是 Toggle 按钮表示可以设定 true/false，有的则是取值列表，可以设定值。修改后，State 会显示已编辑。最后点击上方的 Apply 就是应用更改。点击 Revert 就可以放弃更改等。按 `q` 退出。
</p>
<p width="80%">
<img src="./images/Snipaste_2022-06-03_20-29-01.png" alt="Snipaste_2022-06-03_20-29-01.png" width="80%">]]
</p>

<p>
使用 M-x customize-group 后选择对应的插件名称，可以进入可视化选项区对指定的插 件做自定义设置。当选择 Save for future session 后，刚刚做的设计就会被保存在你的 配置文件（ init.el，或是自定义的文件 ）中。关于各个插件的安装与使用方法通常都可以在其官方页面找 到（GitHub Pages 或者是项目仓库中的 README 文件）。我们强烈建议大家在安装这些插 件后阅读使用方法来更好的将它们使用到你的日常工作当中使效率最大化。
</p>

<p>
此外，使用 Emacs 的过程中也可以临时修改某个变量的值，`M-x set-variable` 就可以输入变量名、回车、输入值、回车。还可以用 `C-h v` 输入变量名来查看变量的含义。
</p>

<p>
因此总结来说，想要设定变量有 几种途径：
</p>
<ul class="org-ul">
<li>配置文件中使用 `(setq name value)`</li>
<li>customize 中设定</li>
<li>运行过程中临时修改 `M-x set-variable`</li>
<li>单文件局部变量。如文件顶部添加 `# -<b>- org-image-actual-width: nil; -</b>-` 可修改 org mode 下图片显示大小</li>
</ul>
</div>
</div>
</section>
<section id="outline-container-h:e3d2a3c1-2875-4ffc-a7c5-4245d0d70f78" class="outline-2">
<h2 id="h:e3d2a3c1-2875-4ffc-a7c5-4245d0d70f78">一些配置</h2>
<div class="outline-text-2" id="text-h:e3d2a3c1-2875-4ffc-a7c5-4245d0d70f78">
</div>
<div id="outline-container-h:4829bcd1-ea8f-4a96-a6f0-5bf2396a19e6" class="outline-3">
<h3 id="h:4829bcd1-ea8f-4a96-a6f0-5bf2396a19e6">操作系统判断</h3>
<div class="outline-text-3" id="text-h:4829bcd1-ea8f-4a96-a6f0-5bf2396a19e6">
<p>
后面的部分配置会因操作系统不同而产生不同配置代码，所以有必要对操作系统进行判断。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25805;&#20316;&#31995;&#32479;&#21028;&#26029;&#65292;&#20998;&#21035;&#35774;&#32622;&#25104;&#24120;&#37327;</span>
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">*is-mac*</span> (eq system-type 'darwin) <span style="color: #8b2252;">"&#21028;&#26029;&#25805;&#20316;&#31995;&#32479;&#26159;&#21542;&#26159;MacOS"</span>)
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">*is-linux*</span> (eq system-type 'gnu/linux))
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">*is-windows*</span> (<span style="color: #a020f0;">or</span> (eq system-type 'ms-dos) (eq system-type 'windows-nt)))
</pre>
</div>

<p>
其中Windows的判断还可以放的宽一点：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">*is-windows*</span> (memq system-type '(ms-dos windows-nt cygwin)))
</pre>
</div>

<p>
测试
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(print *is-mac*)
</pre>
</div>

<p>
范例-修改不同操作系统键位映射
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> *is-mac*
  <span style="color: #b22222;">;;  </span><span style="color: #b22222;">Opt -&gt; meta : M, Cmd -&gt; super : s &#40664;&#35748;&#26159;&#36825;&#20010;</span>
  (<span style="color: #a020f0;">setq</span> mac-option-modifier 'meta
      mac-command-modifier 'super))

(<span style="color: #a020f0;">when</span> *is-windows*
  (<span style="color: #a020f0;">setq</span> w32-apps-modifier 'super))       <span style="color: #b22222;">; </span><span style="color: #b22222;">&#36890;&#36807;SharpKeys&#25913;&#25104;&#20102; Application</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:c0b06a33-5458-4996-8d0e-f6dbd644f4d8" class="outline-3">
<h3 id="h:c0b06a33-5458-4996-8d0e-f6dbd644f4d8">最开始的配置</h3>
<div class="outline-text-3" id="text-h:c0b06a33-5458-4996-8d0e-f6dbd644f4d8">
</div>
<div id="outline-container-h:b0835fa4-9bf4-4120-b55b-1a897dc42636" class="outline-4">
<h4 id="h:b0835fa4-9bf4-4120-b55b-1a897dc42636">basic 内置功能增强</h4>
<div class="outline-text-4" id="text-h:b0835fa4-9bf4-4120-b55b-1a897dc42636">
<p>
设置系统的编码，避免各处的乱码。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(prefer-coding-system 'utf-8)
(<span style="color: #a020f0;">unless</span> *is-windows*
    (set-selection-coding-system 'utf-8))
</pre>
</div>

<p>
在此做简要归纳：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">ui &#30028;&#38754;</span>
(global-linum-mode 1)                        <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#34892;&#21495;, (1,2,3,t) &#37117;&#20195;&#34920;&#24320;&#21551;&#65292;-1 &#20851;&#38381;</span>
(global-display-line-numbers-mode 1)         <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22312; Window &#26174;&#31034;&#34892;&#21495;</span>

(<span style="color: #a020f0;">setq</span> inhibit-startup-screen t)              <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23581;&#35797;&#20851;&#25481;&#21551;&#21160;&#30028;&#38754;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq inhibit-startup-message t)          ;; &#20026;inhibit-startup-screen&#30340;&#21035;&#21517;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq inhibit-splash-screen 1)            ;; &#20851;&#38381;&#21551;&#21160;&#24110;&#21161;&#30011;&#38754;</span>
(tool-bar-mode -1)                           <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20851;&#38381;&#24037;&#20855;&#26639;&#65292;tool-bar-mode &#21363;&#20026;&#19968;&#20010; Minor Mode</span>
(scroll-bar-mode -1)                         <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20851;&#38381;&#25991;&#20214;&#28369;&#21160;&#25511;&#20214;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(menu-bar-mode -1)                        ;; &#20851;&#38381;&#33756;&#21333;&#26639; (&#19981;&#20851;&#38381;&#65292;&#20351;&#29992;&#25554;&#20214;&#26102;&#20250;&#29992;&#21040;)</span>
(toggle-frame-maximized)                     <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20840;&#23631;&#32534;&#36753;&#22120;</span>
(<span style="color: #a020f0;">setq-default</span> cursor-type 'bar)              <span style="color: #b22222;">; </span><span style="color: #b22222;">&#26356;&#25913;&#20809;&#26631;&#30340;&#26679;&#24335;&#65292;&#40664;&#35748;&#27604;&#36739;&#31895;. &#26356;&#22810;C-h v &#26597;&#35810;&#24110;&#21161;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq cursor-type 'bar)                    ;; &#26356;&#25913;&#20809;&#26631;&#30340;&#26679;&#24335;&#12290;setq&#24403;&#21069;buffer&#29983;&#25928;&#65292;&#19981;&#33021;&#20840;&#23616;&#29983;&#25928;</span>
(global-hl-line-mode t)                      <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#39640;&#20142;&#24403;&#21069;&#34892;</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20869;&#32622;&#34917;&#20840;&#21151;&#33021;n</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq tab-always-indent 'complete)           ;; &#20351;&#29992; TAB &#26469;&#21015;&#20986;&#24403;&#21069;&#34917;&#20840;&#36873;&#39033;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(icomplete-mode t)                         ;; &#24320;&#21551;&#30340;&#65292;&#22312;&#25353; M-x &#26102;&#23601;&#26377;&#21487;&#36873;&#30340;&#36873;&#39033;&#20102;&#12290;&#20351;&#29992; vertico-mode&#65292;&#20851;&#38381;&#27492;&#39033;</span>
(electric-pair-mode t)                       <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25324;&#21495;&#34917;&#20840;</span>

(add-hook 'prog-mode-hook #'show-paren-mode) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32534;&#31243;&#27169;&#24335;&#19979;&#65292;&#20809;&#26631;&#22312;&#25324;&#21495;&#19978;&#26102;&#39640;&#20142;&#21478;&#19968;&#20010;&#25324;&#21495;</span>
(column-number-mode t)                       <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22312; Mode line &#19978;&#26174;&#31034;&#21015;&#21495;&#65292;&#26469;&#33258; simple &#20869;&#32622;&#21253;</span>
(global-auto-revert-mode t)                  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#33258;&#21160;&#21152;&#36733;&#22806;&#37096;&#20462;&#25913;&#36807;&#30340;&#25991;&#20214;</span>
(delete-selection-mode t)                    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36873;&#20013;&#25991;&#26412;&#21518;&#36755;&#20837;&#25991;&#26412;&#20250;&#26367;&#25442;&#25991;&#26412;&#65288;&#26356;&#31526;&#21512;&#25105;&#20204;&#20064;&#24815;&#20102;&#30340;&#20854;&#23427;&#32534;&#36753;&#22120;&#30340;&#36923;&#36753;&#12290;&#40664;&#35748;&#36873;&#20013;&#25918;&#21518;&#38754;</span>
(<span style="color: #a020f0;">setq</span> make-backup-files nil)                 <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20851;&#38381;&#25991;&#20214;&#33258;&#21160;&#22791;&#20221;&#12290;&#22914;&#26524;&#26159;&#26377;git&#26469;&#31649;&#29702;&#25991;&#20214;&#65292;&#22791;&#20221;&#25991;&#20214;&#27809;&#26377;&#22826;&#22823;&#24847;&#20041;&#12290;~ &#20026;&#21518;&#32512;&#30340;&#25991;&#20214;&#20026;&#33258;&#21160;&#29983;&#25104;&#30340;&#22791;&#20221;&#25991;&#20214;</span>
(<span style="color: #a020f0;">setq</span> ring-bell-function 'ignore)            <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20851;&#38381; Emacs &#20013;&#30340;&#38169;&#35823;&#25552;&#37266;&#35686;&#21578;&#38899;</span>
(fset 'yes-or-no-p 'y-or-n-p)                <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26576;&#20010;&#21629;&#20196;&#26102;&#38656;&#35201;&#36755;&#20837; (yes or no) &#27604;&#36739;&#40635;&#28902;&#65292;&#23558;&#20854;&#31616;&#21270;&#20026;&#21482;&#36755;&#20837; (y or n)</span>
(add-hook 'prog-mode-hook #'hs-minor-mode)   <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32534;&#31243;&#27169;&#24335;&#19979;&#65292;&#21487;&#20197;&#25240;&#21472;&#20195;&#30721;&#22359;</span>
(savehist-mode 1)                            <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#65288;&#21487;&#36873;&#65289;&#25171;&#24320; Buffer &#21382;&#21490;&#35760;&#24405;&#20445;&#23384;</span>
(<span style="color: #a020f0;">setq</span> display-line-numbers-type 'relative)   <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#65288;&#21487;&#36873;&#65289;&#26174;&#31034;&#30456;&#23545;&#34892;&#21495;</span>
(add-to-list 'default-frame-alist '(width . 90))  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#65288;&#21487;&#36873;&#65289;&#35774;&#23450;&#21551;&#21160;&#22270;&#24418;&#30028;&#38754;&#26102;&#30340;&#21021;&#22987; Frame &#23485;&#24230;&#65288;&#23383;&#31526;&#25968;&#65289;</span>
(add-to-list 'default-frame-alist '(height . 55)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#65288;&#21487;&#36873;&#65289;&#35774;&#23450;&#21551;&#21160;&#22270;&#24418;&#30028;&#38754;&#26102;&#30340;&#21021;&#22987; Frame &#39640;&#24230;&#65288;&#23383;&#31526;&#25968;&#65289;</span>
</pre>
</div>

<p>
`M-x eval-buffer` 来执行当前所有配置
</p>

<p>
<b>更好的默认配置</b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">--- better-defaults --</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32531;&#23384;&#21047;&#26032;</span>
(global-set-key (kbd <span style="color: #8b2252;">"&lt;f5&gt;"</span>) 'revert-buffer)
(global-auto-revert-mode 1)    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24403;&#35775;&#38382;&#30340;&#25991;&#20214;&#22312;&#30913;&#30424;&#19978;&#21457;&#29983;&#26356;&#25913;&#26102;&#65292;&#36825;&#20250;&#33258;&#21160;&#24674;&#22797;&#32531;&#20914;&#21306;</span>
(<span style="color: #a020f0;">setq</span> auto-rever-verbose nil)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20851;&#38381;&#33258;&#21160;&#24674;&#22797;&#20449;&#24687;</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#31995;&#32479;&#30340;&#32534;&#30721;&#65292;&#36991;&#20813;&#21508;&#22788;&#30340;&#20081;&#30721;</span>
(prefer-coding-system 'utf-8)
(set-default-coding-systems 'utf-8)
(set-terminal-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
(<span style="color: #a020f0;">setq</span> default-buffer-file-coding-system 'utf-8)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20851;&#38381;&#25552;&#31034;&#22768;&#38899;</span>
(<span style="color: #a020f0;">setq</span> ring-bell-function 'ignore)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20851;&#38381;&#32553;&#36827;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(electric-indent-mode -1)</span>

<span style="color: #b22222;">;;</span><span style="color: #b22222;">&#20851;&#38381;&#22791;&#20221;&#25991;&#20214;&#21151;&#33021;&#12290;&#22914;&#26524;&#26159;&#26377;git&#26469;&#31649;&#29702;&#25991;&#20214;&#65292;&#22791;&#20221;&#25991;&#20214;&#27809;&#26377;&#22826;&#22823;&#24847;&#20041;&#12290;~ &#20026;&#21518; &#32512;&#30340;&#25991;&#20214;&#20026;&#33258;&#21160;&#29983;&#25104;&#30340;&#22791;&#20221;&#25991;&#20214; </span>
(<span style="color: #a020f0;">setq</span> make-backup-files nil)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#31105;&#27490;&#33258;&#21160;&#24674;&#22797;</span>
(<span style="color: #a020f0;">setq</span> auto-save-default nil)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25324;&#21495;&#21305;&#37197;</span>
(add-hook 'emacs-lisp-mode-hook 'show-paren-mode)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21035;&#21517;</span>
(<span style="color: #a020f0;">setq-default</span> abbrev-mode t)
(define-abbrev-table 'global-abbrev-table '(
                        <span style="color: #b22222;">;; </span><span style="color: #b22222;">signature</span>
                        (<span style="color: #8b2252;">"8jv"</span> <span style="color: #8b2252;">"jaspervincent"</span>)
                        <span style="color: #b22222;">;; </span><span style="color: #b22222;">Microsoft</span>
                        (<span style="color: #8b2252;">"8ms"</span> <span style="color: #8b2252;">"Microsoft"</span>)
                        ))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36755;&#20837;8jv&#31354;&#26684;&#65292;&#23601;&#34917;&#20840;&#20986;jaspervincent  &#31354;&#26684;&#20063;&#21487;&#20197;&#25442;&#25104;&#38750;26&#20010;&#23383;&#27597;</span>


<span style="color: #b22222;">;; </span><span style="color: #b22222;">yes or no &#31616;&#21270;&#20026;y n</span>
(fset 'yes-or-no-p 'y-or-n-p)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26356;&#25913;&#26174;&#31034;&#23383;&#20307;&#22823;&#23567; 16pt</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">http://stackoverflow.com/questions/294664/how-to-set-the-font-size-in-emacs</span>
(set-face-attribute 'default nil <span style="color: #483d8b;">:height</span> 160)<span style="color: #b22222;">;;</span>

<span style="color: #b22222;">;;</span><span style="color: #b22222;">&#35753;&#40736;&#26631;&#28378;&#21160;&#26356;&#22909;&#29992;</span>
(<span style="color: #a020f0;">setq</span> mouse-wheel-scroll-amount '(1 ((shift) . 1) ((control) . nil)))
(<span style="color: #a020f0;">setq</span> mouse-wheel-progressive-speed nil)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:815eb0de-2290-40db-b142-defbf1f9ccd1" class="outline-4">
<h4 id="h:815eb0de-2290-40db-b142-defbf1f9ccd1">不同文件跳转</h4>
<div class="outline-text-4" id="text-h:815eb0de-2290-40db-b142-defbf1f9ccd1">
<p>
配置划分成不同文件，好以后方便查找
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">open-init-file</span>()
  (<span style="color: #a020f0;">interactive</span>)
  (find-file <span style="color: #8b2252;">"~/.emacs.d/init.el"</span>)) 
(global-set-key (kbd <span style="color: #8b2252;">"&lt;f2&gt;"</span>) 'open-init-file) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&lt;f2&gt; &#38190;&#24555;&#36895;&#25171;&#24320;&#37197;&#32622;&#25991;&#20214;</span>

(global-set-key (kbd <span style="color: #8b2252;">"C-c p f"</span>) 'project-find-file) <span style="color: #b22222;">;;   </span><span style="color: #b22222;">&#26597;&#25214;&#25991;&#20214;&#65292;&#40664;&#35748;&#32465;&#23450;&#22312; C-x p f</span>
(eval-after-load 'consult (global-set-key (kbd <span style="color: #8b2252;">"C-c p s"</span>) 'consult-ripgrep))  <span style="color: #b22222;">;;  </span><span style="color: #b22222;">&#26597;&#25214;&#25991;&#20214;&#20869;&#23481;</span>
</pre>
</div>

<p>
C-c 是给用户定义的快捷键，p 代表 project ， f 代表 find-file
</p>

<p>
consult-ripgrep 需要安装 consult 和 ripgrep ， 方便查找关键字
</p>

<p>
配置文件生效的几种方法：
</p>
<ul class="org-ul">
<li>重启编辑器或者重新加 载配置文件</li>
<li>`M-x eval-buffer` 去执行当前缓冲区的所有 Lisp 命令</li>
<li>`C-x C-e` 来执行某一行的 Lisp 代码</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:978a256e-9db4-4154-9797-143f3437dfb5" class="outline-3">
<h3 id="h:978a256e-9db4-4154-9797-143f3437dfb5">配置快捷键</h3>
<div class="outline-text-3" id="text-h:978a256e-9db4-4154-9797-143f3437dfb5">
<p>
首先介绍一下如何配置全局的快捷键：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd &lt;KEY&gt;) &lt;FUNCTION&gt;)
</pre>
</div>

<p>
其中 `&lt;KEY&gt;` 和 `&lt;FUNCTION&gt;` 替换为你想要设置的快捷键和功能。例如一个常见设置是修改回车键为“新起一行并做缩进”：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #8b2252;">"RET"</span>) 'newline-and-indent)
</pre>
</div>

<p>
其它设置示例：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (global-set-key (kbd <span style="color: #8b2252;">"C-a"</span>) 'back-to-indentation)      <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20132;&#25442; C-a &#21644; M-m&#65292;C-a &#20026;&#21040;&#32553;&#36827;&#21518;&#30340;&#34892;&#39318;</span>
  (global-set-key (kbd <span style="color: #8b2252;">"M-m"</span>) 'move-beginning-of-line)   <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20132;&#25442; C-a &#21644; M-m&#65292;M-m &#20026;&#21040;&#30495;&#27491;&#30340;&#34892;&#39318;</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-c '"</span>) 'comment-or-uncomment-region) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20026;&#36873;&#20013;&#30340;&#20195;&#30721;&#21152;&#27880;&#37322;/&#21435;&#27880;&#37322;</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#33258;&#23450;&#20041;&#20004;&#20010;&#20989;&#25968;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Faster move cursor</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">next-ten-lines</span>()
    <span style="color: #8b2252;">"Move cursor to next 10 lines."</span>
    (<span style="color: #a020f0;">interactive</span>)
    (next-line 10))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">previous-ten-lines</span>()
    <span style="color: #8b2252;">"Move cursor to previous 10 lines."</span>
    (<span style="color: #a020f0;">interactive</span>)
    (previous-line 10))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32465;&#23450;&#21040;&#24555;&#25463;&#38190;</span>
  (global-set-key (kbd <span style="color: #8b2252;">"M-n"</span>) 'next-ten-lines)            <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20809;&#26631;&#21521;&#19979;&#31227;&#21160; 10 &#34892;</span>
  (global-set-key (kbd <span style="color: #8b2252;">"M-p"</span>) 'previous-ten-lines)        <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20809;&#26631;&#21521;&#19978;&#31227;&#21160; 10 &#34892;</span>
</pre>
</div>

<p>
在使用 Emacs 期间应当已经发现规律，Emacs 的常见快捷键前缀是 `C-x` 和 `C-c`，有些可选的个人操作：解绑本来的 `C-j` 快捷键（本来功能为 `electric-newline-and-maybe-indent`），让 `C-j` 也成为了一个前缀
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #8b2252;">"C-j"</span>) nil)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21024;&#21435;&#20809;&#26631;&#25152;&#22312;&#34892;&#65288;&#22312;&#22270;&#24418;&#30028;&#38754;&#26102;&#21487;&#20197;&#29992; "C-S-&lt;DEL&gt;"&#65292;&#32456;&#31471;&#24120;&#20250;&#25318;&#25130;&#36825;&#20010;&#25353;&#27861;)</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-j C-k"</span>) 'kill-whole-line)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5973ab9f-60b0-4af6-aa4b-15a755ae791a" class="outline-3">
<h3 id="h:5973ab9f-60b0-4af6-aa4b-15a755ae791a">其它</h3>
<div class="outline-text-3" id="text-h:5973ab9f-60b0-4af6-aa4b-15a755ae791a">
</div>
<div id="outline-container-h:3cae5bd3-c5f2-4622-8647-c4c5581e1cb9" class="outline-4">
<h4 id="h:3cae5bd3-c5f2-4622-8647-c4c5581e1cb9">通过修改字体解决 Windows 上 Emacs 的卡顿</h4>
<div class="outline-text-4" id="text-h:3cae5bd3-c5f2-4622-8647-c4c5581e1cb9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20462;&#25913;&#23383;&#20307;&#35299;&#20915; Windows &#19978; Emacs &#30340;&#21345;&#39039;</span>
(<span style="color: #a020f0;">use-package</span> emacs
  <span style="color: #483d8b;">:if</span> (display-graphic-p)
  <span style="color: #483d8b;">:config</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Font settings</span>
  (<span style="color: #a020f0;">if</span> *is-windows*
    (<span style="color: #a020f0;">progn</span>
      (set-face-attribute 'default nil <span style="color: #483d8b;">:font</span> <span style="color: #8b2252;">"Microsoft Yahei Mono 9"</span>)
      (<span style="color: #a020f0;">dolist</span> (charset '(kana han symbol cjk-misc bopomofo))
        (set-fontset-font (frame-parameter nil 'font) charset (font-spec <span style="color: #483d8b;">:family</span> <span style="color: #8b2252;">"Microsoft Yahei Mono"</span> <span style="color: #483d8b;">:size</span> 12))))
  (set-face-attribute 'default nil <span style="color: #483d8b;">:font</span> <span style="color: #8b2252;">"Source Code Pro for Powerline 11"</span>)))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:54f073a0-8e9a-4ee8-ace4-78a839d3a0ee" class="outline-4">
<h4 id="h:54f073a0-8e9a-4ee8-ace4-78a839d3a0ee">增加的一点启动配置</h4>
<div class="outline-text-4" id="text-h:54f073a0-8e9a-4ee8-ace4-78a839d3a0ee">
<p>
设置垃圾回收阈值，加速启动速度。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#22403;&#22334;&#22238;&#25910;&#38408;&#20540;&#65292;&#21152;&#36895;&#21551;&#21160;&#36895;&#24230;</span>
(<span style="color: #a020f0;">setq</span> gc-cons-threshold most-positive-fixnum)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9b21a271-6160-4e2b-95c1-051bc35101d4" class="outline-4">
<h4 id="h:9b21a271-6160-4e2b-95c1-051bc35101d4">用 y/n 来代替 yes/no</h4>
<div class="outline-text-4" id="text-h:9b21a271-6160-4e2b-95c1-051bc35101d4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(fset 'yes-or-no-p 'y-or-n-p)                <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26576;&#20010;&#21629;&#20196;&#26102;&#38656;&#35201;&#36755;&#20837; (yes or no) </span>
</pre>
</div>


<p>
为了项目管理的统一化，可以用如下的`use-package`写法：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> emacs <span style="color: #483d8b;">:config</span> (<span style="color: #a020f0;">defalias</span> '<span style="color: #0000ff;">yes-or-no-p</span> 'y-or-n-p))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:0dbe9602-f5b7-4556-8dea-6b6abe8ca870" class="outline-4">
<h4 id="h:0dbe9602-f5b7-4556-8dea-6b6abe8ca870">tab 缩进</h4>
<div class="outline-text-4" id="text-h:0dbe9602-f5b7-4556-8dea-6b6abe8ca870">
<p>
跟 vim 一样的
</p>

<p>
参考：<a href="https://emacs-china.org/t/emacs/19319/7">tab 变空格</a>
</p>
</div>
</div>
</div>
</section>
<section id="outline-container-Org 管理" class="outline-2">
<h2 id="Org 管理">Org 管理</h2>
<div class="outline-text-2" id="text-Org 管理">
<p>
官方文档：<a href="https://orgmode.org/manual/index.html">https://orgmode.org/manual/index.html</a>
中文文档：<a href="https://grass.show/omegat/target/Org%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C(%E5%AE%8C%E6%95%B4%E7%89%88).html">https://grass.show/omegat/target/Org%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C(%E5%AE%8C%E6%95%B4%E7%89%88).html</a>
</p>

<p>
缺点：写笔记不方便，插入图片显示比较困难
李杀也不用 org-mode，手撸 html，都二十年了，我也想尝试一下。
</p>
</div>
<div id="outline-container-h:02fe1f63-8c31-4f46-8493-3db7ac084d18" class="outline-3">
<h3 id="h:02fe1f63-8c31-4f46-8493-3db7ac084d18">Org-mode 简化版</h3>
<div class="outline-text-3" id="text-h:02fe1f63-8c31-4f46-8493-3db7ac084d18">
<ul class="org-ul">
<li>org-mode <a href="https://orgmode.org/">https://orgmode.org/</a></li>

<li>大佬 <a href="https://github.com/zamansky">https://github.com/zamansky</a></li>
<li>官方手册 <a href="https://orgmode.org/worg/org-tutorials/">https://orgmode.org/worg/org-tutorials/</a></li>
<li>快捷键官方手册 <a href="https://orgmode.org/worg/orgcard.html">https://orgmode.org/worg/orgcard.html</a></li>
</ul>

<p>
org-mode 是 Emacs 最强力的插件，没有之一。可以用来做 GTD，博客/Wiki工具，写书，写论文等。 orgmode 是 emacs 自带的 package，但是一般自带的版本比较低。更新到最新版本的办法：
</p>

<p>
查看 org mode 版本 `C-h v org-version`
</p>
</div>
<div id="outline-container-h:0f7d62d7-90b9-46ef-8002-bc313c247ba9" class="outline-4">
<h4 id="h:0f7d62d7-90b9-46ef-8002-bc313c247ba9">org mode 能做什么</h4>
<div class="outline-text-4" id="text-h:0f7d62d7-90b9-46ef-8002-bc313c247ba9">
<ul class="org-ul">
<li>写文章</li>
</ul>
<p>
这里包含博客、PRD、技术文档等，都可以通过Org mode完成，例如这篇博文，就是在Org mode下写的：
</p>


<ul class="org-ul">
<li>文学编程</li>
</ul>

<p>
literate programming 根据 Donald Knuth 的 <a href="https://www-cs-faculty.stanford.edu/~knuth/lp.html#:~:text=Literate%20programming%20is%20a%20methodology,in%20a%20high%2Dlevel%20language.">定义</a>，文学编程是一种把文档语言和编程语言组合在一起的方法（methodology）。 它能让编程鲁棒性更强，增强跨平台性，更易维护，以及更加有趣。 文学编程面向的对象是人类，而不是机器。
</p>

<p>
根据<a href="https://orgmode.org/worg/org-contrib/babel/">官方文档</a>，org mode 原来是通过 org-babel 这一插件来实现文学编程的。
</p>

<p>
使用 <code>C-c C-c</code> 来运行下面这段代码。
</p>

<div class="org-src-container">
<pre class="src src-text">#+begin_src &lt;language&gt;  &lt;switches&gt; &lt;header arguments&gt;
,&lt;body&gt;
#+end_src

- &lt;language&gt;
An identifier for the code block language.
- &lt;switches&gt;
Control code execution, export, and format.
- &lt;header arguments&gt;
Header arguments control many facets of code block behavior, including tangling, evaluation, handling results of evaluation, and exporting. 
&lt;body&gt;
The source code to be evaluated.
</pre>
</div>

<p>
范例：显示打印值
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">+caption: print value</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+name: print value</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+begin_src python :results output</span>
<span style="color: #0000ff;">print</span>(1+1)
<span style="color: #b22222;">#</span><span style="color: #b22222;">+end_src</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">+RESULTS: print value</span>
: 2
</pre>
</div>

<ul class="org-ul">
<li>画各种图</li>
</ul>

<p>
依托于Org mode代码块的强大能力，你可以在Org文件中直接画各种图，脑图、流程图、类图、时序图、甘特图等等，这些都是产品经理经常要用到图：
</p>

<ul class="org-ul">
<li>任务管理</li>
</ul>
<p>
每天的计划，工作记录，都可以通过Org mode来记录
</p>
</div>
</div>
<div id="outline-container-h:4c096ca6-5a6b-40e4-b252-5ad858db9878" class="outline-4">
<h4 id="h:4c096ca6-5a6b-40e4-b252-5ad858db9878">安装最新的 org</h4>
<div class="outline-text-4" id="text-h:4c096ca6-5a6b-40e4-b252-5ad858db9878">
<p>
将 `("org" . "<a href="https://orgmode.org/elpa/">https://orgmode.org/elpa/</a>")` 添加到 `package-archives` 中，然后：
安装org 之前，一定要配置 use-package 不使用内置的org 版本。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">&#23433;&#35013; org&#65292;&#36825;&#20010;&#37197;&#32622;&#19968;&#23450;&#35201;&#37197;&#32622;&#22312; use-package &#30340;&#21021;&#22987;&#21270;&#20043;&#21069;&#65292;&#21542;&#21017;&#26080;&#27861;&#27491;&#24120;&#23433;&#35013;</span>
(assq-delete-all 'org package--builtins)
(assq-delete-all 'org package--builtin-versions)

(<span style="color: #a020f0;">setq</span> package-archives '((<span style="color: #8b2252;">"gnu"</span>   . <span style="color: #8b2252;">"https://elpa.gnu.org/packages/"</span>)
                         (<span style="color: #8b2252;">"nongnu"</span> . <span style="color: #8b2252;">"https://elpa.nongnu.org/nongnu/"</span>)
                         (<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"https://melpa.org/packages/"</span>))

(<span style="color: #a020f0;">use-package</span> org
  <span style="color: #483d8b;">:pin</span> gnu
  <span style="color: #483d8b;">:ensure</span> t
  )

(<span style="color: #a020f0;">use-package</span> org-contrib
  <span style="color: #483d8b;">:pin</span> nongnu
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<p>
小于 28 版本的需要在入口文件添加如下内容：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> 'package (add-to-list 'package-archives '(<span style="color: #8b2252;">"nongnu"</span> . <span style="color: #8b2252;">"https://elpa.nongnu.org/nongnu/"</span>)))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2b7b026c-ecf9-4cf2-8c3c-0c9ebff624b4" class="outline-4">
<h4 id="h:2b7b026c-ecf9-4cf2-8c3c-0c9ebff624b4">org-mode基础</h4>
<div class="outline-text-4" id="text-h:2b7b026c-ecf9-4cf2-8c3c-0c9ebff624b4">
</div>
<div id="outline-container-h:8c8fb6dc-c834-441d-9e91-2a7ff22f6642" class="outline-5">
<h5 id="h:8c8fb6dc-c834-441d-9e91-2a7ff22f6642">标题与折叠</h5>
<div class="outline-text-5" id="text-h:8c8fb6dc-c834-441d-9e91-2a7ff22f6642">
<p>
Org mode的标题是通过在行首输入 <code>*</code> 来实现， <code>*</code> 的数量代表标题的级数，在 <code>*</code> 跟一个空格加上文字就共同组成了这个标题。
</p>

<p>
标题最多 10 级
</p>
<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* &#20026;&#19968;&#32423;&#26631;&#39064;</span>
<span style="color: #a0522d;">** &#20026;&#20108;&#32423;&#26631;&#39064;</span>
<span style="color: #a020f0;">*** &#20026;&#19977;&#32423;&#26631;&#39064;&#24182;&#20197;&#27492;&#31867;&#25512;</span>
</pre>
</div>

<p>
简单的使用，连续按 &lt;tab&gt; 键可以进行折叠和展开的切换; <code>C-c C-t</code> 可以将一个条目转换成一条待办事件。
</p>


<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">标题快捷键</td>
<td class="org-left">描述</td>
</tr>

<tr>
<td class="org-left">:------------</td>
<td class="org-left">:----------------------------------------------------------</td>
</tr>

<tr>
<td class="org-left">TAB</td>
<td class="org-left">折叠/打开当前标题</td>
</tr>

<tr>
<td class="org-left">Shift-TAB</td>
<td class="org-left">折叠/打开当前文档的标题</td>
</tr>

<tr>
<td class="org-left">C-u TAB</td>
<td class="org-left">控制整个 buffer 的折叠状态。折叠成标题–折叠成目录–不折叠</td>
</tr>

<tr>
<td class="org-left">M-UP/DOWN</td>
<td class="org-left">调整标题在文档中的位置。可连同子标题一起调整位置   推荐使用</td>
</tr>

<tr>
<td class="org-left">M-LEFT/RIGHT</td>
<td class="org-left">快速提升或降低标题级别。该标题下的相关正文同步调整缩进</td>
</tr>

<tr>
<td class="org-left">C-c C-t</td>
<td class="org-left">切换当前标题的状态（TODO 等）</td>
</tr>

<tr>
<td class="org-left">C-c C-n</td>
<td class="org-left">移动光标到下一标题</td>
</tr>

<tr>
<td class="org-left">C-c C-p</td>
<td class="org-left">移动光标到上一标题</td>
</tr>

<tr>
<td class="org-left">C-c C-f</td>
<td class="org-left">移动光标到和当前标题同等级的下一个标题</td>
</tr>

<tr>
<td class="org-left">C-c C-b</td>
<td class="org-left">移动光标到和当前标题同等级的上一个标题</td>
</tr>

<tr>
<td class="org-left">C-u C-u M-RET</td>
<td class="org-left">在当前标题内容的最后，另起一行创建一个同级标题</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-h:a2538426-75c1-4ddd-af04-a105c3106dff" class="outline-5">
<h5 id="h:a2538426-75c1-4ddd-af04-a105c3106dff">格式化字词</h5>
<div class="outline-text-5" id="text-h:a2538426-75c1-4ddd-af04-a105c3106dff">
<div class="org-src-container">
<pre class="src src-org">&#21152;&#31895;&#65306;*&#31895;&#20307;* <span style="font-weight: bold;">*&#31895;&#20307;*</span>
&#26012;&#20307;&#65306;/&#26012;&#20307;/ <span style="font-style: italic;">/&#26012;&#20307;/</span>
&#21024;&#38500;&#32447;&#65306;+&#21024;&#38500;&#32447;+ <span style="text-decoration: line-through;">+&#21024;&#38500;&#32447;+</span>
&#19979;&#21010;&#32447;&#65306;_&#19979;&#21010;&#32447;_ <span style="text-decoration: underline;">_&#19979;&#21010;&#32447;_</span>
&#24378;&#35843;&#65306;=&#24378;&#35843;= <span style="color: #7f7f7f;">=&#24378;&#35843;=</span>
&#34892;&#20869;&#20195;&#30721;&#65306;~&#20195;&#30721;~ <span style="color: #7f7f7f;">~&#20195;&#30721;~</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:22f6d03f-a39b-4ab7-97f4-123df7d86fa6" class="outline-5">
<h5 id="h:22f6d03f-a39b-4ab7-97f4-123df7d86fa6">输入控制字符</h5>
<div class="outline-text-5" id="text-h:22f6d03f-a39b-4ab7-97f4-123df7d86fa6">
<ul class="org-ul">
<li>引用插入（输入一些看不见的字符）</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell">C-q == quoted-insert
<span style="color: #0000ff;">&#19981;&#21487;&#35265;</span>(&#38750;&#22270;&#24418;&#23383;&#31526;)
    - &lt;RET&gt;, C-l(&#20998;&#39029;&#31526;)
    - 033 Enter (Ascii &#20843;&#36827;&#21046;) = f(&#21407;&#26679;&#36755;&#20986;f)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:487ad9ac-ddee-4e81-afa7-8af7cb4761c0" class="outline-5">
<h5 id="h:487ad9ac-ddee-4e81-afa7-8af7cb4761c0">添加代码块</h5>
<div class="outline-text-5" id="text-h:487ad9ac-ddee-4e81-afa7-8af7cb4761c0">
<p>
在 Org-mode 中你可以直接开启新的缓冲区（Buffer）直接用相应的 Major Mode 来编辑代码块内的内容。在代码块中使用 <code>C-c '</code> 会直接打开对应模式的缓冲区（不仅限于 Lisp）。 这样就使在 Org-mode 中编辑代码变的十分方便快捷。
</p>

<ul class="org-ul">
<li>旧版使用快捷键 <code>&lt; + 快捷码 + TAB</code> 。
<ul class="org-ul">
<li>如代码块 <code>&lt;s + Tab</code> 可以直接插入代码块的代码片段（Snippet）</li>
</ul></li>
<li>从 orgmode 9.2 版本后， <code>org-insert-structure-template</code> 变为 <code>C-c C-,</code> 给出列表选择
<ul class="org-ul">
<li>src 代码可以用 <code>C-c C-, s</code></li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">\#</span>+BEGIN_SRC emacs-lisp
  ;; Your code goes here
  ;; &#20320;&#30340;&#20195;&#30721;&#20889;&#22312;&#36825;&#37324;
<span style="color: #8b2252;">\#</span>+END_SRC
</pre>
</div>


<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\#+BEGIN_SRC emacs-lisp
(+ 2 22)   <span style="color: #b22222;">;;</span><span style="color: #b22222;">&#36825;&#37324;&#20351;&#29992;C-x C-e&#25191;&#34892;&#65292;&#20132;&#20114;&#21306;&#20250;&#26174;&#31034;&#20986;&#32467;&#26524;24&#12290;&#20351;&#29992;C-c C-c &#36755;&#20837;yes&#20250;&#22312;&#20869;&#23481;&#37324;&#28155;&#21152;=+RESULTS&#24182;&#36755;&#20986;&#32467;&#26524;</span>
\#+END_SRC

\#+RESULTS:
: 24
</pre>
</div>

<p>
独立窗口修改：选中代码块，使用 <code>C-c '</code> 会直接打开对应模式的缓冲区，使用 <code>C-c '</code> 完成修改
</p>

<ul class="org-ul">
<li>还想使用旧版快捷键</li>
</ul>

<pre class="example" id="org8d514a8">
(with-eval-after-load 'org
(require 'org-tempo))
;; 禁用左尖括号
(setq electric-pair-inhibit-predicate
	`(lambda (c)
	   (if (char-equal c ?\&lt;) t (,electric-pair-inhibit-predicate c))))

(add-hook 'org-mode-hook
	    (lambda ()
	      (setq-local electric-pair-inhibit-predicate
			  `(lambda (c)
			     (if (char-equal c ?\&lt;) t (,electric-pair-inhibit-predicate c))))))
</pre>
</div>
</div>
<div id="outline-container-h:43567748-650f-448a-82f7-628d7931273f" class="outline-5">
<h5 id="h:43567748-650f-448a-82f7-628d7931273f">列表</h5>
<div class="outline-text-5" id="text-h:43567748-650f-448a-82f7-628d7931273f">
<p>
如果在本级列表内换行，就需要在新行前面加个空格
</p>

<div class="org-src-container">
<pre class="src src-text">&#26080;&#24207;&#21015;&#34920;&#65306;&#20197; - * + &#23383;&#31526;&#24320;&#22836;
&#26377;&#24207;&#21015;&#34920;&#65306;&#20197; 1. 1) &#23383;&#31526;&#24320;&#22836;
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">列表快捷键</td>
<td class="org-left">描述</td>
</tr>

<tr>
<td class="org-left">:-----------</td>
<td class="org-left">:---------------------</td>
</tr>

<tr>
<td class="org-left">C-c -</td>
<td class="org-left">改变列表展示方式</td>
</tr>

<tr>
<td class="org-left">M-UP/DOWN</td>
<td class="org-left">上下调整列表位置</td>
</tr>

<tr>
<td class="org-left">M-LEFT/RIGHT</td>
<td class="org-left">左右提升或降低列表级别</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-h:ac79f8b2-1f22-45e4-a007-7eda24ffd4b8" class="outline-5">
<h5 id="h:ac79f8b2-1f22-45e4-a007-7eda24ffd4b8">超链接</h5>
<div class="outline-text-5" id="text-h:ac79f8b2-1f22-45e4-a007-7eda24ffd4b8">
<p>
<b>快捷键</b>
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">超链接快捷键</td>
<td class="org-left">描述</td>
</tr>

<tr>
<td class="org-left">:-----------</td>
<td class="org-left">:-----------------------------------------------------------</td>
</tr>

<tr>
<td class="org-left">C-c C-l</td>
<td class="org-left">编辑/插入一个超链接 输入地址和描述。链接地址的格式为`<a href="http://.xxx">xxx</a>`</td>
</tr>

<tr>
<td class="org-left">C-u C-c C-l</td>
<td class="org-left">插入一个文件超链接（如果有中文，使用该快捷键会有时跳转不了。这时需要手动输入中文）</td>
</tr>

<tr>
<td class="org-left">C-c C-o</td>
<td class="org-left">用浏览器或 emacs 等打开这个超链接</td>
</tr>

<tr>
<td class="org-left">C-c C-x C-n</td>
<td class="org-left">下一个链接</td>
</tr>

<tr>
<td class="org-left">C-c C-x C-p</td>
<td class="org-left">上一个链接</td>
</tr>
</tbody>
</table>



<ul class="org-ul">
<li><p>
链接格式：	  	Org中链接的格式设置方式。
</p>
<div class="org-src-container">
<pre class="src src-text">[[&#38142;&#25509;&#22320;&#22336;][&#35813;&#38142;&#25509;&#23637;&#31034;&#30340;&#25991;&#23383;]] 
&#25110;&#32773; [[&#38142;&#25509;&#22320;&#22336;]]
</pre>
</div></li>
<li><p>
内部链接：	  	链接到当前文件中的其他位置。
</p>
<div class="org-src-container">
<pre class="src src-text">&lt;&lt;&#26631;&#31614;&#21517;&gt;&gt;
[[&#26631;&#31614;&#21517;]] &#28857;&#20987;&#21487;&#20197;&#36339;&#36716;&#65292;html&#20013;&#26174;&#31034;&#30446;&#24405;&#32534;&#21495;
</pre>
</div></li>
<li>无线电目标：	  	生成目标触发纯文本形式的链接。</li>
<li><p>
外部链接：	  	指向互联网的类似URL的链接。
</p>
<div class="org-src-container">
<pre class="src src-text">[[Link&#31867;&#22411;][&#38142;&#25509;&#26174;&#31034;&#30340;&#21517;&#31216;]]
&#25903;&#25345;&#30340;&#31867;&#22411;&#26377;&#65306;http,https,file,shell,elisp&#31561;

&#22914;&#65306;
[[http://www.gnu.org/software/emacs/][GNU Emacs]]
[[file:/home/dominik/images/jupiter.jpg]]
</pre>
</div></li>
<li>处理链接：	  	创建、插入和跟随。</li>
<li>使用Org外部链接：	  	从我的C源代码链接吗？</li>
<li>链接缩写：	  	编写复杂链接的快捷方式。</li>
<li><p>
搜索选项：	  	链接到特定位置。
</p>
<div class="org-src-container">
<pre class="src src-text">&#36873;&#39033;&#29992; :: 2&#20010;&#20882;&#21495;&#20998;&#38548;
&#22914;&#65306;
[[file:~/code/main.c::255]] &#36339;&#21040;255&#34892;
[[file:~/xx.org::My Target]] &#25628;&#32034;&#36339;&#36716;&#21040;&lt;&lt;My Target&gt;&gt;&#26631;&#31614;
[[file:~/xx.org::*My Target]] &#36339;&#21040;&#23545;&#24212;&#26631;&#39064;
[[file:~/xx.org::#my-custom-id]] &#38142;&#25509;&#21040;&#20855;&#26377;&#8220;CUSTOM_ID&#8221;&#23646;&#24615;&#30340;&#26631;&#39064;
[[file:~/xx.org::/regexp/]] &#27491;&#21017;&#25628;&#32034;
[[attachment:main.c::255]]


[[file:::find me]] &#22312;&#24403;&#21069;&#25991;&#20214;&#20013;&#25628;&#32034; find me&#65292;&#30456;&#24403;&#20110;[[find me]]
[[*my title]] &#36339;&#36716;&#21040;&#23545;&#24212;&#26631;&#39064;&#21517;
</pre>
</div></li>
<li><p>
自定义搜索：	  	当默认搜索不够用时。
</p>

<p>
CUSTOM_ID 定义方法
</p>

<pre class="example" id="orgdf5648c">

引用对应标题 custom_id [[#mydi][标题1]]

** 标题1
 :PROPERTIES:
 :CUSTOM_ID: myid
 :END:
</pre></li>
</ul>


<p>
跳转到指定 CUSTOM_ID 如下。当导出到 html 时，CUSTOM_ID 会转换成锚点，
会替换原先自动生成的章节锚点
</p>

<p>
图片像素滚动
</p>
<div class="org-src-container">
<pre class="src src-sh">pixel-scroll-precision-mode
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5218fb37-431c-4c5b-842d-a1cddead9f5a" class="outline-5">
<h5 id="h:5218fb37-431c-4c5b-842d-a1cddead9f5a">引用</h5>
<div class="outline-text-5" id="text-h:5218fb37-431c-4c5b-842d-a1cddead9f5a">
<p>
在Org mode里，可以通过 #+BEGIN_QUOTE 和 #+END_QUOTE 包裹的部分写入引用的文本，例如：
</p>
<div class="org-src-container">
<pre class="src src-org">#+BEGIN_QUOTE
&#36825;&#26159;&#24341;&#29992;&#30340;&#25991;&#26412;&#12290;
#+END_QUOT
</pre>
</div>
</div>
</div>
<div id="outline-container-h:b1a99d22-9b31-4c1c-b9fe-cd783311c16f" class="outline-5">
<h5 id="h:b1a99d22-9b31-4c1c-b9fe-cd783311c16f">标签</h5>
<div class="outline-text-5" id="text-h:b1a99d22-9b31-4c1c-b9fe-cd783311c16f">
<p>
区别于 CSDN博客 和 evernote 的标签，org-mode 的标签支持为每个标题都设置标签。
标签主要是用于分类和搜索的。但是标签是用户自己设置的，可能该打的标签没打，导致搜索不到。我更倾向于使用搜索命令或 google 搜索笔记。不做笔记
</p>
</div>
</div>
<div id="outline-container-h:7ba3695c-ebe0-4f2d-b617-2cc36cfa903e" class="outline-5">
<h5 id="h:7ba3695c-ebe0-4f2d-b617-2cc36cfa903e">插入 latex 公式</h5>
<div class="outline-text-5" id="text-h:7ba3695c-ebe0-4f2d-b617-2cc36cfa903e">
<div class="org-src-container">
<pre class="src src-shell">&#20351;&#29992; $ $ &#22312;&#34892;&#20869;&#25554;&#20837;&#12290;&#20363;&#22914; $\displaystyle \min_{x_1,\dots x_T}$ :
&#20351;&#29992; $<span style="color: #a0522d;">$</span> $<span style="color: #a0522d;">$</span> &#22312;&#34892;&#38388;&#25554;&#20837;&#12290;&#20363;&#22914; $<span style="color: #a0522d;">$</span>\displaystyle \min_{x_1,\dots x_T}$<span style="color: #a0522d;">$</span> &#65306;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:3f4d7afc-cd42-4ff6-ad1e-dc11166329a6" class="outline-5">
<h5 id="h:3f4d7afc-cd42-4ff6-ad1e-dc11166329a6">添加 org 注释</h5>
<div class="outline-text-5" id="text-h:3f4d7afc-cd42-4ff6-ad1e-dc11166329a6">
<p>
两种注释方式
</p>

<ol class="org-ol">
<li><p>
注释一段内容：注释中的内容不会被导出
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\#+BEGIN_COMMENT

\#+END_COMMENT
</pre>
</div></li>

<li>注释整章内容：在一个章节上使用快捷键 `C-c ;` ，可在一个章节名上触发添加 COMMENT 关键字，该章节就会被注释不会被导出</li>
</ol>
</div>
</div>
<div id="outline-container-h:43040646-ac62-416d-a8c1-458eb0b0a4ca" class="outline-5">
<h5 id="h:43040646-ac62-416d-a8c1-458eb0b0a4ca">计时功能</h5>
<div class="outline-text-5" id="text-h:43040646-ac62-416d-a8c1-458eb0b0a4ca">
<p>
菜单栏 &#x2014;&gt; org &#x2014;&gt; Dates and Scheduling 
</p>

<p>
`C-c C-x .` 开始计时，并显示时间。如`0:00:00`时分秒
</p>

<p>
`C-u C-c C-x .` 停止计时，并显示时间。`0:00:00`时分秒
</p>
</div>
</div>
<div id="outline-container-h:1aaf8cd6-c6b7-4707-bd99-60cb0d324dc0" class="outline-5">
<h5 id="h:1aaf8cd6-c6b7-4707-bd99-60cb0d324dc0">Org 导出</h5>
<div class="outline-text-5" id="text-h:1aaf8cd6-c6b7-4707-bd99-60cb0d324dc0">
<p>
使用 `C-c C-e` 可以将 Org-mode 文档导出为你需要的格式，例如 HTML 或者 PDF 文件。 你现在看到的这本教程就是由 Org-mode 所导出生成的。
</p>
</div>
</div>
</div>
<div id="outline-container-h:a6c29492-860e-4cca-923d-cd7a5d607e02" class="outline-4">
<h4 id="h:a6c29492-860e-4cca-923d-cd7a5d607e02">GTD</h4>
<div class="outline-text-4" id="text-h:a6c29492-860e-4cca-923d-cd7a5d607e02">
</div>
<div id="outline-container-h:da3de33b-845e-4733-82c5-6cee65452606" class="outline-5">
<h5 id="h:da3de33b-845e-4733-82c5-6cee65452606">org todo</h5>
<div class="outline-text-5" id="text-h:da3de33b-845e-4733-82c5-6cee65452606">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-todo-keywords
      (<span style="color: #a020f0;">quote</span> ((sequence <span style="color: #8b2252;">"TODO(t)"</span> <span style="color: #8b2252;">"STARTED(s)"</span> <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"DONE(d!/!)"</span>)
              (sequence <span style="color: #8b2252;">"WAITING(w@/!)"</span> <span style="color: #8b2252;">"SOMEDAY(S)"</span> <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"CANCELLED(c@/!)"</span> <span style="color: #8b2252;">"MEETING(m)"</span> <span style="color: #8b2252;">"PHONE(p)"</span>))))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">fix doom modeline</span>
<span style="color: #483d8b;">:custom-face</span>
(mode-line ((t (<span style="color: #483d8b;">:height</span> 0.9))))
(mode-line-inactive ((t (<span style="color: #483d8b;">:height</span> 0.9))))

(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-checklist</span>)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">need repeat task and properties</span>
(<span style="color: #a020f0;">setq</span> org-log-done t)
(<span style="color: #a020f0;">setq</span> org-log-into-drawer t)
</pre>
</div>

<p>
创建 gtd.org。`M-x ~/gtd.org`
</p>
</div>
<div id="outline-container-h:0cd2807c-e072-4527-8534-b6acf0089257" class="outline-6">
<h6 id="h:0cd2807c-e072-4527-8534-b6acf0089257">多种工作流状态</h6>
<div class="outline-text-6" id="text-h:0cd2807c-e072-4527-8534-b6acf0089257">
<p>
当标题的开头为"TODO"时，任何标题都会成为一个待办事项，例如:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #0000ff;"> &#23436;&#25104;ORG-MODE&#31508;&#35760;xxx&#37096;&#20998;</span>
</pre>
</div>

<p>
可以通过按键`C-c C-t`来对一个已存在标题标记不同的待办状态，默认情况下有三种待办状态:
</p>

<p>
#+end_src text
TODO :: 待办事项
DONE :: 已完成的待办事项
unmarked :: 未标记为待办事项的标题，也就是普通的标题
#+end_src
</p>

<p>
增加状态
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-todo-keywords
      (<span style="color: #a020f0;">quote</span> ((sequence <span style="color: #8b2252;">"TODO(t)"</span> <span style="color: #8b2252;">"STARTED(s)"</span> <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"DONE(d!/!)"</span>)
              (sequence <span style="color: #8b2252;">"WAITING(w@/!)"</span> <span style="color: #8b2252;">"SOMEDAY(S)"</span> <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"CANCELLED(c@/!)"</span> <span style="color: #8b2252;">"MEETING(m)"</span> <span style="color: #8b2252;">"PHONE(p)"</span>))))
</pre>
</div>

<p>
;;待办状态。括号中`@`代表记录日志，而`!`代表记录时间戳，具有两种功能: `TODO(t@/!)`
</p>
</div>
</div>
<div id="outline-container-h:3089e2ff-2661-466e-935d-5e1f28f84451" class="outline-6">
<h6 id="h:3089e2ff-2661-466e-935d-5e1f28f84451">每日计划</h6>
<div class="outline-text-6" id="text-h:3089e2ff-2661-466e-935d-5e1f28f84451">
<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* WAITING Daily routine</span>
- <span style="font-weight: bold;">[ ]</span> leetcode
- <span style="font-weight: bold;">[ ]</span> execrcise
</pre>
</div>


<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #0000ff;"> Daily routine </span><span style="color: #228b22; font-weight: bold;">[100%]</span>
<span style="color: #a020f0;">SCHEDULED:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2022-06-10 Fri 10:00 +1d&gt;</span>
<span style="color: #0000ff;">:PROPERTIES:</span>
<span style="color: #a020f0;">:LAST_REPEAT:</span> <span style="color: #a020f0; background-color: #ffffff; text-decoration: underline;">[2022-06-09 Thu 02:31]</span>
<span style="color: #0000ff;">:END:</span>
- State "DONE"       from "TODO"       <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 02:31]</span>
- State "TODO"       from "WAITING"    <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 02:26]</span>
- <span style="font-weight: bold;">[X]</span> leetcode
- <span style="font-weight: bold;">[X]</span> execrcise
</pre>
</div>

<ul class="org-ul">
<li><code>C-c C-s</code> 开始计划： <code>&lt;2022-06-09 Thu 10:00&gt;</code> 10点</li>

<li>每天 10 点做：需要 <code>+d</code> 加一天 <code>SCHEDULED: &lt;2022-06-09 Thu 10:00 +1d&gt;</code> ，后面在 agenda 中会用到</li>

<li>完成情况进度：每一项任务使用复选框，todo 部分加 <code>[%]</code> ，复选框使用 <code>C-c C-c</code> 打 叉 表示完成。</li>
</ul>

<p>
标记完成：=C-c C-t d= ，可以看到 <code>SCHEDULED</code> 时间自动加 1 <code>SCHEDULED: &lt;2022-06-10 Fri 10:00 +1d&gt;</code>
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #0000ff;"> Daily routine </span><span style="color: #228b22; font-weight: bold;">[100%]</span>
<span style="color: #a020f0;">SCHEDULED:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2022-06-10 Fri 10:00 +1d&gt;</span>
<span style="color: #0000ff;">:PROPERTIES:</span>
<span style="color: #a020f0;">:LAST_REPEAT:</span> <span style="color: #a020f0; background-color: #ffffff; text-decoration: underline;">[2022-06-09 Thu 02:31]</span>
<span style="color: #0000ff;">:END:</span>
- State "DONE"       from "TODO"       <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 02:31]</span>
- State "TODO"       from "WAITING"    <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 02:26]</span>
- <span style="font-weight: bold;">[X]</span> leetcode
- <span style="font-weight: bold;">[X]</span> execrcise
</pre>
</div>

<p>
不过进入新的计划，每一项还需要新的状态。这很麻烦，所以这边用另一个插件包 org-contrib。
目的是要引入 check list
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-checklist</span>)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">need repeat task and properties</span>
(<span style="color: #a020f0;">setq</span> org-log-done t)
(<span style="color: #a020f0;">setq</span> org-log-into-drawer t)
</pre>
</div>

<p>
通过 <code>M-x org-set-property</code>  添加 <code>RESET_CHECK_BOXES</code> 。 <code>RESET_CHECK_BOXES</code>  设置为 <code>t</code> 开启， 会在 <code>PROPERTIES</code> 中增加属性。
</p>

<p>
当 <code>C-c C-t d</code> 把标题设置为 DONE，自动进入下一个时间点。 这对自定义一些重复性工作比较方便。
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #0000ff;"> Daily routine </span><span style="color: #ff0000; font-weight: bold;">[0%]</span>
<span style="color: #a020f0;">SCHEDULED:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2022-06-15 Wed 10:00 +1d&gt;</span>
<span style="color: #0000ff;">:PROPERTIES:</span>
<span style="color: #a020f0;">:LAST_REPEAT:</span> <span style="color: #a020f0; background-color: #ffffff; text-decoration: underline;">[2022-06-09 Thu 07:24]</span>
<span style="color: #a020f0;">:RESET_CHECK_BOXES:</span> <span style="color: #000000; background-color: #ffffff;">t</span>
<span style="color: #0000ff;">:END:</span>
- State "DONE"       from "TODO"       <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 07:24]</span>
- State "DONE"       from "TODO"       <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 02:31]</span>
- State "TODO"       from "WAITING"    <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 02:26]</span>
- <span style="font-weight: bold;">[ ]</span> leetcode
- <span style="font-weight: bold;">[ ]</span> execrcise
</pre>
</div>

<p>
每次完成任务会自动插入完成状态，使用下面设置可以隐藏到 <code>PROPERTIES</code> 里：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">need repeat task and properties</span>
(<span style="color: #a020f0;">setq</span> org-log-done t)
(<span style="color: #a020f0;">setq</span> org-log-into-drawer t)
</pre>
</div>

<p>
使用 <code>C-c C-t d</code> 完成任务， 完成状态会增加到 <code>LOGBOOK</code> 属性中。把之前的状态手动移过来。
</p>
<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #0000ff;"> Daily routine </span><span style="color: #ff0000; font-weight: bold;">[0%]</span>
<span style="color: #a020f0;">SCHEDULED:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2022-06-17 Fri 10:00 +1d&gt;</span>
<span style="color: #0000ff;">:PROPERTIES:</span>
<span style="color: #a020f0;">:LAST_REPEAT:</span> <span style="color: #a020f0; background-color: #ffffff; text-decoration: underline;">[2022-06-09 Thu 07:44]</span>
<span style="color: #a020f0;">:RESET_CHECK_BOXES:</span> <span style="color: #000000; background-color: #ffffff;">t</span>
<span style="color: #0000ff;">:END:</span>
<span style="color: #0000ff;">:LOGBOOK:</span>
- State "DONE"       from "TODO"       <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 07:44]</span>
- State "DONE"       from "TODO"       <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 07:34]</span>
- State "DONE"       from "TODO"       <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 07:24]</span>
- State "DONE"       from              <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 03:03]</span>
- State "DONE"       from              <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 02:50]</span>
- State "DONE"       from "TODO"       <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 02:31]</span>
- State "TODO"       from "WAITING"    <span style="color: #a020f0; text-decoration: underline;">[2022-06-09 Thu 02:26]</span>  
<span style="color: #0000ff;">:END:</span>
- <span style="font-weight: bold;">[ ]</span> leetcode
- <span style="font-weight: bold;">[ ]</span> execrcise
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:9863d2c8-061d-4d34-a262-8cbf6917e414" class="outline-5">
<h5 id="h:9863d2c8-061d-4d34-a262-8cbf6917e414">org agenda</h5>
<div class="outline-text-5" id="text-h:9863d2c8-061d-4d34-a262-8cbf6917e414">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">C-c C-s schedule</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">C-c C-d deadline</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-c a"</span>) 'org-agenda)
(<span style="color: #a020f0;">setq</span> org-agenda-files '(<span style="color: #8b2252;">"~/gtd.org"</span>)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23450;&#20041; agenda &#25991;&#20214;&#65292;&#21487;&#20197;&#26159;&#22810;&#20010;</span>
(<span style="color: #a020f0;">setq</span> org-agenda-span 'day) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25353;&#22825;&#35266;&#23519;</span>
</pre>
</div>


<p>
我们Emacs做GTD工具的核心功能就是Agenda功能，他是一个可以实时查看自己有哪些任务，以及每个任务完成进度的功能，我们可以通过 <code>M-x org-agenda</code> 来打开，也可以自定义快捷键。
</p>

<p>
不过首先你需要建立一个专门存放你的GTD文件的目录，并且将 <code>org-agenda</code> 的目录指定为该目录。
</p>

<p>
首先做个按键绑定 <code>(global-set-key (kbd "C-c a") 'org-agenda)</code>
</p>

<p>
默认是观看每周日程，设置 <code>(setq org-agenda-span 'day)</code> 按日来排行程。
</p>

<p>
基本操作：
</p>
<ul class="org-ul">
<li><code>C-c a a</code>  可以看到每周日程。</li>
<li><code>f/b</code> 下一个/上一个阶段安排, <code>d/w</code> 天/周视图，=n/p= 上/下移动光标</li>
<li>在 <code>~/gtd.org</code> 设置 deadline <code>C-c C-d</code> ，在日程中也能看到。</li>
</ul>
</div>
</div>
<div id="outline-container-h:0b8da68c-57ce-492f-9cc6-00252959ecd3" class="outline-5">
<h5 id="h:0b8da68c-57ce-492f-9cc6-00252959ecd3">org capture</h5>
<div class="outline-text-5" id="text-h:0b8da68c-57ce-492f-9cc6-00252959ecd3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-capture-templates
      '((<span style="color: #8b2252;">"t"</span> <span style="color: #8b2252;">"Todo"</span> entry (file+headline <span style="color: #8b2252;">"~/gtd.org"</span> <span style="color: #8b2252;">"Workspace"</span>)
         <span style="color: #8b2252;">"* TODO [#B] %?\n  %i\n %U"</span>
         <span style="color: #483d8b;">:empty-lines</span> 1)))

(global-set-key (kbd <span style="color: #8b2252;">"C-c r"</span>) 'org-capture)
</pre>
</div>

<p>
这个模板包含五个部分，分别是
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">模板组成</td>
<td class="org-left">对应默认模板中的内容</td>
<td class="org-left">描述</td>
</tr>

<tr>
<td class="org-left">key</td>
<td class="org-left">"t"</td>
<td class="org-left">用来选择模板的字符</td>
</tr>

<tr>
<td class="org-left">description</td>
<td class="org-left">"Todo"</td>
<td class="org-left">展示用的模板描述</td>
</tr>

<tr>
<td class="org-left">type</td>
<td class="org-left">entry</td>
<td class="org-left">新增内容的类型</td>
</tr>

<tr>
<td class="org-left">target</td>
<td class="org-left">(file+headline "~/gtd.org" "Workspace")</td>
<td class="org-left">新增内容的存储位置</td>
</tr>

<tr>
<td class="org-left">template</td>
<td class="org-left">"* TODO [#B] %?\n  %i\n %U"</td>
<td class="org-left">新增内容的模板</td>
</tr>
</tbody>
</table>

<p>
新增内容的模板:
</p>
<ul class="org-ul">
<li>"%?" 是一个更特殊的标记，它不会产生任何内容，当所有其他的特殊标记都展开完毕或者输入完毕后，光标将会停留在这个标记所在的位置。</li>
<li>%i 可以插入一段初始化内容</li>
<li>%U  当前包含日期和时间的未激活的 timestamp，如: <span class="timestamp-wrapper"><span class="timestamp">[2018-03-04 周日 19:26] </span></span></li>
</ul>

<p>
定义捕获模板，绑定到快捷键 <code>C-c r</code> 。 更写详细的参考官方文档。
</p>

<p>
操作：
</p>
<ul class="org-ul">
<li><code>C-c a t</code> 向指定文件中写内容。 <code>C-c C-c</code> 完成. 会记录到gtd.org文件中</li>
<li>在文件中设置开始时间 <code>C-c C-s</code> 21:00 点， 再执行 <code>C-c a a</code> 就可看到日程更新了。</li>
</ul>
</div>
</div>
<div id="outline-container-h:653170a1-0181-4e39-8d56-1a5451c44983" class="outline-5">
<h5 id="h:653170a1-0181-4e39-8d56-1a5451c44983">org effect</h5>
<div class="outline-text-5" id="text-h:653170a1-0181-4e39-8d56-1a5451c44983">
<p>
设置任务完成需要的时间。
</p>

<p>
在 agenda view 中,  <code>e</code> 键可以设置effort, 按 <code>_</code> (org-agenda-filter-by-effort) 可以过滤指定effort 的heading
</p>

<p>
范例:设置 30分钟任务
</p>
<ul class="org-ul">
<li>进入agenda <code>C-c a a</code></li>
<li>设置完成任务需要30分钟，按 <code>e</code> 输入 <code>00:30</code></li>
<li>过滤 1 小时内能完成任务，按 <code>_</code>  输入 <code>&lt;</code> 选择 [4]1:00 对应的数字 4</li>
</ul>
</div>
</div>
<div id="outline-container-h:cf6e0e86-ace6-43a5-94cc-d24663c00fe4" class="outline-5">
<h5 id="h:cf6e0e86-ace6-43a5-94cc-d24663c00fe4">org tags</h5>
<div class="outline-text-5" id="text-h:cf6e0e86-ace6-43a5-94cc-d24663c00fe4">
<p>
在 agenda view 中添加tag, 使用 <code>:</code> , 也可以 <code>M-x org-agenda-set-tags</code> 添加。
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* Daily routine </span><span style="color: #228b22; font-weight: bold;">[100%]</span><span style="color: #0000ff;">                                                             </span><span style="color: #0000ff; font-weight: bold;">:Emacs:Learn:</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:689353b5-7a10-48eb-831e-66482d0eb172" class="outline-5">
<h5 id="h:689353b5-7a10-48eb-831e-66482d0eb172">org priority</h5>
<div class="outline-text-5" id="text-h:689353b5-7a10-48eb-831e-66482d0eb172">
<p>
有三种优先级模式，A-C，若不指定优先级，'B'等级是默认的。
</p>
<ul class="org-ul">
<li><code>C-c ,</code> 或者  <code>M-x org-priority</code>  : 设置当前标题的优先级，键入A-C设置级别，或者键入SPC清除标记</li>
<li id="S-UP/DOWN ">提升/降低当前标题的优先级</li>
</ul>

<p>
设置agenda中优先级A的为“重要且紧急的事”
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-agenda-custom-commands
      '((<span style="color: #8b2252;">"c"</span> <span style="color: #8b2252;">"&#37325;&#35201;&#19988;&#32039;&#24613;&#30340;&#20107;"</span>
         ((tags-todo <span style="color: #8b2252;">"+PRIORITY=\"A\""</span>)))
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">...other commands here</span>
        ))
</pre>
</div>

<p>
查看重要且紧急的事：
</p>
<ul class="org-ul">
<li>进行agenda  视图 <code>C-c a a=，设置优先级A， 按 =,</code>  逗号，输入a。</li>
<li>查看重要且紧急的事，=C-c a c= 展示重要且紧急的事（必须有 TODO 状态）。</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:7403605c-87eb-4208-bbc5-5edc2b148180" class="outline-4">
<h4 id="h:7403605c-87eb-4208-bbc5-5edc2b148180">Org文件以指定的目录深度打开</h4>
<div class="outline-text-4" id="text-h:7403605c-87eb-4208-bbc5-5edc2b148180">
<ul class="org-ul">
<li>参考 <a href="https://emacs-china.org/t/org-startup-show2levels/16499">Org文件以指定的目录深度打开 startup:show2levels</a></li>
</ul>

<p>
org startup的四个选项
</p>

<p>
访问org文件，设置初始的文件目录展示深度，org-manual 提供了四个选项：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+STARTUP: overview top-level headlines only
#+STARTUP: content all headlines
#+STARTUP: showall no folding of any entries
#+STARTUP: showeverything show even drawer contents

org-startup-options is a variable defined in org.el.
Value
 (<span style="color: #8b2252;">"showall"</span> org-startup-folded nil)
 (<span style="color: #8b2252;">"show2levels"</span> org-startup-folded show2levels)
 (<span style="color: #8b2252;">"show3levels"</span> org-startup-folded show3levels)
 (<span style="color: #8b2252;">"show4levels"</span> org-startup-folded show4levels)
 (<span style="color: #8b2252;">"show5levels"</span> org-startup-folded show5levels)

#+STARTUP: show2levels
</pre>
</div>

<p>
其中比较趁手的是前两项 `#+STARTUP: overview` 和 `#+STARTUP: content` 分别只展示一级目录和展示全部的目录。而后面的两项将正文全部展开，不仅会给人铺面而来的压迫感，也不能在第一时间呈现重点。
</p>

<p>
对比前两项 overview 与 content。overview只展示第一级heading，信息量太少，打开满满的一页文本，overview只占前面几行，有点过分单薄。而 content 全部展开 heading，呈现的琐碎细节又太多。
</p>

<p>
配置
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23637;&#24320;&#21040;&#20108;&#32423;&#30446;&#24405;&#30340;&#24037;&#20316;&#27969;</span>
(<span style="color: #a020f0;">setq</span> org-startup-folded 'show2levels)
</pre>
</div>

<p>
<img src="./images/image-20210706160036754.png" alt="image-20210706160036754.png">]]
</p>



<div class="org-src-container">
<pre class="src src-emacs-lisp">#+STARTUP: showall hidestarts
showall&#34920;&#31034;&#23637;&#24320;&#25152;&#26377;&#26631;&#39064;&#65292;hidstarts&#38544;&#34255;&#39069;&#22806;&#30340;&#26143;&#26143;

\* Lesson 1
  Introducing the series and setting up the package mannager
  - Show melpa
  - set up mepla

\* Links
  - [[xuchangwei.com][jasper's Blog]]
</pre>
</div>
</div>
</div>
<div id="outline-container-h:b660e930-6db6-49ee-9619-e3605ee121e8" class="outline-4">
<h4 id="h:b660e930-6db6-49ee-9619-e3605ee121e8">其它操作</h4>
<div class="outline-text-4" id="text-h:b660e930-6db6-49ee-9619-e3605ee121e8">
<p>
<b><b>添加 Org-mode 文本内语法高亮</b></b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org</span>)
(<span style="color: #a020f0;">setq</span> org-src-fontify-natively t)
</pre>
</div>

<p>
在 Org-mode 中重置有序列表序号可以直接使用 M-&lt;RET&gt; 。
</p>

<p>
<b><b>org-ac   org-mode 自动补全</b></b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#40664;&#35748;&#27983;&#35272;&#22120;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq "BROWSER" "chomium-browser")</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">org-mode &#33258;&#21160;&#34917;&#20840;</span>
(<span style="color: #a020f0;">use-package</span> org-ac
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (<span style="color: #a020f0;">progn</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-ac</span>)
    (org-ac/config-default)))
</pre>
</div>

<p>
html高亮
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">html&#39640;&#20142;</span>
(<span style="color: #a020f0;">use-package</span> htmlize
  <span style="color: #483d8b;">:pin</span> melpa
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:defer</span> t
  )
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:e5d9645f-305c-49c5-9710-3ae1a2c19881" class="outline-3">
<h3 id="h:e5d9645f-305c-49c5-9710-3ae1a2c19881">基础介绍</h3>
<div class="outline-text-3" id="text-h:e5d9645f-305c-49c5-9710-3ae1a2c19881">
</div>
<div id="outline-container-h:fccec9c0-d1dd-4104-b574-e17e75ca9c39" class="outline-4">
<h4 id="h:fccec9c0-d1dd-4104-b574-e17e75ca9c39">org能做的事</h4>
<div class="outline-text-4" id="text-h:fccec9c0-d1dd-4104-b574-e17e75ca9c39">
<ol class="org-ol">
<li>记笔记</li>
<li>维护TODO列表</li>
<li>做任务计划</li>
<li>创作及发布</li>
<li>文学编程</li>
</ol>

<p>
<code>org-mode</code> 常用快捷键:
</p>
<ul class="org-ul">
<li><code>&lt;tab&gt;</code> : 展开/折叠光标下标题, 进行如下循环:
"只显示标题" -&gt; "显示子标题" -&gt; "显示子标题内容" -&gt; "只显示标题"</li>
<li><code>&lt;shift&gt;-&lt;tab&gt;</code>: 同时展开/折叠所有标题</li>
<li><code>M-&lt;left&gt;</code> / <code>M-&lt;right&gt;</code> : 当前标题升级/降级</li>
<li><code>M-S-&lt;left&gt;</code> / <code>M-S-&lt;right&gt;</code>: 当前标题及其子标题升级/降级</li>
</ul>
</div>
</div>
<div id="outline-container-h:e040cdf8-c264-4369-93ce-b4021e5a65c2" class="outline-4">
<h4 id="h:e040cdf8-c264-4369-93ce-b4021e5a65c2">安装好org后的可选基础配置</h4>
<div class="outline-text-4" id="text-h:e040cdf8-c264-4369-93ce-b4021e5a65c2">
<div class="org-src-container">
<pre class="src src-shell">(global-set-key (kbd <span style="color: #8b2252;">"C-c l"</span>) <span style="color: #8b2252;">'org-store-link)</span>
<span style="color: #8b2252;">(global-set-key (kbd "C-c a") '</span>org-agenda)
(global-set-key (kbd <span style="color: #8b2252;">"C-c c"</span>) <span style="color: #8b2252;">'org-capture)</span>
</pre>
</div>

<p>
在打开后缀为.org文件后会自动进入org-mode
</p>
</div>
</div>
<div id="outline-container-h:d6397a53-6eaa-438c-be05-0aa8a99b57f9" class="outline-4">
<h4 id="h:d6397a53-6eaa-438c-be05-0aa8a99b57f9">美化插件</h4>
<div class="outline-text-4" id="text-h:d6397a53-6eaa-438c-be05-0aa8a99b57f9">
</div>
<div id="outline-container-h:ee2b6644-bde0-4474-8097-dc98c031972d" class="outline-5">
<h5 id="h:ee2b6644-bde0-4474-8097-dc98c031972d"><a id="org04d4a16"></a>org-bullets 标题星号圆点的插件</h5>
<div class="outline-text-5" id="text-h:ee2b6644-bde0-4474-8097-dc98c031972d">
<ul class="org-ul">
<li>org-bullets <a href="https://github.com/integral-dw/org-bullets">https://github.com/integral-dw/org-bullets</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> org-bullets
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">:custom (org-bullets-bullet-list '("&#9776;" "&#9783;" "&#10047;" "&#9773;")))</span>
  <span style="color: #b22222;">;;</span><span style="color: #b22222;">:init (setq org-ellipsis " &#8744;") ;; &#23558;&#25240;&#21472;&#30340;&#26465;&#30446;&#26368;&#21518;&#30340;...&#26367;&#25442;&#25104;&#24819;&#35201;&#30340;&#31526;&#21495;</span>
  <span style="color: #483d8b;">:hook</span>
  (org-mode . org-bullets-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5497f6e0-6344-4d2e-8237-74cc552da344" class="outline-5">
<h5 id="h:5497f6e0-6344-4d2e-8237-74cc552da344">目录大纲</h5>
<div class="outline-text-5" id="text-h:5497f6e0-6344-4d2e-8237-74cc552da344">
<div class="org-src-container">
<pre class="src src-emacs-lisp">imenu-list
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:20f93915-bf5f-47fd-ae45-987f160451b8" class="outline-4">
<h4 id="h:20f93915-bf5f-47fd-ae45-987f160451b8">org 小技巧</h4>
<div class="outline-text-4" id="text-h:20f93915-bf5f-47fd-ae45-987f160451b8">
</div>
<div id="outline-container-h:2f5bcb63-4994-4099-b39b-eb93349dcd10" class="outline-5">
<h5 id="h:2f5bcb63-4994-4099-b39b-eb93349dcd10">更新文件</h5>
<div class="outline-text-5" id="text-h:2f5bcb63-4994-4099-b39b-eb93349dcd10">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">`C-c C-c` &#22312;org&#25991;&#20214;&#30340;&#39030;&#37096;&#12290;&#23427;&#26356;&#26032;&#25991;&#20214;&#30340;&#26412;&#22320;&#37197;&#32622;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#24674;&#22797;</span>
M-x revert-buffer (&#24674;&#22797;&#21040;&#19978;&#19968;&#27425;&#23384;&#30424;&#26102;)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:3b8988dd-e52f-4a33-923d-9847a9b88a96" class="outline-5">
<h5 id="h:3b8988dd-e52f-4a33-923d-9847a9b88a96">快速选择一个列表</h5>
<div class="outline-text-5" id="text-h:3b8988dd-e52f-4a33-923d-9847a9b88a96">
<p>
`C-c @` org-mark-subtree
</p>
</div>
</div>
</div>
<div id="outline-container-h:084d47f6-ae24-4ce5-aa17-bec2424c54ef" class="outline-4">
<h4 id="h:084d47f6-ae24-4ce5-aa17-bec2424c54ef">org的编号</h4>
<div class="outline-text-4" id="text-h:084d47f6-ae24-4ce5-aa17-bec2424c54ef">
<ul class="org-ul">
<li>在org mode中显示每个列表的编号</li>
</ul>
<p>
org-num-mode
</p>

<ul class="org-ul">
<li>在导出的org文件中不显示编号</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">#+OPTIONS: num:nil toc:nil  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21435;&#38500;&#21015;&#34920;&#32534;&#21495;&#12289;&#30446;&#24405;</span>
</pre>
</div>
</div>
<div id="outline-container-h:112731c2-3bf6-431c-9915-2379ffff1f2e" class="outline-5">
<h5 id="h:112731c2-3bf6-431c-9915-2379ffff1f2e">org 格式化</h5>
<div class="outline-text-5" id="text-h:112731c2-3bf6-431c-9915-2379ffff1f2e">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #b22222;"># </span><span style="color: #b22222;">/&#23383;&#31526;&#20018;/ &#26012;&#20307;&#27809;&#26377;/ /</span>
(setq-default org-hide-emphasis-markers t)

 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#33258;&#21160;&#25442;&#34892;</span>
(add-hook <span style="color: #8b2252;">'org-mode-hook (lambda () (setq truncate-lines nil)))</span>
</pre>
</div>

<p>
utf8格式编辑
</p>

<p>
打开文件时出现乱码，修改字符集编码 <code>M-x revert-buffer-with-coding-system</code>
</p>

<p>
保存时也可以指定文件保存编码 <code>M-x set-buffer-file-coding-system</code>
</p>
</div>
</div>
<div id="outline-container-h:2ae0fc53-cce2-4de8-bc79-791da6e34ae6" class="outline-5">
<h5 id="h:2ae0fc53-cce2-4de8-bc79-791da6e34ae6">导出 html 优化</h5>
<div class="outline-text-5" id="text-h:2ae0fc53-cce2-4de8-bc79-791da6e34ae6">
<p>
默认每行间是要空一行的，如果2个紧挨着的行导出html时，html中换行变成了空格，解决
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#22312;&#25991;&#20214;&#24320;&#22836;&#21152;&#19978; #+OPTIONS: \n:t &#25110;&#32773; (<span style="color: #a020f0;">setq</span> org-export-preserve-breaks t)
</pre>
</div>

<p>
导出中禁用下划线转义
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">#+OPTIONS: ^:nil &#25110;&#32773; (<span style="color: #a020f0;">setq</span> org-export-with-sub-superscripts nil)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a2d92613-03cf-43bb-9111-31bf6a8e2ddd" class="outline-5">
<h5 id="h:a2d92613-03cf-43bb-9111-31bf6a8e2ddd">利用abbrev mode 快速输入重复文本</h5>
<div class="outline-text-5" id="text-h:a2d92613-03cf-43bb-9111-31bf6a8e2ddd">
<p>
参考：李杀网 <a href="http://xahlee.info/emacs/emacs/emacs_abbrev_mode.html">http://xahlee.info/emacs/emacs/emacs_abbrev_mode.html</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21035;&#21517;</span>
(clear-abbrev-table global-abbrev-table)
(define-abbrev-table 'global-abbrev-table '(
                        <span style="color: #b22222;">;; </span><span style="color: #b22222;">signature</span>
                        (<span style="color: #8b2252;">"hugoexp"</span> <span style="color: #8b2252;">":PROPERTIES:\n:EXPORT_FILE_NAME: index\n:END:"</span>)
                        <span style="color: #b22222;">;; </span><span style="color: #b22222;">Microsoft</span>
                        (<span style="color: #8b2252;">"8ms"</span> <span style="color: #8b2252;">"Microsoft"</span>)
                        ))
(<span style="color: #a020f0;">setq-default</span> abbrev-mode t)
(seq save-abbrevs nil)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36755;&#20837;8ms&#31354;&#26684;&#65292;&#23601;&#34917;&#20840;&#20986;Microsoft  &#31354;&#26684;&#20063;&#21487;&#20197;&#25442;&#25104;&#38750;26&#20010;&#23383;&#27597; &#12290;&#19981;&#23637;&#24320;&#21407;&#26679;&#26174;&#31034;&#20351;&#29992;C-q &#31354;&#26684;</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-h:0183db70-c900-436e-bede-acda1dc5174d" class="outline-3">
<h3 id="h:0183db70-c900-436e-bede-acda1dc5174d">文档结构</h3>
<div class="outline-text-3" id="text-h:0183db70-c900-436e-bede-acda1dc5174d">
<p>
Org是基于大纲的一种工具，大纲模式的好处是可以很好的记录笔记和临时的想法，还可以通过折叠来隐藏不需要查看的内容。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21487;&#20197;&#36890;&#36807;&#27492;&#21629;&#20196;&#25110;&#24555;&#25463;&#38190;TAB&#36827;&#34892;&#26174;&#31034;&#21644;&#38544;&#34255;&#20869;&#23481;</span>
(org-cycle)
</pre>
</div>
</div>
<div id="outline-container-h:0f7437c5-c2c5-4d46-a479-9efa62e47e3d" class="outline-4">
<h4 id="h:0f7437c5-c2c5-4d46-a479-9efa62e47e3d">标题</h4>
<div class="outline-text-4" id="text-h:0f7437c5-c2c5-4d46-a479-9efa62e47e3d">
<p>
在 Org mode 中，文档内容是通过 headline 来组织成一个树状结构的 —— 由于在 Org mode 中还存在 "title" 这种文章级的标题，为避免混淆，就不对 "headline" 进行翻译了，我们只要知道这几点就行:
</p>

<ol class="org-ol">
<li>headline 是一节内容的标题(概要)</li>
<li>headline 可以分级</li>
<li>headline 可以有子 headline</li>
</ol>

<p>
headline 在 Org mode 中会被高亮显示，且不同级别的 headline 会以不同的颜色显示。
</p>

<p>
要创建 headline 也很简单，只要一行文字以若干个连续星号(*)顶格，并在星号结束后跟随至少一个空格，则该行会被视为一个 headline ，连续星号的数量被视为 headline 的层级。
</p>

<p>
Org用*号表示标题的层级关系，就像这样:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* &#26631;&#39064;&#19968;
  &#19968;&#20123;&#25991;&#23383;
\** &#23376;&#26631;&#39064;1
   &#23376;&#26631;&#39064;1&#30340;&#20869;&#23481;
\** &#23376;&#26631;&#39064;2
   &#23376;&#26631;&#39064;2&#30340;&#20869;&#23481;
\* &#26631;&#39064;&#20108;
  &#26631;&#39064;&#20108;&#30340;&#20869;&#23481;
\** &#23376;&#26631;&#39064;1
   &#23376;&#26631;&#39064;1&#30340;&#20869;&#23481;
</pre>
</div>
</div>
<div id="outline-container-h:b9376d8d-a045-4111-8aeb-9c218a0b2bcb" class="outline-5">
<h5 id="h:b9376d8d-a045-4111-8aeb-9c218a0b2bcb">其他</h5>
<div class="outline-text-5" id="text-h:b9376d8d-a045-4111-8aeb-9c218a0b2bcb">
<p>
标题的标题是啥？
</p>

<p>
标题的标题叫脚注，后面会讲，其中一个功能就是会在被导出时忽略掉
</p>

<p>
不想看那么多星星咋办？
</p>

<p>
后面也会讲到，不过这里可以提前说一下:
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">+STARTUP: hidestars odd</span>
<span style="color: #8b2252;">\*</span> &#26631;&#39064;&#19968;
  &#19968;&#20123;&#25991;&#23383;
<span style="color: #8b2252;">\*</span>* &#23376;&#26631;&#39064;1
   &#23376;&#26631;&#39064;1&#30340;&#20869;&#23481;
<span style="color: #8b2252;">\*</span>* &#23376;&#26631;&#39064;2
   &#23376;&#26631;&#39064;2&#30340;&#20869;&#23481;
<span style="color: #8b2252;">\*</span> &#26631;&#39064;&#20108;
  &#26631;&#39064;&#20108;&#30340;&#20869;&#23481;
<span style="color: #8b2252;">\*</span>* &#23376;&#26631;&#39064;1
   &#23376;&#26631;&#39064;1&#30340;&#20869;&#23481;
</pre>
</div>

<p>
代码高亮文字两边使用等号
</p>
</div>
</div>
</div>
<div id="outline-container-h:b33da071-a8ec-4404-a4a0-78c7f851202d" class="outline-4">
<h4 id="h:b33da071-a8ec-4404-a4a0-78c7f851202d">不同的显示样式</h4>
<div class="outline-text-4" id="text-h:b33da071-a8ec-4404-a4a0-78c7f851202d">
<p>
大纲模式可以隐藏缓冲区里的部分正文。Org 用绑定到 TAB 和 S-TAB 上的两个全命令来改变视图
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">TAB</td>
<td class="org-left">子树循环：当加上一个前缀参数时（C-u TAB），在下面的状态中改变当前子树的视图</td>
</tr>

<tr>
<td class="org-left">---------------</td>
<td class="org-left">------------------------------------------------------------</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">FOLDED折叠 -&gt; CHILDREN儿童 -&gt; SUBTREE子树</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">当加上shift键时会触发全局的视图循环。</td>
</tr>

<tr>
<td class="org-left">S-TAB和C-u TAB</td>
<td class="org-left">全局循环：使整个缓冲区在下列状态中循环 （这里的S-，是Shift）</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">OVERVIEW概览 -&gt; CONTENTS目次 -&gt; SHOWALL全部显示</td>
</tr>

<tr>
<td class="org-left">C-u C-u C-u TAB</td>
<td class="org-left">显示全部，直接切换为SHOW ALL显示模式，包括drawers。</td>
</tr>
</tbody>
</table>

<p>
`C-c C-c`当前文件生效
</p>

<p>
其他
</p>

<p>
Org打开一个文件时默认为**概览**模式，想要设置打开一个文件后的显示模式可以设置变量`org-startuop-folded`：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#38750;&#31354;&#24847;&#21619;&#30528;&#27010;&#35272;OVERVIEW&#65292;nil&#24847;&#21619;&#30528;&#20840;&#37096;&#26174;&#31034;SHOW ALL</span>
(<span style="color: #a020f0;">setq</span> org-startup-folded t)
</pre>
</div>

<p>
如果要针对单独的org文件配置，可以在org文件开头设置:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+STARTUP: overview
</pre>
</div>

<p>
可选参数有:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+STARTUP: overview <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#40664;&#35748;&#65292;&#21482;&#26174;&#31034;&#19968;&#32423;&#26631;&#39064;</span>
#+STARTUP: content  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#25152;&#26377;&#26631;&#39064;</span>
#+STARTUP: showall  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#25152;&#26377;&#20869;&#23481;</span>
#+STARTUP: show2levels
#+STARTUP: show3levels
#+STARTUP: show4levels
#+STARTUP: show5levels
#+STARTUP: showeverything <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;drawer&#20869;&#23481;</span>
#+STARTUP: indent
</pre>
</div>

<p>
drawer示例
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">+STARTUP: indent showeverything</span>
<span style="color: #8b2252;">\*</span> CD collection
<span style="color: #8b2252;">\*</span>* Classic
<span style="color: #8b2252;">\*</span>** Goldberg Variations
    :PROPERTIES:
    :Title:     Goldberg Variations
    :Composer:  J.S. Bach
    :Artist:    Glenn Gould
    :Publisher: Deutsche Grammophon
    :NDisks:    1
    :END:
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5cd90aa4-e750-4c97-aacf-5ab2c0f07386" class="outline-4">
<h4 id="h:5cd90aa4-e750-4c97-aacf-5ab2c0f07386">移动相关</h4>
<div class="outline-text-4" id="text-h:5cd90aa4-e750-4c97-aacf-5ab2c0f07386">
<p>
以下是关于在标题间跳转的命令
</p>

<div class="org-src-container">
<pre class="src src-shell">C-c C-n &#19979;&#19968;&#20010;&#26631;&#39064; 
C-c C-p &#19978;&#19968;&#20010;&#26631;&#39064; 
C-c C-f &#19979;&#19968;&#20010;&#21516;&#32423;&#26631;&#39064; 
C-c C-b &#19978;&#19968;&#20010;&#21516;&#32423;&#26631;&#39064; 
C-c C-u &#36339;&#36716;&#21040;&#29238;&#32423;&#30446;&#24405;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:fbe96a03-b683-4da0-9351-65c6c732ae42" class="outline-4">
<h4 id="h:fbe96a03-b683-4da0-9351-65c6c732ae42">结构编辑</h4>
<div class="outline-text-4" id="text-h:fbe96a03-b683-4da0-9351-65c6c732ae42">
<div class="org-src-container">
<pre class="src src-shell">M-RET          &#21019;&#24314;&#21516;&#32423;&#21035;&#30340;&#26032;&#26631;&#39064;&#65288;&#22914;&#26524;&#22312;&#19968;&#20010;&#21015;&#34920;&#39033;&#20013;&#65292;&#21017;&#20250;&#21019;&#24314;&#26032;&#30340;&#21015;&#34920;&#39033;/&#22914;&#26524;&#22312;&#26576;&#19968;&#34892;&#20013;&#38388;&#38190;&#20837;&#65292;&#23558;&#20250;&#23558;&#20854;&#20998;&#21106;&#24182;&#21019;&#24314;&#26032;&#30340;&#26631;&#39064;&#65289;&#12290;
C-RET          &#22312;&#24403;&#21069;&#23376;&#26641;&#26411;&#23614;&#28155;&#21152;&#26032;&#30340;&#26631;&#39064;
M-S-RET        &#21019;&#24314;&#21516;&#32423;&#21035;&#30340;TODO&#26465;&#30446;
C-S-RET        &#25554;&#20837;&#19982;&#24403;&#21069;&#26631;&#39064;&#32423;&#21035;&#30456;&#21516;&#30340;&#26032; TODO &#26465;&#30446;&#12290;&#19982; C-RET &#19968;&#26679;&#65292;&#26032;&#26631;&#39064;&#25554;&#20837;&#22312;&#24403;&#21069;&#23376;&#26641;&#20043;&#21518;
TAB            &#24490;&#29615;&#25913;&#21464;&#26410;&#25351;&#23450;&#26631;&#39064;&#21517;&#30340;&#26631;&#39064;&#30340;&#26631;&#39064;&#31561;&#32423;
M_LEFT/RIGHT   &#23558;&#24403;&#21069;&#26631;&#39064;&#25552;&#21319;&#25110;&#38477;&#32423;
M_UP/DOWN      &#19978;&#19979;&#20132;&#25442;&#21516;&#32423;&#21035;
C-c C-w        &#23558;&#24403;&#21069;&#26465;&#30446;&#25918;&#32622;&#19982;&#25351;&#23450;&#26465;&#30446;&#19979;
C-x n s/w      &#20197;&#24403;&#21069;&#23376;&#39033;&#20026;&#21333;&#20301;&#36827;&#34892;&#21464;&#31364;&#21644;&#21464;&#23485;

C-c @          &#20840;&#36873;&#26631;&#39064;&#19979;&#25152;&#26377;&#20869;&#23481;
<span style="color: #0000ff;">C-y</span> (org-yank) &#31896;&#36148;
C-c C-x c      &#22797;&#21046;&#24403;&#21069;&#26631;&#39064;&#21450;&#20869;&#23481;&#65292;&#24182;&#31896;&#36148;&#19979;&#38754;

</pre>
</div>
</div>
<div id="outline-container-h:e74b3a65-ceee-4f4a-b46b-d1acbcd73aca" class="outline-5">
<h5 id="h:e74b3a65-ceee-4f4a-b46b-d1acbcd73aca">文本</h5>
<div class="outline-text-5" id="text-h:e74b3a65-ceee-4f4a-b46b-d1acbcd73aca">
<ul class="org-ul">
<li>居中</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">+BEGIN_CENTER</span>
&#19987;    &#19994;&#65306;       &#36719;&#20214;&#24037;&#31243;       
<span style="color: #b22222;">#</span><span style="color: #b22222;">+END_CENTER</span>
</pre>
</div>

<ul class="org-ul">
<li><p>
粗体
</p>
<div class="org-src-container">
<pre class="src src-shell">&#31895;&#20307; &#29992;&#20004;&#20010;&#26143;&#21495;&#21253;&#35065;&#65292;&#26143;&#21495;&#19982;&#31895;&#20307;&#21069;&#21518;&#30340;&#20854;&#20182;&#23383;&#24212;&#35813;&#21508;&#26377;&#33267;&#23569;&#19968;&#20010;&#31354;&#26684;&#25110;&#33521;&#25991;&#26631;&#28857;&#20998;&#38548;&#24320;&#26469;
bold,word,&#29992;&#33521;&#25991;&#36887;&#21495;&#20998;&#38548;&#24320;&#65292;bold&#26174;&#31034;&#20986;&#31895;&#20307;&#25928;&#26524;
*bold*word&#21017;&#19981;&#26174;&#31034;&#31895;&#20307;&#25928;&#26524;
</pre>
</div></li>

<li><p>
斜体
</p>

<div class="org-src-container">
<pre class="src src-shell">hello &#29992;<span style="color: #8b2252;">""</span>&#21253;&#35065;&#65292;&#35268;&#21017;&#21516;&#31895;&#20307;
&#26012;&#20307; &#22909;&#20687;&#23545;&#20013;&#25991;&#19981;&#31649;&#29992;?&#23548;&#20986;&#25104;HTML&#26102;&#30475;&#21040;&#36824;&#26159;&#29983;&#25928;&#20102;&#65292;&#21487;&#33021;&#26159;&#23383;&#20307;&#20851;&#31995;&#21543;
</pre>
</div></li>

<li><p>
下划线
</p>

<div class="org-src-container">
<pre class="src src-shell">&#19979;&#21010;&#32447; &#29992;<span style="color: #8b2252;">"_"</span>&#22312;&#21069;&#21518;&#21253;&#35065;&#65292;&#35268;&#21017;&#21516;&#31895;&#20307;
_&#19979;&#21010;&#32447;_&#32039;&#36319;&#20854;&#20182;&#23383;&#65292;&#21017;&#19981;&#29983;&#25928;
</pre>
</div></li>

<li><p>
删除线
</p>

<div class="org-src-container">
<pre class="src src-shell">&#21024;&#38500;&#32447; &#29992;<span style="color: #8b2252;">"+"</span>&#22312;&#21069;&#21518;&#21253;&#35065;&#65292;&#35268;&#21017;&#21516;&#31895;&#20307;
</pre>
</div></li>

<li><p>
引用块
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+BEGIN_QUOTE
&#24341;&#29992;&#20869;&#23481;
#+END_QUOTE
</pre>
</div>

<p>
在org文件中输入"&lt;q"然后按 TAB 键会自动插入一个引用块，插入后在其中进行编辑即可。
</p></li>

<li><p>
示例块
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+Begin_EXAMPLE
&#31034;&#20363;
#+END_EXAMPLE
</pre>
</div>

<p>
在org文件中输入 "&lt;e" 然后按 TAB 键来插入一个示例块，可以移动到其中并使用快捷键"C-'(单引号)"来在新窗格中编辑它，编辑好后用同样的快捷键来保存。
</p></li>

<li><p>
代码块
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\#+BEGIN_SRC C++
#include &lt;iostream&gt;

using namespace std<span style="color: #b22222;">;</span>

int main(int argc, char *argv)
{
    cout &lt;&lt; <span style="color: #8b2252;">"&#20195;&#30721;&#22359;"</span> &lt;&lt; endl<span style="color: #b22222;">;</span>

    return 0<span style="color: #b22222;">;</span>
}
\#+END_SRC
</pre>
</div></li>
</ul>





<ul class="org-ul">
<li>旧版使用快捷键 `&lt; + 快捷码 + TAB`。如代码块  `&lt;s + Tab` 可以直接插入代码块的代码片段（Snippet）</li>

<li>从orgmode 9.2后，`org-insert-structure-template`变为 `C-c C-,`给出列表选择，src代码可以用`C-c C-, s`</li>

<li><p>
还想使用旧版快捷键
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-tempo</span>)
</pre>
</div></li>
</ul>



<p>
更多类似的代码片段 （Org-mode Easy Templates）可以在<a href="http://orgmode.org/manual/Easy-Templates.html">这里</a>找到。
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">快捷码</td>
<td class="org-left">补全内容</td>
<td class="org-left">描述</td>
</tr>

<tr>
<td class="org-left">:-----</td>
<td class="org-left">:-----------------------------------</td>
<td class="org-left">:----------------------------------------</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-left">#+BEGIN_SRC\n\n#+END_SRC</td>
<td class="org-left">插入代码块 C-c C-, s</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">#+BEGIN_EXAMPLE\n\n#+END_EXAMPLE</td>
<td class="org-left">插入例子</td>
</tr>

<tr>
<td class="org-left">q</td>
<td class="org-left">#+BEGIN_QUOTE\n\n#+END_QUOTE</td>
<td class="org-left">插入引用</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">#+BEGIN_VERSE\n\n#+END_VERSE</td>
<td class="org-left">默认内容不换行，需要留出空行才能换行</td>
</tr>

<tr>
<td class="org-left">c</td>
<td class="org-left">#+BEGIN_CENTER\n\n#+END_CENTER</td>
<td class="org-left">内容居中</td>
</tr>

<tr>
<td class="org-left">l</td>
<td class="org-left">#+BEGIN_EXPORT latex\n\n#+END_EXPORT</td>
<td class="org-left">直接导出 latex</td>
</tr>

<tr>
<td class="org-left">L</td>
<td class="org-left">#+LaTeX:</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">#+BEGIN_EXPORT html\n\n#+END_EXPORT</td>
<td class="org-left">直接导出 html</td>
</tr>

<tr>
<td class="org-left">H</td>
<td class="org-left">#+HTML:</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">#+BEGIN_EXPORT ascii\n\n#+END_EXPORT</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">A</td>
<td class="org-left">#+ASCII:</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">i</td>
<td class="org-left">#+INDEX:</td>
<td class="org-left">包含文件到 org 中</td>
</tr>

<tr>
<td class="org-left">I</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">状态栏下面弹出一个 buffer，选择包含的文件</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">\#</span>+BEGIN_SRC emacs-lisp
  ;; Your code goes here
  ;; &#20320;&#30340;&#20195;&#30721;&#20889;&#22312;&#36825;&#37324;
<span style="color: #8b2252;">\#</span>+END_SRC
</pre>
</div>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\#+BEGIN_SRC emacs-lisp
(+ 2 22)   <span style="color: #b22222;">;;</span><span style="color: #b22222;">&#36825;&#37324;&#20351;&#29992;C-x C-e&#25191;&#34892;&#65292;&#20132;&#20114;&#21306;&#20250;&#26174;&#31034;&#20986;&#32467;&#26524;24&#12290;&#20351;&#29992;C-c C-c &#36755;&#20837;yes&#20250;&#22312;&#20869;&#23481;&#37324;&#28155;&#21152;=+RESULTS&#24182;&#36755;&#20986;&#32467;&#26524;</span>
\#+END_SRC

\#+RESULTS:
: 24
</pre>
</div>

<p>
独立窗口修改：选中代码块，使用 `C-c '` 会直接打开对应模式的缓冲区，使用 `C-c '` 完成修改
当导出文档时，你可以包含其他文件中的内容。比如，想包含你的“.emacs”文件，你可以用：
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #b22222;">#</span><span style="color: #b22222;">+INCLUDE: "~/.emacs.d/test.el" src emacs-lisp</span>
</pre>
</div>

<p>
可选的第二个第三个参数是组织方式（例如，“quote”，“example”，或者“src”），如果是 “src”，语言用来格式化内容。
组织方式是可选的，如果不给出，文本会被当作 Org 模式的正常处理。用快捷键 `&lt;C-c ,&gt;` 可以访问包含的文件。
</p>

<p>
自定义
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#30452;&#25509; =&lt;el TAB &#23601;&#21487;&#20197;&#36755;&#20837;emacs lisp&#22359;</span>
(add-to-list 'org-structure-template-alist '(<span style="color: #8b2252;">"el"</span>, <span style="color: #8b2252;">"src emacs-lisp"</span>))
</pre>
</div>



<p>
其他
</p>

<p>
如果在创建统计目录的新标题时不想被`M-RET`分割标题可以定制变量`org-M-RET-may-split-line`，例子（具体请查看文档）:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#40664;&#35748;&#19981;&#20998;&#21106;</span>
(<span style="color: #a020f0;">setq</span> org-M-RET-may-split-line '((headline . nil)))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:0382369b-7a14-468b-9751-a8a4a9dfb304" class="outline-4">
<h4 id="h:0382369b-7a14-468b-9751-a8a4a9dfb304">Sparse Trees稀疏树</h4>
<div class="outline-text-4" id="text-h:0382369b-7a14-468b-9751-a8a4a9dfb304">
<p>
org有关很重要的功能，根据选定的信息构建Sparse Trees
</p>

<div class="org-src-container">
<pre class="src src-shell">C-c /    &#36825;&#20250;&#25552;&#31034;&#20320;&#35201;&#20351;&#29992;&#21738;&#20123;Sparse Trees&#30340;&#21629;&#20196;
C-c / r  &#20351;&#29992;&#27491;&#21017;&#21305;&#37197;&#65292;&#25152;&#26377;&#21487;&#21305;&#37197;&#30340;Sparse Trees&#65292;&#21305;&#37197;&#21040;&#30340;&#20250;&#39640;&#20142;&#65292;&#38190;&#20837;C-c C-c&#21462;&#28040;&#39640;&#20142;&#12290;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5a56faf3-01e5-476c-9355-4dac9ee84795" class="outline-4">
<h4 id="h:5a56faf3-01e5-476c-9355-4dac9ee84795">清单列表</h4>
<div class="outline-text-4" id="text-h:5a56faf3-01e5-476c-9355-4dac9ee84795">
<p>
我们不仅可以创建标题样的条目，还能创建例如：复选框，有序无序列表。
</p>

<p>
*有序无须列表的创建方式*：
</p>

<div class="org-src-container">
<pre class="src src-shell">&#26080;&#24207;&#21015;&#34920;&#65306;&#20197; - * + &#23383;&#31526;&#24320;&#22836;
&#26377;&#24207;&#21015;&#34920;&#65306;&#20197; 1. 1) &#23383;&#31526;&#24320;&#22836;

&#21487;&#20197;&#25351;&#23450;&#21015;&#34920;&#30340;&#35828;&#26126;&#65292;&#29992;&#8220;::&#8221;&#19982;&#26465;&#30446;&#26631;&#39064;&#19982;&#35828;&#26126;&#38548;&#24320;
</pre>
</div>

<p>
同一个列表的项目的第一行必须是相同的缩进，下面是一些例子:
</p>

<ul class="org-ul">
<li>西游记观后感 我最喜欢的场景有（顺序）</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">1. &#19977;&#25171;&#30333;&#39592;&#31934;
2. &#22899;&#20799;&#22269;
   + &#35201;&#25105;&#26159;&#21776;&#20711;&#21487;&#33021;&#23601;&#30041;&#19979;&#26469;&#20102;
   + &#21487;&#24796;&#25105;&#19981;&#26159;&#65292;&#21704;&#21704;&#21704;
&#25105;&#26368;&#21916;&#27426;&#30340;&#35282;&#33394;&#26377;
- &#22914;&#26469;&#20315;&#31062; <span style="color: #483d8b;">::</span> &#36319;&#25105;&#29240;&#30340;&#20307;&#22411;&#26377;&#24471;&#19968;&#25340;
- &#23385;&#24735;&#31354; <span style="color: #483d8b;">::</span> &#22909;&#19968;&#20010;&#40784;&#22825;&#22823;&#22307;&#65281;
</pre>
</div>

<ul class="org-ul">
<li>下面是一些按键的介绍:</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">TAB          <span style="color: #483d8b;">::</span> &#31867;&#20284;&#20110;&#26631;&#39064;&#30340;&#25240;&#21472;
M-RET        <span style="color: #483d8b;">::</span> &#26032;&#24314;&#21516;&#32423;&#39033;&#65292;&#22914;&#26524;&#35201;&#25913;&#21464;&#26465;&#30446;&#31867;&#22411;&#65292;&#21487;&#20197;&#20351;&#29992;&#21069;&#32512;&#21442;&#25968;
M-S_RET      <span style="color: #483d8b;">::</span> &#26032;&#24314;&#24102;&#26377;&#22797;&#36873;&#26694;&#30340;&#21516;&#32423;&#39033;
S-UP/DOWN    <span style="color: #483d8b;">::</span> &#22312;&#21015;&#34920;&#20869;&#19978;&#19979;&#36873;&#25321;
M-S-UP/DOWN  <span style="color: #483d8b;">::</span> &#19978;&#19979;&#31227;&#21160;&#24403;&#21069;&#39033;&#65292;&#22914;&#26524;&#26159;&#26377;&#24207;&#30340;&#36824;&#20250;&#33258;&#21160;&#32534;&#21495;&#12290;
M-LEFT/RIGHT <span style="color: #483d8b;">::</span> &#23558;&#24403;&#21069;&#39033;&#38477;&#32423;&#25110;&#32773;&#21319;&#32423;
C-c C-c      <span style="color: #483d8b;">::</span> &#21246;&#36873;&#22797;&#36873;&#26694;

S-LEFT/RIGHT <span style="color: #483d8b;">::</span> &#24490;&#29615;&#20462;&#25913;&#24403;&#21069;&#39033;&#30340;&#26465;&#30446;&#31526;&#21495;
C-c -        <span style="color: #483d8b;">::</span> &#24490;&#29615;&#20462;&#25913;&#24403;&#21069;&#39033;&#30340;&#26465;&#30446;&#31526;&#21495;('<span style="color: #008b8b;">-</span>','<span style="color: #008b8b;">+</span>','<span style="color: #008b8b;">*</span>','<span style="color: #008b8b;">1.</span>','1)')
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:d8d2336e-1fd9-4909-956d-401bb4b7f46b" class="outline-3">
<h3 id="h:d8d2336e-1fd9-4909-956d-401bb4b7f46b">表格</h3>
<div class="outline-text-3" id="text-h:d8d2336e-1fd9-4909-956d-401bb4b7f46b">
<p>
<a href="https://orgmode.org/manual/Tables.html">emacs org-mode 表格官方参考手册</a>
</p>

<p>
<a href="https://orgmode.org/worg/org-tutorials/tables.html">Org tutorial for tables</a>
</p>

<p>
<a href="https://orgmode.org/worg/org-tutorials/org-lookups.html">Org tutorial on table lookup functions</a>
</p>

<p>
<a href="https://orgmode.org/worg/org-symbols.html">org-mode 字符转义</a>
</p>

<p>
<a href="http://www.zmonster.me/2016/06/03/org-mode-table.html">表格基本操作&amp;公式&amp;绘图</a>
</p>

<p>
博客参考 ：<a href="http://www.langdebuqing.com/emacs%20notebook/org-mode%20%E8%A1%A8%E6%A0%BC.html">http://www.langdebuqing.com/emacs%20notebook/org-mode%20%E8%A1%A8%E6%A0%BC.html</a>
</p>

<p>
Org带有一个快速直观的表格编辑器，如果与Emacs的`calc`包一起使用可以实现类似电子表格的计算。
</p>
</div>
<div id="outline-container-h:6adc5bc1-9810-4b0d-9863-0565669efbe1" class="outline-4">
<h4 id="h:6adc5bc1-9810-4b0d-9863-0565669efbe1">表格的创建</h4>
<div class="outline-text-4" id="text-h:6adc5bc1-9810-4b0d-9863-0565669efbe1">
<p>
org 表格中有 | 字符，怎么才能原样显示，不解析:
</p>
<div class="org-src-container">
<pre class="src src-sh">\vert{} &#20195;&#26367;
&#19968;&#31181;&#26041;&#27861;&#26159;&#29992;LaTeX&#65306;\textbar
</pre>
</div>

<ul class="org-ul">
<li><p>
想要创建一个表格分为以下几步
</p>

<ol class="org-ol">
<li><p>
先创建列名
</p>

<p>
利用 "第一个非空白符号是 | 的行被视作表格行" 这个特性，手动创建表格也是非常方便的。首先手动完成第一行，确定表格有多少列，然后按下 TAB 键就能自动在下一行插入新一行表格行了，
</p>

<div class="org-src-container">
<pre class="src src-shell">| name     | age | tel |
</pre>
</div></li>

<li><p>
创建分割线
</p>

<p>
一种办法是新起一行，对齐后输入 "|-" ，即一个列分隔附跟一个连字符，然后按 TAB 键，就会补全成为这样的样式了
</p>

<p>
第二种办法是使用 "C-c -" 这个快捷键来快速插入
</p>

<div class="org-src-container">
<pre class="src src-shell">| name | tel | age |
|------+-----+-----|

| name | tel | age|
| - 
  |
  - - &gt; TAB
</pre>
</div></li>

<li>按TAB或RET新建行</li>
</ol>

<p>
除了手动创建表格，还可以通过 "C-c |" 这个快捷键来快速创建指定大小的表格。使用这个快捷键后，会提示输入创建的表格的大小，默认是5x2也就是5列2行的，且其中一行是 header。
</p>

<p>
第三种创建方法是直接将 buffer 上已有的数据格式化成表格，比如如果是以逗号(,)分隔的 CSV 格式的数据，可以将其拷贝到当前在编辑的 Org mode 文档中，选中，然后使用 "C-c |" 这个快捷键，就能将其转换成表格形式，
</p>

<p>
如果数据之间是用空格分隔的，该如何转换呢?选中后使用快捷键"C-u 1 C-c |"即可。
</p></li>
</ul>

<p>
更进一步的，Org mode 提供了 "org-table-import" 这个命令来将外部文件导入到 Org mode 文档中并用它来创建表格，与之对应的，命令 "org-table-export" 则能将Org mode 文档中的表格导出成文件。文件格式可以是 CSV 的，也可以是以制表符(TAB)或空白字符作为分隔符的。
</p>

<p>
选中`org-table-convert-region`转换为表格
</p>

<p>
如：选中下列执行表格转换
</p>

<div class="org-src-container">
<pre class="src src-shell">id,sex,age,comment
1,man,18,hello world
2,man,19,hello world
3,man,20,hello world
4,man,21,hello world
5,man,22,hello world
</pre>
</div>

<p>
org-mode 对表格的支持也非常棒，比如可以使用 `org-table-transpose-table-at-point` 命令将表格的行列调换过来。
</p>
</div>
</div>
<div id="outline-container-h:4b3a9a1e-59d7-4f71-a094-2a1f1cbbc35d" class="outline-4">
<h4 id="h:4b3a9a1e-59d7-4f71-a094-2a1f1cbbc35d">按键说明</h4>
<div class="outline-text-4" id="text-h:4b3a9a1e-59d7-4f71-a094-2a1f1cbbc35d">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#21019;&#24314;&#21644;&#36716;&#25442;</span>
C-c | (org-table-create-or-convert-from-region)  :: &#23558;&#27963;&#21160;&#21306;&#22495;&#36716;&#25442;&#20026;&#34920;&#26684;&#12290;&#22914;&#26524;&#26159;&#20197;&#36887;&#21495;(,)&#20998;&#38548;&#30340; CSV &#26684;&#24335;&#30340;&#25968;&#25454;&#21487;&#20197;&#30452;&#25509;&#36716;&#25442;

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#37325;&#26032;&#23545;&#20934;&#21644;&#22330;&#36816;&#21160;</span>
C-c C-c (org-table-align)                        :: &#37325;&#26032;&#23545;&#40784;&#34920;&#26684;
<span style="color: #0000ff;">TAB</span> (org-table-next-field)                       :: &#37325;&#26032;&#23545;&#40784;&#34920;&#26684;/&#31227;&#21160;&#21040;&#19979;&#19968;&#20010;&#21333;&#20803;&#26684;/&#21019;&#24314;&#26032;&#34892;
<span style="color: #0000ff;">S-TAB</span> (org-table-previous-field)                 :: &#37325;&#26032;&#23545;&#40784;&#34920;&#26684;/&#31227;&#21160;&#21040;&#19978;&#19968;&#20010;&#21333;&#20803;&#26684;&#24182;&#32534;&#36753;&#26367;&#25442;
<span style="color: #0000ff;">RET</span> (org-table-next-row)                         :: &#37325;&#26032;&#23545;&#40784;&#34920;&#26684;&#65292;&#24182;&#31227;&#21160;&#21040;&#19979;&#19968;&#34892;/&#21019;&#24314;&#26032;&#34892;

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#21644;&#34892;&#32534;&#36753;</span>
<span style="color: #0000ff;">S-UP/DOWN/LEFT/RIGHT</span> (org-table-move-cell-{up|down|left|right})   :: &#20132;&#25442;&#21333;&#20803;&#26684;&#20026;&#19978;&#19979;&#24038;&#21491;&#30340;&#21333;&#20803;&#26684;
<span style="color: #0000ff;">M-LEFT/RIGHT</span> (org-table-move-column-{left|right})                 :: &#20132;&#25442;&#21015;&#20026;&#24038;&#36793;&#25110;&#21491;&#36793;&#30340;&#21015;
<span style="color: #0000ff;">M-S-LEFT</span> (org-table-delete-column)                                :: &#21024;&#38500;&#24403;&#21069;&#21015;
<span style="color: #0000ff;">M-S-RIGHT</span> (org-table-insert-column)                               :: &#21521;&#21491;&#25554;&#20837;&#26032;&#21015;
<span style="color: #0000ff;">M-UP/DOWN</span> (org-table-move-row-{up|down})                          :: &#19978;&#19979;&#31227;&#21160;&#24403;&#21069;&#34892;
<span style="color: #0000ff;">M-S-UP</span> (org-table-kill-row)                                       :: &#21024;&#38500;&#24403;&#21069;&#34892;
<span style="color: #0000ff;">M-S-DOWN</span> (org-table-insert-row)                                   :: &#22312;&#24403;&#21069;&#34892;&#19978;&#26041;&#25554;&#20837;&#26032;&#34892;&#65292;&#22914;&#26524;&#25351;&#23450;&#21069;&#32512;&#21442;&#25968;&#20250;&#19979;&#19979;&#26041;&#25554;&#20837;&#26032;&#34892;
C-c - (org-table-insert-hline)                                    :: &#22312;&#24403;&#21069;&#34892;&#19978;&#25554;&#20837;&#20998;&#21106;&#32447;
C-c RET (org-table-hline-and-move)                                :: &#22312;&#24403;&#21069;&#34892;&#19979;&#25554;&#20837;&#20998;&#21106;&#32447;&#65292;&#24182;&#31227;&#21160;&#21040;&#27700;&#24179;&#32447;&#19979;&#19968;&#34892;
C-c ^ (org-table-sort-lines)                                      :: &#26681;&#25454;&#24403;&#21069;&#21015;&#23545;&#34920;&#26684;&#36827;&#34892;&#25490;&#24207;

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21306;&#22495;</span>
C-c C-x M-w (org-table-copy-region) 
C-c C-x C-w (org-table-cut-region)        :: &#21098;&#20999;&#26576;&#20010;&#21306;&#22495;&#30340;&#34920;&#26684;&#20869;&#23481;
C-c C-x C-y (org-table-paste-rectangle)   :: &#25335;&#36125;&#22797;&#21046;&#30340;&#20869;&#23481;&#21040;&#34920;&#26684;

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26434;&#39033;</span>
C-c <span style="color: #ff00ff;">` (org-table-edit-field)              :: &#32534;&#36753;&#24403;&#21069;&#21333;&#20803;&#26684;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:1a937035-94a5-4372-90ce-b0ce0eafb8fc" class="outline-4">
<h4 id="h:1a937035-94a5-4372-90ce-b0ce0eafb8fc">合并单元格式</h4>
<div class="outline-text-4" id="text-h:1a937035-94a5-4372-90ce-b0ce0eafb8fc">
<p>
方法1，使用内置talbe.el, 参考<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Based-Tables.html">Editing Text-based Tables</a>
</p>

<pre class="example" id="org69a28c7">
+----------+---------+
| Verse No | Verse   |
+----------+---------+
|        1 | Line1   |
|          |Line1    |
|          |Line1    |
+----------+---------+
|        2 | Line2   |
|          |Line2    |
|          |Line2    |
+----------+---------+
</pre>

<p>
导出后得到
</p>
<p>
<del>----------</del>----&#x2013;&#x2014;+
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Verse No</td>
<td class="org-left">Verse</td>
</tr>
</tbody>
</table>
<p>
<del>----------</del>----&#x2013;&#x2014;+
</p>
<table>


<colgroup>
<col  class="org-right">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">Line1</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Line1</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Line1</td>
</tr>
</tbody>
</table>
<p>
<del>----------</del>----&#x2013;&#x2014;+
</p>
<table>


<colgroup>
<col  class="org-right">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-right">2</td>
<td class="org-left">Line2</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Line2</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Line2</td>
</tr>
</tbody>
</table>

<p>
<del>----------</del>----&#x2013;&#x2014;+
</p>
</div>
</div>
<div id="outline-container-h:90e6383f-9ea4-4013-8b7e-7db3adae1e87" class="outline-4">
<h4 id="h:90e6383f-9ea4-4013-8b7e-7db3adae1e87">表格公式</h4>
<div class="outline-text-4" id="text-h:90e6383f-9ea4-4013-8b7e-7db3adae1e87">
<p>
Org mode 中的表格的另外一个强大之处，在于它支持公式。在表格区域使用快捷键 "C-c '"，就可以对表格公式进行编辑，完成后公式会显示在表格下方，以 "#+TBLFM:" 开头，如下图所示。
</p>


<figure id="orgf837e86">
<img src="https://www.zmonster.me/assets/img/org-table-edit-formula.gif" alt="org-table-edit-formula.gif">

</figure>

<p>
使用 "C-c '" 后能在一个独立的、临时的 buffer 中编辑公式，但我们也可以在表格下方手工添加以 "+TBLFM:" 开头的行，然后直接添加公式。
</p>

<p>
上面这个公式表示将第四列的值设为第二列的值与第三列的值的乘积。在编辑好公式并保存后，将光标移动到公式所在行然后使用 "C-c C-c"，就可以应用公式到表格中。如下图所示:
</p>


<figure id="org8189902">
<img src="https://www.zmonster.me/assets/img/org-table-formula-eval.gif" alt="org-table-formula-eval.gif">

</figure>

<p>
在Org mode的表格公式中，用 "@" 来表示行，用 "$" 来表示列，最简单的，"@3$2" 表示的是第三行第二列的位置。使用快捷键 "C-c }" 可以开启表格的横纵坐标显示——若要关闭的话也是用它。如果是用 "C-c '" 来进行公式编辑，在输入表格位置时，会看到表格上对应的位置会在当时高亮，所以建议用这种方式进行编辑。
</p>

<p>
如果只给一个坐标，则另一个坐标会被设为"当前行"或者"当前列"，这在批量处理表格内容时会有用。
</p>

<p>
如果想表示一个区域的话，用 ".." 来表示。
</p>

<p>
下面这个表示左上角为第二行第一列单元格、右下角为第四行第三列单元格的区域，共包含 9 个单元格。
</p>

<div class="org-src-container">
<pre class="src src-shell">@2$<span style="color: #a0522d;">1</span>..@4$<span style="color: #a0522d;">3</span>
</pre>
</div>

<p>
下面这个则表示"当前行"的第一列到第三列的区域:
</p>

<div class="org-src-container">
<pre class="src src-shell">$<span style="color: #a0522d;">1</span>..$<span style="color: #a0522d;">3</span>
</pre>
</div>

<p>
在公式中，可以用 "@#" 表示当前行的行号，用 "$#" 表示当前列的列号，在一些稍复杂点的公式里会有用。
</p>

<p>
此外，还可以定义常量、变量，或者给某个单元格命名，然后引用它们。假设其名字为 "name"，那么 "$name" 就可以引用它了。常量的定义可以通过 "org-table-formula-constants" 来进行，这样定义的常量是全局的；如果要定义局部的常量，可以在org文件中添加诸如这样的行:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+CONSTANTS: pi=3.14 eps=2.4e-6
</pre>
</div>

<p>
还可以在当前表格引用其他表格的域，这需要其他表格被命名为某个名字，如"FOO"，我们要在另一个表格中使用其第三行第四列的域，将其值赋给当前表格的第五行第二列，则可以这样写:
</p>

<div class="org-src-container">
<pre class="src src-shell">@5$<span style="color: #a0522d;">2</span>=remote(FOO, @3$<span style="color: #a0522d;">4</span>)
</pre>
</div>

<p>
下图将被命名为 "fruit_expend" 的表格的第 6 行第 4 列的数据插入到新表格的第二行第二列中: <img src="https://www.zmonster.me/assets/img/org-table-formula-example-1.gif" alt="org-table-formula-example-1.gif">
</p>

<p>
Org mode 的表格公式中，四则运算符都能正常使用，不过略有不同——乘号 "*" 的优先级要比除号 "/" 要高，因此
</p>

<div class="org-src-container">
<pre class="src src-shell">$<span style="color: #a0522d;">3</span> / $<span style="color: #a0522d;">2</span> * $<span style="color: #a0522d;">1</span>
</pre>
</div>

<p>
会被解释为
</p>

<div class="org-src-container">
<pre class="src src-shell">$<span style="color: #a0522d;">3</span> / ($<span style="color: #a0522d;">2</span> * $<span style="color: #a0522d;">1</span>)
</pre>
</div>

<p>
Org mode 默认使用的是 Emacs 中自带的 Calc 这个 package 来进行计算，而 Calc 中提供了相当丰富的计算方法，这里列举一二:
</p>

<ol class="org-ol">
<li>基础算术方法: abs, sign, inv, sqrt, min, max，详见 <a href="http://www.gnu.org/software/emacs/manual/html_mono/calc.html#Arithmetic">Arithmetic Functions</a></li>
<li>对数方法: ln, exp, log，详见 <a href="http://www.gnu.org/software/emacs/manual/html_mono/calc.html#Logarithmic-Functions">Logarithmic Functions</a></li>
<li>三角函数: sin, cos, tahn，详见 <a href="http://www.gnu.org/software/emacs/manual/html_mono/calc.html#Trigonometric-and-Hyperbolic-Functions">Trigonometric/Hyperbolic Functions</a></li>
<li>随机数方法: random</li>
<li>向量/矩阵方法: vunion, vint, vsum, vmean, vmax, vmin, vmedian，详见 <a href="http://www.gnu.org/software/emacs/manual/html_mono/calc.html#Matrix-Functions">Vector/Matrix Functions</a></li>
</ol>

<p>
Calc 的内容比较多，这里不做深入展开，有需要的话可以参考 <a href="http://www.gnu.org/software/emacs/manual/html_mono/calc.html">GNU Emacs Calc Manual</a>。
</p>

<p>
此外，表格公式还能以 Emacs Lisp 的形式来进行编写，不过要在这种形式的公式前加上单引号 "'"，才能正确求值。在 Emacs Lisp 形式的公式表达式中，传入的参数会被当作字符串，所有需要用格式化选项 "N" 来指明参数类型都是数值。如下图，在不加格式化选项时，公式计算出错，加上 ";N" 后才得到了正确的结果。
</p>


<figure id="org99e5a22">
<img src="https://www.zmonster.me/assets/img/org-table-formula-with-lisp.gif" alt="org-table-formula-with-lisp.gif">

</figure>

<p>
所有的格式化选项，必须通过分号 ";" 和公式进行分隔并跟随在公式后面，可用的选项有:
</p>

<ul class="org-ul">
<li>p: 设置计算精度</li>
<li>n/s/e/f: 设置结果的输出格式
<ul class="org-ul">
<li>n3: 输出结果为3位有效数字(1.45)</li>
<li>s3: 输出结果为科学计数法，3位有效数字(1.45e0)</li>
<li>e3: 输出结果为工程计数法，3位有效数字(0.145e1)</li>
<li>f3: 输出结果精确至小数点后3位</li>
</ul></li>
<li>D/R: 计算时使用角度制还是弧度制(如三角函数)</li>
<li>F/S: 分数还是符号(当为 S 时，若结果不为整数，则显示式子本身，如: sqrt(6))</li>
<li>T/t: 时间计算，要求用于计算的值是"HH:MM[:SS]"的形式，当使用 T 时，输出结果是 "HH:MM:SS" 形式；使用 "t" 时，结果显示为一个数值，默认情况下单位是小时，可以通过变量 org-table-duration-custome-format 来设置</li>
<li>E: 不使用时，所有空白单元格都会被跳过，不会包含在计算过程中;当使用时，如果还使用了 N ，则用 "0" 填充；否则，在普通公式中，用 "nan" 填充，在 emacs lisp 公式中，用空字符串填充</li>
<li>N: 使用时，将所有域的值视为数字，对于非数值型，用 0 替代</li>
<li>L: 只用于 emacs lisp 公式，后续</li>
</ul>

<p>
如果需要对表格公式的求值进行调试，可以通过快捷键"C-c {"来开启调试模式(或者关闭它)。
</p>
</div>
</div>
<div id="outline-container-h:3825333f-a2ea-4f37-9913-90823af97628" class="outline-4">
<h4 id="h:3825333f-a2ea-4f37-9913-90823af97628">表格绘图</h4>
<div class="outline-text-4" id="text-h:3825333f-a2ea-4f37-9913-90823af97628">
<p>
使用 Org mode 文档中的表格数据进行绘图有两种方式，一种是使用 Org mode 提供的 "org-plot/gnuplot" 命令直接绘制图像，另外一种是通过在 source block 中读取表格数据来绘图。前者胜在方便快捷，但需要对 gnuplot 有一定的了解；后者胜在灵活，可以选用自己擅长的可视化方法，而且可以绘制复杂的图形。
</p>
</div>
<div id="outline-container-h:9402e5a4-3448-4785-86da-f7504cfeb33d" class="outline-5">
<h5 id="h:9402e5a4-3448-4785-86da-f7504cfeb33d">org-plot/gnuplot</h5>
<div class="outline-text-5" id="text-h:9402e5a4-3448-4785-86da-f7504cfeb33d">
<p>
第一种方法依赖 gnuplot 这个外部绘图工具，以及 gnuplot-mode 这个 Emacs 插件。
</p>

<p>
在依赖满足的情况下，只需要在表格上方添加 "#+PLOT:"， 然后在后面填写要传递给 gnuplot 的参数即可:
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">+PLOT: title:"Citas" ind:1 deps:(3) type:2d with:histograms set:"yrange [0:]" file:"./plot.png"</span>
| Sede      | Max cites | H-index |
|-----------+-----------+---------|
| Chile     |    257.72 |   21.39 |
| Leeds     |    165.77 |   19.68 |
| Sao Paolo |     71.00 |   11.50 |
| Stockholm |    134.19 |   14.33 |
| Morelia   |    257.56 |   17.67 |
</pre>
</div>

<p>
得到的结果如下图所示：
</p>


<figure id="org48f749c">
<img src="https://www.zmonster.me/assets/img/org-plot-example.png" alt="org-plot-example.png">

</figure>

<p>
使用这种 Org mode 自带的绘图方式，除了简便以外，还有一个好处就是表格的 header 能被正确地识别做列名，并在图中用来作为各列数据的 label。
</p>

<p>
以下是可在 "#+PLOT:" 后面设置的绘图参数
</p>

<ul class="org-ul">
<li>title: 设置图像的标题</li>
<li>ind: 用于绘制 x 轴的表中的列</li>
<li>deps: 除 x 轴以外的其他数据在表中的列，若有多列，用括号括起，如 "deps:(2, 3)"</li>
<li>type: 2d, 3d, or grid</li>
<li>with: 设置绘制类型，如 lines, points, boxes, impulses, histograms</li>
<li>file: 如果需要将绘制的图像保存为文件，则使用该属性</li>
<li>labels: 给定 deps 的标签，默认为表格 header</li>
</ul>

<p>
详见: <a href="http://orgmode.org/worg/org-tutorials/org-plot.html">Plotting tables in Org-Mode using org-plot</a>
</p>
</div>
</div>
<div id="outline-container-h:ee2e9842-5150-4e7c-9d91-d620a35e59ca" class="outline-5">
<h5 id="h:ee2e9842-5150-4e7c-9d91-d620a35e59ca">With source block</h5>
<div class="outline-text-5" id="text-h:ee2e9842-5150-4e7c-9d91-d620a35e59ca">
<p>
Org mode 有一个非常强大的功能就是可以插入各种语言的 source block，并且能去执行 source block 里的代码，接着将结果插入到当前的 Org mode 文档中来。
</p>

<p>
下图展示了在 Org mode 中插入 C++ 的 source block 并执行得到结果的过程:
</p>


<figure id="org85841a9">
<img src="https://www.zmonster.me/assets/img/org-src-block-evaluate.gif" alt="org-src-block-evaluate.gif">

</figure>

<p>
同时，Org mode 中的表格数据是可以作为变量传递到 source block 中的，如下图所示:
</p>


<figure id="org533f1f6">
<img src="https://www.zmonster.me/assets/img/org-src-block-read-tbl.gif" alt="org-src-block-read-tbl.gif">

</figure>

<p>
如上图所示，要将表格数据传递给 source block ，需要两个步骤
</p>

<ol class="org-ol">
<li>用 "#+NAME" 将表格命名为 "citas-data"</li>
<li>在 source block 的选项中，用 ":var tbl_data=citas-data" 将表格数据赋值给变量 "tbl_data"</li>
</ol>

<p>
对于下面这个表格，我可以可以用这个方法将数据传递给 source block ，然后用 matplotlib 来绘制图像。
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">+NAME: citas-data</span>
| Sede      | Max cites | H-index |
|-----------+-----------+---------|
| Chile     |    257.72 |   21.39 |
| Leeds     |    165.77 |   19.68 |
| Sao Paolo |     71.00 |   11.50 |
| Stockholm |    134.19 |   14.33 |
| Morelia   |    257.56 |   17.67 |
</pre>
</div>

<p>
相应的 source block 为
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">\#</span>+BEGIN_SRC python :results file :var <span style="color: #a0522d;">tbl_data</span>=citas-data <span style="color: #a0522d;">filename</span>=<span style="color: #8b2252;">"./org-plot-example2.png"</span>
import numpy as np
import matplotlib
import matplotlib.pyplot as plt

<span style="color: #0000ff;">plt.style.use</span>(<span style="color: #8b2252;">'ggplot'</span>)


bar_names = [row[0] for row<span style="color: #a020f0;"> in</span> tbl_data]
h_index = [row[2] for row<span style="color: #a020f0;"> in</span> tbl_data]
ind = np.arange(len(tbl_data))
width = 0.5

<span style="color: #0000ff;">plt.bar</span>(ind, h_index, width)
<span style="color: #0000ff;">plt.title</span>(<span style="color: #8b2252;">'Citas'</span>)
<span style="color: #0000ff;">plt.xlabel</span>(<span style="color: #8b2252;">'Sede'</span>)
<span style="color: #0000ff;">plt.ylabel</span>(<span style="color: #8b2252;">'H-index'</span>)
<span style="color: #0000ff;">plt.xticks</span>(ind + width/2., bar_names)

<span style="color: #0000ff;">plt.savefig</span>(filename)
<span style="color: #a020f0;">return</span>(filename)
<span style="color: #8b2252;">\#</span>+END_SRC
</pre>
</div>

<p>
执行后得到的结果为:
</p>


<figure id="org7eaf491">
<img src="https://www.zmonster.me/assets/img/org-plot-example2.png" alt="org-plot-example2.png">

</figure>
</div>
</div>
</div>
<div id="outline-container-h:5b06ce43-3605-438a-b4dc-a442b3057a75" class="outline-4">
<h4 id="h:5b06ce43-3605-438a-b4dc-a442b3057a75">总结</h4>
<div class="outline-text-4" id="text-h:5b06ce43-3605-438a-b4dc-a442b3057a75">
<p>
同 Org mode 中的其他功能一样，表格能很好地和 Org mode 的其他功能一起工作，利用 Org mode ，能够很容易地进行可重现研究(Reproducible Research)，数据、处理过程、结果展示，都可以在 Org mode 中一起呵成，而且比起 IPython Notebook，Org mode 拥有丰富得多的功能，表格就是其中一例。
</p>

<p>
以数据分析为例，工作流程可以是这样的:
</p>

<ol class="org-ol">
<li>将收集到的数据整理成 CSV 格式(比如从 excel 中导出)</li>
<li>在 Org mode 中将 CSV 格式的数据导入并创建一个表格，为其命名</li>
<li>新建一个 Python 的 source block, 对数据进行清洗、去重，并将结果输出，在 Org mode 中产生一个新的表格，同时将新的表格导出为 CSV 备份</li>
<li>对清洗后的数据进行分析，新建一个 Python 的 source block，使用 matplotlib 将分析结果绘制成图像并在 Org mode 文档中展示</li>
<li>对分析结果进行归纳总结</li>
<li>根据需要，使用 Org mode 自带的功能将文档导出为 HTML 或 PDF 格式，以供他人阅读</li>
<li>(可选)将该 Org mode 文档分享给其他 Org mode 用户</li>
</ol>

<p>
Org mode 真的是太棒啦！
</p>
</div>
</div>
</div>
<div id="outline-container-h:18ffcdf2-f05a-4b65-830f-87220d156c13" class="outline-3">
<h3 id="h:18ffcdf2-f05a-4b65-830f-87220d156c13">超链接</h3>
<div class="outline-text-3" id="text-h:18ffcdf2-f05a-4b65-830f-87220d156c13">
<ul class="org-ul">
<li>超链接有两种定义方式

<ul class="org-ul">
<li><p>
带说明的超链接
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">[[https://www.baidu.com][&#30334;&#24230;&#19968;&#19979;&#65292;&#20320;&#23601;&#30693;&#36947;]]
</pre>
</div></li>

<li><p>
不带说明的超链接
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">[[www.baidu.com]]
</pre>
</div></li>
</ul></li>

<li><p>
超链接的链接方式
</p>

<ul class="org-ul">
<li><p>
内部链接
</p>

<p>
也就是指链接与当前文件的一些链接，例如链接到当前文件某处
</p></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">[[My Target1]]
[[My Target2][&#30446;&#26631;2]]

&lt;&lt;My Target1&gt;&gt;
&lt;&lt;My Target2&gt;&gt;
</pre>
</div>

<ul class="org-ul">
<li><p>
外部链接 org的超链接支持指向文件，网站，电子邮件等等
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">[[https://www.baidu.com][&#30334;&#24230;&#19968;&#19979;&#65292;&#20320;&#23601;&#30693;&#36947;]]
[[file:~/.emacs.d/init.el][Emacs Config - init.el]] &#26412;&#22320;&#22270;&#29255;&#65292;&#21487;&#30465;&#30053;file&#65292;&#22914; [[./01.jpg]]
[[mailto:the_lty_mail@foxmail.com][EvanMeek's &#37038;&#31665;]]
[[irc:/irc.com/#emacs/evanmeek][IRC Emacs]]
[[info:org#Hyperlinks][Emacs Org&#36229;&#38142;&#25509;&#20869;&#37096;&#25991;&#26723;]]
</pre>
</div>

<ul class="org-ul">
<li>其他 在指定文件为指向的链接时，可以指定特定行或目标:

<ul class="org-ul">
<li><p>
特定行
</p>

<div class="org-src-container">
<pre class="src src-shell">[[file:~/.emacs.d/init.el::15][Emacs Config - init.el 15L]]
</pre>
</div></li>

<li><p>
特定目标
</p>

<div class="org-src-container">
<pre class="src src-shell">[[file:~/.emacs.d/test.org::Test Target][test.org Test Target]]
[[file:~/Dropbox/org/task.org::*Book][book]] ;; book&#26631;&#39064;
</pre>
</div></li>
</ul></li>
</ul></li>
</ul></li>

<li>处理超链接</li>
</ul>

<p>
我们可以使用命令`org-store-link`存储当前的位置，然后再通过一些处理超链接的方式处理当前位置的链接，你可以将其绑定一个快捷键，`<a href="#h:e040cdf8-c264-4369-93ce-b4021e5a65c2">见: 安装好org后的可选基础配置</a>`
</p>

<div class="org-src-container">
<pre class="src src-shell">C-c C-l   &#25554;&#20837;&#38142;&#25509;
C-c C-l   &#24403;&#20809;&#26631;&#32622;&#20110;&#19968;&#20010;&#36229;&#38142;&#25509;&#19978;&#65292;&#21487;&#20197;&#30452;&#25509;&#32534;&#36753;&#23427;
C-c C-o   &#25171;&#24320;&#24403;&#21069;&#20809;&#26631;&#19979;&#30340;&#36229;&#38142;&#25509;
</pre>
</div>

<ul class="org-ul">
<li>图片的显示</li>
</ul>

<p>
查看官方<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Showing-Images.html">show images</a>
</p>

<p>
[1][<a href="http://orgmode.org/manual/Images-in-HTML-export.html#Images-in-HTML-export">http://orgmode.org/manual/Images-in-HTML-export.html#Images-in-HTML-export</a>]
</p>

<p>
[2][<a href="http://orgmode.org/worg/org-tutorials/images-and-xhtml-export.html">http://orgmode.org/worg/org-tutorials/images-and-xhtml-export.html</a>]
</p>

<p>
本地插入
</p>

<div class="org-src-container">
<pre class="src src-shell">[[file:01.jpg]]
[[./01.jpg]]
[[file:01.jpg][&#22270;&#29255;&#26174;&#31034;1]]
[[./01.jpg][&#22270;&#29255;&#26174;&#31034;2]]
</pre>
</div>

<p>
外链图片
</p>

<div class="org-src-container">
<pre class="src src-shell">[[http://wx3.sinaimg.cn/mw690/6ee6203cgy1ft3wp3ogijj20d60bljs0.jpg][&#22806;&#38142;&#22270;&#29255;&#31034;&#20363;]]
</pre>
</div>

<p>
图片的详情
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">1.&#23646;&#24615;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26631;&#39064;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+CAPTION: A black cat stalking a spider</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR_HTML: :alt cat/spider image :title Action! :align right</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR_HTML: :width 100px</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR_HTML: :width 300 :style border:2px solid black;</span>

:alt &#23646;&#24615;
:style border:2px solid black; &#22270;&#29255;&#21152;&#40657;&#36793;&#26694;
:align right &#23545;&#40784;

&#24038;&#23545;&#40784;&#20248;&#21270;&#29256;
<span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR_HTML: :style float:left;margin:20px 20px 20px 0px;</span>
</pre>
</div>

<p>
显示图片
orgmode原有一个inline image显示。另外还有一个iimage mode。
</p>

<div class="org-src-container">
<pre class="src src-shell">M-x org-display-inline-images     
M-x org-toggle-inline-images  C-c C-x C-v  &#20869;&#23884;&#26174;&#31034;
org-startup-with-inline-images &#20869;&#23884;&#26174;&#31034;&#26377;&#36830;&#25509;&#30340;&#22270;&#29255;

Org mode &#20013;&#36827;&#34892;&#26174;&#31034;,&#24320;&#21551; iimage-mode &#21363;&#21487;(M-x iimage-mode)&#12290;
</pre>
</div>

<p>
不过外链图片默认是无法在emacs中显示的（通过修改配置文件也是可以实现的），生成html后是会显示的。
</p>

<p>
如果需要全局开启inline image display需要在配置中加入：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Enable inline image when entering org-mode</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Make sure you have all the necessary DLL for image display</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Windows ones can be downloaded from: https://sourceforge.net/projects/ezwinports/files/</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">turn-on-org-show-all-inline-images</span> ()
  (org-display-inline-images t t))

(add-hook 'org-mode-hook 'turn-on-org-show-all-inline-images)
</pre>
</div>

<p>
如果插入图片之后，无法直接导出html，运行 `C-c C-e h h` 后提示： `Please install htmlize from <a href="https://github.com/hniksic/emacs-htmlize">https://github.com/hniksic/emacs-htmlize</a>` 。 在这种情况下，需要到melpha中下载htmlize插件。
</p>

<p>
设置Org中图片显示的尺寸
关键在于配置变量 `org-image-actual-width` 的值. 用 `C-h v org-image-actual-width` 可以看到相关说明:
</p>
<div class="org-src-container">
<pre class="src src-shell">org-image-actual-width &#26159;&#19968;&#20010;&#23450;&#20041;&#22312;&#8216;org.el&#8217;&#20013;&#30340;&#21464;&#37327;. &#23427;&#30340;&#20540;&#26159;t

Documentation:

&#20869;&#23884;&#22270;&#29255;&#26102;&#26159;&#21542;&#26174;&#31034;&#23427;&#30340;&#23454;&#38469;&#23485;&#24230;?

&#33509;&#35774;&#32622;&#20026;t,&#24635;&#26159;&#26174;&#31034;&#23454;&#38469;&#22270;&#29255;&#23485;&#24230;.

&#33509;&#35774;&#32622;&#20026;&#19968;&#20010;&#25968;&#23383;, &#20351;&#29992;imagemagick (&#22914;&#26524;&#21487;&#20197;&#30340;&#35805;) &#26469;&#32553;&#25918;&#22270;&#29255;&#23485;&#24230;&#20026;&#35813;&#20540;&#22823;&#23567;.

&#33509;&#35774;&#32622;&#20026;&#19968;&#20010;&#21482;&#26377;&#19968;&#20010;&#25968;&#23383;&#30340;&#21015;&#34920;, &#21017;&#33509;&#33021;&#25214;&#21040;&#31867;&#20284; <span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR_HTML: :width 300px &#36825;&#26679;&#30340;&#25351;&#23450;&#23485;&#24230;&#30340;&#20851;&#38190;&#23383;&#65292;&#21017;&#23581;&#35797;&#20174; #+ATTR.* &#20013;&#25277;&#21462;&#30456;&#24212;&#30340;&#23485;&#24230;,&#21542;&#21017;&#20351;&#29992;&#25351;&#23450;&#30340;&#25968;&#23383;.</span>

&#33509;&#35774;&#32622;&#20026;nil, &#21017;&#20808;&#23581;&#35797;&#20174; <span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR.* &#20851;&#38190;&#23383;&#20013;&#33719;&#21462;&#23485;&#24230;,&#22914;&#26524;&#33719;&#21462;&#19981;&#21040;&#23485;&#24230;&#21017;&#20351;&#29992;&#23454;&#38469;&#23485;&#24230;.</span>
</pre>
</div>

<p>
修改方法：
</p>
<div class="org-src-container">
<pre class="src src-shell">- init &#37197;&#32622;&#25991;&#20214;&#20013;&#35774;&#32622;&#21464;&#37327;&#30340;&#20540;
(setq org-image-actual-width nil)

- &#21333;&#29420;&#20026;&#25991;&#20214;&#35774;&#32622;&#23616;&#37096;&#21464;&#37327;&#65292;&#26041;&#27861;&#26159;&#22312; org &#25991;&#20214;&#30340;&#31532;1&#34892;&#21152;&#19979;&#38754;&#20869;&#23481;
<span style="color: #b22222;"># </span><span style="color: #b22222;">-*- org-image-actual-width: nil; -*-</span>
</pre>
</div>

<p>
然后加上图片属性：`#+ATTR_ORG: :width 40%`
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">+NAME: png:emacs-ui</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+CAPTION: emacs ui</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR_ORG: :width 40%</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR_LATEX: :width 5in</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR_HTML: :alt cat/spider image :title Action!</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR_HTML: :width 600px</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+ATTR_HTML: :width 100 :style border:2px solid black;</span>
</pre>
</div>
<p>
使用 `M-x org-toggle-inline-images  C-c C-x C-v  内嵌显示`
</p>
</div>
</div>
<div id="outline-container-h:a43aea14-2a36-4844-b51a-5058a540ade0" class="outline-3">
<h3 id="h:a43aea14-2a36-4844-b51a-5058a540ade0">待办事项</h3>
<div class="outline-text-3" id="text-h:a43aea14-2a36-4844-b51a-5058a540ade0">
</div>
<div id="outline-container-h:0b495019-5561-450f-8ecf-9fb55f11fd16" class="outline-4">
<h4 id="h:0b495019-5561-450f-8ecf-9fb55f11fd16">待办事项基础</h4>
<div class="outline-text-4" id="text-h:0b495019-5561-450f-8ecf-9fb55f11fd16">
</div>
<div id="outline-container-h:6761fbf3-fc38-40f3-9c6f-bd8cc560ec89" class="outline-5">
<h5 id="h:6761fbf3-fc38-40f3-9c6f-bd8cc560ec89">基础的待办事项功能</h5>
<div class="outline-text-5" id="text-h:6761fbf3-fc38-40f3-9c6f-bd8cc560ec89">
<p>
当标题的开头为"TODO"时，任何标题都会成为一个待办事项，例如:
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">\*</span> TODO &#23436;&#25104;ORG-MODE&#31508;&#35760;xxx&#37096;&#20998;
</pre>
</div>

<p>
可以通过按键`C-c C-t`来对一个已存在标题标记不同的待办状态，默认情况下有三种待办状态:
</p>

<p>
#+end_src
TODO :: 待办事项
DONE :: 已完成的待办事项
unmarked :: 未标记为待办事项的标题，也就是普通的标题
#+end_src
</p>

<p>
还可以通过agenda缓冲区的`t`命令按键来远程完成切换不同待办状态。
</p>

<p>
下面是一些按键说明:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">S-RIGHT/LEFT       <span style="color: #483d8b;">::</span> &#36873;&#25321;&#21069;&#25110;&#21518;&#19968;&#31181;&#24453;&#21150;&#29366;&#24577;&#65292;&#31867;&#20284;&#20110;&#24490;&#29615;&#20999;&#25442;&#24453;&#21150;&#29366;&#24577;.
C-c / t            <span style="color: #483d8b;">::</span> &#29992;[[*Sparse Trees &#19981;&#30693;&#36947;&#21643;&#32763;&#35793;&#65292;&#31216;&#20026;&#31232;&#30095;&#26641;][Sparse Trees]]&#27983;&#35272;&#24453;&#21150;&#20107;&#39033;&#12290;&#36825;&#23558;&#20250;&#25240;&#21472;&#25972;&#20010;buffer&#65292;&#20294;&#26159;&#20250;&#26174;&#31034;&#25152;&#26377;&#30340;&#24453;&#21150;&#29366;&#24577;&#65288;&#38500;&#20102;DONE&#29366;&#24577;&#65289;&#65292;&#20197;&#21450;&#26631;&#39064;&#30340;&#23618;&#32423;&#20851;&#31995;&#12290;
M-x org-agenda t   <span style="color: #483d8b;">::</span> &#26174;&#31034;&#20840;&#23616;&#30340;&#24453;&#21150;&#20107;&#39033;&#65292;&#24453;&#21150;&#20107;&#39033;&#21015;&#34920;&#20174;&#25152;&#26377;&#30340;agenda&#25991;&#20214;&#20013;&#25910;&#38598;&#65292;&#28982;&#21518;&#22312;&#19968;&#20010;&#21333;&#29420;&#30340;&#32531;&#20914;&#21306;&#20869;&#26174;&#31034;&#12290;
S-M-RET            <span style="color: #483d8b;">::</span> &#26032;&#24314;&#19968;&#20010;&#24453;&#21150;&#20107;&#39033;
</pre>
</div>

<p>
其他
</p>

<p>
也可以通过改变标签从而修改待办事项状态，具体见函数`<a href="help:org-todo-trigger-tag-changes">org-todo-tigger-tag-changes</a>`的文档。
</p>
</div>
</div>
<div id="outline-container-h:62b0274e-5245-4215-8fc2-4b490ffb0ffb" class="outline-5">
<h5 id="h:62b0274e-5245-4215-8fc2-4b490ffb0ffb">多种工作流状态</h5>
<div class="outline-text-5" id="text-h:62b0274e-5245-4215-8fc2-4b490ffb0ffb">
<p>
你可以为使用"TODO"关键字表明@emph[顺序]工作流状态:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-todo-keywords
      '((sequence <span style="color: #8b2252;">"TODO"</span> <span style="color: #8b2252;">"FEEDBACK"</span> <span style="color: #8b2252;">"VERIFY"</span> <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"DONE"</span> <span style="color: #8b2252;">"DELEGATED"</span>)))
</pre>
</div>

<p>
竖线之前的状态代表需要完成的事，而之后代表已完成的事。如果你没有提供竖线`|`作为分割，那么就会把最后一个状态作为"DONE"的状态。安装好后，你就可以使用 <code>C-c C-t</code> 来循环切换这几个状态了。 
</p>

<p>
有时你可能想要使用不同的方式设置"TODO"关键字，例如，你可能想要最基本的”TODO=/=DONE"，但同时也想要有修复bug的工作流， 你可以安装以下的代码:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">&#33258;&#24049;&#23450;&#20041;&#24453;&#21150;&#29366;&#24577; &#25324;&#21495;&#20013;&#30340;&#23383;&#27597;&#20195;&#34920;&#24555;&#25463;&#38190;</span>
(<span style="color: #a020f0;">setq</span> org-todo-keywords
      '((sequence <span style="color: #8b2252;">"TODO(t)"</span> <span style="color: #8b2252;">"WAIT(w)"</span> <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"DONE(d)"</span> <span style="color: #8b2252;">"CANCEL(c)"</span>)
        (sequence <span style="color: #8b2252;">"REPORT(r)"</span> <span style="color: #8b2252;">"BUG(b)"</span> <span style="color: #8b2252;">"KNOWNCAUSE(k)"</span> <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"FIXED(f)"</span>)))
</pre>
</div>

<p>
以上代码让你在为一个标题提供待办事项状态时添加了一个键序列，你可以键入 <code>C-c C-t</code> 来查看效果。
</p>

<p>
如果你想为单独的Org文件提供一个待办状态，并且为其添加键序列，可以使用如下配置:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+TODO: TODO(t) | DONE(d)
#+TODO: REPORT(r) BUG(b) KNOWNCAUSE(k) | FIXED(f)
#+TODO: | CANCELED(c)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:0de3fac3-d509-4bbd-9c6c-ced69e67d717" class="outline-5">
<h5 id="h:0de3fac3-d509-4bbd-9c6c-ced69e67d717">进展日志</h5>
<div class="outline-text-5" id="text-h:0de3fac3-d509-4bbd-9c6c-ced69e67d717">
<p>
记录进展日志以及改变待办状态的时间戳可以使用前缀调用命令`org-todo`。
</p>

<p>
当你键入`C-u C-c C-t`将会提示你改变当前标题的待办状态，如果你将一个待办状态从TODO状态改为DONE状态的话，那么org就会为你创建一个时间戳，以记录你完成当前待办事项的时间。这个功能是基于一个特定的变量决定的：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36827;&#23637;&#26085;&#24535;</span>
(<span style="color: #a020f0;">setq</span> org-log-done 'time) <span style="color: #b22222;">;;</span><span style="color: #b22222;">time&#26102;&#38388; note&#25552;&#31034;&#36755;&#20837;&#20869;&#23481; nil&#20160;&#20040;&#20063;&#19981;&#20570;</span>
</pre>
</div>

<p>
这边出了点小意外，就是我设定`org-log-done`的值，没有效果，可能是版本原因，这边简单讲下不同设定下的不同区别 。 实现的效果大概是这样的:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* &#27599;&#26085;&#20219;&#21153;
\** DONE &#35835;&#20070;
  - State <span style="color: #8b2252;">"DONE"</span>       from <span style="color: #8b2252;">"TODO"</span>       [2020-05-05 &#20108; 19:57] \\
    &#35835;&#23436;&#20102;
  - State <span style="color: #8b2252;">"TODO"</span>       from              [2020-05-05 &#20108; 19:09] \\
    &#35201;&#24320;&#22987;&#35835;&#20070;&#20102;
    &#20170;&#22825;&#35835;&#12298;&#35199;&#28216;&#35760;&#12299;
\** FIXED &#32534;&#31243;
    - State <span style="color: #8b2252;">"FIXED"</span>      from <span style="color: #8b2252;">"BUG"</span>        [2020-05-05 &#20108; 19:58] \\
      &#35299;&#20915;&#20102;BUG
    - State <span style="color: #8b2252;">"BUG"</span>        from <span style="color: #8b2252;">"TODO"</span>       [2020-05-05 &#20108; 19:57] \\
      &#26377;&#20010;BUG
    - State <span style="color: #8b2252;">"TODO"</span>       from <span style="color: #8b2252;">"WAIT"</span>       [2020-05-05 &#20108; 19:57] \\
      &#24320;&#22987;&#32534;&#31243;
    - State <span style="color: #8b2252;">"WAIT"</span>       from              [2020-05-05 &#20108; 19:55] \\
      &#31561;&#35835;&#23436;&#20070;&#20877;&#26469;&#20889;&#20195;&#30721;
\**  CANCEL &#25171;&#28216;&#25103;
      - State <span style="color: #8b2252;">"CANCEL"</span>     from <span style="color: #8b2252;">"WAIT"</span>       [2020-05-05 &#20108; 19:58] \\
        &#30001;&#20110;&#20889;&#20195;&#30721;&#26102;&#35299;&#20915;bug&#26102;&#38388;&#33457;&#22826;&#38271;&#20102;&#65292;&#27809;&#26102;&#38388;&#25171;&#28216;&#25103;&#20102;&#65292;&#21462;&#28040;&#25481;
      - State <span style="color: #8b2252;">"WAIT"</span>       from              [2020-05-05 &#20108; 19:56] \\
        12&#28857;&#20043;&#21069;&#36824;&#26377;&#26102;&#38388;&#30340;&#35805;&#23601;&#25171;&#28216;&#25103;
</pre>
</div>

<p>
下面我还可以对TODO关键字进行单独的设置，让其具有进展日志的功能，比如下面我们为TODO和WAIT关键字指定了默认具有记录时间戳的功能，让DONE或CANCEL关键字具有记录日志的功能：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">&#24453;&#21150;&#29366;&#24577;&#12290;&#25324;&#21495;&#20013;`@`&#20195;&#34920;&#35760;&#24405;&#26085;&#24535;&#65292;&#32780;`!`&#20195;&#34920;&#35760;&#24405;&#26102;&#38388;&#25139;&#65292;&#20855;&#26377;&#20004;&#31181;&#21151;&#33021;: `TODO(t@/!)`</span>
(<span style="color: #a020f0;">setq</span> org-todo-keywords
             '((sequence <span style="color: #8b2252;">"TODO(t!)"</span> <span style="color: #8b2252;">"WAIT(w!)"</span>  <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"DONE(d@)"</span> <span style="color: #8b2252;">"CANCEL(c@)"</span>)))
</pre>
</div>

<p>
其中`@`代表记录日志，而`!`代表记录时间戳，你也可以让他们具有两种功能: `TODO(t@/!)`
</p>

<p>
同样，我们也可以单独为某个org文件设置:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+TODO: TODO(t) | WAIT(w@/!) | DONE (d!) CANCEL(c@)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:8d5f9a7c-5f8f-4bba-b71a-22b2c0aa6d76" class="outline-5">
<h5 id="h:8d5f9a7c-5f8f-4bba-b71a-22b2c0aa6d76">优先级</h5>
<div class="outline-text-5" id="text-h:8d5f9a7c-5f8f-4bba-b71a-22b2c0aa6d76">
<p>
当你大量使用Org模式后，你可能会有大量的待办事项条目，这个时候你可以为其设置优先级标记:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\*** TODO [#A] &#27927;&#30871;
</pre>
</div>

<p>
有三种优先级模式，A-C，若不指定优先级，'B'等级是默认的。
</p>
<ul class="org-ul">
<li><code>C-c ,</code> 或者  <code>M-x org-priority</code>  : 设置当前标题的优先级，键入A-C设置级别，或者键入SPC清除标记</li>
<li id="S-UP/DOWN ">提升/降低当前标题的优先级</li>
</ul>
</div>
</div>
<div id="outline-container-h:dff2ef9d-c841-47ea-b977-107f866c9326" class="outline-5">
<h5 id="h:dff2ef9d-c841-47ea-b977-107f866c9326">任务细分</h5>
<div class="outline-text-5" id="text-h:dff2ef9d-c841-47ea-b977-107f866c9326">
<p>
我们可以将一个待办事项分为多个小的待办事项，并且可以用一些标记用于对小的待办事项做统计：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* TODO &#27599;&#26085;&#20219;&#21153; [33%]
\** TODO &#20889;&#20316;&#19994; [2/3]
\*** TODO &#35821;&#25991;
\*** DONE &#25968;&#23398;
    CLOSED: [2020-05-06 &#19977; 05:53]
    - State <span style="color: #8b2252;">"DONE"</span>       from <span style="color: #8b2252;">"TODO"</span>       [2020-05-06 &#19977; 05:53]
\*** DONE &#33521;&#35821;
    CLOSED: [2020-05-06 &#19977; 07:53]
    - CLOSING NOTE [2020-05-06 &#19977; 07:53] \\
      &#20026;&#20102; &#25552;&#39640;&#25105;&#30340;&#33521;&#35821;&#27700;&#24179;&#65292;&#25105;&#27963;&#20986;uqle
\** TODO &#20581;&#36523; [50%]
\*** TODO 1&#32452;&#20208;&#21351;&#36215;&#22352;
\*** DONE 1&#32452;&#19978;&#19979;&#36466;
    CLOSED: [2020-05-06 &#19977; 07:52]
    - CLOSING NOTE [2020-05-06 &#19977; 07:52] \\
      &#32047;&#27515;&#25105;&#20102;
\*** TODO 500&#27425;&#36339;&#32499;
\*** DONE 5km&#24930;&#36305;
    CLOSED: [2020-05-06 &#19977; 05:55]
    - State <span style="color: #8b2252;">"DONE"</span>       from <span style="color: #8b2252;">"TODO"</span>       [2020-05-06 &#19977; 05:55]
\** DONE &#23398;&#20570;&#33756; [2/2]
   CLOSED: [2020-05-06 &#19977; 05:56]
   - State <span style="color: #8b2252;">"DONE"</span>       from <span style="color: #8b2252;">"TODO"</span>       [2020-05-06 &#19977; 05:56]
\*** DONE &#20027;&#33756;
    CLOSED: [2020-05-06 &#19977; 05:56]
    - State <span style="color: #8b2252;">"DONE"</span>       from <span style="color: #8b2252;">"TODO"</span>       [2020-05-06 &#19977; 05:56]
    - &#19996;&#22369;&#32905;
\*** DONE &#21103;&#33756;
    CLOSED: [2020-05-06 &#19977; 05:56]
    - State <span style="color: #8b2252;">"DONE"</span>       from <span style="color: #8b2252;">"TODO"</span>       [2020-05-06 &#19977; 05:56]
    - &#19978;&#28023;&#38738;
    - &#40060;&#27748;
</pre>
</div>

<p>
待办事项的进度有两种呈现方式，一种是标记为`<code>[/]</code>`另一种是标记为`<code>[%]</code>`，如果它们的子项已完成，那么当前待办事项会自动切换状态为DONE。
</p>

<p>
`C-c C-c `刷新进度的状态
</p>
</div>
</div>
<div id="outline-container-h:306b3d66-e284-4198-8ed9-09dba71273ea" class="outline-5">
<h5 id="h:306b3d66-e284-4198-8ed9-09dba71273ea">复选框</h5>
<div class="outline-text-5" id="text-h:306b3d66-e284-4198-8ed9-09dba71273ea">
<p>
还记得清单列表么，其中有一个复选框的样式，复选框不会被包含在全局的待办事项列表中，因此很适合用来将一个待办事项划分为多个步骤的操作：
</p>

<p>
`M-S_RET      :: 新建带有复选框的同级项`
</p>

<p>
`C-c C-c      :: 勾选复选框`
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* TODO &#27599;&#26085;&#20219;&#21153; [33%]
\** TODO &#20889;&#20316;&#19994; [3/3]
   - [X] &#35821;&#25991;
   - [X] &#25968;&#23398;
   - [X] &#33521;&#35821;
\** TODO &#20581;&#36523; [100%]
   - [X] 1&#32452;&#20208;&#21351;&#36215;&#22352;
   - [X] 1&#32452;&#19978;&#19979;&#36466;
   - [X] 500
   - [X] 5km&#24930;&#36305;
\** TODO &#23398;&#20570;&#33756; [2/2]
\*** DONE &#20027;&#33756; [100%]
    CLOSED: [2020-05-06 &#19977; 06:08]
    - State <span style="color: #8b2252;">"DONE"</span>       from <span style="color: #8b2252;">"TODO"</span>       [2020-05-06 &#19977; 06:08]
    - [X] &#19996;&#22369;&#32905;
\*** DONE &#21103;&#33756; [2/2]
    CLOSED: [2020-05-06 &#19977; 06:08]
    - State <span style="color: #8b2252;">"DONE"</span>       from <span style="color: #8b2252;">"TODO"</span>       [2020-05-06 &#19977; 06:08]
    - [X] &#19978;&#28023;&#38738;
    - [X] &#40060;&#27748;
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-h:2ef66dd7-7d1c-4566-99c7-a28a49b37638" class="outline-3">
<h3 id="h:2ef66dd7-7d1c-4566-99c7-a28a49b37638">标签</h3>
<div class="outline-text-3" id="text-h:2ef66dd7-7d1c-4566-99c7-a28a49b37638">
<p>
可以为一个标题提供一个标签列表，有助于将上下文进行关联。
</p>

<p>
创建标签的方式是在任意标题后，由两个冒号包住的单词，这个单词可以是任意字母、数字、下划线、和@符号。就像这样:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* &#27979;&#35797;&#26631;&#39064;    <span style="color: #483d8b;">:@Test:title_name:etc:</span>
</pre>
</div>
</div>
<div id="outline-container-h:7898b38e-bc37-40bf-8d0c-c91b5d13abfb" class="outline-4">
<h4 id="h:7898b38e-bc37-40bf-8d0c-c91b5d13abfb">标签继承</h4>
<div class="outline-text-4" id="text-h:7898b38e-bc37-40bf-8d0c-c91b5d13abfb">
<p>
Org-mode的标签可以根据大纲树继承结构，也就说子标题的标签会继承父标题的标签，不需要显式的写出来。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* TODO &#20844;&#21496;&#20219;&#21153;                                                        <span style="color: #483d8b;">:work:</span>
\** DONE &#23567;&#32452;&#24320;&#20250;                                                  <span style="color: #483d8b;">:meet:talk:</span>
\** TODO &#32534;&#20889;&#20195;&#30721;                                                       <span style="color: #483d8b;">:code:</span>
</pre>
</div>

<p>
上面编写代码和小组开会项就继承了公司任务的标签:work:。
</p>

<p>
Org-mode还支持单独设置某个标签为所有标签的父标签，从而让当前文件的所有标签都继承与它。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+FILETAGS: <span style="color: #483d8b;">:EvanMeek:</span>
</pre>
</div>

<p>
当一个org文件开头写上上面这段标记后，那么这个org文件的所有标签都会继承与`:EvanMeek:`
</p>
</div>
</div>
<div id="outline-container-h:15f44fc3-d9bf-48ee-8c14-335905c0470b" class="outline-4">
<h4 id="h:15f44fc3-d9bf-48ee-8c14-335905c0470b">设置标签</h4>
<div class="outline-text-4" id="text-h:15f44fc3-d9bf-48ee-8c14-335905c0470b">
<p>
前面我们已经讲过一种设置标签的方式，直接在标题后手动输入，还有另外几种方式:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">C-c C-q  <span style="color: #483d8b;">::</span> &#20026;&#24403;&#21069;&#26631;&#39064;&#21019;&#24314;&#26032;&#30340;&#26631;&#31614;&#12290;&#31354;&#26684;&#28165;&#38500;
C-c C-c  <span style="color: #483d8b;">::</span> &#21516;&#19978;&#65292;&#19981;&#36807;&#21482;&#26377;&#20809;&#26631;&#22312;&#26631;&#39064;&#19978;&#25165;&#26377;&#25928;
</pre>
</div>

<p>
我们还可以提前创建一些常用的标签，然后通过一个单独的按键来快速创建标签，首先设置变量`org-tag-alist`:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">&#35774;&#32622;&#26631;&#31614; `C-c C-q`&#25110;`C-c C-c`</span>
(<span style="color: #a020f0;">setq</span> org-tag-alist '((<span style="color: #8b2252;">"@work"</span> . ?w) (<span style="color: #8b2252;">"@home"</span> . ?h) (<span style="color: #8b2252;">"laptop"</span> . ?l)))
</pre>
</div>

<p>
这样设置后在我们使用`C-c C-q`或`C-c C-c`创建标签时就可以通过一些快捷键来创建标签。 
</p>

<p>
虽然这样很方便，但有随之出现一个文件，就是有些org文件根本用不上这些提前定义好的标签，所以我们就可以单独为文件提前创建标签，创建方式:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+TAGS: @work(w) @home(h) laptop(l)
#+TAGS: t_tag1 t_tag2
</pre>
</div>
</div>
</div>
<div id="outline-container-h:355a7c77-5398-413b-9f7f-4ddca5197e23" class="outline-4">
<h4 id="h:355a7c77-5398-413b-9f7f-4ddca5197e23">标签组</h4>
<div class="outline-text-4" id="text-h:355a7c77-5398-413b-9f7f-4ddca5197e23">
<p>
可以将类似的标签类型定义成一组，有两种定义的方式:
</p>

<ul class="org-ul">
<li>多选式</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+TAGS: [ &#38169;&#35823;(e) : &#24050;&#20462;&#27491;(f) : &#24050;&#30693;&#38382;&#39064;(i) ]
</pre>
</div>

<ul class="org-ul">
<li>单选式</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">#+TAGS: { &#29366;&#24577;: @&#24320;&#21551;(o) @&#20851;&#38381;(c) }
</pre>
</div>

<p>
顾名思义多选就是可以使用标签组中任意多个标签，而单选组内只能选择一种标签
</p>
</div>
</div>
<div id="outline-container-h:47fac935-0990-4879-9f92-da563b825e56" class="outline-4">
<h4 id="h:47fac935-0990-4879-9f92-da563b825e56">搜索标签</h4>
<div class="outline-text-4" id="text-h:47fac935-0990-4879-9f92-da563b825e56">
<div class="org-src-container">
<pre class="src src-emacs-lisp">C-c / m&#25110;C-c \ :: &#20351;&#29992;&#31232;&#30095;&#26641;&#25628;&#32034;&#12290;&#22914;&#26524;&#25351;&#23450;&#21069;&#32512;&#21442;&#25968;&#65292;&#37027;&#20040;&#20250;&#24573;&#30053;&#25152;&#26377;&#38750;&#20195;&#21150;&#29366;&#24577;&#30340;&#26631;&#39064;
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:4a5eba07-20b6-4431-8fad-d87c6fcef6ba" class="outline-3">
<h3 id="h:4a5eba07-20b6-4431-8fad-d87c6fcef6ba">属性</h3>
<div class="outline-text-3" id="text-h:4a5eba07-20b6-4431-8fad-d87c6fcef6ba">
<p>
条目可以具有一些属性标记，这些属性被包含在一个`PROPERTIES`片段中。 
</p>

<p>
一个简单的属性例子:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* &#26368;&#29233;&#30340;&#27468;&#25163;
\** Eminem
   <span style="color: #483d8b;">:PROPERTIES:</span>
   <span style="color: #483d8b;">:COUNTRY:</span> &#32654;&#22269;
   <span style="color: #483d8b;">:&#25104;&#21517;&#26354;:</span> &#12298;The real Slim Shady&#12299;
   <span style="color: #483d8b;">:&#21809;&#29255;&#32047;&#35745;&#38144;&#21806;&#37327;:</span> 2.2&#20159;
   <span style="color: #483d8b;">:FavoriteSong_ALL:</span> <span style="color: #8b2252;">"Lose Yourself"</span> <span style="color: #8b2252;">"MockingBird"</span>
   <span style="color: #483d8b;">:END:</span>
\** &#32418;&#33457;&#20250;&#36125;&#36125;
   <span style="color: #483d8b;">:PROPERTIES:</span>
   <span style="color: #483d8b;">:FavoriteSong:</span> <span style="color: #8b2252;">"H.B.U.F"</span> <span style="color: #8b2252;">"Demo"</span>
   <span style="color: #483d8b;">:END:</span>
</pre>
</div>

<p>
快捷键
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">C-c C-x p   <span style="color: #483d8b;">::</span> &#35774;&#32622;&#23646;&#24615;
C-c C-c d   <span style="color: #483d8b;">::</span> &#21024;&#38500;&#24403;&#21069;&#23646;&#24615;&#39033;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5723388f-2559-4daa-8962-fe9cbdbac2c5" class="outline-3">
<h3 id="h:5723388f-2559-4daa-8962-fe9cbdbac2c5">日期和时间</h3>
<div class="outline-text-3" id="text-h:5723388f-2559-4daa-8962-fe9cbdbac2c5">
<p>
我们可以为待办事项提供时间或日期，在Org-mode中叫时间戳.
</p>
</div>
<div id="outline-container-h:d064a352-e5b5-4c13-8d45-5accfcb36efc" class="outline-4">
<h4 id="h:d064a352-e5b5-4c13-8d45-5accfcb36efc">时间戳</h4>
<div class="outline-text-4" id="text-h:d064a352-e5b5-4c13-8d45-5accfcb36efc">
<p>
时间戳就是一个日期（有多种格式），时间戳可以出现在org文件的任何地方（标题或正文），如果为某个条目指定了个时间戳，那么在用`org-agenda`管理待办事项时就可以筛选指定日期的待办事项操作。
</p>
</div>
<div id="outline-container-h:4d223d5b-58b4-4ab7-8ddb-833f68c36878" class="outline-5">
<h5 id="h:4d223d5b-58b4-4ab7-8ddb-833f68c36878">基本的时间戳（事件、约会）</h5>
<div class="outline-text-5" id="text-h:4d223d5b-58b4-4ab7-8ddb-833f68c36878">
<p>
一个简单的时间戳只是给予了日期或时间给一个条目而已，就像你在纸上做事件或约会的计划一样。
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* &#32422;&#23567;&#32654;&#30475;&#30005;&#24433;</span>
  <span style="color: #a020f0; text-decoration: underline;">&lt;2020-05-28 &#22235;&gt;</span>
<span style="color: #0000ff;">* &#24320;&#23398;&#36820;&#26657;</span>
  <span style="color: #a020f0; text-decoration: underline;">&lt;2020-05-18 &#19968;&gt;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9060279e-db5f-4fa7-833c-bc77fce1d5ae" class="outline-5">
<h5 id="h:9060279e-db5f-4fa7-833c-bc77fce1d5ae">有规律的时间戳</h5>
<div class="outline-text-5" id="text-h:9060279e-db5f-4fa7-833c-bc77fce1d5ae">
<p>
时间戳不仅可以表示具体时间的事件还可以表示每周或每月甚至每天为单位间隔的事件，这代表了每隔多久就重复做的事件:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* &#21435;&#21307;&#38498;&#20307;&#26816;</span>
  <span style="color: #a020f0; text-decoration: underline;">&lt;2020-05-11 &#19968; +1y&gt;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:714de2a7-f74e-4af6-9524-52f9503fa61b" class="outline-5">
<h5 id="h:714de2a7-f74e-4af6-9524-52f9503fa61b">日记样式的时间</h5>
<div class="outline-text-5" id="text-h:714de2a7-f74e-4af6-9524-52f9503fa61b">
<p>
Org模式对Emacs的 <b><b>calendar/diary</b></b> 插件包提供了支持:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* &#27599;&#20010;&#26376;&#30340;&#31532;&#20108;&#21608;&#21484;&#24320;&#20250;&#35758;
  &lt;%%(diary-float t 4 2)&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:44c651b6-b033-4e1a-8205-e5313126f311" class="outline-5">
<h5 id="h:44c651b6-b033-4e1a-8205-e5313126f311">时间/日期范围</h5>
<div class="outline-text-5" id="text-h:44c651b6-b033-4e1a-8205-e5313126f311">
<p>
可以使用`–`来连接两个时间戳以表示时间范围
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* &#20943;&#32933;&#35745;&#21010;
  &lt;2021-05-01 &#20845;&gt;--&lt;2020-06-01 &#19968;&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:ccacd001-ac5f-4056-a0b4-7473166ba059" class="outline-5">
<h5 id="h:ccacd001-ac5f-4056-a0b4-7473166ba059">非活动时间戳</h5>
<div class="outline-text-5" id="text-h:ccacd001-ac5f-4056-a0b4-7473166ba059">
<p>
跟普通的时间戳类似，不过括号是使用方括号，而不是尖括号，区别在于这种非活动的时间戳不会被`org-agenda`所管理。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* &#31532;101&#27425;&#34920;&#30333;
  [2020-05-11 &#19968;]
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:12dd4b33-495d-4e07-850f-ed5bcf365fbb" class="outline-4">
<h4 id="h:12dd4b33-495d-4e07-850f-ed5bcf365fbb">创建时间戳</h4>
<div class="outline-text-4" id="text-h:12dd4b33-495d-4e07-850f-ed5bcf365fbb">
<p>
想让Org-mode识别你创建的时间戳，那必须是有特殊的格式的。下面的按键或命令可以让你快速创建一些时间戳，并且符合特殊的格式。
</p>

<ul class="org-ul">
<li>激活的时间标签 <code>C-c .</code></li>
<li>非激活的时间标签 <code>C-c !</code></li>
<li>加小时分钟 添加前置参数 <code>C-u</code></li>
<li>时间区间：在两个时间戳间用两个短横杠连接。</li>
<li>根据effort预估时间 <code>C-c C-x e == org-set-offort</code> 单位分钟</li>
</ul>



<div class="org-src-container">
<pre class="src src-emacs-lisp">&#22914;&#26524;&#24403;&#21069;&#20809;&#26631;&#19979;&#24050;&#32463;&#26377;&#19968;&#20010;&#26102;&#38388;&#25139;&#65292;&#37027;&#20040;&#23601;&#20250;&#20462;&#25913;&#37027;&#20010;&#26102;&#38388;&#25139;&#12290;
&#22914;&#26524;&#36830;&#32493;&#20004;&#27425;&#20351;&#29992;&#36825;&#20010;&#21629;&#20196;&#65292;&#23558;&#20250;&#25554;&#20837;&#19968;&#20010;&#26102;&#38388;&#33539;&#22260;&#30340;&#26102;&#38388;&#25139;&#12290;
&#24403;&#32473;&#20104;&#23427;&#21069;&#32512;&#21442;&#25968;&#65292;&#37027;&#20040;&#23558;&#20250;&#30452;&#25509;&#25554;&#20837;&#24403;&#21069;&#30340;&#26102;&#38388;&#12290;

&#26222;&#36890;&#26102;&#38388; C-c .
 &lt;2020-07-10 &#20116;&gt;
&#20462;&#25913;&#26102;&#38388; C-c .
&lt;2020-05-10 &#26085;&gt;
&#26102;&#38388;&#33539;&#22260; &#21152;--
&lt;2021-05-01 &#20845;&gt;--&lt;2020-06-01 &#19968;&gt;

&#21069;&#32622;&#21442;&#25968;C-u &#24102;&#20102;&#26102;&#38388;
&lt;2021-08-29 &#21608;&#26085; 01:21&gt;

effort&#39044;&#20272;&#26102;&#38388; 1&#23567;&#26102; C-c C-x e 
<span style="color: #483d8b;">:PROPERTIES:</span>
<span style="color: #483d8b;">:Effort:</span>   1:00
<span style="color: #483d8b;">:END:</span>
</pre>
</div>



<dl class="org-dl">
<dt><code>S-LEFT/RIGHT (org-timestamp-down/up-day)</code></dt><dd>将当前光标下的时间戳提前或延迟一天</dd>
<dt><code>S-UP/DOWN (org-timestamp-down/up)</code>       </dt><dd>同上，不过支持对年，月，日，周，以及时间戳类型(非活动时间戳)进行变换</dd>
</dl>
</div>
</div>
<div id="outline-container-h:7b9b6f98-ee93-40c4-b837-766263cf6f44" class="outline-4">
<h4 id="h:7b9b6f98-ee93-40c4-b837-766263cf6f44">截止日期和计划安排</h4>
<div class="outline-text-4" id="text-h:7b9b6f98-ee93-40c4-b837-766263cf6f44">
<p>
三种状态 
</p>

<ul class="org-ul">
<li><p>
deadline <code>C-c C-d</code> 插入截止时间戳
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #0000ff;"> &#23436;&#25104;ORG-MODE&#31508;&#35760;</span>
        <span style="color: #a020f0;">DEADLINE:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2020-05-11 &#19968;&gt;</span>
<span style="color: #a0522d;">** </span><span style="color: #228b22; font-weight: bold;">DONE</span><span style="color: #a0522d;"> </span><span style="color: #bc8f8f;">&#31532;&#19968;&#37096;&#20998;</span>
<span style="color: #a0522d;">** </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #a0522d;"> &#31532;&#20108;&#37096;&#20998;</span>
</pre>
</div>

<p>
如果时间超过截止日期，那么将会报一个警告，直到这个待办事项为"Done"状态才会停止警告。
</p></li>

<li><p>
scheduled <code>C-c C-s</code> 插入开始时间戳 
</p>

<p>
约定时间不需要打scheduled标记，可用`<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-05-10 周一 09:00&gt;</span></span>`
</p>

<p>
如果有了截止日期你还需要开始日期，通过下面的按键可以插入待办事项(非必须)的开始日期:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #0000ff;"> &#23436;&#25104;ORG-MODE&#31508;&#35760;</span>
        <span style="color: #a020f0;">SCHEDULED:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2021-05-10 &#19968;&gt;</span>
        <span style="color: #a020f0;">DEADLINE:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2020-05-11 &#19968;&gt;</span>  
<span style="color: #a0522d;">** </span><span style="color: #228b22; font-weight: bold;">DONE</span><span style="color: #a0522d;"> </span><span style="color: #bc8f8f;">&#31532;&#19968;&#37096;&#20998;</span>
<span style="color: #a0522d;">** </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #a0522d;"> &#31532;&#20108;&#37096;&#20998;</span>
</pre>
</div>

<p>
如果当前的时间超过了计划的开始时间，那么推迟一天开始时间也会自动推迟。
</p>

<p>
有些需要重复执行的任务，可以为其添加一个间隔周期，例如下面这个例子就是每隔一个月开始一次:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #0000ff;"> &#23436;&#25104;ORG-MODE&#31508;&#35760;</span>
        <span style="color: #a020f0;">SCHEDULED:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2021-05-10 &#19968; +1m&gt;</span>
        <span style="color: #a020f0;">DEADLINE:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2020-05-11 &#19968;&gt;</span>  
<span style="color: #a0522d;">** </span><span style="color: #228b22; font-weight: bold;">DONE</span><span style="color: #a0522d;"> </span><span style="color: #bc8f8f;">&#31532;&#19968;&#37096;&#20998;</span>
<span style="color: #a0522d;">** </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #a0522d;"> &#31532;&#20108;&#37096;&#20998;</span>
</pre>
</div></li>

<li><p>
closed 表示完成，在状态变为 <code>Done</code> 时添加
</p>

<p>
显示完成的时间，要在文件头添加
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #b22222;">#+STARTUP: logdone</span>
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-h:08f8a188-a4fc-4fc2-9faf-b4b6251e99b7" class="outline-4">
<h4 id="h:08f8a188-a4fc-4fc2-9faf-b4b6251e99b7">记录工作时间</h4>
<div class="outline-text-4" id="text-h:08f8a188-a4fc-4fc2-9faf-b4b6251e99b7">
<p>
org-mode可以记录你在完成某项待办事项所用时间，下面是一些按键介绍：
</p>

<dl class="org-dl">
<dt>`C-c C-x C-i` `(org-clock-in)`</dt><dd>开始为当前待办事项计时</dd>
</dl>
<p>
开始计时后会在当前条目下创建一个带有 <b>CLOCK</b> 关键字的时间戳,如果指定了前缀参数，那么就会从最近的计时任务中选择。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">\* &#20889;&#20195;&#30721;
  <span style="color: #483d8b;">:LOGBOOK:</span>
  CLOCK: [2020-05-11 &#19968; 16:09]--[2020-05-12 &#20108; 06:36] =&gt; 14:27
  <span style="color: #483d8b;">:END:</span>
</pre>
</div>
<dl class="org-dl">
<dt>`C-c C-x C-o` `(org-clock-out)`</dt><dd>停止计时</dd>
</dl>
<p>
停止计时，它将会在刚刚开始计时处后创建一个时间戳，并且还会计算出开始时间和停止时间的时间差。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">\* &#20889;&#20195;&#30721;
  <span style="color: #483d8b;">:LOGBOOK:</span>
  CLOCK: [2020-05-11 &#19968; 16:09]--[2020-05-12 &#20108; 06:36] =&gt; 14:27
  <span style="color: #483d8b;">:END:</span>
</pre>
</div>
<p>
<b><b>切换待办状态为"DONE"也会停止计时</b></b>
</p>

<dl class="org-dl">
<dt>`C-c C-x C-e` `(org-clock-modify-effort-estimate)`</dt><dd>更新计时任务进度</dd>
<dt>`C-c C-x C-q` `(org-clock-cancel)`</dt><dd>停止计时在你误操作计时时有用</dd>
<dt>`C-c C-x C-j` `(org-clock-go)`</dt><dd>跳转到计时任务</dd>
</dl>
<p>
可以指定跳转到当前正在计时的条目去，如果指定前缀参数，那么会跳转到最近一次计时任务的条目下。
</p>
</div>
<div id="outline-container-h:b3ba054a-b344-4e7b-8143-c4e387c2facc" class="outline-5">
<h5 id="h:b3ba054a-b344-4e7b-8143-c4e387c2facc">org mode用于读书记录</h5>
<div class="outline-text-5" id="text-h:b3ba054a-b344-4e7b-8143-c4e387c2facc">
<p>
使用 clock 功能，然后利用 `org-clock-report` 来汇总，具体来说可以这样：
</p>

<p>
1.在一个 org-mode 文件中，在一个特定的 headline 下记录一本书的读书历史，比如：
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">\*</span>* &#38405;&#35835;&#12298;GEB&#12299;
    :LOGBOOK:
    CLOCK: [2019-12-28 &#20845; 19:50]--[2019-12-28 &#20845; 20:16] =&gt;  0:26
    CLOCK: [2019-12-27 &#20116; 19:50]--[2019-12-27 &#20116; 20:00] =&gt;  0:10
    CLOCK: [2019-12-26 &#22235; 19:40]--[2019-12-26 &#22235; 20:14] =&gt;  0:34
    CLOCK: [2019-12-25 &#19977; 19:50]--[2019-12-25 &#19977; 20:13] =&gt;  0:23
    CLOCK: [2019-12-24 &#20108; 19:50]--[2019-12-24 &#20108; 20:18] =&gt;  0:28
    :END:
</pre>
</div>

<p>
2.在这个阅读条目下，新增这么一段内容
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">+BEGIN: clocktable :scope subtree :block untilnow</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+END</span>
</pre>
</div>

<p>
3.将光标移动到 `#+BEGIN` 所在一行，执行 `C-c C-c`(或 `M-x org-control-c-control-c`)，将会得到如下结果
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">+BEGIN: clocktable :scope subtree :block untilnow</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+CAPTION: Clock summary at [2020-02-11 &#20108; 11:53], for now.</span>
| Headline        | Time |      |
|-----------------+------+------|
| *Total time*      | *2:01* |      |
|-----------------+------+------|
| <span style="color: #8b2252;">\_</span>  &#38405;&#35835;&#12298;GEB&#12299; |      | 2:01 |
<span style="color: #b22222;">#</span><span style="color: #b22222;">+END</span>
</pre>
</div>

<p>
会记录总用时
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">\*</span>* &#38405;&#35835;&#12298;GEB&#12299;
    :LOGBOOK:
    CLOCK: [2019-12-28 &#20845; 19:50]--[2019-12-28 &#20845; 20:16] =&gt;  0:26
    CLOCK: [2019-12-27 &#20116; 19:50]--[2019-12-27 &#20116; 20:00] =&gt;  0:10
    CLOCK: [2019-12-26 &#22235; 19:40]--[2019-12-26 &#22235; 20:14] =&gt;  0:34
    CLOCK: [2019-12-25 &#19977; 19:50]--[2019-12-25 &#19977; 20:13] =&gt;  0:23
    CLOCK: [2019-12-24 &#20108; 19:50]--[2019-12-24 &#20108; 20:18] =&gt;  0:28
    :END:

    <span style="color: #b22222;">#</span><span style="color: #b22222;">+BEGIN: clocktable :scope subtree :block untilnow</span>
    <span style="color: #b22222;">#</span><span style="color: #b22222;">+CAPTION: Clock summary at [2020-02-11 &#20108; 11:53], for now.</span>
    | Headline        | Time |      |
    |-----------------+------+------|
    | *Total time*      | *2:01* |      |
    |-----------------+------+------|
    | <span style="color: #8b2252;">\_</span>  &#38405;&#35835;&#12298;GEB&#12299; |      | 2:01 |
    <span style="color: #b22222;">#</span><span style="color: #b22222;">+END</span>

<span style="color: #8b2252;">\*</span>* &#38405;&#35835;&#12298;&#19990;&#30028;&#35266;&#12299;
    :LOGBOOK:
    CLOCK: [2019-12-28 &#20845; 19:50]--[2019-12-28 &#20845; 20:16] =&gt;  0:26
    CLOCK: [2019-12-27 &#20116; 19:50]--[2019-12-27 &#20116; 20:00] =&gt;  0:10
    CLOCK: [2019-12-26 &#22235; 19:40]--[2019-12-26 &#22235; 20:14] =&gt;  0:34
    CLOCK: [2019-12-25 &#19977; 19:50]--[2019-12-25 &#19977; 20:13] =&gt;  0:23
    CLOCK: [2019-12-24 &#20108; 19:50]--[2019-12-24 &#20108; 20:18] =&gt;  0:28
    :END:

    <span style="color: #b22222;">#</span><span style="color: #b22222;">+BEGIN: clocktable :scope subtree :block untilnow</span>
    <span style="color: #b22222;">#</span><span style="color: #b22222;">+CAPTION: Clock summary at [2020-02-11 &#20108; 11:53], for now.</span>
    | Headline        | Time |      |
    |-----------------+------+------|
    | *Total time*      | *2:01* |      |
    |-----------------+------+------|
    | <span style="color: #8b2252;">\_</span>  &#38405;&#35835;&#12298;&#19990;&#30028;&#35266;&#12299; |      | 2:01 |
    <span style="color: #b22222;">#</span><span style="color: #b22222;">+END</span>
</pre>
</div>

<p>
report 是可以做很多设置
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">\*</span> &#35835;&#20070;&#35760;&#24405;

  <span style="color: #b22222;">#</span><span style="color: #b22222;">+BEGIN: clocktable :scope subtree :block untilnow</span>
  <span style="color: #b22222;">#</span><span style="color: #b22222;">+CAPTION: Clock summary at [2020-02-11 &#20108; 17:01], for now.</span>
  | Headline           | Time |      |
  |--------------------+------+------|
  | *Total time*         | *4:02* |      |
  |--------------------+------+------|
  | &#35835;&#20070;&#35760;&#24405;           | 4:02 |      |
  | <span style="color: #8b2252;">\_</span>  &#38405;&#35835;&#12298;GEB&#12299;    |      | 2:01 |
  | <span style="color: #8b2252;">\_</span>  &#38405;&#35835;&#12298;&#19990;&#30028;&#35266;&#12299; |      | 2:01 |
  <span style="color: #b22222;">#</span><span style="color: #b22222;">+END</span>


<span style="color: #8b2252;">\*</span>* &#38405;&#35835;&#12298;GEB&#12299;
    :LOGBOOK:
    CLOCK: [2019-12-28 &#20845; 19:50]--[2019-12-28 &#20845; 20:16] =&gt;  0:26
    CLOCK: [2019-12-27 &#20116; 19:50]--[2019-12-27 &#20116; 20:00] =&gt;  0:10
    CLOCK: [2019-12-26 &#22235; 19:40]--[2019-12-26 &#22235; 20:14] =&gt;  0:34
    CLOCK: [2019-12-25 &#19977; 19:50]--[2019-12-25 &#19977; 20:13] =&gt;  0:23
    CLOCK: [2019-12-24 &#20108; 19:50]--[2019-12-24 &#20108; 20:18] =&gt;  0:28
    :END:


<span style="color: #8b2252;">\*</span>* &#38405;&#35835;&#12298;&#19990;&#30028;&#35266;&#12299;
    :LOGBOOK:
    CLOCK: [2019-12-28 &#20845; 19:50]--[2019-12-28 &#20845; 20:16] =&gt;  0:26
    CLOCK: [2019-12-27 &#20116; 19:50]--[2019-12-27 &#20116; 20:00] =&gt;  0:10
    CLOCK: [2019-12-26 &#22235; 19:40]--[2019-12-26 &#22235; 20:14] =&gt;  0:34
    CLOCK: [2019-12-25 &#19977; 19:50]--[2019-12-25 &#19977; 20:13] =&gt;  0:23
    CLOCK: [2019-12-24 &#20108; 19:50]--[2019-12-24 &#20108; 20:18] =&gt;  0:28
    :END:
</pre>
</div>

<p>
见文档：<a href="https://orgmode.org/manual/The-clock-table.html">https://orgmode.org/manual/The-clock-table.html 3</a>
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-h:a48b96a4-cae5-42b1-a3b0-5bf396415739" class="outline-3">
<h3 id="h:a48b96a4-cae5-42b1-a3b0-5bf396415739">重新归档和归档</h3>
<div class="outline-text-3" id="text-h:a48b96a4-cae5-42b1-a3b0-5bf396415739">
</div>
</div>
<div id="outline-container-h:261b9b06-b7db-4d6d-bafb-b81b2bb3ee46" class="outline-3">
<h3 id="h:261b9b06-b7db-4d6d-bafb-b81b2bb3ee46">捕获和附件</h3>
<div class="outline-text-3" id="text-h:261b9b06-b7db-4d6d-bafb-b81b2bb3ee46">
<p>
组织系统必有一个很重要的功能，那就是快速的捕获新想法和新任务，并将其与某些资料关联的能力。Org-mode中使用 <b><b>Capture</b></b> 实现。它能够将与一个任务相关的文件存储在一个特殊的目录下。可能在某个系统下，任务和项目经常需要移动位置，而将整个项目树保存到一个归档文件中有利于保持系统的简洁和快速。
</p>
</div>
<div id="outline-container-h:c40f3d11-4364-47ab-b2f3-0b7a824425c0" class="outline-4">
<h4 id="h:c40f3d11-4364-47ab-b2f3-0b7a824425c0">捕获</h4>
<div class="outline-text-4" id="text-h:c40f3d11-4364-47ab-b2f3-0b7a824425c0">
<p>
org-mode能让你在工作时中断一会儿，来写一段简短的笔记。你可以为捕获新想法定义模板，并且将其笔记与不同的目标文件关联起来。
</p>
</div>
<div id="outline-container-h:a5b88a10-7f04-48bc-a98a-4808532fb57d" class="outline-5">
<h5 id="h:a5b88a10-7f04-48bc-a98a-4808532fb57d">设置捕获</h5>
<div class="outline-text-5" id="text-h:a5b88a10-7f04-48bc-a98a-4808532fb57d">
<p>
以下代码可以设置了保存笔记的默认文件地址，以及定义了一个捕获新想法的全局快捷键:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-default-notes-file  <span style="color: #8b2252;">"~/Documents/org/notes.org"</span>)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36825;&#37324;&#21069;&#38754;&#26377;&#20889;</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-c c"</span>) 'org-capture)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:671c5ac8-693b-420f-bb27-a862bb84d7d2" class="outline-5">
<h5 id="h:671c5ac8-693b-420f-bb27-a862bb84d7d2">使用Capture</h5>
<div class="outline-text-5" id="text-h:671c5ac8-693b-420f-bb27-a862bb84d7d2">
<ul class="org-ul">
<li>`M-x org-capture` 开始捕获 新建了一个缓冲区，用于编辑新捕获的想法。</li>

<li>`C-c C-c`     保存并返回原窗口 在编辑完新想法后，可以快速保存，并且返回原先的窗口，不会打断你的工作流。</li>

<li>`C-c C-w` 重新将当前项移动到其他位置 将一个或多个条目放置与其他地方。</li>

<li>`C-c C-k` 退出捕获过程并且复原到原本的状态。</li>
</ul>
</div>
</div>
<div id="outline-container-h:1562aca7-cfdc-4d5d-a249-1ad5ede538f7" class="outline-5">
<h5 id="h:1562aca7-cfdc-4d5d-a249-1ad5ede538f7">Capture模板</h5>
<div class="outline-text-5" id="text-h:1562aca7-cfdc-4d5d-a249-1ad5ede538f7">
<p>
可以使用模板来为不同情况下的要捕获项以不同方式来捕获到不同的位置。
</p>

<p>
现在假设你想要使用一个模板来创建些普通的TODO条目，并且你想要将这些条目放置到 `~/org/gtd.org` 中的 <b><b>Task</b></b> 标题下，那么这个模板可以这么写:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-capture-templates
      '((<span style="color: #8b2252;">"t"</span> <span style="color: #8b2252;">"Todo"</span> entry (file+headline <span style="color: #8b2252;">"~/org/gtd.org"</span> <span style="color: #8b2252;">"Task"</span>)
         <span style="color: #8b2252;">"* TODO %?\n %i\n %a"</span>))
</pre>
</div>

<p>
如果你你还想用一种时间树的形式来记录捕获到的内容，那么可以这么写:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-capture-templates
      '((<span style="color: #8b2252;">"j"</span> <span style="color: #8b2252;">"Journal"</span> entry (file+datetree <span style="color: #8b2252;">"~/org/journal.org"</span>)
         <span style="color: #8b2252;">"* %?\n %U\n  %i\n  %a"</span>)))
</pre>
</div>

<p>
让我们来分析一下这两个模板例子， `org-capture-templates` 这个变量保存着所有模板，它要求值是一个包含了多个模板的列表，所以我们每个模板都要写成一个列表，列表的第一个参数表示在Capture菜单中模板对应的快捷键，第二个参数表示在Capture菜单中模板快捷键对应的显示文本，第三个参数表示模板内容的类型，第四个参数表示模板内容的位置，第五参数是模板具体的写法。
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">模板参数</td>
<td class="org-left">例子内容</td>
<td class="org-left">描述</td>
</tr>

<tr>
<td class="org-left">:----&#x2013;&#x2014;:</td>
<td class="org-left">:----------------------&#x2013;&#x2014;:</td>
<td class="org-left">:-------&#x2013;&#x2014;:</td>
</tr>

<tr>
<td class="org-left">key</td>
<td class="org-left">"t"</td>
<td class="org-left">模板快捷键</td>
</tr>

<tr>
<td class="org-left">description</td>
<td class="org-left">"Todo"</td>
<td class="org-left">模板描述</td>
</tr>

<tr>
<td class="org-left">type</td>
<td class="org-left">entry</td>
<td class="org-left">模板内容类型</td>
</tr>

<tr>
<td class="org-left">target</td>
<td class="org-left">(file+headline "path" "Task")</td>
<td class="org-left">模板保存的位置</td>
</tr>

<tr>
<td class="org-left">template</td>
<td class="org-left">"* TODO %?\n %i\n %a"</td>
<td class="org-left">具体的模板</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-h:1a454cfc-a69a-4679-8e89-19400bb326d8" class="outline-6">
<h6 id="h:1a454cfc-a69a-4679-8e89-19400bb326d8">org-capture快速新建内容</h6>
<div class="outline-text-6" id="text-h:1a454cfc-a69a-4679-8e89-19400bb326d8">
<ul class="org-ul">
<li>参考博客 <a href="https://www.zmonster.me/2018/02/28/org-mode-capture.html">https://www.zmonster.me/2018/02/28/org-mode-capture.html</a></li>
</ul>

<p>
<a href="https://orgmode.org/manual/Capture.html">Capture</a> 是 Org mode 中非常重要的一个功能，使用它可以让我们快速地新建内容到特定的 Org mode 文件中去，具体一点，可以有下面这些场景
</p>

<ul class="org-ul">
<li>新建一条笔记到 inbox.org 中，将剪贴板中的内容自动插入，并且附上当时的时间</li>
<li>新增一条日志，按照「年-月-日」的层级结构插入到 journal.org 中，如下图所示</li>
<li>以表格的形式，新增一条消费支出记录到用于存放备忘信息的 memo.org 中</li>
<li>新增一条任务到 task.org 中，并且开始计时</li>
<li>新增一个代码片段到 snippet.org 中</li>
</ul>

<p>
上述看似很不一样的操作，只需要在配置里设置不同的 capture 模板即可，模板里支持的元素很多，甚至能在模板里写 elisp 代码来做到已有模板元素不能做到的事情。在写好模板并加载后，我们只需要调用 org-capture 这个函数，就能在弹出的临时 buffer 里选择对应的模板来记录不同的内容，而不用耗费精力去记忆应该打开哪个文件。
</p>

<p>
此外，使用 capture 后将会打开一个临时的 buffer，在我们编辑好内容后轻按 C-c C-c，它就会消失无踪，因此对我们原先在做的事情的打断非常轻微。
</p>

<p>
总结一下就是：
</p>

<ol class="org-ol">
<li>capture 可以预先设置记录内容的模板和存储入口</li>
<li>capture 提供统一的输入入口</li>
<li>capture 用完即走，不干扰当前工作流</li>
</ol>

<p>
如果你是一个 Org mode 用户，应该会用 Org mode 来做笔记记录、日志记录、任务管理这些事情，而这些事情，用 capture 来作为输入是非常自然而方便的，我也在这里建议，在 Org mode 环境里时，应当使用 capture 来作为主要的输入方式。
</p>
</div>
</div>
<div id="outline-container-h:a71246dd-75a2-457a-a149-3132569577a2" class="outline-6">
<h6 id="h:a71246dd-75a2-457a-a149-3132569577a2">最小配置</h6>
<div class="outline-text-6" id="text-h:a71246dd-75a2-457a-a149-3132569577a2">
<p>
capture 功能包含在 org 包里，所以只要安装了 org，那么直接就是能使用 capture 功能的。不过不做配置的话，那么
</p>
<ul class="org-ul">
<li>没有快捷键可以触发功能</li>
<li>默认只有一个用于创建任务的 Task 模板可选，并且存储在变量 org-default-notes-file 指定的文件里。如果org-default-notes-file 没有设置，它会默认存储到 ~/.notes 中去，然后会由于这个文件不是 Org 文件而报错</li>
</ul>

<p>
按照这个要求，可以得到最小的 org-capture 的配置如下
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #8b2252;">"C-c c"</span>) 'org-capture)
(<span style="color: #a020f0;">setq</span> org-default-notes-file <span style="color: #8b2252;">"~/notes.org"</span>)
</pre>
</div>

<p>
使用`C-c c t`可以快速创建使用。
</p>
</div>
</div>
</div>
<div id="outline-container-h:f8f2982a-c93e-4104-a5e3-9fce0f9fca53" class="outline-5">
<h5 id="h:f8f2982a-c93e-4104-a5e3-9fce0f9fca53">capture 自定义模板</h5>
<div class="outline-text-5" id="text-h:f8f2982a-c93e-4104-a5e3-9fce0f9fca53">
</div>
<div id="outline-container-h:45ce7664-bbfb-46f8-9ebf-30cd7f781544" class="outline-6">
<h6 id="h:45ce7664-bbfb-46f8-9ebf-30cd7f781544">capture 模板的五个部分</h6>
<div class="outline-text-6" id="text-h:45ce7664-bbfb-46f8-9ebf-30cd7f781544">
<p>
默认的 capture 模板是下面这个样子的
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">'(<span style="color: #8b2252;">"t"</span> <span style="color: #8b2252;">"Task"</span> entry (file+headline <span style="color: #8b2252;">""</span> <span style="color: #8b2252;">"Tasks"</span>) <span style="color: #8b2252;">"* TODO %?\n  %u\n  %a"</span>)
</pre>
</div>

<p>
后面我们要自己添加新的模板，也是这个格式。这个模板包含五个部分，分别是
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">模板组成</td>
<td class="org-left">对应默认模板中的内容</td>
<td class="org-left">描述</td>
</tr>

<tr>
<td class="org-left">key</td>
<td class="org-left">"t"</td>
<td class="org-left">用来选择模板的字符</td>
</tr>

<tr>
<td class="org-left">description</td>
<td class="org-left">"Task"</td>
<td class="org-left">展示用的模板描述</td>
</tr>

<tr>
<td class="org-left">type</td>
<td class="org-left">entry</td>
<td class="org-left">新增内容的类型</td>
</tr>

<tr>
<td class="org-left">target</td>
<td class="org-left">(file+headline "" "Tasks")</td>
<td class="org-left">新增内容的存储位置</td>
</tr>

<tr>
<td class="org-left">template</td>
<td class="org-left">"* TODO %?\n %u\n %a"</td>
<td class="org-left">新增内容的模板</td>
</tr>
</tbody>
</table>

<p>
下面针对这五部分进行详细说明。
</p>

<p>
<b><b>用于快速选择模板的 key</b></b>
</p>

<p>
对应前面默认模板里的 "t"，这个 key 可以是一个或两个字符，用来在执行 org-capture 的时候选择模板 —— 两个字符的情况是用来给模板分组的，第一个字符表示分组名，第二个字符用来选择这个分组下的实际模板。在我们有很多模板的时候，分组是非常有用的，一来可以让执行 org-capture 时显示的可选项更少，而来可以用来组织相近性质的模板以便管理。模板分组稍后一点会做详细说明，此处就先不展开了。
</p>

<p>
另外，经验证，这里的 key 是支持中文的 XD
</p>

<p>
<b><b>描述模板的 description</b></b>
</p>

<p>
对应前面默认模板里的 "Task"，这个就是用来对模板进行描述的，方便我们正确地选择模板。
</p>

<p>
key 和 description 这两部分会在执行 org-capture 进入模板选择 buffer 后，会显示的内容，其他模板内容在模板选择 buffer 中都是不显示的
</p>

<p>
这两部分，务必要注意
</p>

<ul class="org-ul">
<li>不同模板的 key 不能是一样的</li>
<li>description 应当尽量清晰以减轻自己的记忆负担</li>
</ul>

<p>
<b><b>设置新增内容类型的 type</b></b>
</p>

<p>
对应前面默认模板里的 "entry"，这个用来设置新增内容的类型，可选的类型如下表所示
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">type</td>
<td class="org-left">description</td>
</tr>

<tr>
<td class="org-left">entry</td>
<td class="org-left">带有 headline 的一个 Org mode 节点</td>
</tr>

<tr>
<td class="org-left">item</td>
<td class="org-left">一个列表项</td>
</tr>

<tr>
<td class="org-left">checkitem</td>
<td class="org-left">一个 checkbox 列表项</td>
</tr>

<tr>
<td class="org-left">table-line</td>
<td class="org-left">一个表格行</td>
</tr>

<tr>
<td class="org-left">plain</td>
<td class="org-left">普通文本</td>
</tr>
</tbody>
</table>

<p>
根据不同的 type，org-capture 会尝试将新增内容添加到文件中不同类型的数据的后面，比如
</p>

<ul class="org-ul">
<li>如果 type 是 item/checkitem，那么会找到目标位置后最近的一个列表，并将新增列表项添加到这个列表的后面</li>
<li>如果 type 是 table-line，那么会找到目标位置后最近的一个表格，并将新增行添加到表格的后面</li>
</ul>

<p>
因此对于不同的 type，要求后面的内容模板是按照一定的格式来编写的，下面是不同的 type 对应内容模板的简单示例
</p>

<ul class="org-ul">
<li><p>
type 为 entry 时，内容模板示例
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"* headline"</span>
</pre>
</div>

<p>
也就是说，template 的形式上必须是一个 headline
</p></li>

<li><p>
type 为 item 时
</p>

<p>
如果内容模板为空，会插入一个普通列表项，并且等待输入；如果有需要自定义的内容，那么才需要去写内容模板。
</p>

<p>
而此时的内容模板不需要在形式上是一个列表项，也就是说
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"- item"</span>
</pre>
</div>

<p>
和
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"item"</span>
</pre>
</div>

<p>
的效果是一样的，都会在 target 对应的位置里插入下面这样一个列表项
</p>

<div class="org-src-container">
<pre class="src src-shell">- item
</pre>
</div></li>

<li><p>
type 为 checkitem 时
</p>

<p>
与 type 为 item 时行为大部分一样，仅有一点区别，就是在内容模板为空的时候，它会插入一个 checkbox 列表项。
</p>

<p>
也就是说，如果内容模板不为空，那么它其实是不保证插入的是 checkbox 列表项的，需要我们自己来保证。
</p>

<p>
相应的内容模板应该是类似下面的格式
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"[ ] item"</span>
</pre>
</div></li>

<li><p>
type 为 table-line，内容模板示例
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"| colum 1 | colum 2 | colum3 |"</span>
</pre>
</div>

<p>
就是说，内容模板必须是一个表格的行
</p></li>
</ul>

<p>
<b>设置新增内容写入位置的 target</b>
</p>

<p>
对应前面默认模板里的 "(file+headline "" "Tasks")"，target 用来指定
</p>

<ul class="org-ul">
<li>新增内容要写入到哪个文件</li>
<li>新增内容要写入到文件的什么地方</li>
</ul>

<p>
如前面的默认模板所示，target 部分用一个 list 来表示，其中第一个元素用来表示 target 的类型，可用的类型如下表所示
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">type</td>
<td class="org-left">description</td>
<td class="org-left">example</td>
</tr>

<tr>
<td class="org-left">-----------------</td>
<td class="org-left">------------------------------</td>
<td class="org-left">--------------------------------------------------------</td>
</tr>

<tr>
<td class="org-left">file</td>
<td class="org-left">文件</td>
<td class="org-left">(file "path/to/file")</td>
</tr>

<tr>
<td class="org-left">id</td>
<td class="org-left">特定 ID 的某个 headline</td>
<td class="org-left">(id "id of existing Org entry")</td>
</tr>

<tr>
<td class="org-left">file+headline</td>
<td class="org-left">文件的某个唯一的 headline</td>
<td class="org-left">(file+headline "path/to/file" "node headline")</td>
</tr>

<tr>
<td class="org-left">file+olp</td>
<td class="org-left">文件中的 headline 路径</td>
<td class="org-left">(file+olp "path/to/file" "Level 1 heading" "Level 2" …)</td>
</tr>

<tr>
<td class="org-left">file+regexp</td>
<td class="org-left">文件中被正则匹配的 headline</td>
<td class="org-left">(file+regexp "path/to/file" "regexp to find location")</td>
</tr>

<tr>
<td class="org-left">file+olp+datetree</td>
<td class="org-left">文件中当日所在的 datetree</td>
<td class="org-left">(file+olp+datetree "filename" [ "Level 1 heading" &#x2026;])</td>
</tr>

<tr>
<td class="org-left">file+function</td>
<td class="org-left">文件中被函数匹配的位置</td>
<td class="org-left">(file+function "path/to/file" function-finding-location)</td>
</tr>

<tr>
<td class="org-left">clock</td>
<td class="org-left">当前正在计时中的任务所在的位置</td>
<td class="org-left">(clock)</td>
</tr>

<tr>
<td class="org-left">function</td>
<td class="org-left">自定义函数匹配的位置</td>
<td class="org-left">(function function-finding-location)</td>
</tr>
</tbody>
</table>

<p>
(如有疑惑，请执行 「M-x describe-variable」并输入「org-capture-templates」查看对应的文档)
</p>

<p>
其中 file+headline 是比较常用的，用来记录笔记、创建任务一般用这个就好了。不过这个要求 headline 在文件中是唯一的，如果不是唯一的话，最好使用 file+olp，指定对应 headline 在文件中的完整路径。
</p>

<p>
而 file+datetree、file+weektree 这两种用来创建日志是非常合适的，记录的内容能按年-月-日的层级结构组织好，方便回顾和管理。
</p>

<p>
如果有自己的特殊需求，那么 file+function、function 这两个也提供了极大的自由扩展的空间。
</p>

<p>
需要注意的是，上述与文件相关的 target 类型，如果指定了文件名，那么将会优先使用这个文件名而不是变量 org-default-notes-file 指定的文件 —— 反之，如果文件部分留空，那么就会默认使用 org-default-notes-file 指定的文件了。
</p>

<p>
<b>设置新增内容模板的 template</b>
</p>

<p>
对应前面默认模板里的 "* TODO %?\n %u\n %a"，这部分的内容是实际上新增内容的模板，通过设置它，我们可以在新增内容时
</p>

<ul class="org-ul">
<li>自动插入时间、链接、剪贴板内容、文件内容</li>
<li>交互式地要求输入特定内容，如 tag、headline 属性或其他自定义的字段</li>
<li>自动插入外部应用传入的特定信息，如浏览器上当前网页的链接、选中的文本等</li>
</ul>

<p>
这部分的配置，其中的内容可以分为两类
</p>

<ul class="org-ul">
<li>普通的文本，将会原样出现在新增内容中，如默认模板里的 "* TODO"、"\n"、" "</li>

<li><p>
以 % 开头的特殊标记，如 "%?" 和 "%a"，将会在最后根据类型自动扩展成不同的内容
</p>

<p>
这些特殊标记包括这些
</p>

<ul class="org-ul">
<li><p>
时间、日期相关
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">标记</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">%&lt;…&gt;</td>
<td class="org-left">自定义格式的 timestamp，如: %&lt;%Y-%m-%d&gt;，会得到 <span class="timestamp-wrapper"><span class="timestamp">&lt;2018-03-04 周日&gt;</span></span></td>
</tr>

<tr>
<td class="org-left">%t</td>
<td class="org-left">当前仅包含日期的 timestamp，如: <span class="timestamp-wrapper"><span class="timestamp">&lt;2018-03-04 周日&gt;</span></span></td>
</tr>

<tr>
<td class="org-left">%T</td>
<td class="org-left">当前包含日期和时间的 timestamp，如: <span class="timestamp-wrapper"><span class="timestamp">&lt;2018-03-04 周日 19:26&gt;</span></span></td>
</tr>

<tr>
<td class="org-left">%u</td>
<td class="org-left">当前包含日期的未激活的 timestamp，如: <span class="timestamp-wrapper"><span class="timestamp">[2018-03-04 周日]</span></span></td>
</tr>

<tr>
<td class="org-left">%U</td>
<td class="org-left">当前包含日期和时间的未激活的 timestamp，如: <span class="timestamp-wrapper"><span class="timestamp">[2018-03-04 周日 19:26]</span></span></td>
</tr>

<tr>
<td class="org-left">%^t</td>
<td class="org-left">类似 %t，但是弹出日历让用户选择日期</td>
</tr>

<tr>
<td class="org-left">%^T</td>
<td class="org-left">类似 %T，但是弹出日历让用户选择日期和时间</td>
</tr>

<tr>
<td class="org-left">%^u</td>
<td class="org-left">类似 %u，但是弹出日历让用户选择日期</td>
</tr>

<tr>
<td class="org-left">%^U</td>
<td class="org-left">类似 %U，但是弹出日历让用户选择日期和时间</td>
</tr>
</tbody>
</table>

<p>
注: 激活(active)和未激活(inactive)的 timestamp 的区别在于，后者不会出现在 agenda 中 —— 所以如果是新建一个 headline 到 org-agenda-files 中并且不希望它出现在 agenda 列表中时，应当使用未激活的 timestamp。
</p></li>

<li><p>
剪贴板相关
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">标记</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">%c</td>
<td class="org-left">当前 kill ring 中的第一条内容</td>
</tr>

<tr>
<td class="org-left">%x</td>
<td class="org-left">当前系统剪贴板中的内容</td>
</tr>

<tr>
<td class="org-left">%^C</td>
<td class="org-left">交互式地选择 kill ring 或剪贴板中的内容</td>
</tr>

<tr>
<td class="org-left">%^L</td>
<td class="org-left">类似 %^C，但是将选中的内容作为链接插入</td>
</tr>
</tbody>
</table></li>

<li><p>
标签相关
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">标记</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">%^g</td>
<td class="org-left">交互式地输入标签，并用 target 所在文件中的标签进行补全</td>
</tr>

<tr>
<td class="org-left">%^G</td>
<td class="org-left">类似 %^g，但用所有 org-agenda-files 涉及文件中的标签进行补全</td>
</tr>
</tbody>
</table></li>

<li><p>
文件相关
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">标记</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">%[file]</td>
<td class="org-left">插入文件 <b>file</b> 中的内容</td>
</tr>

<tr>
<td class="org-left">%f</td>
<td class="org-left">执行 org-capture 时当前 buffer 对应的文件名</td>
</tr>

<tr>
<td class="org-left">%F</td>
<td class="org-left">类似 %f，但输入该文件的绝对路径</td>
</tr>
</tbody>
</table></li>

<li><p>
任务相关
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">标记</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">%k</td>
<td class="org-left">当前在计时的任务的标题</td>
</tr>

<tr>
<td class="org-left">%K</td>
<td class="org-left">当前在计时的任务的链接</td>
</tr>
</tbody>
</table></li>

<li><p>
外部链接的信息
</p>

<p>
这里的链接不仅仅指如 <a href="http://www.google.com">http://www.google.com</a> 这样的网页链接，还包括文件、邮箱、新闻组、IRC 会话等，详情见 Org mode 手册的 <a href="https://orgmode.org/manual/External-Links.html#External-Links">External links</a>一节。
</p>

<p>
当然在 capture 里我们用不到所有类型的外部链接，从<a href="https://orgmode.org/manual/Template-expansion.html">文档</a>和 <a href="https://code.orgmode.org/bzg/org-mode/src/master/lisp/org-capture.el#L321">docstring</a> 来看，在 capture 里能用的外部链接只有下面几种
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">link type</th>
<th scope="col" class="org-left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">bbdb</td>
<td class="org-left"><a href="https://www.emacswiki.org/emacs/CategoryBbdb">BBDB</a>联系人数据库记录链接</td>
</tr>

<tr>
<td class="org-left">irc</td>
<td class="org-left">IRC 会话链接</td>
</tr>

<tr>
<td class="org-left">vm</td>
<td class="org-left"><a href="https://www.emacswiki.org/emacs/CategoryViewMail">View Mail</a> 邮件阅读器中的消息、目录链接</td>
</tr>

<tr>
<td class="org-left">wl</td>
<td class="org-left"><a href="https://www.emacswiki.org/emacs/WanderLust">Wunder Lust</a> 邮件/新闻阅读器中的消息、目录链接</td>
</tr>

<tr>
<td class="org-left">mh</td>
<td class="org-left"><a href="https://www.emacswiki.org/emacs/MH-E">MH-E</a> 邮件用户代理中的消息、目录链接</td>
</tr>

<tr>
<td class="org-left">mew</td>
<td class="org-left"><a href="https://www.emacswiki.org/emacs/Mew">MEW</a> 邮件阅读器中的消息链接</td>
</tr>

<tr>
<td class="org-left">rmail</td>
<td class="org-left">Emacs 的默认邮件阅读器 <a href="https://www.emacswiki.org/emacs/Rmail">Rmail</a> 中的消息链接</td>
</tr>

<tr>
<td class="org-left">gnus</td>
<td class="org-left"><a href="http://www.gnus.org/">GNUS</a> 邮件/新闻阅读器中的群组、消息等资源链接</td>
</tr>

<tr>
<td class="org-left">eww/w3/w3m</td>
<td class="org-left">在eww/w3/w3m 中存储的网页链接</td>
</tr>

<tr>
<td class="org-left">calendar</td>
<td class="org-left">日历链接</td>
</tr>

<tr>
<td class="org-left">org-protocol</td>
<td class="org-left">遵循 org-protocol 协议的外部应用链接</td>
</tr>
</tbody>
</table>

<p>
注: <a href="https://orgmode.org/manual/Template-expansion.html">文档</a>的内容来自 <a href="https://code.orgmode.org/bzg/org-mode">org-mode 仓库</a> 中的 doc/org.texi，从 commit 历史来看，可能是过时的；但奇怪的是 org-protocol 明明是支持的，docstring 里却完全没有提及……
</p>

<p>
这些外部链接，大部分都会在 Emacs 中通过 <b><b>org-store-link-pros</b></b> 记录起来，其中会包含这些链接的各个属性，而在 capture 的模板里面，就支持以 <b><b>%:keyword</b></b> 的形式来访问这些属性，比如 vm/wl/mh/mew/rmail/gnus 消息中的发件人名称、发件人地址之类的。因为邮件阅读器这块我个人不怎么用，需要详细了解的请查阅<a href="https://orgmode.org/manual/Template-expansion.html">文档</a>，而 calendar 完全可以用前面的「时间、日期相关」中的 %t、%T 等标记来替代，因此这里只详细说一下 eww 和 org-protocol。
</p>

<p>
eww 可用的特殊标记有如下三个
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">标记</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">%:type</td>
<td class="org-left">固定值，eww</td>
</tr>

<tr>
<td class="org-left">%:link</td>
<td class="org-left">页面的链接</td>
</tr>

<tr>
<td class="org-left">%:description</td>
<td class="org-left">页面的标题，如无则为页面的链接</td>
</tr>
</tbody>
</table>

<p>
org-protocol 可用的特殊标记有如下六个
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">标记</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">%:type</td>
<td class="org-left">链接的类型，如 http/https/ftp 等</td>
</tr>

<tr>
<td class="org-left">%:link</td>
<td class="org-left">链接地址，在 org-protocol 里的 url 字段</td>
</tr>

<tr>
<td class="org-left">%:description</td>
<td class="org-left">链接的标题，在 org-protocol 里的 title 字段</td>
</tr>

<tr>
<td class="org-left">%:annotation</td>
<td class="org-left">靠 url 和 title 完成的 org 格式的链接</td>
</tr>

<tr>
<td class="org-left">%:initial</td>
<td class="org-left">链接上选中的文本，在 org-protocol 里的 body 字段</td>
</tr>

<tr>
<td class="org-left">%:query</td>
<td class="org-left">org-protocol 上除掉开头和子协议部分的剩下部分</td>
</tr>
</tbody>
</table>

<p>
此外，在内容模板中还支持自定义函数来插入内容，以 <b>%(sexp)</b> 的形式，比如说我们可以自己写一个 <b><b>get-current-time</b></b> 函数来插入当前的时间，那么内容模板可以是这个样子的
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"%(get-current-time)"</span>
</pre>
</div>

<p>
而在内容模板中使用自定义函数时，可以将上面 eww 和 org-protocol 的这些特殊标记作为函数的参数，比如一个场景是，用 org-protocol 捕获的网页 title 中包含中括号，会导致下面这样的内容模板出错
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"[[%:link][%:description]]"</span>
</pre>
</div>

<p>
这个时候可以定一个一个函数来将 %:description 中的中括号替换成下划线
</p>

<div class="org-src-container">
<pre class="src src-shell">(defun replace-bracket-in-title (title)
  ;; blablabla
  )
</pre>
</div>

<p>
那么上面那个内容模板可以改成这样
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"[[%:link][%(replace-bracket-in-title \"%:description\")]]"</span>
</pre>
</div></li>

<li><p>
其他
</p>

<p>
还有一些特殊标记，不太好归类，就在这里罗列一下。
</p>

<p>
<b>"%i" 可以插入一段初始化内容</b> ，通常是 <b>org-store-link-plist</b> 中 "initial" 属性的值；如果没有的话，会使用当前 buffer 中被选中的内容；都没有的话就什么也不插入。
</p>

<p>
"%^{prop}p" 会提示输入内容，这将会在新增内容中插入一个 property 到 target 中，并且这个 property 的名字是 prop，值则是我们输入的文本。
</p>

<p>
"%^{prompt}" 则会用 prompt 作为提示符要求我们输入，并且用我们输入的文本替换模板中相应的内容。比如说 "%{姓名}" 会用 "姓名" 作为提示符要求输入。当有多个标记时，可以用 "%\N" 来插入第 N 个提示输入标记产生的内容，举个例子，下面的内容模板
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"- name: %^{&#22995;&#21517;}\n- age: %^{&#24180;&#40836;}\n\n%\\1&#30340;&#24180;&#40836;&#26159;%\\2"</span>
</pre>
</div>

<p>
(注: 此处的反斜线「\」需要转义，否则「\1」会被视作值为 1 的 ASCII 码特殊字符，感谢 Emacs China 网友 <a href="https://emacs-china.org/u/slack-py">slack-py</a> 指出该问题)
</p>

<p>
会要求我们输入姓名和年龄，假如我们输入姓名是 "张三"，年龄是 "25"，那么最后得到的内容是
</p>

<div class="org-src-container">
<pre class="src src-shell">- name: &#24352;&#19977;
- age: 25

&#24352;&#19977;&#30340;&#24180;&#40836;&#26159;25
</pre>
</div>

<p>
"%?" 是一个更特殊的标记，它不会产生任何内容，当所有其他的特殊标记都展开完毕或者输入完毕后，光标将会停留在这个标记所在的位置。
</p>

<p>
"%a" 注释，通常是使用 org-store-link 创建的链接
</p></li>
</ul></li>
</ul>

<p>
<b>设置新增内容模板的 属性</b>
</p>

<p>
条目的其余部分是附加选项的属性列表。公认的属性是：
</p>

<div class="org-src-container">
<pre class="src src-shell">:prepend
&#36890;&#24120;&#65292;&#26032;&#25429;&#33719;&#30340;&#20449;&#24687;&#23558;&#38468;&#21152;&#22312;&#30446;&#26631;&#20301;&#32622;&#65288;&#26368;&#21518;&#19968;&#20010;&#23376;&#39033;&#12289;&#26368;&#21518;&#19968;&#20010;&#34920;&#26684;&#34892;&#12289;&#26368;&#21518;&#19968;&#20010;&#21015;&#34920;&#39033;&#8230;&#8230;&#65289;&#12290;&#35774;&#32622;&#27492;&#23646;&#24615;&#20250;&#25913;&#21464;&#23427;&#12290;&#26032;&#30340;&#22312;&#26087;&#30340;&#19978;&#38754;

:immediate-finish
&#35774;&#32622;&#21518;&#65292;&#19981;&#25552;&#20379;&#32534;&#36753;&#20449;&#24687;&#65292;&#21482;&#38656;&#31435;&#21363;&#24402;&#26723;&#21363;&#21487;&#12290;&#22914;&#26524;&#27169;&#26495;&#21482;&#38656;&#35201;&#21487;&#20197;&#33258;&#21160;&#28155;&#21152;&#30340;&#20449;&#24687;&#65292;&#36825;&#24456;&#26377;&#24847;&#20041;&#12290;

:jump-to-captured
&#35774;&#32622;&#21518;&#65292;&#23436;&#25104;&#21518;&#36339;&#36716;&#21040;&#25429;&#33719;&#30340;&#26465;&#30446;&#12290;

:empty-lines
&#23558;&#27492;&#35774;&#32622;&#20026;&#35201;&#22312;&#26032;&#39033;&#30446;&#21069;&#21518;&#25554;&#20837;&#30340;&#34892;&#25968;&#12290;&#40664;&#35748;&#20026; 0&#65292;&#21807;&#19968;&#30340;&#20854;&#20182;&#24120;&#29992;&#20540;&#26159; 1  &#26032;&#30340;&#22312;&#26087;&#30340;&#19979;&#38754;&#12290;

:empty-lines-after
&#23558;&#27492;&#35774;&#32622;&#20026;&#24212;&#22312;&#26032;&#39033;&#30446;&#20043;&#21518;&#25554;&#20837;&#30340;&#34892;&#25968;&#12290;&#35206;&#30422;:empty-lines&#21518;&#38754;&#25554;&#20837;&#30340;&#34892;&#25968;&#12290;

:empty-lines-before
&#23558;&#27492;&#35774;&#32622;&#20026;&#24212;&#22312;&#26032;&#39033;&#30446;&#20043;&#21069;&#25554;&#20837;&#30340;&#34892;&#25968;&#12290;&#35206;&#30422;:empty-lines&#20043;&#21069;&#25554;&#20837;&#30340;&#25968;&#36724;&#12290;

:clock-in
&#22312;&#27492;&#39033;&#30446;&#20013;&#21551;&#21160;&#26102;&#38047;&#12290;

:clock-keep
&#22312;&#24402;&#26723;&#25429;&#33719;&#30340;&#26465;&#30446;&#26102;&#20445;&#25345;&#26102;&#38047;&#36816;&#34892;&#12290;

:clock-resume
<span style="color: #8b2252;">":clock-in"</span> &#35774;&#32622;&#20026; t &#30340;&#26102;&#20505;&#65292;&#20250;&#22312;&#26032;&#24314;&#20869;&#23481;&#26102;&#24320;&#22987;&#35745;&#26102;&#65292;&#36825;&#22312; GTD &#36825;&#31181;&#22330;&#26223;&#19979;&#26159;&#25402;&#26377;&#29992;&#30340;&#12290;&#20294;&#26377;&#21487;&#33021;&#25105;&#20204;&#22312;&#26032;&#24314;&#20869;&#23481;&#26102;&#65292;&#26412;&#26469;&#23601;&#26377;&#19968;&#20010;&#20219;&#21153;&#22312;&#35745;&#26102;&#65292;&#36825;&#31181;&#24773;&#20917;&#19979;&#21407;&#26469;&#30340;&#35745;&#26102;&#20250;&#20013;&#26029;&#25481;&#65292;&#36825;&#20010;&#26102;&#20505;&#23558; <span style="color: #8b2252;">":clock-resume"</span> &#35774;&#32622;&#20026; t&#65292;&#21487;&#20197;&#22312;&#26032;&#20219;&#21153;&#23436;&#25104;&#21518;&#65292;&#33258;&#21160;&#24674;&#22797;&#21407;&#26469;&#20219;&#21153;&#30340;&#35745;&#26102;&#29366;&#24577;&#12290;&#35831;&#27880;&#24847;&#65292;:clock-keep&#20248;&#20808;&#20110;:clock-resume&#12290;&#23558;&#20004;&#32773;&#37117;&#35774;&#32622;&#20026; non- &#26102;nil&#65292;&#23558;&#36816;&#34892;&#24403;&#21069;&#26102;&#38047;&#24182;&#19988;&#19981;&#20250;&#24674;&#22797;&#21069;&#19968;&#20010;&#26102;&#38047;&#12290;

:time-prompt
&#25552;&#31034;&#36755;&#20837;&#26085;&#26399;/&#21608;&#26641;&#21644;&#22635;&#20805;&#27169;&#26495;&#26102;&#20351;&#29992;&#30340;&#26085;&#26399;/&#26102;&#38388;&#12290;&#22914;&#26524;&#27809;&#26377;&#27492;&#23646;&#24615;&#65292;&#25429;&#33719;&#23558;&#20351;&#29992;&#24403;&#21069;&#26085;&#26399;&#21644;&#26102;&#38388;&#12290;&#21363;&#20351;&#23578;&#26410;&#35774;&#32622;&#27492;&#23646;&#24615;&#65292;&#24744;&#20063;&#21487;&#20197;&#36890;&#36807;org-capture&#20351;&#29992;C-1&#21069;&#32512;&#21442;&#25968;&#36827;&#34892;&#35843;&#29992;&#26469;&#24378;&#21046;&#25191;&#34892;&#30456;&#21516;&#30340;&#34892;&#20026;&#12290;

:tree-type
&#29992;week&#20570;&#19968;&#20010;&#26143;&#26399;&#26641;&#65292;&#32780;&#19981;&#26159;&#19968;&#20010;&#26376;&#22825;&#26641;&#65292;&#21363;&#25226;&#27599;&#19968;&#22825;&#30340;&#26631;&#39064;&#19982;&#24403;&#21069;&#30340;ISO&#19968;&#21608;&#26631;&#39064;&#19979;&#12290;&#29992;&#20110;month&#20165;&#25353;&#26376;&#23545;&#26465;&#30446;&#36827;&#34892;&#20998;&#32452;&#12290;&#40664;&#35748;&#26159;&#25353;&#22825;&#20998;&#32452;&#26465;&#30446;&#12290;

:unnarrowed
&#19981;&#35201;&#32553;&#23567;&#30446;&#26631;&#32531;&#20914;&#21306;&#65292;&#21482;&#38656;&#26174;&#31034;&#23436;&#25972;&#30340;&#32531;&#20914;&#21306;&#12290;&#40664;&#35748;&#26159;&#32553;&#23567;&#23427;&#65292;&#20197;&#20415;&#24744;&#21482;&#33021;&#30475;&#21040;&#26032;&#26448;&#26009;&#12290;

:table-line-pos
&#25351;&#23450;&#34920;&#20013;&#24212;&#25554;&#20837;&#26032;&#34892;&#30340;&#20301;&#32622;&#12290;&#23427;&#24212;&#35813;&#26159;&#19968;&#20010;&#20687; <span style="color: #8b2252;">' &#30340;&#23383;&#31526;&#20018;II-3'</span> &#24847;&#21619;&#30528;&#26032;&#34892;&#24212;&#35813;&#25104;&#20026;&#31532;&#20108;&#20010;&#27700;&#24179;&#20998;&#38548;&#32447;&#20043;&#21069;&#30340;&#31532;&#19977;&#34892;&#12290;

:kill-buffer
&#22914;&#26524;&#35843;&#29992;&#25429;&#33719;&#26102;&#23578;&#26410;&#35775;&#38382;&#30446;&#26631;&#25991;&#20214;&#65292;&#21017;&#22312;&#25429;&#33719;&#23436;&#25104;&#21518;&#20877;&#27425;&#26432;&#27515;&#32531;&#20914;&#21306;&#12290;

:no-save
&#23436;&#25104;&#25429;&#33719;&#21518;&#19981;&#35201;&#20445;&#23384;&#30446;&#26631;&#25991;&#20214;&#12290;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:1b1639ac-de14-41cf-b346-3510ffb73f2d" class="outline-6">
<h6 id="h:1b1639ac-de14-41cf-b346-3510ffb73f2d">使用capture 模板</h6>
<div class="outline-text-6" id="text-h:1b1639ac-de14-41cf-b346-3510ffb73f2d">
<p>
所有的 capture 模板都应当以 list 的形式记录在变量 <b><b>org-capture-templates</b></b> 中，下面的示例可能会存在模板的 key 冲突的情况，请根据自己的情况来选用或参考示例。
</p>

<p>
在开始之前，我们先将 org-capture-templates 设置为空
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-capture-templates nil)
</pre>
</div>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">GTD&#39640;&#25928;&#31649;&#29702;</span>
(custom-set-variables
 '(org-directory <span style="color: #8b2252;">"~/Sync/orgfiles"</span>)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24179;&#26102;&#20010;&#20154;&#24037;&#20316;&#25991;&#20214;&#30446;&#24405;</span>
 '(org-default-notes-file (concat org-directory <span style="color: #8b2252;">"/notes.org"</span>))
 '(org-export-html-postamble nil)
 '(org-hide-leading-stars t)
 '(org-startup-folded (<span style="color: #a020f0;">quote</span> overview))
 '(org-startup-indented t))

(<span style="color: #a020f0;">setq</span> org-file-apps
      (append '(
                (<span style="color: #8b2252;">"\\.pdf\\"</span> . <span style="color: #8b2252;">"evince %s"</span>)
                ) <span style="color: #ff0000; font-weight: bold;">org-file-apps))</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">org-agenda&#26085;&#31243;&#35745;&#21010;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(global-set-key "\C-c a" 'org-agenda)</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-c a"</span>) 'org-agenda)
(<span style="color: #a020f0;">setq</span> org-agenda-files (list <span style="color: #8b2252;">"~/Sync/orgfiles/gcal.org"</span>
                             <span style="color: #8b2252;">"~/Sync/orgfiles/i.org"</span>
                             <span style="color: #8b2252;">"~/Sync/orgfiles/schedule.org"</span>))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">org-capture &#24555;&#36895;&#26032;&#24314;&#20869;&#23481;</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-c c"</span>) 'org-capture)
(<span style="color: #a020f0;">setq</span> org-capture-templates
      '((<span style="color: #8b2252;">"a"</span> <span style="color: #8b2252;">"Appointment"</span> entry (file+headline  <span style="color: #8b2252;">"~/Sync/orgfiles/gcal.org"</span> <span style="color: #8b2252;">"Appointments"</span>)
         <span style="color: #8b2252;">"* TODO %^{&#39044;&#32422;} %?\n:PROPERTIES:\n\n:END:\nDEADLINE: %^T \n %i\n"</span>)
  (<span style="color: #8b2252;">"l"</span> <span style="color: #8b2252;">"Link"</span> entry (file+headline <span style="color: #8b2252;">"~/Sync/orgfiles/links.org"</span> <span style="color: #8b2252;">"Links"</span>)
         <span style="color: #8b2252;">"* %a %^g\n %?\n %T\n %i"</span>)
        (<span style="color: #8b2252;">"b"</span> <span style="color: #8b2252;">"Blog idea"</span> entry (file+headline <span style="color: #8b2252;">"~/Sync/orgfiles/i.org"</span> <span style="color: #8b2252;">"POSTS:"</span>)
         <span style="color: #8b2252;">"* %?\n%T"</span> <span style="color: #483d8b;">:prepend</span> t)
        (<span style="color: #8b2252;">"t"</span> <span style="color: #8b2252;">"To Do Item"</span> entry (file+headline <span style="color: #8b2252;">"~/Sync/orgfiles/i.org"</span> <span style="color: #8b2252;">"To Do and Notes"</span>)
         <span style="color: #8b2252;">"* TODO %?\n%u"</span> <span style="color: #483d8b;">:prepend</span> t)
        (<span style="color: #8b2252;">"m"</span> <span style="color: #8b2252;">"Mail To Do"</span> entry (file+headline <span style="color: #8b2252;">"~/Sync/orgfiles/i.org"</span> <span style="color: #8b2252;">"To Do and Notes"</span>)
         <span style="color: #8b2252;">"* TODO %a\n %?"</span> <span style="color: #483d8b;">:prepend</span> t)
        (<span style="color: #8b2252;">"n"</span> <span style="color: #8b2252;">"Note"</span> entry (file+olp <span style="color: #8b2252;">"~/Sync/orgfiles/i.org"</span> <span style="color: #8b2252;">"Notes"</span>)
         <span style="color: #8b2252;">"* %u %? "</span> <span style="color: #483d8b;">:prepend</span> t)
        (<span style="color: #8b2252;">"r"</span> <span style="color: #8b2252;">"RSS"</span> entry (file+headline <span style="color: #8b2252;">"~/Sync/shared/elfeed.org"</span> <span style="color: #8b2252;">"Feeds misc"</span>)
         <span style="color: #8b2252;">"** %A %^g\n"</span>)
        (<span style="color: #8b2252;">"s"</span> <span style="color: #8b2252;">"Screencast"</span> entry (file <span style="color: #8b2252;">"~/Sync/orgfiles/screencastnotes.org"</span>)
         <span style="color: #8b2252;">"* %^{&#24405;&#24433;} %?\n%i\n"</span>)
  ))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-capture-templates
     '(
  (
  <span style="color: #8b2252;">"l"</span> <span style="color: #8b2252;">"Work log"</span> entry
       (file+datetree <span style="color: #8b2252;">"~/TimeLog.org"</span>)
       <span style="color: #8b2252;">"** %U - %^{Activity} \n %?"</span> <span style="color: #483d8b;">:clock-in</span> t <span style="color: #483d8b;">:clock-resume</span> t
  )))
</pre>
</div>



<p>
步骤：
</p>

<ol class="org-ol">
<li><code>C-c c</code> 打开org-capture</li>
<li><code>t</code> 新建TODO任务</li>
<li>填写你的任务名称</li>
<li><code>C-c C-d</code> 增加Deadline，按方向键可以选择日期。</li>
<li><code>C-c C-c</code> 确认添加，之后这条任务就出现在了task.org之中</li>
</ol>

<p>
还可以将buffer中内容快速记录到文件中
</p>

<p>
使用方法：选中文件内容，=C-c c= 再按j。
</p>
</div>
</div>
<div id="outline-container-h:cf87478a-456e-4798-83bd-7a7bbcc240f3" class="outline-6">
<h6 id="h:cf87478a-456e-4798-83bd-7a7bbcc240f3">用 org-capture 来做任务管理</h6>
<div class="outline-text-6" id="text-h:cf87478a-456e-4798-83bd-7a7bbcc240f3">
<p>
和前面未分组的模板，有两个不同
</p>

<ul class="org-ul">
<li><p>
多了一个只有 key 和 description 而没有 entry/target/template 的 capture 模板，也就是
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'org-capture-templates '(<span style="color: #8b2252;">"t"</span> <span style="color: #8b2252;">"Tasks"</span>))
</pre>
</div>

<p>
这个模板至关重要，它设定了一组模板的名称和选择键前缀。如果缺失了这个模板，那么后面两个模板是不会起作用的。
</p></li>

<li>原来的两个任务模板，其选择键多了一个前缀 "t"</li>
</ul>

<p>
范例：用 org-capture 来做任务管理
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'org-capture-templates '(<span style="color: #8b2252;">"t"</span> <span style="color: #8b2252;">"Tasks"</span>))
(add-to-list 'org-capture-templates
             '(<span style="color: #8b2252;">"tr"</span> <span style="color: #8b2252;">"Book Reading Task"</span> entry
               (file+olp <span style="color: #8b2252;">"~/Dropbox/org/task.org"</span> <span style="color: #8b2252;">"Reading"</span> <span style="color: #8b2252;">"Book"</span>)
               <span style="color: #8b2252;">"* TODO %^{&#20070;&#21517;}\n%u\n%a\n"</span> <span style="color: #483d8b;">:clock-in</span> t <span style="color: #483d8b;">:clock-resume</span> t))
(add-to-list 'org-capture-templates
             '(<span style="color: #8b2252;">"tw"</span> <span style="color: #8b2252;">"Work Task"</span> entry
               (file+headline <span style="color: #8b2252;">"~/Dropbox/org/task.org"</span> <span style="color: #8b2252;">"Work"</span>)
               <span style="color: #8b2252;">"* TODO %^{&#20219;&#21153;&#21517;}\n%u\n%a\n"</span> <span style="color: #483d8b;">:clock-in</span> t <span style="color: #483d8b;">:clock-resume</span> t))
(add-to-list 'org-capture-templates
             '(<span style="color: #8b2252;">"tw"</span> <span style="color: #8b2252;">"Work Task"</span> entry
               (file+headline <span style="color: #8b2252;">"~/Dropbox/org/task.org"</span> <span style="color: #8b2252;">"Work"</span>)
               <span style="color: #8b2252;">"* TODO %^{&#20219;&#21153;&#21517;}\n%u\n%a\n"</span> <span style="color: #483d8b;">:clock-in</span> t <span style="color: #483d8b;">:clock-resume</span> t))
(add-to-list 'org-capture-templates
             '(<span style="color: #8b2252;">"tt"</span> <span style="color: #8b2252;">"Work Note"</span> entry
               (file+headline <span style="color: #8b2252;">"~/Dropbox/org/task.org"</span> <span style="color: #8b2252;">"Notes"</span>)
               <span style="color: #8b2252;">"* TODO %^{&#20219;&#21153;&#21517;} %^g\n%T\n:PROPERTIES:\n:TIMESTAMP: %t\n:END:%?\n"</span> <span style="color: #483d8b;">:empty-lines</span> 1 <span style="color: #483d8b;">:prepend</span> t ))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(file+olp "~/Dropbox/org/task.org" "Reading" "Book") ;; &#38656;&#35201;&#21019;&#24314;&#25991;&#20214;&#24182;&#26377;&#19968;&#32423;&#26631;&#39064;Reading&#21644;&#20108;&#32423;&#26631;&#39064;Book</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">%a &#20250;&#36229;&#36830;&#25509;&#24403;&#21069;buffer&#20869;&#23481;&#65292;   :empty-lines 1 &#26032;&#39033;&#30446;&#21069;&#21518;&#25554;&#20837;&#30340;&#34892;&#25968;&#35774;&#32622;&#20026;1</span>
</pre>
</div>




<figure id="orgbe46a6c">
<img src="./images/image-20211226015546692.png" alt="image-20211226015546692.png">

</figure>


<figure id="org669b654">
<img src="./images/image-20211226015618146.png" alt="image-20211226015618146.png">

</figure>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">\*</span> Reading

<span style="color: #8b2252;">\*</span>* Book
<span style="color: #8b2252;">\*</span>** TODO hello
:LOGBOOK:
CLOCK: [2021-12-26 &#21608;&#26085; 00:59]--[2021-12-26 &#21608;&#26085; 00:59] =&gt;  0:00
:END:
[2021-12-26 &#21608;&#26085;]
[[file:~/Dropbox/org/task.org::*Book][book]]
cf
<span style="color: #8b2252;">\*</span>** TODO sfffs
:LOGBOOK:
CLOCK: [2021-12-26 &#21608;&#26085; 01:06]--[2021-12-26 &#21608;&#26085; 01:06] =&gt;  0:00
:END:
[2021-12-26 &#21608;&#26085;]
[[file:~/Dropbox/org/journal.org::*<span style="color: #8b2252;">\[</span>2021-12-26 &#21608;&#26085; 00:42<span style="color: #8b2252;">\]</span> - sff][[2021-12-26 &#21608;&#26085;sffsf 00:42] - sff]]

ssffsf
<span style="color: #8b2252;">\*</span> Work
<span style="color: #8b2252;">\*</span>* TODO a1
:LOGBOOK:
CLOCK: [2021-12-26 &#21608;&#26085; 01:11]--[2021-12-26 &#21608;&#26085; 01:11] =&gt;  0:00
:END:
[2021-12-26 &#21608;&#26085;]
[[file:d:/work/202112/test.org::*Ref ;; &#22238;&#39038;][Ref ;; &#22238;&#39038;]]
<span style="color: #8b2252;">\*</span> Notes

<span style="color: #8b2252;">\*</span>* TODO task1                                                           :sf:
&lt;2021-12-26 &#21608;&#26085; 01:52&gt;
:PROPERTIES:
:TIMESTAMP: &lt;2021-12-26 &#21608;&#26085;&gt;
:END:
jlsjflsjfssfsf

<span style="color: #8b2252;">\*</span>* TODO task2                                                           :sf:
&lt;2021-12-26 &#21608;&#26085; 01:50&gt;
:PROPERTIES:
:TIMESTAMP: &lt;2021-12-26 &#21608;&#26085;&gt;
:END:
</pre>
</div>


<figure id="org3c70557">
<img src="./images/image-20211226020413135.png" alt="image-20211226020413135.png">

</figure>
</div>
</div>
</div>
<div id="outline-container-h:0ac65517-296c-45c7-83ac-1f75d4b647c1" class="outline-5">
<h5 id="h:0ac65517-296c-45c7-83ac-1f75d4b647c1">用 org-capture 来记录日志</h5>
<div class="outline-text-5" id="text-h:0ac65517-296c-45c7-83ac-1f75d4b647c1">
<p>
做日志记录、日记写作一类的事情，新增的内容和过去的内容都按时间顺序排列，方便我们进行回顾。
</p>

<p>
做日志记录时，比较推荐用 file+datetree 或者 file+weektree 这两个 target type，当然也不是绝对的，比如说下面这个 capture 模板也是满足基本要求的
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'org-capture-templates
             '(<span style="color: #8b2252;">"j"</span> <span style="color: #8b2252;">"Journal"</span> entry (file <span style="color: #8b2252;">"~/Dropbox/org/journal.org"</span>)
               <span style="color: #8b2252;">"* %U - %^{heading}\n  %?"</span>))
</pre>
</div>

<p>
上述模板在每次执行后，在 journal.org 的尾部插入下面这样的内容
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* [2018-03-24 &#20845; 21:42] - &#26576;&#20214;&#20107;&#24773;&#30340;&#35760;&#24405;

  &#20855;&#20307;&#30340;&#35760;&#24405; blablabla
</pre>
</div>

<p>
就是如果想要快速地找到某一天或者某一个月的记录，会稍微费力一点，使用 file+datetree 的话，新增的记录会按照「年-月-日」的层次组织起来；而使用 file+weektree 的话，新增的记录会按「年-周-日」的层次组织，下图是两者的对比
</p>


<figure id="org7e2f42e">
<img src="./images/image-20211226004606710.png" alt="image-20211226004606710.png">

</figure>

<p>
我个人目前是使用 file+datetree 的。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'org-capture-templates
                  '(<span style="color: #8b2252;">"j"</span> <span style="color: #8b2252;">"Journal"</span>
                    entry (file+datetree <span style="color: #8b2252;">"~/Dropbox/org/journal.org"</span>)
                    <span style="color: #8b2252;">"* %U - %^{heading} %^g\n %?\n"</span>
                    ))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:282b011f-943d-4d71-89b7-266199975026" class="outline-5">
<h5 id="h:282b011f-943d-4d71-89b7-266199975026">用 org-capture 收集灵感、记录笔记</h5>
<div class="outline-text-5" id="text-h:282b011f-943d-4d71-89b7-266199975026">
<p>
这类模板也比较简单，基本上用 `file+headline` 的 target，然后视情况而定预先设置 tag 什么的。
</p>

<p>
我个人有一个 capture 模板，用来快速记录未归类的东西，然后会在后面使用 refile 来将这些东西迁移到任务或者笔记中
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'org-capture-templates
             '(<span style="color: #8b2252;">"i"</span> <span style="color: #8b2252;">"Inbox"</span> entry (file <span style="color: #8b2252;">"~/Dropbox/org/inbox.org"</span>)
               <span style="color: #8b2252;">"* %U - %^{heading} %^g\n %?\n"</span>))
</pre>
</div>

<p>
笔记则用另外一个 capture 模板
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'org-capture-templates
             '(<span style="color: #8b2252;">"n"</span> <span style="color: #8b2252;">"Notes"</span> entry (file <span style="color: #8b2252;">"~/Dropbox/org/notes/inbox.org"</span>)
               <span style="color: #8b2252;">"* %^{heading} %t %^g\n  %?\n"</span>))
</pre>
</div>

<p>
可以看到两个模板其实差不多，无非就是写入的文件不一样。实际上的不同之处在于，在我的笔记本 ~/Dropbox/org/notes/inbox.org 中，我设置了一些文件级别的 tag，如下所示
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">+TITLE: &#31508;&#35760;&#26412;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+STARTUP: hideall</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+TAGS: [coding: shell python]</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+TAGS: [shell: grep tail sed ssh]</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+TAGS: [python: ipython pandas numpy]</span>
</pre>
</div>

<p>
这样在特殊标记 `%^g` 展开的时候，就可以用上面设置的 tag 进行补全。
</p>



<p>
这个功能除了可以记录待办事项还有其他许许多多的功能例如获取将当前浏览器中的 URL（下面的例子只在 Mac OS X 平台有效）。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">YOUR_NAME/retrieve-chrome-current-tab-url</span>()
  <span style="color: #8b2252;">"Get the URL of the active tab of the first window"</span>
  (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">let</span> ((result (do-applescript
         (concat
          <span style="color: #8b2252;">"set frontmostApplication to path to frontmost application\n"</span>
          <span style="color: #8b2252;">"tell application \"Google Chrome\"\n"</span>
          <span style="color: #8b2252;">" set theUrl to get URL of active tab of first window\n"</span>
          <span style="color: #8b2252;">" set theResult to (get theUrl) \n"</span>
          <span style="color: #8b2252;">"end tell\n"</span>
          <span style="color: #8b2252;">"activate application (frontmostApplication as text)\n"</span>
          <span style="color: #8b2252;">"set links to {}\n"</span>
          <span style="color: #8b2252;">"copy theResult to the end of links\n"</span>
          <span style="color: #8b2252;">"return links as string\n"</span>))))
  (format <span style="color: #8b2252;">"%s"</span> (s-chop-suffix <span style="color: #8b2252;">"\""</span> (s-chop-prefix <span style="color: #8b2252;">"\""</span> result)))))
</pre>
</div>

<p>
更多有关 Org-capture 的内容可以在<a href="http://orgmode.org/manual/Capture.html">这里</a>找到。
</p>
</div>
<div id="outline-container-h:82d10c5c-3f1d-426d-8024-e0704c275228" class="outline-6">
<h6 id="h:82d10c5c-3f1d-426d-8024-e0704c275228">弹出capture窗口</h6>
<div class="outline-text-6" id="text-h:82d10c5c-3f1d-426d-8024-e0704c275228">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">F4 &#24377;&#20986;capture&#31383;&#21475; C-x 50&#20851;&#38381;&#31383;&#21475;</span>
(<span style="color: #a020f0;">defadvice</span> <span style="color: #0000ff;">org-capture-finalize</span>
    (after delete-capture-frame activate)
  <span style="color: #8b2252;">"Advise capture-finalize to close the frame"</span>
  (<span style="color: #a020f0;">if</span> (equal <span style="color: #8b2252;">"capture"</span> (frame-parameter nil 'name))
      (delete-frame)))

(<span style="color: #a020f0;">defadvice</span> <span style="color: #0000ff;">org-capture-destroy</span>
    (after delete-capture-frame activate)
  <span style="color: #8b2252;">"Advise capture-destroy to close the frame"</span>
  (<span style="color: #a020f0;">if</span> (equal <span style="color: #8b2252;">"capture"</span> (frame-parameter nil 'name))
      (delete-frame)))

(<span style="color: #a020f0;">use-package</span> noflet
  <span style="color: #483d8b;">:ensure</span> t )
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">make-capture-frame</span> ()
  <span style="color: #8b2252;">"Create a new frame and run org-capture."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (make-frame '((name . <span style="color: #8b2252;">"capture"</span>)))
  (select-frame-by-name <span style="color: #8b2252;">"capture"</span>)
  (delete-other-windows)
  (noflet ((switch-to-buffer-other-window (buf) (switch-to-buffer buf)))
          (org-capture)))
(global-set-key (kbd <span style="color: #8b2252;">"&lt;f4&gt;"</span>) 'make-capture-frame)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:560a4c45-0e44-4bd1-b4f1-d6e71fac844e" class="outline-6">
<h6 id="h:560a4c45-0e44-4bd1-b4f1-d6e71fac844e">我的配置</h6>
<div class="outline-text-6" id="text-h:560a4c45-0e44-4bd1-b4f1-d6e71fac844e">
<div class="org-src-container">
<pre class="src src-shell">;; org-mode&#35821;&#27861;&#39640;&#20142;
(require <span style="color: #8b2252;">'org)</span>
<span style="color: #8b2252;">(setq org-src-fontify-natively t)</span>

<span style="color: #8b2252;">;; &#35774;&#32622;&#40664;&#35748; Org Agenda &#25991;&#20214;&#30446;&#24405;</span>
<span style="color: #8b2252;">(global-set-key (kbd "C-c a") '</span>org-agenda)
(setq org-agenda-files <span style="color: #8b2252;">'("~/tmp/worker/node.org"))</span>

<span style="color: #8b2252;">;; org-capture &#24555;&#36895;&#26032;&#24314;&#20869;&#23481;</span>
<span style="color: #8b2252;">(global-set-key (kbd "C-c c") '</span>org-capture)
(setq org-capture-templates
      <span style="color: #8b2252;">'(</span>
<span style="color: #8b2252;">        ("t" "Todo" entry (file+headline "~/tmp/worker/node.org" "Workspace")</span>
<span style="color: #8b2252;">             "* TODO [#B] %?\n  %i\n %T" :prepend t)</span>
<span style="color: #8b2252;">        ("n" "Note" entry (file+olp "~/tmp/worker/node.org" "Notes")</span>
<span style="color: #8b2252;">         "* %u %? " :prepend t)</span>
<span style="color: #8b2252;">        ))</span>
<span style="color: #8b2252;">(use-package ox-reveal</span>
<span style="color: #8b2252;">  :ensure t)</span>

<span style="color: #8b2252;">(setq org-reveal-root "https://cdn.jsdelivr.net/npm/reveal.js") ;; &#20351;&#29992; reveal.js &#38656;&#35201;&#24341;&#20837; js</span>
<span style="color: #8b2252;">(setq org-reveal-mathjax t)</span>

<span style="color: #8b2252;">(use-package htmlize</span>
<span style="color: #8b2252;">  :pin melpa</span>
<span style="color: #8b2252;">  :ensure t</span>
<span style="color: #8b2252;">  :defer t</span>
<span style="color: #8b2252;">  )</span>

<span style="color: #8b2252;">(provide '</span>init-org)
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-h:d7edd865-58c1-49ae-bace-49d481cedb42" class="outline-4">
<h4 id="h:d7edd865-58c1-49ae-bace-49d481cedb42">GTD</h4>
<div class="outline-text-4" id="text-h:d7edd865-58c1-49ae-bace-49d481cedb42">
</div>
<div id="outline-container-h:21b79770-78d4-49b2-97fa-820e834feb76" class="outline-5">
<h5 id="h:21b79770-78d4-49b2-97fa-820e834feb76">什么是GTD</h5>
<div class="outline-text-5" id="text-h:21b79770-78d4-49b2-97fa-820e834feb76">
<p>
<a href="https://gettingthingsdone.com/">https://gettingthingsdone.com/</a> 清空大脑，将内容纳入系统
</p>


<figure id="orgb1293ac">
<img src="./images/image-20211221114937627.png" alt="image-20211221114937627.png">

</figure>

<p>
Get Things Done(GTD)，是一套时间管理方法，面对生活中如下情况：
</p>

<ul class="org-ul">
<li>有很多事情要做</li>
<li>每件事情有主次之分</li>
<li>个人精力有限
我们需要随时很方便的了解我们下一步要做什么，合理的安排我们有限的时间，集中精力完成更重要的事情。</li>
</ul>

<p>
“GTD通过帮助你更好的跟踪和管理你的思绪、需要做的和想做的事，从而使你能在合适的情境中静下心，集中精神完成最重要的任务。”
“GTD不是一蹴而就的。GTD是一套持续的系统，需要不断地实践才能让你更好的掌握，从而成为你信任的系统。”
</p>
</div>
</div>
<div id="outline-container-h:c0795252-3795-43ec-a1c4-c6b5858f989d" class="outline-5">
<h5 id="h:c0795252-3795-43ec-a1c4-c6b5858f989d"><b><b>GTD原则：</b></b></h5>
<div class="outline-text-5" id="text-h:c0795252-3795-43ec-a1c4-c6b5858f989d">
<p>
五步：<a href="https://gettingthingsdone.com/what-is-gtd/">https://gettingthingsdone.com/what-is-gtd/</a>
</p>



<ul class="org-ul">
<li>CAPTURE 收集，收集你所关注的，将您关注的任何和所有内容写入、记录或收集到收集工具中。</li>
<li>CLARIFY 处理，可操作吗？ 如果是，则决定下一步行动和项目（如果需要多个行动）。 如果不是，请决定它是垃圾、参考还是要搁置的东西。</li>
<li>ORGANIZE 管理，把它放在它该放的地方，在适当的地方放置您分类内容的提醒。</li>
<li>REFLECT 回顾，经常复习，更新和审查所有相关的系统内容以重新获得控制和关注。</li>
<li>ENGAGE 执行，简单地做
使用您值得信赖的系统自信而清晰地做出行动决策。</li>
</ul>




<figure id="orgd81cf9d">
<img src="./images/image-20211221102413865.png" alt="image-20211221102413865.png">

</figure>

<p>
图出处：<a href="https://en.wikipedia.org/wiki/Getting_Things_Done">https://en.wikipedia.org/wiki/Getting_Things_Done</a>
</p>

<ul class="org-ul">
<li>inbox 收集箱，</li>
<li>判断是否是可执行事情，不可执行的话，扔掉、放着以后做、可用的东西放到参考中；可执行，是否是一步可做完？</li>
<li>不是一步可做完，那就做项目计划任务拆分；是一步可做完的，那么是否超过2分钟能做完？</li>
<li>不超过2分钟能做完，做；超过2分钟能做完，是否是自己做？</li>
<li>不是自己做，安排别人做，等待任务；是自己做，约定时间去做</li>
<li>是约定时间做的，放到日程安排中；不是约定时间去做，放到计划开始时间中</li>
</ul>

<p>
建立清单
</p>
<ul class="org-ul">
<li>inbox 所有收集的信息</li>
<li>next step 马上要做的</li>
<li>project 项目，子清单</li>
<li>someday/maby 放着以后做</li>
<li>waitting for 等待别人完成</li>
<li>calendar 日程</li>
<li>回顾 清单是否要更新</li>
</ul>

<p>
范例：清单
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #b22222;">#+STARTUP: indent overview</span>
<span style="color: #b22222;">#+STARTUP: logdrawer ;; &#21551;&#21160;LOGBOOK drawer</span>
<span style="color: #b22222;">#+TAGS: #&#23567;&#24352;(z) #&#23567;&#24464;(x)</span>
<span style="color: #b22222;">#+TAGS: &#24037;(c) &#22242;(y) &#25919;(a)</span>
<span style="color: #b22222;">#+TAGS: @work(w) @home(h) laptop(l)</span>
<span style="color: #b22222;">#+TODO: TODO(t) SCH(s) WAIT(w) | DONE(d) CANCELED(c)</span>
<span style="color: #b22222;">#+TODO: REPORT(r) BUG(b) KNOWNCAUSE(k) | FIXED(f)</span>
<span style="color: #0000ff;">* Inbox</span>
<span style="color: #a0522d;">** Classic                                                        </span><span style="color: #a0522d; font-weight: bold;">:&#24037;:@work:</span>

<span style="color: #0000ff;">* Next Action ;; &#39532;&#19978;&#20570;</span>
<span style="color: #a0522d;">** </span><span style="color: #228b22; font-weight: bold;">DONE</span><span style="color: #a0522d;"> </span><span style="color: #bc8f8f;">&#25171;&#21360;&#26126;&#22825;&#20250;&#35758;&#35758;&#31243;</span>
<span style="color: #a0522d;">** </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #a0522d;"> &#20889;a&#39033;&#30446;&#39033;&#30446;&#35745;&#21010;&#20070;</span>
<span style="color: #a020f0;">SCHEDULED:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2021-12-21 &#21608;&#20108; 09:00&gt;</span>

<span style="color: #0000ff;">* Wait ;; &#23433;&#25490;&#32473;&#21035;&#20154;&#65292;&#21487;&#29992;&#26631;&#31614;&#20195;&#26367;</span>
<span style="color: #a0522d;">** </span><span style="color: #228b22; font-weight: bold;">DONE</span><span style="color: #a0522d;"> </span><span style="color: #bc8f8f;">&#23567;&#24352;&#30830;&#23450;&#39033;&#30446;&#35745;&#21010;&#20070;&#27169;&#22359;                                       </span><span style="color: #bc8f8f; font-weight: bold;">:#&#23567;&#24352;:</span>
<span style="color: #a020f0;">DEADLINE:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2021-12-21 &#21608;&#20108; 12:00&gt;</span>

<span style="color: #0000ff;">* Appointment ;; &#32422;&#23450;&#26102;&#38388;</span>
<span style="color: #a0522d;">** &#21442;&#25968;xx&#21457;&#24067;&#20250; </span><span style="color: #a020f0; text-decoration: underline;">&lt;2021-12-21 &#21608;&#20108; 14:00&gt;</span><span style="color: #a0522d;">                               </span><span style="color: #a0522d; font-weight: bold;">:&#35775;&#38382;:</span>

<span style="color: #0000ff;">* Project ;; &#22797;&#26434;&#20219;&#21153;</span>
<span style="color: #a0522d;">** &#24179;&#21488;&#24320;&#21457;</span>

<span style="color: #0000ff;">* Someday ;; &#20197;&#21518;&#35201;&#20570;</span>
<span style="color: #0000ff;">* Ref ;; &#22238;&#39038;</span>
</pre>
</div>

<p>
文件头
</p>


<figure id="orge890d6e">
<img src="./images/image-20211221115347360.png" alt="image-20211221115347360.png">

</figure>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #b22222;">#+STARTUP: overview ::&#21551;&#21160;&#26102;&#40664;&#35748;&#26174;&#31034;overview&#32423;&#21035;</span>
<span style="color: #b22222;">#+STARTUP: logdrawer ::&#21551;&#21160;LOGBOOK drawer</span>
<span style="color: #b22222;">#+TODO: TODO(t) SCH(s) WAIT(w) | DONE(d) CANCELED(c)</span>
<span style="color: #b22222;">#+TODO: ING(i) SUPERVISING(v) WAITINGFOR(f) | COMPLETED(m)</span>
<span style="color: #b22222;">#+TAGS: &#23567;&#24352;(z) &#23567;&#26446;&#65288;l&#65289; &#39532;&#24635;&#65288;m&#65289;</span>
<span style="color: #b22222;">#+COLUMNS: %1PRIORITY(P) %4TODO(ToDo) %30ITEM(Task) %TAGS(Tags)  %4Effort(Esti){:} %18DEADLINE(Deadline)</span>
<span style="color: #b22222;">#+OPTIONS: p:t ::&#23548;&#20986;&#26102;&#26174;&#31034;&#35745;&#21010;&#26085;&#26399; d:1 :: &#23548;&#20986;drawer</span>
<span style="color: #b22222;">#+HTML_HEAD: &lt;link rel="stylesheet" type="text/css" href="styles/readtheorg.css" /&gt;</span>
<span style="color: #b22222;">#+LANGUAGE: zh-CN  ::&#23548;&#20986;&#26102;&#65292;&#20250;&#26174;&#31034;&#8220;&#30446;&#24405;&#8221;&#32780;&#19981;&#26159;"table of contents"</span>
<span style="color: #b22222;">#+PROPERTY: Effort_ALL 0 0:10 0:20 0:30 1:00 1:30 2:00 2:30 3:00</span>
</pre>
</div>

<p>
使用org-mode 实现任务管理的简单流程
</p>

<ul class="org-ul">
<li>收集信息新建列表</li>
<li>设置状态和标签</li>
<li>设置时间</li>
<li>每天看agenda</li>
<li>及时更新完成状态</li>
<li><p>
归档
</p>

<div class="org-src-container">
<pre class="src src-shell">C-c $ &#23558;&#26631;&#39064;&#24402;&#26723;&#21040;&#21516;&#30446;&#24405;&#19979;&#21516;&#25991;&#20214;&#21517;_archive&#25991;&#20214;&#20013;
</pre>
</div></li>

<li>定期回顾</li>
</ul>
</div>
</div>
<div id="outline-container-h:ef7f7dc4-5772-4a0a-be8d-7024796f3998" class="outline-5">
<h5 id="h:ef7f7dc4-5772-4a0a-be8d-7024796f3998"><b><b>明确和组织</b></b></h5>
<div class="outline-text-5" id="text-h:ef7f7dc4-5772-4a0a-be8d-7024796f3998">
<p>
总体流程：
</p>

<p>
信息收集到inbox，明确任务内容，处理后组织入清单
</p>

<p>
明确任务
</p>

<p>
个性化明确任务
</p>


<figure id="orge5a7ab8">
<img src="./images/image-20211222052151612.png" alt="image-20211222052151612.png">

</figure>

<p>
明确、细化(目标：为了后续的过滤)
</p>

<p>
任务判断
</p>

<ul class="org-ul">
<li>是否可执行</li>
<li>是否在指定时间发生</li>
<li>是否可以即时处理的，直接做完(GTD 的2分钟原则)</li>
<li>简单任务不属于项目的，直接写在Todo条目下，任务状态为TODO</li>
<li>属于项目的，记入项目条目</li>
<li>非执行内容送他们去该去的地方</li>
</ul>

<p>
任务属性
</p>
<ul class="org-ul">
<li><p>
以动词开头
</p>

<p>
将任务转化为可交付成果，参考SMART
</p></li>

<li>明确是否授权(设置跟踪)</li>

<li>任务属性

<ul class="org-ul">
<li>TODO状态 <code>C-c C-t, S-RIGHT/LEFT  (org-todo)</code></li>

<li><p>
设置属性 <code>C-c C-x p</code>
</p>

<div class="org-src-container">
<pre class="src src-shell">:PROPERTIES:
:CATEGORY:   xxx
:END:
</pre>
</div></li>

<li>进度 <code>[0%] [0/0]</code></li>
</ul></li>
<li>明确优先级

<ul class="org-ul">
<li><p>
优先级可以自己定义，A最先做，B做完A之后，C不急
</p>

<p>
<code>S-UP/DOWN (org-priorty-up/down)</code>
</p></li>
</ul></li>

<li><p>
尽可能规划时间
</p>

<p>
schedule和deadline的使用 <code>C-c C-s (org-schedule)</code> , <code>C-c C-d (org-deadline)</code>
</p></li>

<li><p>
预估工作时间
</p>

<p>
时间范围 <code>--</code> 或预估时间 <code>C-c C-x e (org-set-effort)</code>
</p></li>

<li>设置标签

<ul class="org-ul">
<li><p>
人、地点、领域
</p>

<p>
<code>C-c C-q</code> 或 <code>C-c C-c (org-set-tags-command)</code>
</p></li>
</ul></li>

<li><p>
任务细节
</p>

<p>
背景、原则、目标、结果、初心
</p></li>
</ul>

<p>
范例：任务清单
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #b22222;">#+STARTUP: indent overview</span>
<span style="color: #b22222;">#+STARTUP: logdrawer ;; &#21551;&#21160;LOGBOOK drawer</span>
<span style="color: #b22222;">#+TAGS: #&#23567;&#24352;(z) #&#23567;&#24464;(x)</span>
<span style="color: #b22222;">#+TAGS: &#24037;(c) &#22242;(y) &#25919;(a)</span>
<span style="color: #b22222;">#+TAGS: @work(w) @home(h) laptop(l)</span>
<span style="color: #b22222;">#+TODO: TODO(t) SCH(s) WAIT(w) | DONE(d) CANCELED(c)</span>
<span style="color: #b22222;">#+TODO: REPORT(r) BUG(b) KNOWNCAUSE(k) | FIXED(f)</span>
<span style="color: #0000ff;">* Inbox</span>
<span style="color: #a0522d;">** Classic                                                        </span><span style="color: #a0522d; font-weight: bold;">:&#24037;:@work:</span>
<span style="color: #0000ff;">* Todo ;; &#39532;&#19978;&#20570;</span>
<span style="color: #a0522d;">** </span><span style="color: #228b22; font-weight: bold;">DONE</span><span style="color: #a0522d;"> </span><span style="color: #bc8f8f;">&#25171;&#21360;&#26126;&#22825;&#20250;&#35758;&#35758;&#31243;                                                </span><span style="color: #bc8f8f; font-weight: bold;">:&#24037;:</span>
<span style="color: #a0522d;">** </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #a0522d;"> &#20889;a&#39033;&#30446;&#39033;&#30446;&#35745;&#21010;&#20070;</span>
<span style="color: #a020f0;">SCHEDULED:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2021-12-21 &#21608;&#20108; 09:00&gt;</span>

<span style="color: #0000ff;">* Appointment ;; &#32422;&#23450;&#26102;&#38388;</span>
<span style="color: #a0522d;">** SCH </span><span style="color: #a020f0;">[#C]</span><span style="color: #a0522d;"> &#21442;&#25968;xx&#21457;&#24067;&#20250;                                              </span><span style="color: #a0522d; font-weight: bold;">:&#35775;&#38382;:</span>
<span style="color: #a020f0;">SCHEDULED:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2021-12-22 &#21608;&#19977; 15:00-16:00&gt;</span>
<span style="color: #0000ff;">:PROPERTIES:</span>
<span style="color: #a020f0;">:Effort:</span>   <span style="color: #000000; background-color: #ffffff;">1:00</span>
<span style="color: #0000ff;">:END:</span>
<span style="color: #a020f0;">*** &#20250;&#35758;&#20449;&#24687;</span>
- &#22320;&#28857;&#65306;808&#20250;&#35758;&#23460;
- &#19982;&#20250;&#20154;&#21592;&#65306;&#23567;&#24352;&#12289;&#23567;&#26446;
- &#35758;&#31243;
  1. &#35752;&#35770;a
  2. &#21046;&#23450;b

<span style="color: #0000ff;">* Project ;; &#22797;&#26434;&#20219;&#21153;</span>
<span style="color: #a0522d;">** &#24179;&#21488;&#24320;&#21457;</span>
<span style="color: #a020f0;">DEADLINE:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2021-12-24 &#21608;&#20116;&gt;</span>
<span style="color: #a020f0;">*** SCH &#38656;&#27714;&#35780;&#23457;</span>
<span style="color: #a020f0;">DEADLINE:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2021-12-22 &#21608;&#19977; 22:00&gt;</span>

<span style="color: #a020f0;">*** </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #a020f0;"> &#35745;&#21010;</span>

<span style="color: #0000ff;">* Someday ;; &#20197;&#21518;&#35201;&#20570;</span>
<span style="color: #0000ff;">* Ref ;; &#22238;&#39038;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:0bf3858b-23c7-4b6d-b813-292e1b4ac170" class="outline-5">
<h5 id="h:0bf3858b-23c7-4b6d-b813-292e1b4ac170">选择任务的操作</h5>
<div class="outline-text-5" id="text-h:0bf3858b-23c7-4b6d-b813-292e1b4ac170">
<ul class="org-ul">
<li>使用agenda视图

<ul class="org-ul">
<li>日、周、月的切换 <code>C-c a</code></li>
<li>前一天、后一天</li>
</ul></li>

<li>agenda视图分区的说明 
<ul class="org-ul">
<li><p>
Properties的设置，设置category区分。
</p>

<div class="org-src-container">
<pre class="src src-shell">:PROPERTIES:
:CATEGORY:   xxx
:END:
</pre>
</div></li>
</ul></li>

<li><p>
使用column view
</p>

<p>
agenda中 <code>C-c C-x C-c (org-columns)</code>
</p></li>

<li>选择的建议
<ul class="org-ul">
<li>先做当时安排的</li>
<li>根据deadline或schdule</li>
<li>先做困难的</li>
<li>先做重要的</li>
<li>根据场景</li>
<li>根据优先级</li>
<li>根据现在的时间资源</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:b7c8733b-a3e1-42d7-95a1-c3d4d20977d2" class="outline-5">
<h5 id="h:b7c8733b-a3e1-42d7-95a1-c3d4d20977d2">做</h5>
<div class="outline-text-5" id="text-h:b7c8733b-a3e1-42d7-95a1-c3d4d20977d2">
<ul class="org-ul">
<li><p>
任务计时
</p>

<div class="org-src-container">
<pre class="src src-shell">&#32553;&#23567;&#32534;&#36753;&#65306;C-x n s
org-clock-in C-c C-x TAB
org-clock-out C-c C-x C-o
</pre>
</div>

<p>
自定义菜单参考：<a href="http://xahlee.info/emacs/emacs/elisp_menu.html">http://xahlee.info/emacs/emacs/elisp_menu.html</a>
</p></li>
</ul>


<figure id="orgbe4fc4d">
<img src="./images/image-20211224071649050.png" alt="image-20211224071649050.png">

</figure>

<ul class="org-ul">
<li><p>
不被打断
</p>

<p>
专注后被打断，再回到专注需要时间
</p>

<p>
创造不被打断的环境
</p>

<ul class="org-ul">
<li>选好时间</li>
<li>阻止各类提醒</li>
<li>专注当前任务</li>
<li>软件全屏</li>
<li>不分心，不看手机</li>
</ul></li>
</ul>

<p>
<b>如果被打断</b>
</p>

<ul class="org-ul">
<li>如果打断边上的纸记一下，有时间，再inbox</li>
<li>推迟实体交流</li>
<li>如果被迫离开，写下当时的状态及准备下一步的思考</li>
</ul>
</div>
</div>
<div id="outline-container-h:95c78dc4-1e15-4655-8f98-b98a13d512c9" class="outline-5">
<h5 id="h:95c78dc4-1e15-4655-8f98-b98a13d512c9">回顾</h5>
<div class="outline-text-5" id="text-h:95c78dc4-1e15-4655-8f98-b98a13d512c9">
<p>
对于清单进行整理，将关注聚焦
</p>

<p>
参考GTD推荐的清单1
</p>

<p>
<a href="https://gettingthingsdone.com/2018/08/episode-43-the-power-of-the-gtd-weekly-review/?__cf_chl_jschl_tk__=293ce6e18d738aff49772509dc68692d6bd2dd89-1587888468-0-AZEDr2egKVh9NbL9p8mU7JWVvrD_RVcLmDhW9k6CZcYSLsODbaMCwyosHw2yN1UHskful7Wr8XYz4VFgf7Hqx29i5QTl-aruJG_OQDUcNdHQAgY_AjDVs-gG9P_az_TPr1Yg7tbLIdepIWml2slV2uEwbz2e-mrzaErpHYl6m_LKK0qHNBmoeHCe_4n65xZ9StBO4wJI6JwgYJA-jZFLdcEJBIxErzMZJFjt--lMEcplvZwgo__vytsxCNlufe8u3LYp4AWdQwSHWdp_q9VcDpckEAfqoio4B0cbes1QSLW2Fq6vz8CRfiC53-VQejbKMqxgXpPC_NobL22OkrUqr5HxR7rHYBfAArW9Lx7_Xg9T1UfzsQpEbI_f79qTsNOReRLK93wS8MnG_q0QHYfWOTc">GTD Weekly Review</a>
</p>

<p>
GET CLEAR 清空大脑
</p>

<ul class="org-ul">
<li><p>
COLLECT LOOSE PAPERS AND MATERIALS
</p>

<p>
Gather all accumulated business cards, receipts, and miscellaneous paper-based materials into your in-tray.
</p></li>

<li><p>
GET “IN” TO ZERO
</p>

<p>
Process completely all outstanding paper materials, journal and meeting notes, voicemails, dictation, and emails.
</p></li>

<li><p>
EMPTY YOUR HEAD
</p>

<p>
Put in writing and process any uncaptured new projects, action items, waiting fors, someday/maybes, etc.
</p></li>
</ul>

<p>
GET CURRENT 关注当下
</p>

<ul class="org-ul">
<li><p>
REVIEW NEXT ACTIONS LISTS
</p>

<p>
Mark off completed actions. Review for reminders of further action steps to record.
</p></li>

<li><p>
REVIEW PREVIOUS CALENDAR DATA
</p>

<p>
Review past calendar in detail for remaining action items, reference data, etc., and transfer into the active system.
</p></li>

<li><p>
REVIEW UPCOMING CALENDAR
</p>

<p>
Review upcoming calendar events—long and short term. Capture actions triggered.
</p></li>

<li><p>
REVIEW WAITING FOR LIST
</p>

<p>
Record appropriate actions for any needed follow-up. Check off received ones.
</p></li>

<li><p>
REVIEW PROJECT (AND LARGER OUTCOME) LISTS
</p>

<p>
Evaluate status of projects, goals, and outcomes, one by one, ensuring at least one current next action item on each. Browse through project plans, support material, and any other work-in-progress material to trigger new actions, completions, waiting fors, etc.
</p></li>

<li><p>
REVIEW ANY RELEVANT CHECKLISTS
</p>

<p>
Use as a trigger for any new actions.
</p></li>
</ul>

<p>
GET CREATIVE 创造
</p>

<ul class="org-ul">
<li><p>
REVIEW SOMEDAY/MAYBE LIST
</p>

<p>
Review for any projects or actions which may now have become active, and transfer to the appropriate list. Delete items no longer of interest.
</p></li>

<li><p>
BE CREATIVE &amp; COURAGEOUS
</p>

<p>
Any new, wonderful, hare-brained, creative, thought-provoking, risk-taking ideas to add into your system?
</p></li>
</ul>

<p>
周回顾模板2
</p>

<p>
<a href="https://lite.evernote.com/note/101bcfff-0bbf-49a6-98b2-fbfd16fc01ea">https://lite.evernote.com/note/101bcfff-0bbf-49a6-98b2-fbfd16fc01ea</a>
</p>

<ul class="org-ul">
<li class="trans"><code>[-]</code> 灵魂拷问
<ul class="org-ul">
<li>Does this list fully represent my priorities, interests, values, and long-term goals?</li>
<li>In which Areas of Responsibility do I have too many Projects? Not enough?</li>
<li>Are there important outcomes or goals that don’t have any Projects targeted at them?</li>
<li>Am I spending time or attention on something that has no clear outcome or goal?</li>
<li>If anything is unclear, ask yourself, “What am I really trying to accomplish here?” or “What‘s the point of doing this?”</li>
<li>With this whole inventory in front of you, are there any Projects you want to kill, postpone, renegotiate, or clarify?</li>
</ul></li>
<li>捕获 Gather any loose papers, post-it notes, etc. and bring them into your inbox or scan to Evernote.</li>
<li>清空 物理 Clear desk / wallet / briefcase / purse / etc. Clear physical inbox 电子 Clear digital inboxes Clear computer: clean desktop, clean downloads folder, empty trash Clear phone: voicemails and text messages 大脑 My Personal Trigger List 清空大脑</li>
<li>回顾 Review Calendar Review Projects &amp; Next Actions Review Checklists Review Waiting For and Delegated Projects Review Someday/Maybe List</li>
<li>内省 Things I’m proud of from this week Areas to improve for next week Any new and great ideas?</li>
</ul>



<p>
操作
</p>

<p>
更新状态
</p>

<ul class="org-ul">
<li><p>
任务内容补充
</p>

<p>
直接编辑 
</p></li>

<li>任务状态的更新 <code>C-c C-t</code></li>

<li>任务时间更新 <code>C-c C-s C-c C-d</code></li>

<li>优先级的更新 <code>S-up/down</code></li>
</ul>

<p>
调整顺序
</p>

<p>
<code>M-up/down</code>, <code>C-x/v</code> 注意被隐藏的部分，设置 <code>org-catch-invisible-edits</code> 属性
</p>



<p>
搁置任务的调整
</p>

<p>
<b>原因</b>
</p>

<p>
在整理任务清单的过程中，一定会发现一些搁置的项目，想一想未来重启的触发条件：
</p>

<ol class="org-ol">
<li>等待一个固定的时间。</li>
<li>等待某个人（或机构）的明确指令或回复。</li>
<li>等待其它触发条件</li>
</ol>

<p>
<b>操作</b>
</p>

<ol class="org-ol">
<li>将搁置的任务放入单独的清单。</li>
<li>为这些清单设置触发条件，主要是日期。</li>
<li>在每周回顾中回顾这些清单</li>
</ol>
</div>
</div>
<div id="outline-container-h:d79ac030-7a30-493c-bff2-1694b0251b2e" class="outline-5">
<h5 id="h:d79ac030-7a30-493c-bff2-1694b0251b2e">归档</h5>
<div class="outline-text-5" id="text-h:d79ac030-7a30-493c-bff2-1694b0251b2e">
<p>
2种模式
</p>

<ul class="org-ul">
<li>Archive</li>
<li>Refile</li>
</ul>

<p>
<b>Archive</b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">C-c $ (org-archive-subtree)
</pre>
</div>

<ul class="org-ul">
<li>优点：不同的清单可以设置归档到的文件或条目下</li>

<li><p>
缺点：
</p>

<p>
控制度较小，归档都放在同一级
</p>

<p>
可以设置不同条目下的归档设置，但是需提前设置，设置不同条目的清单会增加清单的复杂度
</p></li>
</ul>

<p>
<b>Refile</b>
</p>

<ul class="org-ul">
<li>优点：可以在归档时灵活选择</li>
<li>缺点：由于主要的功能用于归档，影响本文件的归档使用</li>
</ul>

<p>
归档的操作
创建归档的文件，设置需要的分类。
配置文件中进行配置
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#28155;&#21152;&#25991;&#20214;&#36335;&#24452;&#65292;&#24182;&#19988;&#21482;&#36716;&#31227;&#21040;2&#32423;&#26631;&#39064;&#19979;</span>
(<span style="color: #a020f0;">setq</span> org-refile-targets  '((<span style="color: #8b2252;">"C:/Refile.org"</span> <span style="color: #483d8b;">:level</span> . 2)
                             <span style="color: #8b2252;">"C:/Refile2.org"</span> <span style="color: #483d8b;">:level</span> . 2)
                             ))
</pre>
</div>

<p>
refile操作 <code>C-c C-w org-refile</code>
</p>

<p>
项目清单的归档
在一个项目开始的时候，我通常我会在电脑中建一个文件夹，以项目的名称命名，如： 2021-党支部-第三支部换届 ，在项目开展过程中，所有项目相关的文件我会保存在这个文件夹内。注意，以上操作与OrgMode无关。
</p>

<p>
在项目开始的同时，我要在我的日程管理org文件中的Project条目下建一个条目：
</p>
<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* Project</span>
  ** &#31532;&#19977;&#25903;&#37096;&#25442;&#23626;
  &#39033;&#30446;&#36807;&#31243;&#35760;&#24405;&#8230;&#8230;
</pre>
</div>
<p>
项目完成后，我会将所有项目相关的文件整理后，归档 org 文件中的内容
</p>

<p>
在项目文件夹（如： 2021-党支部-第三支部换届 ）下新建一个空白的 .org 文件，如： 2021-党支部-第三支部换届.org
将我日程管理org文件中所有项目条目下的内容剪切到新org文件中去，并保存。
</p>
</div>
</div>
<div id="outline-container-h:dcbc7c79-e43f-4aea-a456-23b64d194bf8" class="outline-5">
<h5 id="h:dcbc7c79-e43f-4aea-a456-23b64d194bf8">org-pomodoro 番茄时间工作法的插件</h5>
<div class="outline-text-5" id="text-h:dcbc7c79-e43f-4aea-a456-23b64d194bf8">
<p>
Org-pomodoro 是一个番茄时间工作法的插件（更多关于这个工作法的信息可以在<a href="https://en.wikipedia.org/wiki/Pomodoro_Technique">这里</a>找到）。 它的 GitHub 地址在<a href="https://github.com/lolownia/org-pomodoro">这里</a>。在 <code>(require 'org-pomodoro)</code> 后可以通过 Customize-group 来对其进行设置，包括不同休息种类的时长。
</p>

<ul class="org-ul">
<li>Org-pomodoro <a href="https://github.com/lolownia/org-pomodoro">https://github.com/lolownia/org-pomodoro</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my/packages</span> '(
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#30058;&#33540;&#24037;&#20316;&#27861;</span>
         org-pomodoro
         ) <span style="color: #ff0000; font-weight: bold;">"Default packages"</span><span style="color: #ff0000; font-weight: bold;">)</span>
</pre>
</div>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">org-pomodoro&#30058;&#33540;&#24037;&#20316;&#27861;</span>
(<span style="color: #a020f0;">use-package</span> org-pomodoro
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<p>
需要把时间置顶的可以用这个方法 <a href="https://emacs-china.org/t/org-pomodoro-emacs/10933">https://emacs-china.org/t/org-pomodoro-emacs/10933</a>
</p>

<p>
因为每次保存中文的时候都需要选择解码，我们可以使用下面的配置将文本解码设置默认为 UTF-8，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#25991;&#26412;&#35299;&#30721;&#40664;&#35748;&#20026; UTF-8</span>
(set-language-environment <span style="color: #8b2252;">"UTF-8"</span>)
</pre>
</div>

<p>
当 org-mode 不能生效时，我们需要将与 Org 相关的配置放置于 <code>with-eval-after-load</code> 中，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> 'org
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Org &#27169;&#24335;&#30456;&#20851;&#35774;&#23450;</span>
  )
</pre>
</div>

<p>
~/.emacs.d/lisp/init-org.el文件
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> 'org
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Org &#27169;&#24335;&#30456;&#20851;&#35774;&#23450;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-mode&#35821;&#27861;&#39640;&#20142;</span>
  (<span style="color: #a020f0;">setq</span> org-src-fontify-natively t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#40664;&#35748; Org Agenda &#25991;&#20214;&#30446;&#24405;</span>
  (<span style="color: #a020f0;">setq</span> org-agenda-files '(<span style="color: #8b2252;">"d:/xxx"</span>))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-capture-templates&#24555;&#36895;&#35760;&#31508;&#35760;</span>
  (<span style="color: #a020f0;">setq</span> org-capture-templates
  '((<span style="color: #8b2252;">"t"</span> <span style="color: #8b2252;">"Todo"</span> entry (file+headline <span style="color: #8b2252;">"d:/xxx/gtd.org"</span> <span style="color: #8b2252;">"&#24037;&#20316;&#23433;&#25490;"</span>)
     <span style="color: #8b2252;">"* TODO [#B] %?\n  %i\n"</span>
     <span style="color: #483d8b;">:empty-lines</span> 1))) 

  )

(global-set-key (kbd <span style="color: #8b2252;">"C-c r"</span>) 'org-capture)

(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">init-org</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:10cebcd1-5f46-415e-8fda-b002691efbcf" class="outline-5">
<h5 id="h:10cebcd1-5f46-415e-8fda-b002691efbcf">google日历</h5>
<div class="outline-text-5" id="text-h:10cebcd1-5f46-415e-8fda-b002691efbcf">
<p>
使用 org-gcal 与我的 Google 日历同步约会，同时使用我的主组织文件作为我的待办事项列表。
</p>

<ul class="org-ul">
<li>org-gcal <a href="https://github.com/myuhe/org-gcal.el">https://github.com/myuhe/org-gcal.el</a></li>
</ul>

<p>
将 OAuth 服务器配置为通过 Google 日历集成读取数据
</p>

<ul class="org-ul">
<li>打开google开发者平台<a href="https://console.developers.google.com/project">Google Developers Console</a>创建一个项目using emacs，在API和服务中找到Google Calendar API启用</li>
<li>OAuth 同意屏幕设置</li>
<li>添加凭证OAuth 2.0 客户端 ID</li>
</ul>

<p>
emacs 配置
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">google&#26085;&#21382;</span>
(<span style="color: #a020f0;">setq</span> package-check-signature nil)

(<span style="color: #a020f0;">use-package</span> org-gcal
<span style="color: #483d8b;">:ensure</span> t
<span style="color: #483d8b;">:config</span>
(<span style="color: #a020f0;">setq</span> org-gcal-client-id <span style="color: #8b2252;">"oauth 2.0 client ID"</span>
org-gcal-client-secret <span style="color: #8b2252;">"client secret"</span>
org-gcal-file-alist '((<span style="color: #8b2252;">"xcwhome@gmail.com"</span> .  <span style="color: #8b2252;">"~/Dropbox/orgfiles/gcal.org"</span>))))
<span style="color: #b22222;">;;</span><span style="color: #b22222;">&#21516;&#27493;&#26085;&#21382;&#21246;&#23376;</span>
(add-hook 'org-agenda-mode-hook (<span style="color: #a020f0;">lambda</span> () (org-gcal-sync) ))
(add-hook 'org-capture-after-finalize-hook (<span style="color: #a020f0;">lambda</span> () (org-gcal-sync) ))
</pre>
</div>

<p>
访问google日历验证 <a href="https://calendar.google.com/calendar">https://calendar.google.com/calendar</a>
</p>

<p>
参考设置：<a href="https://cestlaz.github.io/posts/using-emacs-26-gcal/">https://cestlaz.github.io/posts/using-emacs-26-gcal/</a>
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-h:91421128-fd0a-4569-9a43-32d58459dee8" class="outline-3">
<h3 id="h:91421128-fd0a-4569-9a43-32d58459dee8">使用Agenda来查看日程</h3>
<div class="outline-text-3" id="text-h:91421128-fd0a-4569-9a43-32d58459dee8">
<p>
我们Emacs做GTD工具的核心功能就是Agenda功能，他是一个可以实时查看自己有哪些任务，以及每个任务完成进度的功能，我们可以通过 <code>M-x org-agenda</code> 来打开，也可以自定义快捷键。
</p>

<p>
不过首先你需要建立一个专门存放你的GTD文件的目录，并且将org-agenda的目录指定为该目录。
</p>
</div>
<div id="outline-container-h:38013889-ca2c-4da9-b28d-a256b4e73591" class="outline-4">
<h4 id="h:38013889-ca2c-4da9-b28d-a256b4e73591">设置</h4>
<div class="outline-text-4" id="text-h:38013889-ca2c-4da9-b28d-a256b4e73591">
<ul class="org-ul">
<li><p>
org-agenda-files
</p>

<div class="org-src-container">
<pre class="src src-shell">C-c [ == org-agenda-file-to-front  &#23558;&#24403;&#21069;&#25991;&#20214;&#21152;&#20837;&#20840;&#23616;&#21015;&#34920;
C-c ] &#23558;&#24403;&#21069;&#25991;&#20214;&#31227;&#38500;&#20840;&#23616;&#21015;&#34920;
C-c C-x &lt; &#38145;&#23450;&#24403;&#21069;&#25991;&#20214;&#21363;&#22312;org agenda&#30340;buffer&#20013;&#21482;&#26174;&#31034;&#24403;&#21069;&#25991;&#20214;&#30340;&#26085;&#31243;&#65288;org-agenda-set-restriction-lock&#65289;
C-c C-x &gt; &#35299;&#38145;(org-agenda-remove-restriction-lock)
</pre>
</div>

<p>
配置文件设置
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#40664;&#35748; Org Agenda &#25991;&#20214;&#30446;&#24405;</span>
(<span style="color: #a020f0;">setq</span> org-agenda-files '(<span style="color: #8b2252;">"~/org"</span>))
</pre>
</div></li>

<li><p>
org-agenda
</p>

<p>
设置快捷键
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622; org-agenda &#25171;&#24320;&#24555;&#25463;&#38190;</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-c a"</span>) 'org-agenda)
</pre>
</div>

<p>
你只需将你的 <code>*.org</code> 文件放入上面所指定的文件夹中就可以开始使用 Agenda 模式了。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#35201;&#21152;&#36733;&#30340;agenda&#25991;&#20214;</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-c a"</span>) 'org-agenda)
(<span style="color: #a020f0;">setq</span> org-agenda-files (list <span style="color: #8b2252;">"~/Dropbox/orgfiles/gcal.org"</span>
                             <span style="color: #8b2252;">"~/Dropbox/orgfiles/i.org"</span>
                             <span style="color: #8b2252;">"~/Dropbox/orgfiles/schedule.org"</span>))
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-h:ae196bae-d5e4-4f8a-bf5a-1ccc187fff50" class="outline-4">
<h4 id="h:ae196bae-d5e4-4f8a-bf5a-1ccc187fff50">Agenda 的使用</h4>
<div class="outline-text-4" id="text-h:ae196bae-d5e4-4f8a-bf5a-1ccc187fff50">
<p>
启用 <code>C-c a</code>  打开 Agenda 模式菜单并选择不同的可视方式
</p>

<p>
常用条件： a, t
</p>

<ul class="org-ul">
<li><p>
a (d/w 当天或本周，默认本周显示)
</p>

<p>
b 上一个星期，f 下一个星期，空格或TAB指向清单文件，t 切换待办状态，g 刷新状态，s 保存到文件中， R查看当天任务完成时间
</p></li>

<li><p>
t 列出所有清单，显示TODO状态的清单
</p>

<p>
1 所有todo 2&#x2026;
</p></li>
</ul>

<p>
除了 a t T 之外，其它并不实用，特别是那几条搜索的命令。
</p>

<div class="org-src-container">
<pre class="src src-shell">a Agenda for current week or day &#36825;&#20010;&#26368;&#24120;&#29992;&#65292;&#26174;&#31034;&#21608;&#30340;&#26085;&#31243;
t list of all TODO entries &#36825;&#20010;&#21487;&#20197;&#25226;&#25152;&#26377;&#26377;&#30528;TODO&#29366;&#24577;&#30340;&#28165;&#21333;&#21015;&#20986;&#26469;
T Entries with special TODO kwd &#21644;&#19978;&#19968;&#26465;&#31867;&#20284;&#65292;&#36807;&#31243;&#20013;&#20250;&#22686;&#21152;&#19968;&#20010;&#36807;&#28388;&#26465;&#20214;&#65292;&#26174;&#31034;&#25351;&#23450;&#30340;TODO&#20851;&#38190;&#23383;&#30340;&#28165;&#21333;
m Match a TAGS/PROP/TODO query &#26681;&#25454;tag&#26469;&#36807;&#28388;&#26174;&#31034;&#28165;&#21333;
M Likd m, but only TODO entries &#21644;m&#21151;&#33021;&#30456;&#21516;&#65292;&#20294;&#21482;&#26174;&#31034;&#24102;&#26377;TODO&#20851;&#38190;&#23383;&#30340;&#28165;&#21333;
s search for keywords &#26681;&#25454;&#20851;&#38190;&#23383;&#25628;&#32034;
S Like s, but only TODO entries &#21644;s&#21151;&#33021;&#30456;&#21516;&#65292;&#20294;&#21482;&#26174;&#31034;&#24102;&#26377;TODO&#20851;&#38190;&#23383;&#30340;&#28165;&#21333;
/ Multi-occur
? Find :FLAGGED: entries
<span style="color: #b22222;"># </span><span style="color: #b22222;">Toggle sticky agenda views</span>
&lt; Brffer, subtree/region restriction &#38480;&#23450;&#33539;&#22260;
&gt; Remove restriction &#21462;&#28040;&#38480;&#23450;
e Export agenda views
<span style="color: #b22222;"># </span><span style="color: #b22222;">List stuck project &#26174;&#31034;&#20572;&#28382;&#30340;&#39033;&#30446;&#65292;&#20309;&#20026;&#20572;&#28382;&#65292;&#21487;&#20197;&#33258;&#23450;&#20041;&#65292;&#25353; ! &#23601;&#21487;&#36827;&#20837;&#33258;&#23450;&#20041;&#33756;&#21333;</span>
C Configure custom agenda commands &#25171;&#24320;&#33258;&#23450;&#20041;agenda&#37197;&#32622;&#30340;&#30028;&#38754;
</pre>
</div>

<p>
其他快捷键及功能：
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">快捷键</th>
<th scope="col" class="org-left">功能</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">b</td>
<td class="org-left">daily视图</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">w</td>
<td class="org-left">weekly视图</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">n/p</td>
<td class="org-left">上/下移动光标</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">N/P</td>
<td class="org-left">上/下按日程移动光标</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">SPC</td>
<td class="org-left">在另一缓冲区显示任务在org文件中的定义的位置</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">TAB</td>
<td class="org-left">在另一缓冲区显示任务在org文件中的定义的位置，并且光标跳转至此</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">L</td>
<td class="org-left">显示任务在文件中位置并且光标居中</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">RET</td>
<td class="org-left">在当前buffer打开文件并跳转</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">F</td>
<td class="org-left">打开跟踪模式，即移动光标时，另一buffer显示当前任务的定义处</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-c C-x b</td>
<td class="org-left">显示任务及子树，并可以设置层数</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-c C-o</td>
<td class="org-left">打开链接</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">关闭另一个buffer</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">A</td>
<td class="org-left">打开另一种视图并嵌入到当前视图中</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">弹出多个命令进行选择</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">f/b</td>
<td class="org-left">下一天</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">跳转至当天</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">j</td>
<td class="org-left">选择日期并跳转</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">D</td>
<td class="org-left">包含日记</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">刷新agenda buffer</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&lt;</td>
<td class="org-left">通过类型过滤</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">^</td>
<td class="org-left">通过 top headline 过滤</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">=</td>
<td class="org-left">通过模式匹配过滤</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">\</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">去除所有过滤</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">改变状态</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-S-Left/C-S-Right</td>
<td class="org-left">改变状态</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-k</td>
<td class="org-left">删除</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-w</td>
<td class="org-left">重新归档某项日程</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">$</td>
<td class="org-left">归档，通常是另一个文件</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">T</td>
<td class="org-left">显示所有tag</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">:</td>
<td class="org-left">设置tag</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">,</td>
<td class="org-left">设置优先级</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">+/- 或者 S-up/down</td>
<td class="org-left">设置优先级</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">z</td>
<td class="org-left">添加note</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-c C-a</td>
<td class="org-left">附件</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-c C-s</td>
<td class="org-left">安排日程</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-c C-d</td>
<td class="org-left">设置deadline</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">S-Left/Right</td>
<td class="org-left">改变日期</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&gt;</td>
<td class="org-left">改变日期</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">I</td>
<td class="org-left">插入clock</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">O</td>
<td class="org-left">停止上一个clock</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">X</td>
<td class="org-left">取消当前clock</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">J</td>
<td class="org-left">跳转之clock处</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">M-Up/Down</td>
<td class="org-left">拖拽一个日程</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">m</td>
<td class="org-left">mark当前日程</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">*</td>
<td class="org-left">mark所有日程为重点</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">取消mark当前日程</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">U</td>
<td class="org-left">取消mark所有日程</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">M-m</td>
<td class="org-left">设置/取消当前mark</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">M-×</td>
<td class="org-left">设置/取消所有mark</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">B</td>
<td class="org-left">bulk action</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-x C-w</td>
<td class="org-left">导出。可以为.html .pdf .ps .org</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">q</td>
<td class="org-left">退出</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">x</td>
<td class="org-left">退出，包括所有相关打开的buffer</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
太多了，大家通过帮助自己尝试吧。
</p>

<p>
<b>Weekly/daily 视图</b>
</p>

<p>
输入M-x org-agenda 时， 选择a 进入此视图。
</p>

<p>
在此视图中，操作在上一节介绍过。大家实践一下，通常使用的也就几个功能，碰到需要用的其他，再来查询具体快捷键。
</p>

<p>
<b>ToDo 视图</b>
</p>

<p>
输入M-x org-agenda 时， 选择t/T 进入此视图。
 t， 列出所有的todo
</p>

<p>
T，可以选择特殊的key来进行过滤。
</p>

<p>
<b>Tag和属性过滤视图</b>
</p>

<p>
输入M-x org-agenda 时， 选择m/M 进入此视图。
 m， 根据tag进行过滤
</p>

<p>
&gt; 语法：
&gt;  ‘work’：  选择tag ‘:work:’.
&gt;  ‘work&amp;boss’： 选择tag ‘:work:’ 和 ‘:boss:’.
&gt;  ‘+work-boss’： 选择tag ‘:work:’, 忽略 tag ‘:boss:’.
&gt;  ‘work|laptop’： 选择tag ‘:work:’ 或 ‘:laptop:’.
&gt;  ‘work|laptop+night’：选择有laptop 并且有night的tag
</p>

<p>
除了tag，还可以使用正则表达式，例如： ‘work+{^boss.*}’ ，选择带有work的tag并且以boss开头
</p>

<p>
更多的语法及表达式就不介绍了，有需要时，查文档获取。
</p>

<p>
<b>search 试图</b>
</p>

<p>
输入M-x org-agnda 时， 选择s 进入此视图。
 根据关键字查找或者正则。
</p>

<p>
<b>stuck project试图</b>
</p>

<p>
输入M-x org-agnda 时， 选择# 进入此视图。
</p>

<p>
参考了David Allen的GTD方法，一个stuck的project是没有定义下一步action的日程，不会在todo显示
</p>

<p>
<b>分类</b>
</p>

<p>
每个org todo文件都有一个分类，默认就是文件名。
</p>

<p>
可以在文件开头加入：
</p>

<div class="org-src-container">
<pre class="src src-text">#+CATEGORY: xxx
</pre>
</div>

<p>
可以在某项日程中加入属性：
</p>

<p>
&gt; :CATEGORY: xxx
</p>

<p>
之后在检索过滤时，可以根据分类来进行u过滤
</p>

<p>
<b>Column 视图</b>
</p>

<p>
列模式在上篇文章已经介绍过。
 使用C-c C-x C-c 进入列模式。
 此处不介绍了。
</p>

<p>
<b>格式</b>
</p>

<p>
导出时，Html等格式可以定义更多的格式，所以Emacs 可以定义更多的格式。
</p>

<p>
例如：
</p>

<p>
&gt; <b>bold</b>, <i>italic</i>, <b>underlined</b>, <code>verbatim</code> and code,
</p>

<p>
我只用到导出纯文本，故此项未深入了解。
</p>



<p>
<b>范例：使用org-mode记录日程安排</b>
</p>

<p>
目录有gtd.org
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #a0522d;">** </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #a0522d;"> Learn Emacs</span>
<span style="color: #a0522d;">** </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #a0522d;"> Learn Elisp</span>
   <span style="color: #a020f0;">DEADLINE:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2021-06-18 &#21608;&#20116; 09:00&gt;</span> <span style="color: #a020f0;">SCHEDULED:</span> <span style="color: #a020f0; text-decoration: underline;">&lt;2021-06-18 &#21608;&#20116; 08:00&gt;</span>
<span style="color: #a0522d;">** </span><span style="color: #ff0000; font-weight: bold;">TODO</span><span style="color: #a0522d;"> Hacking Emacs</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:8f37e915-6f93-46bd-9282-9229d500e546" class="outline-4">
<h4 id="h:8f37e915-6f93-46bd-9282-9229d500e546">org-agenda演示</h4>
<div class="outline-text-4" id="text-h:8f37e915-6f93-46bd-9282-9229d500e546">
<p>
<b><b>org-agenda查看每日任务</b></b>
</p>

<p>
步骤：
</p>

<ol class="org-ol">
<li><code>C-c a</code> 进入org-agenda</li>
<li><code>a</code> 进入每日、每周任务</li>
<li>默认展示的是一周内每天的任务，按`d`进入当天任务，按 <code>w</code> 返回每周任务</li>
<li>按 <code>R</code> (注意大写)查看当天每个任务的完成时间情况</li>
<li>按 <code>r</code> 刷新状态</li>
</ol>

<p>
按 <code>C-c a</code>
</p>


<figure id="orgf3196ec">
<img src="./images/image-20210618202749196.png" alt="image-20210618202749196.png">

</figure>

<p>
按 <code>a</code>
</p>


<figure id="org8155499">
<img src="./images/image-20210618203024169.png" alt="image-20210618203024169.png">

</figure>

<p>
按 <code>r</code> 刷新，按 <code>d</code> 当天安排， <code>w</code> 周安排
</p>
</div>
</div>
<div id="outline-container-h:f83ddd44-a78e-4b1a-91eb-963cdf4a31fe" class="outline-4">
<h4 id="h:f83ddd44-a78e-4b1a-91eb-963cdf4a31fe"><b>org-agenda查看自定义模板</b></h4>
<div class="outline-text-4" id="text-h:f83ddd44-a78e-4b1a-91eb-963cdf4a31fe">
<p>
步骤：
</p>

<ol class="org-ol">
<li><code>C-c a</code> 进入org-agenda</li>
<li><code>w</code> 进入自定义的模板</li>
<li><code>a</code> 选择优先级为a的任务列出</li>
<li><code>C-c a</code>, <code>wb</code> 选择优先级为b的任务列出</li>
<li><code>C-c a</code>, <code>W</code> (大写)列出所有模板中的代办任务</li>
</ol>

<p>
参考：<a href="https://www.cnblogs.com/yangruiGB2312/p/9101838.html">https://www.cnblogs.com/yangruiGB2312/p/9101838.html</a>
</p>

<p>
<a href="https://www.zmonster.me/2021/09/25/record-life-with-org.html">https://www.zmonster.me/2021/09/25/record-life-with-org.html</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-agenda-custom-commands
  '(
    (<span style="color: #8b2252;">"w"</span> . <span style="color: #8b2252;">"&#20219;&#21153;&#23433;&#25490;"</span>)
    (<span style="color: #8b2252;">"wa"</span> <span style="color: #8b2252;">"&#37325;&#35201;&#19988;&#32039;&#24613;&#30340;&#20219;&#21153;"</span> tags-todo <span style="color: #8b2252;">"+PRIORITY=\"A\""</span>)
    (<span style="color: #8b2252;">"wb"</span> <span style="color: #8b2252;">"&#37325;&#35201;&#19988;&#19981;&#32039;&#24613;&#30340;&#20219;&#21153;"</span> tags-todo <span style="color: #8b2252;">"-weekly-monthly-daily+PRIORITY=\"B\""</span>)
    (<span style="color: #8b2252;">"wc"</span> <span style="color: #8b2252;">"&#19981;&#37325;&#35201;&#19988;&#32039;&#24613;&#30340;&#20219;&#21153;"</span> tags-todo <span style="color: #8b2252;">"+PRIORITY=\"C\""</span>)
    (<span style="color: #8b2252;">"W"</span> <span style="color: #8b2252;">"Weekly Review"</span>
     ((stuck <span style="color: #8b2252;">""</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">review stuck projects as designated by org-stuck-projects</span>
      (tags-todo <span style="color: #8b2252;">"project"</span>)
      (tags-todo <span style="color: #8b2252;">"daily"</span>)
      (tags-todo <span style="color: #8b2252;">"weekly"</span>)
      (tags-todo <span style="color: #8b2252;">"school"</span>)
      (tags-todo <span style="color: #8b2252;">"code"</span>)
      (tags-todo <span style="color: #8b2252;">"theory"</span>))
    )
    (<span style="color: #8b2252;">"n"</span> <span style="color: #8b2252;">"Agenda and all TODOs"</span> <span style="color: #b22222;">;; </span><span style="color: #b22222;">n &#26159;&#33258;&#23450;&#20041;&#30340;&#24555;&#25463;&#38190; Agenda and all TODOs&#26159;&#26631;&#39064;</span>
     ((tags-todo <span style="color: #8b2252;">"@Tom|@Mary"</span> nil)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#26159;todo&#29366;&#24577;&#30340;&#65292;&#19988;tag&#26159; &#8220;@Tom&#8221;&#25110;&#8221;@Mary&#8221;&#30340;&#12290;&#24403;&#26102;&#30340;&#30446;&#30340;&#26159;&#37325;&#28857;&#20851;&#27880;&#36825;&#20004;&#20010;&#20154;&#30456;&#20851;&#20219;&#21153;</span>
     (agenda <span style="color: #8b2252;">""</span> nil)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#26085;&#31243;&#65292;&#36825;&#19968;&#22359;&#21644; =org-agenda= =a= &#30340;&#25928;&#26524;&#19968;&#33268;</span>
     (todo <span style="color: #8b2252;">"TODO"</span> nil) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#25152;&#26377; TODO &#30340;&#20219;&#21153;</span>
     (todo <span style="color: #8b2252;">"WAIT"</span> nil)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#25152;&#26377;WAIT&#30340;&#20219;&#21153;</span>
 <span style="color: #b22222;">;;     </span><span style="color: #b22222;">nil)</span>
     )

        (<span style="color: #8b2252;">"p"</span> <span style="color: #8b2252;">"Customized Agenda View"</span>
         ((todo <span style="color: #8b2252;">"SOMETIME"</span> ((org-agenda-overriding-header <span style="color: #8b2252;">"&#32431;&#35745;&#26102;&#20219;&#21153;"</span>)))))
        (<span style="color: #8b2252;">"l"</span> <span style="color: #8b2252;">"Daily Agenda Logs"</span>
         ((agenda <span style="color: #8b2252;">""</span> ((org-agenda-overriding-header <span style="color: #8b2252;">"&#20170;&#26085;&#35760;&#24405;"</span>)
                      (org-agenda-span 'day)
                      (org-agenda-show-log 'clockcheck)
                      (org-agenda-start-with-log-mode nil)
                      (org-agenda-archives-mode t)
                      (org-agenda-log-mode-items '(closed clock))
                      (org-agenda-clockreport-parameter-plist
                       '(<span style="color: #483d8b;">:link</span> t <span style="color: #483d8b;">:maxlevel</span> 2 <span style="color: #483d8b;">:fileskip0</span> t <span style="color: #483d8b;">:scope</span> agenda-with-archives))
                      (org-agenda-clockreport-mode t)
                      (org-agenda-log-mode-add-notes nil)
                      ))))
))
</pre>
</div>

<p>
其中的指令其实很好理解，比如：
</p>

<ul class="org-ul">
<li>("w" . "任务安排") 表示了设置快捷键"w"展示任务安排</li>
<li>("wa" "重要且紧急的任务" tags-todo "+PRIORITY="A"") 表示设置快捷键 "wa"展示重要且紧急的任务，筛选条件是 优先级等于"A"</li>
<li>("wb" "重要且不紧急的任务" tags-todo "-weekly-monthly-daily+PRIORITY="B"") 筛选条件是：排除每周、每月、每日标签、且优先级等于B</li>
<li>((stuck "") 表示显示尚未进行管理的任务</li>
<li>下面的"project", "daily"表示展现该类标签下的任务</li>
</ul>

<p>
自定义agenda模板：
</p>

<p>
<a href="https://github.com/Linusp/org-agenda-example/blob/master/init.el">https://github.com/Linusp/org-agenda-example/blob/master/init.el</a>
</p>



<p>
设置agenda的模板
</p>

<p>
基本思路和原先自定义的基本相同
</p>

<ul class="org-ul">
<li>尽量安排日程，在日历是显示</li>
<li>没有明确日期的，在日历下显示</li>
<li>列出所有在建的项目，需要关注的项目。前提是定期回顾所有项目，将需要关注项目的根列表设为 `TODO`</li>
<li>尽量可以分类，任务的项目名。前提是所有项目设置 `:agenda-group:` 属性</li>
</ul>
</div>
<div id="outline-container-h:181062df-e9d9-4a13-bbb9-96e67e4a21b6" class="outline-5">
<h5 id="h:181062df-e9d9-4a13-bbb9-96e67e4a21b6">org-super-agenda插件</h5>
<div class="outline-text-5" id="text-h:181062df-e9d9-4a13-bbb9-96e67e4a21b6">
<p>
<a href="https://github.com/alphapapa/org-super-agenda">https://github.com/alphapapa/org-super-agenda</a>
</p>

<p>
#+end_src
</p>

<p>
(global-set-key (kbd "C-c a") 'org-agenda)
;;;;; Org-super-agenda
(use-package org-super-agenda
  :ensure t
  :after org-agenda
  :config
  (org-super-agenda-mode))
(setq org-agenda-custom-commands
  '(
    ("r" . "任务安排")
    ("ra" "重要且紧急的任务" tags-todo "+PRIORITY=\"A\"")
    ("rb" "重要且不紧急的任务" tags-todo "-weekly-monthly-daily+PRIORITY=\"B\"")
    ("rc" "不重要且紧急的任务" tags-todo "+PRIORITY=\"C\"")
    ("W" "Weekly Review"
     ((stuck "") ;; review stuck projects as designated by org-stuck-projects
      (tags-todo "project")
      (tags-todo "daily")
      (tags-todo "weekly")
      (tags-todo "school")
      (tags-todo "code")
      (tags-todo "theory"))
    )
    ("n" "Agenda and all TODOs" ;; n 是自定义的快捷键 Agenda and all TODOs是标题
     ((tags-todo "@Tom|@Mary" nil)  ;; 显示是todo状态的，且tag是 “@Tom”或”@Mary”的。当时的目的是重点关注这两个人相关任务
     (agenda "" nil)  ;; 显示日程，这一块和 <code>org-agenda</code> <code>a</code> 的效果一致
     (todo "TODO" nil) ;; 显示所有 TODO 的任务
     (todo "WAIT" nil)) ;; 显示所有WAIT的任务
 ;;     nil)
     )
</p>

<p>
("p" "Customized Agenda View"
 ((todo "SOMETIME" ((org-agenda-overriding-header "纯计时任务")))))
("l" "Daily Agenda Logs"
 ((agenda "" ((org-agenda-overriding-header "今日记录")
	      (org-agenda-span 'day)
	      (org-agenda-show-log 'clockcheck)
	      (org-agenda-start-with-log-mode nil)
	      (org-agenda-archives-mode t)
	      (org-agenda-log-mode-items '(closed clock))
	      (org-agenda-clockreport-parameter-plist
	       '(:link t :maxlevel 2 :fileskip0 t :scope agenda-with-archives))
	      (org-agenda-clockreport-mode t)
	      (org-agenda-log-mode-add-notes nil)
	      ))))
</p>

<p>
  ("w" "Weekly Overview"
           (( agenda "" ((org-agenda-span 'day)
                 (org-super-agenda-groups
                   '((:name "Today"
          :time-grid t
          :deadline today)
         (:name "Over Due"
          :deadline past)
         (:name "Working On"
          :todo ("STRT" "LOOP"))
         (:name "Delayed"
          :todo ("WAIT" "HOLD"))
         (:name "Important"
          :priority "A"
          :order 1)
         (:name "Less Important"
          :priority "B")
         (:name "Trival"
          :priority&lt;"B")))))))
))
(provide 'init-org)
#+end_src
</p>



<p>
<b><b>org Mode 中的搜索</b></b>
</p>

<p>
`C-c a` 中可以根据提示使用 `s` 来进行关键字所搜。使用 `t` 则可以进行代办事项的搜索。
</p>
</div>
</div>
</div>
<div id="outline-container-h:3e99829b-2e74-491b-9d1f-b457682a9034" class="outline-4">
<h4 id="h:3e99829b-2e74-491b-9d1f-b457682a9034">`~/.emacs.d/lisp/init-org.el`文件</h4>
<div class="outline-text-4" id="text-h:3e99829b-2e74-491b-9d1f-b457682a9034">
<p>
#+end_src
;; org-mode语法高亮
(require 'org)
(setq org-src-fontify-natively t)
</p>

<p>
;; 设置默认 Org Agenda 文件目录
(setq org-agenda-files '("d:/xxx"))
</p>


<p>
(provide 'init-org)
#+end_src
</p>
</div>
</div>
</div>
<div id="outline-container-h:41dcb152-f0d6-4f47-8471-07fed78b02cf" class="outline-3">
<h3 id="h:41dcb152-f0d6-4f47-8471-07fed78b02cf">富文本标记</h3>
<div class="outline-text-3" id="text-h:41dcb152-f0d6-4f47-8471-07fed78b02cf">
</div>
<div id="outline-container-h:3e7b1ce9-4ebd-436d-9b4b-9c2234addf50" class="outline-4">
<h4 id="h:3e7b1ce9-4ebd-436d-9b4b-9c2234addf50">图片</h4>
<div class="outline-text-4" id="text-h:3e7b1ce9-4ebd-436d-9b4b-9c2234addf50">
<p>
图像是指向没有描述部分的图像文件的链接
</p>

<div class="org-src-container">
<pre class="src src-shell">./img/cat.jpg
</pre>
</div>

<p>
其它看超连接讲解
</p>
</div>
</div>
<div id="outline-container-h:770e59aa-8a82-4caf-a804-0c9d859ddcb9" class="outline-4">
<h4 id="h:770e59aa-8a82-4caf-a804-0c9d859ddcb9">创建脚注</h4>
<div class="outline-text-4" id="text-h:770e59aa-8a82-4caf-a804-0c9d859ddcb9">
<p>
脚注就是以脚注定义符号开头的一段话，脚注定义符号是将脚注名称放在一个方括号里形成的，要求放在第0列，不能有缩进。而引用就是在正文中将脚注名称用方括号括起来。例如：
</p>

<div class="org-src-container">
<pre class="src src-shell">The Org homepage[fn:1] now looks a lot better than it used to.
...
[fn:1] The link is: http://orgmode.org
</pre>
</div>

<p>
用下面的命令来处理脚注：
</p>

<ul class="org-ul">
<li>C-c C-x f 这是一个移动命令。当光标处理引用处时，跳转到它的定义；当光标处理定义处时，跳转到第一个引用处。其他情况下，新建一个脚注。当有前缀时，会提供一个菜单供选择操作，其中包括重新给脚注编号。</li>
<li>C-c C-c 在定义和引用之间跳转</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:4ad4a0a7-7683-40d8-9e58-4928d5e7e42a" class="outline-3">
<h3 id="h:4ad4a0a7-7683-40d8-9e58-4928d5e7e42a">导出</h3>
<div class="outline-text-3" id="text-h:4ad4a0a7-7683-40d8-9e58-4928d5e7e42a">
</div>
<div id="outline-container-h:7594038c-15c5-42a5-85a0-97910cf43cf5" class="outline-4">
<h4 id="h:7594038c-15c5-42a5-85a0-97910cf43cf5">导出设置</h4>
<div class="outline-text-4" id="text-h:7594038c-15c5-42a5-85a0-97910cf43cf5">
<p>
<a href="https://orgmode.org/manual/Export-Settings.html">https://orgmode.org/manual/Export-Settings.html</a>
</p>

<p>
如
</p>
<div class="org-src-container">
<pre class="src src-org"><span style="color: #7f7f7f;">#+TITLE:</span> <span style="color: #191970; font-weight: bold;">&#31070;&#30340;&#32534;&#36753;&#22120;emacs -&gt; &#25991;&#31456;&#23545;&#24212;&#30340;&#20013;&#25991;&#26631;&#39064;</span>
<span style="color: #b22222;">#+URL: <a href="https://www.xuchangwei.com/">https://www.xuchangwei.com/</a></span>
<span style="color: #7f7f7f;">#+AUTHOR:</span> <span style="color: #191970;">jasperhsu -&gt; &#20462;&#25913;&#25104;&#24744;&#33258;&#24049;&#30340;&#29992;&#25143;&#21517;</span>
<span style="color: #b22222;">#+CATEGORY: emacs-common -&gt; &#25991;&#31456;&#23545;&#24212;&#30340;&#20998;&#31867;</span>
<span style="color: #7f7f7f;">#+DATE:</span> <span style="color: #191970;">&lt;2022-06-02 &#22235; 22:20&gt; -&gt; &#25991;&#31456;&#23436;&#25104;&#32763;&#35793;&#30340;&#26102;&#38388;</span>
<span style="color: #b22222;">#+OPTIONS: ^:{} # &#25110;&#20889;&#25104; ^:nil &#34920;&#31034; _ &#20445;&#25345;&#21407;&#26679;&#65292; &#32780;&#19981;&#26159; Tex &#35821;&#27861;&#12290;org-export-with-special-strings nil</span>
<span style="color: #b22222;"># -*- org-image-actual-width: nil; -*-</span>
<span style="color: #b22222;">#+OPTIONS: \n:t #&#26159;&#21542;&#20445;&#25442;&#34892;&#31526;</span>
</pre>
</div>


<div class="org-src-container">
<pre class="src src-org"><span style="color: #7f7f7f;">#+title:</span> <span style="color: #191970; font-weight: bold;">GNU Emacs configuration</span>
<span style="color: #7f7f7f;">#+author:</span> <span style="color: #191970;">Protesilaos Stavrou</span>
<span style="color: #7f7f7f;">#+email:</span> <span style="color: #191970;">public@protesilaos.com</span>
<span style="color: #b22222;">#+language: en</span>
<span style="color: #b22222;">#+options: ':t toc:nil author:t email:t num:t</span>
<span style="color: #b22222;">#+startup: content indent</span>
<span style="color: #b22222;">#+macro: latest-export-date (eval (format-time-string "%F %T %z"))</span>
<span style="color: #b22222;">#+macro: word-count (eval (count-words (point-min) (point-max)))</span>

<span style="color: #b22222;">#+toc: headlines 8 insert TOC here, with eight headline levels</span>

<span style="color: #0000ff;">* head1</span>
<span style="color: #a0522d;">** head1</span>
<span style="color: #0000ff;">* head2</span>

&#35828;&#26126;&#65306;

Org &#36890;&#24120;&#20250;&#22312;&#25991;&#20214;&#30340;&#31532;&#19968;&#20010;&#26631;&#39064;&#20043;&#21069;&#30452;&#25509;&#25554;&#20837;&#30446;&#24405;&#12290;&#35201;&#23558;&#30446;&#24405;&#31227;&#21160;&#21040;&#20854;&#20182;&#20301;&#32622;&#65292;&#35831;&#20808;&#20851;&#38381;&#40664;&#35748;&#30340;&#21464;&#37327; org-export-with-toc &#25110; ' #+OPTIONS: toc:nil '&#12290;&#28982;&#21518;&#22312;&#25152;&#38656;&#20301;&#32622;&#25554;&#20837; ' #+TOC: headlines N '&#12290;

<span style="color: #b22222;">#+startup: content indent &#20854;&#20013; content &#26174;&#31034;&#25152;&#26377;&#26631;&#39064;&#65292;indent &#26159;&#27599;&#20010;&#26631;&#39064;&#19978;&#21482;&#26377;&#19968;&#20010;&#26143;&#21495;&#21487;&#35265;&#65292;&#20854;&#20313;&#26143;&#21495;&#20351;&#29992;&#19982;&#32972;&#26223;&#30456;&#21516;&#30340;&#23383;&#20307;&#39068;&#33394;&#36974;&#32617;</span>
</pre>
</div>
</div>
</div>
</div>
</section>
<section id="outline-container-h:c1419f37-bd97-4be5-bdd4-9f8203d608e9" class="outline-2">
<h2 id="h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</h2>
<div class="outline-text-2" id="text-h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
由于插件数量众多，本教程将分类进行介绍。大体分为如下几类：
</p>
<ul class="org-ul">
<li>内置包：尽量少的使用插件。</li>
<li>功能优化类：对 Emacs 自身的一些不够完美的功能进行替换，解决一些痛点，提高操作便利性。</li>
<li>功能增强类：大大提升 Emacs 体验与效率。</li>
<li>编程类：和编程相关的插件配置</li>
<li>外观类：配置颜色、主题、屏保等。</li>
<li>有趣类：实用性不高但很有趣的插件</li>
</ul>
</div>
</section>
<section id="outline-container-h:2cc66bcd-64e4-4b8a-a540-e668ef98ef6f" class="outline-2">
<h2 id="h:2cc66bcd-64e4-4b8a-a540-e668ef98ef6f">插件-内置包</h2>
<div class="outline-text-2" id="text-h:2cc66bcd-64e4-4b8a-a540-e668ef98ef6f">
<p>
推荐这个 <a href="https://github.com/emacs-tw/awesome-emacs">Github：emacs-tw/awesome-emacs</a>，在这里你可以找到更多的内置以及第三方的软件包。
</p>
</div>
<div id="outline-container-h:4729f7f6-1fc6-4dd3-9165-82741aa69a09" class="outline-3">
<h3 id="h:4729f7f6-1fc6-4dd3-9165-82741aa69a09">Dired</h3>
<div class="outline-text-3" id="text-h:4729f7f6-1fc6-4dd3-9165-82741aa69a09">
<p>
官方文档：<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired.html">Dired, the Directory Editor</a>
</p>

<p>
在Emacs中管理文件？是的，这个功能就是为你的这个需求诞生的。虽然很多人觉得它不够美观，不够强大，而纷纷写了更多强大功能的特性来增强或替代它，但不可否认的是，它作为一款内置的文件管理工具，其性能以及其带来的影响都是第三方插件不能比拟的。C-x d来体验吧，它内置了很多的快捷命令，可能得稍微适应一下。
</p>

<p>
打开  
</p>
<ul class="org-ul">
<li>C-x d 或 dired 打开目录</li>
<li>C-x C-f [Dir] 打开目录或文件</li>
<li>C-x (4 | 5) d 或dired-other-(window | frame)</li>
<li>C-x C-d 或 list-directory</li>
<li>C-x C-j 或 dired-jump 打开当前文件所在的目录或上层目录</li>
</ul>

<p>
Mode
</p>
<ul class="org-ul">
<li>q: 退出</li>
<li>执行 Shell 命令
<ul class="org-ul">
<li>! | (&amp;) 或者 dired-do-(async)-shell-command</li>
</ul></li>
<li>标记
<ul class="org-ul">
<li>dired-mark 或者 m                                
<ul class="org-ul">
<li>后面的 N 个:  (N) m</li>
</ul></li>
<li>Regex: dired-mark-files-regexp 或者 % m</li>
<li>去掉: dired-unmark-(backward) 或者 u | &lt;del&gt;</li>
<li>去掉所有: dired-unmark-all-marks 或者 U</li>
</ul></li>
<li>执行
<ul class="org-ul">
<li>dired-do-flagged-delete 或者 x</li>
</ul></li>
<li>新建
<ul class="org-ul">
<li>dired-create-directory 或者 +</li>
<li>dired-create-empty-file 空文件</li>
<li>S	 // 符号链接</li>
<li>H	 // 硬链接</li>
</ul></li>
<li>复制
<ul class="org-ul">
<li>dired-do-copy 或者 C
<ul class="org-ul">
<li>(N) C    // 将复制光标位置上的文件和其后N个</li>
</ul></li>
</ul></li>
<li>删除
<ul class="org-ul">
<li>立即: dired-do-delete 或者 D</li>
<li>待删标记: dired-flag-file-deletion 或者 d
<ul class="org-ul">
<li>e	  // 编辑文件</li>
</ul></li>
</ul></li>
<li>移动
<ul class="org-ul">
<li>下|上
<ul class="org-ul">
<li>Space 或 C-n 或 n</li>
<li>Del 或 C-p 或 p</li>
</ul></li>
<li>子目录: dired-(next | prev)-dirline  或者 &gt; | &lt;</li>
<li>Jump : dired-goto-file 或者 j</li>
<li>父目录: dired-up-directory 或者 ^</li>
</ul></li>
<li>打开-文件
<ul class="org-ul">
<li>dired-find-file 或者 &lt;RET&gt; 或者 f</li>
<li>dired-find-file-other-window 或者 o</li>
<li>dired-display-file 或者 C-o (光标不动)</li>
<li>只读: dired-view-file 或者 v
<ul class="org-ul">
<li>C-c 或者 q  // 返回目录清单窗口</li>
<li>s	  // search</li>
<li>Enter	  // 前进到下一行</li>
<li>=	  // 显示光标在哪一行</li>
</ul></li>
</ul></li>
<li>刷新
<ul class="org-ul">
<li>revert-buffer 或者 g</li>
<li>dired-do-redisplay 或者 l</li>
</ul></li>
<li>排序-时间|文件名-(默认按文件名排序)
<ul class="org-ul">
<li>s 或者 dired-sort-toggle-or-edit</li>
<li>C-u s
<ul class="org-ul">
<li>c : last modification time.</li>
<li>u : access time.</li>
<li>S : file size.</li>
<li>X : file extension.</li>
</ul></li>
</ul></li>
<li>重命名或移动
<ul class="org-ul">
<li>R</li>
</ul></li>
<li>修改-权限|用户|用户组|时间戳
<ul class="org-ul">
<li>M                   // Mode</li>
<li>O                   // owner</li>
<li>dired-do-chgrp 或者 G</li>
<li>T                   // Timestamp</li>
</ul></li>
<li>压缩|解压缩-文件
<ul class="org-ul">
<li>dired-do-compress 或者 Z (已压缩 则 解压缩)</li>
<li>dired-do-compress-to ~== c</li>
</ul></li>
<li>搜索
<ul class="org-ul">
<li>dired-do-search 或者 A</li>
<li>dired-isearch-filenames 或者 M-s f C-s</li>
<li>dired-isearch-filenames-regexp 或者 M-s f M-C-s</li>
</ul></li>
<li>查询替换
<ul class="org-ul">
<li>dired-do-query-replace 或者 Q</li>
</ul></li>
</ul>


<p>
Dired Mode 是一个强大的模式它能让我们完成和文件管理相关的所有操作。
</p>

<p>
使用 Dired Mode， C-x d 或 M-x dired
</p>

<p>
这个模式类似于图形界面系统中的资源管理器。你 可以在其中查看文件和目录的详细信息，对他们进行各种操作，甚至复制粘贴缓冲区中的内 容。下面是一些常用的操作（下面的所有键均需在 Dired Mode 下使用），
</p>

<ul class="org-ul">
<li>+ 创建目录</li>
<li>g 刷新目录  通过在C-x C-f创建完文件后按g刷新显示</li>
<li>C 拷贝</li>
<li>D 删除</li>
<li>R 重命名</li>
<li>d 标记删除</li>
<li>u 取消标记 大U全部取消</li>
<li>x 执行所有的标记</li>
<li>s 排序 。按修改时间或名称</li>
<li>S-6 上级目录</li>
<li>C-x C-q 目录下进入编辑模式，可改文件名</li>
<li>%m 正则匹配，可以安装正则插件p</li>
<li>dired-jump <code>=</code> C-X C-j 打开d:/</li>
</ul>

<p>
这里有几点可以优化的地方。第一是删除目录的时候 Emacs 会询问是否递归删除或拷贝， 这也有些麻烦我们可以用下面的配置将其设定为默认递归删除目录（出于安全原因的考虑， 也许你需要保持此行为。所有文中的配置请务必按需配置）。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">C-x d &#25805;&#20316;&#25991;&#20214;&#26102;&#65292;&#36882;&#24402;&#21024;&#38500;&#65292;&#19981;&#29992;&#35810;&#38382;&#26159;&#21542;&#36882;&#24402;&#21024;&#38500;</span>
(<span style="color: #a020f0;">setq</span> dired-recursive-deletes 'always)
(<span style="color: #a020f0;">setq</span> dired-recursive-copies 'always)
</pre>
</div>

<p>
第二是，每一次你进入一个回车进入一个新的目录中是，一个新的缓冲区就会被建立。这使 得我们的缓冲区列表中充满了大量没有实际意义的记录。我们可以使用下面的代码，让 Emacs 重用唯一的一个缓冲区作为 Dired Mode 显示专用缓冲区。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20248;&#21270;&#32531;&#20914;&#21306; Dired Mode &#26174;&#31034;&#19987;&#29992;&#32531;&#20914;&#21306;</span>
(put 'dired-find-alternate-file 'disabled nil)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20027;&#21160;&#21152;&#36733; Dired Mode</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'dired)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(defined-key dired-mode-map (kbd "RET") 'dired-find-alternate-file)</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24310;&#36831;&#21152;&#36733;</span>
(<span style="color: #a020f0;">with-eval-after-load</span> 'dired
    (define-key dired-mode-map (kbd <span style="color: #8b2252;">"RET"</span>) 'dired-find-alternate-file)
</pre>
</div>

<p>
使用延迟加载可以使编辑器加载速度有所提升。
</p>

<p>
启用 <code>dired-x</code> 可以让每一次进入 Dired 模式时，使用新的快捷键 <code>C-x C-j</code> 就可以进 入当前文件夹的所在的路径。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25171;&#24320;&#24403;&#21069;&#25991;&#20214;&#36335;&#24452;dired mode C-x C-j</span>
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">dired-x</span>)
</pre>
</div>

<p>
使用 <code>(setq dired-dwin-target 1)</code> 则可以使当一个窗口（frame）中存在两个分屏 （window）时，将另一个分屏自动设置成拷贝地址的目标。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">2&#20010;&#20998;&#23631;&#38388;&#33258;&#21160;&#22797;&#21046;</span>
(<span style="color: #a020f0;">setq</span> dired-dwin-target 1)
</pre>
</div>

<p>
最后如果你是 Mac OS X 的用户，可以安装 <code>reveal-in-osx-finder</code> 这个插件（你可以在 <a href="https://melpa.org/#/reveal-in-osx-finder">这里</a>找到它），它可以将任意文件直接在 Finder 中打开。你想安装这个插件，将其添加至上文的插件列表中即可，下次启动 Emacs 时，它就会自动帮你完成下载。使用 <code>M-x reveal-in-osx-finder</code>
</p>
</div>
<div id="outline-container-h:92e65847-da2b-4972-8cb3-2251f3cd5655" class="outline-4">
<h4 id="h:92e65847-da2b-4972-8cb3-2251f3cd5655">批量修改文件名</h4>
<div class="outline-text-4" id="text-h:92e65847-da2b-4972-8cb3-2251f3cd5655">
<p>
<code>C-x C-q</code> 就可以直接在 Dired Mode 中进行编辑，使用之前学的 iedit-mode 和区域选择 就可以直接对多个文件进行重命名编辑了。 <code>C-c C-c</code> 完成编辑
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'dired-mode-hook 'auto-revert-mode)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq dired-recursive-deletes 'always)</span>
(<span style="color: #a020f0;">setq</span> dired-recursive-copies 'always)
(<span style="color: #a020f0;">setq</span> dired-isearch-filenames 'dwim)
(<span style="color: #a020f0;">setq-default</span> diredp-hide-details-initially-flag nil
              dired-dwim-target t)

(<span style="color: #a020f0;">use-package</span> dired+)
(<span style="color: #a020f0;">use-package</span> dired-sort)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:c4633986-58cf-4f2b-a3b3-bd835647b5ed" class="outline-3">
<h3 id="h:c4633986-58cf-4f2b-a3b3-bd835647b5ed">IDO/Icomplete</h3>
<div class="outline-text-3" id="text-h:c4633986-58cf-4f2b-a3b3-bd835647b5ed">
<p>
IDO可以让你交互式的操作缓冲区以及文件。而Icomplete可以让你通过输入一定的文字来快速的补充完整或过滤结果。这两个一般是同时存在的，如果你想体验，你可以按下M-x或者比如C-x b，然后输入一些内容来体验。
</p>

<p>
作为一个延伸，我们再介绍另外一个内置的功能fido-mode。Fido (Fake IDO)，基本上是整合了以上两者的功能，所以不用单独开启上面的两个功能，开启这一个即可。默认的，这个没有垂直的模式，所以很多人喜欢装一些第三方的包来实现垂直模式。其实在早期的Emacs里面，你可以配置一些变量来实现垂直样式，但从Emacs 28.1开始，内置了一个fido-vertical-mode来原生实现垂直模式的FIDO。如果你喜欢垂直模式的，直接开启这个fido-vertical-mode即可。
</p>
</div>
</div>
<div id="outline-container-h:683fb41c-c52d-4f4b-81d2-ddae3bc742fa" class="outline-3">
<h3 id="h:683fb41c-c52d-4f4b-81d2-ddae3bc742fa">Winner Mode</h3>
<div class="outline-text-3" id="text-h:683fb41c-c52d-4f4b-81d2-ddae3bc742fa">
<p>
这是一个用来管理窗口变化的全局模式。经常的，我们开启了几个Window，然后关闭了一些，我们就可以通过winner-undo，winner-redo等来撤销或者反撤销。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> winner
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:hook</span> (after-init . winner-mode))
</pre>
</div>

<p>
内置包使用 <code>(winner-mode 1)</code> 开启。
</p>
<ul class="org-ul">
<li><code>winner-redo C-c left</code>  回退窗口</li>
<li><code>winner-undo C-c right</code>  撤消回退</li>
</ul>
</div>
</div>
<div id="outline-container-h:3962d68a-6144-45d7-9523-ef31723fcb2d" class="outline-3">
<h3 id="h:3962d68a-6144-45d7-9523-ef31723fcb2d">imenu 跳转</h3>
<div class="outline-text-3" id="text-h:3962d68a-6144-45d7-9523-ef31723fcb2d">
<p>
可以根据标题等可识别的菜单项来在当前的缓冲区中进行快速的跳转。非常适合编写org-mode，markdown等文档的时候使用。当然，在变成的环境中，也非常好用。
</p>

<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
可以在跳转在不同标题。如markdown
</p>

<p>
使用
</p>

<p>
#+end_src
M-x imenu
#+end_src
</p>

<p>
imenu 可以显示当前所有缓冲区的列表，下面的配置可以让其拥有更精确的跳转，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">imenu &#21487;&#20197;&#26174;&#31034;&#24403;&#21069;&#25152;&#26377;&#32531;&#20914;&#21306;&#30340;&#21015;&#34920;&#65292;&#19979;&#38754;&#30340;&#37197;&#32622;&#21487;&#20197;&#35753;&#20854;&#25317;&#26377;&#26356;&#31934;&#30830;&#30340;&#36339;&#36716;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">js2-imenu-make-index</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">save-excursion</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq imenu-generic-expression '((nil "describe\\(\"\\(.+\\)\"" 1)))</span>
  (imenu--generic-function '((<span style="color: #8b2252;">"describe"</span> <span style="color: #8b2252;">"\\s-*describe\\s-*(\\s-*[\"']</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[\"']\\s-*,.*"</span> 1)
           (<span style="color: #8b2252;">"it"</span> <span style="color: #8b2252;">"\\s-*it\\s-*(\\s-*[\"']</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[\"']\\s-*,.*"</span> 1)
           (<span style="color: #8b2252;">"test"</span> <span style="color: #8b2252;">"\\s-*test\\s-*(\\s-*[\"']</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[\"']\\s-*,.*"</span> 1)
           (<span style="color: #8b2252;">"before"</span> <span style="color: #8b2252;">"\\s-*before\\s-*(\\s-*[\"']</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[\"']\\s-*,.*"</span> 1)
           (<span style="color: #8b2252;">"after"</span> <span style="color: #8b2252;">"\\s-*after\\s-*(\\s-*[\"']</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[\"']\\s-*,.*"</span> 1)
           (<span style="color: #8b2252;">"Function"</span> <span style="color: #8b2252;">"function[ \t]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[a-zA-Z0-9_$.]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t]*("</span> 1)
           (<span style="color: #8b2252;">"Function"</span> <span style="color: #8b2252;">"^[ \t]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[a-zA-Z0-9_$.]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t]*=[ \t]*function[ \t]*("</span> 1)
           (<span style="color: #8b2252;">"Function"</span> <span style="color: #8b2252;">"^var[ \t]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[a-zA-Z0-9_$.]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t]*=[ \t]*function[ \t]*("</span> 1)
           (<span style="color: #8b2252;">"Function"</span> <span style="color: #8b2252;">"^[ \t]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[a-zA-Z0-9_$.]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t]*()[ \t]*{"</span> 1)
           (<span style="color: #8b2252;">"Function"</span> <span style="color: #8b2252;">"^[ \t]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[a-zA-Z0-9_$.]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t]*:[ \t]*function[ \t]*("</span> 1)
           (<span style="color: #8b2252;">"Task"</span> <span style="color: #8b2252;">"[. \t]task([ \t]*['\"]</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">'\"]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">"</span> 1)))))
(add-hook 'js2-mode-hook
        (<span style="color: #a020f0;">lambda</span> ()
    (<span style="color: #a020f0;">setq</span> imenu-create-index-function 'js2-imenu-make-index)))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">imenu </span>
(global-set-key (kbd <span style="color: #8b2252;">"M-s i"</span>) 'counsel-imenu)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2c58b4d3-ae66-454c-9017-edf5799c7037" class="outline-3">
<h3 id="h:2c58b4d3-ae66-454c-9017-edf5799c7037">whitespace 识别空白内置包</h3>
<div class="outline-text-3" id="text-h:2c58b4d3-ae66-454c-9017-edf5799c7037">
<p>
有些语言编程（Python，我没有念你的身份证；makefile别打喷嚏）的时候，我们非常苦恼这种TAB，空格的混用。这时候我们需要来验证下到底是空格还是TAB。光靠眼睛看，是不现实的。通过移动光标又太慢。而这个whitespace在这种情况下，就可以大显身手。
</p>

<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
建议不要一直开启
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x whitespace-mode
</pre>
</div>

<p>
开启后，所有换行位置都会被标记为`$`，空格被标记为`.`，TAB被标记为空白符。
</p>
</div>
</div>
<div id="outline-container-h:94022f09-9bc8-4dd0-960f-ab3244b61142" class="outline-3">
<h3 id="h:94022f09-9bc8-4dd0-960f-ab3244b61142">prettify-symbol-mode</h3>
<div class="outline-text-3" id="text-h:94022f09-9bc8-4dd0-960f-ab3244b61142">
<p>
这个模式是非常有趣的，绝大部分的时候我们都不需要，但偶尔有那么的一个瞬间，我们还是会小小的心动一下，比如当看到别人的lambda显示为λ的时候。嗯，这个模式就这一个功能，会将一些特定的符号显示为一些数学样式/希腊字母样式。不必要，但很美妙。
</p>
</div>
</div>
<div id="outline-container-h:8aa7ff0e-5d31-4e91-a7dc-298b235098e0" class="outline-3">
<h3 id="h:8aa7ff0e-5d31-4e91-a7dc-298b235098e0">abbrev 缩写补全内置包</h3>
<div class="outline-text-3" id="text-h:8aa7ff0e-5d31-4e91-a7dc-298b235098e0">
<p>
展开缩写。那些很长的单词/句子/表达式……总是那么讨厌，而我们需要天天写。所以才会有snippet这样的代码片段思路。虽然，代码片段工具已经十分强大了（事实上，太强大了），但更多的时候我们是用在编程语言的环境下，而在平时的文档等写作中不常用。因为snippet不能涵盖我们自定义的部分。（其实，我们可以添加自定义的部分）。
</p>

<p>
在一定程度上，snippet是内置abbrev的一种增强，但如果你喜欢的话，内置的abbrev也非常好用。你可以添加一个个人信息（邮箱，电话，网址，住址等），然后通过一两个字符快速的展开，节省我们不少的时间。
</p>


<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
缩写快速扩展为目标字符。
</p>

<p>
开启：`M-x abbrev-mode`
</p>

<p>
然后我们要在需要创建缩写词的位置输入`C-x a i g`来定义一个缩写词以及它对应的完整词汇。上面的三个字母，可以简单记忆为abbrev insert global
</p>

<p>
例如：输入yn 然后键入`C-x a i g`输入“you name“，那么下次输入yn时，再输入空格或者其它的符号就会自动替换为you name。
</p>

<p>
这些被记忆下来的缩写词被记录在`~/.abbrev.defs`文件中。也可以自定义位置
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> abbrev-file-name
     <span style="color: #8b2252;">"~/.emacs.d/abbrev_defs"</span>)
</pre>
</div>

<p>
配置
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21035;&#21517;</span>
(<span style="color: #a020f0;">setq-default</span> abbrev-mode t)
(define-abbrev-table 'global-abbrev-table '(
                        <span style="color: #b22222;">;; </span><span style="color: #b22222;">signature</span>
                        (<span style="color: #8b2252;">"8jv"</span> <span style="color: #8b2252;">"jaspervincent"</span>)
                        <span style="color: #b22222;">;; </span><span style="color: #b22222;">Microsoft</span>
                        (<span style="color: #8b2252;">"8ms"</span> <span style="color: #8b2252;">"Microsoft"</span>)
                        ))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36755;&#20837;8jv&#31354;&#26684;&#65292;&#23601;&#34917;&#20840;&#20986;jaspervincent  &#31354;&#26684;&#20063;&#21487;&#20197;&#25442;&#25104;&#38750;26&#20010;&#23383;&#27597;&#12290; &#19981;&#23637;&#24320;&#21407;&#26679;&#26174;&#31034;&#20351;&#29992;C-q &#31354;&#26684;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:84712c53-09a2-4f81-9cc0-8f5e3b4f1630" class="outline-3">
<h3 id="h:84712c53-09a2-4f81-9cc0-8f5e3b4f1630">Eldoc 显示定义内置包</h3>
<div class="outline-text-3" id="text-h:84712c53-09a2-4f81-9cc0-8f5e3b4f1630">
<p>
这个完全不需要介绍了。你甚至感觉不到它的存在，但它无处不在。你平时在minibuffer看到的函数的签名提示，参数类型提示等，都是它完成的。你不需要知道它，但它已与你形影不离。
</p>

<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
一个非常简单的帮助编程的工具，用以在echo area显示函数或者变量的签名/定义。这对于编程来说是非常重要的，而且这个功能使用起来非常轻量级。
</p>

<p>
emacs 27自动开启的
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x eldoc-mode
</pre>
</div>

<p>
或者用hook方式添加到编程模式中
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'prog-mode 'eldoc-mode)
</pre>
</div>

<p>
在回显区就能看到当前函数或者变量的签名/定义了
</p>
</div>
</div>
<div id="outline-container-h:2beea88c-e4c7-486d-8d47-63492b0ca00a" class="outline-3">
<h3 id="h:2beea88c-e4c7-486d-8d47-63492b0ca00a">hideShow代码折叠 内置包</h3>
<div class="outline-text-3" id="text-h:2beea88c-e4c7-486d-8d47-63492b0ca00a">
<p>
就如同它的名字那样，它的作用就是对一段代码/文档，进行折叠/展开。比如你在编写C-Like代码的时候，`{}`包围的部分。比如一个class，比如一个function等等。可以让你的文档以及注意力变的更加的集中和聚焦。
</p>


<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
开启
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x hs-minor-mode
&#25110;&#32773; hook&#20013;
(add-hook 'prog-mode 'hs-minor-mode)
</pre>
</div>

<p>
开启后，就可以用以下命令来折叠或者展开了
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">hs-hide-all/hs-show-all               &#25240;&#21472;/&#23637;&#24320;&#20840;&#37096;&#20195;&#30721;&#22359;
hs-hide-block/hs-show-block           &#25240;&#21472;/&#23637;&#24320;&#24403;&#21069;&#20195;&#30721;&#22359;
hs-hide-initial-comment-block/hs-show-initial-comment-block  &#25240;&#21472;/&#23637;&#24320;&#24320;&#22987;&#30340;&#27880;&#37322;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:84cbd0b2-761f-4ba7-826f-b607992c572c" class="outline-3">
<h3 id="h:84cbd0b2-761f-4ba7-826f-b607992c572c">flymake 语法检查器 内置包</h3>
<div class="outline-text-3" id="text-h:84cbd0b2-761f-4ba7-826f-b607992c572c">
<p>
实时语法检查。或许曾经你更喜欢flycheck，或者曾经你听说过许多flymake的“坏话”，但那都是历史了。如今你应该重新来体验一下最新的flymake了。从Emacs26开始，重构之后的FlyMake已经焕然一新。是你心中想要的样子了。而且，已经是我必备的日常工具了。简单，强大。我日常使用的场景都能支持了。
</p>


<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
自emacs26以来，有了很大进步，体验并不输flycheck多少。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">flymake &#35821;&#27861;&#26816;&#26597; &#20869;&#32622;&#21253;</span>
 (<span style="color: #a020f0;">use-package</span> flymake
    <span style="color: #483d8b;">:ensure</span> nil
    <span style="color: #483d8b;">:diminish</span> (flymake <span style="color: #8b2252;">" Flym."</span>)
    <span style="color: #483d8b;">:hook</span> (prog-mode . flymake-mode)
    <span style="color: #483d8b;">:bind</span> ((<span style="color: #8b2252;">"M-n"</span> . flymake-goto-next-error)
            (<span style="color: #8b2252;">"M-p"</span> . flymake-goto-prev-error)))
</pre>
</div>

<p>
这样配置了2个快捷键，以及它在Mode line上的表现，同时在编程模式下它会被自动启用。
</p>
</div>
</div>
<div id="outline-container-h:90d00d54-b727-4f3a-b620-16a6f839658c" class="outline-3">
<h3 id="h:90d00d54-b727-4f3a-b620-16a6f839658c">CC Mode</h3>
<div class="outline-text-3" id="text-h:90d00d54-b727-4f3a-b620-16a6f839658c">
<p>
一直以来，我对这个功能都不怎么感冒。我觉得它重，而且不实用。直到我折腾了它里面的几个命令，比如comment-开头的那几个，hungry delete等之后，就感觉到这些“看似三方”的功能，原来在Emacs中都已经有内置。这已经称为了我日常使用的一个基本的模式了。其实你只需要开启其中的一些你需要或者喜欢的就可以了。但无论你开启了几个，我都建议你非常认真的学习以下CC Mode的手册。太棒了！
</p>
</div>
</div>
<div id="outline-container-h:430e36b7-018e-4101-94e9-d3dcfc6134ab" class="outline-3">
<h3 id="h:430e36b7-018e-4101-94e9-d3dcfc6134ab">ielm</h3>
<div class="outline-text-3" id="text-h:430e36b7-018e-4101-94e9-d3dcfc6134ab">
<p>
交互式Emacs Lisp解释器。经常的，我会用它来学习和测试一些ELisp的语法以及函数等。是跟ipython，go playground差不多的东西。学习ELisp的时候，应该会经常使用到它。
</p>
</div>
</div>
<div id="outline-container-h:84445224-bb5f-4a3f-9cc9-0df3abb6b08c" class="outline-3">
<h3 id="h:84445224-bb5f-4a3f-9cc9-0df3abb6b08c">Org Mode</h3>
<div class="outline-text-3" id="text-h:84445224-bb5f-4a3f-9cc9-0df3abb6b08c">
<p>
啊，这个包真的不需要解释。甚至有很多人使用Emacs的原因就是因为这个包。文本的世界，或许才是你真正的生活乐趣。（这就是我现在越来越喜欢写而不是录制视频的原因。）
</p>
</div>
</div>
<div id="outline-container-h:1c626f40-445b-46d6-8842-9eddd63fa4dd" class="outline-3">
<h3 id="h:1c626f40-445b-46d6-8842-9eddd63fa4dd">VC</h3>
<div class="outline-text-3" id="text-h:1c626f40-445b-46d6-8842-9eddd63fa4dd">
<p>
版本控制。你一定用过Subversion，你一定用着Git，或许你还在使用一些其他的版本控制系统。你以往的做法是安装一个又一个的插件来管理不同的系统。但内置的这个VC可以帮你用一种统一的方式来管理各种系统。不论是SVN，还是Git，一样的操作流程。
</p>

<p>
但讲真，这个插件功能虽然强大，但有些习惯（尤其是被magit这样的插件）一旦养成，还是需要一定的时间来改变和理解。但你只要适应了VC的思路，你应该会喜欢。
</p>

<p>
更重要的，在任何平台（比如Windows）上VC都没有性能问题，Magit（等插件）能做到吗？
</p>
</div>
</div>
<div id="outline-container-h:b67fb45a-f74a-4fbd-9df2-8dd574a0fce7" class="outline-3">
<h3 id="h:b67fb45a-f74a-4fbd-9df2-8dd574a0fce7">EShell/Term</h3>
<div class="outline-text-3" id="text-h:b67fb45a-f74a-4fbd-9df2-8dd574a0fce7">
<p>
在Emacs中使用终端。不用过多解释，也不用有过多的学习精力，就按照你想的那样使用就行了。减少了一个离开Emacs切换终端的步骤。
</p>


<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
使用elisp写成的shell。类似于软件term
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x eshell
</pre>
</div>


<p>
参考使用说明 <a href="https://github.com/emacs-china/hello-emacs/blob/master/Emacs%E4%B8%AD%E7%9A%84shell--Eshell%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0.org">https://github.com/emacs-china/hello-emacs/blob/master/Emacs%E4%B8%AD%E7%9A%84shell--Eshell%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0.org</a>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #483d8b;">cd</span> /ssh:xx.com
find-file filename
</pre>
</div>
</div>
</div>
<div id="outline-container-h:015db127-1d46-4b11-aae9-0c194f1c51c2" class="outline-3">
<h3 id="h:015db127-1d46-4b11-aae9-0c194f1c51c2">package.el</h3>
<div class="outline-text-3" id="text-h:015db127-1d46-4b11-aae9-0c194f1c51c2">
<p>
之前的视频版本中，我把这个插件放到了最前面。而在本文中，我也考虑过不介绍。因为它已经是任何的系统/编程语言/工具……的标配了。包管理器。如果没有包管理器，你都不好意思在开源软件的世界里混。就连……Windows都有了winget，scoop，chocolatey。
</p>

<p>
你安装的那些第三方插件，都是通过它（或者一些它的增强包）来完成的。没有必要刻意研究它，会配置它的源，会调用它的几个命令（更新，安装，删除等）就可以了。你什么时候对它感兴趣了，它就在那里。
</p>
</div>
</div>
<div id="outline-container-h:4edd4a74-ae23-45c4-9395-65a7abc208bc" class="outline-3">
<h3 id="h:4edd4a74-ae23-45c4-9395-65a7abc208bc">tramp-mode编辑远程文件插件</h3>
<div class="outline-text-3" id="text-h:4edd4a74-ae23-45c4-9395-65a7abc208bc">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>
<ul class="org-ul">
<li>tramp-mode <a href="https://www.emacswiki.org/emacs/TrampMode">https://www.emacswiki.org/emacs/TrampMode</a></li>
</ul>

<p>
TRAMP（Transparent Remote Access, Multiple Protocols透明远程访问，多协议）是一个用于编辑远程文件的包，
</p>

<p>
借助TRAMP,你可以像编辑本地文件一样来编辑远程文件。我通常通过 ssh 执行此操作。其它工具sshfs可以把远程服务器目录挂载到本地。
</p>

<p>
tramp的用法很简单,只要你在 `C-x C-f` 选择文件时使用一种特殊的语法格式来标示文件就行了.
</p>

<p>
tramp标示文件的语法为:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">/[protocol]:[user@]hostname[#port]<span style="color: #483d8b;">:path-to-file</span> 
</pre>
</div>

<p>
例如 `/ssh:cnaps2@10.8.6.10:~/tmp/t.log` 会通过ssh协议,以cnaps2用户登录10.8.6.10这台机,并访问上面的~/tmp/t.log文件.
</p>

<p>
当你用tramp打开remote文件时,会在modeline上显示一个 `@10.8.6.10` 这样的标识,说明这个是一个10.8.6.10上的远程文件.
</p>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">root&#36523;&#20221;&#32534;&#36753;&#26412;&#22320;&#25991;&#20214;</span>
sudo::/tmp/sc/rootfile
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22810;&#32423;&#36339;&#36716;&#32534;&#36753;&#25991;&#20214;</span>
ssh::www.cstu.org|sudo:www.cstuy.org:/home/zamansky/sc/rootfile
</pre>
</div>

<p>
当然你也可以用sshfs服务挂载远程服务到本地来使用。
</p>
</div>
</div>
<div id="outline-container-h:4b0b6921-55ca-4f6a-8e18-435254009d8b" class="outline-3">
<h3 id="h:4b0b6921-55ca-4f6a-8e18-435254009d8b">eww  浏览器 内置包</h3>
<div class="outline-text-3" id="text-h:4b0b6921-55ca-4f6a-8e18-435254009d8b">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
默认的搜索引擎是duckduckgo。可以使用`M-x eww`来启动
EWW 有它无与伦比的优势：
</p>
<ul class="org-ul">
<li>干净、纯粹，不容易分心</li>
<li>方便调整字体</li>
<li>无法执行 JS，无隐私泄漏问题</li>
</ul>

<p>
第二点非常重要，有些网页的设计实在是不方便沉浸式阅读，要不就是文字太小，要不就是背景色太亮，而在 EWW 中，这些问题都能解决，就是一般的 buffer 设置而已。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my/set-eww-font</span> (fontconfig)
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"sFontconfig(Ubuntu-20): "</span>)
  (<span style="color: #a020f0;">let</span> ((font (<span style="color: #a020f0;">or</span> (<span style="color: #a020f0;">if</span> (string-empty-p fontconfig)
                      <span style="color: #8b2252;">"Ubuntu-20"</span>
                    fontconfig))))
    (set-face-attribute 'variable-pitch (selected-frame) <span style="color: #483d8b;">:font</span> font)))
</pre>
</div>
<p>
常用快捷键
</p>
<div class="org-src-container">
<pre class="src src-shell">w  &#25335;&#36125;&#24403;&#21069;&#39029;&#38754; URL
g  &#21047;&#26032;&#24403;&#21069;&#39029;&#38754;
[  &#21518;&#36864;
]  &#21069;&#36827;
v  &#26597;&#30475;&#32593;&#39029;&#28304;&#30721;
b  &#28155;&#21152;&#24403;&#21069;&#39029;&#38754;&#21040;&#24050;&#31614;
B  &#26597;&#30475;&#24050;&#31614;
R  &#24320;&#21551;&#38405;&#35835;&#27169;&#24335;
n/p  &#33258;&#21160;&#36339;&#21040;&#19979;&#19968;&#39029;/&#19978;&#19968;&#39029;
M-RET &#22312;&#26032; buffer &#20869;&#25171;&#24320;&#38142;&#25509;
</pre>
</div>
<p>
n/p 是通过寻找页面中含有 next 标记的链接，比如 <a href="https://dev.mysql.com/doc/internals/en/files-in-innodb-sources.html">MySQL 的文档</a>就支持上下页跳转。
</p>

<p>
为了方便浏览国外技术网站，需要让 EWW 走代理，可以参考：<a href="https://emacstalk.github.io/post/007/">url-retrieve 使用 curl 作为后端实现</a>。
</p>
</div>
</div>
<div id="outline-container-h:8a5cf80c-052c-4bab-bacd-37eb4f9b28bb" class="outline-3">
<h3 id="h:8a5cf80c-052c-4bab-bacd-37eb4f9b28bb">mu4e邮件</h3>
<div class="outline-text-3" id="text-h:8a5cf80c-052c-4bab-bacd-37eb4f9b28bb">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
unix <a href="http://www.lijigang.com/blog/2020/05/12/emacs-process-mail/">http://www.lijigang.com/blog/2020/05/12/emacs-process-mail/</a>
</p>



<p>
<a href="http://blog.lujun9972.win/blog/2016/12/29/%E4%BD%BF%E7%94%A8emacs%E5%8F%91%E9%80%81%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6/index.html">http://blog.lujun9972.win/blog/2016/12/29/%E4%BD%BF%E7%94%A8emacs%E5%8F%91%E9%80%81%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6/index.html</a>
</p>



<p>
windows
</p>
</div>
</div>
<div id="outline-container-h:ff805566-6d9b-4233-a01a-6ab8d36311ed" class="outline-3">
<h3 id="h:ff805566-6d9b-4233-a01a-6ab8d36311ed">emms music插件</h3>
<div class="outline-text-3" id="text-h:ff805566-6d9b-4233-a01a-6ab8d36311ed">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>emms <a href="https://www.gnu.org/software/emms/">https://www.gnu.org/software/emms/</a></li>
</ul>

<p>
Emms的基本功能由三部分组成：核心、来源和播放器
</p>

<div class="org-src-container">
<pre class="src src-shell">git chttps://git.savannah.gnu.org/git/emms.git
</pre>
</div>



<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'general) (require 'pretty-hydra)</span>
(<span style="color: #a020f0;">use-package</span> emms
  <span style="color: #483d8b;">:general</span>
  (z-spc-leader-def <span style="color: #8b2252;">"e"</span> 'z-music-hydra/body)
  (ranger-mode-map <span style="color: #8b2252;">"C-c m"</span> 'emms-play-dired)
  <span style="color: #483d8b;">:pretty-hydra</span>
  (z-music-hydra
   (<span style="color: #483d8b;">:color</span> red <span style="color: #483d8b;">:quit-key</span> <span style="color: #8b2252;">"q"</span>)
   (<span style="color: #8b2252;">"Playlists"</span>
    ((<span style="color: #8b2252;">"e"</span> emms)
     (<span style="color: #8b2252;">"g"</span> emms-play-directory <span style="color: #8b2252;">"open dir"</span>)
     (<span style="color: #8b2252;">"v"</span> emms-playlist-mode-go <span style="color: #8b2252;">"go to current"</span>)
     (<span style="color: #8b2252;">"m"</span> emms-metaplaylist-mode-go <span style="color: #8b2252;">"metaplaylist"</span>))
    <span style="color: #8b2252;">"Controls"</span>
    ((<span style="color: #8b2252;">"n"</span> emms-next <span style="color: #8b2252;">"next"</span>)
     (<span style="color: #8b2252;">"p"</span> emms-previous <span style="color: #8b2252;">"previous"</span>)
     (<span style="color: #8b2252;">"s"</span> emms-shuffle <span style="color: #8b2252;">"shuffle"</span>))
    <span style="color: #8b2252;">""</span>
    ((<span style="color: #8b2252;">"i"</span> emms-mode-line-toggle <span style="color: #8b2252;">"song info"</span>)
     (<span style="color: #8b2252;">"w"</span> emms-pause <span style="color: #8b2252;">"pause"</span>)
     (<span style="color: #8b2252;">"x"</span> emms-stop <span style="color: #8b2252;">"stop"</span>))
    ))
  <span style="color: #483d8b;">:custom</span>
  (emms-seek-seconds 5)
  (emms-player-list '(emms-player-mpv))
  (emms-source-file-default-directory <span style="color: #8b2252;">"~/Music/"</span>)
  (emms-playlist-buffer-name <span style="color: #8b2252;">"*Emms*"</span>)
  (emms-source-file-directory-tree-function 'emms-source-file-directory-tree-find)
  (emms-browser-covers 'emms-browser-cache-thumbnail)
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">emms-setup</span>)
  (emms-all)
  (emms-history-load)
  (emms-mode-line-disable))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:8ea20429-db9d-4f69-a8b1-5165701b8d81" class="outline-3">
<h3 id="h:8ea20429-db9d-4f69-a8b1-5165701b8d81">recentf 最近访问文件</h3>
<div class="outline-text-3" id="text-h:8ea20429-db9d-4f69-a8b1-5165701b8d81">
<p>
recentf-mode 最近打开过文件的选项
</p>

<p>
内置功能
</p>

<p>
让我们更快捷的在图形界面的菜单中打开最近 编辑过的文件。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;  </span><span style="color: #b22222;">&#26368;&#36817;&#25171;&#24320;&#36807;&#25991;&#20214;&#30340;&#36873;&#39033; t(rue) 1&#34920;&#31034;&#24320;&#21551;</span>
(add-hook 'after-init-hook 'recentf-mode)
(<span style="color: #a020f0;">setq-default</span>
 recentf-max-saved-items 1000
 recentf-exclude `(<span style="color: #8b2252;">"/tmp/"</span> <span style="color: #8b2252;">"/ssh:"</span> ,(concat package-user-dir <span style="color: #8b2252;">"/.*-autoloads\\.el\\'"</span>)))
</pre>
</div>

<p>
使用 `M-x recentf-open-files` 打开最近文件列表。后面可以使用  counsel 插件的 `counsel-recentf` 绑定快捷键 `C-x C-r`代替此功能。
或者使用 consult 插件的 `consult-buffer` 绑定 `C-x b` 显示最近打开的文件
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> recentf
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:bind</span> ((<span style="color: #8b2252;">"C-x C-r"</span> . recentf-open-files))
  <span style="color: #483d8b;">:hook</span> (after-init . recentf-mode)
  <span style="color: #483d8b;">:init</span> (<span style="color: #a020f0;">setq</span> recentf-max-saved-items 300
              recentf-exclude
              '(<span style="color: #8b2252;">"\\.?cache"</span> <span style="color: #8b2252;">".cask"</span> <span style="color: #8b2252;">"url"</span> <span style="color: #8b2252;">"COMMIT_EDITMSG\\'"</span> <span style="color: #8b2252;">"bookmarks"</span>
                <span style="color: #8b2252;">"\\.</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(?:</span><span style="color: #8b2252;">gz</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">gif</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">svg</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">png</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">jpe?g</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">bmp</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">xpm</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">$"</span>
                <span style="color: #8b2252;">"\\.?ido\\.last$"</span> <span style="color: #8b2252;">"\\.revive$"</span> <span style="color: #8b2252;">"/G?TAGS$"</span> <span style="color: #8b2252;">"/.elfeed/"</span>
                <span style="color: #8b2252;">"^/tmp/"</span> <span style="color: #8b2252;">"^/var/folders/.+$"</span> <span style="color: #8b2252;">"^/ssh:"</span> <span style="color: #8b2252;">"/persp-confs/"</span>
                (<span style="color: #a020f0;">lambda</span> (file) (file-in-directory-p file package-user-dir))))
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">push</span> (expand-file-name recentf-save-file) recentf-exclude)
  (add-to-list 'recentf-filename-handlers #'abbreviate-file-name))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:6fb2aa07-eb86-4101-bc04-67f8d1903e58" class="outline-3">
<h3 id="h:6fb2aa07-eb86-4101-bc04-67f8d1903e58">sessions 保存和恢复编辑器会话</h3>
<div class="outline-text-3" id="text-h:6fb2aa07-eb86-4101-bc04-67f8d1903e58">
</div>
<div id="outline-container-h:552aeaef-16e0-4072-ada3-a8e459094020" class="outline-4">
<h4 id="h:552aeaef-16e0-4072-ada3-a8e459094020">savehist, saveplace 保存光标历史，记住上个命令位置</h4>
<div class="outline-text-4" id="text-h:552aeaef-16e0-4072-ada3-a8e459094020">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> savehist
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:hook</span> (after-init . savehist-mode)
  <span style="color: #483d8b;">:init</span> (<span style="color: #a020f0;">setq</span> enable-recursive-minibuffers t <span style="color: #b22222;">; </span><span style="color: #b22222;">Allow commands in minibuffers</span>
              history-length 1000
              savehist-additional-variables '(mark-ring
                                              global-mark-ring
                                              search-ring
                                              regexp-search-ring
                                              extended-command-history)
              savehist-autosave-interval 300)
  )

(<span style="color: #a020f0;">use-package</span> saveplace
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:hook</span> (after-init . save-place-mode))
</pre>
</div>

<p>
savehist-mode  默认开启，重启 emacs 会记住使用过的命令，同时会保存到 <code>~/.emacs.d/history</code> 文件中。 history 文件还保存了 minibuffer 的变量、查找过的文件等。
</p>

<p>
save-place-mode 开启后，会记住光标所在文件的位置，下次打开文件时自动光标指向这个位置
</p>

<p>
测试：
</p>
<ul class="org-ul">
<li>记住光标的位置，重启emacs</li>
<li><code>C-x C-f</code> 重新打开该文件，可以看到光标是上次退出的位置。</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:188a76a5-8b4f-4cfe-8610-07f130a81150" class="outline-3">
<h3 id="h:188a76a5-8b4f-4cfe-8610-07f130a81150">几个内置的主题</h3>
<div class="outline-text-3" id="text-h:188a76a5-8b4f-4cfe-8610-07f130a81150">
<ul class="org-ul">
<li>leuven，我最喜欢的亮色主题之一了。其实它也有暗色主题，只是没有内置。</li>
<li>modus，应该是从Emacs 28开始内置的一款包含亮/暗色的主题。非常好，我很喜欢。暗色有的时候，我感觉眼睛有点累。</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(load-theme 'manoj-dark)
(load-theme 'leuven t)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a42add85-8942-4d45-a922-d4dd150941c8" class="outline-3">
<h3 id="h:a42add85-8942-4d45-a922-d4dd150941c8">不常用的内置功能</h3>
<div class="outline-text-3" id="text-h:a42add85-8942-4d45-a922-d4dd150941c8">
<p>
列举在这里，你可以按照自己的喜好，来开启或试用。
</p>

<ul class="org-ul">
<li>tab-bar-mode，我个人更喜欢使用buffer切换的方式</li>

<li>artist-mode，绘制一些ASCII字符画，比如线条，三角形，矩形等</li>

<li>CEDET，集成开发环境（但很可惜，我更喜欢eglot或者lsp-mode）</li>

<li>Ebrowse，因为不写C++代码，所以我不怎么使用</li>

<li>RefTex，Latex的一些标签，引用的支持</li>

<li>EWW，网络浏览器</li>

<li>Gnus，邮件和新闻</li>

<li>Messages，邮件管理</li>

<li>ERC，IRC客户端</li>

<li>Rcirc，IRC客户端</li>

<li>Newsticker，RSS阅读器</li>

<li>seq.el，ELisp编程中经常使用</li>

<li>cl-lib.el，Common Lisp的扩展包，也经常使用</li>

<li>EIEIO，面向对象编程，我是在研究eglot的源码的时候知道了这个东西</li>

<li>mpc，音乐播放器</li>
</ul>
</div>
</div>
</section>
<section id="outline-container-h:79a4c1cb-7b35-45e3-8a14-0c6458ffd03c" class="outline-2">
<h2 id="h:79a4c1cb-7b35-45e3-8a14-0c6458ffd03c">插件-功能优化类</h2>
<div class="outline-text-2" id="text-h:79a4c1cb-7b35-45e3-8a14-0c6458ffd03c">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
功能优化类：对 Emacs 自身的一些不够完美的功能进行替换，解决一些痛点，提高操作便利性
</p>
</div>
<div id="outline-container-h:eb8b4bbf-fb19-45da-be61-27f1a073497a" class="outline-3">
<h3 id="h:eb8b4bbf-fb19-45da-be61-27f1a073497a">ivy 搜索优化插件</h3>
<div class="outline-text-3" id="text-h:eb8b4bbf-fb19-45da-be61-27f1a073497a">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>ivy <a href="https://github.com/abo-abo/swiper">https://github.com/abo-abo/swiper</a></li>
</ul>

<p>
ivy 就为 Emacs 带来了使用体验上的巨大提升，就好像用了 oh-my-zsh 的 zsh。
</p>

<p>
打开 ivy 的链接，会发现其实这个仓库名为 swiper，里面包含了 ivy、counsel 和 swiper 三部分。它们三个分别加强了 Emacs 的三个方面：*补全系统*、*部分常用命令*、*搜索功能*。由于是作者 abo-abo（Oleh Krehel）开发的三个模块，现在都整合到了一起，我们一并安装就好。顺带一提的是，这位作者非常厉害，我们后面提到的好几个插件都由他发起和编写。
</p>

<p>
ivy，设置缓冲区格式
</p>

<p>
counsel，emacs中命令指定用ivy方式展示
</p>

<p>
swiper，代替自带的isearch搜索功能
</p>
</div>
<div id="outline-container-h:663fea7f-7999-475b-b228-a1d7f6790cb4" class="outline-4">
<h4 id="h:663fea7f-7999-475b-b228-a1d7f6790cb4">配置流程</h4>
<div class="outline-text-4" id="text-h:663fea7f-7999-475b-b228-a1d7f6790cb4">
<p>
接下来，通过 ivy 来让读者熟悉一下 Emacs 安装插件的流程：
</p>

<ol class="org-ol">
<li>*得知插件*：首先我们会通过一些渠道听说某个插件很好用（比如通过本系列教程），于是我们找到它的主页（绝大多数情况都是一个 GitHub 仓库，我们可以 Google 一下或者直接在 GitHub 上搜索）。</li>
<li>*阅读主页*：一个好用且用户数量大的插件的主页一定是非常完善的，包括了插件的功能介绍、安装、配置，以及 Issue （Issue 指使用中上报发现的问题和漏洞）和如何贡献等等。对于我们 Emacs 初级用户而言，我们主要关注前半部分，也就是功能、安装、配置。</li>
<li>*安装*：尽管该仓库包含了三部分，但它们都合并到了一个 package，也就是相当于是一个插件，名为 ivy。于是我们看 ivy的主页的 “Installation” 一节中写着：</li>
</ol>
<div class="org-src-container">
<pre class="src src-shell">Install the ivy package from GNU ELPA or MELPA.
</pre>
</div>

<p>
很多插件都会用这样的一句话一笔带过安装方式。MELPA 是一个插件仓库，那么只要我们的配置文件中写好了相应的链接配置，就可以通过输入 <code>M-x package-install</code> <code>&lt;RET&gt;</code> <code>ivy</code> <code>&lt;RET&gt;</code> 来安装插件了。
</p>

<p>
此外，我们有一个更方便的方式来管理插件—— use-package 插件。因此读者需要首先按照上一篇教程中的指导安装好 use-package 插件。于是我们可以直接在配置文件（例如 `~/.emacs.d/init.el`）中写上：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> ivy
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<ol class="org-ol">
<li>配置</li>
</ol>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">mypackages</span> '(
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">--- Better Editor ---</span>
         swiper
               counsel
         ) <span style="color: #ff0000; font-weight: bold;">"Default packages"</span><span style="color: #ff0000; font-weight: bold;">)</span>
(ivy-mode)
(<span style="color: #a020f0;">setq</span> ivy-use-virtual-buffers t)
(<span style="color: #a020f0;">setq</span> enable-recursive-minibuffers t)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">enable this if you want `</span><span style="color: #008b8b;">swiper</span><span style="color: #b22222;">' to use it</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq search-default-mode #'char-fold-to-regexp)</span>
(global-set-key <span style="color: #8b2252;">"\C-s"</span> 'swiper)
(global-set-key (kbd <span style="color: #8b2252;">"C-c C-r"</span>) 'ivy-resume)
(global-set-key (kbd <span style="color: #8b2252;">"M-x"</span>) 'counsel-M-x)
(global-set-key (kbd <span style="color: #8b2252;">"C-x C-f"</span>) 'counsel-find-file)
(global-set-key (kbd <span style="color: #8b2252;">"&lt;f1&gt; f"</span>) 'counsel-describe-function)
(global-set-key (kbd <span style="color: #8b2252;">"&lt;f1&gt; v"</span>) 'counsel-describe-variable)
</pre>
</div>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#31616;&#21333;&#20351;&#29992;</span>
(<span style="color: #a020f0;">use-package</span> counsel
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind</span> ((<span style="color: #8b2252;">"M-x"</span> . counsel-M-x)
           (<span style="color: #8b2252;">"C-x C-f"</span> . counsel-find-file)
  )
(<span style="color: #a020f0;">use-package</span> swiper
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:diminish</span> (ivy-mode . <span style="color: #8b2252;">""</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#19981;&#22312;&#27425;&#27169;&#24335;&#20013;&#26174;&#31034;</span>
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">progn</span>
    (ivy-mode)
    (<span style="color: #a020f0;">setq</span> ivy-use-virtual-buffers t)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21152;&#36895;</span>
    (<span style="color: #a020f0;">setq</span> enable-recursive-minibuffers t)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21152;&#36895;</span>
    (<span style="color: #a020f0;">setq</span> ivy-initialinputs-alist nil)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#27809;&#26377;&#24320;&#22987;&#26102;&#21021;&#22987;&#21270;&#35774;&#32622;&#30340;&#20540;</span>
    (<span style="color: #a020f0;">setq</span> ivy-count-format <span style="color: #8b2252;">"%d/%d )     ;; &#26174;&#31034;&#25628;&#32034;&#30340;&#25968;&#37327;</span>
<span style="color: #8b2252;">    (setq ivy-re-builders-alist '((t . ivy--regex-ignore-order))) ;; &#29992;regex&#25628;&#32034;&#26102;&#27809;&#26377;&#24046;&#21035;</span>
<span style="color: #8b2252;">    ;; enable this if you want `</span><span style="color: #008b8b;">swiper</span><span style="color: #8b2252;">' to use it</span>
<span style="color: #8b2252;">    ;; (setq search-default-mode #'char-fold-to-regexp)</span>
<span style="color: #8b2252;">    (global-set-key "</span>\C-s<span style="color: #8b2252;">" 'swiper)</span>
<span style="color: #8b2252;">    (global-set-key (kbd "</span>C-x b<span style="color: #8b2252;">") 'ivy-switch-buffer)</span>
<span style="color: #8b2252;">    (global-set-key (kbd "</span>C-c v<span style="color: #8b2252;">") 'ivy-push-view)</span>
<span style="color: #8b2252;">    (global-set-key (kbd "</span>C-c V<span style="color: #8b2252;">") 'ivy-pop-view)</span>
<span style="color: #8b2252;">    (global-set-key (kbd "</span>C-c s<span style="color: #8b2252;">") 'ivy-switch-view)</span>
<span style="color: #8b2252;">    (global-set-key (kbd "</span>C-c C-r<span style="color: #8b2252;">") 'ivy-resume)</span>
<span style="color: #8b2252;">    (global-set-key (kbd "</span>M-x<span style="color: #8b2252;">") 'counsel-M-x)</span>
<span style="color: #8b2252;">    (global-set-key (kbd "</span>C-x C-f<span style="color: #8b2252;">") 'counsel-find-file)</span>
<span style="color: #8b2252;">    (global-set-key (kbd "</span>M-y<span style="color: #8b2252;">") 'counsel-yank-pop)</span>
<span style="color: #8b2252;">    (global-set-key (kbd "</span>&lt;f1&gt; f<span style="color: #8b2252;">") 'counsel-describe-function)</span>
<span style="color: #8b2252;">    (global-set-key (kbd "</span>&lt;f1&gt; v<span style="color: #8b2252;">") 'counsel-describe-variable)))</span>

<span style="color: #8b2252;">;; &#26356;&#26377;&#25928;&#37197;&#32622;</span>
<span style="color: #8b2252;">;; --- ivy-counsel-swiper ---</span>
<span style="color: #8b2252;">(use-package ivy</span>
<span style="color: #8b2252;">  :ensure t</span>
<span style="color: #8b2252;">  :defer 1</span>
<span style="color: #8b2252;">  :demand</span>
<span style="color: #8b2252;">  :hook (after-init . ivy-mode)</span>
<span style="color: #8b2252;">  :config</span>
<span style="color: #8b2252;">  (ivy-mode 1)</span>
<span style="color: #8b2252;">  (setq ivy-use-virtual-buffers t</span>
<span style="color: #8b2252;">          ivy-initial-inputs-alist nil</span>
<span style="color: #8b2252;">          ivy-count-format "</span>%d/%d <span style="color: #8b2252;">"</span>
<span style="color: #8b2252;">          enable-recursive-minibuffers t</span>
<span style="color: #8b2252;">          ivy-re-builders-alist '((t . ivy--regex-ignore-order)))</span>
<span style="color: #8b2252;">   :bind (("</span>C-x b<span style="color: #8b2252;">" . ivy-switch-buffer)</span>
<span style="color: #8b2252;">            ("</span>C-c C-r<span style="color: #8b2252;">" . ivy-resume))</span>
<span style="color: #8b2252;">)</span>

<span style="color: #8b2252;">(use-package counsel</span>
<span style="color: #8b2252;">  :ensure t</span>
<span style="color: #8b2252;">  :after (ivy)</span>
<span style="color: #8b2252;">  :bind (("</span>M-x<span style="color: #8b2252;">" . counsel-M-x)</span>
<span style="color: #8b2252;">           ("</span>C-x C-f<span style="color: #8b2252;">" . counsel-find-file)</span>
<span style="color: #8b2252;">           ("</span>C-c f<span style="color: #8b2252;">" . counsel-recentf)</span>
<span style="color: #8b2252;">           ("</span>C-c g<span style="color: #8b2252;">" . counsel-git)</span>
<span style="color: #8b2252;">           (("</span>M-y<span style="color: #8b2252;">" . counsel-yank-pop)</span>
<span style="color: #8b2252;">            :map ivy-minibuffer-map</span>
<span style="color: #8b2252;">            ("</span>M-y<span style="color: #8b2252;">" . ivy-next-line)))</span>
<span style="color: #8b2252;">)</span>

<span style="color: #8b2252;">(use-package swiper</span>
<span style="color: #8b2252;">  :ensure t</span>
<span style="color: #8b2252;">  :after ivy</span>
<span style="color: #8b2252;">  :bind (("</span>C-s<span style="color: #8b2252;">" . swiper)</span>
<span style="color: #8b2252;">           ("</span>C-r<span style="color: #8b2252;">" . swiper-isearch-backward)</span>
<span style="color: #8b2252;">   ("</span>C-c C-r<span style="color: #8b2252;">" . ivy-resume))</span>
<span style="color: #8b2252;">  :config (setq swiper-action-recenter t</span>
<span style="color: #8b2252;">                  swiper-include-line-number-in-search t)</span>
<span style="color: #8b2252;">)</span>
</pre>
</div>

<ul class="org-ul">
<li><code>C-x C-f</code> 时，我们不再调用的是 <code>find-file</code> ，而是 <code>counsel-find-file</code> ，最主要的区别便是会把当前目录下所有文件列表显示在一个新的 Minibuffer 中，当你想到上一级目录时，也只需要按下一次 &lt;DEL&gt; ，而不用像之前一样要删除一个词。 此外，还可以模糊输入文件名就可以找到相应的文件。</li>
<li><code>M-x</code> 也被替换为了 <code>counsel-M-x</code> ，会将命令也列表显示出来，同样也可以模糊输入命令。</li>
<li><code>C-x b</code> 切换 Buffer</li>
<li><code>C-s</code> 搜索</li>
<li><code>M-y</code> 使用剪贴板历</li>
</ul>

<p>
都会提供类似的补全功能
</p>

<p>
如 <code>M-x</code> 搜索函数时可选列表
</p>

<p>
<code>M-x eval</code> 时 <code>C-n C-p</code> 选择
</p>


<figure id="org86608f1">
<img src="./images/image-20210618165140071.png" alt="image-20210618165140071.png">

</figure>

<p>
插件-yank回溯 ivy
使用 <code>M-y</code> 选择要回溯的内容
</p>

<ul class="org-ul">
<li>参考 <a href="http://pragmaticemacs.com/emacs/counsel-yank-pop-with-a-tweak/">http://pragmaticemacs.com/emacs/counsel-yank-pop-with-a-tweak/</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> counsel
  <span style="color: #483d8b;">:bind</span>
  ((<span style="color: #8b2252;">"M-y"</span> . counsel-yank-pop)
   <span style="color: #483d8b;">:map</span> ivy-minibuffer-map
   (<span style="color: #8b2252;">"M-y"</span> . ivy-next-line)))
</pre>
</div>

<p>
和 ivy 功能基本类似的插件有 helm 和 ido ，
</p>
</div>
</div>
</div>
<div id="outline-container-h:47ed6446-96e7-4c02-aaba-41374718aa7f" class="outline-3">
<h3 id="h:47ed6446-96e7-4c02-aaba-41374718aa7f">amx</h3>
<div class="outline-text-3" id="text-h:47ed6446-96e7-4c02-aaba-41374718aa7f">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>amx <a href="https://github.com/DarwinAwardWinner/amx">https://github.com/DarwinAwardWinner/amx</a></li>
</ul>

<p>
这个插件可以记录我们每次调用 M-x 时输入的命令历史，然后每次将最常用的显示在前面，这对于我们短时间希望频繁输入某几个命令的场景非常有用。amx 的配置十分简单：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> amx
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span> (amx-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:7c3f3b73-46bc-400f-a3b0-2d7bb2094afc" class="outline-3">
<h3 id="h:7c3f3b73-46bc-400f-a3b0-2d7bb2094afc">ace-window 窗口间的跳转插件</h3>
<div class="outline-text-3" id="text-h:7c3f3b73-46bc-400f-a3b0-2d7bb2094afc">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>ace-window <a href="https://github.com/abo-abo/ace-window">https://github.com/abo-abo/ace-window</a></li>
</ul>

<p>
这又是一个 abo-abo（Oleh Krehel）的项目。我们用 Emacs 多窗口时，window 超过 3 个后就很难使用 C-x o 进行切换了。ace-window 对 C-x o 重新绑定，使用时可以为每个 window 编个号，用编号进行跳转。
</p>


<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;  </span><span style="color: #b22222;">ace-window &#31383;&#21475;&#38388;&#30340;&#36339;&#36716;&#25554;&#20214;</span>
(<span style="color: #a020f0;">use-package</span> ace-window
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25152;&#26377;&#31383;&#21475;&#20570;&#26144;&#23556;</span>
  (<span style="color: #a020f0;">progn</span>
    (global-set-key [remap other-window] 'ace-window)
    )
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32465;&#23450;&#24555;&#25463;&#38190;M-o&#24555;&#36895;&#20999;&#25442;&#31383;&#21475;&#65292;&#40664;&#35748;&#20026;C-x o</span>
  <span style="color: #483d8b;">:bind</span> ((<span style="color: #8b2252;">"M-o"</span> . 'ace-window)))
</pre>
</div>

<p>
使用 <code>C-x o</code> + 动作 + 窗口编号，可以完成删除移动等操作
</p>


<figure id="orgd7055b3">
<img src="./images/ace-window-extras.png" alt="ace-window-extras.png">

</figure>

<p>
源码
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Must be defined before `</span><span style="color: #008b8b;">aw-make-frame-char</span><span style="color: #b22222;">' since its :set function references this.</span>
(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">aw-dispatch-alist</span>
  '((?x aw-delete-window <span style="color: #8b2252;">"Delete Window"</span>)
    (?m aw-swap-window <span style="color: #8b2252;">"Swap Windows"</span>)
    (?M aw-move-window <span style="color: #8b2252;">"Move Window"</span>)
    (?c aw-copy-window <span style="color: #8b2252;">"Copy Window"</span>)
    (?j aw-switch-buffer-in-window <span style="color: #8b2252;">"Select Buffer"</span>)
    (?n aw-flip-window)
    (?u aw-switch-buffer-other-window <span style="color: #8b2252;">"Switch Buffer Other Window"</span>)
    (?e aw-execute-command-other-window <span style="color: #8b2252;">"Execute Command Other Window"</span>)
    (?F aw-split-window-fair <span style="color: #8b2252;">"Split Fair Window"</span>)
    (?v aw-split-window-vert <span style="color: #8b2252;">"Split Vert Window"</span>)
    (?b aw-split-window-horz <span style="color: #8b2252;">"Split Horz Window"</span>)
    (?o delete-other-windows <span style="color: #8b2252;">"Delete Other Windows"</span>)
    (?T aw-transpose-frame <span style="color: #8b2252;">"Transpose Frame"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">?i ?r ?t are used by hyperbole.el</span>
    (?? aw-show-dispatch-help))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:16d736b7-ad2f-490b-af9d-58b8ba73e251" class="outline-3">
<h3 id="h:16d736b7-ad2f-490b-af9d-58b8ba73e251">mwin</h3>
<div class="outline-text-3" id="text-h:16d736b7-ad2f-490b-af9d-58b8ba73e251">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>mwin <a href="https://github.com/alezost/mwim.el">https://github.com/alezost/mwim.el</a></li>
</ul>

<p>
<code>C-a</code> 对应了 <code>move-beginning-of-line</code> ， <code>M-m</code> 对应了 <code>back-to-indentation</code> 。当代码有缩进时，前者会把光标移动到行首（到空格之前），后者会移动到代码文字的开头（到空格之后）。那么实际中这两个按法差别较大，且不易区分，使用起来不方便。mwim 就将二者合并，覆盖 <code>C-a</code> 为 <code>mwim-beginning-of-code-or-line</code> ，这样按一次 <code>C-a</code> 时移动到代码文字开头，再按一次则是移动到整行的行首，如此反复
</p>

<p>
同时，更有意义的是，它还可以覆盖 <code>C-e</code> <code>move-end-of-line</code> 为 <code>mwim-end-of-code-or-line</code> ，当本行代码结尾有注释时，第一次按 <code>C-e</code> 将光标移动到代码尾部、注释之前。再按一次则是移动到整行的行尾。 这就大大提高了写代码的效率。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> mwim
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind</span>
  (<span style="color: #8b2252;">"C-a"</span> . mwim-beginning-of-code-or-line)
  (<span style="color: #8b2252;">"C-e"</span> . mwim-end-of-code-or-line))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9b874035-242f-42fa-89e5-89bf53304977" class="outline-3">
<h3 id="h:9b874035-242f-42fa-89e5-89bf53304977">undo-tree 撤销树插件</h3>
<div class="outline-text-3" id="text-h:9b874035-242f-42fa-89e5-89bf53304977">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>undo-tree <a href="https://www.emacswiki.org/emacs/UndoTree">https://www.emacswiki.org/emacs/UndoTree</a></li>
</ul>
<p>
基础撤销 ：使用 <code>C-/</code> 或者 <code>C-_</code> 或者 <code>C-x u</code>
</p>

<p>
还记得 Emacs 令人头疼的撤销和重做操作吗？ <code>C-x u</code> 对应了 undo 命令，而 redo 则需要先 <code>C-g</code> 让历史记录环方向转换，再进行 undo 表示 redo。
</p>

<p>
想要撤销之前的撤销？你如果撤销，然后再做一个没有任何内容编辑的行动，之后下一个撤销就会撤销刚刚的撤销，于是形成了一个重做。 <code>C-g</code> 就是起到其中“没有任何内容编辑的行动”的作用。
</p>

<p>
所有的编辑都会成为 undo-tree 上的一个节点。当按下 <code>C-x u</code> 时就会显示出这棵树。当你撤销时，只需要向上寻找历史节点。而当你又做了其它编辑，这棵树就会分叉。也就意味着，你之前的记录依然被保留，你随时可以反悔，也不用担心不小心编辑了内容导致无法重做。
</p>

<p>
undo-tree 被放在了 GNU ELPA 上，并不是 MELPA，所以读者如果用了国内镜像，一定要把 GNU ELPA 加入到包管理链接中，详见 MELPA 插件源。
</p>


<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;  </span><span style="color: #b22222;">undo-tree &#25764;&#38144;&#26641;&#25554;&#20214;</span>
(<span style="color: #a020f0;">use-package</span> undo-tree
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span> (global-undo-tree-mode))
</pre>
</div>


<p>
<code>C-x u</code> 进入undo tree，显示diff window
</p>
<ul class="org-ul">
<li>p n   上下移动，</li>
<li>b f    在分支左右切换，</li>
<li>t 显示时间戳，选定需要的状态后，</li>
<li>q 退出。</li>
</ul>
</div>
</div>
<div id="outline-container-h:d3c54205-538e-451f-bc4e-476cd9e605d7" class="outline-3">
<h3 id="h:d3c54205-538e-451f-bc4e-476cd9e605d7">smart-mode-line 插件</h3>
<div class="outline-text-3" id="text-h:d3c54205-538e-451f-bc4e-476cd9e605d7">
<ul class="org-ul">
<li>smart-mode-line <a href="https://github.com/Malabarba/smart-mode-line">https://github.com/Malabarba/smart-mode-line</a></li>
</ul>

<p>
让 mode line 更加漂亮、方便管理的插件，可以自动做一些模式的隐藏等等，也可以选择多种主题。具体读者可以自行探索。这里给个基础配置：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> smart-mode-line
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span> (sml/setup))
</pre>
</div>


<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> smart-mode-line
    <span style="color: #483d8b;">:ensure</span> t
    <span style="color: #483d8b;">:init</span>
    (<span style="color: #a020f0;">setq</span> sml/no-confirm-load-theme t)
    (<span style="color: #a020f0;">setq</span> sml/theme 'respectful)
    (sml/setup))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:c5137ddb-e01a-4070-9618-c13421e81307" class="outline-3">
<h3 id="h:c5137ddb-e01a-4070-9618-c13421e81307">good-scroll</h3>
<div class="outline-text-3" id="text-h:c5137ddb-e01a-4070-9618-c13421e81307">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>good-scroll <a href="https://github.com/io12/good-scroll.el">https://github.com/io12/good-scroll.el</a></li>
</ul>

<p>
在现代图形界面操作系统中，光标在上下移动、翻页的时候 Emacs 会直接刷新界面，滚动时也是按行滚动，比较粗糙。good-scroll 提供了平滑滚动，并且支持变速滚动，更加顺手。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> good-scroll
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span> (good-scroll-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a9a7cbd5-dc3b-43b3-b7d2-afc22f618e8d" class="outline-3">
<h3 id="h:a9a7cbd5-dc3b-43b3-b7d2-afc22f618e8d">restart-emacs 重启emacs插件</h3>
<div class="outline-text-3" id="text-h:a9a7cbd5-dc3b-43b3-b7d2-afc22f618e8d">
<p>
use-package
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> restart-emacs
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:commands</span> (restart-emacs))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">emacs --debug-init</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a3ab1bf4-9a2d-4605-9584-a2274ad6d907" class="outline-3">
<h3 id="h:a3ab1bf4-9a2d-4605-9584-a2274ad6d907">benchmark-ini 测试启动耗时插件</h3>
<div class="outline-text-3" id="text-h:a3ab1bf4-9a2d-4605-9584-a2274ad6d907">
<p>
通过 `benchmark-init` 包进行启动耗时的测量。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21551;&#21160;&#32791;&#26102;&#30340;&#27979;&#37327;</span>
(<span style="color: #a020f0;">use-package</span> benchmark-init
  <span style="color: #483d8b;">:init</span> (benchmark-init/activate)
  <span style="color: #483d8b;">:hook</span> (after-init . benchmark-init/deactivate))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">M-x benchmark-init/show-durations-tree` &#25110;&#32773; `M-x benchmark-init/show-durations-tabulated
</pre>
</div>
</div>
</div>
<div id="outline-container-h:de02f34b-6721-4d9c-81f9-c4c801ff52aa" class="outline-3">
<h3 id="h:de02f34b-6721-4d9c-81f9-c4c801ff52aa">smartparens 成对插件</h3>
<div class="outline-text-3" id="text-h:de02f34b-6721-4d9c-81f9-c4c801ff52aa">
<p>
smartparens <a href="https://github.com/Fuco1/smartparens">https://github.com/Fuco1/smartparens</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">mypackages</span> '(
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">--- Better Editor ---</span>
         smartparens
         ) <span style="color: #ff0000; font-weight: bold;">"Default packages"</span><span style="color: #ff0000; font-weight: bold;">)</span>
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">smartparens-config</span>)
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(add-hook 'emacs-lisp-mode-hook 'smartparens-mode) &#24403;&#21069;&#29983;&#25928;</span>
(smartparens-global-mode t)
</pre>
</div>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">--- smartparens &#25104;&#23545;&#25554;&#20214; ---</span>
(<span style="color: #a020f0;">use-package</span> smartparens
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span> (smartparens-global-mode t)
  )
</pre>
</div>
</div>
</div>
<div id="outline-container-h:536d5305-bb2a-476c-a985-d27f1c691b6d" class="outline-3">
<h3 id="h:536d5305-bb2a-476c-a985-d27f1c691b6d">crux 优化emacs常用操作</h3>
<div class="outline-text-3" id="text-h:536d5305-bb2a-476c-a985-d27f1c691b6d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> crux
  <span style="color: #483d8b;">:bind</span> ((<span style="color: #8b2252;">"C-a"</span> . crux-move-beginning-of-line) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22238;&#21040;&#34892;&#24320;&#22987;</span>
         (<span style="color: #8b2252;">"C-c ^"</span> . crux-top-join-line)        <span style="color: #b22222;">;; </span>
         (<span style="color: #8b2252;">"C-x ,"</span> . crux-find-user-init-file) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24555;&#36895;&#25171;&#24320;init&#25991;&#20214;</span>
         (<span style="color: #8b2252;">"C-c k"</span> . crux-smart-kill-line)))   <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24555;&#36895;&#21024;&#38500;&#34892;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:3b16b1ae-e41d-4f17-b95d-83b621491747" class="outline-3">
<h3 id="h:3b16b1ae-e41d-4f17-b95d-83b621491747">try包</h3>
<div class="outline-text-3" id="text-h:3b16b1ae-e41d-4f17-b95d-83b621491747">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> try
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<p>
使用`M-x try`输入想尝试的包。如2048game
</p>
</div>
</div>
</section>
<section id="outline-container-h:3dbd641f-14b8-4494-93b5-cbb83ccd3b52" class="outline-2">
<h2 id="h:3dbd641f-14b8-4494-93b5-cbb83ccd3b52">插件-功能增强类类</h2>
<div class="outline-text-2" id="text-h:3dbd641f-14b8-4494-93b5-cbb83ccd3b52">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
功能增强类：大大提升 Emacs 体验与效率
</p>
</div>
<div id="outline-container-h:2eb6452f-1388-4de8-bc61-21df09c8052e" class="outline-3">
<h3 id="h:2eb6452f-1388-4de8-bc61-21df09c8052e">Interface Enhancement</h3>
<div class="outline-text-3" id="text-h:2eb6452f-1388-4de8-bc61-21df09c8052e">
<ul class="org-ul">
<li><a href="https://github.com/emacs-dashboard/emacs-dashboard">Dashboard</a> - A startup dashboard which provides certain information about your recent Emacs activities.</li>
<li><a href="https://github.com/Wilfred/helpful">Helpful</a> - An enchancement of the Emacs built-in help system.</li>
<li>sublimity - smooth-scrolling, minimap inspired by the sublime editor.</li>
<li>workgroups2 - Session manager, saves all your opened buffers, their location and sizes on disk to restore later.</li>
<li>ace-popup-menu - Replace GUI popup menu with something more efficient.</li>
<li>GNU Hyperbole - GNU Hyperbole is an efficient and programmable hypertextual information management system. It is a toolkit and user interface for viewing, retrieving and interlinking all kinds of textual information.</li>
<li>linum-relative - display relative line number in the left margin in emacs.</li>
<li>beacon - Never lose your cursor again.</li>
<li>pulsar - Highlights current line, an minimal alternative to beacon.</li>
<li>yascroll-el - Yet Another Scroll Bar Mode.</li>
</ul>
</div>
<div id="outline-container-h:1a6e4818-0c24-4e4b-a42b-ff8243efc7a7" class="outline-4">
<h4 id="h:1a6e4818-0c24-4e4b-a42b-ff8243efc7a7">dashboard</h4>
<div class="outline-text-4" id="text-h:1a6e4818-0c24-4e4b-a42b-ff8243efc7a7">
<ul class="org-ul">
<li>dashboard <a href="https://github.com/emacs-dashboard/emacs-dashboard">https://github.com/emacs-dashboard/emacs-dashboard</a></li>
</ul>

<p>
dashboard 就是一个新的欢迎界面，可以列出最近打开的项目、最近打开的文件等等。按下 p 或 r 就可以快速 跳转到相应小结里。还可以列出来标记过的书签、org-mode （Emacs 自带的一个强大的笔记系统）日程、自定义控件等。
</p>

<p>
Projects 节中没有内容，原因在于这部分是配合 projectile 插件使用的.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> dashboard
 <span style="color: #483d8b;">:ensure</span> t
 <span style="color: #483d8b;">:config</span>
 (<span style="color: #a020f0;">setq</span> dashboard-banner-logo-title <span style="color: #8b2252;">"Welcome to Emacs!"</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20010;&#24615;&#31614;&#21517;&#65292;&#38543;&#35835;&#32773;&#21916;&#22909;&#35774;&#32622;</span>
 <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq dashboard-projects-backend 'projectile) ;; &#31561;&#23433;&#35013;&#20102; projectile &#25554;&#20214;&#21518;&#20877;&#20351;&#29992;</span>
 (<span style="color: #a020f0;">setq</span> dashboard-startup-banner 'official) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20063;&#21487;&#20197;&#33258;&#23450;&#20041;&#22270;&#29255;</span>
 (add-to-list 'dashboard-items '(agenda) t)
 (<span style="color: #a020f0;">setq</span> dashboard-week-agenda t)
 (<span style="color: #a020f0;">setq</span> dashboard-items '((recents  . 5)    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#22810;&#23569;&#20010;&#26368;&#36817;&#25991;&#20214;</span>
                            (bookmarks . 5)   <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#22810;&#23569;&#20010;&#26368;&#36817;&#20070;&#31614;</span>
                            (projects . 10)   <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#22810;&#23569;&#20010;&#26368;&#36817;&#39033;&#30446;</span>
                            (agenda . 5)
                            (registers . 5))&#65289;
 (dashboard-setup-startup-hook))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:fcbbec36-69e9-4eee-9b81-7fc9f9598820" class="outline-4">
<h4 id="h:fcbbec36-69e9-4eee-9b81-7fc9f9598820">helpful 帮助插件</h4>
<div class="outline-text-4" id="text-h:fcbbec36-69e9-4eee-9b81-7fc9f9598820">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>helpful <a href="https://github.com/Wilfred/helpful">https://github.com/Wilfred/helpful</a></li>
</ul>

<p>
配置
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Note that the built-in `</span><span style="color: #008b8b;">describe-function</span><span style="color: #b22222;">' includes both functions</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">and macros. `</span><span style="color: #008b8b;">helpful-function</span><span style="color: #b22222;">' is functions only, so we provide</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">`</span><span style="color: #008b8b;">helpful-callable</span><span style="color: #b22222;">' as a drop-in replacement.</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-h f"</span>) #'helpful-callable)

(global-set-key (kbd <span style="color: #8b2252;">"C-h v"</span>) #'helpful-variable)
(global-set-key (kbd <span style="color: #8b2252;">"C-h k"</span>) #'helpful-key)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:905e6512-c21e-4fa5-b5b6-96a3b9e44c42" class="outline-3">
<h3 id="h:905e6512-c21e-4fa5-b5b6-96a3b9e44c42">Book marks</h3>
<div class="outline-text-3" id="text-h:905e6512-c21e-4fa5-b5b6-96a3b9e44c42">
<p>
这是 Emacs 自带的功能。 这在阅读代码的时候可是个十分方便的功能。
</p>
</div>
</div>
<div id="outline-container-h:38dd2955-f6d1-4a11-b916-cc13fe07c41a" class="outline-3">
<h3 id="h:38dd2955-f6d1-4a11-b916-cc13fe07c41a">ivy view</h3>
<div class="outline-text-3" id="text-h:38dd2955-f6d1-4a11-b916-cc13fe07c41a">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
这是 ivy 插件的额外功能——ivy view。
它与 Book mark 的区别是直接将当前 Frame 中的 Window 的状态都进行保存，然后状态间切换。例如我们打开了多个窗口做一件事，但是中途需要看一些其它文件，那么想要回到刚刚的窗口摆放方式就是 ivy view 出场的地方了。与 Book marks 类似，涉及三个命令：
</p>
<ul class="org-ul">
<li>ivy-push-view：保存当前的窗口状态。配置中绑定为快捷键 `C-c v`。</li>
<li>ivy-switch-view：切换窗口状态。配置中绑定为快捷键 `C-c s`。</li>
<li>ivy-pop-view ：删除保存了的窗口状态。配置中绑定为快捷键 `C-c V`。</li>
</ul>
</div>
</div>
<div id="outline-container-h:4da09563-5753-4a78-8dd8-f3183df84dad" class="outline-3">
<h3 id="h:4da09563-5753-4a78-8dd8-f3183df84dad">which-key 组合键显示插件</h3>
<div class="outline-text-3" id="text-h:4da09563-5753-4a78-8dd8-f3183df84dad">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>which-key 显示全部组合键的选项  <a href="https://github.com/justbur/emacs-which-key">https://github.com/justbur/emacs-which-key</a></li>
</ul>

<p>
这是一个实用小工具，专门针对 Emacs 快捷键多而杂的问题，安装后，当按下部分快捷键前缀时，它会通过 minibuffer 提示你都有哪些可以按的快捷键及其命令名。例如启动了 `hs-minor-mode` 后，我们正常可以通过 `C-c @ C-h` 折叠代码块、用 `C-c @ C-s` 来展开代码块。但这个快捷键很长，时常记不住，那么有了 which-key 后我们可以先按下 `C-c @` ，此时 which-key 就会提示我们接下来可以按的键：
</p>

<p>
对于选项过多的前缀，例如 C-x ，which-key 会显示出非常多的选项，那么就需要翻页，根据它的提示，我们只需要按下 `C-h`，然后按 `n` 或 `p` 进行向下翻页和向上翻页。
</p>

<p>
在下载后可以使用下面的代码进行激活，
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">mypackages</span> '(
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">--- which-key ---</span>
         which-key
         ) <span style="color: #ff0000; font-weight: bold;">"Default packages"</span><span style="color: #ff0000; font-weight: bold;">)</span>
(which-key-mode 1)
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq which-key-side-window-location 'right)</span>
</pre>
</div>

<p>
使用：如按`C-x`会显示所有相关的组合键
</p>

<p>
组合键显示在右侧窗口可通过`M-x customize-group  which-key`找到`Which Key Side Window Location`设置为right
</p>

<p>
use-package
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#20840;&#37096;&#32452;&#21512;&#38190;</span>
(<span style="color: #a020f0;">use-package</span> which-key
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:defer</span> nil
  <span style="color: #483d8b;">:config</span> (which-key-mode))
</pre>
</div>

<p>
想要更好解决快捷键繁杂的问题，可以进一步参考插件 hydra。
</p>
</div>
</div>
<div id="outline-container-h:3253d03e-0457-40a7-8663-3f4cb81c5121" class="outline-3">
<h3 id="h:3253d03e-0457-40a7-8663-3f4cb81c5121">avy 快速搜索定位插件</h3>
<div class="outline-text-3" id="text-h:3253d03e-0457-40a7-8663-3f4cb81c5121">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>avy: <a href="https://github.com/abo-abo/avy">https://github.com/abo-abo/avy</a></li>
<li>博客 <a href="https://karthinks.com/software/avy-can-do-anything/">https://karthinks.com/software/avy-can-do-anything/</a></li>
</ul>

<p>
可以快速定位
</p>

<p>
avy 又是一个 abo-abo（Oleh Krehel）开发的强大插件。其最最基本的功能就是无需鼠标的快速光标跳转，但其能力远不止于此，接下来将会花一些篇幅介绍。博客中，有详细地介绍 avy 的更多用法，以下是 avy 主要内容的介绍。
</p>
</div>
<div id="outline-container-h:9fa8caaf-17f4-47a9-a646-cf7a8fbfe5ab" class="outline-4">
<h4 id="h:9fa8caaf-17f4-47a9-a646-cf7a8fbfe5ab">操作逻辑抽象</h4>
<div class="outline-text-4" id="text-h:9fa8caaf-17f4-47a9-a646-cf7a8fbfe5ab">
<p>
在博客中提到了 avy 操作逻辑的抽象概念，也是很多 Emacs 命令的操作抽象：Filter、Select、Act，翻译过来就是“筛选”、“选择”、“行动”。举个例子，我们按 `C-x C-f` 打开文件，此时列出了当前目录下的所有文件名，按下文件名的前缀，待选文件的范围就会缩小，这就叫“筛选”；我们在其中最终选择了一个文件，这叫“选择”；最后按下回车，此时 Emacs 就会打开并切换到那个文件，这就叫”行动“。很多操作都可以归为这种模式。
</p>
</div>
</div>
<div id="outline-container-h:fd238ab7-03d6-49d9-a741-562415730f73" class="outline-4">
<h4 id="h:fd238ab7-03d6-49d9-a741-562415730f73">基本用法</h4>
<div class="outline-text-4" id="text-h:fd238ab7-03d6-49d9-a741-562415730f73">
<p>
那么你的第一反应可能是，这不就是很正常的一个命令的用法吗，为什么说的这么抽象？ avy 就是在这个模式上做出了文章，其核心思想就是将三者进行解耦合，让这个模式支持更多的应用场景。我们来看看具体的用法。配置如下：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> avy
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind</span> (<span style="color: #8b2252;">"M-s"</span> . avy-goto-char))
</pre>
</div>

<p>
使用时`M-s 字母` ，第次输入位置单词，就会立即到指定位置。
</p>

<p>
示例：搜索s字符`M-s s`，光标到avy那一行，按s
</p>

<p>
<img src="./images/image-20210629185544828.png" alt="image-20210629185544828.png">]]
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> avy
  <span style="color: #483d8b;">:defer</span> 0
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind</span> ((<span style="color: #8b2252;">"M-g :"</span> . 'avy-goto-char)
         (<span style="color: #8b2252;">"M-g '"</span> . 'avy-goto-char-2)
         (<span style="color: #8b2252;">"M-g \""</span> . 'avy-goto-char-timer)
         (<span style="color: #8b2252;">"M-g f"</span> . 'avy-goto-line)
         (<span style="color: #8b2252;">"M-g w"</span> . 'avy-goto-word-1)
         (<span style="color: #8b2252;">"M-g e"</span> . 'avy-goto-word-0)))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:aa0697d6-88ea-4ab8-8f9e-2c0138670768" class="outline-4">
<h4 id="h:aa0697d6-88ea-4ab8-8f9e-2c0138670768">进阶用法</h4>
<div class="outline-text-4" id="text-h:aa0697d6-88ea-4ab8-8f9e-2c0138670768">
<p>
别忘了，跳转只是它最最基本的功能。事实上，当我们“筛选”后、”选择“前，可以更改 avy 的“行动”，有哪些行动呢？读者可以在输入了“部分文本”后，按下 `?` 键，就会显示出 avy 当前支持的“行动”。
</p>

<p>
例如下图所示，我们写着写着希望换一种写法，对代码进行重构，把上面的三个 `print` 语句合并在一个函数中，那么一行行分别去选中、复制、回来、粘贴肯定是很麻烦的。于是，我们按下 `M-s C-SPC`，输入 `p` ( print 的开头字母），此时按下 `?`，下面的 Minibuffer 就会显示出可以选择的其它行动，我们希望使用 `Y: yank-line`，于是输入 `Y`（注意大小写），然后按下我们目标 `print` 语句的标签，例如 `a`，这时，`a` 对应的语句就完全被复制到了当前光标所在的位置。我们的光标没有丝毫的移动，就成功将一行代码复制了过来。
</p>

<p>
它命令的效果，例如 `kill-stay` 可以“隔空剪切文本”、`teleport` 可以“把远处的文本传送到当前位置“等等。注意我们中途按下的 `?` 只是对大家的提示 ，如果熟练记住了几个常用的“行动”，就可以直接省略按 `?` 了 。
</p>

<p>
如果不喜欢这种输多个字符然后等待 avy 生效这样的方式，也可以把快捷键调用的命令改为例如 `avy-goto-word-1`，这时就可以通过输某个词的首字母就可以直接触发 avy 的筛选。
</p>
</div>
</div>
</div>
<div id="outline-container-h:14bdd66b-812e-4b8b-88fa-b25504510336" class="outline-3">
<h3 id="h:14bdd66b-812e-4b8b-88fa-b25504510336">minibuffer 补全</h3>
<div class="outline-text-3" id="text-h:14bdd66b-812e-4b8b-88fa-b25504510336">
<p>
Emacs有很多很好用的补全体系，如 ivy 体系，vertico 体系等等，这里我们推荐新手朋友使用的是 vertico 。
</p>

<p>
vertico 体系包含以下几个插件
</p>
<ul class="org-ul">
<li>vertico</li>
<li>consult</li>
<li>embark</li>
<li>maginalia</li>
</ul>

<p>
它们都比较轻量级，可替代 ivy helm ido 重量级补全
</p>
</div>
<div id="outline-container-h:eaada5ce-bec0-4338-8762-878f98851ad8" class="outline-4">
<h4 id="h:eaada5ce-bec0-4338-8762-878f98851ad8"><a href="https://github.com/minad/vertico">vertico</a>和 <a href="https://github.com/oantolin/orderless">Orderless</a> 增强 minibuffer 补全</h4>
<div class="outline-text-4" id="text-h:eaada5ce-bec0-4338-8762-878f98851ad8">
<ul class="org-ul">
<li>vertico <a href="https://github.com/minad/vertico">https://github.com/minad/vertico</a>   交互垂直</li>
<li>orderless <a href="https://github.com/oantolin/orderless">https://github.com/oantolin/orderless</a> 模糊搜索</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> vertico
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span> (vertico-mode))

(<span style="color: #a020f0;">use-package</span> orderless
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> vertico
  <span style="color: #483d8b;">:init</span> (<span style="color: #a020f0;">setq</span> completion-styles '(orderless)))
</pre>
</div>

<p>
有了 vertico-mode，把之前的 icomplete-mode 关掉。 补全变为垂直，垂直对于我们是更友好的，所有 minibuffer 的行为的可以补全。如使用 <code>M-x</code> 补全变为垂直,  <code>C-x C-f</code> 增强显示目录下文件、 <code>C-x b</code> 变为垂直。
</p>

<p>
orderless 支持 <code>M-x</code> 模糊搜索，可以无序的。 如 edebug-defun 函数搜索， <code>M-x fun debug</code>
</p>
</div>
</div>
<div id="outline-container-h:1a8eb4fa-c83f-4570-a064-ffac59b5e94b" class="outline-4">
<h4 id="h:1a8eb4fa-c83f-4570-a064-ffac59b5e94b">marginalia 增强 minubuffer 的 annotation</h4>
<div class="outline-text-4" id="text-h:1a8eb4fa-c83f-4570-a064-ffac59b5e94b">
<ul class="org-ul">
<li>marginalia <a href="https://github.com/minad/marginalia">https://github.com/minad/marginalia</a> 注解</li>
</ul>

<p>
一个为 Emacs minibuffer 中的选项添加注解的插件。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> marginalia
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span> (marginalia-mode)
  <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> minibuffer-local-map
        (<span style="color: #8b2252;">"M-A"</span> . marginalia-cycle)))
</pre>
</div>

<p>
<code>M-x</code> 可以看到它会把命令的注释直接显示在minibuffer中
</p>

<p>
<code>C-h v</code> 查看一个变量的内容，可以发现不用再按回车看到里面的值。直接显示在minibuffer中
</p>

<p>
<code>C-h f</code> 键位绑定都已经在minibuffer中显示出来了
</p>

<p>
<code>C-x C-f</code> 显示文件大小权限等， <code>C-x b</code> 显 buffer 大小状态， <code>C-h f</code> 显示函数快捷键等
</p>
</div>
</div>
<div id="outline-container-h:245be342-c6ad-4688-9840-79699f85a3af" class="outline-4">
<h4 id="h:245be342-c6ad-4688-9840-79699f85a3af">embark 增强 minibuffer action 和自适应的 context menu</h4>
<div class="outline-text-4" id="text-h:245be342-c6ad-4688-9840-79699f85a3af">
<ul class="org-ul">
<li>embark <a href="https://github.com/oantolin/embark">https://github.com/oantolin/embark</a></li>
<li>embark 相关博客 <a href="https://karthinks.com/software/fifteen-ways-to-use-embark/">https://karthinks.com/software/fifteen-ways-to-use-embark/</a></li>
</ul>

<p>
minibuffer action 和自适应的 context menu
</p>

<p>
embark 是另一个比较神奇的工具。Emacs 基本的操作流程是先输入命令再输入命令作用的对象。例如，我们先按下 `C-x C-f` 再输入文件名来打开文件。但是有的时候，我们按下命令、选择了文件后，可能又后悔了，想要对相同的文件输入另一个命令。例如我们按下 `C-x k` 打算关闭一个后台 buffer，然后输入了文件名，这时我们忽然想再查看一眼那个文件。那么平常，我们只好按下 `C-g` 放弃这次命令，再用 `C-x b` 切换过去。而有了 embark ，我们可以在按下 `C-x k` 、输入了部分文件名选中文件后 ，按下 `C-;` 触发 embark-act，这时按下 `o` 就可以在另一个新的窗口打开这个 buffer 了。我们无需放弃命令重新输入，而是继续输入就好了。
</p>

<p>
直接使用官网提供的配置就好 (官方强烈建议 embark, marginalia, consult 一同使用来改善 minibuffer。 可以代替 ivy。)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(package-install 'embark)
(global-set-key (kbd <span style="color: #8b2252;">"C-;"</span>) 'embark-act)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22914; C-x C-h&#65292;&#36890;&#36807; orderless &#30340;&#27169;&#31946;&#26041;&#24335;&#30452;&#25509;&#35843;&#29992;&#21629;&#20196;</span>
(<span style="color: #a020f0;">setq</span> prefix-help-command 'embark-prefix-help-command)
</pre>
</div>

<p>
use-package
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> embark
  <span style="color: #483d8b;">:defer</span> t
  <span style="color: #483d8b;">:init</span>
  (<span style="color: #a020f0;">setq</span> which-key-use-C-h-commands nil
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">press C-h after a prefix key, it shows all the possible key bindings and let you choose what you want</span>
        prefix-help-command #'embark-prefix-help-command)

  (define-key minibuffer-local-map (kbd <span style="color: #8b2252;">"C-;"</span>) 'embark-act)
  (define-key minibuffer-local-map (kbd <span style="color: #8b2252;">"C-c C-;"</span>) 'embark-export)
  <span style="color: #b22222;">;;</span><span style="color: #b22222;">(define-key minibuffer-local-map (kbd "C-c C-e") '+vertico/embark-export-write)</span>

  (global-set-key (kbd <span style="color: #8b2252;">"C-;"</span>) 'embark-act)

  <span style="color: #483d8b;">:config</span>
  (define-key minibuffer-local-map (kbd <span style="color: #8b2252;">"C-'"</span>) #'embark-become)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">list all the keybindings in this buffer</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-h B"</span>) 'embark-bindings)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">add the package! target finder before the file target finder,</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">so we don't get a false positive match.</span>
  <span style="color: #483d8b;">:config</span>
  (define-key embark-identifier-map <span style="color: #8b2252;">"R"</span> #'consult-ripgrep)
  <span style="color: #b22222;">;;</span><span style="color: #b22222;">(define-key embark-file-map (kbd "E") #'consult-directory-externally)</span>
  )
</pre>
</div>



<p>
使用
</p>

<p>
光标在函数位置，按 <code>C-;</code> 
</p>
<ul class="org-ul">
<li>RET 查看光标处函数定义文件位置，并打开</li>
<li>c 修改变量的值
<ul class="org-ul">
<li>如 C-h v 变量名，按 C-; c 修改变量的值</li>
</ul></li>
</ul>

<p>
优点：不需要记快捷键了
</p>
<ul class="org-ul">
<li>以前查看函数的绑定键
<ul class="org-ul">
<li><code>C-h b</code> 查看函数快捷键绑定：</li>
<li>以前按 <code>C-x C-h</code> 时，会告诉你 <code>C-x</code> 绑定了哪些快捷键</li>
</ul></li>
<li>设置了 <code>(setq prefix-help-command #'embark-prefix-help-command)</code> 后
<ul class="org-ul">
<li>按 <code>C-x C-h</code> 模糊输入函数名可看到绑定的快捷键，按回车可直接执行命令，就不需要再记快捷键了。</li>
</ul></li>
</ul>

<p>
如果想要让 avy 也支持 embark，需要在 avy 的配置中添加 :config：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> avy
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">avy-action-embark</span> (pt)
          (<span style="color: #a020f0;">unwind-protect</span>
                  (<span style="color: #a020f0;">save-excursion</span>
            (goto-char pt)
            (embark-act))
        (select-window
         (cdr (ring-ref avy-ring 0))))
          t)
  (<span style="color: #a020f0;">setf</span> (alist-get ?e avy-dispatch-alist) 'avy-action-embark)
  <span style="color: #483d8b;">:bind</span>
  ((<span style="color: #8b2252;">"C-j C-SPC"</span> . avy-goto-char-timer)))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:82e69d3a-6bf5-46bf-8921-f9636908ce1a" class="outline-4">
<h4 id="h:82e69d3a-6bf5-46bf-8921-f9636908ce1a"><a href="https://github.com/minad/consult">Consult</a> 增强文件内搜索和跳转函数定义</h4>
<div class="outline-text-4" id="text-h:82e69d3a-6bf5-46bf-8921-f9636908ce1a">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(package-install 'consult)
<span style="color: #b22222;">;;</span><span style="color: #b22222;">replace swiper &#21487;&#20197;&#26367;&#20195;&#32769;&#30340; ivy mode &#30340; swiper &#21151;&#33021;</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-s"</span>) 'consult-line)
(global-set-key (kbd <span style="color: #8b2252;">"M-s i"</span>) 'consult-imenu)  <span style="color: #b22222;">;</span><span style="color: #b22222;">&#36339;&#36716;&#20989;&#25968;&#23450;&#20041;</span>
</pre>
</div>

<p>
使用 <code>C-s</code> 搜索的内容就会在minibuffer中垂直显示，使用C-p 或 C-n来上下选择
</p>

<p>
使用 <code>M-s i</code> 跳转函数定义或者org-mode标题
</p>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> consult
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind</span> (
         (<span style="color: #8b2252;">"C-s"</span> . consult-line) <span style="color: #b22222;">;; </span><span style="color: #b22222;">replace swipe</span>
         ([remap switch-to-buffer] . consult-buffer) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22810;&#26174;&#31034;&#26368;&#36817;&#25171;&#24320;&#25991;&#20214;&#12290;&#26367;&#25442;&#40664;&#35748; C-x b buffer</span>
         (<span style="color: #8b2252;">"C-c p s"</span> . consult-ripgrep) <span style="color: #b22222;">;;  </span><span style="color: #b22222;">&#26597;&#25214;&#25991;&#20214;&#20869;&#23481;&#65292;&#38656;&#35201;&#23433;&#35013; ripgrep &#21629;&#20196;</span>
         )
  )
</pre>
</div>

<p>
<code>consult-imenu</code>  查看当前文件定义的函数并跳转到函数定义
<code>consult-buffer</code> 显示最近打开的文件
<code>consult-ripgrep</code> 查找文件内容。需要提前安装 ripgrep 命令。grep &lt; ack &lt; ag &lt; <a href="https://github.com/BurntSushi/ripgrep">ripgrep</a> (rg)
</p>

<p>
配置划分成不同文件，好以下方式方便查找
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(eval-after-load 'consult (global-set-key (kbd <span style="color: #8b2252;">"C-c p s"</span>) 'consult-ripgrep))  <span style="color: #b22222;">;;  </span><span style="color: #b22222;">&#26597;&#25214;&#25991;&#20214;&#20869;&#23481;</span>
</pre>
</div>

<p>
使用 `consult-ripgrep`  默认会在以 git  为根目录搜索。`C-n C-p` 下上搜索同时可以预览。
</p>
</div>
</div>
</div>
<div id="outline-container-h:b8ba25d0-235f-4ddf-9f89-124feeb4f08d" class="outline-3">
<h3 id="h:b8ba25d0-235f-4ddf-9f89-124feeb4f08d">hydra 自定义按键组合菜单插件</h3>
<div class="outline-text-3" id="text-h:b8ba25d0-235f-4ddf-9f89-124feeb4f08d">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>hydra <a href="https://github.com/abo-abo/hydra">https://github.com/abo-abo/hydra</a></li>
</ul>

<p>
hydra 进一步解决了 Emacs 的复杂的命令如何组织的问题，这又是一个 abo-abo（Oleh Krehel）编写的插件。which-key 虽然对快捷键起到了提示作用，但是对于 Emacs 数量这么庞大的命令来说还是有很多不足。
</p>

<p>
hydra 主要功能是把一组特定场景的命令组织到一起， 通过简单按键来进行调用。这个思路和 Vim 的各种 mode 是类似的。
</p>

<p>
首先安装好 hydra ，而由于我们希望在 use-package 里进行配置，再安装一个 use-package-hydra 小插件可以让我们的 use-package 多一个 :hydra 关键字，可以更方便地配置。 这段配置应当写在靠前一点的位置比较保险。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> hydra
  <span style="color: #483d8b;">:ensure</span> t)

(<span style="color: #a020f0;">use-package</span> use-package-hydra
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> hydra) 
</pre>
</div>


<p>
范例：f2后，g键放大文本，l键缩小文本
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23450;&#20041;hydra &#21517;&#23383;&#21487;&#20197;&#33258;&#34892;&#23450;&#20041;&#22914;hydra-zoom</span>
(defhydra hydra-zoom (global-map <span style="color: #8b2252;">"&lt;f2&gt;"</span>)
  <span style="color: #8b2252;">"zoom"</span>
  (<span style="color: #8b2252;">"g"</span> text-scale-increase <span style="color: #8b2252;">"in"</span>)
  (<span style="color: #8b2252;">"l"</span> text-scale-decrease <span style="color: #8b2252;">"out"</span>))
</pre>
</div>

<p>
使用这个简单的代码，您可以： 
</p>
<ul class="org-ul">
<li>使用 开始放大：&lt;f2&gt; g</li>
<li>继续放大：g</li>
<li>或者缩小：l</li>
<li>一次放大五倍：5g</li>
<li>停止缩放：使用不是 g 或 l 的任何键</li>
</ul>

<p>
起初对 undo-tree 的配置非常简单：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> undo-tree
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span> (global-undo-tree-mode))
</pre>
</div>

<p>
而想要和 hydra 结合可以变为：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> undo-tree
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span> (global-undo-tree-mode)
  <span style="color: #483d8b;">:after</span> hydra
  <span style="color: #483d8b;">:bind</span> (<span style="color: #8b2252;">"C-x C-h u"</span> . hydra-undo-tree/body)
  <span style="color: #483d8b;">:hydra</span> (hydra-undo-tree (<span style="color: #483d8b;">:hint</span> nil)
  <span style="color: #8b2252;">"</span>
<span style="color: #8b2252;">  _p_: undo  _n_: redo _s_: save _l_: load   "</span>
  (<span style="color: #8b2252;">"p"</span>   undo-tree-undo)
  (<span style="color: #8b2252;">"n"</span>   undo-tree-redo)
  (<span style="color: #8b2252;">"s"</span>   undo-tree-save-history)
  (<span style="color: #8b2252;">"l"</span>   undo-tree-load-history)
  (<span style="color: #8b2252;">"u"</span>   undo-tree-visualize <span style="color: #8b2252;">"visualize"</span> <span style="color: #483d8b;">:color</span> blue)
  (<span style="color: #8b2252;">"q"</span>   nil <span style="color: #8b2252;">"quit"</span> <span style="color: #483d8b;">:color</span> blue)))
</pre>
</div>

<p>
看起来很长，其实就是定义了一个小表格，可以让我们先按下 <code>C-x C-h u</code> 来调用 <code>hydra-undo-tree/body</code> 这个命令，它会在 minibuffer 中显示出我们配置中的字符串.
</p>

<p>
此时，我们就可以通过选择 p、n、s、l 和 u 来分别触发五个 undo-tree 的命令了。 所以可以总结为，hydra 可以任意将一些命令组织在一起，方便在某个场合下调用。
</p>

<p>
具体来说，我们通过 :hydra 标签可以声明这样一组命令，起了个名字，在上面的例子中就是 hydra-undo-tree，被称为 hydra-awesome，习惯以 hydra- 开头。想要调出这一组，需要输入的是就是加上 /body，上例中也就是 hydra-undo-tree/body，当然你可以选择直接调其中的某个命令例如 hydra-undo-tree/undo-tree-undo。
</p>

<p>
一个值得注意的小细节是每个提示词的颜色，有的为红色，有的为蓝色。事实上颜色是有相对应的设置的，红色的表示按过了之后依然可以继续按，不会退出 hydra ；蓝色表示按了一次就会退出 hydra。例如上例中，我们可能需要多次 undo 和 redo，所以 p 和 n 都是红色的。而 u 可以展示出 undo-tree，而展示出来之后我们就不再需要 hydra 了，所以我们把 u 配置成了蓝色。所有颜色如下：
</p>
<div class="org-src-container">
<pre class="src src-shell">| color    | toggle                     |
|----------+----------------------------|
| red      |                            |
| blue     | :exit t                    |
| amaranth | :foreign-keys warn         |
| teal     | :foreign-keys warn :exit t |
| pink     | :foreign-keys run          |
</pre>
</div>

<p>
不想用颜色的话也可以直接用 <code>:exit t</code> 表示按完后就退出。此外还有很多细节可以调整，例如超时退出，具体参考 hydra 的<a href="https://github.com/abo-abo/hydra/wiki/">主页 Wiki</a> 吧。
</p>
</div>
<div id="outline-container-h:32112a65-bdd4-46b5-af7f-b7a70e01cda9" class="outline-4">
<h4 id="h:32112a65-bdd4-46b5-af7f-b7a70e01cda9">Window</h4>
<div class="outline-text-4" id="text-h:32112a65-bdd4-46b5-af7f-b7a70e01cda9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key
 (kbd <span style="color: #8b2252;">"&lt;f2&gt;"</span>)
 (defhydra f2-fun (<span style="color: #483d8b;">:color</span> pink <span style="color: #483d8b;">:hint</span> nil)
   <span style="color: #8b2252;">"</span>
<span style="color: #8b2252;">Window</span>
<span style="color: #8b2252;">^ Resize ^         ^ Move ^       ^Split^      ^Delete</span>
<span style="color: #8b2252;">^^^^^^^^-----------------------------------------------------------------</span>
<span style="color: #8b2252;">_e_: enlarge         ^_i_^          _v_:|      _dw_:del-current</span>
<span style="color: #8b2252;">_s_: shrink       _j_     _l_       _x_:-      _da_:ace-del</span>
<span style="color: #8b2252;">_E_: enlarge-&lt;&gt;      ^_k_^          _|_:&gt;move  _do_:del-other</span>
<span style="color: #8b2252;">_S_: shrink-&lt;&gt;     _ws_:swap      ___:Vmove ^ ^_db_:kill-buf</span>
<span style="color: #8b2252;">_bw_: balance      ^&lt;Jump&gt;^         ^^^^       _df_:del-frame </span>
<span style="color: #8b2252;">^ ^                _a_:ace _f_:to-frame</span>
<span style="color: #8b2252;">"</span>

   (<span style="color: #8b2252;">"e"</span> #'enlarge-window)
   (<span style="color: #8b2252;">"s"</span> #'shrink-window)
   (<span style="color: #8b2252;">"E"</span> #'enlarge-window-horizontally)
   (<span style="color: #8b2252;">"S"</span> #'shrink-window-horizontally)
   (<span style="color: #8b2252;">"bw"</span> #'balance-windows)
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">Move</span>
   (<span style="color: #8b2252;">"j"</span> #'windmove-left)
   (<span style="color: #8b2252;">"i"</span> #'windmove-up)
   (<span style="color: #8b2252;">"l"</span> #'windmove-right)
   (<span style="color: #8b2252;">"k"</span> #'windmove-down)
   (<span style="color: #8b2252;">"ws"</span> ace-swap-window)
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">Jump</span>
   (<span style="color: #8b2252;">"a"</span> ace-window <span style="color: #483d8b;">:exit</span> t)
   (<span style="color: #8b2252;">"f"</span> #'select-frame-by-name <span style="color: #483d8b;">:exit</span> t)
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">Spilt</span>
   (<span style="color: #8b2252;">"|"</span> (<span style="color: #a020f0;">lambda</span> ()
          (<span style="color: #a020f0;">interactive</span>)
          (split-window-right)
          (windmove-right)))
   (<span style="color: #8b2252;">"_"</span> (<span style="color: #a020f0;">lambda</span> ()
          (<span style="color: #a020f0;">interactive</span>)
          (split-window-below)
          (windmove-down)))
   (<span style="color: #8b2252;">"v"</span> #'split-window-right)
   (<span style="color: #8b2252;">"x"</span> #'split-window-below)
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">Delete</span>
   (<span style="color: #8b2252;">"da"</span> ace-delete-window)
   (<span style="color: #8b2252;">"dw"</span> delete-window)
   (<span style="color: #8b2252;">"do"</span> delete-other-windows <span style="color: #483d8b;">:exit</span> t)
   (<span style="color: #8b2252;">"db"</span> kill-this-buffer)
   (<span style="color: #8b2252;">"df"</span> delete-frame <span style="color: #483d8b;">:exit</span> t)
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">Misc</span>
   (<span style="color: #8b2252;">"t"</span> transpose-frame <span style="color: #8b2252;">"-&lt;-&gt;|"</span>)
   (<span style="color: #8b2252;">"nf"</span> new-frame <span style="color: #8b2252;">"New-frame"</span> <span style="color: #483d8b;">:exit</span> t)
   (<span style="color: #8b2252;">"z"</span> #'text-scale-adjust <span style="color: #8b2252;">"Zoom"</span> <span style="color: #483d8b;">:exit</span> t)
   <span style="color: #b22222;">;;</span>
   (<span style="color: #8b2252;">"q"</span> nil <span style="color: #8b2252;">"Quit"</span> <span style="color: #483d8b;">:color</span> blue)))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:10b13b6f-5edb-41ba-9372-7b3b003ad56f" class="outline-4">
<h4 id="h:10b13b6f-5edb-41ba-9372-7b3b003ad56f">MC 多游标</h4>
<div class="outline-text-4" id="text-h:10b13b6f-5edb-41ba-9372-7b3b003ad56f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key
 (kbd <span style="color: #8b2252;">"C-S-c"</span>)
 (defhydra hydra-mc  (<span style="color: #483d8b;">:columns</span> 5)
   <span style="color: #8b2252;">"multiple-cursors"</span>
   (<span style="color: #8b2252;">"ll"</span> mc/edit-lines <span style="color: #8b2252;">"lines"</span>)
   (<span style="color: #8b2252;">"le"</span> mc/edit-ends-of-lines <span style="color: #8b2252;">"end-lines"</span>)

   (<span style="color: #8b2252;">"j"</span> mc/mark-next-like-this <span style="color: #8b2252;">"next"</span>)
   (<span style="color: #8b2252;">"uj"</span> mc/unmark-next-like-this <span style="color: #8b2252;">"un-n"</span>)
   (<span style="color: #8b2252;">"J"</span> mc/skip-to-next-like-this <span style="color: #8b2252;">"skip-n"</span>)
   (<span style="color: #8b2252;">"s"</span> #'mc/mark-next-like-this-symbol <span style="color: #8b2252;">"symbols-n"</span>)

   (<span style="color: #8b2252;">"k"</span> mc/mark-previous-like-this <span style="color: #8b2252;">"prev"</span>)
   (<span style="color: #8b2252;">"uk"</span> mc/unmark-previous-like-this <span style="color: #8b2252;">"un-p"</span>)
   (<span style="color: #8b2252;">"K"</span> mc/skip-to-previous-like-this <span style="color: #8b2252;">"skip-p"</span>)

   (<span style="color: #8b2252;">"aa"</span> mc/mark-all-like-this <span style="color: #8b2252;">"all"</span>)
   (<span style="color: #8b2252;">"A"</span> mc/mark-all-dwim <span style="color: #8b2252;">"dwim"</span>)
   (<span style="color: #8b2252;">"aw"</span> #'mc/mark-all-words-like-this <span style="color: #8b2252;">"word"</span>)
   (<span style="color: #8b2252;">"as"</span> mc/mark-all-symbols-like-this-in-defun <span style="color: #8b2252;">"symbols-in-def"</span>)

   (<span style="color: #8b2252;">"r"</span> #'mc/mark-all-in-region-regexp <span style="color: #8b2252;">"region-regexp"</span>)
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">Quit</span>
   (<span style="color: #8b2252;">"q"</span> nil <span style="color: #8b2252;">"Quit"</span> <span style="color: #483d8b;">:color</span> blue)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">("i" mc/insert-numbers)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">( "h" mc-hide-unmatched-lines-mode)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">( "dr" mc/reverse-regions)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">( "ds" mc/sort-regions)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:e77a9821-94d8-4afe-a1ad-7f2382bd53c9" class="outline-3">
<h3 id="h:e77a9821-94d8-4afe-a1ad-7f2382bd53c9">multiple-cursors多光标插件</h3>
<div class="outline-text-3" id="text-h:e77a9821-94d8-4afe-a1ad-7f2382bd53c9">
<ul class="org-ul">
<li>multiple-cursors <a href="https://github.com/magnars/multiple-cursors.el">https://github.com/magnars/multiple-cursors.el</a></li>
</ul>

<p>
多光标编辑可是编辑器的必备需求。这个插件提供了多种生成多光标的方式。
</p>

<ul class="org-ul">
<li>*连续多行*：我们按下 <code>C-SPC</code> 触发一次 <code>set-mark</code> ，随后让光标向下移动，再输入 <code>M-x mc/edit-lines</code> 就生成连续多行光标。</li>
<li>*编辑多处同一段文本*：选中文本，输入命令 <code>mc/mark-next-like-this</code> 、 <code>mc/mark-previous-like-this</code> 、 <code>mc/mark-all-like-this</code> ，看名字就知道，分别可以标记下一个词、上一个词、所有词。还可以用 <code>mc/skip-to-next-like-this</code> 和 <code>mc/skip-to-previous-like-this</code> 跳过一部分。</li>
<li>*鼠标点击选择*：见配置，将 <code>mc/toggle-cursor-on-click</code> 绑定到某个键位。</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> multiple-cursors
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> mc/always-run-for-all t))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20351;&#29992;&#40736;&#26631;&#24038;&#38190;&#26469;&#36873;&#22810;&#20010;&#20301;&#32622;</span>
(<span style="color: #a020f0;">bind-key</span> <span style="color: #8b2252;">"M-&lt;down-mouse-1&gt;"</span> 'mc/add-cursor-on-click)
(<span style="color: #a020f0;">unbind-key</span> <span style="color: #8b2252;">"M-&lt;down-mouse-1&gt;"</span> redshank-mode-map)
</pre>
</div>

<p>
可以看到这个插件的命令比较杂，一一绑定快捷键难以记忆。这就是又一次要使用 hydra 形成一组快捷键了：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> multiple-cursors
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> hydra
  <span style="color: #483d8b;">:bind</span>
  ((<span style="color: #8b2252;">"C-x C-h m"</span> . hydra-multiple-cursors/body)
   (<span style="color: #8b2252;">"C-S-&lt;mouse-1&gt;"</span> . mc/toggle-cursor-on-click))
  <span style="color: #483d8b;">:hydra</span> (hydra-multiple-cursors
                    (<span style="color: #483d8b;">:hint</span> nil)
                    <span style="color: #8b2252;">"</span>
<span style="color: #8b2252;">Up^^             Down^^           Miscellaneous           % 2(mc/num-cursors) cursor%s(if (&gt; (mc/num-cursors) 1) \"s\" \"\")</span>
<span style="color: #8b2252;">------------------------------------------------------------------</span>
<span style="color: #8b2252;"> [_p_]   Prev     [_n_]   Next     [_l_] Edit lines  [_0_] Insert numbers</span>
<span style="color: #8b2252;"> [_P_]   Skip     [_N_]   Skip     [_a_] Mark all    [_A_] Insert letters</span>
<span style="color: #8b2252;"> [_M-p_] Unmark   [_M-n_] Unmark   [_s_] Search      [_q_] Quit</span>
<span style="color: #8b2252;"> [_|_] Align with input CHAR       [Click] Cursor at point"</span>
                    (<span style="color: #8b2252;">"l"</span> mc/edit-lines <span style="color: #483d8b;">:exit</span> t)
                    (<span style="color: #8b2252;">"a"</span> mc/mark-all-like-this <span style="color: #483d8b;">:exit</span> t)
                    (<span style="color: #8b2252;">"n"</span> mc/mark-next-like-this)
                    (<span style="color: #8b2252;">"N"</span> mc/skip-to-next-like-this)
                    (<span style="color: #8b2252;">"M-n"</span> mc/unmark-next-like-this)
                    (<span style="color: #8b2252;">"p"</span> mc/mark-previous-like-this)
                    (<span style="color: #8b2252;">"P"</span> mc/skip-to-previous-like-this)
                    (<span style="color: #8b2252;">"M-p"</span> mc/unmark-previous-like-this)
                    (<span style="color: #8b2252;">"|"</span> mc/vertical-align)
                    (<span style="color: #8b2252;">"s"</span> mc/mark-all-in-region-regexp <span style="color: #483d8b;">:exit</span> t)
                    (<span style="color: #8b2252;">"0"</span> mc/insert-numbers <span style="color: #483d8b;">:exit</span> t)
                    (<span style="color: #8b2252;">"A"</span> mc/insert-letters <span style="color: #483d8b;">:exit</span> t)
                    (<span style="color: #8b2252;">"&lt;mouse-1&gt;"</span> mc/add-cursor-on-click)
                    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Help with click recognition in this hydra</span>
                    (<span style="color: #8b2252;">"&lt;down-mouse-1&gt;"</span> ignore)
                    (<span style="color: #8b2252;">"&lt;drag-mouse-1&gt;"</span> ignore)
                    (<span style="color: #8b2252;">"q"</span> nil)))
</pre>
</div>
<p>
之后我们便可以使用 <code>C-x C-h m</code> 来列出所有的命令，然后选择即可。第一次用multiple-cursors可能会问你是否要将 <code>xxx</code> 命令应用到所有的光标上，读者根据具体情况判断即可，之后就不会反复提问了。
</p>
</div>
</div>
<div id="outline-container-h:ea78466a-d75b-4852-a27e-9b3289204921" class="outline-3">
<h3 id="h:ea78466a-d75b-4852-a27e-9b3289204921">tiny</h3>
<div class="outline-text-3" id="text-h:ea78466a-d75b-4852-a27e-9b3289204921">
<p>
github: <a href="https://github.com/abo-abo/tiny">https://github.com/abo-abo/tiny</a>
</p>

<p>
abo-abo 继续为我们带来好用的插件。tiny 可以实现一个方便的序号宏展开。举个小例子就一目了然了：我们想要定义一组函数分别名为 int fun01、int fun02、 …… 、int fun10，正常我们只能一个个手敲，但有了 tiny，我们可以输入一个这样的简单语法：
</p>
<div class="org-src-container">
<pre class="src src-text">m1\n10|int func%02d ()
</pre>
</div>

<p>
m 是个固定的前缀字符，1\n10 表示 1 到 10 的数字，中间用回车换行分隔，竖线 | 后面是我们的格式化文本。然后我们调用 M-x tiny-expand 命令，就能得到如下文本：
</p>

<div class="org-src-container">
<pre class="src src-text">int func01 ()
int func02 ()
int func03 ()
int func04 ()
int func05 ()
int func06 ()
int func07 ()
int func08 ()
int func09 ()
int func10 ()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> tiny
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21487;&#36873;&#32465;&#23450;&#24555;&#25463;&#38190;&#65292;&#20010;&#20154;&#24863;&#35273;&#19981;&#32465;&#23450;&#24555;&#25463;&#38190;&#20063;&#26080;&#22952;</span>
  <span style="color: #483d8b;">:bind</span>
  (<span style="color: #8b2252;">"C-;"</span> . tiny-expand))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:65e8eb34-0627-4377-96ed-620e9d3931fc" class="outline-3">
<h3 id="h:65e8eb34-0627-4377-96ed-620e9d3931fc">highlight-symbol</h3>
<div class="outline-text-3" id="text-h:65e8eb34-0627-4377-96ed-620e9d3931fc">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>highlight-symbol <a href="https://github.com/nschum/highlight-symbol.el">https://github.com/nschum/highlight-symbol.el</a></li>
</ul>

<p>
这个插件可以高亮出当前 Buffer 中所有的、与光标所在处的符号相同的符号。也就是例如一些同名变量、函数名等。虽然在后面我们使用一些其他插件时也会捎带有类似功能，但它可以同时高亮很多字符，便于阅读代码等。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> highlight-symbol
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span> (highlight-symbol-mode)
  <span style="color: #483d8b;">:bind</span> (<span style="color: #8b2252;">"&lt;f3&gt;"</span> . highlight-symbol)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25353;&#19979; F3 &#38190;&#23601;&#21487;&#39640;&#20142;&#24403;&#21069;&#31526;&#21495;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:4e139573-544d-4d15-974a-32e3bd2b2883" class="outline-3">
<h3 id="h:4e139573-544d-4d15-974a-32e3bd2b2883">rainbow-delimiters</h3>
<div class="outline-text-3" id="text-h:4e139573-544d-4d15-974a-32e3bd2b2883">
<ul class="org-ul">
<li>rainbow-delimiters <a href="https://github.com/Fanael/rainbow-delimiters">https://github.com/Fanael/rainbow-delimiters</a></li>
</ul>

<p>
这个插件可以用不同颜色标记多级括号，方便看清代码块（尤其在 EmacsLisp 中）。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> rainbow-delimiters
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:hook</span> (prog-mode . rainbow-delimiters-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:964ee18a-93c5-4943-b284-822a58cd19d4" class="outline-3">
<h3 id="h:964ee18a-93c5-4943-b284-822a58cd19d4">google-this</h3>
<div class="outline-text-3" id="text-h:964ee18a-93c5-4943-b284-822a58cd19d4">
<ul class="org-ul">
<li>google-this <a href="https://github.com/Malabarba/emacs-google-this">https://github.com/Malabarba/emacs-google-this</a></li>
</ul>

<p>
在 Emacs 内选中一段文本，按下 <code>C-c / t</code> 触发 google-this，即可搜索这段文本。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> google-this
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (google-this-mode)) 
</pre>
</div>
</div>
</div>
<div id="outline-container-h:66409e21-1707-4475-a9f1-62d6e256523d" class="outline-3">
<h3 id="h:66409e21-1707-4475-a9f1-62d6e256523d">evil（为 Vim 用户）</h3>
<div class="outline-text-3" id="text-h:66409e21-1707-4475-a9f1-62d6e256523d">
<p>
evil 可以让习惯了 Vim 的用户在 Emacs 中使用 Vim 按键方式，大大减轻了 Vim 用户转入 Emacs 的成本。
两个主要 ”Emacs 发行版“ Doom Emacs 和 Spacemacs 都是默认支持的，所以这二者对 Vim 转 Emacs 且不喜欢花太多时间配置的人来说非常合适。
</p>
</div>
<div id="outline-container-h:3511eb20-d226-4d76-ad43-a441aa9009b2" class="outline-4">
<h4 id="h:3511eb20-d226-4d76-ad43-a441aa9009b2">安装Evil</h4>
<div class="outline-text-4" id="text-h:3511eb20-d226-4d76-ad43-a441aa9009b2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> evil
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (<span style="color: #a020f0;">setq</span> evil-want-keybinding nil) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#19981;&#20351;&#29992;&#33258;&#24102;&#30340;&#38190;&#20301;&#32465;&#23450;&#12290;&#40664;&#35748;&#21152;&#36733;&#19981;&#21516;&#27169;&#24335;&#19979;&#38190;&#20301;&#32465;&#23450;</span>
  (<span style="color: #a020f0;">setq</span> evil-want-C-u-scroll t)   <span style="color: #b22222;">;</span><span style="color: #b22222;">C-u &#23454;&#29616;&#21521;&#19978;&#28378;&#21160;&#12290;&#40664;&#35748;C-u &#26159;emacs&#20013;&#30340;&#21151;&#33021;</span>
  (evil-mode)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">https://emacs.stackexchange.com/questions/46371/how-can-i-get-ret-to-follow-org-mode-links-when-using-evil-mode</span>
  (<span style="color: #a020f0;">with-eval-after-load</span> 'evil-maps
    (define-key evil-motion-state-map (kbd <span style="color: #8b2252;">"RET"</span>) nil)) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#22914;&#26524;&#26377;&#38142;&#25509;&#65292;&#25353;&#22238;&#36710;&#33021;&#35775;&#38382;&#36825;&#20010;&#38142;&#25509;</span>
  )
</pre>
</div>

<p>
evil 可以使用 C-z 切换 Emacs 按键模式和 Vim 按键模式。当然在终端中，这会覆盖掉挂起功能，想要挂起可以按 C-x C-z。
</p>

<p>
安装undo-tree
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">evil &#20351;&#29992;undo-tree&#26469;&#31649;&#29702;undo redo</span>
(<span style="color: #a020f0;">use-package</span> undo-tree
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:diminish</span>
  <span style="color: #483d8b;">:init</span>
  (global-undo-tree-mode 1)
  (<span style="color: #a020f0;">setq</span> undo-tree-auto-save-history nil)
  (evil-set-undo-system 'undo-tree))
</pre>
</div>


<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#20809;&#26631;&#31227;&#21160;</span>
h: &#24038; L: &#21491; j: &#19979; k: &#19978;
^ : &#36339;&#36716;&#33267;&#34892;&#39318;&#31532;&#19968;&#20010;&#38750;&#31354;&#30333;&#23383;&#31526;&#65307;
0 : &#25968;&#23383;0&#36339;&#36716;&#33267;&#32477;&#23545;&#34892;&#39318;&#65307;
$ : &#36339;&#36716;&#33267;&#32477;&#23545;&#34892;&#23614;
G &#26368;&#21518;&#19968;&#34892;
gg &#31532;&#19968;&#34892;
Ctrl+f : &#21521;&#25991;&#20214;&#23614;&#37096;&#32763;&#19968;&#23631;
Ctrl+b : &#21521;&#25991;&#20214;&#39318;&#37096;&#32763;&#19968;&#23631;
Ctrl+d : &#21521;&#25991;&#20214;&#23614;&#37096;&#32763;&#21322;&#23631;
Ctrl+u : &#21521;&#25991;&#20214;&#39318;&#37096;&#32763;&#21322;&#23631;

<span style="color: #b22222;"># </span><span style="color: #b22222;">2&#31383;&#21475;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#31383;&#21475;&#20998;&#21106;</span>
Ctrl+w,s&#65306;split, &#27700;&#24179;&#20998;&#21106;&#65292;&#19978;&#19979;&#20998;&#23631;&#12290;&#25110;&#32773;:sp&#12290;:sp(split) filename    &#19978;&#19979;&#20998;&#21106;&#65292;&#24182;&#25171;&#24320;&#19968;&#20010;&#26032;&#30340;&#25991;&#20214;&#12290;
Ctrl+w,v&#65306;vertical, &#22402;&#30452;&#20998;&#21106;&#65292;&#24038;&#21491;&#20998;&#23631;&#65292;&#25110;&#32773;:vs&#12290;:vs(vsplit) filename    &#24038;&#21491;&#20998;&#21106;&#65292;&#24182;&#25171;&#24320;&#19968;&#20010;&#26032;&#30340;&#25991;&#20214;&#12290;
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#31383;&#21475;&#20999;&#25442;</span>
&lt;C-w&gt;w &#22312;&#31383;&#21475;&#24490;&#29615;&#20999;&#25442;&#12290;&#22914;&lt;C-w&gt;&lt;C-w&gt;&lt;C-w&gt;&lt;C-w&gt;
&lt;C-w&gt;h &#20999;&#25442;&#21040;&#24038;&#36793;&#30340;&#31383;&#21475;
&lt;C-w&gt;j &#20999;&#25442;&#21040;&#21491;&#36793;&#30340;&#31383;&#21475;
&lt;C-w&gt;k &#20999;&#25442;&#21040;&#19978;&#36793;&#30340;&#31383;&#21475;
&lt;C-w&gt;l &#20999;&#25442;&#21040;&#19979;&#36793;&#30340;&#31383;&#21475;
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#31383;&#21475;&#31227;&#21160;</span>
&lt;C-w&gt;L &#24038;&#36793;&#31383;&#21475;&#31227;&#21160;&#21040;&#21491;&#36793;
&lt;C-w&gt;H &#21491;&#36793;&#31383;&#21475;&#31227;&#21160;&#21040;&#24038;&#36793;
</pre>
</div>
</div>
</div>
<div id="outline-container-h:c59ac394-a32c-478f-9e17-eee29e55b38c" class="outline-4">
<h4 id="h:c59ac394-a32c-478f-9e17-eee29e55b38c">Evil state</h4>
<div class="outline-text-4" id="text-h:c59ac394-a32c-478f-9e17-eee29e55b38c">
<p>
<b>Emacs中使用vim和外部使用vim的区别</b>
</p>

<p>
vim 中有normal和insert模式，在emacs中是各种state, 如 noarmal state, insert state
</p>

<dl class="org-dl">
<dt>Normal State (N)</dt><dd>这是 Evil 默认的“静止状态”，其中定义了 vi 绑定的主体。 <code>M-x evil-normal-state</code></dd>

<dt>Insert State (I)</dt><dd>这是插入文本的状态，其中未修改的键将在缓冲区中插入相应的字符。</dd>

<dt>Emacs State (E)</dt><dd>一种尽可能接近默认 Emacs 行为的状态，通过 <code>C-z</code> 从emacs和 vi 相互切换。</dd>

<dt>Visual State (V)</dt><dd>用于选择文本区域的状态。</dd>

<dt>Motion State (M) 运动状态 （M）</dt><dd>一种特殊状态，适用于只读缓冲区，其中运动可用，但编辑操作不可用。只读的文档一般都是Motion state 如帮助文档。 <code>M-x evil-motion-state</code></dd>

<dt>Replace State (R) 替换状态 （R）</dt><dd>一种特殊状态，与插入状态非常相似，只不过它替换文本而不是插入。 按住大写的 <code>R</code> , 一直替换状态</dd>
</dl>
</div>
</div>
<div id="outline-container-h:eff30182-038c-4d5f-9fec-1f752ab1936a" class="outline-4">
<h4 id="h:eff30182-038c-4d5f-9fec-1f752ab1936a">Evil基础用法</h4>
<div class="outline-text-4" id="text-h:eff30182-038c-4d5f-9fec-1f752ab1936a">
<p>
增删改查 (text-obj, commands, replace)
</p>
<ul class="org-ul">
<li>text-obj 更好地操作文本
<ul class="org-ul">
<li>选中单词 viw</li>
<li>删除单词 diw</li>
</ul></li>
<li>跳到r字符的位置： fr</li>
<li>commands
<ul class="org-ul">
<li><code>:</code> 进行命令行模式。 :%s/commands/111/ 可以替换, 按 u 回退</li>
</ul></li>
</ul>

<p>
evil-guide: <a href="https://github.com/noctuid/evil-guide.git">https://github.com/noctuid/evil-guide.git</a>
</p>

<p>
上述文档花2小时认真读就可以完全从vim用户切到emacs上使用了。
</p>


<p>
<b>interactive replace 交互式替换文本</b>
</p>

<p>
交互式替换文本. 在evil模式中，选中的单词填写在 <code>:%s/&lt;word&gt;//</code> 中
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;;</span><span style="color: #b22222;">###</span><span style="color: #ff0000; font-weight: bold;">autoload</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my/evil-quick-replace</span> (beg end )
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"r"</span>)
  (<span style="color: #a020f0;">when</span> (evil-visual-state-p)
    (evil-exit-visual-state)
    (<span style="color: #a020f0;">let</span> ((selection (regexp-quote (buffer-substring-no-properties beg end))))
      (<span style="color: #a020f0;">setq</span> command-string (format <span style="color: #8b2252;">"%%s /%s//g"</span> selection))
      (<span style="color: #a020f0;">minibuffer-with-setup-hook</span>
          (<span style="color: #a020f0;">lambda</span> () (backward-char 2))
        (evil-ex command-string)))))

(define-key evil-visual-state-map (kbd <span style="color: #8b2252;">"C-r"</span>) 'my/evil-quick-replace)
</pre>
</div>

<p>
交互式替换文本操作：
</p>
<ul class="org-ul">
<li><code>SPC v</code> 或者选中要替换的字符串，按 <code>C-r</code> 替换</li>
</ul>
</div>
</div>
<div id="outline-container-h:evil-custom-keybinding" class="outline-4">
<h4 id="h:evil-custom-keybinding">自定义快捷键</h4>
<div class="outline-text-4" id="text-h:evil-custom-keybinding">
<p>
<b>定义不同 state 下面的快捷键</b>
</p>


<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">&#33258;&#23450;&#20041;&#35774;&#32622;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22312;&#36827;&#34892;&#25554;&#20837;&#27169;&#24335;&#21518;&#65292;&#24076;&#26395;&#20351;&#29992;emacs&#30340;&#24555;&#25463;&#38190;&#65292;&#32780;&#21448;&#19981;&#24076;&#26395;&#36827;&#20837; Emacs State</span>
(setcdr evil-insert-state-map nil)
(define-key evil-insert-state-map [escape] 'evil-normal-state) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#25353; [Esc] &#22238;&#21040;normal state</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21152;&#31354;&#34892;, &#40664;&#35748; o + Esc &#38656;&#35201;2&#27425;&#25805;&#20316;. &#19979;&#38754;&#30340;&#35774;&#32622;&#30452;&#25509;&#22312;normal &#27169;&#24335;&#20013;&#25805;&#20316;</span>
(define-key evil-normal-state-map (kbd <span style="color: #8b2252;">"[ SPC"</span>) (<span style="color: #a020f0;">lambda</span> () (<span style="color: #a020f0;">interactive</span>) (evil-insert-newline-above) (forward-line))) <span style="color: #b22222;">; </span><span style="color: #b22222;">[ + &#31354;&#26684;&#65292;&#21521;&#19978;&#21152;&#31354;&#34892;</span>
(define-key evil-normal-state-map (kbd <span style="color: #8b2252;">"] SPC"</span>) (<span style="color: #a020f0;">lambda</span> () (<span style="color: #a020f0;">interactive</span>) (evil-insert-newline-below) (forward-line -1))) <span style="color: #b22222;">; </span><span style="color: #b22222;">[ + &#31354;&#26684;&#65292;&#21521;&#19978;&#21152;&#31354;&#34892;</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22312;normal state&#20013;&#20999;&#25442;&#19981;&#21516;&#30340;buffer</span>
(define-key evil-normal-state-map (kbd <span style="color: #8b2252;">"[ b"</span>) 'previous-buffer) <span style="color: #b22222;">; </span><span style="color: #b22222;">[ + b &#20999;&#21040;&#21069;&#19968;&#20010;buffer</span>
(define-key evil-normal-state-map (kbd <span style="color: #8b2252;">"] b"</span>) 'next-buffer)
(define-key evil-motion-state-map (kbd <span style="color: #8b2252;">"[ b"</span>) 'previous-buffer)
(define-key evil-motion-state-map (kbd <span style="color: #8b2252;">"] b"</span>) 'next-buffer)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22312;dired&#27169;&#24335;&#19979;&#65292;&#28155;&#21152;&#24555;&#25463;&#38190;</span>
(evil-define-key 'normal dired-mode-map <span style="color: #b22222;">; </span><span style="color: #b22222;">&#21482;&#20462;&#25913;dired&#27169;&#24335;&#19979;normal&#27169;&#24335;&#30340;&#24555;&#25463;&#38190;&#32465;&#23450;</span>
  (kbd <span style="color: #8b2252;">"&lt;RET&gt;"</span>) 'dired-find-alternate-file
  (kbd <span style="color: #8b2252;">"C-k"</span>) 'dired-up-directory <span style="color: #b22222;">;</span><span style="color: #b22222;">&#24448;&#19978;&#19968;&#32423;&#30446;&#24405;</span>
  <span style="color: #8b2252;">"`"</span> 'dired-open-term
  <span style="color: #8b2252;">"q"</span> 'quit-window <span style="color: #b22222;">; </span><span style="color: #b22222;">q &#36864;&#20986;&#12290;&#40664;&#35748;&#27809;&#26377;&#12290; &#21487;&#20197;&#26597;&#30475;emacs state&#19979;&#30340;q&#32465;&#23450;&#30340;&#20989;&#25968; =C-x d= &#36827;&#20837;dired&#65292; =C-z= &#36827;&#20837;emacs state&#65292; =C-h k= &#25353; q &#21487;&#26597;&#21040;&#23545;&#24212;&#30340;&#20989;&#25968;&#20026; quit-window</span>
  <span style="color: #8b2252;">"o"</span> 'dired-find-file-other-window <span style="color: #b22222;">; </span><span style="color: #b22222;">&#22312;&#21478;&#22806;&#19968;&#20010;&#31383;&#21475;&#25171;&#24320;&#25991;&#20214;</span>
  <span style="color: #8b2252;">"z"</span> 'dired-get-size
  <span style="color: #8b2252;">")"</span> 'dired-omit-mode)
</pre>
</div>


<p>
<b>spacemacs like 快捷键如何定义</b>
</p>

<p>
general插件中global-definer在init-basic.el中定义
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> general
  <span style="color: #483d8b;">:init</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">global-definer &#23545;&#24212;leader&#38190;&#20026;&#31354;&#26684;</span>
  (global-definer
    <span style="color: #8b2252;">"!"</span> 'shell-command <span style="color: #b22222;">;</span><span style="color: #b22222;">&#31354;&#26684;+! SPC ! &#36827;&#20837;shell&#21629;&#20196;&#34892;</span>
    <span style="color: #8b2252;">"SPC"</span> 'execute-extended-command <span style="color: #b22222;">; </span><span style="color: #b22222;">&#25353;2&#19979;&#31354;&#26684;SPC-SPC&#23601;&#21487;&#20197;&#23454;&#29616; M-x &#30340;&#25928;&#26524;</span>
    <span style="color: #8b2252;">"'"</span> 'vertico-repeat
    <span style="color: #8b2252;">"+"</span> 'text-scale-increase
    <span style="color: #8b2252;">"-"</span> 'text-scale-decrease
    <span style="color: #8b2252;">"u"</span> 'universal-argument <span style="color: #b22222;">;</span><span style="color: #b22222;">SPC u &#30456;&#24403;&#20110;emacs&#30340;C-u </span>
    <span style="color: #8b2252;">"hdf"</span> 'describe-function <span style="color: #b22222;">;</span><span style="color: #b22222;">SPC hdf &#30456;&#24403;&#20110;emacs&#30340;C-h f</span>
    <span style="color: #8b2252;">"hdv"</span> 'describe-variable <span style="color: #b22222;">;</span><span style="color: #b22222;">SPC hdv &#30456;&#24403;&#20110;emacs&#30340;C-h v</span>
    <span style="color: #8b2252;">"hdk"</span> 'describe-key <span style="color: #b22222;">;</span><span style="color: #b22222;">SPC hdk &#30456;&#24403;&#20110;emacs&#30340;C-h k</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26597;&#30475;init-funcs.el &#33258;&#23450;&#20041;&#20989;&#25968;</span>
    <span style="color: #8b2252;">"hh"</span> 'my/highlight-dwim <span style="color: #b22222;">;</span><span style="color: #b22222;">SPC hh &#39640;&#20142;&#36873;&#20013;&#21306;&#22495;&#24182;&#26631;&#19978;&#39068;&#33394;</span>
    <span style="color: #8b2252;">"hc"</span> 'my/clearn-highlight <span style="color: #b22222;">;</span><span style="color: #b22222;">SPC hc &#28165;&#38500;&#39640;&#20142;&#39068;&#33394;</span>
    <span style="color: #8b2252;">"v"</span> 'er/expand-region <span style="color: #b22222;">;</span><span style="color: #b22222;">SPC v &#25193;&#22823;&#21306;&#22495;</span>
    )
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">leader &#38190;&#20026;SPC&#31354;&#26684;&#65292;&#23376;leader&#38190;&#20026;b. &#22914; SPC b b&#26597;&#30475;buffer&#32531;&#20914;&#21306;</span>
  (+general-global-menu! <span style="color: #8b2252;">"buffer"</span> <span style="color: #8b2252;">"b"</span>
    <span style="color: #8b2252;">"d"</span> 'kill-current-buffer
    <span style="color: #8b2252;">"b"</span> '(consult-buffer <span style="color: #483d8b;">:which-key</span> <span style="color: #8b2252;">"consult buffer"</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#26597;&#30475;buffer&#32531;&#20914;&#21306;</span>
    <span style="color: #8b2252;">"B"</span> 'switch-to-buffer
    <span style="color: #8b2252;">"p"</span> 'previous-buffer
    <span style="color: #8b2252;">"R"</span> 'rename-buffer
    <span style="color: #8b2252;">"M"</span> '((<span style="color: #a020f0;">lambda</span> () (<span style="color: #a020f0;">interactive</span>) (switch-to-buffer <span style="color: #8b2252;">"*Messages*"</span>)) 
          <span style="color: #483d8b;">:which-key</span> <span style="color: #8b2252;">"messages-buffer"</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">SPC b M&#26597;&#30475;*Message*&#32531;&#20914;&#21306;</span>
    <span style="color: #8b2252;">"n"</span> 'next-buffer
    <span style="color: #8b2252;">"i"</span> 'ibuffer
    <span style="color: #8b2252;">"f"</span> 'my-open-current-directory
    <span style="color: #8b2252;">"k"</span> 'kill-buffer

    <span style="color: #8b2252;">"y"</span> 'copy-buffer-name
    <span style="color: #8b2252;">"K"</span> 'kill-other-buffers)
  )
</pre>
</div>

<p>
参考配置： <a href="https://github.com/zilongshanren/emacs.d/blob/eglot/lisp/init-keybindings.el">https://github.com/zilongshanren/emacs.d/blob/eglot/lisp/init-keybindings.el</a> 实现自己的文件、窗口、项目多种快捷键绑定
</p>
</div>
</div>
<div id="outline-container-h:5bb4009d-f741-44ee-bbc3-61ad2b7bdaeb" class="outline-4">
<h4 id="h:5bb4009d-f741-44ee-bbc3-61ad2b7bdaeb">evil-leader 插件</h4>
<div class="outline-text-4" id="text-h:5bb4009d-f741-44ee-bbc3-61ad2b7bdaeb">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li>evil-leader  <a href="https://github.com/cofi/evil-leader">https://github.com/cofi/evil-leader</a></li>
</ul>

<p>
在 Emacs 中使用 Leader Key 可以通过 <a href="https://github.com/cofi/evil-leader">evil-leader</a> 来实现。你需要做的就是在安装后将其激活即可。
</p>

<p>
<b><b>提示</b></b>: 根据<a href="https://github.com/cofi/evil-leader">cofi/evil-leader</a>的说明，你应该在激活 evil-mode 之前就激活 global-evil-leader-mode，否则 evil-leader 在几个初始缓冲区(scratch, Message,…)上将不生效。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-evil-leader-mode)
</pre>
</div>

<p>
Leader Key 可以通过 customize-group 来进行设置（Evil Leader/Leader）。因为之后我 们会转移至 Spacemacs 所以我们可以将其设置为空格键 `SPC` 。
</p>

<p>
在通过下面的配置来设置简单的结合 Leader Key 快捷键组合（我们使用不同的键讲不同的 功能分组，例如我们使用 `f` 键来做关于文件的操作，使用 `b` 键来做关于缓冲区 （Buffer）的操作），
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">evil </span>
(evil-leader/set-key
  <span style="color: #8b2252;">"ff"</span> 'find-file              <span style="color: #b22222;">; </span><span style="color: #b22222;">&#25171;&#24320;&#25991;&#20214;&#65292;&#21407;C-x C-f &#21487;&#20197;&#29992;C-h k &#36755;&#20837;C-x C-f&#26597;&#25214;&#23545;&#24212;&#30340;key&#21517;&#31216;</span>
  <span style="color: #8b2252;">"fr"</span> 'recentf-open-files     <span style="color: #b22222;">; </span><span style="color: #b22222;">&#25171;&#24320;&#26368;&#36817;&#25991;&#20214;&#65292; meacs: C-x C-r </span>
  <span style="color: #8b2252;">"bb"</span> 'switch-to-buffer       <span style="color: #b22222;">; </span><span style="color: #b22222;">&#31354;&#26684;-bb&#20999;&#25442;&#21040;buffer&#65292;&#21407;C-x b</span>
  <span style="color: #8b2252;">"0"</span>  'select-window-0        <span style="color: #b22222;">; </span><span style="color: #b22222;">&#31354;&#26684;-0&#20999;&#25442;&#31383;&#21475;0&#65292;M-0 </span>
  <span style="color: #8b2252;">"1"</span>  'select-window-1        <span style="color: #b22222;">; </span><span style="color: #b22222;">&#31354;&#26684;-1&#20999;&#25442;&#31383;&#21475;1&#65292;M-1 </span>
  <span style="color: #8b2252;">"2"</span>  'select-window-h
  <span style="color: #8b2252;">"3"</span>  'select-window-3
  <span style="color: #8b2252;">"w/"</span> 'split-window-right     <span style="color: #b22222;">; </span><span style="color: #b22222;">SPC-w/ &#22402;&#30452;&#20998;&#23631;&#65292;emacs: C-x 3 vim: C-w v   :vs</span>
  <span style="color: #8b2252;">"w-"</span> 'split-window-below     <span style="color: #b22222;">; </span><span style="color: #b22222;">SPC-w- &#27700;&#24179;&#20998;&#23631;&#65292;emacs: vim: C-w s   :sp</span>
  <span style="color: #8b2252;">"wM"</span> 'delete-other-windows   <span style="color: #b22222;">; </span><span style="color: #b22222;">SPC-wM &#21024;&#38500;&#38500;&#24403;&#21069;&#31383;&#21475;&#20043;&#22806;&#30340;&#31383;&#21475;&#65292;emacs: C-x 1 vim: C-w o :only</span>
  )
</pre>
</div>
</div>
</div>
<div id="outline-container-h:36d15ff2-87fc-47f2-a385-ddca88f7c2f0" class="outline-4">
<h4 id="h:36d15ff2-87fc-47f2-a385-ddca88f7c2f0">相关插件列表</h4>
<div class="outline-text-4" id="text-h:36d15ff2-87fc-47f2-a385-ddca88f7c2f0">
</div>
<div id="outline-container-h:2186eba8-72bf-4c04-b439-168680e1055e" class="outline-5">
<h5 id="h:2186eba8-72bf-4c04-b439-168680e1055e">evil-escape插件回退到normal state</h5>
<div class="outline-text-5" id="text-h:2186eba8-72bf-4c04-b439-168680e1055e">
<p>
任何状态下按 <code>kj</code> 就能回到normal state。很实用，相当于把esc键集中在右手, 一只手就可以操作vim常用功能。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">kj &#36864;&#22238;&#21040;&#26222;&#36890;&#27169;&#24335;</span>
(<span style="color: #a020f0;">use-package</span> evil-escape
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">{{ https://github.com/syl20bnr/evil-escape</span>
  (<span style="color: #a020f0;">setq-default</span> evil-escape-delay 0.3)
  (<span style="color: #a020f0;">setq</span> evil-escape-excluded-major-modes '(dired-mode))
  (<span style="color: #a020f0;">setq-default</span> evil-escape-key-sequence <span style="color: #8b2252;">"kj"</span>)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">disable evil-escape when input method is on</span>
  (evil-escape-mode 1)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">}}</span>
)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:ff29f09d-cec5-488a-a62e-2e96a9327958" class="outline-5">
<h5 id="h:ff29f09d-cec5-488a-a62e-2e96a9327958">evil-anzu</h5>
<div class="outline-text-5" id="text-h:ff29f09d-cec5-488a-a62e-2e96a9327958">
<p>
小功能ui。 当用 <code>Shift *</code> 查找单词重复出现几次时，下方状态栏会多一个标识显示，显示当前重复出现单词的位置和总重复次数。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">&#19979;&#26041;&#29366;&#24577;&#26639;&#26174;&#31034;&#21333;&#35789;&#37325;&#22797;&#20986;&#29616;&#20301;&#32622;</span>
(<span style="color: #a020f0;">use-package</span> evil-anzu
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> evil
  <span style="color: #483d8b;">:diminish</span>
  <span style="color: #483d8b;">:demand</span> t
  <span style="color: #483d8b;">:init</span>
  (global-anzu-mode t))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:4ab86f63-e3dc-4b10-a730-72d12d10555a" class="outline-5">
<h5 id="h:4ab86f63-e3dc-4b10-a730-72d12d10555a">evil-collections</h5>
<div class="outline-text-5" id="text-h:4ab86f63-e3dc-4b10-a730-72d12d10555a">
<p>
使用社区的按键绑定。相对稳定不会改变
</p>

<p>
同时可以设置不同模式中默认的evil状态
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">&#20351;&#29992;&#31038;&#21306;&#31283;&#23450;&#30340;&#25353;&#38190;&#32465;&#23450;&#12290; &#24182;&#35774;&#32622;&#19981;&#21516;&#27169;&#24335;&#20013;&#40664;&#35748;&#30340;evil&#29366;&#24577;</span>
(<span style="color: #a020f0;">use-package</span> evil-collection
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> evil
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> evil-collection-mode-list (remove 'lispy evil-collection-mode-list)) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#31227;&#38500;&#31038;&#21306;&#20013;&#25554;&#20214;&#30340;&#25913;&#38190;&#23545;&#20320;&#38190;&#20301;&#24433;&#21709;</span>
  (evil-collection-init)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#36827;&#20837;mode&#26102;&#23545;&#24212;&#30340;vim &#27169;&#24335;</span>
  (<span style="color: #a020f0;">cl-loop</span> for (mode . state) in
           '((org-agenda-mode . normal) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#36827;&#20837;agenda&#26102;&#40664;&#35748;Normal State&#29366;&#24577;</span>
             (Custom-mode . emacs)
             (eshell-mode . emacs) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#36827;&#20837;eshell&#27169;&#24335;&#26102;&#40664;&#35748;Emacs State&#29366;&#24577;</span>
             (makey-key-mode . motion))
           do (evil-set-initial-state mode state)))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:efec661d-88ef-4d35-8545-e33a71e60c04" class="outline-5">
<h5 id="h:efec661d-88ef-4d35-8545-e33a71e60c04">evil-surround</h5>
<div class="outline-text-5" id="text-h:efec661d-88ef-4d35-8545-e33a71e60c04">
<ul class="org-ul">
<li>evil-surround <a href="https://github.com/timcharper/evil-surround">https://github.com/timcharper/evil-surround</a></li>
</ul>

<p>
<a href="https://github.com/timcharper/evil-surround">Evil-surround</a>是一个 Vim 上非常常用的插件改写的，使用它可以快速的将选中区域进行 匹配的操作，例如选中区域两边同时进行添加或修改括号，引号等操作。
</p>

<p>
S用法，选中一个单词后加引号。
</p>
<ul class="org-ul">
<li><code>viw S "</code> 相当于原生vim text object用法 <code>viw Shift i "</code> 操作</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">S&#29992;&#27861;&#65292;&#36873;&#20013;&#19968;&#20010;&#21333;&#35789;&#21518;&#21152;&#24341;&#21495;&#12290;viw S " &#30456;&#24403;&#20110;&#21407;&#29983;vim text object&#29992;&#27861; viw Shift i " </span>
(<span style="color: #a020f0;">use-package</span> evil-surround
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (global-evil-surround-mode 1))
</pre>
</div>

<p>
vim中快捷使用
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">normal&#27169;&#24335;&#19979;&#22686;&#21152;&#12289;&#21024;&#38500;&#12289;&#20462;&#25913;&#25104;&#23545;&#20869;&#23481;</span>
<span style="color: #0000ff;">ds</span> (delete a surrounding)
<span style="color: #0000ff;">cs</span> (change a surrounding)
<span style="color: #0000ff;">ys</span> (you add a surrounding)

<span style="color: #b22222;">#</span><span style="color: #b22222;">1.&#28155;&#21152;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">name&#21333;&#35789;&#20004;&#36793;"name"&#65292;&#20809;&#26631;&#22312;name&#21333;&#35789;&#19978;</span>
ys+iw<span style="color: #8b2252;">"  </span>
<span style="color: #8b2252;"># name&#20013;"</span>nam<span style="color: #8b2252;">"e&#65292;&#20809;&#26631;&#20572;&#22312;n&#23383;&#31526;&#19978;</span>
<span style="color: #8b2252;">ys+fm"</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">2.&#20462;&#25913;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">"name"&#21464;'name'</span>
cs+<span style="color: #8b2252;">"'</span>
<span style="color: #8b2252;"># (name)&#21464;[name]</span>
<span style="color: #8b2252;">cs+(]</span>

<span style="color: #8b2252;">#3.&#21024;&#38500;</span>
<span style="color: #8b2252;"># 'name'&#21464;name</span>
<span style="color: #8b2252;">ds+'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5748be0d-f8c4-45d6-89c0-3fd42e880a2c" class="outline-5">
<h5 id="h:5748be0d-f8c4-45d6-89c0-3fd42e880a2c">evil-nerd-commenter</h5>
<div class="outline-text-5" id="text-h:5748be0d-f8c4-45d6-89c0-3fd42e880a2c">
<ul class="org-ul">
<li>evil-nerd-commenter 快速添加与取消注释的插件 <a href="https://github.com/redguardtoo/evil-nerd-commenter">https://github.com/redguardtoo/evil-nerd-commenter</a></li>
</ul>

<p>
对不同语言加的注释
</p>

<p>
使用下面的代码将其与 Evil 模式进行绑定，这里我们选择使用 <code>,/</code> 作为快捷键。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">&#28155;&#21152;&#19981;&#21516;&#35821;&#35328;&#30340;&#27880;&#37322;</span>
(<span style="color: #a020f0;">use-package</span> evil-nerd-commenter
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">normal &#25110; visual &#27169;&#24335;&#19979;&#25353; ,/ &#21487;&#21152;&#27880;&#37322;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(define-key evil-normal-state-map (kbd ",ci") 'evilnc-comment-or-uncomment-lines)</span>
  (define-key evil-normal-state-map (kbd <span style="color: #8b2252;">",/"</span>) 'evilnc-comment-or-uncomment-lines)
  (define-key evil-visual-state-map (kbd <span style="color: #8b2252;">",/"</span>) 'evilnc-comment-or-uncomment-lines)
  )
</pre>
</div>

<p>
操作：加注释
</p>
<ul class="org-ul">
<li>单行注释， <code>,/</code></li>
<li>多行注释，选中行 <code>,/</code></li>
</ul>
</div>
</div>
<div id="outline-container-h:c63ca6bf-d489-49a3-90b9-0826c2bc5f20" class="outline-5">
<h5 id="h:c63ca6bf-d489-49a3-90b9-0826c2bc5f20">evil-snipe</h5>
<div class="outline-text-5" id="text-h:c63ca6bf-d489-49a3-90b9-0826c2bc5f20">
<p>
小功能ui。高亮查找的字符。 如查找m字符。 <code>fm</code> 当前行的m字符高亮。按 <code>;</code> 重复查找动作
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> evil-snipe
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:diminish</span>
  <span style="color: #483d8b;">:init</span>
  (evil-snipe-mode +1)
  (evil-snipe-override-mode +1))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:270a82c8-9426-4829-b6b8-2037a2121fdf" class="outline-5">
<h5 id="h:270a82c8-9426-4829-b6b8-2037a2121fdf">evil-matchit</h5>
<div class="outline-text-5" id="text-h:270a82c8-9426-4829-b6b8-2037a2121fdf">
<p>
按 <code>%</code> 可以在函数、括号之间跳转
</p>

<p>
参考我的文章<a href="http://xuchangwei.com/lisp/coding-emacs/coding-emacs.html#h:vscode-symbol-jump">(如何提高编程速度)</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">&#25353; % &#21487;&#20197;&#22312;&#20989;&#25968;&#12289;&#25324;&#21495;&#20043;&#38388;&#36339;&#36716;</span>
(<span style="color: #a020f0;">use-package</span> evil-matchit
  <span style="color: #483d8b;">:ensure</span>
  <span style="color: #483d8b;">:init</span>
  (global-evil-matchit-mode 1))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:78a0a60e-dfaf-4aeb-9f4d-6bbaefd6ae1d" class="outline-4">
<h4 id="h:78a0a60e-dfaf-4aeb-9f4d-6bbaefd6ae1d">高阶用法（自定义 text-obj 或者 自定义 commands)</h4>
<div class="outline-text-4" id="text-h:78a0a60e-dfaf-4aeb-9f4d-6bbaefd6ae1d">
<ul class="org-ul">
<li><a href="https://github.com/noctuid/evil-guide#modes">https://github.com/noctuid/evil-guide#modes</a></li>
<li><a href="https://evil.readthedocs.io/en/latest/overview.html">https://evil.readthedocs.io/en/latest/overview.html</a></li>
</ul>


<p>
<b>我的建议</b>
</p>

<p>
使用emacs原生按键。 用多了evil，你还是个vim用户，无法轻松操作无配置或精简内置配置的emacs。
</p>
</div>
</div>
</div>
<div id="outline-container-h:ace7fead-b17b-4cb3-a5ef-f1e78e52ecba" class="outline-3">
<h3 id="h:ace7fead-b17b-4cb3-a5ef-f1e78e52ecba">Window-numbering 插件</h3>
<div class="outline-text-3" id="text-h:ace7fead-b17b-4cb3-a5ef-f1e78e52ecba">
<p>
这个插件可以让我们快速的使用 Leader Key 与数字键的组合来在多个窗口之间进行跳转。 它的 GitHub 地址可以在<a href="https://github.com/nschum/window-numbering.el">这里</a>找到。
</p>

<p>
下载安装后通过下面的代码可以将其激活，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(window-numbering-mode 1)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:e68f5892-d6f7-4298-b1fb-348e49ea8b58" class="outline-3">
<h3 id="h:e68f5892-d6f7-4298-b1fb-348e49ea8b58">elfeed订阅插件</h3>
<div class="outline-text-3" id="text-h:e68f5892-d6f7-4298-b1fb-348e49ea8b58">
<ul class="org-ul">
<li>elfeed <a href="https://github.com/skeeto/elfeed">https://github.com/skeeto/elfeed</a></li>
</ul>
</div>
<div id="outline-container-h:6da7003c-ea3b-411d-88f4-8b4fb3926cbd" class="outline-4">
<h4 id="h:6da7003c-ea3b-411d-88f4-8b4fb3926cbd">elfeed-part1</h4>
<div class="outline-text-4" id="text-h:6da7003c-ea3b-411d-88f4-8b4fb3926cbd">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">elfeed part1</span>
(<span style="color: #a020f0;">setq</span> elfeed-db-directory <span style="color: #8b2252;">"~/Sync/shared/elfeeddb"</span>)

(<span style="color: #a020f0;">use-package</span> elfeed
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> elfeed-search-mode-map
              (<span style="color: #8b2252;">"q"</span> . bjm/elfeed-save-db-and-bury)
              (<span style="color: #8b2252;">"Q"</span> . bjm/elfeed-save-db-and-bury)
              (<span style="color: #8b2252;">"m"</span> . elfeed-toggle-star)
              (<span style="color: #8b2252;">"M"</span> . elfeed-toggle-star)
              )
  )
<span style="color: #b22222;">;; </span><span style="color: #b22222;">elfeed-org&#20351;&#29992;&#30340;org&#25991;&#20214;&#65292;&#25552;&#21069;&#25910;&#34255;&#19968;&#20123;&#38142;&#25509;</span>
(<span style="color: #a020f0;">use-package</span> elfeed-org
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (elfeed-org)
  (<span style="color: #a020f0;">setq</span> rmh-elfeed-org-files (list <span style="color: #8b2252;">"~/Sync/shared/elfeed.org"</span>)))
</pre>
</div>

<p>
我们可以在`~/Sync/shared/elfeed.org`提前保存好收藏的地址
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">\* blogs                                                        <span style="color: #483d8b;">:elfeed:</span>
\** daily                                                        <span style="color: #483d8b;">:daily:</span>
\*** http://telescoper.wordpress.com/feed/
\*** http://xkcd.com/rss.xml
\*** http://timharford.com/feed/
\*** http://understandinguncertainty.org/rss.xml
\** emacs                                                        <span style="color: #483d8b;">:emacs:</span>
\*** http://www.reddit.com/r/emacs/.rss
\*** http://planet.emacsen.org/atom.xml
\*** http://feeds.feedburner.com/XahsEmacsBlog
\*** http://pragmaticemacs.com/feed/
\*** [[http://emacs.stackexchange.com/feeds][SX]]
</pre>
</div>

<p>
运行`M-x elfeed`进入阅读模式，再运行`M-x elfeed-update`更新一下数据，这时就可以看到订阅的网站文章了。
</p>

<p>
操作
</p>

<div class="org-src-container">
<pre class="src src-shell">&#26041;&#21521;&#38190;  &#36873;&#25321;&#25991;&#31456;
&#22238;&#36710; &#38405;&#35835;&#25991;&#31456;
q   &#36864;&#20986;&#25991;&#31456;
b   &#27983;&#35272;&#22120;&#38405;&#35835;
s   &#25628;&#32034;&#25991;&#31456;  &#21487;&#22810;&#31181;&#32452;&#21512;&#25628;&#32034;&#12290;+string&#25628;&#32034;tags&#20026;string&#30340;&#26410;&#35835;&#20869;&#23481;&#65292;string&#25628;&#32034;&#20869;&#23481;&#21253;&#21547;&#25991;&#31456;&#65292;@1-day-ago&#19968;&#22825;&#21069;&#25991;&#31456;&#65292;@6-months-ago&#20845;&#20010;&#26376;&#21069;&#25991;&#31456;
r   &#26631;&#35760;&#25991;&#31456;&#24050;&#35835;
u   &#26631;&#35760;&#25991;&#31456;&#26410;&#35835;
m   &#26631;&#35760;&#21152;&#26143;&#25991;&#31456;
p   &#21521;&#19978;&#20999;&#25442;&#25991;&#31456;
n   &#21521;&#19979;&#20999;&#25442;&#25991;&#31456;
+   &#35774;&#32622;tags
-   &#21462;&#28040;tags
C-x k &#26432;&#27515;buffer
</pre>
</div>

<p>
优化配置，更新数据库，及将阅读的状态保存下来，适用于多机器办公。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">elfeed-mark-all-as-read&#24050;&#35835;&#26631;&#35760;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">elfeed-mark-all-as-read</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (mark-whole-buffer)
  (elfeed-search-untag-all-unread))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">functions to support syncing .elfeed between machines</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">makes sure elfeed reads index from disk before launching</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">http://pragmaticemacs.com/emacs/read-your-rss-feeds-in-emacs-with-elfeed/</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">bjm/elfeed-load-db-and-open</span> ()
<span style="color: #8b2252;">"Wrapper to load the elfeed db from disk before opening"</span>
(<span style="color: #a020f0;">interactive</span>)
(elfeed-db-load)
(elfeed)
(elfeed-search-update--force))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">write to disk when quiting</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">bjm/elfeed-save-db-and-bury</span> ()
  <span style="color: #8b2252;">"Wrapper to save the elfeed db to disk before burying buffer"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (elfeed-db-save)
  (quit-window))

(<span style="color: #a020f0;">defalias</span> '<span style="color: #0000ff;">elfeed-toggle-star</span>
  (elfeed-expose #'elfeed-search-toggle-all 'star))
</pre>
</div>

<p>
优化展示
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">&#20248;&#21270;&#31383;&#21475;&#65292;&#25991;&#31456;&#21015;&#34920;&#19982;&#20869;&#23481;&#21516;&#31383;&#21475;&#23637;&#31034;</span>
(<span style="color: #a020f0;">use-package</span> elfeed-goodies
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (elfeed-goodies/setup))
</pre>
</div>

<p>
<img src="./images/image-20210724194557245.png" alt="image-20210724194557245.png">]]
</p>
</div>
</div>
<div id="outline-container-h:8ff31c4b-fb3c-4f4c-af8f-72cf099f183d" class="outline-4">
<h4 id="h:8ff31c4b-fb3c-4f4c-af8f-72cf099f183d">elfeed-part2-Hydras</h4>
<div class="outline-text-4" id="text-h:8ff31c4b-fb3c-4f4c-af8f-72cf099f183d">
<ul class="org-ul">
<li>hydra 自定义按键组合菜单插件 <a href="https://github.com/abo-abo/hydra">https://github.com/abo-abo/hydra</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> hydra
<span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<p>
elfeed阅读器自定义组合
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> elfeed
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> elfeed-search-mode-map
              ...&#30465;&#30053;
              (<span style="color: #8b2252;">"j"</span> . xcw/make-and-run-elfeed-hydra)
              (<span style="color: #8b2252;">"J"</span> . xcw/make-and-run-elfeed-hydra)
              )
             ...&#30465;&#30053;
  )
...&#30465;&#30053;
<span style="color: #b22222;">;; </span><span style="color: #b22222;">elfeed part2 &#33258;&#23450;&#20041;hydra</span>
(defhydra xcw/hydra-elfeed ()
  <span style="color: #8b2252;">"filter"</span>
  (<span style="color: #8b2252;">"*"</span> (elfeed-search-set-filter <span style="color: #8b2252;">"@6-months-ago +star"</span>) <span style="color: #8b2252;">"Starred"</span>)
  (<span style="color: #8b2252;">"M"</span> elfeed-toggle-star <span style="color: #8b2252;">"Mark"</span>)
  (<span style="color: #8b2252;">"A"</span> (elfeed-search-set-filter <span style="color: #8b2252;">"@6-months-ago"</span>) <span style="color: #8b2252;">"All"</span>)
  (<span style="color: #8b2252;">"T"</span> (elfeed-search-set-filter <span style="color: #8b2252;">"@1-day-ago"</span>) <span style="color: #8b2252;">"Today"</span>)
  (<span style="color: #8b2252;">"Q"</span> bjm/elfeed-save-db-and-bury <span style="color: #8b2252;">"Quit Elfeed"</span> <span style="color: #483d8b;">:color</span> blue)
  (<span style="color: #8b2252;">"q"</span> nil <span style="color: #8b2252;">"quit"</span> <span style="color: #483d8b;">:color</span> blue)
  )

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">xcw/make-and-run-elfeed-hydra</span> ()
  <span style="color: #8b2252;">""</span>
  (<span style="color: #a020f0;">interactive</span>)
  <span style="color: #b22222;">;;</span><span style="color: #b22222;">(mz/make-elfeed-hydra)</span>
  (mz/hydra-elfeed/body))
</pre>
</div>

<p>
生效后，进入`elfeed`按`j`就能显示自定义菜单了
</p>
</div>
</div>
<div id="outline-container-h:f059a5b3-4ab3-42a6-81ad-9491054b5b32" class="outline-4">
<h4 id="h:f059a5b3-4ab3-42a6-81ad-9491054b5b32">elfeed-part2-macros</h4>
<div class="outline-text-4" id="text-h:f059a5b3-4ab3-42a6-81ad-9491054b5b32">
<p>
我们使用宏可以更灵活定义自己的操作。
</p>

<p>
范例：宏简单使用
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defmacro</span> <span style="color: #0000ff;">infix</span> (a op c)
  `(,op ,a ,c)
  )

(macroexpand '(infix 30 * 10 )) <span style="color: #b22222;">; </span><span style="color: #b22222;">(* 30 10)</span>

(infix 30 * 10 ) <span style="color: #b22222;">; </span><span style="color: #b22222;">evaluates to 300</span>
</pre>
</div>

<p>
基于第二部分加入宏，可以自动获取数据库大写的字符作为国
</p>

<p>
我们可以使用调用 elfeed-db-get-all-tags 来获取我们数据库中所有标签的列表
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> elfeed
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> elfeed-search-mode-map
             ...&#30465;&#30053;
              (<span style="color: #8b2252;">"j"</span> . mz/make-and-run-elfeed-hydra)
              (<span style="color: #8b2252;">"J"</span> . mz/make-and-run-elfeed-hydra)
             ...&#30465;&#30053;
  )
<span style="color: #b22222;">;;</span><span style="color: #b22222;">&#20248;&#21270;&#31383;&#21475;&#65292;&#25991;&#31456;&#21015;&#34920;&#19982;&#20869;&#23481;&#21516;&#31383;&#21475;&#23637;&#31034;</span>
(<span style="color: #a020f0;">use-package</span> elfeed-goodies
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (elfeed-goodies/setup))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">elfeed-org&#20351;&#29992;&#30340;org&#25991;&#20214;&#65292;&#25552;&#21069;&#25910;&#34255;&#19968;&#20123;&#38142;&#25509;</span>
(<span style="color: #a020f0;">use-package</span> elfeed-org
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (elfeed-org)
  (<span style="color: #a020f0;">setq</span> rmh-elfeed-org-files (list <span style="color: #8b2252;">"~/Sync/shared/elfeed.org"</span>)))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">elfeed part3 macros &#33258;&#21160;&#21457;&#29616;&#26631;&#31614;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">z/hasCap</span> (s) <span style="color: #8b2252;">""</span>
       (<span style="color: #a020f0;">let</span> ((case-fold-search nil))
         (string-match-p <span style="color: #8b2252;">"[[:upper:]]"</span> s)
         ))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">z/get-hydra-option-key</span> (s)
  <span style="color: #8b2252;">"returns single upper case letter (converted to lower) or first"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let</span> ( (loc (z/hasCap s)))
    (<span style="color: #a020f0;">if</span> loc
        (downcase (substring s loc (+ loc 1)))
      (substring s 0 1)
      )))

<span style="color: #b22222;">;;  </span><span style="color: #b22222;">(active blogs cs eDucation emacs local misc sports star tech unread webcomics)</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mz/make-elfeed-cats</span> (tags)
  <span style="color: #8b2252;">"Returns a list of lists. Each one is line for the hydra configuratio in the form</span>
<span style="color: #8b2252;">         (c function hint)"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (mapcar (<span style="color: #a020f0;">lambda</span> (tag)
            (<span style="color: #a020f0;">let*</span> (
                   (tagstring (symbol-name tag))
                   (c (z/get-hydra-option-key tagstring))
                   )
              (list c (append '(elfeed-search-set-filter) (list (format <span style="color: #8b2252;">"@6-months-ago +%s"</span> tagstring) ))tagstring  )))
          tags))

(<span style="color: #a020f0;">defmacro</span> <span style="color: #0000ff;">mz/make-elfeed-hydra</span> ()
  `(defhydra mz/hydra-elfeed ()
     <span style="color: #8b2252;">"filter"</span>
     ,@(mz/make-elfeed-cats (elfeed-db-get-all-tags))
     (<span style="color: #8b2252;">"*"</span> (elfeed-search-set-filter <span style="color: #8b2252;">"@6-months-ago +star"</span>) <span style="color: #8b2252;">"Starred"</span>)
     (<span style="color: #8b2252;">"M"</span> elfeed-toggle-star <span style="color: #8b2252;">"Mark"</span>)
     (<span style="color: #8b2252;">"A"</span> (elfeed-search-set-filter <span style="color: #8b2252;">"@6-months-ago"</span>) <span style="color: #8b2252;">"All"</span>)
     (<span style="color: #8b2252;">"T"</span> (elfeed-search-set-filter <span style="color: #8b2252;">"@1-day-ago"</span>) <span style="color: #8b2252;">"Today"</span>)
     (<span style="color: #8b2252;">"Q"</span> bjm/elfeed-save-db-and-bury <span style="color: #8b2252;">"Quit Elfeed"</span> <span style="color: #483d8b;">:color</span> blue)
     (<span style="color: #8b2252;">"q"</span> nil <span style="color: #8b2252;">"quit"</span> <span style="color: #483d8b;">:color</span> blue)
     ))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mz/make-and-run-elfeed-hydra</span> ()
  <span style="color: #8b2252;">""</span>
  (<span style="color: #a020f0;">interactive</span>)
  (mz/make-elfeed-hydra)
  (mz/hydra-elfeed/body))
</pre>
</div>

<p>
最终的
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">elfeed part1</span>
(<span style="color: #a020f0;">setq</span> elfeed-db-directory <span style="color: #8b2252;">"~/Sync/shared/elfeeddb"</span>)

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mz/elfeed-browse-url</span> (<span style="color: #228b22;">&amp;optional</span> use-generic-p)
  <span style="color: #8b2252;">"Visit the current entry in your browser using `</span><span style="color: #008b8b;">browse-url</span><span style="color: #8b2252;">'.</span>
<span style="color: #8b2252;">  If there is a prefix argument, visit the current entry in the</span>
<span style="color: #8b2252;">  browser defined by `</span><span style="color: #008b8b;">browse-url-generic-program</span><span style="color: #8b2252;">'."</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (<span style="color: #a020f0;">let</span> ((entries (elfeed-search-selected)))
    (<span style="color: #a020f0;">cl-loop</span> for entry in entries
             do (<span style="color: #a020f0;">if</span> use-generic-p
                    (browse-url-generic (elfeed-entry-link entry))
                  (browse-url (elfeed-entry-link entry))))
    (mapc #'elfeed-search-update-entry entries)
    (<span style="color: #a020f0;">unless</span> (<span style="color: #a020f0;">or</span> elfeed-search-remain-on-entry (use-region-p))
      <span style="color: #b22222;">;;</span><span style="color: #b22222;">(forward-line)</span>
      )))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">elfeed-mark-all-as-read&#24050;&#35835;&#26631;&#35760;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">elfeed-mark-all-as-read</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (mark-whole-buffer)
  (elfeed-search-untag-all-unread))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">functions to support syncing .elfeed between machines</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">makes sure elfeed reads index from disk before launching</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">http://pragmaticemacs.com/emacs/read-your-rss-feeds-in-emacs-with-elfeed/</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">bjm/elfeed-load-db-and-open</span> ()
<span style="color: #8b2252;">"Wrapper to load the elfeed db from disk before opening"</span>
(<span style="color: #a020f0;">interactive</span>)
(elfeed-db-load)
(elfeed)
(elfeed-search-update--force))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">write to disk when quiting</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">bjm/elfeed-save-db-and-bury</span> ()
  <span style="color: #8b2252;">"Wrapper to save the elfeed db to disk before burying buffer"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (elfeed-db-save)
  (quit-window))


(<span style="color: #a020f0;">use-package</span> elfeed
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> elfeed-search-mode-map
              (<span style="color: #8b2252;">"q"</span> . bjm/elfeed-save-db-and-bury)
              (<span style="color: #8b2252;">"Q"</span> . bjm/elfeed-save-db-and-bury)
              (<span style="color: #8b2252;">"m"</span> . elfeed-toggle-star)
              (<span style="color: #8b2252;">"M"</span> . elfeed-toggle-star)
              (<span style="color: #8b2252;">"j"</span> . mz/make-and-run-elfeed-hydra)
              (<span style="color: #8b2252;">"J"</span> . mz/make-and-run-elfeed-hydra)
              (<span style="color: #8b2252;">"b"</span> . mz/elfeed-browse-url)
              (<span style="color: #8b2252;">"B"</span> . elfeed-search-browse-url)
              )
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">defalias</span> '<span style="color: #0000ff;">elfeed-toggle-star</span>
    (elfeed-expose #'elfeed-search-toggle-all 'star))
  )

<span style="color: #b22222;">;;</span><span style="color: #b22222;">&#20248;&#21270;&#31383;&#21475;&#65292;&#25991;&#31456;&#21015;&#34920;&#19982;&#20869;&#23481;&#21516;&#31383;&#21475;&#23637;&#31034;</span>
(<span style="color: #a020f0;">use-package</span> elfeed-goodies
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (elfeed-goodies/setup))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">elfeed-org&#20351;&#29992;&#30340;org&#25991;&#20214;&#65292;&#25552;&#21069;&#25910;&#34255;&#19968;&#20123;&#38142;&#25509;</span>
(<span style="color: #a020f0;">use-package</span> elfeed-org
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (elfeed-org)
  (<span style="color: #a020f0;">setq</span> rmh-elfeed-org-files (list <span style="color: #8b2252;">"~/Sync/shared/elfeed.org"</span>)))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">elfeed part3 macros &#33258;&#21160;&#21457;&#29616;&#26631;&#31614;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">z/hasCap</span> (s) <span style="color: #8b2252;">""</span>
       (<span style="color: #a020f0;">let</span> ((case-fold-search nil))
         (string-match-p <span style="color: #8b2252;">"[[:upper:]]"</span> s)
         ))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">z/get-hydra-option-key</span> (s)
  <span style="color: #8b2252;">"returns single upper case letter (converted to lower) or first"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let</span> ( (loc (z/hasCap s)))
    (<span style="color: #a020f0;">if</span> loc
        (downcase (substring s loc (+ loc 1)))
      (substring s 0 1)
      )))

<span style="color: #b22222;">;;  </span><span style="color: #b22222;">(active blogs cs eDucation emacs local misc sports star tech unread webcomics)</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mz/make-elfeed-cats</span> (tags)
  <span style="color: #8b2252;">"Returns a list of lists. Each one is line for the hydra configuratio in the form</span>
<span style="color: #8b2252;">         (c function hint)"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (mapcar (<span style="color: #a020f0;">lambda</span> (tag)
            (<span style="color: #a020f0;">let*</span> (
                   (tagstring (symbol-name tag))
                   (c (z/get-hydra-option-key tagstring))
                   )
              (list c (append '(elfeed-search-set-filter) (list (format <span style="color: #8b2252;">"@6-months-ago +%s"</span> tagstring) ))tagstring  )))
          tags))

(<span style="color: #a020f0;">defmacro</span> <span style="color: #0000ff;">mz/make-elfeed-hydra</span> ()
  `(defhydra mz/hydra-elfeed ()
     <span style="color: #8b2252;">"filter"</span>
     ,@(mz/make-elfeed-cats (elfeed-db-get-all-tags))
     (<span style="color: #8b2252;">"*"</span> (elfeed-search-set-filter <span style="color: #8b2252;">"@6-months-ago +star"</span>) <span style="color: #8b2252;">"Starred"</span>)
     (<span style="color: #8b2252;">"M"</span> elfeed-toggle-star <span style="color: #8b2252;">"Mark"</span>)
     (<span style="color: #8b2252;">"A"</span> (elfeed-search-set-filter <span style="color: #8b2252;">"@6-months-ago"</span>) <span style="color: #8b2252;">"All"</span>)
     (<span style="color: #8b2252;">"T"</span> (elfeed-search-set-filter <span style="color: #8b2252;">"@1-day-ago"</span>) <span style="color: #8b2252;">"Today"</span>)
     (<span style="color: #8b2252;">"Q"</span> bjm/elfeed-save-db-and-bury <span style="color: #8b2252;">"Quit Elfeed"</span> <span style="color: #483d8b;">:color</span> blue)
     (<span style="color: #8b2252;">"q"</span> nil <span style="color: #8b2252;">"quit"</span> <span style="color: #483d8b;">:color</span> blue)
     ))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mz/make-and-run-elfeed-hydra</span> ()
  <span style="color: #8b2252;">""</span>
  (<span style="color: #a020f0;">interactive</span>)
  (mz/make-elfeed-hydra)
  (mz/hydra-elfeed/body))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-elfeed-tag-sort</span> (a b)
  (<span style="color: #a020f0;">let*</span> ((a-tags (format <span style="color: #8b2252;">"%s"</span> (elfeed-entry-tags a)))
         (b-tags (format <span style="color: #8b2252;">"%s"</span> (elfeed-entry-tags b))))
    (<span style="color: #a020f0;">if</span> (string= a-tags b-tags)
        (&lt; (elfeed-entry-date b) (elfeed-entry-date a)))
    (string&lt; a-tags b-tags)))

(<span style="color: #a020f0;">setf</span> elfeed-search-sort-function #'my-elfeed-tag-sort)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:45076e41-f667-4616-ac16-bc2f98be461c" class="outline-3">
<h3 id="h:45076e41-f667-4616-ac16-bc2f98be461c">Hyperbole 超文本管理系统</h3>
<div class="outline-text-3" id="text-h:45076e41-f667-4616-ac16-bc2f98be461c">
<p>
<a href="https://www.gnu.org/software/hyperbole/">GNU Hyperbole</a> 是个 Emacs 的超文本管理系统。
</p>

<p>
在 Emacs 中使用 Hyperbole 可以极大地提升你管理信息和导航的效率。它是一个功能强大的超文本信息管理系统，通过直观的“按钮”机制，让你能快速创建链接、执行操作并跳转到各种资源。
</p>

<p>
GNU Hyperbole （发音为 Ga-new Hi-per-bo-lee），简称 Hyperbole，就像是超文本版的 Markdown。无论缓冲区处于何种模式，Hyperbole 都能自动识别数十种常见的预设模式，并能通过一个按键将其立即激活为超链接：电子邮件地址、URL、grep -n 输出、程序回溯、Emacs 按键序列、程序标识符、Texinfo 和 Info 交叉引用、Org 链接、Markdown 链接等等。您只需加载 Hyperbole，即可轻松实现文本的超链接功能，无需任何额外操作或复杂的格式设置。
</p>


<p>
Hyperbole是一款由五个核心组件组成的套件,包括按钮和智能键、联系人和文本查找器、屏幕控制、超文本大纲以及一个编程库。
</p>

<ul class="org-ul">
<li>官方手册：<a href="https://github.com/rswgnu/hyperbole/blob/master/man/hyperbole.html">https://github.com/rswgnu/hyperbole/blob/master/man/hyperbole.html</a></li>
<li>Git 仓库：
<ul class="org-ul">
<li>GitHub：<a href="https://github.com/rswgnu/hyperbole">https://github.com/rswgnu/hyperbole</a></li>
</ul></li>
</ul>


<p>
<b>安装</b>
</p>

<p>
<span class="underline">Package.el</span>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">package</span>)
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(add-to-list 'package-archives '("melpa". "https://melpa.org/packages/") t)</span>
(<span style="color: #a020f0;">setq</span> package-archives '((<span style="color: #8b2252;">"gnu"</span>    . <span style="color: #8b2252;">"https://mirrors.tuna.tsinghua.edu.cn/elpa/gnu/"</span>)
                         (<span style="color: #8b2252;">"nongnu"</span> . <span style="color: #8b2252;">"https://mirrors.tuna.tsinghua.edu.cn/elpa/nongnu/"</span>)
                         (<span style="color: #8b2252;">"melpa"</span>  . <span style="color: #8b2252;">"https://mirrors.tuna.tsinghua.edu.cn/elpa/melpa/"</span>)))
(package-initialize)
(<span style="color: #a020f0;">when</span> (not package-archive-contents)
  (package-refresh-contents))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">(package-install 'hyperbole)</span>
(<span style="color: #a020f0;">use-package</span> hyperbole
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind*</span> (<span style="color: #8b2252;">"M-RET"</span> . hkey-either)
  <span style="color: #483d8b;">:config</span>
  (hyperbole-mode 1))  <span style="color: #b22222;">; </span><span style="color: #b22222;">&#21551;&#29992; Hyperbole &#27169;&#24335;</span>
</pre>
</div>

<p>
<span class="underline">Straight</span>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(straight-use-package 'hyperbole)
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">hyperbole</span>)
</pre>
</div>

<p>
<span class="underline">Quelpa</span>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(package-install 'use-package)
(package-install 'quelpa-use-package)
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">quelpa-use-package</span>)
(<span style="color: #a020f0;">use-package</span> hyperbole <span style="color: #483d8b;">:quelpa</span> (hyperbole <span style="color: #483d8b;">:fetcher</span> github
                                          <span style="color: #483d8b;">:repo</span> <span style="color: #8b2252;">"rswgnu/hyperbole"</span>
                                          <span style="color: #483d8b;">:files</span> (<span style="color: #8b2252;">"*"</span>)
                                          : config '(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">hyperbole</span>)))
</pre>
</div>

<p>
<b>快捷键</b>
</p>

<ul class="org-ul">
<li>按键清单： <code>C-h h</code></li>
<li>Action Key(动作键)： <code>M-RET</code>  或 SHIFT-中键鼠标 或 Ecs-RET</li>
<li>Assist Key(辅助键)： <code>C-u M-RET</code></li>

<li><code>C-h h d d</code> 进入演示文档</li>

<li><code>C-h A</code> 动作键简介</li>
</ul>

<p>
<b>按钮类型&amp;文件</b>
</p>

<ul class="org-ul">
<li>{Implicit Buttons}：隐式按钮，最常用。自动定义的按钮，由布尔类型谓词识别，这些谓词与缓冲区中的文本匹配，然后执行相应操作</li>
<li>&lt;(Explicit Buttons)&gt;：显式按钮。一次创建一个，嵌入在特定文件中</li>
<li>&lt;(Global Buttons)&gt;：全局按钮。存储在个人按钮文件中，通过名称激活</li>
</ul>

<p>
所有按钮类别都可以调用任意操作，而不仅仅是链接到资源。  
</p>

<p>
按钮可以存储在任何类型的文本文件中，但为了方便访问经常使用的按钮组，Hyperbole 提供了两种按钮文件：
</p>
<ul class="org-ul">
<li>单个个人按钮文件 "~/.hyperb/HYPB"。将所有类似书签的按钮放在这里，可通过 {C-h h b p} 访问。</li>
<li>每个目录相同类型的文件，也命名为 HYPB，并可通过 {C-h h b d} 从目录中访问。</li>
</ul>

<p>
<b>隐式按钮</b>
</p>

<p>
一些常见示例：
</p>

<div class="org-src-container">
<pre class="src src-text">- &#36335;&#24452;&#21517;

"DEMO#Global Buttons:2"          - &#22823;&#32434;&#37096;&#20998;&#38170;&#28857; &amp; &#30456;&#23545;&#34892;&#21495;&#65292;&#24403;&#21069;&#30446;&#24405;&#19979;&#23384;&#22312;DEMO&#36825;&#20010;&#25991;&#20214;
"README.md#Hyperbole Components" - Markdown &#38170;&#28857;&#65292;&#20445;&#25345;&#31354;&#26684;&#19981;&#21464;
"${hyperb:dir}/HY-NEWS"          - Elisp &#25110;&#29615;&#22659;&#21464;&#37327;
"subr.el"                        - &#32534;&#36753; load-path &#20013;&#30340;&#20219;&#20309; Elisp &#24211;
"(hyperbole)action-key-modeline-function" - &#25163;&#20876;&#20449;&#24687;

- &#25353;&#38190;&#31995;&#21015;&#38544;&#24335;&#25353;&#38062;

{C-x 4 b scratch RET M-&lt;"&#25554;&#20837;&#20219;&#24847;&#25991;&#26412;&#12290;&#37027;&#24456;&#37239;&#65281;" RET RET M-&lt;}

- Shell Grep &#28040;&#24687;&#12289;&#22534;&#26632;&#36319;&#36394;&#12289;&#24110;&#21161;&#25163;&#20876; Apropos

{M-x shell RET grep SPC -n SPC gbut:label-list SPC *.el RET}  &#25191;&#34892; M-x shell&#36755;&#20837; grep -n gbut:labelt-list *.el
{M-x shell RET python SPC /tmp/stack.py RET}
{M-x shell RET apropos SPC windows RET}

{C-0 C-c @ emacs-lisp-mode RET 33 RET} &#22312;&#19968;&#20010;3x3&#30340;&#32593;&#26684;&#20013;&#26174;&#31034;9&#20010;&#26368;&#36817;&#26368;&#24120;&#29992;&#30340;Emacs Lisp&#32531;&#20914;&#21306;&#12290;
</pre>
</div>

<p>
操作按钮（隐式按钮的概括形式）
</p>

<p>
如果您熟悉Emacs Lisp并希望快速地将Lisp代码或Lisp变量转换成夸张的按钮，只需去掉任何外括号，并用&lt;尖括号&gt;将剩余的代码括起来。
</p>
<div class="org-src-container">
<pre class="src src-text">&lt;shell&gt;
- &#36339;&#36716;&#21040;shell&#32531;&#23384;&#21306;&#25110;&#26032;&#24314;&#19968;&#20010;shell&#32531;&#20914;&#21306;

&lt;fill-column&gt;
- &#22312;&#36855;&#20320;&#32531;&#20914;&#21306;&#26174;&#31034;&#21464;&#37327;&#20540;

&lt;find-file-other-window (expand-file-name "DEMO" hyperb:dir)&gt;
&lt;hpath:find "${hyperb:dir}/DEMO")&gt;
"${hyperb:dir}/DEMO"
- &#25191;&#34892; Lisp &#34920;&#36798;&#24335;&#12290; &#19978;&#38754;&#30340;&#19977;&#20010;&#22522;&#26412;&#19978;&#20570;&#21516;&#26679;&#30340;&#20107;&#24773;&#65292;&#26174;&#31034;&#25991;&#20214;&#12290;

</pre>
</div>

<p>
使用 <code>M-RET</code> 跳转到指定链接
</p>

<p>
创建隐式按钮： 直接写或 <code>C-h h i c</code> 创建并命名
</p>

<p>
<b>隐式按钮类型</b>
</p>
<table>


<colgroup>
<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Implicit Button Types</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">action</td>
<td class="org-left">annot-bib</td>
<td class="org-left">completion</td>
</tr>

<tr>
<td class="org-left">cscope</td>
<td class="org-left">ctags</td>
<td class="org-left">debbugs-gnu-mode</td>
</tr>

<tr>
<td class="org-left">debbugs-gnu-query</td>
<td class="org-left">debugger-source</td>
<td class="org-left">dir-summary</td>
</tr>

<tr>
<td class="org-left">doc-id</td>
<td class="org-left">elink</td>
<td class="org-left">elisp-compiler-msg</td>
</tr>

<tr>
<td class="org-left">etags</td>
<td class="org-left">git-commit-reference</td>
<td class="org-left">glink</td>
</tr>

<tr>
<td class="org-left">gnus-push-button</td>
<td class="org-left">grep-msg</td>
<td class="org-left">hyp-address</td>
</tr>

<tr>
<td class="org-left">hyp-source</td>
<td class="org-left">id-cflow</td>
<td class="org-left">ilink</td>
</tr>

<tr>
<td class="org-left">Info-node</td>
<td class="org-left">ipython-stack-frame</td>
<td class="org-left">kbd-key</td>
</tr>

<tr>
<td class="org-left">klink</td>
<td class="org-left">mail-address</td>
<td class="org-left">man-apropos</td>
</tr>

<tr>
<td class="org-left">markdown-internal-link</td>
<td class="org-left">org-link-outside-org-mode</td>
<td class="org-left">patch-msg</td>
</tr>

<tr>
<td class="org-left">pathname</td>
<td class="org-left">pathname-line-and-column</td>
<td class="org-left">rfc</td>
</tr>

<tr>
<td class="org-left">rfc-toc</td>
<td class="org-left">ripgrep-msg</td>
<td class="org-left">social-reference</td>
</tr>

<tr>
<td class="org-left">texinfo-ref</td>
<td class="org-left">text-toc</td>
<td class="org-left">www-url</td>
</tr>
</tbody>
</table>

<p>
隐式按钮类型存储在它们自己的名称空间“ibtypes::”中，所以请参阅“路径名”ibtype上的文档，使用 {C-h f ibtypes::pathname RET}
</p>

<p>
<b>显式按钮</b>
</p>

<p>
所有 &lt;(显式按钮)&gt; 看起来都一样。它们是通过 {C-h h e c} 单独创建的，这会提示输入按钮名称、动作类型及相关参数。
</p>

<p>
显式链接按钮可以通过将动作鼠标键从源缓冲区拖到引用窗口来创建。Hyperbole 会确定使用的链接类型，如果有多种可能性，它会提示你选择。
</p>

<p>
Action Types
</p>
<div class="org-src-container">
<pre class="src src-text">completion
annot-bib
www-url
debbugs-gnu-query
eval-elisp
display-boolean
exec-kbd-macro
display-variable
exec-window-cmd
hyp-request
function-in-buffer
hyp-source
exec-shell-cmd
hyp-config
kbd-key
link-to-Info-index-item
link-to-buffer-tmp
link-to-Info-node
link-to-directory
link-to-elisp-doc
link-to-bookmark
link-to-doc
link-to-file
link-to-gbut
link-to-kotl
link-to-rfc
link-to-ebut
link-to-file-line
link-to-ibut
link-to-mail
link-to-file-line-and-column
link-to-kcell
link-to-regexp-match
link-to-texinfo-node
link-to-string-match
link-to-web-search
org-link
text-toc
man-show
org-internal-link-target
rfc-too
org-radio-target
</pre>
</div>

<ul class="org-ul">
<li><p>
创建显式按钮：
</p>
<ul class="org-ul">
<li>方法1 <code>C-h h e c</code></li>
</ul>

<p>
如：按键名称new button，action类型 link-to-info-node，输入(hyperbole)Smart Keys，回车
</p></li>
</ul>

<div class="org-src-container">
<pre class="src src-text">&lt;(new button)&gt;
</pre>
</div>

<ul class="org-ul">
<li>方法2 鼠标选中文本拖拽到一个文档到位置</li>
</ul>

<ul class="org-ul">
<li>在按钮位置使用 <code>M-RET</code> 跳转到指定链接。</li>

<li>查看属性：在按钮位置，执行 <code>C-u M-RET</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-text">@loc&gt; "d:/tmp/a.org"

&lt;(new button)&gt;
  Display an Info node given by STRING.
If not found, try to display it as an Info index item.
STRING must be a string of the form "(filename)name" or
"filename.info#name".  During button creation, completion for both
filename and node names is available.  Filename may be given without
the .info suffix in the format with parentheses.

(fn STRING)
   variable-documentation: "The currently selected Hyperbole button.  Available to action routines."
   lbl-key:         "new_button"
   lbl-start:       226
   lbl-end:         240
   loc:             "d:/tmp/a.org"
   categ:           explicit
   actype:          link-to-Info-node
   args:            ("(hyperbole)Smart Keys")
   creator:         "Administrator@SKY-2001BMX"
   create-time:     #("Nov 25 00:35:41 &#20013;&#22269;&#26631;&#20934;&#26102;&#38388; 2025" 16 22 (charset chinese-gbk))
</pre>
</div>

<ul class="org-ul">
<li>删除按钮： <code>C-h h e d</code></li>
</ul>


<p>
隐式按钮通常只能点击，不能激活，因为它们没有名称。但有一种方法可以给隐式按钮命名。
附加到显示按钮的标签，就是它的名称。
</p>

<div class="org-src-container">
<pre class="src src-text">&lt;[&#26631;&#31614;&#21517;&#31216;]&gt; &#21518;&#38754;&#21487;&#20197;&#20351;&#29992;&#31561;&#21495;&#12289;&#20882;&#21495;&#12289;&#20943;&#21495;&#26469;&#20998;&#38548;&#38544;&#24335;&#25353;&#38062;
&lt;[demo]&gt; == "${hyperb:dir}/DEMO:123"
&lt;[demo]&gt; -- "${hyperb:dir}/DEMO"
&lt;[demo]&gt; ::: "${hyperb:dir}/DEMO"

&#25351;&#23450;&#26597;&#30475;&#22120;
&lt;[PDF
  Viewer]&gt; == "${hyperb:dir}/man/hyperbole.pdf"
</pre>
</div>

<p>
<b>全局按钮</b>
</p>

<p>
你个人的 Ibutton 文件中的所有显式或命名的隐式按钮都是全局按钮，可以通过名称使用 {C-h h g a} 激活。
</p>

<div class="org-src-container">
<pre class="src src-text">{C-u C-h h g c about-test RET &lt;hpath:find "${hyperb:dir}/HY-ABOUT")&gt; RET}
{C-h h g a about-test RET}
{C-h h g d about-test RET}
</pre>
</div>

<p>
<b>鼠标按键</b>
</p>

<div class="org-src-container">
<pre class="src src-text">- &#36890;&#36807;&#40736;&#26631;&#28608;&#27963;&#25991;&#26412;
  &#40736;&#26631;&#25805;&#20316;&#38190;&#65306;{Shift+Button2}
  &#36741;&#21161;&#40736;&#26631;&#38190;&#65306;{Shift+Button3}
- &#22914;&#26524;&#24076;&#26395;&#20351;&#29992; Button2 &#21644; Button3&#65288;&#19981;&#25353; Shift&#65289;&#65292;&#35831;&#23558;&#20197;&#19979;&#20869;&#23481;&#28155;&#21152;&#21040;&#24744;&#30340; Emacs &#21021;&#22987;&#21270;&#25991;&#20214;&#20013;&#65306;

  (eval-after-load "hyperbole" '(hmouse-add-unshitfted-smart-keys))
  &#25110;&#22312;&#21152;&#36733; Hyperbole &#21518;&#20132;&#20114;&#24335;&#25191;&#34892;&#65306;
  &lt;hmouse-add-unshifted-smart-keys&gt;
- &#22312; Hyperbole &#40736;&#26631;&#25353;&#38062;&#21644;&#20043;&#21069;&#30340;&#32465;&#23450;&#20043;&#38388;&#20999;&#25442;&#65306;

  {M-x hmouse-toggle-bindings RET}
</pre>
</div>

<p>
<b>鼠标拖动与 Treemacs</b>
</p>

<p>
<b>窗格与窗扇</b>
</p>

<p>
<b>查找菜单</b>
</p>

<ul class="org-ul">
<li>专业的网页搜索手动进行起来太困难，所以人们最终只是做一些效果不佳的普通搜索。</li>
<li>Hyperbole 的“查找”和“网页搜索”功能旨在更容易地将你与所需信息连接起来。</li>
<li>这不正是我们最初构建超文本的原因吗？</li>
</ul>

<p>
<code>C-h h f</code> 提示查找类型
</p>

<div class="org-src-container">
<pre class="src src-text">find&gt;  GrepFiles  LocateFiles  MatchFileBuffers  OccurHere  RemoveLines  SaveLines  Web/
&#36755;&#20837; w &#36827;&#20837;Web&#36873;&#39033;

Web&gt;  Amazon Bing Dictionary ducKduckgo Elisp Facebook Google gitHub Images Jump Maps RFCs StackOverflow Twitter Wikipedia Youtube
&#36755;&#20837; e &#34920;&#31034;Elisp

&#20250;&#25171;&#24320;&#27983;&#35272;&#22120;&#65292;https://www.google.com/search?q=info+filetype:el
</pre>
</div>

<p>
<b>大纲器</b>
</p>

<p>
Koutliner 是唯一一个具有动态多级节点编号（例如 1.4.3.2）以及每个节点的永久超链接锚点的 Emacs 大纲工具，同时还支持在超链接中包含的视图规格影响大纲视图。它非常适合待办事项列表、头脑风暴、需求文档或任何需要详细结构的内容。
</p>

<div class="org-src-container">
<pre class="src src-text">{C-x o C-h h k e}

&lt;EXAMPLE.kotl, 4=012 |bc1e&gt;
</pre>
</div>

<p>
&#x2013;
“可以把 Hyperbole 看作是一组原语，帮助你以所希望的方式组织和显示文本，就像 Emacs 大纲一样。使用它为你的个人按钮文件结构化各个部分，然后在每个部分添加适当的显式和隐式按钮。或者使用 Koutliner，这样你可以直接链接到自动编号的节点。或者在代码的评论中嵌入链接，让人们可以快速参考相关资料。”
</p>

<p>
<code>C-h h k</code>
</p>

<div class="org-src-container">
<pre class="src src-text">Kotl&gt;  All  Blanks  Create  Downto  Examp  Format/  Hide  Info  Kill  Link  Overvw  Show  Top  Vspec
&#36755;&#20837; e &#34920;&#31034;Examp &#26597;&#30475;&#20869;&#32622;&#31034;&#20363;

&#21333;&#20803;&#26684;&#25805;&#20316; 
- C-j &#22312;&#24403;&#21069;&#21333;&#20803;&#26684;&#21518;&#21019;&#24314;&#21516;&#32423;&#21333;&#20803;&#26684;
- C-u C-j &#21019;&#24314;&#24403;&#21069;&#21333;&#20803;&#26684;&#30340;&#23376;&#21333;&#20803;&#26684;
- C-c C-k &#21024;&#38500;&#24403;&#21069;&#21333;&#20803;&#26684;&#21450;&#20854;&#25972;&#20010;&#23376;&#26641;
- {C-c p} &#20250;&#23558;&#35813;&#21333;&#20803;&#26684;&#28155;&#21152;&#20026;&#24403;&#21069;&#21333;&#20803;&#26684;&#29238;&#21333;&#20803;&#26684;&#30340;&#21516;&#32423;&#21333;&#20803;&#26684;&#12290;

&#23618;&#32423;&#35843;&#25972;  
- TAB &#38477;&#20302;&#24403;&#21069;&#21333;&#20803;&#26684;&#65288;&#21450;&#20854;&#23376;&#26641;&#65289;&#30340;&#23618;&#32423;&#65288;Demote&#65289;
- M-TAB   &#25552;&#21319;&#24403;&#21069;&#21333;&#20803;&#26684;&#65288;&#21450;&#20854;&#23376;&#26641;&#65289;&#30340;&#23618;&#32423;&#65288;Promote&#65289;
- M-1 TAB &#23558;TAB/M-TAB&#38190;&#20999;&#25442;&#20026;&#25554;&#20837;&#21046;&#34920;&#31526;&#21151;&#33021;

&#20999;&#25442;&#32534;&#21495;&#30340;&#26174;&#31034;&#26684;&#24335;
- &#20999;&#25442;&#32534;&#21495;&#26684;&#24335;  C-c C-l ?   &#26174;&#31034;&#24182;&#36873;&#25321;&#19981;&#21516;&#30340;&#32534;&#21495;&#26684;&#24335;
- &#20462;&#25913;&#24403;&#21069;&#22823;&#32434;&#20998;&#38548;&#31526;   C-c M-l &#26356;&#25913;&#24403;&#21069;Koutline&#25991;&#20214;&#30340;&#20998;&#38548;&#31526;
- &#20462;&#25913;&#40664;&#35748;&#20998;&#38548;&#31526; C-u C-c M-l &#26356;&#25913;&#21019;&#24314;&#26032;&#22823;&#32434;&#26102;&#30340;&#40664;&#35748;&#20998;&#38548;&#31526;

{C-c C-v} &#20250;&#25552;&#31034;&#36755;&#20837;&#19968;&#20010;&#35270;&#22270;&#35268;&#26684;&#23383;&#31526;&#20018;&#65292;&#20854;&#20013;&#20197;&#19979;&#20195;&#30721;&#26159;&#26377;&#25928;&#30340;&#12290;&#35270;&#22270;&#35268;&#26684;&#20013;&#30340;&#20219;&#20309;&#26080;&#25928;&#23383;&#31526;&#37117;&#20250;&#34987;&#24573;&#30053;&#12290;&#22914; ben. &#30456;&#24403;&#20999;&#25442;&#32534;&#21495;&#26174;&#31034;&#26684;&#24335;

C-c C-v
ce &#19968;&#34892;&#26174;&#31034;
c2e &#20108;&#34892;&#26174;&#31034;
c2eb &#24674;&#22797;&#21407;&#26679;
</pre>
</div>

<p>
<b>HyRolo</b>
</p>

<p>
HyRolo 是一个易于使用但功能强大的联系人管理和记录查询工具（现在支持 BBDB 和 Google 联系人）。联系人可以分布在多个文件中，并且如果需要可以使用不同的格式。夸张按钮可以嵌入条目中，并从搜索匹配缓冲区中激活。HyRolo 文件是 Emacs 大纲，因此可以以标准方式快速折叠和重新组织。
</p>

<p>
{C-x 4 r}  即 C-h h r r
</p>

<div class="org-src-container">
<pre class="src src-text">T&#25240;&#21472;&#25152;&#26377;&#26465;&#30446;
q&#36864;&#20986;
</pre>
</div>

<p>
<b>HyControl &amp; Org模式</b>
</p>

<ul class="org-ul">
<li>快速控制窗口和框架</li>
</ul>

<p>
C-h h s
</p>
<div class="org-src-container">
<pre class="src src-text">Screen&gt;  FramesControl  WindowsControl
&#36755;&#20837;w&#36827;&#20837;&#31383;&#21475;&#27169;&#24335;&#65292;&#22914;&#25353;[]&#24038;&#21491;&#20998;&#38548;&#31383;&#21475;&#65292;q&#36864;&#20986;
</pre>
</div>
<div class="org-src-container">
<pre class="src src-text">

- &#31383;&#21475;&#32593;&#26684; - &#24555;&#36895;&#22810;&#31383;&#21475;&#24067;&#23616;  

{C-u 0 M-x hycontrol-windows-grid RET python-mode RET 23 RET}  

- &#36890;&#36807;&#25353;&#38190;&#24207;&#21015;&#30340;&#38544;&#24335;&#25353;&#38062;&#36827;&#34892;&#33050;&#26412;&#21270;  

- &#20026;&#21333;&#20010;&#31383;&#21475;&#25110;&#26694;&#26550;&#26356;&#25913;&#30028;&#38754;&#22823;&#23567;&#30340;&#26368;&#24555;&#26041;&#27861;
</pre>
</div>
</div>
</div>
</section>
<section id="outline-container-h:b7fd23b6-e4f6-40b2-a626-b402646745c6" class="outline-2">
<h2 id="h:b7fd23b6-e4f6-40b2-a626-b402646745c6">插件-外观主题</h2>
<div class="outline-text-2" id="text-h:b7fd23b6-e4f6-40b2-a626-b402646745c6">
<p>
外观类：配置颜色、主题、屏保等。
</p>
</div>
<div id="outline-container-h:b488b90d-b246-4980-b6b5-d249f2001b48" class="outline-3">
<h3 id="h:b488b90d-b246-4980-b6b5-d249f2001b48">modeline 增强</h3>
<div class="outline-text-3" id="text-h:b488b90d-b246-4980-b6b5-d249f2001b48">
</div>
<div id="outline-container-h:0a2569bd-3126-417c-8886-98ab2b1602a7" class="outline-4">
<h4 id="h:0a2569bd-3126-417c-8886-98ab2b1602a7">simple</h4>
<div class="outline-text-4" id="text-h:0a2569bd-3126-417c-8886-98ab2b1602a7">
<p>
在modeline里显示行号、列号以及当前文本的大小
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">modeline&#19978;&#26174;&#31034;&#25991;&#20214;&#22823;&#23567;&#12289; &#21015;&#21495;</span>
(<span style="color: #a020f0;">use-package</span> simple
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:hook</span> (after-init . size-indication-mode)
  <span style="color: #483d8b;">:init</span>
  (<span style="color: #a020f0;">setq</span> column-number-mode t))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:69a8c85e-9645-4ca7-a282-de4a4858abef" class="outline-4">
<h4 id="h:69a8c85e-9645-4ca7-a282-de4a4858abef">doom-modeline</h4>
<div class="outline-text-4" id="text-h:69a8c85e-9645-4ca7-a282-de4a4858abef">
<p>
好看的modeline
</p>
<ul class="org-ul">
<li>doom-modeline <a href="#h:69a8c85e-9645-4ca7-a282-de4a4858abef">doom-modeline</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:9014e687-3c8e-4d46-a316-bb3543f7963a" class="outline-4">
<h4 id="h:9014e687-3c8e-4d46-a316-bb3543f7963a">更换主题</h4>
<div class="outline-text-4" id="text-h:9014e687-3c8e-4d46-a316-bb3543f7963a">
</div>
<div id="outline-container-h:5d366512-d2b0-4adb-b20b-183555cb25c9" class="outline-5">
<h5 id="h:5d366512-d2b0-4adb-b20b-183555cb25c9">customize theme 内置主题</h5>
<div class="outline-text-5" id="text-h:5d366512-d2b0-4adb-b20b-183555cb25c9">
<p>
自带的主题颜色，可以使用 <code>M-x customize themes</code> 图形化来选择，或者使用命令 <code>load-theme 主题</code> 。如 <code>M-x load-theme light-blue</code>
</p>

<ul class="org-ul">
<li>leuven，我最喜欢的亮色主题之一了。其实它也有暗色主题，只是没有内置。</li>
<li>modus，应该是从Emacs 28开始内置的一款包含亮/暗色的主题。非常好，我很喜欢。暗色有的时候，我感觉眼睛有点累。</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(load-theme 'manoj-dark)
(load-theme 'leuven t)
(load-theme 'tango-dark)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:8c77c09b-7f63-4e29-b424-e8286278435f" class="outline-5">
<h5 id="h:8c77c09b-7f63-4e29-b424-e8286278435f">color-theme-sanityinc-tomorrow 主题插件</h5>
<div class="outline-text-5" id="text-h:8c77c09b-7f63-4e29-b424-e8286278435f">
<p>
参考 <a href="https://github.com/purcell/emacs.d/blob/dc8a9e3a0017f8df7ab5692909f4c75695bab5b2/lisp/init-themes.el">purcell/emacs.d</a> 配置
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> color-theme-sanityinc-tomorrow
   <span style="color: #483d8b;">:ensure</span> t )

<span style="color: #b22222;">;; </span><span style="color: #b22222;">Don't prompt to confirm theme safety. This avoids problems with</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">first-time startup on Emacs &gt; 26.3.</span>
(<span style="color: #a020f0;">setq</span> custom-safe-themes t)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">If you don't customize it, this is the theme you get.</span>
(<span style="color: #a020f0;">setq-default</span> custom-enabled-themes '(sanityinc-tomorrow-bright))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">Ensure that themes will be applied even if they have not been customized</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">reapply-themes</span> ()
  <span style="color: #8b2252;">"Forcibly load the themes listed in `</span><span style="color: #008b8b;">custom-enabled-themes</span><span style="color: #8b2252;">'."</span>
  (<span style="color: #a020f0;">dolist</span> (theme custom-enabled-themes)
    (<span style="color: #a020f0;">unless</span> (custom-theme-p theme)
      (load-theme theme)))
  (custom-set-variables `(custom-enabled-themes (<span style="color: #a020f0;">quote</span> ,custom-enabled-themes))))

(add-hook 'after-init-hook 'reapply-themes)


<span style="color: #b22222;">;; </span><span style="color: #b22222;">Toggle between light and dark</span>

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">light</span> ()
  <span style="color: #8b2252;">"Activate a light color theme."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">setq</span> custom-enabled-themes '(sanityinc-tomorrow-day))
  (reapply-themes))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">dark</span> ()
  <span style="color: #8b2252;">"Activate a dark color theme."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">setq</span> custom-enabled-themes '(sanityinc-tomorrow-bright))
  (reapply-themes))
</pre>
</div>

<p>
使用 light 和 dark 命令切换主题。
</p>
</div>
</div>
<div id="outline-container-h:45ff93fe-27b0-4396-a83c-9d39c51b1c31" class="outline-5">
<h5 id="h:45ff93fe-27b0-4396-a83c-9d39c51b1c31">zenburn-theme 主题插件</h5>
<div class="outline-text-5" id="text-h:45ff93fe-27b0-4396-a83c-9d39c51b1c31">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> zenburn-theme
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span> (load-theme 'zenburn t))
</pre>
</div>

<p>
<img src="./images/image-20210629233655815.png" alt="image-20210629233655815.png">]]
</p>
</div>
</div>
<div id="outline-container-h:3094ac2d-07c0-4cd6-9125-854f36ca839e" class="outline-5">
<h5 id="h:3094ac2d-07c0-4cd6-9125-854f36ca839e">monokai-theme 主题插件</h5>
<div class="outline-text-5" id="text-h:3094ac2d-07c0-4cd6-9125-854f36ca839e">
<ul class="org-ul">
<li>monokai-theme <a href="https://github.com/oneKelvinSmith/monokai-emacs/">https://github.com/oneKelvinSmith/monokai-emacs/</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">mypackages</span> '(
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">theme</span>
         monokai-theme
         ) <span style="color: #ff0000; font-weight: bold;">"Default packages"</span><span style="color: #ff0000; font-weight: bold;">)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#27599;&#27425;&#25171;&#24320;&#32534;&#36753;&#22120;&#26102;&#21152;&#36733;&#20027;&#39064;&#65292;       </span>
(add-to-list 'my/packages 'monokai-theme)
(load-theme 'monokai 1)
</pre>
</div>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25442;&#20027;&#39064;</span>
(<span style="color: #a020f0;">use-package</span> monokai-theme
  <span style="color: #483d8b;">:init</span> (load-theme 'monokai t) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#21021;&#22987;&#21270;&#21442;&#25968;</span>
  )
</pre>
</div>

<p>
<img src="./images/image-20210618155537852.png" alt="image-20210618155537852.png">]]
</p>
</div>
</div>
<div id="outline-container-h:b7d8b66b-436a-42bf-8823-c41866fc9794" class="outline-5">
<h5 id="h:b7d8b66b-436a-42bf-8823-c41866fc9794">doom-themes</h5>
<div class="outline-text-5" id="text-h:b7d8b66b-436a-42bf-8823-c41866fc9794">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> doom-themes
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (<span style="color: #a020f0;">if</span> (display-graphic-p)
      (load-theme 'doom-solarized-light)
    (load-theme 'doom-tomorrow-night)))

(<span style="color: #a020f0;">use-package</span> doom-modeline
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (<span style="color: #a020f0;">setq</span> doom-modeline-minor-modes t)
  <span style="color: #483d8b;">:custom-face</span>
  (mode-line ((t (<span style="color: #483d8b;">:height</span> 0.95))))
  (mode-line-inactive ((t (<span style="color: #483d8b;">:height</span> 0.95))))
  <span style="color: #483d8b;">:hook</span> (after-init . doom-modeline-mode))
</pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="outline-container-h:c1608212-7bcc-44eb-a2d7-874a0921eaf3" class="outline-2">
<h2 id="h:c1608212-7bcc-44eb-a2d7-874a0921eaf3">插件-有趣类</h2>
<div class="outline-text-2" id="text-h:c1608212-7bcc-44eb-a2d7-874a0921eaf3">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
有趣类：实用性不高但很有趣的插件
</p>
</div>
<div id="outline-container-h:76a8660e-5ef9-4b69-9d1c-725847bd069c" class="outline-3">
<h3 id="h:76a8660e-5ef9-4b69-9d1c-725847bd069c">教学辅助</h3>
<div class="outline-text-3" id="text-h:76a8660e-5ef9-4b69-9d1c-725847bd069c">
</div>
<div id="outline-container-h:7716bd23-ebc5-4739-af84-ba5d60c090a2" class="outline-4">
<h4 id="h:7716bd23-ebc5-4739-af84-ba5d60c090a2">keycast</h4>
<div class="outline-text-4" id="text-h:7716bd23-ebc5-4739-af84-ba5d60c090a2">
<p>
github: <a href="https://github.com/tarsius/keycast">https://github.com/tarsius/keycast</a>
</p>

<p>
显示键绑定和命令
</p>

<p>
软件包提供四种模式，用于显示当前命令及其按键或鼠标绑定。
</p>
<ul class="org-ul">
<li>keycast-mode-line-mode 在所选窗口底部的模式行中显示当前绑定。</li>
<li>keycast-header-line-mode 在所选窗口的顶部标题行中显示当前绑定。</li>
<li>keycast-tab-bar-mode 在所选框架顶部的标签栏中显示当前绑定。</li>
<li>keycast-log-mode 在专用窗口中显示最近绑定的列表。</li>
</ul>

<p>
激活
</p>
<ul class="org-ul">
<li><code>M-x keycast-mode</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">modeline&#19978;&#26174;&#31034;&#25105;&#30340;&#25152;&#26377;&#30340;&#25353;&#38190;&#21644;&#25191;&#34892;&#30340;&#21629;&#20196;</span>
(<span style="color: #a020f0;">use-package</span> keycast
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (add-to-list 'global-mode-string '(<span style="color: #8b2252;">""</span> keycast-mode-line <span style="color: #8b2252;">" "</span>))
  (keycast-mode-line-mode t))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:504f9b85-ac01-4aa7-a038-2c6d942f1821" class="outline-3">
<h3 id="h:504f9b85-ac01-4aa7-a038-2c6d942f1821">小功能包</h3>
<div class="outline-text-3" id="text-h:504f9b85-ac01-4aa7-a038-2c6d942f1821">
</div>
<div id="outline-container-h:f47fcad4-ad11-4f66-b7bf-abce3bcdcec7" class="outline-4">
<h4 id="h:f47fcad4-ad11-4f66-b7bf-abce3bcdcec7">beacon 滚动时闪烁光标插件</h4>
<div class="outline-text-4" id="text-h:f47fcad4-ad11-4f66-b7bf-abce3bcdcec7">
<ul class="org-ul">
<li>beacon <a href="https://github.com/Malabarba/beacon">https://github.com/Malabarba/beacon</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#27599;&#27425;&#28378;&#21160;&#26102;&#37117;&#20250;&#38378;&#28865;&#20809;&#26631;</span>
(<span style="color: #a020f0;">use-package</span> beacon
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (beacon-mode 1)
<span style="color: #b22222;">; </span><span style="color: #b22222;">this color looks good for the zenburn theme but not for the one</span>
  (<span style="color: #a020f0;">setq</span> beacon-color <span style="color: #8b2252;">"#666600"</span>))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:f6d29041-370a-4178-af4e-ae9cde9d641d" class="outline-3">
<h3 id="h:f6d29041-370a-4178-af4e-ae9cde9d641d">画图</h3>
<div class="outline-text-3" id="text-h:f6d29041-370a-4178-af4e-ae9cde9d641d">
</div>
<div id="outline-container-h:fe2bfc54-0aca-46f0-a37d-fffd91455d67" class="outline-4">
<h4 id="h:fe2bfc54-0aca-46f0-a37d-fffd91455d67">artist 画文本图内置包</h4>
<div class="outline-text-4" id="text-h:fe2bfc54-0aca-46f0-a37d-fffd91455d67">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
在artist-mode中，你可以使用鼠标或者键盘来画线(可以带箭头)、矩形、正方形、多边形、椭圆、圆和一些类似于水蒸气似的不规则图形，当然可以擦除，填出图形，还可以在其上写字。
</p>

<ul class="org-ul">
<li>进入artist-mode `M-x artist-mode`</li>

<li>离开artist-mode `M-x artist-mode-off`  或`C-c C-c`</li>

<li>mouse-2（鼠标中键）,shift mouse-2 弹出一个菜单，从菜单里你可以选择要使用左键画什么类型更改一些设定</li>

<li>mouse-1 ( 鼠标左键) , shift-mouse-1 绘制部分由鼠标左键完成，请参考绘制操作。</li>

<li>mouse-3 ( 鼠标右键) , shift mouse-3 mouse-3 删除鼠标下的一个字符 shift mouse-3 画出矩形框，删除框选所有字符</li>
</ul>

<p>
<b><b>绘制操作（鼠标左键）</b></b>
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">操作</td>
<td class="org-left">无shift</td>
<td class="org-left">shift</td>
</tr>

<tr>
<td class="org-left">----------</td>
<td class="org-left">------------------------------------------------------------</td>
<td class="org-left">------------------------------------------------------------</td>
</tr>

<tr>
<td class="org-left">pen</td>
<td class="org-left">单击，在鼠标点填充一个“填充符号”，默认为"."；</td>
<td class="org-left">单击，在鼠标点填充一个“o”；</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">按下左键，拖动，抬起，绘制填充符号组成的线</td>
<td class="org-left">按下左键，拖动，抬起，绘制一条从初始点到最终点的直线</td>
</tr>

<tr>
<td class="org-left">Line</td>
<td class="org-left">任意方向的线</td>
<td class="org-left">直线</td>
</tr>

<tr>
<td class="org-left">Rectangle</td>
<td class="org-left">矩形</td>
<td class="org-left">正方形</td>
</tr>

<tr>
<td class="org-left">Poly-line</td>
<td class="org-left">任意方向的多边形</td>
<td class="org-left">每条线都是直线的多边形</td>
</tr>

<tr>
<td class="org-left">Ellipses</td>
<td class="org-left">椭圆</td>
<td class="org-left">圆</td>
</tr>

<tr>
<td class="org-left">Text</td>
<td class="org-left">文本</td>
<td class="org-left">覆盖式文本</td>
</tr>

<tr>
<td class="org-left">Spray-can</td>
<td class="org-left">喷雾器</td>
<td class="org-left">设置喷雾器的大小</td>
</tr>

<tr>
<td class="org-left">Erase</td>
<td class="org-left">橡皮，擦掉一个字符</td>
<td class="org-left">擦掉矩形内字符</td>
</tr>

<tr>
<td class="org-left">Vaporize</td>
<td class="org-left">擦除一行</td>
<td class="org-left">擦除所有相连的行</td>
</tr>

<tr>
<td class="org-left">Cut</td>
<td class="org-left">剪切矩形</td>
<td class="org-left">剪切正方形</td>
</tr>

<tr>
<td class="org-left">copy</td>
<td class="org-left">复制矩形</td>
<td class="org-left">复制正方形</td>
</tr>

<tr>
<td class="org-left">paste</td>
<td class="org-left">粘贴</td>
<td class="org-left">粘贴</td>
</tr>

<tr>
<td class="org-left">Flood-fill</td>
<td class="org-left">填充工具，填充</td>
<td class="org-left">填充</td>
</tr>
</tbody>
</table>

<p>
范例： 画一个rectangle
</p>
<ul class="org-ul">
<li>C-c C-a C-o选择rectangle画笔</li>
<li>此时按下Ret, 然后鼠标开始移动(C-b C-n C-p C-f等cursor移送就好)</li>
<li>C-c C-a C-o切到text画笔(其实不选也可以)，然后输入想要输入的字符串</li>
<li>同理就可以绘制出backend1 backend2</li>
<li>C-c C-a C-o选择line 到线的中间位置按下RET，变成 +，开始走位，然后到结
尾，按下Ret,拐弯就是拐弯的地方按下RET</li>
</ul>

<p>
这个时候没有箭头等信息 可以先生成图片看看是啥样的,结束artist-mode然后首尾添加 怎么增加箭头呢？其实这里我不建议用命令或者啥的搞，如果基本就是 <code>&lt;,&gt;,^,v</code>
</p>

<pre class="example" id="org37268b9">

     +--------------+
  +--+              +----+
  |  |    nginx     |    |
  |  +--------------+    |
	    |		               |
	    v		               v
+----------+	+-----------+
|          |	|           |
| backend1 |  | backend2  |
+----------+	+-----------+
</pre>

<ol class="org-ol">
<li>artist-mode/picture-mode: 生成 ascii 图</li>
<li>ditaa: 根据ascii图生成图片</li>
<li>graphviz: 生成关系图</li>
<li>plantuml: 基于graphiz之上,生成uml图</li>
</ol>


<p>
参考帮助: C-h f artist-mode
</p>
<pre class="example" id="orgae91c94">
文档 切换艺术家模式。

这是一个次要模式。 如果以交互方式调用，请切换艺术家模式。 如果前缀参数为正，则启用该模式，如果为零或负，则禁用该模式。

如果从 Lisp 调用，则在 ARG 已切换时切换模式。 如果 ARG 为零、省略或为正数，则启用该模式。 如果 ARG 为负数，则禁用该模式。

要检查当前缓冲区中是否启用了次要模式，请评估艺术家模式。

当模式启用和禁用时都会调用该模式的钩子。

Artist 可让您使用鼠标和/或键盘绘制线条、正方形、矩形和多段线、椭圆形和圆形。

如何退出艺术家模式

  输入 M-x artist-mode-off 退出艺术家模式。


如何提交错误报告

  输入 M-x artist-submit-bug-report 以提交错误报告。


用鼠标绘图：

  mouse-2(鼠标中键)
   shift mouse-2 弹出一个菜单，您可以在其中选择使用 
         mouse-1 绘制的内容，并可以在其中进行一些设置（如下所述）。

  mouse-1(鼠标左键)
   shift mouse-1 绘制线条、矩形或多段线、擦除、剪切、复制
         或粘贴：

         操作               未Shift               Shift
         -------------------------------------------------- ------------
         pen(笔)           在点处填充字符 .      从最后一个点到新点的直线
         -------------------------------------------------- ------------
         Line(直线)        任意方向的直线        直线
         -------------------------------------------------- ------------
         Rectangle(长方形) 长方形                正方形
         -------------------------------------------------- ------------
         Poly-line(多段线) 任意方向的多段线      直多段线
         -------------------------------------------------- ------------
         Ellipses(椭圆)    椭圆                  圆形
         -------------------------------------------------- ------------
         Text(文本)        文本（see thru查看）  文本（overwrite覆盖）
         -------------------------------------------------- ------------
         Spray-can(喷雾罐) 喷雾罐                设置喷雾尺寸
         -------------------------------------------------- ------------
         Erase(擦除)       擦除字符              擦除矩形
         -------------------------------------------------- ------------
         Vaporize(蒸发)    擦除单线              擦除已连接线
         -------------------------------------------------- ------------
         Cut(剪切)         剪切矩形              剪切正方形
         -------------------------------------------------- ------------
         Copy(复制)        复制矩形              复制正方形
         -------------------------------------------------- ------------
         Paste(粘贴)       粘贴                  粘贴
         -------------------------------------------------- ------------
         Flood-fill(填充)  填充                  填充
         -------------------------------------------------- ------------

         * 直线只能水平、垂直或对角线。

         * 按住 mouse-1 时绘制 Poly-lens(多段线)。 当您释放按钮时，该点即被设置。 如果您希望线段是直的，请在按鼠标 1 按钮之前按住 Shift 键。 单击鼠标 2 或鼠标 3 停止绘制多段线。

         * See thru for text 意味着缓冲区中已经存在的文本将通过渲染文本中的空白可见，而 overwrite 则相反。

         * Vaporize(汽化)连接的线路仅汽化 _端点_ 已连接的线路。 另请参见变量 artist-vaporize-fuzziness。

         * Cut(剪切)副本，然后清除矩形/正方形。

         * 绘制直线或多段线时，可以设置箭头。
           有关详细信息，请参阅下面的“箭头”。


         * 模式栏显示当前选择的绘图操作。 此外，如果末尾有一个星号 (*)，则表明您当前正在绘制某些内容。

         * Flood-fill(填充)时要有耐心 —— 大面积区域需要相当长的时间才能被填充。

  mouse-3(鼠标右键) 删除指针下的字符
   shift mouse-3 擦除矩形


设置

   Set fill(设置填充) 设置填充矩形/正方形时使用的字符

   Set line(设置线条) 设置绘制线条时使用的字符

   Erase char(擦除字符) 设置擦除时使用的字符

   Rubber-banding(橡皮筋) 切换橡皮筋

   Trimming(修剪) 切换行尾的修剪（即：绘制形状时，删除行尾处的无关空白）

   Borders(边框) 切换填充形状周围线条边框的绘制


用键绘图

  M-x artist-key-set-point 执行以下操作之一：

         对于直线/矩形/正方形：设置第一个/第二个端点

                 对于多段线：设置一个点（使用 C-u M-x artist-key-set-point 设置最后一个点）

         擦除字符时：切换erasing(擦除)

         剪切/复制时：设置矩形/正方形的第一个/最后一个端点

         粘贴时：Pastes(粘贴)

  M-x artist-select-operation 选择要绘制的内容

  使用 M-x artist-next-line、M-x artist-previous-line、M-x artist-forward-char 和 M-x artist-backward-char 进行移动。

  M-x artist-select-fill-char         设置填充时使用的字符
  M-x artist-select-line-char         设置绘图时使用的字符
  M-x artist-select-erase-char        设置擦除时使用的字符
  M-x artist-toggle-rubber-banding    切换橡皮筋
  M-x artist-toggle-trim-line-endings 切换行结尾的修剪
  M-x artist-toggle-borderless-shapes 切换绘制形状的边框


箭头

   M-x artist-toggle-first-arrow  设置/取消设置线条/折线开头的箭头

   M-x artist-toggle-second-arrow 设置/取消设置线条/多段线末端的箭头


选择操作

  有一些快速选择绘图操作的按键：

   M-x artist-select-op-line               选择绘图线
   M-x artist-select-op-straight-line      选择绘制直线
   M-x artist-select-op-rectangle          选择绘图矩形
   M-x artist-select-op-square             选择绘图方块
   M-x artist-select-op-poly-line          选择绘制多段线
   M-x artist-select-op-straight-poly-line 选择绘制直折线
   M-x artist-select-op-ellipse            选择绘图椭圆
   M-x artist-select-op-circle             选择绘制圆圈
   M-x artist-select-op-text-see-thru      选择渲染文本（see thru）
   M-x artist-select-op-text-overwrite     选择渲染文本（覆盖）
   M-x artist-select-op-spray-can          用喷雾罐喷雾
   M-x artist-select-op-spray-set-size     设置喷雾罐尺寸
   M-x artist-select-op-erase-char         选择擦除字符
   M-x artist-select-op-erase-rectangle    选择擦除矩形
   M-x artist-select-op-vaporize-line      选择蒸发单线
   M-x artist-select-op-vaporize-lines     选择蒸发连接线
   M-x artist-select-op-cut-rectangle      选择剪切矩形
   M-x artist-select-op-copy-rectangle     选择复制矩形
   M-x artist-select-op-paste              选择粘贴
   M-x artist-select-op-flood-fill         选择填充


变量

  这是不同变量的简要概述。 欲了解更多信息，
  请参阅变量的文档（类型 M-x describe-variable &lt;variable&gt; RET）。

  artist-rubber-banding                 是否交互式地进行橡皮筋
  artist-first-char                     在第一/第二点设置什么...
  artist-second-char                    ...当不使用橡皮筋时
  artist-interface-with-rect            应该剪切/复制/粘贴带有矩形的界面
  artist-arrows                         绘制箭头时使用的箭头
  artist-aspect-ratio                   方块的字符高度与宽度
  artist-trim-line-endings              修剪行尾
  artist-flood-fill-right-border        填充时的右边框
  artist-flood-fill-show-incrementally  填充时更新显示
  artist-pointer-shape                  绘图时使用的指针形状
  artist-ellipse-left-char              用于窄椭圆的字符
  artist-ellipse-right-char             用于窄椭圆的字符
  artist-borderless-shapes              形状是否应该有边框
  artist-picture-compatibility          图片模式兼容性打开或关闭
  artist-vaporize-fuzziness             识别线条时的公差
  artist-spray-interval                 重复喷涂之间的秒数
  artist-spray-radius                   喷涂区域的大小
  artist-spray-chars                    喷雾-“颜色”
  artist-spray-new-char                 初始喷雾-“颜色”

Hooks(钩子)

  打开或关闭模式会运行艺术家模式钩子。


键位图总结
  &lt;                 artist-toggle-first-arrow
  &lt;down-mouse-1&gt;    artist-down-mouse-1
  &lt;down-mouse-2&gt;    artist-mouse-choose-operation
  &lt;down-mouse-3&gt;    artist-down-mouse-3
  &lt;down&gt;            artist-next-line
  &lt;left&gt;            artist-backward-char
  &lt;right&gt;           artist-forward-char
  &lt;up&gt;              artist-previous-line
  &gt;                 artist-toggle-second-arrow
  C-&lt;mouse-4&gt;       artist-select-prev-op-in-list
  C-&lt;mouse-5&gt;       artist-select-next-op-in-list
  C-b               artist-backward-char
  C-c C-a C-b       artist-submit-bug-report
  C-c C-a C-d       artist-select-op-erase-char
  C-c C-a C-e       artist-select-erase-char
  C-c C-a C-f       artist-select-fill-char
  C-c C-a C-k       artist-select-op-cut-rectangle
  C-c C-a C-l       artist-select-line-char
  C-c C-a C-o       artist-select-operation
  C-c C-a C-r       artist-toggle-rubber-banding
  C-c C-a C-s       artist-toggle-borderless-shapes
  C-c C-a C-t       artist-toggle-trim-line-endings
  C-c C-a C-y       artist-select-op-paste
  C-c C-a E         artist-select-op-erase-rectangle
  C-c C-a L         artist-select-op-straight-line
  C-c C-a M-w       artist-select-op-copy-rectangle
  C-c C-a P         artist-select-op-straight-poly-line
  C-c C-a R         artist-select-op-square
  C-c C-a S         artist-select-op-spray-can
  C-c C-a T         artist-select-op-text-overwrite
  C-c C-a V         artist-select-op-vaporize-lines
  C-c C-a c         artist-select-op-circle
  C-c C-a e         artist-select-op-ellipse
  C-c C-a f         artist-select-op-flood-fill
  C-c C-a l         artist-select-op-line
  C-c C-a p         artist-select-op-poly-line
  C-c C-a r         artist-select-op-rectangle
  C-c C-a s         artist-select-op-square
  C-c C-a t         artist-select-op-text-see-thru
  C-c C-a v         artist-select-op-vaporize-line
  C-c C-a z         artist-select-op-spray-set-size
  C-c C-c           artist-mode-off
  C-f               artist-forward-char
  C-n               artist-next-line
  C-p               artist-previous-line
  RET               artist-key-set-point
  S-&lt;down-mouse-1&gt;  artist-down-mouse-1
  S-&lt;down-mouse-2&gt;  artist-mouse-choose-operation
  S-&lt;down-mouse-3&gt;  artist-down-mouse-3


按键绑定
该命令不在任何键盘映射中。
</pre>
</div>
</div>
<div id="outline-container-h:a424b9f2-9f05-452c-a18d-3f44a7fd407a" class="outline-4">
<h4 id="h:a424b9f2-9f05-452c-a18d-3f44a7fd407a">figlet 插件</h4>
<div class="outline-text-4" id="text-h:a424b9f2-9f05-452c-a18d-3f44a7fd407a">
<ul class="org-ul">
<li>figlet <a href="http://www.figlet.org/figlet-man.html">http://www.figlet.org/figlet-man.html</a></li>
</ul>

<p>
在一个窗口中写出ascii-art， yank到源码中作为注释。
</p>

<p>
提前在操作系统安装 figlet 命令
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">macOS</span>
brew install figlet

<span style="color: #b22222;"># </span><span style="color: #b22222;">ubuntu</span>
apt install figlet


<span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;</span>
figlet <span style="color: #8b2252;">"abc"</span>
figlet -f weird oh-my-zsh <span style="color: #b22222;"># </span><span style="color: #b22222;">-f&#21442;&#25968;&#24341;&#29992; &#23383;&#20307;</span>
figlet -f lean oh-my-zsh| tr <span style="color: #8b2252;">' _/'</span> <span style="color: #8b2252;">' ()'</span> <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20351;&#29992;tr&#21629;&#20196;&#26367;&#25442;&#20351;&#29992;&#30340;&#23383;&#31526;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">-c/-r/-l &#21442;&#25968;&#35774;&#32622;&#25991;&#23383;&#30340;&#23545;&#40784;&#26041;&#24335;&#65292;&#20998;&#21035;&#20026;-c center &#65292;-l left &#65292;-r right</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">-w int &#21442;&#25968;&#35774;&#32622;&#25991;&#23383;&#30340;&#26368;&#22823;&#23485;&#24230;</span>
</pre>
</div>

<p>
use-package
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> figlet
  <span style="color: #483d8b;">:ensure</span> t)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(package-install 'figlet)</span>
</pre>
</div>

<p>
使用 `M-x figlet` 输入字符串。
</p>
</div>
</div>
</div>
<div id="outline-container-h:b41e16e7-abc5-4263-8f27-8d447c46de3c" class="outline-3">
<h3 id="h:b41e16e7-abc5-4263-8f27-8d447c46de3c">pandoc 文本转换器</h3>
<div class="outline-text-3" id="text-h:b41e16e7-abc5-4263-8f27-8d447c46de3c">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
pandoc <a href="https://pandoc.org/">https://pandoc.org/</a>
</p>

<p>
pandoc支持多少文件格式的相互转换，基本满足日常需求。下面介绍简单的使用。
</p>

<p>
<code>.org</code> 文件可以很轻松的通过 <code>org-md-export-to-markdown</code> 生成 <code>.md</code> 文件。 <code>.md</code> 文件可以借助 Pandoc 生成 <code>.org</code>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#36873;&#39033;</span>
-f &lt;format&gt;, -r &lt;format&gt;   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25351;&#23450;&#36755;&#20837;&#25991;&#20214;&#26684;&#24335;&#65292;&#40664;&#35748;&#20026; Markdown&#65307;</span>
-t &lt;format&gt;, -w &lt;format&gt;   <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25351;&#23450;&#36755;&#20986;&#25991;&#20214;&#26684;&#24335;&#65292;&#40664;&#35748;&#20026; HTML&#65307;</span>
-o &lt;file&gt;                  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25351;&#23450;&#36755;&#20986;&#25991;&#20214;&#65292;&#35813;&#39033;&#32570;&#30465;&#26102;&#65292;&#23558;&#36755;&#20986;&#21040;&#26631;&#20934;&#36755;&#20986;&#65307;</span>
--highlight-style &lt;style&gt;  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#35774;&#32622;&#20195;&#30721;&#39640;&#20142;&#20027;&#39064;&#65292;&#40664;&#35748;&#20026; pygments&#65307;</span>
-s                         <span style="color: #b22222;">#</span><span style="color: #b22222;">&#29983;&#25104;&#26377;&#22836;&#23614;&#30340;&#29420;&#31435;&#25991;&#20214;&#65288;HTML&#65292;LaTeX&#65292;TEI &#25110; RTF&#65289;&#65307;</span>
-S                         <span style="color: #b22222;">#</span><span style="color: #b22222;">&#32874;&#26126;&#27169;&#24335;&#65292;&#26681;&#25454;&#25991;&#20214;&#21028;&#26029;&#20854;&#26684;&#24335;&#65307;</span>
--self-contained           <span style="color: #b22222;">#</span><span style="color: #b22222;">&#29983;&#25104;&#33258;&#21253;&#21547;&#30340;&#25991;&#20214;&#65292;&#20165;&#22312;&#36755;&#20986; HTML &#25991;&#26723;&#26102;&#26377;&#25928;&#65307;</span>
--verbose                  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24320;&#21551; Verbose &#27169;&#24335;&#65292;&#29992;&#20110; Debug&#65307;</span>
--list-input-formats       <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#25903;&#25345;&#30340;&#36755;&#20837;&#26684;&#24335;&#65307;</span>
--list-output-formats      <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#25903;&#25345;&#30340;&#36755;&#20986;&#26684;&#24335;&#65307;</span>
--list-extensions          <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#25903;&#25345;&#30340; Markdown &#25193;&#23637;&#26041;&#26696;&#65307;</span>
--list-highlight-languages <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#25903;&#25345;&#20195;&#30721;&#39640;&#20142;&#30340;&#32534;&#31243;&#35821;&#35328;&#65307;</span>
--list-highlight-styles    <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21015;&#20986;&#25903;&#25345;&#30340;&#20195;&#30721;&#39640;&#20142;&#20027;&#39064;&#65307;</span>
-v, --version              <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26174;&#31034;&#31243;&#24207;&#30340;&#29256;&#26412;&#21495;&#65307;</span>
-h, --help                 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26174;&#31034;&#31243;&#24207;&#30340;&#24110;&#21161;&#20449;&#24687;&#12290;</span>
--toc                      <span style="color: #b22222;">#</span><span style="color: #b22222;">&#29983;&#25104;&#30446;&#24405;</span>
</pre>
</div>


<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-shell">pandoc -f html -t org -o h.org h.html     <span style="color: #b22222;">#</span><span style="color: #b22222;">html &#36716; org</span>
pandoc -f markdown -t org -o a.org a.md   <span style="color: #b22222;">#</span><span style="color: #b22222;">markdown &#36716; org</span>
pandoc -f org -t markdown -o b.md b.org   <span style="color: #b22222;">#</span><span style="color: #b22222;">org &#36716; markdown</span>
</pre>
</div>
</div>
</div>
</section>
<section id="outline-container-h:25f5f221-bf9b-449d-b79d-b00488819071" class="outline-2">
<h2 id="h:25f5f221-bf9b-449d-b79d-b00488819071">插件整理</h2>
<div class="outline-text-2" id="text-h:25f5f221-bf9b-449d-b79d-b00488819071">
</div>
<div id="outline-container-h:b16c2928-0c0d-4a2d-858b-20163f0c6f8c" class="outline-3">
<h3 id="h:b16c2928-0c0d-4a2d-858b-20163f0c6f8c">dired 目录相关插件</h3>
<div class="outline-text-3" id="text-h:b16c2928-0c0d-4a2d-858b-20163f0c6f8c">
<p>
diredfl <a href="https://github.com/purcell/diredfl">https://github.com/purcell/diredfl</a>
</p>

<p>
这改编自 Drew Adams 的 dired+ 包提供的额外字体锁定规则，但通过现代方式发布，并删除了对旧 Emacsen 的支持。
</p>

<p>
`C-x d`
</p>



<p>
dired-recent <a href="https://github.com/vifon/dired-recent.el">https://github.com/vifon/dired-recent.el</a>
</p>

<p>
使用 Emacs 访问的路径的历史记录.
</p>

<p>
`C-x C-d` to select a previously visited directory to open
</p>



<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">dierd+&#39069;&#22806;&#29256;</span>
(<span style="color: #a020f0;">use-package</span> diredfl
<span style="color: #483d8b;">:ensure</span> t
<span style="color: #483d8b;">:config</span> 
(diredfl-global-mode 1))

(<span style="color: #a020f0;">setq</span> 
dired-listing-switches <span style="color: #8b2252;">"-lXGh --group-directories-first"</span>
dired-dwim-target t)
(add-hook 'dired-mode-hook 'dired-hide-details-mode)

<span style="color: #b22222;">;;</span><span style="color: #b22222;">A history of paths visited with Emacs dired.&#20351;&#29992; Emacs &#35775;&#38382;&#30340;&#36335;&#24452;&#30340;&#21382;&#21490;&#35760;&#24405;</span>
(<span style="color: #a020f0;">use-package</span> dired-recent
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (dired-recent-mode  1)
  )
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-dired-recent-dirs</span> ()
  <span style="color: #8b2252;">"Present a list of recently used directories and open the selected one in dired"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let</span> ((dir (ivy-read <span style="color: #8b2252;">"Directory: "</span>
                       dired-recent-directories
                       <span style="color: #483d8b;">:re-builder</span> #'ivy--regex
                       <span style="color: #483d8b;">:sort</span> nil
                       <span style="color: #483d8b;">:initial-input</span> nil)))
    (dired dir)))

(<span style="color: #a020f0;">setq</span> dired-guess-shell-alist-user '((<span style="color: #8b2252;">""</span> <span style="color: #8b2252;">"xdg-open"</span>)))
</pre>
</div>
</div>
<div id="outline-container-h:aa73cb3f-9efb-4998-86f7-344530eb68c7" class="outline-4">
<h4 id="h:aa73cb3f-9efb-4998-86f7-344530eb68c7">旧版dired插件</h4>
<div class="outline-text-4" id="text-h:aa73cb3f-9efb-4998-86f7-344530eb68c7">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">; </span><span style="color: #b22222;">wiki melpa problem</span>
<span style="color: #b22222;">;</span><span style="color: #b22222;">(use-package dired+</span>
<span style="color: #b22222;">;  </span><span style="color: #b22222;">:ensure t</span>
<span style="color: #b22222;">;  </span><span style="color: #b22222;">:config (require 'dired+)</span>
<span style="color: #b22222;">;  </span><span style="color: #b22222;">)</span>

(<span style="color: #a020f0;">setq</span> dired-dwim-target t)

(<span style="color: #a020f0;">use-package</span> dired-narrow
<span style="color: #483d8b;">:ensure</span> t
<span style="color: #483d8b;">:config</span>
(<span style="color: #a020f0;">bind-key</span> <span style="color: #8b2252;">"C-c C-n"</span> #'dired-narrow)
(<span style="color: #a020f0;">bind-key</span> <span style="color: #8b2252;">"C-c C-f"</span> #'dired-narrow-fuzzy)
(<span style="color: #a020f0;">bind-key</span> <span style="color: #8b2252;">"C-x C-N"</span> #'dired-narrow-regexp)
)

(<span style="color: #a020f0;">use-package</span> dired-subtree <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> dired
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">bind-key</span> <span style="color: #8b2252;">"&lt;tab&gt;"</span> #'dired-subtree-toggle dired-mode-map)
  (<span style="color: #a020f0;">bind-key</span> <span style="color: #8b2252;">"&lt;backtab&gt;"</span> #'dired-subtree-cycle dired-mode-map))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:da79e80e-8473-4df6-b5bc-76cb34c57418" class="outline-3">
<h3 id="h:da79e80e-8473-4df6-b5bc-76cb34c57418">pcre2el正则插件</h3>
<div class="outline-text-3" id="text-h:da79e80e-8473-4df6-b5bc-76cb34c57418">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li><a href="https://github.com/joddie/pcre2el">https://github.com/joddie/pcre2el</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> pcre2el
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span> 
  (pcre-mode)
  )
</pre>
</div>

<p>
在目录模式中使用`%m`开启正则匹配
</p>

<p>
`C-c / /` rxt-explain
</p>
</div>
</div>
<div id="outline-container-h:066bcbd8-3627-4128-aaf3-8c20e1772a6c" class="outline-3">
<h3 id="h:066bcbd8-3627-4128-aaf3-8c20e1772a6c">Atomic Chrome已弃用</h3>
<div class="outline-text-3" id="text-h:066bcbd8-3627-4128-aaf3-8c20e1772a6c">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> atomic-chrome
<span style="color: #483d8b;">:ensure</span> t
<span style="color: #483d8b;">:config</span> (atomic-chrome-start-server))
(<span style="color: #a020f0;">setq</span> atomic-chrome-buffer-open-style 'frame)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:786fa5ff-edba-4acb-a6c9-6ac231217b0e" class="outline-3">
<h3 id="h:786fa5ff-edba-4acb-a6c9-6ac231217b0e">自定义菜单插件</h3>
<div class="outline-text-3" id="text-h:786fa5ff-edba-4acb-a6c9-6ac231217b0e">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<p>
参考：<a href="http://xahlee.info/emacs/emacs/elisp_menu.html">http://xahlee.info/emacs/emacs/elisp_menu.html</a>
</p>

<div class="org-src-container">
<pre class="src src-shell">;; Creating a new menu pane<span style="color: #a020f0;"> in</span> the menu bar to the right of &#8220;Tools&#8221; menu
(define-key-after
  global-map
  [menu-bar mymenu]
  (cons <span style="color: #8b2252;">"MyMenu"</span> (make-sparse-keymap <span style="color: #8b2252;">"hoot hoot"</span>))
  <span style="color: #8b2252;">'tools )</span>

<span style="color: #8b2252;">;; Creating a menu item, under the menu by the id &#8220;[menu-bar mymenu]&#8221;</span>
<span style="color: #8b2252;">(define-key</span>
<span style="color: #8b2252;">  global-map</span>
<span style="color: #8b2252;">  [menu-bar mymenu co]</span>
<span style="color: #8b2252;">  '</span>(<span style="color: #8b2252;">"Clock Out"</span> . org-clock-out))

;; creating another menu item
(define-key
  global-map
  [menu-bar mymenu ci]
  <span style="color: #8b2252;">'("Clock In" . org-clock-in))</span>

<span style="color: #8b2252;">;; code to remove the whole menu panel</span>
<span style="color: #8b2252;">;; (global-unset-key [menu-bar mymenu])</span>
</pre>
</div>

<p>
<img src="./images/image-20211221053202213.png" alt="image-20211221053202213.png">]]
</p>
</div>
</div>
</section>
<section id="outline-container-h:6ed13efd-21da-4dd9-b227-449a8ebfc079" class="outline-2">
<h2 id="h:6ed13efd-21da-4dd9-b227-449a8ebfc079">插件-开发环境</h2>
<div class="outline-text-2" id="text-h:6ed13efd-21da-4dd9-b227-449a8ebfc079">
</div>
<div id="outline-container-h:ec846e9b-5edd-4130-badf-ea611b910d9c" class="outline-3">
<h3 id="h:ec846e9b-5edd-4130-badf-ea611b910d9c">编程辅助</h3>
<div class="outline-text-3" id="text-h:ec846e9b-5edd-4130-badf-ea611b910d9c">
</div>
<div id="outline-container-h:e72a8e09-4aaf-4854-8bca-e59e0c962557" class="outline-4">
<h4 id="h:e72a8e09-4aaf-4854-8bca-e59e0c962557">函数跳转与注释</h4>
<div class="outline-text-4" id="text-h:e72a8e09-4aaf-4854-8bca-e59e0c962557">
<p>
函数定义跳转 `M-.`  再使用`M-,`跳回原来位置
`M-;` 插入当前行注释
</p>
</div>
</div>
<div id="outline-container-h:204ed4b3-8ea4-495e-aeaa-94de64d687f5" class="outline-4">
<h4 id="h:204ed4b3-8ea4-495e-aeaa-94de64d687f5">Completion 自动补全</h4>
<div class="outline-text-4" id="text-h:204ed4b3-8ea4-495e-aeaa-94de64d687f5">
</div>
<div id="outline-container-h:a80eff87-e0fb-411d-8af7-89677a5c5fcf" class="outline-5">
<h5 id="h:a80eff87-e0fb-411d-8af7-89677a5c5fcf">基本的补全</h5>
<div class="outline-text-5" id="text-h:a80eff87-e0fb-411d-8af7-89677a5c5fcf">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20869;&#32622;&#34917;&#20840;&#21151;&#33021;</span>
(<span style="color: #a020f0;">setq</span> tab-always-indent 'complete)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20351;&#29992; TAB &#26469;&#21015;&#20986;&#24403;&#21069;&#34917;&#20840;&#36873;&#39033;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(icomplete-mode t)                   ;; &#24320;&#21551;&#30340;&#65292;&#22312;&#25353; M-x &#26102;&#23601;&#26377;&#21487;&#36873;&#30340;&#36873;&#39033;&#20102;&#12290;&#26377;&#20102; vertico-mode&#65292;&#21487;&#20197;&#25226;&#36825;&#39033;&#20851;&#25481;</span>
(electric-pair-mode t)               <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25324;&#21495;&#34917;&#20840;</span>
(show-paren-mode t)                  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25324;&#21495;&#21305;&#37197;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:8b6ae587-c4fc-4458-b258-9851adc8daad" class="outline-5">
<h5 id="h:8b6ae587-c4fc-4458-b258-9851adc8daad">auto-complete 补全插件</h5>
<div class="outline-text-5" id="text-h:8b6ae587-c4fc-4458-b258-9851adc8daad">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> auto-complete
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (<span style="color: #a020f0;">progn</span>
    (ac-config-default)
    (global-auto-complete-mode t)))
</pre>
</div>

<p>
<img src="./images/image-20210629193327680.png" alt="image-20210629193327680.png">]]
</p>

<p>
过时了，后面用company插件
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> company
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> company-idle-delay 0)
  (<span style="color: #a020f0;">setq</span> company-minimum-prefix-length 3)

  (global-company-mode t)
  )
</pre>
</div>
</div>
</div>
<div id="outline-container-h:4682a9d6-c356-4159-b100-1a986447d85b" class="outline-5">
<h5 id="h:4682a9d6-c356-4159-b100-1a986447d85b">Company 补全插件</h5>
<div class="outline-text-5" id="text-h:4682a9d6-c356-4159-b100-1a986447d85b">
<ul class="org-ul">
<li>Company 补全插件 <a href="http://company-mode.github.io/">http://company-mode.github.io/</a></li>
<li>Company是'complete anything'的意思，是一种 auto-complete 自动补全</li>
<li>支持各种后端 (back-ends): Elisp, clang, yasnippet&#x2026;</li>
<li>可以更改前端样式</li>
</ul>

<p>
安装
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">package-install company
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Auto-completion</span>
(global-company-mode 1)
(<span style="color: #a020f0;">setq</span> company-idle-delay 0)     <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#34917;&#20840;&#26102;&#38388;&#24555;&#20123;</span>
(<span style="color: #a020f0;">setq</span> company-minimum-prefix-length 3) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26368;&#23567;&#20960;&#20010;&#23383;&#31526;&#24320;&#22987;&#34917;&#20840;</span>
</pre>
</div>

<p>
我们可以使用下面的配置来在 Company-mode 中使用 <code>C-n</code> 与 <code>C-p</code> 来选择补全项，
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;  </span><span style="color: #b22222;">Company-mode &#20013;&#20351;&#29992; `C-n` &#19982; `C-p` &#26469;&#36873;&#25321;&#34917;&#20840;&#39033;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">company mode &#40664;&#35748;&#36873;&#25321;&#19978;&#19968;&#26465;&#21644;&#19979;&#19968;&#26465;&#20505;&#36873;&#39033;&#21629;&#20196; M-n M-p</span>
(<span style="color: #a020f0;">with-eval-after-load</span> 'company
  (define-key company-active-map (kbd <span style="color: #8b2252;">"M-n"</span>) nil)
  (define-key company-active-map (kbd <span style="color: #8b2252;">"M-p"</span>) nil)

  (define-key company-active-map (kbd <span style="color: #8b2252;">"C-n"</span>) #'company-select-next)
  (define-key company-active-map (kbd <span style="color: #8b2252;">"C-p"</span>) #'company-select-previous))
</pre>
</div>

<p>
use-package
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> company
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (global-company-mode t)                    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20840;&#23616;&#24320;&#21551; company &#34917;&#20840;</span>
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> company-idle-delay 0)                <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#34917;&#20840;&#26102;&#38388;&#24555;&#20123;</span>
  (<span style="color: #a020f0;">setq</span> company-minimum-prefix-length 1)     <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26368;&#23569;&#36755;&#20837;1&#20010;&#23383;&#31526;&#24320;&#21551;</span>
  (<span style="color: #a020f0;">setq</span> company-show-numbers t)              <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32473;&#36873;&#39033;&#32534;&#21495; (&#25353;&#24555;&#25463;&#38190; M-1&#12289;M-2 &#31561;&#31561;&#26469;&#36827;&#34892;&#36873;&#25321;)</span>
  (<span style="color: #a020f0;">setq</span> company-dabbrev-other-buffers 'all)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20174;&#25152;&#26377;&#32531;&#20914;&#21306;&#25910;&#38598;&#34917;&#20840;&#20449;&#24687;</span>
  (<span style="color: #a020f0;">setq</span> company-tooltip-align-annotations t) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21491;&#20391;&#38468;&#21152;&#27880;&#37322;</span>
  (<span style="color: #a020f0;">setq</span> company-selection-wrap-around t)
  (<span style="color: #a020f0;">setq</span> company-transformers '(company-sort-by-occurrence)) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#26681;&#25454;&#36873;&#25321;&#30340;&#39057;&#29575;&#36827;&#34892;&#25490;&#24207;&#65292;&#22914;&#26524;&#19981;&#21916;&#27426;&#21487;&#20197;&#21435;&#25481;</span>
  <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> company-active-map
              (<span style="color: #8b2252;">"C-n"</span> . 'company-select-next)
              (<span style="color: #8b2252;">"C-p"</span> . 'company-select-previous)))  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20351;&#29992; `C-n` &#19982; `C-p` &#26469;&#36873;&#25321;&#34917;&#20840;&#39033;&#65292;&#40664;&#35748;&#36873;&#25321;&#19978;&#19968;&#26465;&#21644;&#19979;&#19968;&#26465;&#20505;&#36873;&#39033;&#21629;&#20196; M-n M-p</span>
</pre>
</div>


<figure id="org06d1be8">
<img src="./images/image-20210704172507874.png" alt="image-20210704172507874.png">

</figure>
</div>
</div>
<div id="outline-container-h:92d4beba-812e-45d0-b60f-82ce52a1de87" class="outline-5">
<h5 id="h:92d4beba-812e-45d0-b60f-82ce52a1de87">缩写补全</h5>
<div class="outline-text-5" id="text-h:92d4beba-812e-45d0-b60f-82ce52a1de87">
<p>
使用下面的代码我们可以开启 `abbrev` 模式并定义一个缩写表，每当我们输入下面的缩写 并以空格结束时，Emacs 就会将其自动展开成为我们所需要的字符串。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21035;&#21517;</span>
(<span style="color: #a020f0;">setq-default</span> abbrev-mode t)
(define-abbrev-table 'global-abbrev-table '(
              <span style="color: #b22222;">;; </span><span style="color: #b22222;">signature</span>
              (<span style="color: #8b2252;">"8jv"</span> <span style="color: #8b2252;">"jaspervincent"</span>)
              <span style="color: #b22222;">;; </span><span style="color: #b22222;">Microsoft</span>
              (<span style="color: #8b2252;">"8ms"</span> <span style="color: #8b2252;">"Microsoft"</span>)
              ))
</pre>
</div>

<p>
上面的缩写前使用的 `8` 也类似于命名空间的作用，使其不会与我们所常用的字符串冲突。
</p>
</div>
</div>
<div id="outline-container-h:e69d7361-1893-4185-8dbe-60c1ff69908b" class="outline-5">
<h5 id="h:e69d7361-1893-4185-8dbe-60c1ff69908b">hippie-expand 补全</h5>
<div class="outline-text-5" id="text-h:e69d7361-1893-4185-8dbe-60c1ff69908b">
<p>
Emacs 还有一个非常实用的补全小功能 hippie。dabbbrev 与之功能相似，二者都是 Emacs 自带的功能。
</p>

<p>
Company 有时候补全功能并不是非常理想，这时就可以使用 Hippie Expand 来完成补全。 Company Mode 补全效果不理想的原因是在不同的区域中会使用不同的后端函数来完成补全， 但是当后端补全函数不能被激活时，则补全就不会被激活。
</p>

<p>
我们可以将下面的代码加入到我们的配置文件中，来增强 Hippie Expand 的功能，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #8b2252;">"M-/"</span>) 'hippie-expand)

(<span style="color: #a020f0;">setq</span> hippie-expand-try-function-list
      '(try-expand-debbrev
        try-expand-debbrev-all-buffers
        try-expand-debbrev-from-kill
        try-complete-file-name-partially
        try-complete-file-name
        try-expand-all-abbrevs
        try-expand-list
        try-expand-line
        try-complete-lisp-symbol-partially
        try-complete-lisp-symbol))
</pre>
</div>

<p>
然后将其绑定为快捷键，使我们可以更方便的使用它。默认 `M-/` 键就被绑定到了 dabbrev-expand 函数。
</p>

<p>
当我们输入几个字符前缀，然后按下 `M-/` 调用 hippie-expand 函数，它会根据前缀匹配后面的内容。不同于普通的代码补全，它的补全还包括了文件名、elisp 函数名等。它的补全规则不包含语法分析，而是纯文本补全，很适用于我们写一些重复性的相似代码/其它文本的场合。
</p>
</div>
</div>
<div id="outline-container-h:93e27e60-418a-42ca-8f0e-c9506b4681e1" class="outline-5">
<h5 id="h:93e27e60-418a-42ca-8f0e-c9506b4681e1">补全完善</h5>
<div class="outline-text-5" id="text-h:93e27e60-418a-42ca-8f0e-c9506b4681e1">
<p>
不补全'单引号
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36755;&#20837;'&#24341;&#21495;&#19981;&#20250;&#20877;&#34917;&#20840;&#21478;&#19968;&#20010;  emacs 27.2 &#19981;&#29983;&#25928;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(sp-local-pair 'emacs-lisp-mode "'" nil :actions nil)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(sp-local-pair 'lisp-interaction-mode "'" nil :actions nil)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20063;&#21487;&#20197;&#25226;&#19978;&#38754;&#20004;&#21477;&#21512;&#36215;&#26469;</span>
(sp-local-pair '(emacs-lisp-mode lisp-interaction-mode) <span style="color: #8b2252;">"'"</span> nil <span style="color: #483d8b;">:actions</span> nil)
<span style="color: #b22222;">;;  </span><span style="color: #b22222;">&#21333;&#24341;&#21495;</span>
(sp-local-pair 'lisp-interaction-mode <span style="color: #8b2252;">"'"</span> nil <span style="color: #483d8b;">:actions</span> nil)
</pre>
</div>

<p>
`show-paren-mode` 可以使鼠标在括号上是高亮其所匹配的另一半括号，然而我们想要光标 在括号内时就高亮包含内容的两个括号，使用下面的代码就可以做到这一点。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25324;&#21495;&#20869;&#25324;&#21495;&#39640;&#20142;</span>
(<span style="color: #a020f0;">define-advice</span> <span style="color: #0000ff;">show-paren-function</span> (<span style="color: #483d8b;">:around</span> (fn) fix-show-paren-function)
  <span style="color: #8b2252;">"Highlight enclosing parens."</span>
  (<span style="color: #a020f0;">cond</span> ((looking-at-p <span style="color: #8b2252;">"\\s("</span>) (funcall fn))
  (t (<span style="color: #a020f0;">save-excursion</span>
       (<span style="color: #a020f0;">ignore-errors</span> (backward-up-list))
       (funcall fn)))))
</pre>
</div>

<p>
Lisp 的宏（Macro）类似于 C++ 中的模板，并可以生产新的代码（你可以在<a href="http://stackoverflow.com/questions/267862/what-makes-lisp-macros-so-special">这里</a>找到更多 关于宏的讨论）。使用它，我们可以增强某个函数的功能而不去更改这个函数的代码。
</p>

<p>
还有一个小问题就是解决在不同系统中的换行符，例如在 DOS 系统下的 `\r(^M)` 换行符， 这让我们有时候在 Unix 系统中很是头疼，因为它的存在会使版本控制误以为整行的代码都 被修改过而造成不必要的麻烦。（你可以在<a href="http://unix.stackexchange.com/questions/32001/what-is-m-and-how-do-i-get-rid-of-it">这里</a>找到更多关于 `\r(^M)` 的信息）
</p>

<p>
我们用两种方式来处理这个问题，隐藏这个换行符或者将其删除。首先下面是隐藏的方法，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#38544;&#34255;&#25442;&#34892;&#31526;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">hidden-dos-eol</span> ()
  <span style="color: #8b2252;">"Do not show ^M in files containing mixed UNIX and DOS line endings."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">unless</span> buffer-display-table
    (<span style="color: #a020f0;">setq</span> buffer-display-table (make-display-table)))
  (aset buffer-display-table ?\^M []))
</pre>
</div>

<p>
使用下面的代码则可以定义函数将此换行符删除，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21024;&#38500;dos&#25442;&#34892;&#31526;/r</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">remove-dos-eol</span> ()
  <span style="color: #8b2252;">"Replace DOS eolns CR LF with Unix eolns CR"</span>
  (<span style="color: #a020f0;">interactive</span>)
  (goto-char (point-min))
  (<span style="color: #a020f0;">while</span> (search-forward <span style="color: #8b2252;">"\r"</span> nil t) (replace-match <span style="color: #8b2252;">""</span>)))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:eae1a7d1-d933-4ec2-b5b1-1ff83e3e5753" class="outline-4">
<h4 id="h:eae1a7d1-d933-4ec2-b5b1-1ff83e3e5753">Syntax Checking 语法检查</h4>
<div class="outline-text-4" id="text-h:eae1a7d1-d933-4ec2-b5b1-1ff83e3e5753">
<p>
默认 Emacs 自带了flymake，但flycheck是一个更优的方案。
</p>

<p>
语法检查器可以在开发动态语言（Interpreted/Dynamic Programming Language）时极大的 提高你的开发效率，它会实时的检查你的代码并将句法错误（Syntax Error）与静态语义 （Static Semantic Error）错误进行高亮与提示。
</p>

<ul class="org-ul">
<li>eslint JavaScript 的语法检查器  <a href="https://github.com/eslint/eslint">https://github.com/eslint/eslint</a></li>
<li>flycheck-mode 语法检查器 <a href="https://github.com/flycheck/flycheck">https://github.com/flycheck/flycheck</a></li>
</ul>
</div>
<div id="outline-container-h:f0cb2f15-2af7-4070-908e-774c58a5a081" class="outline-5">
<h5 id="h:f0cb2f15-2af7-4070-908e-774c58a5a081">flycheck 语法检查插件</h5>
<div class="outline-text-5" id="text-h:f0cb2f15-2af7-4070-908e-774c58a5a081">
<p>
flycheck 是一个对接 Emacs 和语法检查程序（也就是 linting）的插件。官网提供的方案是全局开启 flycheck
</p>

<p>
use-package
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> flycheck
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span> (global-flycheck-mode))
</pre>
</div>

<p>
我们可以使用 hook 来指定什么情况下启动 flycheck，例如只在编程时使用：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> flycheck
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:hook</span>
  (prog-mode . flycheck-mode))
</pre>
</div>

<p>
如果你只想在编程语言的模式下启用：
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'js2-mode-hook 'flycheck-mode) <span style="color: #b22222;">;; </span><span style="color: #b22222;">js&#25991;&#20214;&#35821;&#27861;&#26816;&#26597;</span>
(add-hook 'python-mode-hook 'flycheck-mode)
</pre>
</div>

<p>
那么，flycheck已就绪，特定语言的语法检查程序要如何安装呢？flycheck 的主页上已为你列好<a href="https://www.flycheck.org/en/latest/languages.html#flycheck-languages">各种编程语言对应的语法检查程序列表</a>，其中包含了相应的链接。
</p>

<p>
例如，写 Python 的话，我们可以使用 <a href="https://flake8.pycqa.org/en/latest/">python-flake8</a> 或者 <a href="https://pylint.org/">pylint</a>。 例如使用 pylint 的话，在 Ubuntu 上可以用 apt 进行安装，在 macOS、Windows 上可以用 pip 来进行安装。
</p>

<p>
编译型语言通常安装好编译器即可使用。例如 C/C++、Rust 安装好 gcc/clang、rustc 就可以了。
</p>


<p>
快捷键使用
</p>
<ul class="org-ul">
<li>查看后端： `C-c !v`</li>
<li>查看目前有问题语法： `C-c !l`</li>
</ul>

<p>
<img src="./images/image-20210722061405854.png" alt="image-20210722061405854.png">]]
</p>

<p>
打开一个py文件时，我们点一下tools &#x2013;&gt; syntax checking &#x2013;&gt; select syntax checker 可以看到针对对应语言的语法检查
</p>

<p>
如test.c代码
</p>

<div class="org-src-container">
<pre class="src src-shell">include &lt;stdio.h&gt;
<span style="color: #b22222;">#</span><span style="color: #b22222;">include &lt;stlib.h"</span>

int main() {
  <span style="color: #483d8b;">printf</span>(<span style="color: #8b2252;">"Hello\n"</span>)
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:ce07a33e-4709-4681-92fb-9732a0220781" class="outline-4">
<h4 id="h:ce07a33e-4709-4681-92fb-9732a0220781">Format (style, highlight, indent )</h4>
<div class="outline-text-4" id="text-h:ce07a33e-4709-4681-92fb-9732a0220781">
</div>
</div>
<div id="outline-container-h:4d68d59b-bc15-41e6-bbca-2b21aa121246" class="outline-4">
<h4 id="h:4d68d59b-bc15-41e6-bbca-2b21aa121246">Navigation 导航</h4>
<div class="outline-text-4" id="text-h:4d68d59b-bc15-41e6-bbca-2b21aa121246">
<ul class="org-ul">
<li>Navigation (tag, definition, symbols)</li>
</ul>
</div>
<div id="outline-container-h:3a90c273-103e-43b2-9884-a6584187b642" class="outline-5">
<h5 id="h:3a90c273-103e-43b2-9884-a6584187b642">dumb-jump跳转到定义插件</h5>
<div class="outline-text-5" id="text-h:3a90c273-103e-43b2-9884-a6584187b642">
<ul class="org-ul">
<li>dumb-jump <a href="https://github.com/jacktasia/dumb-jump">https://github.com/jacktasia/dumb-jump</a></li>
</ul>

<p>
是一个 Emacs“跳转到定义”包，支持 50 多种编程语言
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> dumb-jump
  <span style="color: #483d8b;">:bind</span> ((<span style="color: #8b2252;">"M-g o"</span> . dumb-jump-go-other-window)
         (<span style="color: #8b2252;">"M-g j"</span> . dumb-jump-go)
         (<span style="color: #8b2252;">"M-g x"</span> . dumb-jump-go-prefer-external)
         (<span style="color: #8b2252;">"M-g z"</span> . dumb-jump-go-prefer-external-other-window))
  <span style="color: #483d8b;">:config</span> 
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq dumb-jump-selector 'ivy) ;; (setq dumb-jump-selector 'helm)</span>
  <span style="color: #483d8b;">:init</span>
  (dumb-jump-mode)
  <span style="color: #483d8b;">:ensure</span>
  )
</pre>
</div>

<p>
系统上安装ag搜索工具性能最好。
</p>
</div>
</div>
</div>
<div id="outline-container-h:763bc375-0e56-4aca-99ab-c8a191bca30d" class="outline-4">
<h4 id="h:763bc375-0e56-4aca-99ab-c8a191bca30d">Code Templates &amp; Snippets 代码模板和片段</h4>
<div class="outline-text-4" id="text-h:763bc375-0e56-4aca-99ab-c8a191bca30d">
<ul class="org-ul">
<li>Code Templates &amp; Snippets : yasnippet</li>
</ul>
</div>
<div id="outline-container-h:343d2423-685d-4a96-b9e9-ec9d6927c66d" class="outline-5">
<h5 id="h:343d2423-685d-4a96-b9e9-ec9d6927c66d">yasnippet代码片段模板</h5>
<div class="outline-text-5" id="text-h:343d2423-685d-4a96-b9e9-ec9d6927c66d">
<p>
`yasnippet` 是一个代码块补全的插件（<a href="https://github.com/capitaomorte/yasnippet">GitHub</a> 地址）。只要打key就会写入代码片段
</p>

<ul class="org-ul">
<li>可以下载别人写好的代码片段</li>
<li>可以自定义代码片段</li>
<li>不同主模式带不同的代码片段</li>
</ul>

<p>
使用下面的配置文件将其在所有 的编程语言的模式中激活。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my/packages</span> '(
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20195;&#30721;&#22359;&#34917;&#20840;</span>
         yasnippet
         ) <span style="color: #ff0000; font-weight: bold;">"Default packages"</span><span style="color: #ff0000; font-weight: bold;">)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">yasnippet &#20195;&#30721;&#22359;&#34917;&#20840;</span>
(yas-reload-all)
(add-hook 'prog-mode-hook #'yas-minor-mode)
</pre>
</div>

<p>
自定义代码块的方法可以在上面提供的链接中找到。
</p>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> yasnippet
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:diminish</span> yas-minor-mode
  <span style="color: #483d8b;">:hook</span> (after-init . yas-global-mode))

(<span style="color: #a020f0;">use-package</span> yasnippet-snippets
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> yasnippet)

</pre>
</div>

<p>
复杂点的
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Settings for yasnippet</span>
(<span style="color: #a020f0;">use-package</span> yasnippet
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:diminish</span> yas-minor-mode
  <span style="color: #483d8b;">:hook</span> (after-init . yas-global-mode)
  <span style="color: #483d8b;">:config</span>
  (add-to-list 'yas-snippet-dirs (concat
                          (file-name-directory user-emacs-directory)
                          <span style="color: #8b2252;">"snippets"</span>))
  (<span style="color: #a020f0;">use-package</span> yasnippet-snippets  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#19979;&#36733;&#19968;&#20123;&#36164;&#28304;&#22871;&#20214;</span>
    <span style="color: #483d8b;">:after</span> yasnippet
    <span style="color: #483d8b;">:ensure</span> t)

  (<span style="color: #a020f0;">use-package</span> auto-yasnippet
    <span style="color: #483d8b;">:ensure</span> t
    <span style="color: #483d8b;">:bind</span> ((<span style="color: #8b2252;">"C-o"</span> . aya-open-line)
           (<span style="color: #8b2252;">"H-w"</span> . aya-create)
           (<span style="color: #8b2252;">"H-y"</span> . aya-expand))))
</pre>
</div>


<p>
其它
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> yasnippet
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (yas-reload-all)
  <span style="color: #483d8b;">:hook</span>
  (prog-mode . yas-minor-mode)
  <span style="color: #483d8b;">:config</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">add company-yasnippet to company-backends</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">company-mode/backend-with-yas</span> (backend)
    (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">and</span> (listp backend) (member 'company-yasnippet backend))
        backend
      (append (<span style="color: #a020f0;">if</span> (consp backend) backend (list backend))
              '(<span style="color: #483d8b;">:with</span> company-yasnippet))))
  (<span style="color: #a020f0;">setq</span> company-backends (mapcar #'company-mode/backend-with-yas company-backends))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">unbind &lt;TAB&gt; completion</span>
  (define-key yas-minor-mode-map [(tab)]        nil)
  (define-key yas-minor-mode-map (kbd <span style="color: #8b2252;">"TAB"</span>)    nil)
  (define-key yas-minor-mode-map (kbd <span style="color: #8b2252;">"&lt;tab&gt;"</span>)  nil)
  <span style="color: #483d8b;">:bind</span>
  (<span style="color: #483d8b;">:map</span> yas-minor-mode-map (<span style="color: #8b2252;">"S-&lt;tab&gt;"</span> . yas-expand)))

(<span style="color: #a020f0;">use-package</span> yasnippet-snippets
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> yasnippet)
</pre>
</div>
<p>
yasnippet-snippets 是一个模板集合，里面包含了常见的模板。也可以自定义模板，参考 yasnippet 的主页即可
</p>

<p>
对其它语言的支持看到<a href="https://github.com/AndreaCrotti/yasnippet-snippets/tree/9ce0b05f4b4d693831e67dd65d660716a8192e8d">这里</a>
</p>

<p>
简单的使用方法就是使用 `~` 来定义模板，然后调用 `aya-create` 再使用 `aya-expand` 来使用模板。
</p>

<p>
下面是使用代码片段的方法：
</p>

<ul class="org-ul">
<li>使用自带代码片段</li>
</ul>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#25191;&#34892;</span>
M-x yas-describe-tables

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#36755;&#20986;</span>
YASnippet tables:

Snippet table <span style="color: #ff00ff;">`fundamental-mode'</span>
<span style="color: #ff00ff;">----------------------------------------------------------------------------------------------------</span>
<span style="color: #ff00ff;">group                   state name                                    key             binding</span>
<span style="color: #ff00ff;">----------------------------------------------------------------------------------------------------</span>
<span style="color: #ff00ff;">(top level)               (a) current-date                            dd</span>
<span style="color: #ff00ff;">                          (a) current-date-and-time                   dt</span>
<span style="color: #ff00ff;">                          (a) Mode line                               -*-</span>
<span style="color: #ff00ff;">#&#20854;&#20013;key&#20195;&#34920;&#20195;&#30721;&#29255;&#27573;&#30340;&#24555;&#25463;&#36755;&#20837;&#65292;&#20877;&#25353;tab&#23601;&#21487;&#20197;&#34917;&#20840;&#29255;&#27573;&#12290;</span>
<span style="color: #ff00ff;">#&#20351;&#29992;C-n C-p&#19978;&#19979;&#38405;&#35835;&#29255;&#27573;&#35828;&#26126;</span>
</pre>
</div>

<p>
片段说明 
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">-*- mode: snippet -*-</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">name: current-date  &#25351;Snippet&#30340;&#21517;&#31216;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">key: dd             &#25353;&#21738;&#20010;key&#26469;&#21551;&#21160;snippet</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">contributor : Kristof Molnar-Tatai <a href="mailto:kristof.mlnr%40gmail.com">&lt;kristof.mlnr@gmail.com&gt;</a>  &#20316;&#32773;&#20449;&#24687;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">--</span>
<span style="color: #ff00ff;">`(format-time-string "%Y-%m-%d")`</span>

</pre>
</div>

<ul class="org-ul">
<li>自定义代码片段</li>
</ul>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#25191;&#34892;</span>
M-x yas-new-snippet == C-c C-n
</pre>
</div>

<p>
片段内容
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;"># </span><span style="color: #b22222;">-*- mode: snippet -*-</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">name: showmessage</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">key: sh</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">--</span>
(message <span style="color: #8b2252;">"hello from my yasnippet"</span>)$<span style="color: #a0522d;">0</span>
</pre>
</div>

<p>
使用`C-c C-c`完成编程，选择片段生效的模式，保存指定位置`~/.emacs.d/snippets/emacs-lisp-mode/showmessage`即可。
</p>
</div>
</div>
</div>
<div id="outline-container-h:226791fb-7946-4f79-8e3b-04991d3c7c8c" class="outline-4">
<h4 id="h:226791fb-7946-4f79-8e3b-04991d3c7c8c">代码调试</h4>
<div class="outline-text-4" id="text-h:226791fb-7946-4f79-8e3b-04991d3c7c8c">
<p>
与代码分析类似，微软设计 VSCode 时，对调试器也进行了前后端分离的设计，称为 <a href="https://microsoft.github.io/debug-adapter-protocol/">Debug Adapter Protocol</a>。Emacs 中可以使用 <a href="https://emacs-lsp.github.io/dap-mode/">dap-mode</a> 作为客户端。
</p>

<p>
dap-mode 对各个语言的配置在其<a href="https://emacs-lsp.github.io/dap-mode/page/configuration/">官方手册</a>上有说明。下文对语言的介绍中会一一进行简单说明。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> dap-mode
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> hydra lsp-mode
  <span style="color: #483d8b;">:commands</span> dap-debug
  <span style="color: #483d8b;">:custom</span>
  (dap-auto-configure-mode t)
  <span style="color: #483d8b;">:config</span>
  (dap-ui-mode 1)
  <span style="color: #483d8b;">:hydra</span>
  (hydra-dap-mode
   (<span style="color: #483d8b;">:color</span> pink <span style="color: #483d8b;">:hint</span> nil <span style="color: #483d8b;">:foreign-keys</span> run)
   <span style="color: #8b2252;">"</span>
<span style="color: #8b2252;">^Stepping^          ^Switch^                 ^Breakpoints^         ^Debug^                     ^Eval</span>
<span style="color: #8b2252;">^^^^^^^^----------------------------------------------------------------------------------------------------------------</span>
<span style="color: #8b2252;">_n_: Next           _ss_: Session            _bb_: Toggle          _dd_: Debug                 _ee_: Eval</span>
<span style="color: #8b2252;">_i_: Step in        _st_: Thread             _bd_: Delete          _dr_: Debug recent          _er_: Eval region</span>
<span style="color: #8b2252;">_o_: Step out       _sf_: Stack frame        _ba_: Add             _dl_: Debug last            _es_: Eval thing at point</span>
<span style="color: #8b2252;">_c_: Continue       _su_: Up stack frame     _bc_: Set condition   _de_: Edit debug template   _ea_: Add expression.</span>
<span style="color: #8b2252;">_r_: Restart frame  _sd_: Down stack frame   _bh_: Set hit count   _ds_: Debug restart</span>
<span style="color: #8b2252;">_Q_: Disconnect     _sl_: List locals        _bl_: Set log message</span>
<span style="color: #8b2252;">                  _sb_: List breakpoints</span>
<span style="color: #8b2252;">                  _sS_: List sessions</span>
<span style="color: #8b2252;">"</span>
   (<span style="color: #8b2252;">"n"</span> dap-next)
   (<span style="color: #8b2252;">"i"</span> dap-step-in)
   (<span style="color: #8b2252;">"o"</span> dap-step-out)
   (<span style="color: #8b2252;">"c"</span> dap-continue)
   (<span style="color: #8b2252;">"r"</span> dap-restart-frame)
   (<span style="color: #8b2252;">"ss"</span> dap-switch-session)
   (<span style="color: #8b2252;">"st"</span> dap-switch-thread)
   (<span style="color: #8b2252;">"sf"</span> dap-switch-stack-frame)
   (<span style="color: #8b2252;">"su"</span> dap-up-stack-frame)
   (<span style="color: #8b2252;">"sd"</span> dap-down-stack-frame)
   (<span style="color: #8b2252;">"sl"</span> dap-ui-locals)
   (<span style="color: #8b2252;">"sb"</span> dap-ui-breakpoints)
   (<span style="color: #8b2252;">"sS"</span> dap-ui-sessions)
   (<span style="color: #8b2252;">"bb"</span> dap-breakpoint-toggle)
   (<span style="color: #8b2252;">"ba"</span> dap-breakpoint-add)
   (<span style="color: #8b2252;">"bd"</span> dap-breakpoint-delete)
   (<span style="color: #8b2252;">"bc"</span> dap-breakpoint-condition)
   (<span style="color: #8b2252;">"bh"</span> dap-breakpoint-hit-condition)
   (<span style="color: #8b2252;">"bl"</span> dap-breakpoint-log-message)
   (<span style="color: #8b2252;">"dd"</span> dap-debug)
   (<span style="color: #8b2252;">"dr"</span> dap-debug-recent)
   (<span style="color: #8b2252;">"ds"</span> dap-debug-restart)
   (<span style="color: #8b2252;">"dl"</span> dap-debug-last)
   (<span style="color: #8b2252;">"de"</span> dap-debug-edit-template)
   (<span style="color: #8b2252;">"ee"</span> dap-eval)
   (<span style="color: #8b2252;">"ea"</span> dap-ui-expressions-add)
   (<span style="color: #8b2252;">"er"</span> dap-eval-region)
   (<span style="color: #8b2252;">"es"</span> dap-eval-thing-at-point)
   (<span style="color: #8b2252;">"q"</span> nil <span style="color: #8b2252;">"quit"</span> <span style="color: #483d8b;">:color</span> blue)
   (<span style="color: #8b2252;">"Q"</span> dap-disconnect <span style="color: #483d8b;">:color</span> red)))
</pre>
</div>

<p>
其操作和我们平常使用 IDE 的操作是几乎一样的。我们可以通过 dap-breakpoint-add 命令或鼠标点击一行的左侧边缘来增加一个断点。当然也可以使用我们上面定义的 hydra，先调用 M-x dap-hydra 展开 hydra，然后输入相应命令。
</p>

<p>
使用 dap-debug-edit-template 命令可以编辑调试所使用的模板，也就是调试命令的设置，如果没有自定义参数通常用默认的就好，无需进行此步操作。这就类似于 VSCode 的 launch.json 文件的作用。 把光标移入它生成的模板的括号内，按下 C-M-x 来让其生效，随后调用 dap-debug 开始调试。
</p>

<p>
对于不同语言，需要安装好不同的后端程序，主要可以参考其<a href="https://emacs-lsp.github.io/dap-mode/page/configuration/">官方手册</a>。
</p>
</div>
</div>
<div id="outline-container-h:461dccbb-9553-46cf-9317-d1716ab9c1a7" class="outline-4">
<h4 id="h:461dccbb-9553-46cf-9317-d1716ab9c1a7">Project 项目管理</h4>
<div class="outline-text-4" id="text-h:461dccbb-9553-46cf-9317-d1716ab9c1a7">
<p>
目前为止，Emacs 只是在对文件进行操作，而没有项目的概念。我们实际的开发一定是以项目为单位的，projectile 就是为 Emacs 提供了项目管理的插件。
</p>


<ul class="org-ul">
<li>Project : progectile, Speedbar</li>
</ul>
</div>
<div id="outline-container-h:958269d3-4e72-499e-9a6d-b22fc0cf234f" class="outline-5">
<h5 id="h:958269d3-4e72-499e-9a6d-b22fc0cf234f">插件-projectile</h5>
<div class="outline-text-5" id="text-h:958269d3-4e72-499e-9a6d-b22fc0cf234f">
<p>
是一个非常好的包，它使在项目中和项目之间导航变得更加容易。我也安装了counsel-projectile
</p>

<ul class="org-ul">
<li>projectile <a href="https://github.com/bbatsov/projectile">https://github.com/bbatsov/projectile</a></li>
<li>counsel-projectile <a href="https://github.com/ericdanan/counsel-projectile">https://github.com/ericdanan/counsel-projectile</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">projectile&#39033;&#30446;&#38388;&#20999;&#25442;</span>
(<span style="color: #a020f0;">use-package</span> projectile
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> projectile-mode-map
              (<span style="color: #8b2252;">"s-p"</span> . 'projectile-command-map)
              (<span style="color: #8b2252;">"C-c p"</span> . 'projectile-command-map)
              )
  <span style="color: #483d8b;">:config</span>
  <span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq projectile-completion-system 'ivy)</span>
  (<span style="color: #a020f0;">setq</span> projectile-mode-line <span style="color: #8b2252;">" Proj"</span>)
  (<span style="color: #a020f0;">setq</span> projectile-track-known-projects-automatically nil)
  (projectile-mode +1)

  (<span style="color: #a020f0;">when</span> (executable-find <span style="color: #8b2252;">"rg"</span>)
    (<span style="color: #a020f0;">setq-default</span> projectile-generic-command <span style="color: #8b2252;">"rg --files --hidden"</span>))

  (<span style="color: #a020f0;">use-package</span> counsel-projectile
    <span style="color: #483d8b;">:ensure</span> t
    <span style="color: #483d8b;">:init</span> (counsel-projectile-mode)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(use-package ibuffer-projectile</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">:ensure t</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">:config</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'ibuffer-hook</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">(lambda ()</span>
<span style="color: #b22222;">;;       </span><span style="color: #b22222;">(ibuffer-projectile-set-filter-groups)</span>
<span style="color: #b22222;">;;       </span><span style="color: #b22222;">(unless (eq ibuffer-sorting-mode 'alphabetic)</span>
<span style="color: #b22222;">;;         </span><span style="color: #b22222;">(ibuffer-do-sort-by-alphabetic))))</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">)</span>
</pre>
</div>

<p>
当同时配好 projectile 和 lsp 后，我们如果打开一个项目内的文件，lsp 会提示你让你确认一下 projectile 推测出的项目的根目录，它会以此为范围做代码分析。
</p>

<p>
projectile 之所以能猜出来项目的根目录，逻辑是它从你打开的文件所在的目录一级一级向上寻找含有一些项目标志性的文件或目录，例如 `.git`、`Makefile`、`CMakeLists.txt`、 `setup.py`、`Cargo.toml` 等所在的目录认定为项目根目录。当然，也会有一些情况会推测错误，尤其对于大型项目包含子项目的，所以它在询问你时，可以根据它的指示，手动指定项目的根目录。对于一些临时打开的文件，也可以直接跳过这个步骤。
另外，也可以直接在项目的根目录下创建一个名为 `.projectile` 的空文件来明确提示 projectile 根目录在这里。
更多详细说明可以参考<a href="https://docs.projectile.mx/projectile/projects.html">文档</a>。
</p>

<p>
项目的标识是：
</p>

<ul class="org-ul">
<li>自发现</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> projectile-project-search-path '(<span style="color: #8b2252;">"~/.emacs.d/samples/python/"</span> <span style="color: #8b2252;">"~/.emacs.d/samples/web/"</span>))
</pre>
</div>

<p>
添加了 `.projectile`空文件 的目录做项目。内容会写在`~/.emacs.d/projectile-bookmarks.eld`中
</p>

<ul class="org-ul">
<li>在版本管理系统下的项目，自动识别
<ul class="org-ul">
<li>Git</li>
<li>Mercurial</li>
<li>Bazaar</li>
<li>Subversion</li>
<li>CVS</li>
<li>Fossil</li>
<li>Darcs</li>
</ul></li>
</ul>


<p>
projectile 提供了在本项目下的常用操作，比如：
</p>

<ul class="org-ul">
<li>帮助： `C-c p ?`</li>
<li>切换项目： `C-c p p`</li>
<li>本项目中打开文件： `C-c p f`</li>
<li>本项目中切换 buffer： `C-c p b`</li>
<li>本项目中搜索： `C-c p s g` 或者 `C-c p s s`</li>
<li>C-c p t 使用pt查找内容</li>
<li>C-c p h 查找文件名</li>
<li>C-c p a 主要用来切换html和css</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:2f4d3338-fb22-4da4-bb66-3fbf94b4a31b" class="outline-4">
<h4 id="h:2f4d3338-fb22-4da4-bb66-3fbf94b4a31b">局部变量</h4>
<div class="outline-text-4" id="text-h:2f4d3338-fb22-4da4-bb66-3fbf94b4a31b">
<p>
我们目前的配置都是全局的，Emacs 自然也可以对项目进行特别的配置。Emacs 有一个配置文件，就类似于 VSCode 的 `.vscode/settings.json` ，名为 `.dir-locals.el`。这个文件是一种特殊的语法，用于保存一些变量在这个项目下的取值。
</p>

<p>
举个例子，如果我们的项目需要使用 clang 编译器的 c++11 标准做语法检查，应当如下操作：
</p>

<p>
输入命令 `M-x add-dir-local-variable` 在操作结束后，会自动创建 `.dir-locals.el` 文件。首先它会让我们选择一下我们的这个变量是哪个 major mode 的变量，我们选择 `c++-mode`。随后，输入我们想要设置的变量 flycheck-clang-language-standard，输入回车确认。最后输入我们要设置的值 "c++11"（注意双引号表示字符串）。此时命令完成我们会跳转到 `.dir-locals.el` 文件的 buffer，内容如下：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">Directory Local Variables</span>
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">For more information see (info "(emacs) Directory Variables")</span>

((c++-mode . ((flycheck-clang-language-standard . <span style="color: #8b2252;">"c++11"</span>))))
</pre>
</div>

<p>
按下 `C-x C-s` 保存这个文件。下次打开这个项目的文件时，会提示你是否要应用这些变量的自定义值（为了安全性），按 y 即可生效。
</p>

<p>
如果使用的是 gcc 编译器，将变量名中的 clang 替换成 gcc 就好。
</p>
</div>
</div>
<div id="outline-container-h:a8f3a177-17f2-4cb1-9079-6ef6b2bef06f" class="outline-4">
<h4 id="h:a8f3a177-17f2-4cb1-9079-6ef6b2bef06f">环境变量</h4>
<div class="outline-text-4" id="text-h:a8f3a177-17f2-4cb1-9079-6ef6b2bef06f">
<p>
特别的，尤其是在 macOS 上，有时候我们可能会遇到一些在终端中的可执行文件放到 Emacs 图形界面下不能使用的问题。原因就在于图形界面的环境变量没有被正确设置。例如在图形界面使用 lsp 插件写 Python 程序并使用了 conda 虚拟环境，可能会提示你它找不到任何 language server，原因就在于 lsp 直接调用了 pyright 命令但是它没有在基本环境变量里。
</p>

<p>
我们可以通过安装 Steve Purcell 写的插件 <a href="https://github.com/purcell/exec-path-from-shell">exec-path-from-shell</a> 来完成：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">MacOS specific fix the PATH environment variable issue</span>
(<span style="color: #a020f0;">use-package</span> exec-path-from-shell
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:defer</span> nil
  <span style="color: #483d8b;">:when</span> (<span style="color: #a020f0;">or</span> (memq window-system '(mac ns x pgtk))
            (<span style="color: #a020f0;">unless</span> (memq system-type '(windows-nt dos))
              (daemonp)))
  <span style="color: #483d8b;">:init</span> (exec-path-from-shell-initialize))
</pre>
</div>

<p>
注意，完成这一任务会调用 Shell 进程，速度很慢，而如果遇到日常大家 `export PATH=$PATH:path/to/bin` 这种字符串拼接写法时会更慢，大大拖慢 Emacs 启动速度。根据 <a href="https://github.com/purcell/exec-path-from-shell#setting-up-your-shell-startup-files-correctly">Purcell 的建议</a>，这里的配置就只针对 macOS 上使用了图形界面的情况才启动这个插件的功能，并且读者应当尽量做到：
</p>

<ul class="org-ul">
<li>通过把 PATH 变量的设定放置在 `~/.profile`、`~/.bash_profile`、`~/.zshenv` 而不是通通放入 `~/.bashrc` 、`~/.zshrc` 。</li>
<li>不要使用 PATH 变量字符串拼接，而直接赋值。</li>
</ul>
</div>
</div>
<div id="outline-container-h:e2161054-41b8-490c-930b-f7bfbdeffbaf" class="outline-4">
<h4 id="h:e2161054-41b8-490c-930b-f7bfbdeffbaf">版本管理</h4>
<div class="outline-text-4" id="text-h:e2161054-41b8-490c-930b-f7bfbdeffbaf">
</div>
<div id="outline-container-h:81039ec5-0485-4320-9700-20246c1409ff" class="outline-5">
<h5 id="h:81039ec5-0485-4320-9700-20246c1409ff">Magi和git相关插件</h5>
<div class="outline-text-5" id="text-h:81039ec5-0485-4320-9700-20246c1409ff">
<p>
magit 是 Emacs 内部的 git 管理工具，提供了对 git 方便的调用和显示。magit 几乎无需配置。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> magit
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<p>
如果习惯了命令行操作 git，常用的操作用 build-in 的功能足够，就不需要安装这个插件了。
</p>

<p>
`.gitignore`过滤文件
</p>

<div class="org-src-container">
<pre class="src src-shell">elpa
auto-save-list
*~
<span style="color: #8b2252;">\#</span>*
elpy
emms
</pre>
</div>

<p>
<a href="https://github.com/emacsorphanage/git-gutter">https://github.com/emacsorphanage/git-gutter</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">some ediff settings</span>
(<span style="color: #a020f0;">setq</span> ediff-diff-options <span style="color: #8b2252;">""</span>)
(<span style="color: #a020f0;">setq</span> ediff-custom-diff-options <span style="color: #8b2252;">"-u"</span>)
(<span style="color: #a020f0;">setq</span> ediff-window-setup-function 'ediff-setup-windows-plain)
(<span style="color: #a020f0;">setq</span> ediff-split-window-function 'split-window-vertically)

(<span style="color: #a020f0;">use-package</span> magit
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (<span style="color: #a020f0;">progn</span>
    (<span style="color: #a020f0;">setq</span> magit-section-initial-visibility-alist
    '((stashes . hide) (untracked . hide) (unpushed . hide)))
    (<span style="color: #a020f0;">bind-key</span> <span style="color: #8b2252;">"C-x g"</span> 'magit-status)
    ))

(<span style="color: #a020f0;">setq</span> magit-status-margin
      '(t <span style="color: #8b2252;">"%Y-%m-%d %H:%M "</span> magit-log-margin-width t 18))

(<span style="color: #a020f0;">use-package</span> git-timemachine
  <span style="color: #483d8b;">:ensure</span> t
  )

(<span style="color: #a020f0;">use-package</span> git-gutter-fringe
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (global-git-gutter-mode))


(<span style="color: #a020f0;">use-package</span> smerge-mode
  <span style="color: #483d8b;">:after</span> hydra
  <span style="color: #483d8b;">:config</span>
  (defhydra unpackaged/smerge-hydra
    (<span style="color: #483d8b;">:color</span> pink <span style="color: #483d8b;">:hint</span> nil <span style="color: #483d8b;">:post</span> (smerge-auto-leave))
    <span style="color: #8b2252;">"</span>
<span style="color: #8b2252;">^Move^       ^Keep^               ^Diff^                 ^Other^</span>
<span style="color: #8b2252;">^^-----------^^-------------------^^---------------------^^-------</span>
<span style="color: #8b2252;">_n_ext       _b_ase               _&lt;_: upper/base        _C_ombine</span>
<span style="color: #8b2252;">_p_rev       _u_pper              _=_: upper/lower       _r_esolve</span>
<span style="color: #8b2252;">^^           _l_ower              _&gt;_: base/lower        _k_ill current</span>
<span style="color: #8b2252;">^^           _a_ll                _R_efine</span>
<span style="color: #8b2252;">^^           _RET_: current       _E_diff</span>
<span style="color: #8b2252;">"</span>
    (<span style="color: #8b2252;">"n"</span> smerge-next)
    (<span style="color: #8b2252;">"p"</span> smerge-prev)
    (<span style="color: #8b2252;">"b"</span> smerge-keep-base)
    (<span style="color: #8b2252;">"u"</span> smerge-keep-upper)
    (<span style="color: #8b2252;">"l"</span> smerge-keep-lower)
    (<span style="color: #8b2252;">"a"</span> smerge-keep-all)
    (<span style="color: #8b2252;">"RET"</span> smerge-keep-current)
    (<span style="color: #8b2252;">"\C-m"</span> smerge-keep-current)
    (<span style="color: #8b2252;">"&lt;"</span> smerge-diff-base-upper)
    (<span style="color: #8b2252;">"="</span> smerge-diff-upper-lower)
    (<span style="color: #8b2252;">"&gt;"</span> smerge-diff-base-lower)
    (<span style="color: #8b2252;">"R"</span> smerge-refine)
    (<span style="color: #8b2252;">"E"</span> smerge-ediff)
    (<span style="color: #8b2252;">"C"</span> smerge-combine-with-next)
    (<span style="color: #8b2252;">"r"</span> smerge-resolve)
    (<span style="color: #8b2252;">"k"</span> smerge-kill-current)
    (<span style="color: #8b2252;">"ZZ"</span> (<span style="color: #a020f0;">lambda</span> ()
            (<span style="color: #a020f0;">interactive</span>)
            (save-buffer)
            (bury-buffer))
     <span style="color: #8b2252;">"Save and bury buffer"</span> <span style="color: #483d8b;">:color</span> blue)
    (<span style="color: #8b2252;">"q"</span> nil <span style="color: #8b2252;">"cancel"</span> <span style="color: #483d8b;">:color</span> blue))
  <span style="color: #483d8b;">:hook</span> (magit-diff-visit-file . (<span style="color: #a020f0;">lambda</span> ()
                                   (<span style="color: #a020f0;">when</span> smerge-mode
                                     (unpackaged/smerge-hydra/body)))))

(<span style="color: #a020f0;">use-package</span> forge
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<p>
快捷键使用
</p>
<ul class="org-ul">
<li>git状态：`C-x g magit-status` 相当于 git status 。 使用?查看快捷键</li>
</ul>

<p>
magit 的总体使用逻辑是一步一步进行输入的 。最基本的用法是使用 `C-x M-g` 调用 `magit-dispatch`，会列出来所有可以调用的子命令，选中后再输入一些可选的选项和接下来的命令，就和正常输入 git 的命令一样。
</p>

<p>
使用 magit 做一些较为复杂的操作是非常方便的，举个例子，我们希望对比当前的这个源文件和上一个 commit 的区别，只需如下操作，其中每一步都有非常多的提示：
</p>

<ul class="org-ul">
<li>C-x M-g 调用 magit-dispatch 。</li>
<li>d 选择 Diff 。</li>
<li>`&#x2013; &lt;tab&gt; &lt;enter&gt; &lt;enter&gt;` 自动填充当前文件名，表示我们只关注这个文件的异同。</li>
<li>r 选择 Diff range，因为我们想对比另一个 commit。</li>
<li>输入 `HEAD^` （表示同一分支的上一个 commit）/ 想要对比的 commit ID。可以按 `&lt;tab&gt;` 进行提示。</li>
</ul>

<p>
由于 git 本身就是个非常复杂的工具，本文不做细致讨论，更多用法可以参考 magit 的主页。
</p>
</div>
</div>
</div>
<div id="outline-container-h:918e5f51-00fa-4640-b907-5e17c4dc0e24" class="outline-4">
<h4 id="h:918e5f51-00fa-4640-b907-5e17c4dc0e24">工作区管理</h4>
<div class="outline-text-4" id="text-h:918e5f51-00fa-4640-b907-5e17c4dc0e24">
<p>
对于涉及多个项目的更复杂的任务，我们需要一个工作区（workspace）来进行管理和切换。<a href="https://github.com/Alexander-Miller/treemacs">treemacs</a> 为我们提供了这样的功能。如果读者不需要工作区管理这样复杂的功能，而只是想要一个树形文件结构显示，那么可以考虑使用 <a href="https://github.com/jaypei/emacs-neotree">neotre</a>e。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> treemacs
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:defer</span> t
  <span style="color: #483d8b;">:config</span>
  (treemacs-tag-follow-mode)
  <span style="color: #483d8b;">:bind</span>
  (<span style="color: #483d8b;">:map</span> global-map
        (<span style="color: #8b2252;">"M-0"</span>       . treemacs-select-window)
        (<span style="color: #8b2252;">"C-x t 1"</span>   . treemacs-delete-other-windows)
        (<span style="color: #8b2252;">"C-x t t"</span>   . treemacs)
        (<span style="color: #8b2252;">"C-x t B"</span>   . treemacs-bookmark)
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">("C-x t C-t" . treemacs-find-file)</span>
        (<span style="color: #8b2252;">"C-x t M-t"</span> . treemacs-find-tag))
  (<span style="color: #483d8b;">:map</span> treemacs-mode-map
        (<span style="color: #8b2252;">"/"</span> . treemacs-advanced-helpful-hydra)))

(<span style="color: #a020f0;">use-package</span> treemacs-projectile
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> (treemacs projectile))

(<span style="color: #a020f0;">use-package</span> lsp-treemacs
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> (treemacs lsp))
</pre>
</div>

<p>
配置好后，我们可以使用 `C-x t t` 调出 treemacs，用 `M-0` 在我们的代码 Buffer 和 treemacs 边栏之间切换。当我们光标进入 treemacs 边栏时，可以按问号 `?` 来调出帮助。
</p>

<p>
我们可以使用 `treemacs-create-workspace` 来创建一个新的工作区。它会在你当前光标所在处打出一个小窗提示你输入 “Workspace name”，起个合适的名字。创建好后，我们在 treemacs 边栏中输入 `C-c C-p a` 调用 `treemacs-add-project-to-workspace` 来添加一个项目路径，用 `C-c C-p d` 去除工作区选中的项目。这些都可以在 `?` 显示的帮助中找到。想要切换工作区时，使用 `treemacs-switch-workspace` 命令。
</p>

<p>
由于我们安装了 `treemacs-projectile`，我们也可以使用 treemacs-projectile 命令将我们 projectile 当中保存过的项目直接导入到 treemacs 中。
</p>

<p>
此外，我们还可以调用 treemacs-edit-workspaces 来通过配置文件来修改我们的工作区设置，修改完成后用 treemacs-finish-edit 命令或 `C-c C-c` 结束编辑。它会自动检查语法。（ps：所使用的语法是 Emacs org-mode，一个 Emacs 内部的笔记系统，可以近似理解为高级 markdown）。
</p>

<p>
treemacs 不仅能够显示文件，还会显示其中的符号，包括函数定义、结构体定义等等。配置中的 `(treemacs-tag-follow-mode)` 就是希望 treemacs 始终跟随着我们代码光标所在位置进行移动。
</p>

<p>
最后，`?` 显示出的帮助是 treemacs-common-helpful-hydra，我们可以按 `/` 或调用 treemacs-advanced-helpful-hydra 来显示出更多帮助，包括了对文件的操作和对工作区的操作。
</p>

<p>
treemacs 正常情况不会根据我们打开的 Buffer 不同而切换项目或工作区。其原因在于有时候我们只是打开一些额外的文件，并不希望工作区也进行转变。而大多数情况，我们也确实并不需要频繁切换工作区，所以我们主动去调用 treemacs-switch-workspace 就好。如果觉得这样过于繁琐，也可以开启一个 treemacs-project-follow-mode，它会根据我们的文件跳转到相应的项目中。 或者直接使用本节开头提到的 <a href="https://github.com/jaypei/emacs-neotree">neotree</a> 插件。
</p>

<p>
treemacs 的边栏是一个固定在 Buffer 内的 frame， 所以操作起来有些特殊。
</p>
</div>
<div id="outline-container-h:ca1206f5-382e-4733-b2d2-b5791cfb6276" class="outline-5">
<h5 id="h:ca1206f5-382e-4733-b2d2-b5791cfb6276">treemacs插件</h5>
<div class="outline-text-5" id="text-h:ca1206f5-382e-4733-b2d2-b5791cfb6276">
<p>
<a href="#h:c1419f37-bd97-4be5-bdd4-9f8203d608e9">插件包管理</a>
</p>

<ul class="org-ul">
<li><a href="https://github.com/Alexander-Miller/treemacs">https://github.com/Alexander-Miller/treemacs</a></li>
</ul>

<p>
开启`treemacs`
</p>

<div class="org-src-container">
<pre class="src src-shell">(use-package treemacs
  :ensure t
  :defer t
  :init
  (with-eval-after-load <span style="color: #8b2252;">'winum</span>
<span style="color: #8b2252;">    (define-key winum-keymap (kbd "M-0") #'</span>treemacs-select-window))
  :config
  (progn
    (setq treemacs-collapse-dirs                 (<span style="color: #a020f0;">if</span> treemacs-python-executable 3 0)
          treemacs-deferred-git-apply-delay      0.5
          treemacs-directory-name-transformer    <span style="color: #b22222;">#</span><span style="color: #b22222;">'identity</span>
          treemacs-display-in-side-window        t
          treemacs-eldoc-display                 t
          treemacs-file-event-delay              5000
          treemacs-file-extension-regex          treemacs-last-period-regex-value
          treemacs-file-follow-delay             0.2
          treemacs-file-name-transformer         <span style="color: #b22222;">#</span><span style="color: #b22222;">'identity</span>
          treemacs-follow-after-init             t
          treemacs-expand-after-init             t
          treemacs-git-command-pipe              <span style="color: #8b2252;">""</span>
          treemacs-goto-tag-strategy             <span style="color: #8b2252;">'refetch-index</span>
<span style="color: #8b2252;">          treemacs-indentation                   2</span>
<span style="color: #8b2252;">          treemacs-indentation-string            " "</span>
<span style="color: #8b2252;">          treemacs-is-never-other-window         nil</span>
<span style="color: #8b2252;">          treemacs-max-git-entries               5000</span>
<span style="color: #8b2252;">          treemacs-missing-project-action        '</span>ask
          treemacs-move-forward-on-expand        nil
          treemacs-no-png-images                 nil
          treemacs-no-delete-other-windows       t
          treemacs-project-follow-cleanup        nil
          treemacs-persist-file                  (expand-file-name <span style="color: #8b2252;">".cache/treemacs-persist"</span> user-emacs-directory)
          treemacs-position                      <span style="color: #8b2252;">'left</span>
<span style="color: #8b2252;">          treemacs-read-string-input             '</span>from-child-frame
          treemacs-recenter-distance             0.1
          treemacs-recenter-after-file-follow    nil
          treemacs-recenter-after-tag-follow     nil
          treemacs-recenter-after-project-jump   <span style="color: #8b2252;">'always</span>
<span style="color: #8b2252;">          treemacs-recenter-after-project-expand '</span>on-distance
          treemacs-litter-directories            <span style="color: #8b2252;">'("/node_modules" "/.venv" "/.cask")</span>
<span style="color: #8b2252;">          treemacs-show-cursor                   nil</span>
<span style="color: #8b2252;">          treemacs-show-hidden-files             t</span>
<span style="color: #8b2252;">          treemacs-silent-filewatch              nil</span>
<span style="color: #8b2252;">          treemacs-silent-refresh                nil</span>
<span style="color: #8b2252;">          treemacs-sorting                       '</span>alphabetic-asc
          treemacs-space-between-root-nodes      t
          treemacs-tag-follow-cleanup            t
          treemacs-tag-follow-delay              1.5
          treemacs-user-mode-line-format         nil
          treemacs-user-header-line-format       nil
          treemacs-width                         35
          treemacs-width-is-initially-locked     t
          treemacs-workspace-switch-cleanup      nil)

    ;; The default width and height of the icons is 22 pixels. If you are
    ;; using a Hi-DPI display, uncomment this to double the icon size.
    ;;(treemacs-resize-icons 44)

    (treemacs-follow-mode t)
    (treemacs-filewatch-mode t)
    (treemacs-fringe-indicator-mode <span style="color: #8b2252;">'always)</span>
<span style="color: #8b2252;">    (pcase (cons (not (null (executable-find "git")))</span>
<span style="color: #8b2252;">                 (not (null treemacs-python-executable)))</span>
<span style="color: #8b2252;">      (`(t . t)</span>
<span style="color: #8b2252;">       (treemacs-git-mode '</span>deferred))
      (<span style="color: #ff00ff;">`(t . _)</span>
<span style="color: #ff00ff;">       (treemacs-git-mode 'simple))))</span>
<span style="color: #ff00ff;">  :bind</span>
<span style="color: #ff00ff;">  (:map global-map</span>
<span style="color: #ff00ff;">        ("M-0"       . treemacs-select-window)</span>
<span style="color: #ff00ff;">        ("C-x t 1"   . treemacs-delete-other-windows)</span>
<span style="color: #ff00ff;">        ("C-x t t"   . treemacs)</span>
<span style="color: #ff00ff;">        ("C-x t B"   . treemacs-bookmark)</span>
<span style="color: #ff00ff;">        ("C-x t C-t" . treemacs-find-file)</span>
<span style="color: #ff00ff;">        ("C-x t M-t" . treemacs-find-tag)))</span>
<span style="color: #ff00ff;">;;&#22312;&#30446;&#24405;&#26641;&#20013;&#21487;&#20197;&#20351;&#29992;vim&#30340;&#24555;&#25463;&#38190;&#19978;&#19979;&#31227;&#21160;</span>
<span style="color: #ff00ff;">(use-package treemacs-evil</span>
<span style="color: #ff00ff;">  :after (treemacs evil)</span>
<span style="color: #ff00ff;">  :ensure t)</span>

<span style="color: #ff00ff;">(use-package treemacs-projectile</span>
<span style="color: #ff00ff;">  :after (treemacs projectile)</span>
<span style="color: #ff00ff;">  :ensure t)</span>

<span style="color: #ff00ff;">(use-package treemacs-icons-dired</span>
<span style="color: #ff00ff;">  :after (treemacs dired)</span>
<span style="color: #ff00ff;">  :ensure t</span>
<span style="color: #ff00ff;">  :config (treemacs-icons-dired-mode))</span>

<span style="color: #ff00ff;">(use-package treemacs-magit</span>
<span style="color: #ff00ff;">  :after (treemacs magit)</span>
<span style="color: #ff00ff;">  :ensure t)</span>

<span style="color: #ff00ff;">(use-package treemacs-persp ;;treemacs-perspective if you use perspective.el vs. persp-mode</span>
<span style="color: #ff00ff;">  :after (treemacs persp-mode) ;;or perspective vs. persp-mode</span>
<span style="color: #ff00ff;">  :ensure t</span>
<span style="color: #ff00ff;">  :config (treemacs-set-scope-type 'Perspectives))</span>
</pre>
</div>

<p>
使用`M-0`快速打开目录树，使用`?`可以看到对应快捷键。如`o-h`在新窗口中打开文件。
</p>
</div>
</div>
<div id="outline-container-h:693f9055-02bf-4136-b2d7-288cc6902192" class="outline-5">
<h5 id="h:693f9055-02bf-4136-b2d7-288cc6902192">lsp-treemacs</h5>
<div class="outline-text-5" id="text-h:693f9055-02bf-4136-b2d7-288cc6902192">
</div>
</div>
</div>
<div id="outline-container-h:afef20f4-f16c-4a10-9357-397bf5a077d0" class="outline-4">
<h4 id="h:afef20f4-f16c-4a10-9357-397bf5a077d0">终端</h4>
<div class="outline-text-4" id="text-h:afef20f4-f16c-4a10-9357-397bf5a077d0">
<p>
Emacs 内想要使用 Shell 可以直接调用 `M-x shell` 即可打开你的默认 Shell。此外 Emacs 还特别打造了 eshell 作为 Emacs 的专用 Shell。
</p>

<p>
使用 Shell 主要注意操作上，我们不再使用方向键来回滚历史命令，而是通过 `M-p` 和 `M-n` 来翻看命令。
</p>
</div>
</div>
<div id="outline-container-h:c2b2ef9b-d16c-4091-a339-3879d3b2f8a1" class="outline-4">
<h4 id="h:c2b2ef9b-d16c-4091-a339-3879d3b2f8a1">远程访问</h4>
<div class="outline-text-4" id="text-h:c2b2ef9b-d16c-4091-a339-3879d3b2f8a1">
<p>
Emacs 本身有一个 tramp 功能可以实现远程 ssh 访问。无需任何配置，使用 `C-x C-f` 打开文件时，删除掉所有路径，只留下一个斜杠 `/`，然后输入成 `/ssh:user@address:`，后面接远程服务器上的目录，就可以访问到相应的远程服务器的相应文件或目录。如果在 `~/.ssh/config` 中有配置 Host 名称，也可以直接输入名称 `/ssh:hostname:`。
</p>

<p>
如果需要代理才能访问，请在 "MELPA" 中提到的代理配置：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> url-proxy-services '((<span style="color: #8b2252;">"no_proxy"</span> . <span style="color: #8b2252;">"^</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">192\\.168\\..*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">"</span>)
                           (<span style="color: #8b2252;">"http"</span> . <span style="color: #8b2252;">"&lt;&#20195;&#29702; IP&gt;:&lt;&#20195;&#29702;&#31471;&#21475;&#21495;&gt;"</span>)
                           (<span style="color: #8b2252;">"https"</span> . <span style="color: #8b2252;">"&lt;&#20195;&#29702; IP&gt;:&lt;&#20195;&#29702;&#31471;&#21475;&#21495;&gt;"</span>)))
</pre>
</div>

<p>
但是，虽然可以远程编辑，却并不能继续使用以上大部分功能，因为这些插件都是安装在本地的，而源代码和项目都在远程服务器上。VSCode 对此的解决办法是可以在远程服务器也安装一遍这些插件。对 Emacs 来说，其实只要把 `~/.emacs.d` 目录复制到远程服务器上，然后在上面安装一个 Emacs，就可以直接在终端中使用远程的 Emacs 了，毕竟我们用 Emacs 本来就不需要鼠标。这样可能比远程访问来得更加简单好用。
</p>
</div>
</div>
<div id="outline-container-h:1b04e0fe-d1f4-4819-8820-728077cf762d" class="outline-4">
<h4 id="h:1b04e0fe-d1f4-4819-8820-728077cf762d">Doc 文档</h4>
<div class="outline-text-4" id="text-h:1b04e0fe-d1f4-4819-8820-728077cf762d">
</div>
</div>
</div>
<div id="outline-container-h:1cf85fd5-46a3-483d-bf93-878ebc13272e" class="outline-3">
<h3 id="h:1cf85fd5-46a3-483d-bf93-878ebc13272e">编程语言</h3>
<div class="outline-text-3" id="text-h:1cf85fd5-46a3-483d-bf93-878ebc13272e">
<p>
推荐使用LSP完成各个编程语言的配置
</p>
</div>
<div id="outline-container-h:c540b2d7-075e-40f7-b370-0cf0ea80a9e5" class="outline-4">
<h4 id="h:c540b2d7-075e-40f7-b370-0cf0ea80a9e5">代码分析</h4>
<div class="outline-text-4" id="text-h:c540b2d7-075e-40f7-b370-0cf0ea80a9e5">
<p>
编程语言环境配置之LSP
</p>


<p>
代码分析
这一功能是指通过语法分析来进行诸如寻找函数和变量的定义、引用等等与编程语言本身相关的功能。传统方法中，每种语言都有一个专门为其设计的插件，例如 C/C++ 开发会用一些传统的 CEDET，gtag 等插件，Python 则用 elpy。但这类插件由于和编辑器直接耦合，完全由插件开发者控制，更新维护不一定及时，bug 也会较多。因此，推荐使用微软为 VSCode 设计的 Language Server Protocol (LSP) 来完成这一任务。随着 LSP 发展壮大，它已成为一个开放的、统一的标准了，可以供 Emacs 使用。
</p>

<p>
LSP 将代码分析解耦合为前端（即编辑器提供的功能，语言无关）和后端（语法分析，语言相关）两部分，二者通过一个规定好的协议来通信，也就是 LSP 协议，这样一来，编辑器开发者只需要做好前端部分，也就是 LSP client，后端的语言相关部分由语言开发者完成，称为 LSP server，分工明确，效率更高，体验也就会好很多。
</p>

<p>
为 Emacs 提供 LSP 的插件有 <a href="https://emacs-lsp.github.io/lsp-mode">lsp</a> 和 <a href="https://github.com/joaotavora/eglot">eglot</a>，相对来说使用 lsp 的人更多相对更稳定，本节将介绍 lsp 插件，及其相关的组合插件。lsp 应当与 projectile 项目管理插件一起使用。此外，这里的 lsp 只是前端部分， 后端需要单独安装，有的时候可以直接通过命令 `lsp-install-server` 让 lsp 为你自动安装，或者也可以手动安装你偏爱的 LSP server，下文中会介绍几个常用语言的典型配置。
</p>
</div>
<div id="outline-container-h:16e834a4-bae3-4286-89c4-651d756171ff" class="outline-5">
<h5 id="h:16e834a4-bae3-4286-89c4-651d756171ff">lsp-mode</h5>
<div class="outline-text-5" id="text-h:16e834a4-bae3-4286-89c4-651d756171ff">
<p>
官方地址 <a href="https://microsoft.github.io/language-server-protocol/">https://microsoft.github.io/language-server-protocol/</a>
</p>

<p>
lsp-mode <a href="https://github.com/emacs-lsp/lsp-mode">https://github.com/emacs-lsp/lsp-mode</a>
</p>

<p>
<img src="./images/image-20210627044320316.png" alt="image-20210627044320316.png">]]
</p>

<p>
首先根据其官网，我们就可以有一个最基础的配置：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Minimized lsp-mode setup</span>
(<span style="color: #a020f0;">use-package</span> lsp-mode
  <span style="color: #483d8b;">:commands</span> (lsp lsp-deferred) <span style="color: #b22222;">;; </span><span style="color: #b22222;">lsp-deferred &#36827;&#20837;&#26576;&#20010;&#27169;&#24335;&#26102;&#21551;&#21160;</span>
  <span style="color: #483d8b;">:init</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">lsp-save-actions</span> ()
    <span style="color: #8b2252;">"LSP actions before save."</span>
    (add-hook 'before-save-hook #'lsp-organize-imports t t)
        (add-hook 'before-save-hook #'lsp-format-buffer t t))
  <span style="color: #483d8b;">:hook</span> ((lsp-mode . #'lsp-enable-which-key-integration)
         (lsp-mode . #'lsp-save-actions)
         ((c-mode
           c++-mode
           go-mode
           java-mode
           js-mode
           python-mode
           rust-mode
           web-mode) <span style="color: #ff0000; font-weight: bold;">. lsp-deferred))</span>
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> lsp-auto-guess-root t
            lsp-headerline-breadcrumb-enable nil
            lsp-keymap-prefix <span style="color: #8b2252;">"C-c l"</span>
            lsp-file-watch-threshold 500
            lsp-log-io nil)
  (define-key lsp-mode-map (kbd <span style="color: #8b2252;">"C-c l"</span>) lsp-command-map)
  (<span style="color: #a020f0;">setq</span> lsp-completion-provider <span style="color: #483d8b;">:none</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#38459;&#27490; lsp &#37325;&#26032;&#35774;&#32622; company-backend &#32780;&#35206;&#30422;&#25105;&#20204; yasnippet &#30340;&#35774;&#32622;</span>
  )

<span style="color: #b22222;">;; </span><span style="color: #b22222;">optional if you want which-key integration</span>
(<span style="color: #a020f0;">use-package</span> which-key
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (which-key-mode))
</pre>
</div>

<p>
另外官网相应的 lsp 命令笔者使用的是 lsp-deferred 替代，主要区别是 `lsp-deferred` 会推迟 lsp 服务的启动直到文件完全被显示出来，使用这个的主要目的是为了避免在文件数量过多的大项目造成 LSP 服务端过载。
</p>

<p>
`lsp-headerline-breadcrumb-enable` 让 lsp 为我们不显示 breadcrumb。当我们完全配置好后，打开一个项目中的文件时，会在文件的最上面显示该文件的路径，这个被称为 breadcrumb。
</p>

<p>
随后，我们如果希望有更现代的图形化的支持，例如光标停留在一个变量或者函数时，显示相关的定义缩略信息、文档注释等，那么我们可以再安装一个 lsp-ui 插件，并做如下配置：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Optional features, disabled default</span>
(<span style="color: #a020f0;">when</span> nil
  (<span style="color: #a020f0;">use-package</span> lsp-ui
    <span style="color: #483d8b;">:ensure</span> t
    <span style="color: #483d8b;">:after</span> lsp-mode
    <span style="color: #483d8b;">:init</span>
    (<span style="color: #a020f0;">setq</span> lsp-ui-doc-include-signature t
          lsp-ui-doc-position 'top
          lsp-ui-sideline-ignore-duplicate t)
    (add-hook 'lsp-mode-hook 'lsp-ui-mode)
    (add-hook 'lsp-ui-mode-hook 'lsp-modeline-code-actions-mode)
    <span style="color: #483d8b;">:config</span>
    (define-key lsp-ui-mode-map [remap xref-find-definitions] #'lsp-ui-peek-find-definitions)
    (define-key lsp-ui-mode-map [remap xref-find-references] #'lsp-ui-peek-find-references)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">debug with dap-mode</span>
(<span style="color: #a020f0;">when</span> nil
  (<span style="color: #a020f0;">use-package</span> dap-mode
    <span style="color: #483d8b;">:ensure</span> t
    <span style="color: #483d8b;">:init</span>
    (add-hook 'lsp-mode-hook 'dap-mode)
    (add-hook 'dap-mode-hook 'dap-ui-mode)
    (add-hook 'dap-mode-hook 'dap-tooltip-mode)
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(add-hook 'python-mode-hook (lambda() (require 'dap-python)))</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(add-hook 'go-mode-hook (lambda() (require 'dap-go)))</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(add-hook 'java-mode-hook (lambda() (require 'dap-java)))</span>
    ))
</pre>
</div>

<p>
上面主要目的是替换本来的部分快捷键映射，由 lsp-ui 来进行接管，它同时为我们提供了一些跳转功能。这样我们可以使用 `M-.` 来寻找符号的定义，用 `M-?` 来寻找符号的引用。`lsp-ui-doc-position 'at-point` 配置了 lsp-ui-doc （也就是刚刚提到的符号信息弹窗）在窗口上方显示，虽然很多现代编辑器都是显示在光标所在位置，但那会遮挡代码，有时十分惹人厌烦，所以一般会设置成显示在上方 top 或下方 bottom。如果确实希望显示在光标所在位置，可以改为 at-point。
</p>

<ul class="org-ul">
<li>代码跳转： `C-c l g g  lsp-find-definition`</li>
<li>导入函数： `C-c l r o lsp-organize-imports`</li>
</ul>

<p>
其它：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">optionally &#37197;&#32622;&#21069;d&#26679;&#24335;</span>
(<span style="color: #a020f0;">use-package</span> lsp-ui <span style="color: #483d8b;">:commands</span> lsp-ui-mode)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">if you are helm user</span>
(<span style="color: #a020f0;">use-package</span> helm-lsp <span style="color: #483d8b;">:commands</span> helm-lsp-workspace-symbol)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">if you are ivy user</span>
(<span style="color: #a020f0;">use-package</span> lsp-ivy <span style="color: #483d8b;">:commands</span> lsp-ivy-workspace-symbol)
(<span style="color: #a020f0;">use-package</span> lsp-treemacs <span style="color: #483d8b;">:commands</span> lsp-treemacs-errors-list)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">optionally if you want to use debugger</span>
(<span style="color: #a020f0;">use-package</span> dap-mode)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(use-package dap-LANGUAGE) to load the dap adapter for your language</span>
</pre>
</div>


<ul class="org-ul">
<li>各个语言环境配置 <a href="https://emacs-lsp.github.io/lsp-mode/page/languages/">https://emacs-lsp.github.io/lsp-mode/page/languages/</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:9195a3ae-6d80-4f90-9845-ea1ed0d03133" class="outline-5">
<h5 id="h:9195a3ae-6d80-4f90-9845-ea1ed0d03133">eglot</h5>
<div class="outline-text-5" id="text-h:9195a3ae-6d80-4f90-9845-ea1ed0d03133">
<p>
自29版本后内置包。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> eglot
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:hook</span> ((c-mode
          c++-mode
          go-mode
          java-mode
          js-mode
          python-mode
          rust-mode
          web-mode) <span style="color: #ff0000; font-weight: bold;">. eglot-ensure)</span>
  <span style="color: #483d8b;">:bind</span> ((<span style="color: #8b2252;">"C-c e f"</span> . #'eglot-format)
         (<span style="color: #8b2252;">"C-c e a"</span> . #'eglot-code-actions)
         (<span style="color: #8b2252;">"C-c e i"</span> . #'eglot-code-action-organize-imports)
         (<span style="color: #8b2252;">"C-c e q"</span> . #'eglot-code-action-quickfix))
  <span style="color: #483d8b;">:config</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq eglot-ignored-server-capabilities '(:documentHighlightProvider))</span>
  (add-to-list 'eglot-server-programs '(web-mode <span style="color: #8b2252;">"vls"</span>))
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">eglot-actions-before-save</span>()
    (add-hook 'before-save-hook #'eglot-format-buffer))
  (add-hook 'eglot--managed-mode-hook #'eglot-actions-before-save))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:7acd0544-2ad0-44ce-9120-301d3507093c" class="outline-4">
<h4 id="h:7acd0544-2ad0-44ce-9120-301d3507093c">LSP-python语言环境</h4>
<div class="outline-text-4" id="text-h:7acd0544-2ad0-44ce-9120-301d3507093c">
<ol class="org-ol">
<li>运行</li>
</ol>
<p>
Python 的运行主要考虑与它的 REPL 的配合以及虚拟环境的切换。前者是 Emacs 自带的基础功能，后者可以安装插件 <a href="https://github.com/jorgenschaefer/pyvenv">pyvenv</a> 进行管理。笔者平日使用 miniconda 做 Python 的环境管理（F.Y.I., miniconda 是 anaconda 的最精简版），如果你使用 anaconda，只需要改个名字；如果你使用 Python 本身的 virtualenv，pyvenv 插件更是直接支持。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> python
  <span style="color: #483d8b;">:defer</span> t
  <span style="color: #483d8b;">:mode</span> (<span style="color: #8b2252;">"\\.py\\'"</span> . python-mode)
  <span style="color: #483d8b;">:interpreter</span> (<span style="color: #8b2252;">"python3"</span> . python-mode)
  <span style="color: #483d8b;">:config</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">for debug</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">dap-python</span>))

(<span style="color: #a020f0;">use-package</span> pyvenv
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (setenv <span style="color: #8b2252;">"WORKON_HOME"</span> <span style="color: #8b2252;">"~/miniconda3/envs"</span>)
  (<span style="color: #a020f0;">setq</span> python-shell-interpreter <span style="color: #8b2252;">"python3"</span>)
  (pyvenv-mode t))
</pre>
</div>

<p>
需要把这里的 ~/miniconda3 路径换成自己的路径，一般默认或者在用户目录下，形如 `~/anaconda3`；或者在根目录下，形如 `/anaconda3`。使用 virtualenv 的话则不需要这行配置。
</p>

<p>
有了 pyvenv，我们打开 Python 项目，如果想要切换环境，就输入命令 `M-x pyvenv-workon`，它会列出所有可以切换的环境，配置中的设置就是为了能让 pyvenv 找到我们的 miniconda 环境。
</p>

<p>
想要使用 REPL，首先打开一个 Python 文件，然后使用快捷键 `C-c C-p` 调用命令 run-python，启动 Python 解释器，Emacs 会弹出一个名为 `*Python*` 的 buffer，就是 Python 的 REPL。随后我们光标放在 Python 文件的 buffer 中，可以选中一部分代码，或者不选表示全部代码，按 `C-c C-c` 调用命令 python-shell-send-buffer，把选中的代码发送到 REPL 中，此时 `*Python* buffer` 中就会相应地执行了这些代码。
</p>

<p>
此外，对于 IPython Notebook 文件（.ipynb），有一个 <a href="https://github.com/millejoh/emacs-ipython-notebook">emacs-ipython-notebook</a> 插件可以提供支持。
</p>


<ol class="org-ol">
<li>LSP</li>
</ol>

<p>
Python 的 language server 比较多，包括 <a href="https://github.com/python-lsp/python-lsp-server">python-language-server（pyls</a>）、<a href="https://github.com/davidhalter/jedi">Jedi</a>、<a href="https://github.com/Microsoft/python-language-server">Microsoft Python Language Server</a> 和 <a href="https://github.com/microsoft/pyright">Pyright</a>。pyls 普遍评价是比较慢，所以不推荐使用。后三个可以根据自己喜好选择。 这里选择了评价较好的 Pyright。可以通过 `pip3 install pyright` 来手动安装。Emacs 中的相应配置如下：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> lsp-pyright
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  <span style="color: #483d8b;">:hook</span>
  (python-mode . (<span style="color: #a020f0;">lambda</span> ()
                  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">lsp-pyright</span>)
                  (lsp-deferred))))
</pre>
</div>


<ul class="org-ul">
<li>创建一个目录，写你的py代码文件</li>
<li>`M-x lsp-install-server`安装pyright</li>
<li>`M-x lsp` 初始化，将项目作为根目录方式导入</li>
</ul>

<p>
其它参考：<a href="https://www.ichenxiaoyu.com/emacs_python3/">https://www.ichenxiaoyu.com/emacs_python3/</a>
</p>

<p>
注意，在图形界面中，尤其是 macOS 上，可能会出现明明安装了 pyright 但是 lsp 提示无法找到该命令的情况，遇到这个问题，请记得安装上面“环境变量” 小节的插件 `exec-path-from-shell` 。
</p>

<ol class="org-ol">
<li>调试</li>
</ol>

<p>
使用 dap-mode 调试前需先手动通过 pip 安装 python3 -m pip install ptvsd。
</p>
</div>
<div id="outline-container-h:56ad8f41-8b2b-4326-924b-1e1a0ca0d82d" class="outline-5">
<h5 id="h:56ad8f41-8b2b-4326-924b-1e1a0ca0d82d">方法2python-palantir</h5>
<div class="outline-text-5" id="text-h:56ad8f41-8b2b-4326-924b-1e1a0ca0d82d">
<ul class="org-ul">
<li><a href="https://emacs-lsp.github.io/lsp-mode/page/lsp-pyls/">https://emacs-lsp.github.io/lsp-mode/page/lsp-pyls/</a></li>
</ul>

<p>
进入py3的虚拟环境，再执行emacs
</p>

<p>
#+end_src 
pip3 install python-language-server
#+end_src
</p>

<p>
`C-c C-p`打开交互式python
</p>

<p>
`C-c C-c` 缓存内容执行
</p>
</div>
</div>
<div id="outline-container-h:388b9233-a1ea-453e-8ef1-97db186a7718" class="outline-5">
<h5 id="h:388b9233-a1ea-453e-8ef1-97db186a7718">旧方法python jedi</h5>
<div class="outline-text-5" id="text-h:388b9233-a1ea-453e-8ef1-97db186a7718">
<p>
这里我的环境默为python3
</p>

<p>
python-mode
</p>

<p>
`C-c C-p`打开交互式python
</p>

<p>
`C-c C-c` 缓存内容执行
</p>

<p>
<b><b>安装flycheck插件</b></b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> flycheck
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (global-flycheck-mode t))
</pre>
</div>

<p>
<b><b>安装外部的语法检查器pylint</b></b>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">python3</span>
pip install pylint
</pre>
</div>

<p>
<b><b>安装python补全插件Jedi</b></b>
</p>

<ul class="org-ul">
<li>Jedi <a href="https://github.com/tkf/emacs-jedi">https://github.com/tkf/emacs-jedi</a></li>
</ul>

<p>
我使用的另一个工具是<a href="https://github.com/tkf/emacs-jedi">Jedi</a>。它为 Python 提供了更广泛的补全。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> jedi
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (add-hook 'python-mode-hook 'jedi:setup)
  (add-hook 'python-mode-hook 'jedi:ac-setup))
</pre>
</div>

<p>
要让 jedi 工作，您需要安装 jedi 服务器，该服务器通过运行 `M-x jedi:install-server` 在 emacs 中完成。但是，要使其正常工作，您需要安装 Python Virtualenv。我这样做了:
</p>

<div class="org-src-container">
<pre class="src src-shell">sudo pip install virtualenv
</pre>
</div>

<p>
之后的改动
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> py-python-command <span style="color: #8b2252;">"python3"</span>)
(<span style="color: #a020f0;">setq</span> python-shell-interpreter <span style="color: #8b2252;">"python3"</span>)

(<span style="color: #a020f0;">use-package</span> jedi
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
  (add-hook 'python-mode-hook 'jedi:setup)
  (add-hook 'python-mode-hook 'jedi:ac-setup))

(<span style="color: #a020f0;">use-package</span> virtualenvwrapper
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (venv-initialize-interactive-shells)
  (venv-initialize-eshell))
</pre>
</div>

<p>
示例py文件
</p>

<p>
#+end_srcpython
import random
  x = 2
print("hello")
def f(x):
    return random.randrange(1,x)
</p>

<p>
for i in range(2, 10):
    print(f(i))
#+end_src
</p>
</div>
</div>
<div id="outline-container-h:8873e0c7-d4e1-4362-9f6b-85b82ef38c44" class="outline-5">
<h5 id="h:8873e0c7-d4e1-4362-9f6b-85b82ef38c44">旧方法python elpy</h5>
<div class="outline-text-5" id="text-h:8873e0c7-d4e1-4362-9f6b-85b82ef38c44">
<ul class="org-ul">
<li>elpy python语法检查<a href="https://github.com/jorgenschaefer/elpy">https://github.com/jorgenschaefer/elpy</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> elpy
<span style="color: #483d8b;">:ensure</span> t
<span style="color: #483d8b;">:config</span>
(elpy-enable))
</pre>
</div>

<p>
`C-c C-d`文档
</p>

<p>
我不认为这是一个我会经常使用的包，因为我使用其他工具来做类似的事情
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> py-python-command <span style="color: #8b2252;">"python3"</span>)
(<span style="color: #a020f0;">setq</span> python-shell-interpreter <span style="color: #8b2252;">"python3"</span>)

(<span style="color: #a020f0;">use-package</span> elpy
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:custom</span> (elpy-rpc-backend <span style="color: #8b2252;">"jedi"</span>)
  <span style="color: #483d8b;">:config</span> 
  (elpy-enable)
)

(<span style="color: #a020f0;">use-package</span> virtualenvwrapper
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (venv-initialize-interactive-shells)
  (venv-initialize-eshell))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:90a4fd8b-24f7-41ac-ac82-decd85de8834" class="outline-4">
<h4 id="h:90a4fd8b-24f7-41ac-ac82-decd85de8834">LSP-go语言环境</h4>
<div class="outline-text-4" id="text-h:90a4fd8b-24f7-41ac-ac82-decd85de8834">
<p>
参考：<a href="https://github.com/golang/tools/blob/master/gopls/doc/emacs.md">https://github.com/golang/tools/blob/master/gopls/doc/emacs.md</a>
</p>

<p>
环境变量
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #a0522d;">GO111MODULE</span>=on go install golang.org/x/tools/gopls@latest

<span style="color: #b22222;"># </span><span style="color: #b22222;">.bash_profile or .zshrc</span>
<span style="color: #483d8b;">export</span> <span style="color: #a0522d;">GOPATH</span>=<span style="color: #8b2252;">"$(</span><span style="color: #ff00ff;">go env GOPATH</span><span style="color: #8b2252;">)"</span>
<span style="color: #483d8b;">export</span> <span style="color: #a0522d;">PATH</span>=<span style="color: #8b2252;">"${PATH}:${GOPATH}/bin"</span>
</pre>
</div>

<p>
安装 go 相关插件
参考：<a href="https://github.com/seagle0128/.emacs.d/blob/754eb554ca2dd22807898bd5a4257a57f6ab5cfd/lisp/init-go.el">seagle0128/.emacs.d init-go.el</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> go-mode
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Golang</span>
(<span style="color: #a020f0;">use-package</span> go-mode
  <span style="color: #483d8b;">:functions</span> go-update-tools
  <span style="color: #483d8b;">:commands</span> godoc-gogetdoc
  <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> go-mode-map
         (<span style="color: #8b2252;">"C-c R"</span> . go-remove-unused-imports)
         (<span style="color: #8b2252;">"&lt;f1&gt;"</span> . godoc-at-point))
  <span style="color: #483d8b;">:init</span> (<span style="color: #a020f0;">setq</span> godoc-at-point-function #'godoc-gogetdoc)
  <span style="color: #483d8b;">:config</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Env vars</span>
  (<span style="color: #a020f0;">with-eval-after-load</span> 'exec-path-from-shell
    (exec-path-from-shell-copy-envs '(<span style="color: #8b2252;">"GOPATH"</span> <span style="color: #8b2252;">"GO111MODULE"</span> <span style="color: #8b2252;">"GOPROXY"</span>)))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Install or update tools</span>
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">go--tools</span> '(<span style="color: #8b2252;">"golang.org/x/tools/gopls"</span>
                      <span style="color: #8b2252;">"golang.org/x/tools/cmd/goimports"</span>
                      <span style="color: #8b2252;">"honnef.co/go/tools/cmd/staticcheck"</span>
                      <span style="color: #8b2252;">"github.com/go-delve/delve/cmd/dlv"</span>
                      <span style="color: #8b2252;">"github.com/zmb3/gogetdoc"</span>
                      <span style="color: #8b2252;">"github.com/josharian/impl"</span>
                      <span style="color: #8b2252;">"github.com/cweill/gotests/..."</span>
                      <span style="color: #8b2252;">"github.com/fatih/gomodifytags"</span>
                      <span style="color: #8b2252;">"github.com/davidrjenni/reftools/cmd/fillstruct"</span>)
    <span style="color: #8b2252;">"All necessary go tools."</span>)

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">go-update-tools</span> ()
    <span style="color: #8b2252;">"Install or update go tools."</span>
    (<span style="color: #a020f0;">interactive</span>)
    (<span style="color: #a020f0;">unless</span> (executable-find <span style="color: #8b2252;">"go"</span>)
      (<span style="color: #ff0000; font-weight: bold;">user-error</span> <span style="color: #8b2252;">"Unable to find `</span><span style="color: #008b8b;">go</span><span style="color: #8b2252;">' in `</span><span style="color: #008b8b;">exec-path</span><span style="color: #8b2252;">'!"</span>))

    (message <span style="color: #8b2252;">"Installing go tools..."</span>)
    (<span style="color: #a020f0;">dolist</span> (pkg go--tools)
      (set-process-sentinel
       (start-process <span style="color: #8b2252;">"go-tools"</span> <span style="color: #8b2252;">"*Go Tools*"</span> <span style="color: #8b2252;">"go"</span> <span style="color: #8b2252;">"install"</span> <span style="color: #8b2252;">"-v"</span> <span style="color: #8b2252;">"-x"</span> (concat pkg <span style="color: #8b2252;">"@latest"</span>))
       (<span style="color: #a020f0;">lambda</span> (proc _)
         (<span style="color: #a020f0;">let</span> ((status (process-exit-status proc)))
           (<span style="color: #a020f0;">if</span> (= 0 status)
               (message <span style="color: #8b2252;">"Installed %s"</span> pkg)
             (message <span style="color: #8b2252;">"Failed to install %s: %d"</span> pkg status)))))))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Try to install go tools if `</span><span style="color: #008b8b;">gopls</span><span style="color: #b22222;">' is not found</span>
  (<span style="color: #a020f0;">unless</span> (executable-find <span style="color: #8b2252;">"gopls"</span>)
    (go-update-tools))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Misc</span>
  (<span style="color: #a020f0;">use-package</span> go-dlv)
  (<span style="color: #a020f0;">use-package</span> go-fill-struct)
  (<span style="color: #a020f0;">use-package</span> go-impl)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Install: See https://github.com/golangci/golangci-lint#install</span>
  (<span style="color: #a020f0;">use-package</span> flycheck-golangci-lint
    <span style="color: #483d8b;">:if</span> (executable-find <span style="color: #8b2252;">"golangci-lint"</span>)
    <span style="color: #483d8b;">:after</span> flycheck
    <span style="color: #483d8b;">:defines</span> flycheck-disabled-checkers
    <span style="color: #483d8b;">:hook</span> (go-mode . (<span style="color: #a020f0;">lambda</span> ()
                       <span style="color: #8b2252;">"Enable golangci-lint."</span>
                       (<span style="color: #a020f0;">setq</span> flycheck-disabled-checkers '(go-gofmt
                                                          go-golint
                                                          go-vet
                                                          go-build
                                                          go-test
                                                          go-errcheck))
                       (flycheck-golangci-lint-setup))))

  (<span style="color: #a020f0;">use-package</span> go-tag
    <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> go-mode-map
           (<span style="color: #8b2252;">"C-c t a"</span> . go-tag-add)
           (<span style="color: #8b2252;">"C-c t r"</span> . go-tag-remove))
    <span style="color: #483d8b;">:init</span> (<span style="color: #a020f0;">setq</span> go-tag-args (list <span style="color: #8b2252;">"-transform"</span> <span style="color: #8b2252;">"camelcase"</span>)))

  (<span style="color: #a020f0;">use-package</span> go-gen-test
    <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> go-mode-map
           (<span style="color: #8b2252;">"C-c t g"</span> . go-gen-test-dwim)))

  (<span style="color: #a020f0;">use-package</span> gotest
    <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> go-mode-map
           (<span style="color: #8b2252;">"C-c t f"</span> . go-test-current-file)
           (<span style="color: #8b2252;">"C-c t t"</span> . go-test-current-test)
           (<span style="color: #8b2252;">"C-c t j"</span> . go-test-current-project)
           (<span style="color: #8b2252;">"C-c t b"</span> . go-test-current-benchmark)
           (<span style="color: #8b2252;">"C-c t c"</span> . go-test-current-coverage)
           (<span style="color: #8b2252;">"C-c t x"</span> . go-run))))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">Local Golang playground for short snippets</span>
(<span style="color: #a020f0;">use-package</span> go-playground
  <span style="color: #483d8b;">:diminish</span>
  <span style="color: #483d8b;">:commands</span> (go-playground-mode))

(<span style="color: #a020f0;">provide</span> '<span style="color: #008b8b;">init-go</span>)
</pre>
</div>

<p>
报错：
</p>
<div class="org-src-container">
<pre class="src src-shell">LSP :: The following servers support current file but<span style="color: #a020f0;"> do</span> not have automatic installation: gopls
</pre>
</div>
<p>
原因：执行 `(executable-find "gopls")` 没有找到 gopls 命令，检查环境变量配置
解决：<a href="https://geeksocket.in/posts/emacs-lsp-go/">参考这里</a>
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #483d8b;">export</span> <span style="color: #a0522d;">GOPATH</span>=<span style="color: #8b2252;">"$(</span><span style="color: #ff00ff;">go env GOPATH</span><span style="color: #8b2252;">)"</span>
<span style="color: #483d8b;">export</span> <span style="color: #a0522d;">PATH</span>=<span style="color: #8b2252;">"${PATH}:${GOPATH}/bin"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:c60aafb9-64f9-41b5-bc7f-86d8c7f84f32" class="outline-4">
<h4 id="h:c60aafb9-64f9-41b5-bc7f-86d8c7f84f32">LSP-c++语言环境</h4>
<div class="outline-text-4" id="text-h:c60aafb9-64f9-41b5-bc7f-86d8c7f84f32">
<ol class="org-ol">
<li>编译</li>
</ol>
<p>
Emacs 本身就有一个 compile 函数可以用来编译 C/C++ 文件。打开一个 C/C++ 项目，使用默认配置调用 M-x compile，它会提示 make -k 来进行编译，也就是会默认我们是一个 make 项目。 如果我们没有 Makefile，例如我们在做算法题，只是想直接单独编译一个源文件，那么也可以直接手动输入命令：
</p>

<div class="org-src-container">
<pre class="src src-sh">$ g++ prog.cpp -g -o exec
</pre>
</div>

<p>
事实上，这个默认值是一个 Emacs 字符串变量，如果我们希望在这个项目里使用一个固定的编译命令，就可以利用上文“局部变量”小节中提到的办法自定义局部变量 compile-command 为我们想要的编译命令。 如果我们在之前的基础上设置，会得到如下的 .dir-locals.el 文件：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">Directory Local Variables</span>
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">For more information see (info "(emacs) Directory Variables")</span>

((c++-mode . ((compile-command . <span style="color: #8b2252;">"g++ main.cpp -g -o exec"</span>)
              (flycheck-clang-language-standard . <span style="color: #8b2252;">"c++11"</span>))))
</pre>
</div>

<p>
但是显然，这里我们写死了源代码文件 main.cpp，对于一些特定小项目是可以的， 但是对于刷算法题这种需求却并不好用，因为我们不同的题目是放在不同的源文件中，每个都单独可编译。为此，我们需要让 Emacs 自己为编译命令填写当前的源码文件（这里其实就是我们手动实现一个类似 VSCode 的 Code Runner 插件）。
</p>

<p>
首先我们可以在 init.el （或者是任何你自己定义的 elisp 文件中）定义两个函数：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">file-name-only</span> ()
  <span style="color: #8b2252;">"Get the current buffer file name without directory."</span>
  (file-name-nondirectory (buffer-name)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">file-name-only-noext</span> ()
  <span style="color: #8b2252;">"Get the currennt buffer file name without directory and extension."</span>
  (file-name-sans-extension (file-name-only)))
</pre>
</div>

<p>
前者可以获得当前所在 buffer 的文件名，后者则得到了文件名除去后缀名的名字（用来做可执行文件名）。
</p>

<p>
随后我们设置 compile-command 为：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(concat <span style="color: #8b2252;">"clang++ -g "</span> (file-name-only) <span style="color: #8b2252;">" -o "</span> (file-name-only-noext))
</pre>
</div>

<p>
其中 concat 是一个字符串拼接函数，可以理解为：
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b2252;">"clang++ -g "</span> + (file-name-only) + <span style="color: #8b2252;">" -o "</span> + (file-name-only-noext)
</pre>
</div>

<p>
最终得到这样的 .dir-locals.el：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">((c++-mode . ((compile-command . (concat <span style="color: #8b2252;">"clang++ -g "</span>
                                  (file-name-only)
                                  <span style="color: #8b2252;">" -o "</span>
                                  (file-name-only-noext)))
              (flycheck-clang-language-standard . <span style="color: #8b2252;">"c++11"</span>))))
</pre>
</div>

<p>
这样当我们调用 compile 命令时，可以利用字符串拼接自动补全当前所在的源文件并编译成相应的可执行文件。注意其中的 -g 选项是用于 debug 的选项 。读者也可以直接修改 .dir-locals.el 文件，只不过括号比较多需要注意不要出错。
</p>

<ol class="org-ol">
<li>LSP</li>
</ol>

<p>
前文提到，LSP 需要针对每个语言有一个后端程序提供分析功能。对于 C/C++ 笔者所使用的是 llvm 下的 <a href="https://clangd.llvm.org/">clangd</a> 工具，还可以选择<a href="https://github.com/MaskRay/ccls">ccls</a>。安装可以参照<a href="https://clangd.llvm.org/installation">它的官</a>网，简单来说，对于 macOS，安装了 llvm 就有了 clangd；对于 Debian/Ubuntu 可以直接用 apt 安装。
</p>

<p>
每种语言的 language server 都被 lsp 插件官网贴心地罗列了出来。
对于项目需要一些特殊的编译选项，例如自定义头文件、库等，需要参照<a href="https://clangd.llvm.org/installation#project-setup">clangd 的文档</a>进行设置，简单来说，就是在项目目录下创建一个 compile_commands.json 文件，把编译选项写在里面就好。写好后，clangd 在分析代码时就会使用这些选项了。
</p>

<p>
对于 CMake 项目，CMake 可以直接生成 compile_commands.json 文件给 clangd 使用，参考 <a href="https://clangd.llvm.org/installation#project-setup">clangd 的文档</a>。此外，Emacs 也可以安装专门为 LSP 设计的 <a href="https://github.com/regen100/cmake-language-server">cmake-language-server</a>，再或者也可以使用 <a href="https://github.com/atilaneves/cmake-ide">cmake-ide</a> 插件（但就不走 lsp 插件了）。
</p>

<p>
C/C++ 配置如下，其中 c-toggle-hungry-state 函数是为了在按下删除键时尽可能删除多余空白字符，例如缩进的空白、空行等，会自动删除到一个非空白字符，读者可以根据需要开启：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> c++-mode
  <span style="color: #483d8b;">:functions</span>                    <span style="color: #b22222;">; </span><span style="color: #b22222;">suppress warnings</span>
  c-toggle-hungry-state
  <span style="color: #483d8b;">:hook</span>
  (c-mode . lsp-deferred)
  (c++-mode . lsp-deferred)
  (c++-mode . c-toggle-hungry-state))
</pre>
</div>

<ol class="org-ol">
<li>调试</li>
</ol>

<p>
Emacs 本身可以直接使用 M-x gdb 利用 gdb 进行调试。
</p>

<p>
那么我们更希望使用 dap-mode， 笔者选择使用 llvm 下的 lldb-vscode 工具做后端进行调试。安装 llvm 后应该已经安装好了这个工具，否则手动安装就好。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> dap-lldb
  <span style="color: #483d8b;">:after</span> dap-mode
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> dap-lldb-debug-program '(<span style="color: #8b2252;">"/usr/local/opt/llvm/bin/lldb-vscode"</span>))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">ask user for executable to debug if not specified explicitly (c++)</span>
  (<span style="color: #a020f0;">setq</span> dap-lldb-debugged-program-function
                (<span style="color: #a020f0;">lambda</span> () (read-file-name <span style="color: #8b2252;">"Select file to debug: "</span>))))
</pre>
</div>

<p>
配置中明确指定了 lldb-vscode 的路径。这里的路径是 macOS 上通过 Homebrew 安装 llvm 的路径，其它平台的路径需要自行确定。
</p>

<p>
除了 lldb-vscode，也可以使用其它方式如 vscode-cpptools、GDB 等，可以参考 <a href="https://emacs-lsp.github.io/dap-mode/page/configuration/#native-debug-gdblldb">dap-mode 的手册</a>。
</p>

<p>
macOS 上（Linux 未测试）直接使用默认的 lldb 做 debug 会提示 Failed to load MI Debugger。这是因为 llvm-mi 被移出了 llvm 项目成为了一个单独项目，所以并未一同安装。 需要克隆源码安装一下（请事先选择好一个合适的存放目录进行操作）：
</p>

<div class="org-src-container">
<pre class="src src-sh">$ git clone https://github.com/lldb-tools/lldb-mi.git
$ mkdir -p lldb-mi/build
$ cd lldb-mi/build
$ cmake ..
$ cmake --build .
$ ln -s $<span style="color: #a0522d;">PWD</span>/src/lldb-mi /usr/local/bin/lldb-mi
</pre>
</div>

<p>
最后的链接命令可以改成你觉得合适的其它路径，只要在环境变量中就好。安装好后，就可以直接使用 lldb。macOS 上 dap-mode 使用 gdb 会有问题.
</p>
</div>
<div id="outline-container-h:22dbe2b5-eb58-445a-b4b4-fc25095dc143" class="outline-5">
<h5 id="h:22dbe2b5-eb58-445a-b4b4-fc25095dc143">非lsp</h5>
<div class="outline-text-5" id="text-h:22dbe2b5-eb58-445a-b4b4-fc25095dc143">
<p>
<b>安装C/C++编译程序</b>
</p>

<p>
macos
</p>
<div class="org-src-container">
<pre class="src src-sh">brew install gcc
brew install gdb

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26816;&#26597;</span>
gcc --version
g++ --version
clang --version
gdb --version
</pre>
</div>

<p>
windows
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#19979;&#36733; https://www.msys2.org/ &#23433;&#35013; mysys2</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#23433;&#35013; C/C++ &#24517;&#35201;&#30340;&#36719;&#20214;&#24037;&#20855;</span>
pacman -Syu <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26356;&#26032;&#24211;</span>
pacman -S mingw-w64-x86_64-gcc mingw-w64-x86_64-gdb make mingw-w64-x86_64-clang mingw-w64-x86_64-clang-tools-extra

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#26816;&#26597;</span>
gcc --version
g++ --version
clang --version
gdb --version
</pre>
</div>

<p>
重启emacs，让环境生效。
</p>

<p>
<b>安装 <a href="https://github.com/joaotavora/eglot">eglot</a> (Emacs 29 自带 eglot)</b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> eglot
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:hook</span> ((c-mode
          c++-mode) <span style="color: #ff0000; font-weight: bold;">. eglot-ensure)</span>
  <span style="color: #483d8b;">:config</span>
  (add-to-list 'eglot-server-programs '((c++-mode c-mode) <span style="color: #8b2252;">"clangd"</span>))
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">eglot-actions-before-save</span>()
    (add-hook 'before-save-hook #'eglot-format-buffer))
  (add-hook 'eglot--managed-mode-hook #'eglot-actions-before-save))
</pre>
</div>

<p>
<b>一键运行代码</b>
</p>

<ul class="org-ul">
<li>安装quickrun</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> quickrun
    <span style="color: #483d8b;">:ensure</span> t
    <span style="color: #483d8b;">:commands</span> (quickrun)
    <span style="color: #483d8b;">:init</span>
    (quickrun-add-command <span style="color: #8b2252;">"c++/c1z"</span>
    '((<span style="color: #483d8b;">:command</span> . <span style="color: #8b2252;">"g++"</span>)
        (<span style="color: #483d8b;">:exec</span> . (<span style="color: #8b2252;">"%c -std=c++1z %o -o %e %s"</span>
                <span style="color: #8b2252;">"%e %a"</span>))
        (<span style="color: #483d8b;">:remove</span> . (<span style="color: #8b2252;">"%e"</span>)))
    <span style="color: #483d8b;">:default</span> <span style="color: #8b2252;">"c++"</span>))
</pre>
</div>

<ul class="org-ul">
<li>自定义快捷键</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #8b2252;">"&lt;f5&gt;"</span>) 'quickrun)
</pre>
</div>


<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-c++"><span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;iostream&gt;</span>
<span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;iterator&gt;</span>
<span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;vector&gt;</span>

<span style="color: #a020f0;">using</span> <span style="color: #a020f0;">namespace</span> <span style="color: #008b8b;">std</span>;

<span style="color: #228b22;">int</span> <span style="color: #0000ff;">main</span>()
{
  <span style="color: #228b22;">vector</span>&lt;<span style="color: #228b22;">int</span>&gt; <span style="color: #a0522d;">myVec</span>;
  myVec.push_back(2);
  myVec.push_back(3);
  cout &lt;&lt; <span style="color: #8b2252;">"Hello World"</span> &lt;&lt; endl;

  cout &lt;&lt; <span style="color: #8b2252;">"vect size: "</span> &lt;&lt; myVec.size() &lt;&lt; endl;
  <span style="color: #a020f0;">return</span> 0;
}
</pre>
</div>

<p>
按 F5 查看运行结果。
</p>

<p>
<b>调试代码</b>
</p>

<ul class="org-ul">
<li><code>M-x compile</code> 默认为 <code>make -k</code> ,改为 <code>g++ -g -o test.o test.cpp</code> ， 这样就会自动调用这个命令编译代码</li>
<li><code>M-x gud-gdb</code> 启用gdb，输入 <code>gdb ./test.o</code> 装载 test.o 文件。</li>
<li>常用调试命令</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">list    &#26174;&#31034;&#28304;&#20195;&#30721;
<span style="color: #a020f0;">break</span>   &#26032;&#22686;&#26029;&#28857;&#65292; break main, break 12&#65288;&#34892;&#21495;&#65289;
info    &#26597;&#30475;&#26029;&#28857;&#25110;&#32773;&#23616;&#37096;&#21464;&#37327;&#20449;&#24687; info breakpoints, info locals
run     &#24320;&#22987;&#35843;&#35797;
next    &#31867;&#20284; step over
step    &#36339;&#36716;&#21040;&#20989;&#25968;&#20869;&#37096;
<span style="color: #a020f0;">continue</span>        &#32487;&#32493;&#36816;&#34892;&#21040;&#19979;&#19968;&#20010;&#26029;&#28857;
quit    &#36864;&#20986;&#35843;&#35797;
watch   &#20869;&#23384;&#26029;&#28857;
display &#31867;&#20284; IDE &#37324;&#38754;&#30340; watch &#21151;&#33021;
<span style="color: #a020f0;">break</span> 11 if xxx &#26465;&#20214;&#26029;&#28857;
</pre>
</div>

<p>
范例：
断点调试：
</p>
<ul class="org-ul">
<li>list 列出代码</li>
<li><code>break 11</code> 在 11 行下断点</li>
<li><code>break 12</code> 在 12 行下断点</li>
<li><code>info breakpoints</code> 列出断点</li>
<li><code>run</code> 程序停在了 11 行</li>
<li><code>print myVec</code> 打印对应值</li>
<li><code>next</code> 下一行</li>
<li><code>print myVec</code> 打印对应值</li>
<li><code>continue</code> 运行到下一个断点</li>
</ul>

<div class="org-src-container">
<pre class="src src-c++"><span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;iostream&gt;</span>
<span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;iterator&gt;</span>
<span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;vector&gt;</span>

<span style="color: #a020f0;">using</span> <span style="color: #a020f0;">namespace</span> <span style="color: #008b8b;">std</span>;

<span style="color: #228b22;">int</span> <span style="color: #0000ff;">add</span> (<span style="color: #228b22;">int</span> <span style="color: #a0522d;">a</span> , <span style="color: #228b22;">int</span> <span style="color: #a0522d;">b</span>)
{
  <span style="color: #a020f0;">return</span> a + b;
}

<span style="color: #228b22;">int</span> <span style="color: #0000ff;">main</span>()
{
  <span style="color: #228b22;">vector</span>&lt;<span style="color: #228b22;">int</span>&gt; <span style="color: #a0522d;">myVec</span>;
  myVec.push_back(2);
  myVec.push_back(3);
  myVec.push_back(add(3,4));

  <span style="color: #a020f0;">for</span> (<span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span> = 0; i &lt; 5000; i++) {
    myVec.push_back(i);
  }
  cout &lt;&lt; <span style="color: #8b2252;">"Hello World"</span> &lt;&lt; endl;

  cout &lt;&lt; <span style="color: #8b2252;">"vect size: "</span> &lt;&lt; myVec.size() &lt;&lt; endl;
  <span style="color: #a020f0;">return</span> 0;
}
</pre>
</div>
<ul class="org-ul">
<li><code>b add</code> b 为 break 缩写，add 是代码对应的函数</li>
<li><code>b 20 if i == 2500</code> 条件断点，第 20 行 i 为 2500 时</li>
<li><code>run</code></li>
<li><code>info locals</code> 查看局部变量</li>
<li><code>cont</code>  continue 缩写</li>
<li><code>info locals</code> 查看局部变量</li>
<li><code>display myVec</code> 每次运行程序都显示 myVec 值。display 类似 ide 调试中的 watch</li>
<li><code>next</code></li>
<li><code>print i</code></li>
<li><code>quit</code> 退出</li>
</ul>





<p>
<b>Snippets代码块补插件</b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20195;&#30721;&#34917;&#20840;&#25554;&#20214;</span>
(<span style="color: #a020f0;">use-package</span> yasnippet
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:init</span>
    (yas-global-mode 1))

(<span style="color: #a020f0;">use-package</span> yasnippet-snippets
  <span style="color: #483d8b;">:ensure</span> t)
(<span style="color: #a020f0;">use-package</span> yasnippet-classic-snippets
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<p>
<b><b>标签跳转</b></b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">tags for code navigation  </span>
(<span style="color: #a020f0;">use-package</span> ggtags
<span style="color: #483d8b;">:ensure</span> t
<span style="color: #483d8b;">:config</span>
(add-hook 'c-mode-common-hook
(<span style="color: #a020f0;">lambda</span> ()
(<span style="color: #a020f0;">when</span> (derived-mode-p 'c-mode 'c++-mode 'java-mode)
(ggtags-mode 1))))
)
</pre>
</div>

<p>
`M-.`跳转
</p>

<p>
`M-x speedbar`标签树
</p>
</div>
</div>
</div>
<div id="outline-container-h:23b168ff-d6ce-4c30-bd71-63e4d97f635d" class="outline-4">
<h4 id="h:23b168ff-d6ce-4c30-bd71-63e4d97f635d">前端开发</h4>
<div class="outline-text-4" id="text-h:23b168ff-d6ce-4c30-bd71-63e4d97f635d">
</div>
<div id="outline-container-h:51861f70-f1c7-433d-991a-08c39500b4eb" class="outline-5">
<h5 id="h:51861f70-f1c7-433d-991a-08c39500b4eb">web-mode 插件</h5>
<div class="outline-text-5" id="text-h:51861f70-f1c7-433d-991a-08c39500b4eb">
<p>
Emacs 自带的 HTML Mode 使用起来并不是那么的方便，而 web-mode 则是一个非常常用也 很强大的用于编辑前端代码的 Major Mode（你可以在<a href="https://github.com/fxbois/web-mode">这里</a>找到更多关于它的信息）。
</p>

<ul class="org-ul">
<li>web-mode <a href="https://github.com/fxbois/web-mode">https://github.com/fxbois/web-mode</a></li>
</ul>

<p>
首先我们需要安装它，照例我们需要将其添加至我们的插件列表中去。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">mypackages</span> '(
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">web-mode</span>
         web-mode
         ) <span style="color: #ff0000; font-weight: bold;">"Default packages"</span><span style="color: #ff0000; font-weight: bold;">)</span>
</pre>
</div>

<p>
在安装完成后我们就可以开始配置它了，首先我们需要做的是将所有的 `*.html` 文件都使 用 web-mode 来打开。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> auto-mode-alist
      (append
       '((<span style="color: #8b2252;">"\\.js\\'"</span> . js2-mode))
       '((<span style="color: #8b2252;">"\\.html\\'"</span> . web-mode))
       auto-mode-alist))
</pre>
</div>

<p>
这样所有的 HTML 代码在 Emacs 中就会之间启用 web-mode 而非默认的 HTML Mode 了。你 可以阅读它的<a href="http://web-mode.org/">文档</a>来学习更多 web-mode 详细的使用方法。
</p>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> web-mode
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (add-to-list 'auto-mode-alist '(<span style="color: #8b2252;">"\\.html?\\'"</span> . web-mode))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20851;&#32852;&#24341;&#25806;</span>
  (<span style="color: #a020f0;">setq</span> web-mode-engines-alist
  '((<span style="color: #8b2252;">"django"</span>  . <span style="color: #8b2252;">"\\.html\\'"</span>)
    (<span style="color: #8b2252;">"php"</span>    . <span style="color: #8b2252;">"\\.phtml\\'"</span>)))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#19978;&#19979;&#25991;&#24863;&#30693;&#33258;&#21160;&#23436;&#25104;</span>
  (<span style="color: #a020f0;">setq</span> web-mode-ac-sources-alist
  '((<span style="color: #8b2252;">"css"</span> . (ac-source-css-property))
    (<span style="color: #8b2252;">"html"</span> . (ac-source-words-in-buffer ac-source-abbrev))))
  (<span style="color: #a020f0;">setq</span> web-mode-enable-auto-closing t))
</pre>
</div>

<p>
使用
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">&#33258;&#21160;&#34917;&#20840;&#26631;&#31614;&#65306;&lt;/  &#25110;&#32773;&#21629;&#20196;`C-c C-e /`
&#23383;&#31526;&#21152;&#26631;&#31614;  &#65306;&#36873;&#20013;&#23383;&#31526;&#65292;`C-c C-e w` &#36755;&#20837;&#26631;&#31614;&#21517; 
&#27880;&#37322;        &#65306;&#20351;&#29992; `M-<span style="color: #b22222;">;</span><span style="color: #b22222;">` &#23601;&#21487;&#20197;&#27880;&#37322;&#24403;&#21069;&#34892;&#20195;&#30721;&#25110;&#36873;&#20013;&#34892;&#30340;&#20195;&#30721;&#12290;</span>
&#26631;&#31614;&#25240;&#21472;    &#65306;`C-c C-f`
</pre>
</div>

<p>
html
</p>

<p>
#+end_srchtml
&lt;!doctype html&gt;
&lt;html&gt;
    &lt;h1&gt;hello&lt;/h1&gt;
    &lt;h2&gt;content in between&lt;/h2&gt;
    &lt;ol&gt;
  &lt;li&gt;one&lt;/li&gt;
    &lt;/ol&gt;
&lt;/html&gt;
&lt;h3&gt;here&lt;/h3&gt;
&lt;h4&gt;hehe&lt;/h4&gt;
    &lt;ol&gt;
  one
  two
    &lt;/ol&gt;
&lt;/html&gt;
#+end_src
</p>

<p>
web-mode配置
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">config for web-mode</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">web-mode &#20195;&#30721;&#32553;&#36827;2&#20010;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-web-mode-indent-setup</span> ()
  (<span style="color: #a020f0;">setq</span> web-mode-markup-indent-offset 2) <span style="color: #b22222;">; </span><span style="color: #b22222;">web-mode, html tag in html file</span>
  (<span style="color: #a020f0;">setq</span> web-mode-css-indent-offset 2)    <span style="color: #b22222;">; </span><span style="color: #b22222;">web-mode, css in html file</span>
  (<span style="color: #a020f0;">setq</span> web-mode-code-indent-offset 2)   <span style="color: #b22222;">; </span><span style="color: #b22222;">web-mode, js code in html file</span>
  )
(add-hook 'web-mode-hook 'my-web-mode-indent-setup)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">web-mode &#22312;2&#20010;&#31354;&#26684;&#21644;4&#20010;&#31354;&#26684;&#20043;&#38388;&#20999;&#25442;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-toggle-web-indent</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">web development</span>
  (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">or</span> (eq major-mode 'js-mode) (eq major-mode 'js2-mode))
      (<span style="color: #a020f0;">progn</span>
  (<span style="color: #a020f0;">setq</span> js-indent-level (<span style="color: #a020f0;">if</span> (= js-indent-level 2) 4 2))
  (<span style="color: #a020f0;">setq</span> js2-basic-offset (<span style="color: #a020f0;">if</span> (= js2-basic-offset 2) 4 2))))

  (<span style="color: #a020f0;">if</span> (eq major-mode 'web-mode)
      (<span style="color: #a020f0;">progn</span> (<span style="color: #a020f0;">setq</span> web-mode-markup-indent-offset (<span style="color: #a020f0;">if</span> (= web-mode-markup-indent-offset 2) 4 2))
       (<span style="color: #a020f0;">setq</span> web-mode-css-indent-offset (<span style="color: #a020f0;">if</span> (= web-mode-css-indent-offset 2) 4 2))
       (<span style="color: #a020f0;">setq</span> web-mode-code-indent-offset (<span style="color: #a020f0;">if</span> (= web-mode-code-indent-offset 2) 4 2))))
  (<span style="color: #a020f0;">if</span> (eq major-mode 'css-mode)
      (<span style="color: #a020f0;">setq</span> css-indent-offset (<span style="color: #a020f0;">if</span> (= css-indent-offset 2) 4 2)))

  (<span style="color: #a020f0;">setq</span> indent-tabs-mode nil))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">web-mode &#22312;2&#20010;&#31354;&#26684;&#21644;4&#20010;&#31354;&#26684;&#20043;&#38388;&#20999;&#25442; &#24555;&#25463;&#38190;</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-c t i"</span>) 'my-toggle-web-indent)

</pre>
</div>
</div>
</div>
<div id="outline-container-h:4b6fa779-2b9b-4336-9074-644a7e3dee82" class="outline-5">
<h5 id="h:4b6fa779-2b9b-4336-9074-644a7e3dee82">js2-refactor 插件</h5>
<div class="outline-text-5" id="text-h:4b6fa779-2b9b-4336-9074-644a7e3dee82">
<p>
js2-refactor 是一个用于重构 JavaScript 的插件，它是一个 Minor Mode，你可以在 <a href="https://github.com/magnars/js2-refactor.el">GitHub</a> 找到更多关于这个插件的信息。
</p>

<ul class="org-ul">
<li>js2-refactor <a href="https://github.com/magnars/js2-refactor.el">https://github.com/magnars/js2-refactor.el</a></li>
</ul>

<p>
我们使用刚刚所提到的方法来安装 js2-refactor 插件。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my/packages</span> '(
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">js2-refactor</span>
         js2-refactor
         ) <span style="color: #ff0000; font-weight: bold;">"Default packages"</span><span style="color: #ff0000; font-weight: bold;">)</span>
</pre>
</div>

<p>
在安装完成后，添加一个钩子（Hook）：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">config for js2-refactor</span>
(add-hook 'js2-mode-hook #'js2-refactor-mode)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">js2-refactor &#25552;&#21462;&#21069;&#32512;</span>
(js2r-add-keybindings-with-prefix <span style="color: #8b2252;">"C-c C-m"</span>)
</pre>
</div>

<p>
我们可以使用 `C-c C-m` 然后输入功能前缀，例如 `em` 是 extract-method 的前缀。更 多的功能和使用方法也可以在上面给出的链接中找到，所有的前缀也可以在<a href="https://github.com/magnars/js2-refactor.el#refactorings">这里</a>找到。
</p>
</div>
</div>
<div id="outline-container-h:11d04d3c-c69b-4844-a77d-a57ac5101ec0" class="outline-5">
<h5 id="h:11d04d3c-c69b-4844-a77d-a57ac5101ec0">优化 occur 与 imenu</h5>
<div class="outline-text-5" id="text-h:11d04d3c-c69b-4844-a77d-a57ac5101ec0">
<p>
下面的代码用于配置 Occur Mode 使其默认搜索当前被选中的或者在光标下的字符串：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">occur &#22686;&#24378;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">occur-dwim</span> ()
  <span style="color: #8b2252;">"Call `</span><span style="color: #008b8b;">occur</span><span style="color: #8b2252;">' with a sane default."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">push</span> (<span style="color: #a020f0;">if</span> (region-active-p)
      (buffer-substring-no-properties
       (region-beginning)
       (region-end))
    (<span style="color: #a020f0;">let</span> ((sym (thing-at-point 'symbol)))
      (<span style="color: #a020f0;">when</span> (stringp sym)
        (regexp-quote sym))))
  regexp-history)
  (call-interactively 'occur))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">occur &#22686;&#24378;</span>
(global-set-key (kbd <span style="color: #8b2252;">"M-s o"</span>) 'occur-dwim)
</pre>
</div>

<p>
`dwim` 是按我说的做的缩写（Do what I mean）。
</p>

<p>
Occur 可以用于显示变量或函数的定义，我们可以通过 popwin 的 customize-group 将定 义显示设置为右边而不是默认的底部（ `customize-group &gt; popwin &gt; Popup Window Position` 设置为 right），也可以在这里对其宽度进行调节。
</p>

<p>
Occur 与普通的搜索模式不同的是，`C-x o`它可以使用 Occur-Edit Mode (在弹出的窗口中按 `e` 进入编辑模式) 对搜索到的结果进行之间的编辑。`C-c C-c`完成编辑
</p>

<p>
imenu 可以显示当前所有缓冲区的列表，下面的配置可以让其拥有更精确的跳转，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">imenu &#21487;&#20197;&#26174;&#31034;&#24403;&#21069;&#25152;&#26377;&#32531;&#20914;&#21306;&#30340;&#21015;&#34920;&#65292;&#19979;&#38754;&#30340;&#37197;&#32622;&#21487;&#20197;&#35753;&#20854;&#25317;&#26377;&#26356;&#31934;&#30830;&#30340;&#36339;&#36716;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">js2-imenu-make-index</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">save-excursion</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq imenu-generic-expression '((nil "describe\\(\"\\(.+\\)\"" 1)))</span>
  (imenu--generic-function '((<span style="color: #8b2252;">"describe"</span> <span style="color: #8b2252;">"\\s-*describe\\s-*(\\s-*[\"']</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[\"']\\s-*,.*"</span> 1)
           (<span style="color: #8b2252;">"it"</span> <span style="color: #8b2252;">"\\s-*it\\s-*(\\s-*[\"']</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[\"']\\s-*,.*"</span> 1)
           (<span style="color: #8b2252;">"test"</span> <span style="color: #8b2252;">"\\s-*test\\s-*(\\s-*[\"']</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[\"']\\s-*,.*"</span> 1)
           (<span style="color: #8b2252;">"before"</span> <span style="color: #8b2252;">"\\s-*before\\s-*(\\s-*[\"']</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[\"']\\s-*,.*"</span> 1)
           (<span style="color: #8b2252;">"after"</span> <span style="color: #8b2252;">"\\s-*after\\s-*(\\s-*[\"']</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">.+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[\"']\\s-*,.*"</span> 1)
           (<span style="color: #8b2252;">"Function"</span> <span style="color: #8b2252;">"function[ \t]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[a-zA-Z0-9_$.]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t]*("</span> 1)
           (<span style="color: #8b2252;">"Function"</span> <span style="color: #8b2252;">"^[ \t]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[a-zA-Z0-9_$.]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t]*=[ \t]*function[ \t]*("</span> 1)
           (<span style="color: #8b2252;">"Function"</span> <span style="color: #8b2252;">"^var[ \t]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[a-zA-Z0-9_$.]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t]*=[ \t]*function[ \t]*("</span> 1)
           (<span style="color: #8b2252;">"Function"</span> <span style="color: #8b2252;">"^[ \t]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[a-zA-Z0-9_$.]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t]*()[ \t]*{"</span> 1)
           (<span style="color: #8b2252;">"Function"</span> <span style="color: #8b2252;">"^[ \t]*</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[a-zA-Z0-9_$.]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">[ \t]*:[ \t]*function[ \t]*("</span> 1)
           (<span style="color: #8b2252;">"Task"</span> <span style="color: #8b2252;">"[. \t]task([ \t]*['\"]</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">'\"]+</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">"</span> 1)))))
(add-hook 'js2-mode-hook
        (<span style="color: #a020f0;">lambda</span> ()
    (<span style="color: #a020f0;">setq</span> imenu-create-index-function 'js2-imenu-make-index)))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">imenu </span>
(global-set-key (kbd <span style="color: #8b2252;">"M-s i"</span>) 'counsel-imenu)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:33d41d7f-a1d8-4267-9104-ee44cc8b435a" class="outline-5">
<h5 id="h:33d41d7f-a1d8-4267-9104-ee44cc8b435a">JavaScript IDE</h5>
<div class="outline-text-5" id="text-h:33d41d7f-a1d8-4267-9104-ee44cc8b435a">
</div>
<div id="outline-container-h:1590c98a-ffe1-4371-b60d-3881dd15f881" class="outline-6">
<h6 id="h:1590c98a-ffe1-4371-b60d-3881dd15f881">js2-mode插件</h6>
<div class="outline-text-6" id="text-h:1590c98a-ffe1-4371-b60d-3881dd15f881">
<p>
<a href="https://github.com/mooz/js2-mode/">https://github.com/mooz/js2-mode/</a>
</p>

<ul class="org-ul">
<li>语法高亮</li>
<li>语法检查器（Linter）</li>
</ul>

<p>
Emacs 提供的默认 JavaScript Major Mode 并不是非常好用。所以我们可以将默认的模式 替换成 <a href="https://github.com/mooz/js2-mode">js2-mode</a> 一个比默认模式好用的 Major Mode。我们可以通过 MELPA 来下载它，然 后用下面的代码将其启用。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">config js2-mode for js files</span>
(<span style="color: #a020f0;">setq</span> auto-mode-alist
      (append
      '((<span style="color: #8b2252;">"\\.js\\'"</span> . js2-mode))
      auto-mode-alist))
</pre>
</div>

<p>
你可以在<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Auto-Major-Mode.html">这里</a>（How Emacs Chooses a Major Mode）找到 Emacs 是如何选择何时该选用何 种 Major Mode 的方法。
</p>

<p>
在这里我们需要知道 `auto-mode-alist` 的作用，这个变量是一个 <a href="https://www.emacswiki.org/emacs/AssociationList">AssociationList</a>，它 使用正则表达式（REGEXP）的规则来匹配不同类型文件应使用的 Major Mode。 下面是几个 正则表达式匹配的例子，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">((<span style="color: #8b2252;">"\\`/tmp/fol/"</span> . text-mode)
 (<span style="color: #8b2252;">"\\.texinfo\\'"</span> . texinfo-mode)
 (<span style="color: #8b2252;">"\\.texi\\'"</span> . texinfo-mode)
 (<span style="color: #8b2252;">"\\.el\\'"</span> . emacs-lisp-mode)
 (<span style="color: #8b2252;">"\\.c\\'"</span> . c-mode)
 (<span style="color: #8b2252;">"\\.h\\'"</span> . c-mode)
 &#8230;)
</pre>
</div>

<p>
下面是如何添加新的模式与对应文件类型的例子（与我们配置 `js2-mode` 时相似的例子），
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> auto-mode-alist
  (append
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">File name (within directory) starts with a dot.</span>
   '((<span style="color: #8b2252;">"/\\.[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">/]*\\'"</span> . fundamental-mode)
     <span style="color: #b22222;">;; </span><span style="color: #b22222;">File name has no dot.</span>
     (<span style="color: #8b2252;">"/[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\\./]*\\'"</span> . fundamental-mode)
     <span style="color: #b22222;">;; </span><span style="color: #b22222;">File name ends in &#8216;</span><span style="color: #008b8b;">.C</span><span style="color: #b22222;">&#8217;.</span>
     (<span style="color: #8b2252;">"\\.C\\'"</span> . c++-mode))
   auto-mode-alist))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a69ad9e2-481d-4814-9de6-96d027af0277" class="outline-6">
<h6 id="h:a69ad9e2-481d-4814-9de6-96d027af0277">nodejs-repl插件</h6>
<div class="outline-text-6" id="text-h:a69ad9e2-481d-4814-9de6-96d027af0277">
<p>
<a href="https://github.com/abicky/nodejs-repl.el/">https://github.com/abicky/nodejs-repl.el/</a>
</p>

<p>
需要提前安装nodejs
</p>

<p>
执行缓冲区的代码可以使用 `nodejs-repl` 插件，它需要你的机器上已经安装了 NodeJS。 然而在 Mac OS X 上可能会出现找不到 NodeJS 可执行文件的问题，要解决这个问题你需要 安装另外一个 `exec-path-from-shell` 的插件并将其启用。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (memq window-system '(mac ns))
  (exec-path-from-shell-initialize))
</pre>
</div>

<p>
有了 `nodejs-repl` 我们就可以方便的测试和开发我们的 JavaScript 代码了（你可以在 <a href="https://github.com/mooz/js2-mode">这里</a>找到更多关于它的使用方法）。
</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="outline-container-h:b9993db1-f53e-4934-818b-4011d370121b" class="outline-2">
<h2 id="h:b9993db1-f53e-4934-818b-4011d370121b">插件应用</h2>
<div class="outline-text-2" id="text-h:b9993db1-f53e-4934-818b-4011d370121b">
</div>
<div id="outline-container-h:d0473065-b04f-4f5f-9ce1-a64eeca584ce" class="outline-3">
<h3 id="h:d0473065-b04f-4f5f-9ce1-a64eeca584ce">Org文件导出为其他格式</h3>
<div class="outline-text-3" id="text-h:d0473065-b04f-4f5f-9ce1-a64eeca584ce">
</div>
<div id="outline-container-h:42cb0610-ab99-405a-8300-9dc3db1abb6d" class="outline-4">
<h4 id="h:42cb0610-ab99-405a-8300-9dc3db1abb6d">org文件能导出为什么格式</h4>
<div class="outline-text-4" id="text-h:42cb0610-ab99-405a-8300-9dc3db1abb6d">
<p>
Org文件是一种基于Markup语言的文本文件，它与Markdown文件异曲同工，而Markup一个重要特点就是很容易转换成其他格式，产品经理常用到的格式有：
</p>

<ul class="org-ul">
<li>HTML网页</li>
<li>Markdown文件</li>
<li>PDF文件</li>
<li>Reveal.js幻灯片</li>
<li>Hugo博客站点</li>
<li>HTML静态站点</li>
<li>docx, pptx</li>
<li>…</li>
</ul>
<p>
其中对我个人而言，最常用的导出格式为HTML网页和PDF。
</p>
</div>
</div>
<div id="outline-container-h:dd8caa86-a2d0-4615-bea0-3bb866bffb87" class="outline-4">
<h4 id="h:dd8caa86-a2d0-4615-bea0-3bb866bffb87">org文件导出通用设置</h4>
<div class="outline-text-4" id="text-h:dd8caa86-a2d0-4615-bea0-3bb866bffb87">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> ox
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:custom</span>
  (org-export-with-toc t)
  (org-export-with-tags 'not-in-toc)
  (org-export-with-drawers nil)
  (org-export-with-priority t)
  (org-export-with-footnotes t)
  (org-export-with-smart-quotes t)
  (org-export-with-section-numbers t)
  (org-export-with-sub-superscripts '{})
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">`</span><span style="color: #008b8b;">org-export-use-babel</span><span style="color: #b22222;">' set to nil will cause all source block header arguments to be ignored This means that code blocks with the argument :exports none or :exports results will end up in the export.</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">See:</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">https://stackoverflow.com/questions/29952543/how-do-i-prevent-org-mode-from-executing-all-of-the-babel-source-blocks</span>
  (org-export-use-babel t)
  (org-export-headline-levels 9)
  (org-export-coding-system 'utf-8)
  (org-export-with-broken-links 'mark)
  (org-export-default-language <span style="color: #8b2252;">"zh-CN"</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#40664;&#35748;&#26159;en</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(org-ascii-text-width 72)</span>
  )

<span style="color: #b22222;">;; </span><span style="color: #b22222;">export extra</span>
(<span style="color: #a020f0;">use-package</span> ox-extra
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:config</span>
  (ox-extras-activate '(ignore-headlines))
  )
</pre>
</div>

<p>
设置完后，我们按下 <code>C-x C-e</code> 键后，可以看到默认就支持了 iCalendar、HTML、LaTex、ODT、Plain Text、Publish（HTML静态站点）这几个导出格式。
</p>

<p>
这个网页的样式也是 Org mode 自带的 CSS 样式。后面我们会尝试改造它。
</p>
</div>
</div>
<div id="outline-container-h:efaf8a22-8faa-4f4c-b2e4-f91e4328e3fd" class="outline-4">
<h4 id="h:efaf8a22-8faa-4f4c-b2e4-f91e4328e3fd">org文件导出为网页</h4>
<div class="outline-text-4" id="text-h:efaf8a22-8faa-4f4c-b2e4-f91e4328e3fd">
</div>
<div id="outline-container-h:3ed8b644-9365-4bd5-8a57-34ed5a5fad05" class="outline-5">
<h5 id="h:3ed8b644-9365-4bd5-8a57-34ed5a5fad05">ox-html导出设置</h5>
<div class="outline-text-5" id="text-h:3ed8b644-9365-4bd5-8a57-34ed5a5fad05">
<p>
先对HTML导出做一个基本设置
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> ox-html
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:init</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">add support for video</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-video-link-export</span> (path desc backend)
    (<span style="color: #a020f0;">let</span> ((ext (file-name-extension path)))
      (<span style="color: #a020f0;">cond</span>
       ((eq 'html backend)
        (format <span style="color: #8b2252;">"&lt;video width='</span><span style="color: #008b8b;">800</span><span style="color: #8b2252;">' preload='</span><span style="color: #008b8b;">metadata</span><span style="color: #8b2252;">' controls='</span><span style="color: #008b8b;">controls</span><span style="color: #8b2252;">'&gt;&lt;source type='</span><span style="color: #008b8b;">video/%s</span><span style="color: #8b2252;">' src='</span><span style="color: #008b8b;">%s</span><span style="color: #8b2252;">' /&gt;&lt;/video&gt;"</span> ext path))
       <span style="color: #b22222;">;; </span><span style="color: #b22222;">fall-through case for everything else</span>
       (t
        path))))
  (org-link-set-parameters <span style="color: #8b2252;">"video"</span> <span style="color: #483d8b;">:export</span> 'org-video-link-export)
  <span style="color: #483d8b;">:custom</span>
  (org-html-doctype <span style="color: #8b2252;">"html5"</span>)
  (org-html-html5-fancy t)
  (org-html-checkbox-type 'unicode)
  (org-html-validation-link nil))

(<span style="color: #a020f0;">use-package</span> htmlize
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:custom</span>
  (htmlize-pre-style t)
  (htmlize-output-type 'inline-css))
</pre>
</div>

<p>
完成HTML导出设置后，我们再次导出 emacs-config.org 可以看到导出的HTML好看多了，代码块还有了语法高亮。
</p>
</div>
</div>
<div id="outline-container-h:1e7e3929-94af-4f6c-adfb-3b7103748ca3" class="outline-5">
<h5 id="h:1e7e3929-94af-4f6c-adfb-3b7103748ca3">修改导出的样式</h5>
<div class="outline-text-5" id="text-h:1e7e3929-94af-4f6c-adfb-3b7103748ca3">
<p>
<a href="https://github.com/fniessen/org-html-themes">org-html-themes</a> 项目可以改变org文件导出为html的默认样式，项目的几个主题非常好看，用法也很简单，只需要在每个org文件开始的地方，加上下面这段代码即可（以 readtheorg 这个主题为例）
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #b22222;">#+SETUPFILE: <a href="https://fniessen.github.io/org-html-themes/org/theme-readtheorg.setup">https://fniessen.github.io/org-html-themes/org/theme-readtheorg.setup</a></span>
</pre>
</div>

<p>
<code>C-c C-e h o</code> 看看效果
</p>

<p>
当然也可以克隆到本地，修改。
</p>

<p>
范例：将所有的图片都居中显示
假设项目的本地目录存放在 ~/.emacs.d/org-html-themes/ 文件夹，然后根据自己的需要找到项目文件夹下 src/readtheorg_theme/css/readtheorg.css 文件进行按需修改，
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">cd</span> ~/.emacs.d/
git clone https://github.com/fniessen/org-html-themes.git
<span style="color: #483d8b;">cd</span> org-html-themes
vim src/readtheorg_theme/css/readtheorg.css

/* to make image center */
figure{
    margin: 24px 0px 24px 0px;
    text-align:center;
}
</pre>
</div>
<p>
修改完后，需要以本地而非在线的方式来引用这些css，可以在 ~/.emacs.d/ 文件夹下创建一个 org-setupfile.org 文件，文件的内容如下：
</p>
<div class="org-src-container">
<pre class="src src-sh">curl -o org-setupfile.org  https://fniessen.github.io/org-html-themes/org/theme-readtheorg.setup

vim  org-setupfile.org
<span style="color: #b22222;"># </span><span style="color: #b22222;">-*- mode: org; -*-</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">+OPTIONS: html-style:nil</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+HTML_HEAD: &lt;link rel="stylesheet" type="text/css" href="/Users/7tq6lr/.emacs.d/org-html-themes/src/readtheorg_theme/css/htmlize.css"/&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+HTML_HEAD: &lt;link rel="stylesheet" type="text/css" href="/Users/7tq6lr/.emacs.d/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/&gt;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">+HTML_HEAD: &lt;script type="text/javascript" src="/Users/7tq6lr/.emacs.d/org-html-themes/src/lib/js/jquery.min.js"&gt;&lt;/script&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+HTML_HEAD: &lt;script type="text/javascript" src="/Users/7tq6lr/.emacs.d/org-html-themes/src/lib/js/bootstrap.min.js"&gt;&lt;/script&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+HTML_HEAD: &lt;script type="text/javascript" src="/Users/7tq6lr/.emacs.d/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"&gt;&lt;/script&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+HTML_HEAD: &lt;script type="text/javascript" src="/Users/7tq6lr/.emacs.d/org-html-themes/src/readtheorg_theme/js/readtheorg.js"&gt;&lt;/script&gt;</span>
</pre>
</div>

<p>
最后一步，就是在每个org文件的文件头的位置，加上下面这一行代码即可：
</p>
<div class="org-src-container">
<pre class="src src-org"><span style="color: #b22222;">#+SETUPFILE: ~/.emacs.d/org-setupfile.org</span>
</pre>
</div>

<ul class="org-ul">
<li>如果不想输出作者、日期等信息，可以在org文件头添加如下配置项即可： <code>#+OPTIONS: author:nil date:nil email:nil timestamp:nil</code></li>
<li>不想导出页脚 <code>#+OPTIONS: html-postamble:nil</code></li>
<li>除了 org-html-themes 外，还有很多选择，如 <a href="https://github.com/gongzhitaao/orgcss">https://github.com/gongzhitaao/orgcss</a> 等，也都很好看，可以根据自己的需要选择导出模板。</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:193d1135-9a23-4c9f-a321-56f8d477700c" class="outline-4">
<h4 id="h:193d1135-9a23-4c9f-a321-56f8d477700c">org文件导出为PDF</h4>
<div class="outline-text-4" id="text-h:193d1135-9a23-4c9f-a321-56f8d477700c">
<p>
org文件导出为PDF有好几种做法：
</p>

<p>
先导出为HTML，然后通过浏览器的打印为PDF功能生成PDF
</p>
<ul class="org-ul">
<li>通过 ox-latex 导出为PDF</li>
<li>通过 ox-pandoc 导出为PDF</li>
</ul>

<p>
下面介绍如何设置 ox-latex 来导出PDF.
</p>
</div>
<div id="outline-container-h:667c634a-0083-4994-9336-b856a3acc0ef" class="outline-5">
<h5 id="h:667c634a-0083-4994-9336-b856a3acc0ef">ox-latex导出PDF设置</h5>
<div class="outline-text-5" id="text-h:667c634a-0083-4994-9336-b856a3acc0ef">
<p>
ox-latex 是Org mode自带的功能，可以将Org文件导出为latex文件和PDF文件。下面我们来设置它:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> ox-latex
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:defer</span> t
  <span style="color: #483d8b;">:config</span>
  (add-to-list 'org-latex-classes
               '(<span style="color: #8b2252;">"cn-article"</span>
                 <span style="color: #8b2252;">"\\documentclass[UTF8,a4paper]{article}"</span>
                 (<span style="color: #8b2252;">"\\section{%s}"</span> . <span style="color: #8b2252;">"\\section*{%s}"</span>)
                 (<span style="color: #8b2252;">"\\subsection{%s}"</span> . <span style="color: #8b2252;">"\\subsection*{%s}"</span>)
                 (<span style="color: #8b2252;">"\\subsubsection{%s}"</span> . <span style="color: #8b2252;">"\\subsubsection*{%s}"</span>)
                 (<span style="color: #8b2252;">"\\paragraph{%s}"</span> . <span style="color: #8b2252;">"\\paragraph*{%s}"</span>)
                 (<span style="color: #8b2252;">"\\subparagraph{%s}"</span> . <span style="color: #8b2252;">"\\subparagraph*{%s}"</span>)))

  (add-to-list 'org-latex-classes
               '(<span style="color: #8b2252;">"cn-report"</span>
                 <span style="color: #8b2252;">"\\documentclass[11pt,a4paper]{report}"</span>
                 (<span style="color: #8b2252;">"\\chapter{%s}"</span> . <span style="color: #8b2252;">"\\chapter*{%s}"</span>)
                 (<span style="color: #8b2252;">"\\section{%s}"</span> . <span style="color: #8b2252;">"\\section*{%s}"</span>)
                 (<span style="color: #8b2252;">"\\subsection{%s}"</span> . <span style="color: #8b2252;">"\\subsection*{%s}"</span>)
                 (<span style="color: #8b2252;">"\\subsubsection{%s}"</span> . <span style="color: #8b2252;">"\\subsubsection*{%s}"</span>)))
  (<span style="color: #a020f0;">setq</span> org-latex-default-class <span style="color: #8b2252;">"cn-article"</span>)
  (<span style="color: #a020f0;">setq</span> org-latex-image-default-height <span style="color: #8b2252;">"0.9\\textheight"</span>
        org-latex-image-default-width <span style="color: #8b2252;">"\\linewidth"</span>)
  (<span style="color: #a020f0;">setq</span> org-latex-pdf-process
            '(<span style="color: #8b2252;">"xelatex -interaction nonstopmode -output-directory %o %f"</span>
              <span style="color: #8b2252;">"bibtex %b"</span>
              <span style="color: #8b2252;">"xelatex -interaction nonstopmode -output-directory %o %f"</span>
              <span style="color: #8b2252;">"xelatex -interaction nonstopmode -output-directory %o %f"</span>
              <span style="color: #8b2252;">"rm -fr %b.out %b.log %b.tex %b.brf %b.bbl auto"</span>
              ))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20351;&#29992; Listings &#23439;&#21253;&#26684;&#24335;&#21270;&#28304;&#20195;&#30721;(&#21482;&#26159;&#25226;&#20195;&#30721;&#26694;&#29992; listing &#29615;&#22659;&#26694;&#36215;&#26469;&#65292;&#36824;&#38656;&#35201;&#39069;&#22806;&#30340;&#35774;&#32622;)</span>
  (<span style="color: #a020f0;">setq</span> org-latex-listings t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">mapping jupyter-python to Python</span>
  (add-to-list 'org-latex-listings-langs '(jupyter-python <span style="color: #8b2252;">"Python"</span>))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Options for \lset command&#65288;reference to listing Manual)</span>
  (<span style="color: #a020f0;">setq</span> org-latex-listings-options
        '(
          (<span style="color: #8b2252;">"basicstyle"</span> <span style="color: #8b2252;">"\\small\\ttfamily"</span>)       <span style="color: #b22222;">; </span><span style="color: #b22222;">&#28304;&#20195;&#30721;&#23383;&#20307;&#26679;&#24335;</span>
          (<span style="color: #8b2252;">"keywordstyle"</span> <span style="color: #8b2252;">"\\color{eminence}\\small"</span>)                 <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20851;&#38190;&#35789;&#23383;&#20307;&#26679;&#24335;</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">("identifierstyle" "\\color{doc}\\small")</span>
          (<span style="color: #8b2252;">"commentstyle"</span> <span style="color: #8b2252;">"\\color{commentgreen}\\small\\itshape"</span>)    <span style="color: #b22222;">; </span><span style="color: #b22222;">&#25209;&#27880;&#26679;&#24335;</span>
          (<span style="color: #8b2252;">"stringstyle"</span> <span style="color: #8b2252;">"\\color{red}\\small"</span>)                       <span style="color: #b22222;">; </span><span style="color: #b22222;">&#23383;&#31526;&#20018;&#26679;&#24335;</span>
          (<span style="color: #8b2252;">"showstringspaces"</span> <span style="color: #8b2252;">"false"</span>)                                <span style="color: #b22222;">; </span><span style="color: #b22222;">&#23383;&#31526;&#20018;&#31354;&#26684;&#26174;&#31034;</span>
          (<span style="color: #8b2252;">"numbers"</span> <span style="color: #8b2252;">"left"</span>)                                          <span style="color: #b22222;">; </span><span style="color: #b22222;">&#34892;&#21495;&#26174;&#31034;</span>
          (<span style="color: #8b2252;">"numberstyle"</span> <span style="color: #8b2252;">"\\color{preprocess}"</span>)                       <span style="color: #b22222;">; </span><span style="color: #b22222;">&#34892;&#21495;&#26679;&#24335;</span>
          (<span style="color: #8b2252;">"stepnumber"</span> <span style="color: #8b2252;">"1"</span>)                                          <span style="color: #b22222;">; </span><span style="color: #b22222;">&#34892;&#21495;&#36882;&#22686;</span>
          (<span style="color: #8b2252;">"xleftmargin"</span> <span style="color: #8b2252;">"2em"</span>)                                       <span style="color: #b22222;">;</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">("backgroundcolor" "\\color{background}")                   ; &#20195;&#30721;&#26694;&#32972;&#26223;&#33394;</span>
          (<span style="color: #8b2252;">"tabsize"</span> <span style="color: #8b2252;">"4"</span>)                                             <span style="color: #b22222;">; </span><span style="color: #b22222;">TAB &#31561;&#25928;&#31354;&#26684;&#25968;</span>
          (<span style="color: #8b2252;">"captionpos"</span> <span style="color: #8b2252;">"t"</span>)                                          <span style="color: #b22222;">; </span><span style="color: #b22222;">&#26631;&#39064;&#20301;&#32622; top or buttom(t|b)</span>
          (<span style="color: #8b2252;">"breaklines"</span> <span style="color: #8b2252;">"true"</span>)                                       <span style="color: #b22222;">; </span><span style="color: #b22222;">&#33258;&#21160;&#26029;&#34892;</span>
          (<span style="color: #8b2252;">"breakatwhitespace"</span> <span style="color: #8b2252;">"true"</span>)                                <span style="color: #b22222;">; </span><span style="color: #b22222;">&#21482;&#22312;&#31354;&#26684;&#20998;&#34892;</span>
          (<span style="color: #8b2252;">"showspaces"</span> <span style="color: #8b2252;">"false"</span>)                                      <span style="color: #b22222;">; </span><span style="color: #b22222;">&#26174;&#31034;&#31354;&#26684;</span>
          (<span style="color: #8b2252;">"columns"</span> <span style="color: #8b2252;">"flexible"</span>)                                      <span style="color: #b22222;">; </span><span style="color: #b22222;">&#21015;&#26679;&#24335;</span>
          (<span style="color: #8b2252;">"frame"</span> <span style="color: #8b2252;">"tb"</span>)                                              <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20195;&#30721;&#26694;&#65306;single, or tb &#19978;&#19979;&#32447;</span>
          (<span style="color: #8b2252;">"frameleftmargin"</span> <span style="color: #8b2252;">"1.5em"</span>)                                 <span style="color: #b22222;">; </span><span style="color: #b22222;">frame &#21521;&#21491;&#20559;&#31227;</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">("frameround" "tttt")                                       ; &#20195;&#30721;&#26694;&#65306; &#22278;&#35282;</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">("framesep" "0pt")</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">("framerule" "1pt")                                         ; &#26694;&#30340;&#32447;&#23485;</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">("rulecolor" "\\color{background}")                         ; &#26694;&#39068;&#33394;</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">("fillcolor" "\\color{white}")</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">("rulesepcolor" "\\color{comdil}")</span>
          (<span style="color: #8b2252;">"framexleftmargin"</span> <span style="color: #8b2252;">"5mm"</span>)                                  <span style="color: #b22222;">; </span><span style="color: #b22222;">let line numer inside frame</span>
          ))
  )
</pre>
</div>

<p>
设置完后，我们按下 C-c C-e 导出当前文档，然后按下 l o 导出为 PDF 文件并打开，可以看到Emacs打开了生成的PDF文件。
</p>
</div>
</div>
</div>
<div id="outline-container-h:f6b77b0d-8a88-475f-8824-66100d48dcea" class="outline-4">
<h4 id="h:f6b77b0d-8a88-475f-8824-66100d48dcea">org文件导出为Reveal.js幻灯片</h4>
<div class="outline-text-4" id="text-h:f6b77b0d-8a88-475f-8824-66100d48dcea">
<ul class="org-ul">
<li>org-reveal <a href="https://github.com/yjwen/org-reveal">https://github.com/yjwen/org-reveal</a></li>
<li>reveal.js 文件 <a href="https://github.com/hakimel/reveal.js">https://github.com/hakimel/reveal.js</a></li>
</ul>

<p>
<a href="https://orgmode.org/worg/org-tutorials/non-beamer-presentations.html">官方</a> 整理了几种做幻灯片的方式。 但实际上使用起来只有 epresent 和 org-reveal 操作比较简单。本文只介绍 <a href="https://github.com/yjwen/org-reveal">org-reveal</a> 插件将org文件导出为漂亮的幻灯片。
</p>


<p>
present.org
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">* Slide 1</span>
 here's some text
<span style="color: #0000ff;">* Slide 2</span>
<span style="color: #a0522d;">** subslide 1</span>
   some text
<span style="color: #a0522d;">** subslide 2</span>
<span style="color: #0000ff;">* Slide 3</span>
 - list item 1
 - list item 2
<span style="color: #0000ff;">   </span><span style="color: #0000ff;">| a | b | c |</span>
<span style="color: #0000ff;">   </span><span style="color: #0000ff;">|---+---+---|</span>
<span style="color: #0000ff;">   </span><span style="color: #0000ff;">| 1 | 2 | 3 |</span>
<span style="color: #0000ff;">   </span><span style="color: #0000ff;">| 4 | 5 | 6 |</span>
<span style="color: #0000ff;">   </span><span style="color: #0000ff;">|---+---+---|</span>
<span style="color: #0000ff;">* Slide 4</span>
<span style="color: #b22222;">#+begin_src python</span>
<span style="color: #7f7f7f;">   </span><span style="color: #a020f0;">def</span><span style="color: #7f7f7f;"> </span><span style="color: #0000ff;">f</span><span style="color: #7f7f7f;">(x):</span>
<span style="color: #7f7f7f;"> </span><span style="color: #a020f0;">return</span><span style="color: #7f7f7f;"> x </span><span style="color: #7f7f7f;">+</span><span style="color: #7f7f7f;"> 1</span>
<span style="color: #7f7f7f;">   </span><span style="color: #483d8b;">print</span><span style="color: #7f7f7f;">(f(5))</span>
<span style="color: #b22222;">#+end_src</span>
</pre>
</div>

<p>
安装
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> ox-reveal
  <span style="color: #483d8b;">:ensure</span> ox-reveal
  <span style="color: #483d8b;">:after</span> ox
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> org-reveal-root <span style="color: #8b2252;">"https://cdn.jsdelivr.net/npm/reveal.js"</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20351;&#29992; reveal.js &#38656;&#35201;&#24341;&#20837; js </span>
  (<span style="color: #a020f0;">setq</span> org-reveal-mathjax t)
)
</pre>
</div>

<p>
写完后，只需要按下 <code>C-c C-e</code> 导出，选择 <code>R B</code> 导出为 reveal.js 幻灯片网页并打开即可
</p>


<figure id="org422963c">
<img src="./images/image-20210701061936564.png" alt="image-20210701061936564.png">

</figure>

<p>
还可以下载安装<a href="https://github.com/hakimel/reveal.js">reveal.js</a> 
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">cd</span> ~/.emacs.d/ &amp;&amp; git clone https://github.com/hakimel/reveal.js.git

<span style="color: #483d8b;">cd</span> reveal.js &amp;&amp; npm install
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> ox-reveal
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> ox
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> org-reveal-hlevel 1)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Avalable themes: night, black, white, league, beige, sky, serif, simple, solarized, blood, moon</span>
  (<span style="color: #a020f0;">setq</span> org-reveal-theme <span style="color: #8b2252;">"moon"</span>)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">can also set root to a CDN cloud: https://cdn.jsdelivr.net/npm/reveal.js</span>
  (<span style="color: #a020f0;">setq</span> org-reveal-root (expand-file-name <span style="color: #8b2252;">"reveal.js"</span> user-emacs-directory))
  (<span style="color: #a020f0;">setq</span> org-reveal-mathjax t)
  (<span style="color: #a020f0;">setq</span> org-reveal-ignore-speaker-notes t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">original title font size is TOO large!</span>
  (<span style="color: #a020f0;">setq</span> org-reveal-title-slide <span style="color: #8b2252;">"&lt;h1&gt;&lt;font size=\"8\"&gt;%t&lt;/font&gt;&lt;/h1&gt;&lt;h2&gt;&lt;font size=\"6\"&gt;%s&lt;/font&gt;&lt;/h2&gt;&lt;p&gt;&lt;font size=\"5\"&gt;%a&lt;/font&gt;&lt;br/&gt;&lt;font size=\"5\"&gt;%d&lt;/font&gt;&lt;/p&gt;"</span>)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">don't load highlight, use htmlize instead. If you want to add line-number, add -n in src block header</span>
  (<span style="color: #a020f0;">setq</span> org-reveal-plugins '(markdown zoom notes search))
  (<span style="color: #a020f0;">setq</span> org-reveal-klipsify-src 'on)
  (<span style="color: #a020f0;">setq</span> org-reveal-extra-css (expand-file-name <span style="color: #8b2252;">"reveal.js/css/extra.css"</span> user-emacs-directory))
  )
</pre>
</div>


<p>
这时一个简易的幻灯片就做好。以下可以做完善：
</p>
<div class="org-src-container">
<pre class="src src-org">
&#20027;&#39064;&#65306;
&#20869;&#32622;&#20102;&#25552;&#20379;&#20102;&#22810;&#31181;&#20027;&#39064;&#22312;&#36825;&#37324; <span style="color: #3a5fcd; text-decoration: underline;"><a href="https://github.com/hakimel/reveal.js/tree/master/css/theme">https://github.com/hakimel/reveal.js/tree/master/css/theme</a></span> &#21487;&#36873;
<span style="color: #b22222;">#+REVEAL_THEME: sky</span>

&#24187;&#28783;&#29255;&#32534;&#21495;:
<span style="color: #b22222;">#+REVEAL_INIT_OPTIONS: slideNumber:"c/t"</span>

&#24187;&#28783;&#29255;&#39029;&#30473;/&#39029;&#33050;&#65306;
<span style="color: #b22222;">#+REVEAL_SLIDE_HEADER: &#25105;&#26159;&#39029;&#30473;</span>
<span style="color: #b22222;">#+REVEAL_SLIDE_FOOTER: &#25105;&#26159;&#39029;&#33050;</span>

&#25554;&#20837;&#21407;&#22987; HTML&#65306;
<span style="color: #b22222;">#+REVEAL_HTML: &lt;font size="30" color="red"&gt;&#31070;&lt;/font&gt;&#20043;&#32534;&#36753;&#22120;!</span>

&#36807;&#24230;&#25928;&#26524;default|cube|page|concave|zoom|linear|fade|none
<span style="color: #b22222;">#+REVEAL_TRANS: zoom</span>

<span style="color: #b22222;">#+OPTIONS: toc:nil num:nil   ;; &#21435;&#30446;&#24405;&#26641;</span>

<span style="color: #b22222;">#+ATTR_REVEAL: :frag (roll-in)</span>
&#20869;&#23481;&#20998;&#27573;&#65306;&#35774;&#32622; `:frag frag-style` &#36873;&#39033;&#21487;&#20197;&#35753;&#20869;&#23481;&#19968;&#28857;&#19968;&#28857;&#30340;&#26174;&#31034;&#20986;&#26469;&#12290;&#22270;&#29255;&#12289;&#34920;&#26684;&#21644;&#20854;&#20182; HTML &#37117;&#21487;&#20197;&#20998;&#27573;&#12290; &#36824;&#21487;&#20197;&#36890;&#30693;&#26174;&#31034;&#30340;&#21160;&#25928;&#65292;&#20855;&#20307;&#35265;&#65306;<span style="color: #3a5fcd; text-decoration: underline;"><a href="https://github.com/yjwen/org-reveal/blob/master/Readme.org#fragmented-contents">https://github.com/yjwen/org-reveal/blob/master/Readme.org#fragmented-contents</a></span>
</pre>
</div>


<p>
范例：
<img src="./images/image-20210701081208560.png" alt="image-20210701081208560.png">
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #b22222;">#+OPTIONS: toc:nil num:nil</span>
<span style="color: #7f7f7f;">#+TITLE:</span> <span style="color: #191970; font-weight: bold;">My Awesome Presentation</span>
<span style="color: #7f7f7f;">#+AUTHOR:</span> <span style="color: #191970;">JasperVincent</span>
<span style="color: #b22222;">#+REVEAL_THEME: sky</span>
<span style="color: #b22222;">#+REVEAL_TRANS: zoom</span>
<span style="color: #b22222;">#+REVEAL_INIT_OPTIONS: slideNumber:"c/t"</span>
<span style="color: #b22222;">#+REVEAL_SLIDE_HEADER: &#25105;&#26159;&#39029;&#30473;</span>
<span style="color: #b22222;">#+REVEAL_SLIDE_FOOTER: &#25105;&#26159;&#39029;&#33050;</span>

<span style="color: #0000ff;">* Slide 1</span>
<span style="color: #b22222;">#+REVEAL_HTML: &lt;font size="30" color="red"&gt;&#31070;&lt;/font&gt;&#20043;&#32534;&#36753;&#22120;!</span>

  here's some text
<span style="color: #0000ff;">* Slide 2</span>
<span style="color: #a0522d;">** subslide 1</span>
    some text
<span style="color: #a0522d;">** subslide 2</span>
<span style="color: #0000ff;">* Slide 3</span>
<span style="color: #b22222;">#+ATTR_REVEAL: :frag (roll-in)</span>
  - list item 1
  - list item 2
<span style="color: #0000ff;">    </span><span style="color: #0000ff;">| a | b | c |</span>
<span style="color: #0000ff;">    </span><span style="color: #0000ff;">|---+---+---|</span>
<span style="color: #0000ff;">    </span><span style="color: #0000ff;">| 1 | 2 | 3 |</span>
<span style="color: #0000ff;">    </span><span style="color: #0000ff;">| 4 | 5 | 6 |</span>
<span style="color: #0000ff;">    </span><span style="color: #0000ff;">|---+---+---|</span>
<span style="color: #0000ff;">* Slide 4</span>
<span style="color: #b22222;">#+begin_src python</span>
<span style="color: #a020f0;">def</span><span style="color: #7f7f7f;"> </span><span style="color: #0000ff;">f</span><span style="color: #7f7f7f;">(x):</span>
<span style="color: #7f7f7f;">   </span><span style="color: #a020f0;">return</span><span style="color: #7f7f7f;"> x </span><span style="color: #7f7f7f;">+</span><span style="color: #7f7f7f;"> 1</span>

<span style="color: #483d8b;">print</span><span style="color: #7f7f7f;">(f(5))</span>
<span style="color: #b22222;">#+end_src</span>
</pre>
</div>

<p>
大佬作品：<a href="https://github.com/zamansky/mazelesson/">https://github.com/zamansky/mazelesson/</a>
作品存放推荐：<a href="https://rawgit.com/">https://rawgit.com/</a>
</p>
</div>
</div>
<div id="outline-container-h:aa8aacee-201b-48fc-885d-8d9bb07fd143" class="outline-4">
<h4 id="h:aa8aacee-201b-48fc-885d-8d9bb07fd143">org文件导出为Markdown</h4>
<div class="outline-text-4" id="text-h:aa8aacee-201b-48fc-885d-8d9bb07fd143">
<p>
我们通过 <a href="https://github.com/larstvei/ox-gfm">ox-gfm</a> 插件来导出Github样式的Markdown文件
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> ox-gfm
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> ox)
</pre>
</div>

<p>
通过 <code>C-c C-e</code> 导出当前文件，然后选择 <code>g g</code> 导出为 Markdown 文件
我们用 <a href="https://github.com/marktext/marktext/releases">marktext</a> 打开后可以看到导出的 Markdown 文件非常漂亮：
</p>

<p>
由于导出 markdown 是在 HTML 后端之上构建的（请参阅 HTML 导出），只需要修改导出 html 属性。如显示 5 级标题：
</p>

<pre class="example" id="org7b35eec">
#+options: H:5
</pre>
</div>
</div>
<div id="outline-container-h:9a6e5c9c-5087-496b-bcc4-61a3921e7892" class="outline-4">
<h4 id="h:9a6e5c9c-5087-496b-bcc4-61a3921e7892">org文件导出为Office文件</h4>
<div class="outline-text-4" id="text-h:9a6e5c9c-5087-496b-bcc4-61a3921e7892">
<p>
org文件当然也可以导出为Office的Word和PPT文件，我们需要 <a href="https://github.com/kawabata/ox-pandoc">ox-pandoc</a> 这款插件。
</p>

<ul class="org-ul">
<li>pandoc <a href="https://pandoc.org/">https://pandoc.org/</a></li>
</ul>

<p>
安装：pandoc
</p>
<div class="org-src-container">
<pre class="src src-sh">brew install pandoc

/opt/homebrew/bin/pandoc
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> ox-pandoc
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:custom</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">special extensions for markdown_github output</span>
  (org-pandoc-format-extensions '(markdown_github+pipe_tables+raw_html))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Linux /usr/local/bin/pandoc</span>
  (org-pandoc-command <span style="color: #8b2252;">"/opt/homebrew/bin/pandoc"</span>)
  )
</pre>
</div>

<ul class="org-ul">
<li>Word： <code>C-c C-e</code> 并选择 <code>p x</code></li>
<li>PPT： <code>C-c C-e</code> 并选择 <code>p p</code></li>
</ul>
</div>
</div>
<div id="outline-container-h:adf5c0c8-8b19-4b5c-acb3-2725e4711a18" class="outline-4">
<h4 id="h:adf5c0c8-8b19-4b5c-acb3-2725e4711a18">org文件导出为博客站点</h4>
<div class="outline-text-4" id="text-h:adf5c0c8-8b19-4b5c-acb3-2725e4711a18">
<p>
如何通过Org mode来写博客将在后续的课程中专门讲述，这里就先不讲了。
</p>
</div>
</div>
</div>
<div id="outline-container-h:1be7d378-925e-4d53-b9d0-efaa60c7024d" class="outline-3">
<h3 id="h:1be7d378-925e-4d53-b9d0-efaa60c7024d">通过 Org mode写博客</h3>
<div class="outline-text-3" id="text-h:1be7d378-925e-4d53-b9d0-efaa60c7024d">
<blockquote>
<p>
org-mode 提供了丰富的格式，可以用来做写博客、笔记，规划，TODO，还有极其强大的文本样式，很多人用来写论文。
本质上 org-mode 跟 markdown 一样，都是一种纯文本标记语言而已。
一些主流的平台（github，gitlab），主流的博客工具（Jekyll，Hugo）都是支持 org-mode 的，把他当做 markdown 来用即可。
</p>
</blockquote>

<p>
在Emacs里通过Org mode写博客也有很多方式，这里，我着重介绍以下两种方式：
</p>

<ul class="org-ul">
<li>通过 Org mode 自带的 ox-publish 机制导出为静态HTML站点</li>
<li>通过 ox-hugo 插件，利用 hugo 的强大功能导出为好看的博客</li>
</ul>

<p>
这两种方式，第一种是生成自己看的私人笔记等；第二种方式是生成对外展示的博客，下面逐一介绍。
</p>
</div>
<div id="outline-container-h:ce091335-e54f-42b7-8ed1-af64cd767ee5" class="outline-4">
<h4 id="h:ce091335-e54f-42b7-8ed1-af64cd767ee5">通过ox-publish写博客</h4>
<div class="outline-text-4" id="text-h:ce091335-e54f-42b7-8ed1-af64cd767ee5">
<p>
我们需要对 <a href="https://orgmode.org/manual/Publishing.html">ox-publish</a> 做一些基础的配置：
</p>

<p>
用户手册：<a href="https://orgmode.org/worg/org-tutorials/org-publish-html-tutorial.html">https://orgmode.org/worg/org-tutorials/org-publish-html-tutorial.html</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> ox-publish
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:commands</span> (org-publish org-publish-all)
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> org-export-global-macros
      '((<span style="color: #8b2252;">"timestamp"</span> . <span style="color: #8b2252;">"@@html:&lt;span class=\"timestamp\"&gt;[$1]&lt;/span&gt;@@"</span>)))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">sitemap &#29983;&#25104;&#20989;&#25968;</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my/org-sitemap-date-entry-format</span> (entry style project)
    <span style="color: #8b2252;">"Format ENTRY in org-publish PROJECT Sitemap format ENTRY ENTRY STYLE format that includes date."</span>
    (<span style="color: #a020f0;">let</span> ((filename (org-publish-find-title entry project)))
      (<span style="color: #a020f0;">if</span> (= (length filename) 0)
          (format <span style="color: #8b2252;">"*%s*"</span> entry)
        (format <span style="color: #8b2252;">"{{{timestamp(%s)}}} [[file:%s][%s]]"</span>
                (format-time-string <span style="color: #8b2252;">"%Y-%m-%d"</span>
                                    (org-publish-find-date entry project))
                entry
                filename))))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622; org-publish &#30340;&#39033;&#30446;&#21015;&#34920;</span>
  (<span style="color: #a020f0;">setq</span> org-publish-project-alist
        '(
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#31508;&#35760;&#37096;&#20998;</span>
          (<span style="color: #8b2252;">"org-notes"</span>
           <span style="color: #483d8b;">:base-directory</span> <span style="color: #8b2252;">"~/org/"</span>
           <span style="color: #483d8b;">:base-extension</span> <span style="color: #8b2252;">"org"</span>
           <span style="color: #483d8b;">:exclude</span> <span style="color: #8b2252;">"</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">tasks</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">test</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">scratch</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">diary</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">capture</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">mail</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">habits</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">resume</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">meetings</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">personal</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">org-beamer-example</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;">\\.org</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">test</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">article</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">roam</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">hugo"</span>
           <span style="color: #483d8b;">:publishing-directory</span> <span style="color: #8b2252;">"~/public_html/"</span>
           <span style="color: #483d8b;">:recursive</span> t                 <span style="color: #b22222;">; </span><span style="color: #b22222;">include subdirectories if t</span>
           <span style="color: #483d8b;">:publishing-function</span> org-html-publish-to-html
           <span style="color: #483d8b;">:headline-levels</span> 6
           <span style="color: #483d8b;">:auto-preamble</span> t
           <span style="color: #483d8b;">:auto-sitemap</span> t
           <span style="color: #483d8b;">:sitemap-filename</span> <span style="color: #8b2252;">"sitemap.org"</span>
           <span style="color: #483d8b;">:sitemap-title</span> <span style="color: #8b2252;">"Sitemap"</span>
           <span style="color: #483d8b;">:sitemap-format-entry</span> my/org-sitemap-date-entry-format)

          <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#38745;&#24577;&#36164;&#28304;&#37096;&#20998;</span>
          (<span style="color: #8b2252;">"org-static"</span>
           <span style="color: #483d8b;">:base-directory</span> <span style="color: #8b2252;">"~/org/"</span>
           <span style="color: #483d8b;">:base-extension</span> <span style="color: #8b2252;">"css</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">js</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">png</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">jpg</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">gif</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">pdf</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">mp3</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">ogg</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">swf</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">mov"</span>
           <span style="color: #483d8b;">:publishing-directory</span> <span style="color: #8b2252;">"~/public_html/"</span>
           <span style="color: #483d8b;">:recursive</span> t
           <span style="color: #483d8b;">:publishing-function</span> org-publish-attachment)

          <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#39033;&#30446;&#38598;&#21512;</span>
          (<span style="color: #8b2252;">"org"</span>
           <span style="color: #483d8b;">:components</span> (<span style="color: #8b2252;">"org-notes"</span> <span style="color: #8b2252;">"org-static"</span>))
          ))
  )
</pre>
</div>

<p>
<b>配置说明：</b>
</p>

<p>
这将配置变量 <code>org-publish-project-alist</code> 以定义我们网站的发布项目。阅读此变量的文档， <code>M-x describe-variable</code> 以获取更多信息！
</p>

<p>
这里最重要的两个配置是： <code>sitemap-format-entry</code> 以及 <code>org-publish-project-alist</code> 。前者是生成 sitemap 的方式，后者是定义publish要到哪个文件夹，把哪些org文件进行发布。
</p>

<p>
指定源和目标:
</p>

<ul class="org-ul">
<li><code>:base-directory</code> 指定包含源文件的目录，即需要发布文件的基本目录</li>
<li><code>:publishing-directory</code> 指定转化后存放的目录</li>
<li><code>:preparation-function</code> 指定转化文件前需要调用的函数， 例如发布前需要 make 一下源文件</li>
<li><code>:completion-function</code> 指定转化文件完成后需要调用的函数</li>
</ul>

<p>
选择文件（用于识别需要发布的文件）：
</p>
<ul class="org-ul">
<li><code>:base-extension</code> 指定识别的文件拓展名， 不需要点(.)后缀 ，如：*:base-extension “css”*</li>
<li><code>:exclude</code> 用于排除指定文件</li>
<li><code>:include</code> 引入指定文件，存在该文件都会进行发布转化</li>
<li><code>:recursive</code> 为真时， 将递归检查发布 base-directory 指定目录下的文件</li>
</ul>

<p>
发布触发执行动作:
</p>
<ul class="org-ul">
<li><code>:publishing-function</code> 执行发布操作将触发指定函数来完成工作
<ul class="org-ul">
<li><code>org-html-publish-to-htm</code> 默认 org 文件转化成 HTML</li>
<li><code>org-publish-attachment</code> 复制操作</li>
</ul></li>
</ul>

<p>
我们配置完 ox-publish 后，可以通过两种方式来发布静态站点：
</p>

<p>
<b>发布</b>
</p>

<ul class="org-ul">
<li>M-x org-publish-all 来发布（全部）站点</li>
<li>按 C-c C-e 后，再按 P a 来发布（全部）站点</li>
</ul>

<p>
当写完一篇文章之后需要手动调用 <code>org-export-dispatch</code> 选择 <code>p f</code> ，将当前 org 文档生成 HTML 网页文件。
</p>

<p>
<b>测试</b>
</p>

<p>
一个简单的网页就生成了，可以使用浏览器打开此 HTML 文件进行预览，也可以使用 <code>Simple-Httpd</code> 这个插件在 website-directory 文件下启动一个 server，之后在浏览器中打开 127.0.0.1:19999 就可以查看生成的博客内容啦。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> simple-httpd
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:after</span> ox-publish
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> httpd-root <span style="color: #8b2252;">"~/public_html"</span>)
  (<span style="color: #a020f0;">setq</span> httpd-port 19999) 
  (httpd-start)
  )
</pre>
</div>

<p>
或者
</p>
<div class="org-src-container">
<pre class="src src-sh">python3 -m http.server --directory=~/public_html
Open http://localhost:8000/<span style="color: #a020f0;"> in</span> the Web browser
</pre>
</div>

<p>
<b>独立的配置</b>
</p>

<p>
我们还需要一个可以运行 Emacs Lisp 脚本的 shell 脚本。我们称之为 build.sh 
</p>

<div class="org-src-container">
<pre class="src src-sh">emacs -Q --script build-site.el
</pre>
</div>

<p>
<code>-Q</code> 参数可防止 Emacs 加载您自己的 Emacs 配置，这将有助于确保一旦我们
准备好开始发布此站点，就可以在其他机器上干净地执行相同的脚本。
</p>

<p>
加载 Emacs 的包管理器，并将 package-user-dir 配置为项目文件夹的子目录。
这允许您安装脚本的软件包，而无需将它们与您个人 Emacs 配置的软件包混淆
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;;; </span><span style="color: #b22222;">Initialize the package system</span>
(<span style="color: #a020f0;">setq</span> make-backup-files nil)

(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">package</span>)
(<span style="color: #a020f0;">setq</span> package-user-dir (expand-file-name <span style="color: #8b2252;">"./.packages"</span>))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq package-archives '(("melpa" . "https://melpa.org/packages/")</span>
<span style="color: #b22222;">;;                          </span><span style="color: #b22222;">("elpa" . "https://elpa.gnu.org/packages/")))</span>
(<span style="color: #a020f0;">setq</span> package-archives '(
    (<span style="color: #8b2252;">"melpa"</span> . <span style="color: #8b2252;">"http://mirrors.tuna.tsinghua.edu.cn/elpa/melpa/"</span>)
    (<span style="color: #8b2252;">"gnu"</span> . <span style="color: #8b2252;">"http://mirrors.tuna.tsinghua.edu.cn/elpa/gnu/"</span>)
    (<span style="color: #8b2252;">"org"</span> . <span style="color: #8b2252;">"http://mirrors.tuna.tsinghua.edu.cn/elpa/org/"</span>)))


(<span style="color: #a020f0;">unless</span> (<span style="color: #a020f0;">bound-and-true-p</span> package--initialized)
  (package-initialize))

(<span style="color: #a020f0;">when</span> (not package-archive-contents)
  (package-refresh-contents))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">Check and install dependencies</span>
(<span style="color: #a020f0;">dolist</span> (package '(htmlize))
  (<span style="color: #a020f0;">unless</span> (package-installed-p package)
    (package-install package)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">Load publishing system</span>
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ox-publish</span>)
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">htmlize</span>)
</pre>
</div>


<p>
<b>自定义页面展出配置</b>
</p>

<p>
与手动写 html，css 一样这些在 org 里都是可自定义的，修改 org-publish 中的属性参
数和直接修改对应的 org 的 html 页面展出参数是等效的，请仔细阅读官方文档：<a href="https://orgmode.org/manual/Publishing-options.html">https://orgmode.org/manual/Publishing-options.html</a>
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">Generic properties</span>
:with-author  org-export-with-author
:with-creator org-export-with-creator
:with-toc org-export-with-toc
:section-numbers  org-export-with-section-numbers
:time-stamp-file org-export-time-stamp-file
:headline-levels org-export-headline-levels
:with-sub-superscript   org-export-with-sub-superscripts

<span style="color: #b22222;">#</span><span style="color: #b22222;">HTML specific properties</span>
:html-head-include-default-style  org-html-head-include-default-style
:html-divs  org-html-divs
:html-container org-html-container-element
:html-html5-fancy org-html-html5-fancy
:html-validation-link org-html-validation-link 
:html-doctype org-html-doctype

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21333;&#20010;org&#25991;&#20214;&#19981;&#24819;&#23548;&#20986;&#39029;&#33050;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+OPTIONS: html-postamble:nil</span>
</pre>
</div>

<p>
范例：自定义 html 导出内容
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">load file</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">file-contents</span> (file)
  (<span style="color: #a020f0;">with-temp-buffer</span>
    (insert-file-contents file)
    (buffer-string)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">Generic properties</span>
(<span style="color: #a020f0;">setq</span> 
      org-export-with-author nil <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#19981;&#26174;&#31034;&#20316;&#32773;</span>
      org-export-with-creator t <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034; Emacs &#21644; Org &#29256;&#26412;</span>
      org-export-with-toc t <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26174;&#31034;&#30446;&#24405;</span>
      org-export-with-section-numbers nil <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#19981;&#26174;&#31034;&#31456;&#33410;&#24207;&#21495;</span>
      org-export-time-stamp-file nil <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#19981;&#26174;&#31034;&#26102;&#38388;&#25139;&#65292;&#22914;&#21019;&#24314;&#26102;&#38388;</span>
      org-export-headline-levels 4 <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23548;&#20986;&#26631;&#39064;&#32423;&#21035;&#65292;&#40664;&#35748; 3</span>
      org-export-with-sub-superscripts nil <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#37325;&#35201;&#65292;&#19978;&#26631;&#19979;&#26631;&#20445;&#25345;&#21407;&#26679;&#36755;&#20986;&#65292;&#22914; _ &#19979;&#21010;&#32447;</span>
      )

<span style="color: #b22222;">;; </span><span style="color: #b22222;">HTML specific properties</span>
(<span style="color: #a020f0;">setq</span> org-html-divs '((preamble <span style="color: #8b2252;">"header"</span> <span style="color: #8b2252;">"top"</span>)
                      (content <span style="color: #8b2252;">"main class=\"container\""</span> <span style="color: #8b2252;">"content"</span>)
                      (postamble <span style="color: #8b2252;">"footer"</span> <span style="color: #8b2252;">"postamble"</span>))
      org-html-container-element <span style="color: #8b2252;">"section"</span>
      org-html-validation-link nil <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#39029;&#38754;&#24213;&#37096;&#30340;&#39564;&#35777;&#38142;&#25509; Validate &#65292;&#40664;&#35748; t &#65292; nil &#21024;&#38500;</span>
      org-html-html5-fancy t
      org-html-doctype <span style="color: #8b2252;">"html5"</span>

      org-html-head-include-default-style nil
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-html-head "&lt;link rel=\"stylesheet\" href=\"https://cdn.simplecss.org/simple.min.css\" /&gt;")</span>
      org-html-head (file-contents <span style="color: #8b2252;">"assets/head.html"</span>)
      org-html-postamble t
      org-html-postamble-format
      '((<span style="color: #8b2252;">"en"</span> <span style="color: #8b2252;">"&lt;p class=\"postamble\"&gt;First created: %d &lt;br /&gt;Last updated: %C &lt;br /&gt;Power by %c&lt;/p&gt;"</span>))
      )

<span style="color: #b22222;">;;; </span><span style="color: #b22222;">&#31561;&#20215;</span>
(<span style="color: #a020f0;">setq</span> org-publish-project-alist
      `(
        (<span style="color: #8b2252;">"xxxx"</span>

         <span style="color: #b22222;">;;</span><span style="color: #b22222;">xxxxx</span>
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">https://orgmode.org/manual/Publishing-options.html#Generic-properties-1</span>
         <span style="color: #483d8b;">:with-author</span> nil
         <span style="color: #483d8b;">:with-creator</span> t
         <span style="color: #483d8b;">:with-toc</span> t
         <span style="color: #483d8b;">:section-numbers</span> nil
         <span style="color: #483d8b;">:time-stamp-file</span> nil
         <span style="color: #483d8b;">:headline-levels</span> 4
         <span style="color: #483d8b;">:with-sub-superscript</span> nil

         <span style="color: #b22222;">;; </span><span style="color: #b22222;">https://orgmode.org/manual/Publishing-options.html#ASCII-specific-properties-1</span>
         <span style="color: #b22222;">;;; </span><span style="color: #b22222;">https://emacs.stackexchange.com/questions/76599/how-to-adjust-html-elements-using-org-publish-in-emacs</span>
         <span style="color: #483d8b;">:html-container</span> <span style="color: #8b2252;">"div class=\"container\""</span>
         <span style="color: #483d8b;">:html-divs</span> ((preamble <span style="color: #8b2252;">"header"</span> <span style="color: #8b2252;">"preamble"</span>)
                     (content <span style="color: #8b2252;">"main class=\"container\""</span> <span style="color: #8b2252;">"content"</span>)
                     (postamble <span style="color: #8b2252;">"footer"</span> <span style="color: #8b2252;">"postamble"</span>))
         <span style="color: #483d8b;">:html-container</span> <span style="color: #8b2252;">"section"</span>
         <span style="color: #483d8b;">:html-validation-link</span> nil
         <span style="color: #483d8b;">:html-html5-fancy</span> t
         <span style="color: #483d8b;">:html-doctype</span> <span style="color: #8b2252;">"html5"</span>
         <span style="color: #483d8b;">:html-head</span> ,(file-contents <span style="color: #8b2252;">"assets/head.html"</span>)
         <span style="color: #483d8b;">:html-head-include-default-style</span> nil
         <span style="color: #483d8b;">:html-preamble</span> ,(file-contents <span style="color: #8b2252;">"assets/html_preamble-port.html"</span>)
         <span style="color: #483d8b;">:html-postamble</span> ,(file-contents <span style="color: #8b2252;">"assets/html_postamble.html"</span>)
         )

       ))

</pre>
</div>

<p>
这将删除默认注入 HTML 输出的默认 JavaScript 和 CSS 代码，并将其替换为
指向名为 Simple.css 的漂亮样式表的链接（或您自己的 CSS 文件！
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> org-html-validation-link nil            <span style="color: #b22222;">;; </span><span style="color: #b22222;">Don't show validation link</span>
      org-html-head-include-scripts nil       <span style="color: #b22222;">;; </span><span style="color: #b22222;">Use our own scripts</span>
      org-html-head-include-default-style nil <span style="color: #b22222;">;; </span><span style="color: #b22222;">Use our own styles</span>
      org-html-head <span style="color: #8b2252;">"&lt;link rel=\"stylesheet\" href=\"https://cdn.simplecss.org/simple.min.css\" /&gt;"</span>)
</pre>
</div>

<p>
<b>自定义站点地图</b>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="color: #483d8b;">:auto-sitemap</span> t
<span style="color: #483d8b;">:sitemap-title</span> nil<span style="color: #b22222;">;</span><span style="color: #b22222;">"Blog"</span>
<span style="color: #483d8b;">:sitemap-format-entry</span> my/org-publish-org-sitemap-format
<span style="color: #483d8b;">:sitemap-function</span> my/org-publish-org-sitemap
<span style="color: #483d8b;">:sitemap-sort-files</span> anti-chronologically
<span style="color: #483d8b;">:sitemap-filename</span> <span style="color: #8b2252;">"sitemap.org"</span>
<span style="color: #483d8b;">:sitemap-style</span> tree
</pre>
</div>

<p>
站点地图列表格式，以树样式格式化以表示目录结构
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my/org-publish-org-sitemap</span> (title list)
  <span style="color: #8b2252;">"Sitemap generation function."</span>
  (concat <span style="color: #8b2252;">"#+OPTIONS: toc:nil"</span>)
  (org-list-to-subtree list))
</pre>
</div>

<p>
清理缓存：
</p>

<p>
Orgmode 发布项目缓存说明 在使用 Orgmode 进行 M-x org-publish-project 来进行将 org 文件导出为项目时，发现它会有缓存，即如果 org 文件没有再修改过，它就不会再生成该文件相应的 HTML 文件了。
</p>

<ul class="org-ul">
<li>org-publish-timestamp-directory 这个就是保存时间戳文件的缓存目录。（删除该目录下的所有文件，即可进行全量重新发布）</li>
</ul>

<p>
清除上下标的设置:
</p>

<p>
默认情况下org-mode会把 <code>^, _, []</code> 等字符当做latex中的上标,下标和脚注 如果不想让org-mode误会, 也要在metadata中注明. 
</p>

<pre class="example" id="orgb5efd81">
#+OPTIONS: ^:nil
</pre>

<p>
参考博客：
</p>
<ul class="org-ul">
<li>System Crafters: <a href="https://systemcrafters.net/publishing-websites-with-org-mode/building-the-site/">https://systemcrafters.net/publishing-websites-with-org-mode/building-the-site/</a></li>
<li><a href="https://github.com/djliden/djliden.github.io/blob/main/build-site.el">https://github.com/djliden/djliden.github.io/blob/main/build-site.el</a></li>
<li><a href="https://gitlab.com/psachin/psachin.gitlab.io">psachin</a>  <a href="https://opensource.com/article/20/3/blog-emacs">https://opensource.com/article/20/3/blog-emacs</a> 配置 <a href="https://gitlab.com/psachin/psachin.gitlab.io">https://gitlab.com/psachin/psachin.gitlab.io</a></li>
<li><a href="https://github.com/emacsist">emacsist</a>  <a href="https://emacsist.github.io/emacsist/orgmode/%E4%BD%BF%E7%94%A8Orgmode%E5%86%99%E5%8D%9A%E5%AE%A2.html">使用 Orgmode 写博客</a> 仓库 <a href="https://github.com/emacsist">https://github.com/emacsist</a></li>
<li>distro.tube <a href="https://distro.tube/kb/org-publish.html">https://distro.tube/kb/org-publish.html</a></li>
<li><a href="https://www.zhangjiee.com/blog/2019/build-site-with-org-mode.html">https://www.zhangjiee.com/blog/2019/build-site-with-org-mode.html</a></li>
<li><a href="https://nicolasknoebber.com/posts/blogging-with-emacs-and-org.html">https://nicolasknoebber.com/posts/blogging-with-emacs-and-org.html</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:518a21d7-1504-456d-bfa6-271be6e3b42b" class="outline-4">
<h4 id="h:518a21d7-1504-456d-bfa6-271be6e3b42b">通过 ox-hugo 来写博客</h4>
<div class="outline-text-4" id="text-h:518a21d7-1504-456d-bfa6-271be6e3b42b">
<ul class="org-ul">
<li>hugo <a href="https://gohugo.io/getting-started/quick-start/">https://gohugo.io/getting-started/quick-start/</a></li>
<li>ox-hugo <a href="https://ox-hugo.scripter.co/">https://ox-hugo.scripter.co/</a></li>
</ul>

<p>
我们先安装 hugo
</p>
<div class="org-src-container">
<pre class="src src-sh">brew install hugo
</pre>
</div>

<p>
然后，我们来安装和配置 ox-hugo 这个插件：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="color: #a020f0;">use-package</span> ox-hugo
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">with-eval-after-load</span> 'org-capture
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-hugo-new-subtree-post-capture-template</span> ()
      <span style="color: #8b2252;">"Returns `</span><span style="color: #008b8b;">org-capture</span><span style="color: #8b2252;">' template string for new Hugo post.</span>
<span style="color: #8b2252;">See `</span><span style="color: #008b8b;">org-capture-templates</span><span style="color: #8b2252;">' for more information."</span>
      (<span style="color: #a020f0;">let*</span> ((title (read-from-minibuffer <span style="color: #8b2252;">"Post Title: "</span>)) <span style="color: #b22222;">; </span><span style="color: #b22222;">Prompt to enter the post title</span>
             (fname (org-hugo-slug title)))
        (mapconcat #'identity
                   `(
                     ,(concat <span style="color: #8b2252;">"* TODO "</span> title)
                     <span style="color: #8b2252;">":PROPERTIES:"</span>
                     ,(concat <span style="color: #8b2252;">":EXPORT_FILE_NAME: "</span> fname)
                     <span style="color: #8b2252;">":END:"</span>
                     <span style="color: #8b2252;">"%?\n"</span>)          <span style="color: #b22222;">; </span><span style="color: #b22222;">Place the cursor here finally</span>
                   <span style="color: #8b2252;">"\n"</span>)))

    (add-to-list 'org-capture-templates
                 '(<span style="color: #8b2252;">"h"</span>                <span style="color: #b22222;">; </span><span style="color: #b22222;">`</span><span style="color: #008b8b;">org-capture</span><span style="color: #b22222;">' binding + h</span>
                   <span style="color: #8b2252;">"Hugo post"</span>
                   entry
                   <span style="color: #b22222;">;; </span><span style="color: #b22222;">It is assumed that below file is present in `</span><span style="color: #008b8b;">org-directory</span><span style="color: #b22222;">'</span>
                   <span style="color: #b22222;">;; </span><span style="color: #b22222;">and that it has a "Blog Ideas" heading. It can even be a</span>
                   <span style="color: #b22222;">;; </span><span style="color: #b22222;">symlink pointing to the actual location of capture.org!</span>
                   (file+olp <span style="color: #8b2252;">"/Users/7tq6lr/projs/pyobj/c5/testblog/all-blog.org"</span> <span style="color: #8b2252;">"Blog Ideas"</span>)
                   (<span style="color: #a020f0;">function</span> org-hugo-new-subtree-post-capture-template))))
  )
</pre>
</div>

<p>
Hugo-xmin
</p>
<div class="org-src-container">
<pre class="src src-sh">hugo new site testblog
<span style="color: #483d8b;">cd</span> testblog
git init
git submodule add https://github.com/nodejh/hugo-theme-mini.git themes/mini
<span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"theme = 'mini'"</span> &gt;&gt; hugo.toml
hugo server -D
</pre>
</div>

<p>
我们按下 C-c C-e 后，选择 H h 就可以将当前的org文件按照设定的路径，导出相应的Markdown文件
</p>


<p>
all-blog-org 文件内容：
</p>
<div class="org-src-container">
<pre class="src src-org"><span style="color: #b22222;">#+HUGO_BASE_DIR: ./</span>
<span style="color: #b22222;">#+HUGO_SECTION: post</span>
<span style="color: #b22222;">#+HUGO_auto_set_lastmod: t</span>
<span style="color: #b22222;">#+hugo_code_fence: nil</span>
<span style="color: #b22222;">#+HUGO_CUSTOM_FRONT_MATTER: :hide - header - footer</span>
<span style="color: #b22222;">#+TOC: headlines 2</span>
<span style="color: #b22222;">#+FILETAGS: :Emacs:Org-mode:</span>

<span style="color: #0000ff;">* Blog Ideas</span>

<span style="color: #a0522d;">** </span><span style="color: #228b22; font-weight: bold;">DONE</span><span style="color: #a0522d;"> </span><span style="color: #bc8f8f;">My first blog</span>
<span style="color: #a020f0;">CLOSED:</span> <span style="color: #a020f0; text-decoration: underline;">[2024-07-23 &#21608;&#20108; 23:43]</span>
<span style="color: #0000ff;">:LOGBOOK:</span>
- State "DONE"       from "STARTED"    <span style="color: #a020f0; text-decoration: underline;">[2024-07-23 &#21608;&#20108; 23:43]</span>
<span style="color: #0000ff;">:END:</span>

<span style="color: #a020f0;">*** 111</span>

after

<span style="color: #a020f0;">*** 222</span>

xxxx
</pre>
</div>

<p>
配置 all-blog.org, 让它在保存内容的时候自动生成博客内容，<a href="https://ox-hugo.scripter.co/doc/auto-export-on-saving/">https://ox-hugo.scripter.co/doc/auto-export-on-saving/</a>
</p>

<p>
.dir-locals.el 放到博客目录
</p>
<div class="org-src-container">
<pre class="src src-sh">((org-mode . ((<span style="color: #483d8b;">eval</span> . (org-hugo-auto-export-mode)))))
</pre>
</div>

<p>
写完博客，自动生产调用这个脚本，my-fist-blog文章就在contenet目录中
</p>

<p>
hugo server -D 执行后浏览器查看就可以显示文章了。
</p>


<p>
配置 github 和 github workflow 来自动发布博客
</p>
<ul class="org-ul">
<li>新建一个 github 仓库</li>
<li>添加 remote 并 push 到远程</li>
<li>添加 github workflow</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:17da42b2-5694-413d-aa59-ed71c39fbee8" class="outline-3">
<h3 id="h:17da42b2-5694-413d-aa59-ed71c39fbee8">org-mode 写文档小技巧</h3>
<div class="outline-text-3" id="text-h:17da42b2-5694-413d-aa59-ed71c39fbee8">
</div>
<div id="outline-container-h:7733b0cb-b324-4929-9994-d7132f20261c" class="outline-4">
<h4 id="h:7733b0cb-b324-4929-9994-d7132f20261c">截图</h4>
<div class="outline-text-4" id="text-h:7733b0cb-b324-4929-9994-d7132f20261c">
<p>
截图工具:
</p>

<ul class="org-ul">
<li>picpick <a href="https://picpick.app/">https://picpick.app/</a></li>
<li>snipaste <a href="https://www.snipaste.com/">https://www.snipaste.com/</a></li>
</ul>

<p>
window 自带截屏快捷键 win+Shift+s 保存到剪切板中。
</p>


<p>
使用截图会保存在系统剪贴板中，实现粘贴有如下方法：
</p>

<ul class="org-ul">
<li>一个小函数</li>
<li><a href="https://github.com/abo-abo/org-download">org-download</a> 插件</li>
</ul>
</div>
<div id="outline-container-h:07656bfa-f29d-4ae3-acbc-b6f55e6ad62a" class="outline-5">
<h5 id="h:07656bfa-f29d-4ae3-acbc-b6f55e6ad62a">一个小函数</h5>
<div class="outline-text-5" id="text-h:07656bfa-f29d-4ae3-acbc-b6f55e6ad62a">
<p>
<b>前置条件</b>
</p>

<p>
mac 中安装命令行工具 <a href="https://github.com/jcsalterego/pngpaste">pngpaste</a> 来实现粘贴
</p>
<div class="org-src-container">
<pre class="src src-sh">brew install pngpaste
</pre>
</div>

<p>
Linux 命令行工具 <a href="https://github.com/astrand/xclip">xclip</a> 
</p>



<p>
<b>编写函数</b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> emacs
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:after</span> org
  <span style="color: #483d8b;">:bind</span> (<span style="color: #483d8b;">:map</span> org-mode-map
              (<span style="color: #8b2252;">"s-V"</span> . my/org-insert-clipboard-image))
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my/org-insert-clipboard-image</span> (width)
    <span style="color: #8b2252;">"create a time stamped unique-named file from the clipboard in the sub-directory</span>
<span style="color: #8b2252;"> (%filename.assets) as the org-buffer and insert a link to this file."</span>
    (<span style="color: #a020f0;">interactive</span> (list
                  (read-string (format <span style="color: #8b2252;">"Input image width, default is 800: "</span>)
                               nil nil <span style="color: #8b2252;">"800"</span>)))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#22270;&#29255;&#23384;&#25918;&#30340;&#25991;&#20214;&#22841;&#20301;&#32622;&#20026; `</span><span style="color: #008b8b;">&#24403;&#21069;Org&#25991;&#20214;&#21516;&#21517;.assets</span><span style="color: #b22222;">'</span>
    (<span style="color: #a020f0;">setq</span> foldername <span style="color: #8b2252;">"./images/"</span>)
    (<span style="color: #a020f0;">if</span> (not (file-exists-p foldername))
        (mkdir foldername))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#22270;&#29255;&#30340;&#25991;&#20214;&#21517;&#65292;&#26684;&#24335;&#20026; `</span><span style="color: #008b8b;">img_&#24180;&#26376;&#26085;_&#26102;&#20998;&#31186;.png</span><span style="color: #b22222;">'</span>
    (<span style="color: #a020f0;">setq</span> imgName (concat <span style="color: #8b2252;">"img_"</span> (format-time-string <span style="color: #8b2252;">"%Y%m%d_%H%M%S"</span>) <span style="color: #8b2252;">".png"</span>))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22270;&#29255;&#25991;&#20214;&#30340;&#30456;&#23545;&#36335;&#24452;</span>
    (<span style="color: #a020f0;">setq</span> relativeFilename (concat <span style="color: #8b2252;">"./images/"</span> imgName))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26681;&#25454;&#19981;&#21516;&#30340;&#25805;&#20316;&#31995;&#32479;&#35774;&#32622;&#19981;&#21516;&#30340;&#21629;&#20196;&#34892;&#24037;&#20855;</span>
    (<span style="color: #a020f0;">cond</span> ((string-equal system-type <span style="color: #8b2252;">"gnu/linux"</span>)
           (shell-command (concat <span style="color: #8b2252;">"xclip -selection clipboard -t image/png -o &gt; "</span> relativeFilename)))
          ((string-equal system-type <span style="color: #8b2252;">"darwin"</span>)
           (shell-command (concat <span style="color: #8b2252;">"pngpaste "</span> relativeFilename)))
          ((string-equal system-type <span style="color: #8b2252;">"windows-nt"</span>)
           (shell-command (concat <span style="color: #8b2252;">"powershell -command \"Add-Type -AssemblyName System.Windows.Forms;if ($([System.Windows.Forms.Clipboard]::ContainsImage())) {$image = [System.Windows.Forms.Clipboard]::GetImage();[System.Drawing.Bitmap]$image.Save('"</span>relativeFilename <span style="color: #8b2252;">"',[System.Drawing.Imaging.ImageFormat]::Png); Write-Output 'clipboard content saved as file'} else {Write-Output 'clipboard does not contain image data'}\""</span>))))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32473;&#31896;&#36148;&#22909;&#30340;&#22270;&#29255;&#38142;&#25509;&#21152;&#19978;&#23485;&#24230;&#23646;&#24615;&#65292;&#26041;&#20415;&#23548;&#20986;</span>
    (insert (concat <span style="color: #8b2252;">"\n#+DOWNLOADED: screenshot @ "</span>
                    (format-time-string <span style="color: #8b2252;">"%Y-%m-%d %a %H:%M:%S"</span> (current-time))
                    <span style="color: #8b2252;">"\n#+CAPTION: \n#+ATTR_ORG: :width "</span>
                    width
                    <span style="color: #8b2252;">"\n#+ATTR_LATEX: :width "</span>
                    (<span style="color: #a020f0;">if</span> (&gt;= (/ (string-to-number width) 800.0) 1.0)
                        <span style="color: #8b2252;">"1.0"</span>
                      (number-to-string (/ (string-to-number width) 800.0)))
                    <span style="color: #8b2252;">"\\linewidth :float nil\n"</span>
                    <span style="color: #8b2252;">"#+ATTR_HTML: :width "</span>
                    width
                    <span style="color: #8b2252;">"\n[[file:"</span> relativeFilename <span style="color: #8b2252;">"]]\n"</span>))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#37325;&#26032;&#26174;&#31034;&#19968;&#19979;&#22270;&#29255;</span>
    (org-redisplay-inline-images)
    )
  )
</pre>
</div>

<p>
函数绑定了另外一个快捷键 <code>Cmd-Shift-v</code> 。输入一个宽度（默认宽度为800，直接按回车就是默认宽度），然后整个粘贴工作就完成了，
</p>

<p>
或者改 F2 粘贴截图：
</p>
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my/org-insert-clipboard-image</span> (width)
  <span style="color: #8b2252;">"create a time stamped unique-named file from the clipboard in the sub-directory</span>
<span style="color: #8b2252;"> (%filename.assets) as the org-buffer and insert a link to this file."</span>
  (<span style="color: #a020f0;">interactive</span> (list
                (read-string (format <span style="color: #8b2252;">"Input image width, default is 800: "</span>)
                             nil nil <span style="color: #8b2252;">"800"</span>)))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#22270;&#29255;&#23384;&#25918;&#30340;&#25991;&#20214;&#22841;&#20301;&#32622;&#20026; `</span><span style="color: #008b8b;">&#24403;&#21069;Org&#25991;&#20214;&#21516;&#21517;.assets</span><span style="color: #b22222;">'</span>
  (<span style="color: #a020f0;">setq</span> foldername <span style="color: #8b2252;">"./images/"</span>)
  (<span style="color: #a020f0;">if</span> (not (file-exists-p foldername))
      (mkdir foldername))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#22270;&#29255;&#30340;&#25991;&#20214;&#21517;&#65292;&#26684;&#24335;&#20026; `</span><span style="color: #008b8b;">img_&#24180;&#26376;&#26085;_&#26102;&#20998;&#31186;.png</span><span style="color: #b22222;">'</span>
  (<span style="color: #a020f0;">setq</span> imgName (concat <span style="color: #8b2252;">"img_"</span> (format-time-string <span style="color: #8b2252;">"%Y%m%d_%H%M%S"</span>) <span style="color: #8b2252;">".png"</span>))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22270;&#29255;&#25991;&#20214;&#30340;&#30456;&#23545;&#36335;&#24452;</span>
  (<span style="color: #a020f0;">setq</span> relativeFilename (concat <span style="color: #8b2252;">"./images/"</span> imgName))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26681;&#25454;&#19981;&#21516;&#30340;&#25805;&#20316;&#31995;&#32479;&#35774;&#32622;&#19981;&#21516;&#30340;&#21629;&#20196;&#34892;&#24037;&#20855;</span>
  (<span style="color: #a020f0;">cond</span> ((string-equal system-type <span style="color: #8b2252;">"gnu/linux"</span>)
         (shell-command (concat <span style="color: #8b2252;">"xclip -selection clipboard -t image/png -o &gt; "</span> relativeFilename)))
        ((string-equal system-type <span style="color: #8b2252;">"darwin"</span>)
         (shell-command (concat <span style="color: #8b2252;">"pngpaste "</span> relativeFilename)))
        ((string-equal system-type <span style="color: #8b2252;">"windows-nt"</span>)
         (shell-command (concat <span style="color: #8b2252;">"powershell -command \"Add-Type -AssemblyName System.Windows.Forms;if ($([System.Windows.Forms.Clipboard]::ContainsImage())) {$image = [System.Windows.Forms.Clipboard]::GetImage();[System.Drawing.Bitmap]$image.Save('"</span>relativeFilename <span style="color: #8b2252;">"',[System.Drawing.Imaging.ImageFormat]::Png); Write-Output 'clipboard content saved as file'} else {Write-Output 'clipboard does not contain image data'}\""</span>))))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32473;&#31896;&#36148;&#22909;&#30340;&#22270;&#29255;&#38142;&#25509;&#21152;&#19978;&#23485;&#24230;&#23646;&#24615;&#65292;&#26041;&#20415;&#23548;&#20986;</span>
  (insert (concat <span style="color: #8b2252;">"\n#+DOWNLOADED: screenshot @ "</span>
                  (format-time-string <span style="color: #8b2252;">"%Y-%m-%d %a %H:%M:%S"</span> (current-time))
                  <span style="color: #8b2252;">"\n#+CAPTION: \n#+ATTR_ORG: :width "</span>
                  width
                  <span style="color: #8b2252;">"\n#+ATTR_LATEX: :width "</span>
                  (<span style="color: #a020f0;">if</span> (&gt;= (/ (string-to-number width) 800.0) 1.0)
                      <span style="color: #8b2252;">"1.0"</span>
                    (number-to-string (/ (string-to-number width) 800.0)))
                  <span style="color: #8b2252;">"\\linewidth :float nil\n"</span>
                  <span style="color: #8b2252;">"#+ATTR_HTML: :width "</span>
                  width
                  <span style="color: #8b2252;">"\n[[file:"</span> relativeFilename <span style="color: #8b2252;">"]]\n"</span>))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#37325;&#26032;&#26174;&#31034;&#19968;&#19979;&#22270;&#29255;</span>
  (org-redisplay-inline-images)
  (message <span style="color: #8b2252;">"OKKKK"</span>)
  )

(global-set-key (kbd <span style="color: #8b2252;">"&lt;f2&gt;"</span>) 'my/org-insert-clipboard-image)
</pre>
</div>

<p>
<b>图片压缩</b>
</p>

<p>
图片压缩工具有很多，这里使用 <a href="https://ffmpeg.org/">FFmpeg</a> 视频处理工具
</p>

<p>
透明度/动画 支持
</p>
<ul class="org-ul">
<li>jpg 不支持透明度，不支持动画</li>
<li>png 支持透明度，支持动画（apng，效果不好）</li>
<li>webp 支持透明度，支持动画</li>
</ul>

<p>
浏览器支持
</p>
<ul class="org-ul">
<li>jpg 现代浏览器都支持</li>
<li>png 现代浏览器都支持</li>
<li>webp 大部分现代浏览器支持</li>
</ul>

<p>
范例： 300KB png 格式文件压缩测试
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">png&#26684;&#24335; &#26377;&#20013;&#38388;&#35843;&#33394;&#26495;&#65292;300--&gt;102KB</span>
ffmpeg -i t.png  -vf <span style="color: #a0522d;">palettegen</span>=<span style="color: #a0522d;">max_colors</span>=256:<span style="color: #a0522d;">stats_mode</span>=single -y  out_3.png  
ffmpeg -i t.png -i out_3.png -lavfi <span style="color: #8b2252;">"[0][1:v] paletteuse"</span> -pix_fmt pal8 -y c.png

<span style="color: #b22222;">#</span><span style="color: #b22222;">webp&#26684;&#24335; 300--&gt;32KB</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">-lossless &#26159;&#35774;&#32622;&#26080;&#25439;&#21387;&#32553;</span>
ffmpeg -i t.png  -vf <span style="color: #a0522d;">scale</span>=iw:ih -codec libwebp -lossless 0 -quality 75  -y d.png

<span style="color: #b22222;">#</span><span style="color: #b22222;">jpg&#26684;&#24335; 300--&gt;78KB</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">-q:v&#36873;&#39033;&#26469;&#35774;&#32622;&#21387;&#32553;&#36136;&#37327;&#65292;&#20540;&#20026;2&#12290;&#36825;&#20010;&#20540;&#33539;&#22260;&#20026;0&#21040;31&#65292;&#20854;&#20013;0&#20026;&#26368;&#39640;&#36136;&#37327;&#65292;31&#20026;&#26368;&#20302;&#36136;&#37327;&#12290;</span>
ffmpeg -i t.png -q:v 4 -y output.jpg

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25913;&#21464;&#22823;&#23567;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22270;&#29255;&#21387;&#32553;&#20026;&#23610;&#23544;&#20026;640x480&#20687;&#32032;</span>
ffmpeg -i t.png -vf <span style="color: #a0522d;">scale</span>=640:480 -y output.jpg
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21333;&#32431;&#35843;&#25972;&#22270;&#29255;&#22823;&#23567;&#65292;&#26080;&#25439;&#21387;&#32553;&#25226;&#22270;&#29255;&#23485;&#39640;&#32553;&#23567;2&#20493;iw/2:ih/2</span>
ffmpeg -i t.png -vf <span style="color: #a0522d;">scale</span>=iw/2:ih/2 -y a.png

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#38745;&#24577;&#36755;&#20986;</span>
-loglevel quiet
</pre>
</div>

<p>
完整的脚本：
</p>

<div class="org-src-container">
<pre class="src src-elisp">  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my/org-insert-clipboard-image</span> (width)
    <span style="color: #8b2252;">"create a time stamped unique-named file from the clipboard in the sub-directory</span>
<span style="color: #8b2252;"> (%filename.assets) as the org-buffer and insert a link to this file."</span>
    (<span style="color: #a020f0;">interactive</span> (list
                  (read-string (format <span style="color: #8b2252;">"Input image width, default is 800: "</span>)
                               nil nil <span style="color: #8b2252;">"800"</span>)))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#22270;&#29255;&#23384;&#25918;&#30340;&#25991;&#20214;&#22841;&#20301;&#32622;&#20026; `</span><span style="color: #008b8b;">&#24403;&#21069;Org&#25991;&#20214;&#21516;&#21517;.assets</span><span style="color: #b22222;">'</span>
    (<span style="color: #a020f0;">setq</span> foldername <span style="color: #8b2252;">"./images/"</span>)
    (<span style="color: #a020f0;">if</span> (not (file-exists-p foldername))
        (mkdir foldername))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35774;&#32622;&#22270;&#29255;&#30340;&#25991;&#20214;&#21517;&#65292;&#26684;&#24335;&#20026; `</span><span style="color: #008b8b;">img_&#24180;&#26376;&#26085;_&#26102;&#20998;&#31186;.png</span><span style="color: #b22222;">'</span>
    (<span style="color: #a020f0;">setq</span> srcImgName (concat <span style="color: #8b2252;">"img_"</span> (format-time-string <span style="color: #8b2252;">"%Y%m%d_%H%M%S"</span>) <span style="color: #8b2252;">"_src.png"</span>))
    (<span style="color: #a020f0;">setq</span> imgName (concat <span style="color: #8b2252;">"img_"</span> (format-time-string <span style="color: #8b2252;">"%Y%m%d_%H%M%S"</span>) <span style="color: #8b2252;">".png"</span>))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22270;&#29255;&#25991;&#20214;&#30340;&#30456;&#23545;&#36335;&#24452;</span>
    (<span style="color: #a020f0;">setq</span> srcRelativeFilename (concat <span style="color: #8b2252;">"./images/"</span> srcImgName))
    (<span style="color: #a020f0;">setq</span> relativeFilename (concat <span style="color: #8b2252;">"./images/"</span> imgName))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26681;&#25454;&#19981;&#21516;&#30340;&#25805;&#20316;&#31995;&#32479;&#35774;&#32622;&#19981;&#21516;&#30340;&#21629;&#20196;&#34892;&#24037;&#20855;</span>
    (<span style="color: #a020f0;">cond</span> ((string-equal system-type <span style="color: #8b2252;">"gnu/linux"</span>)
           (shell-command (concat <span style="color: #8b2252;">"xclip -selection clipboard -t image/png -o &gt; "</span> relativeFilename)))
          ((string-equal system-type <span style="color: #8b2252;">"darwin"</span>)
           (shell-command (concat <span style="color: #8b2252;">"pngpaste "</span> relativeFilename)))
          ((string-equal system-type <span style="color: #8b2252;">"windows-nt"</span>)
           <span style="color: #b22222;">;;</span><span style="color: #b22222;">(shell-command (concat "powershell -command \"Add-Type -AssemblyName System.Windows.Forms; if ($([System.Windows.Forms.Clipboard]::ContainsImage())) { $image = [System.Windows.Forms.Clipboard]::GetImage(); $image.Save('"srcRelativeFilename "', [System.Drawing.Imaging.ImageFormat]::Png); Write-Output 'Clipboard content saved as file'; &amp; ffmpeg -i "srcRelativeFilename " -q:v 4 -loglevel quiet -y "relativeFilename " } else { Write-Output 'Clipboard does not contain image data' }\""))))</span>
           <span style="color: #b22222;">;;</span><span style="color: #b22222;">(shell-command (concat "powershell -command \"Add-Type -AssemblyName System.Windows.Forms; if ($([System.Windows.Forms.Clipboard]::ContainsImage())) { $image = [System.Windows.Forms.Clipboard]::GetImage(); $image.Save('"srcRelativeFilename "', [System.Drawing.Imaging.ImageFormat]::Png); Write-Output 'Clipboard content saved as file'; &amp; ffmpeg -i "srcRelativeFilename " -q:v 4 -loglevel quiet -y "relativeFilename " ;&amp; Remove-Item -Path "srcRelativeFilename" -Force} else { Write-Output 'Clipboard does not contain image data' }\""))))</span>
           <span style="color: #b22222;">;;</span><span style="color: #b22222;">(shell-command (concat "powershell -command \"Add-Type -AssemblyName System.Windows.Forms; if ($([System.Windows.Forms.Clipboard]::ContainsImage())) { $image = [System.Windows.Forms.Clipboard]::GetImage(); $image.Save('"srcRelativeFilename "', [System.Drawing.Imaging.ImageFormat]::Png); Write-Output 'Clipboard content saved as file'; ffmpeg -i "srcRelativeFilename " -vf '</span><span style="color: #008b8b;">palettegen=max_colors=256:stats_mode=single</span><span style="color: #b22222;">' -loglevel quiet -y  out_3.png ; ffmpeg -i "srcRelativeFilename " -i out_3.png -lavfi '[0][1:v] paletteuse' -pix_fmt pal8 -loglevel quiet -y "relativeFilename "} else { Write-Output 'Clipboard does not contain image data' }\""))))</span>
           (shell-command (concat <span style="color: #8b2252;">"powershell -command \"Add-Type -AssemblyName System.Windows.Forms; if ($([System.Windows.Forms.Clipboard]::ContainsImage())) { $image = [System.Windows.Forms.Clipboard]::GetImage(); $image.Save('"</span>srcRelativeFilename <span style="color: #8b2252;">"', [System.Drawing.Imaging.ImageFormat]::Png); Write-Output 'Clipboard content saved as file'; ffmpeg -i "</span>srcRelativeFilename <span style="color: #8b2252;">" -vf '</span><span style="color: #008b8b;">palettegen=max_colors=256:stats_mode=single</span><span style="color: #8b2252;">' -loglevel quiet -y  out_3.png ; ffmpeg -i "</span>srcRelativeFilename <span style="color: #8b2252;">" -i out_3.png -lavfi '[0][1:v] paletteuse' -pix_fmt pal8 -loglevel quiet -y "</span>relativeFilename <span style="color: #8b2252;">"; Remove-Item -Path "</span>srcRelativeFilename<span style="color: #8b2252;">" -Force ; Remove-Item -Path out_3.png  -Force} else { Write-Output 'Clipboard does not contain image data' }\""</span>))))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32473;&#31896;&#36148;&#22909;&#30340;&#22270;&#29255;&#38142;&#25509;&#21152;&#19978;&#23485;&#24230;&#23646;&#24615;&#65292;&#26041;&#20415;&#23548;&#20986;</span>
    (insert (concat <span style="color: #8b2252;">"\n#+DOWNLOADED: screenshot @ "</span>
                    (format-time-string <span style="color: #8b2252;">"%Y-%m-%d %a %H:%M:%S"</span> (current-time))
                    <span style="color: #8b2252;">"\n#+CAPTION: \n#+ATTR_ORG: :width "</span>
                    width
                    <span style="color: #8b2252;">"\n#+ATTR_LATEX: :width "</span>
                    (<span style="color: #a020f0;">if</span> (&gt;= (/ (string-to-number width) 800.0) 1.0)
                        <span style="color: #8b2252;">"1.0"</span>
                      (number-to-string (/ (string-to-number width) 800.0)))
                    <span style="color: #8b2252;">"\\linewidth :float nil\n"</span>
                    <span style="color: #8b2252;">"#+ATTR_HTML: :width "</span>
                    width
                    <span style="color: #8b2252;">"\n[[file:"</span> relativeFilename <span style="color: #8b2252;">"]]\n"</span>))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#37325;&#26032;&#26174;&#31034;&#19968;&#19979;&#22270;&#29255;</span>
    (org-redisplay-inline-images)
    (message <span style="color: #8b2252;">"OKKKKKK"</span>)
    )

(global-set-key (kbd <span style="color: #8b2252;">"&lt;f2&gt;"</span>) 'my/org-insert-clipboard-image)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:7eb13b73-f15d-4980-a7e4-3220a908bd23" class="outline-5">
<h5 id="h:7eb13b73-f15d-4980-a7e4-3220a908bd23">org-download</h5>
<div class="outline-text-5" id="text-h:7eb13b73-f15d-4980-a7e4-3220a908bd23">
<p>
需要借助 <code>org-download</code> 实现. 在这里只给出实现截图功能的设置代码, 以后的教程再详细讲解.
</p>

<p>
使用方法
</p>
<ul class="org-ul">
<li>使用系统截图工具 (<code>Windows</code> 下用 <code>&lt;Win&gt;+&lt;shift&gt;+s</code>) 将截图保存到剪贴板</li>
<li>用 <code>C-M-y</code> (绑定了 <code>org-download-clipboard</code> 函数) 将剪贴板中图片粘贴到 <code>org</code> 文件中.</li>
</ul>

<p>
安装方法  
</p>
<ul class="org-ul">
<li><code>Linux</code> / <code>MacOS</code>
<ul class="org-ul">
<li>安装截图工具 snipaste</li>
<li>用以下 <code>use-package</code> 代码安装及设置</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">use-package</span> org-download
  <span style="color: #483d8b;">:ensure</span> t <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#33258;&#21160;&#20174; melpa &#19978;&#23433;&#35013;</span>
  <span style="color: #483d8b;">:defer</span> t <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24310;&#36831;&#21152;&#36733;</span>
  <span style="color: #483d8b;">:bind</span>
  (<span style="color: #483d8b;">:map</span> org-mode-map
        (<span style="color: #8b2252;">"C-M-y"</span> . org-download-clipboard)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32465;&#23450;&#20174;&#21098;&#36148;&#29256;&#31896;&#36148;&#25130;&#22270;&#30340;&#24555;&#25463;&#38190;</span>
  <span style="color: #483d8b;">:custom</span>
  (org-download-heading-lvl 1) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#29992;&#19968;&#32423;&#26631;&#39064;&#32473;&#25130;&#22270;&#25991;&#20214;&#21629;&#21517;</span>
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> org-download-image-attr-list
        '(<span style="color: #8b2252;">"#+ATTR_HTML: :width 80% :align center"</span>))
  (<span style="color: #a020f0;">setq-default</span> org-download-image-dir <span style="color: #8b2252;">"./images"</span>)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#29992;&#21516;&#32423; ./img &#30446;&#24405;&#25918;&#32622;&#25130;&#22270;&#25991;&#20214;</span>
</pre>
</div>


<ul class="org-ul">
<li><code>Windows</code>
<ul class="org-ul">
<li><p>
需要安装 <code>ImageMagick</code>, 并保证 <code>magick.exe</code> 在 <code>PATH</code> 变量的路径中
用 <code>msys2</code> 安装
</p>
<div class="org-src-container">
<pre class="src src-sh">pacman -S mingw-w64-x86_64-imagemagick
</pre>
</div></li>
<li>从<a href="https://github.com/abo-abo/org-download/blob/acc9622968cb4d0027cd3478c374191597c18ea4/org-download.el%20%E6%88%96">这里</a>或网盘下载 <code>org-download.el</code> 文件, 置于你的 <code>.emacs.d</code> 文件夹合适的路径中 (如 <code>~/.emacs.d/lisp/</code>)</li>
<li><p>
使用以下 <code>use-package</code> 代码及设置
</p>
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">use-package</span> org-download
  <span style="color: #483d8b;">:ensure</span> async <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22240;&#20026;&#19981;&#26159;&#20174;melpa&#23433;&#35013;, &#38656;&#35201;&#25163;&#21160;&#20445;&#35777;async&#23433;&#35013;</span>
  <span style="color: #483d8b;">:defer</span> t <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24310;&#36831;&#21152;&#36733;</span>
  <span style="color: #483d8b;">:load-path</span> <span style="color: #8b2252;">"~/.emacs.d/lisp/"</span>
  <span style="color: #483d8b;">:bind</span>
  (<span style="color: #483d8b;">:map</span> org-mode-map
        (<span style="color: #8b2252;">"C-M-y"</span> . org-download-clipboard)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32465;&#23450;&#20174;&#21098;&#36148;&#29256;&#31896;&#36148;&#25130;&#22270;&#30340;&#24555;&#25463;&#38190;</span>
  <span style="color: #483d8b;">:custom</span>
  (org-download-heading-lvl 1) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#29992;&#19968;&#32423;&#26631;&#39064;&#32473;&#25130;&#22270;&#25991;&#20214;&#21629;&#21517;</span>
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq-default</span> org-download-image-dir <span style="color: #8b2252;">"./images"</span>)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#29992;&#21516;&#32423; ./img &#30446;&#24405;&#25918;&#32622;&#25130;&#22270;&#25991;&#20214;</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-h:bd070f19-2283-4563-9779-45e95f01cb8b" class="outline-3">
<h3 id="h:bd070f19-2283-4563-9779-45e95f01cb8b">在Org mode里用纯文本画图</h3>
<div class="outline-text-3" id="text-h:bd070f19-2283-4563-9779-45e95f01cb8b">
<p>
在Emacs的Org mode里，我们可以有很多画图语言的选择，比较知名的有：
</p>

<ul class="org-ul">
<li><a href="https://plantuml.com/zh/">plantuml</a> 推荐</li>
<li><a href="https://github.com/terrastruct/d2">d2</a></li>
<li><a href="https://mermaid.js.org/">mermaid</a></li>
<li><a href="https://graphviz.org/">graphviz</a></li>
<li><a href="https://ditaa.sourceforge.net/">ditaa</a></li>
<li>…</li>
</ul>
</div>
<div id="outline-container-h:04fdfc58-954d-495d-90de-dd7c9f11a551" class="outline-4">
<h4 id="h:04fdfc58-954d-495d-90de-dd7c9f11a551">plantuml</h4>
<div class="outline-text-4" id="text-h:04fdfc58-954d-495d-90de-dd7c9f11a551">
<p>
官方：<a href="https://plantuml.com/zh/">https://plantuml.com/zh/</a>
</p>

<p>
比较推荐的是 plantuml ，主要是它支持的图形种类最多：
</p>
<ul class="org-ul">
<li>序列图</li>
<li>用例图</li>
<li>类图</li>
<li>对象图</li>
<li>活动图（这里是传统的语法）。</li>
<li>组件图</li>
<li>部署图</li>
<li>状态图</li>
<li>时序图</li>
</ul>

<p>
也支持以下非UML图表：
</p>
<ul class="org-ul">
<li>JSON数据</li>
<li>YAML数据</li>
<li>Extended Backus-Naur Form (EBNF)图表</li>
<li>网络图（nwdiag）</li>
<li>线框图形界面或UI模拟图（盐）。</li>
<li>架构图</li>
<li>规范和描述语言（SDL）</li>
<li>Ditaa图</li>
<li>甘特图</li>
<li>思维导图</li>
<li>工作分解结构图（WBS）</li>
<li>用AsciiMath或JLaTeXMath符号进行数学计算</li>
<li>实体关系图（IE/ER）。</li>
</ul>

<p>
这样基本上我们只需要学会 plantuml 的语法，就能够画出我们工作中需要的所有类型的图了，非常划算。
</p>
</div>
<div id="outline-container-h:2080c3ce-fad8-4539-b959-f6e370635542" class="outline-5">
<h5 id="h:2080c3ce-fad8-4539-b959-f6e370635542">PlantUML的安装和配置</h5>
<div class="outline-text-5" id="text-h:2080c3ce-fad8-4539-b959-f6e370635542">
<p>
软件包安装
</p>

<p>
mac
</p>
<div class="org-src-container">
<pre class="src src-sh">brew install plantuml 
</pre>
</div>

<p>
配置Emacs和Org mode支持 plantuml
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> plantuml-mode
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:mode</span> (<span style="color: #8b2252;">"\\.plantuml\\'"</span> . plantuml-mode)
  <span style="color: #483d8b;">:init</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">enable plantuml babel support</span>
  (add-to-list 'org-src-lang-modes '(<span style="color: #8b2252;">"plantuml"</span> . plantuml))
  (org-babel-do-load-languages 'org-babel-load-languages
                               (append org-babel-load-languages
                                       '((plantuml . t))))
  <span style="color: #483d8b;">:config</span>
  (<span style="color: #a020f0;">setq</span> org-plantuml-exec-mode 'plantuml)
  (<span style="color: #a020f0;">setq</span> org-plantuml-executable-path <span style="color: #8b2252;">"plantuml"</span>)
  (<span style="color: #a020f0;">setq</span> plantuml-executable-path <span style="color: #8b2252;">"plantuml"</span>)
  (<span style="color: #a020f0;">setq</span> plantuml-default-exec-mode 'executable)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">set default babel header arguments</span>
  (<span style="color: #a020f0;">setq</span> org-babel-default-header-args:plantuml
        '((<span style="color: #483d8b;">:exports</span> . <span style="color: #8b2252;">"results"</span>)
          (<span style="color: #483d8b;">:results</span> . <span style="color: #8b2252;">"file"</span>)
          ))
  )
</pre>
</div>

<p>
按下 <code>C-c C-c</code> 执行代码块， plantuml 就会自动解析文本执行，并生成你想要的图片啦
</p>

<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-text">#+BEGIN_SRC plantuml :file ./images/uml_20230704_150.png :width 400 :exports both
  @startuml
  !theme materia                             /' &#35774;&#23450;&#20027;&#39064; '/
  scale 2                                    /' &#35774;&#23450;&#22270;&#29255;&#30340;&#28165;&#26224;&#24230; '/

  skinparam componentStyle rectangle

  A -&gt; B : 1. hello\n2. world

  @endgantt
#+END_SRC

#+RESULTS:
#+ATTR_ORG: :width 400
#+ATTR_HTML: :width 400
[[file:./images/uml_20230704_150.png]]
</pre>
</div>
</div>
</div>
<div id="outline-container-h:25de2b1a-485f-4ade-a405-d2722e159349" class="outline-5">
<h5 id="h:25de2b1a-485f-4ade-a405-d2722e159349">PlantUML各种图形的示例</h5>
<div class="outline-text-5" id="text-h:25de2b1a-485f-4ade-a405-d2722e159349">
</div>
<div id="outline-container-h:b0294d97-9d21-4d20-b3e5-f0738b953134" class="outline-6">
<h6 id="h:b0294d97-9d21-4d20-b3e5-f0738b953134">时序图</h6>
<div class="outline-text-6" id="text-h:b0294d97-9d21-4d20-b3e5-f0738b953134">
<p>
时序图是我们经常画的图，我们常常来描述业务流程的时候通过时序图来描述，下面是一个时序图的例子
</p>

<div class="org-src-container">
<pre class="src src-text">#+begin_src plantuml :file ./images/uml_20230115_135944.png :width 400 :exports both
  @startuml
  !theme materia                             /' &#35774;&#23450;&#20027;&#39064; '/
  scale 2                                    /' &#35774;&#23450;&#22270;&#29255;&#30340;&#28165;&#26224;&#24230; '/

  Alice -&gt; Bob: Authentication Request
  Bob --&gt; Alice: Authentication Response

  Alice -&gt; Bob: Another authentication request
  Alice &lt;-- Bob: Another authentication response

  @enduml
#+end_src
</pre>
</div>


<figure id="org891f650">
<img src="./images/Snipaste_2023-07-04_22-37-59.png" alt="Snipaste_2023-07-04_22-37-59.png" width="60%">

</figure>
</div>
</div>
<div id="outline-container-h:3f0bb6c4-ce4e-4473-85a2-245f3d79273d" class="outline-6">
<h6 id="h:3f0bb6c4-ce4e-4473-85a2-245f3d79273d">类图</h6>
<div class="outline-text-6" id="text-h:3f0bb6c4-ce4e-4473-85a2-245f3d79273d">
<p>
我们用来描述类、实例、关系的时候常常会用到类图
</p>

<div class="org-src-container">
<pre class="src src-text">#+BEGIN_SRC plantuml :file ./images/uml_20230115_151217.png :width 800 :exports both
@startuml
!theme materia
scale 2
skinparam componentStyle rectangle
class Class
class ClassExpression
class IRI
class Entity
class ObjectProperty
class DataProperty
class AnnotationProperty
class Datatype
class DataRange {
        arity: UnlimitedNatural
        }
class NamedIndividual
class Individual
class AnonymousIndividual {
        nodeID: String
        }
class Literal {
        lexicalFrom: String
        }

Class -up-|&gt; ClassExpression
Class -up-|&gt; Entity
ObjectProperty -up-|&gt; Entity
DataProperty -up-|&gt; Entity
AnnotationProperty -up-|&gt; Entity
Datatype -up-|&gt; Entity
Datatype -up-|&gt; DataRange
NamedIndividual -up-|&gt; Entity
NamedIndividual -up-|&gt; Individual
AnonymousIndividual -up-|&gt; Individual
Entity -left-&gt; IRI
Literal -up-&gt; Datatype

Note bottom of Datatype: The arity of a datatype muse be one.
@enduml
#+END_SRC
</pre>
</div>


<figure id="org1abfcf9">
<img src="./images/Snipaste_2023-07-04_22-40-26.png" alt="Snipaste_2023-07-04_22-40-26.png" width="60%">

</figure>
</div>
</div>
<div id="outline-container-h:53f989f7-a276-49a9-8f15-ad9d79fece8c" class="outline-6">
<h6 id="h:53f989f7-a276-49a9-8f15-ad9d79fece8c">组件图</h6>
<div class="outline-text-6" id="text-h:53f989f7-a276-49a9-8f15-ad9d79fece8c">
<p>
我们可以通过组件图来画产品的架构、技术架构等。 
</p>

<div class="org-src-container">
<pre class="src src-text">#+BEGIN_SRC plantuml :file ./images/uml_20230115_151535.png :width 400 :exports both
@startuml
!theme materia
scale 2
skinparam componentStyle rectangle

package "Some Group" {
  HTTP - [First Component]
  [Another Component]
}

node "Other Groups" {
  FTP - [Second Component]
  [First Component] --&gt; FTP
}

cloud {
  [Example 1]
}


database "MySql" {
  folder "This is my folder" {
    [Folder 3]
  }
  frame "Foo" {
    [Frame 4]
  }
}


[Another Component] --&gt; [Example 1]
[Example 1] --&gt; [Folder 3]
[Folder 3] --&gt; [Frame 4]

@enduml
#+END_SRC
</pre>
</div>


<figure id="orga697326">
<img src="./images/Snipaste_2023-07-04_22-42-13.png" alt="Snipaste_2023-07-04_22-42-13.png" width="60%">

</figure>
</div>
</div>
<div id="outline-container-h:b6d9e0ea-8d0b-430e-ad91-2b98a46b3e67" class="outline-6">
<h6 id="h:b6d9e0ea-8d0b-430e-ad91-2b98a46b3e67">活动图</h6>
<div class="outline-text-6" id="text-h:b6d9e0ea-8d0b-430e-ad91-2b98a46b3e67">
<p>
我们可以通过活动图来画一些偏程序向的流程图。
</p>

<div class="org-src-container">
<pre class="src src-text">#+BEGIN_SRC plantuml :file ./images/uml_20230115_151804.png :width 400 :exports both
@startuml
!theme materia
scale 2
skinparam componentStyle rectangle

start
if (Graphviz &#24050;&#23433;&#35013;?) then (yes)
  :&#22788;&#29702;&#25152;&#26377;\n&#32472;&#21046;&#20219;&#21153;;
else (no)
  :&#20165;&#22788;&#29702;
  __&#26102;&#24207;&#22270;__ &#21644; __&#27963;&#21160;__ &#22270;;
endif
stop

@enduml
#+END_SRC
</pre>
</div>


<figure id="org8be7666">
<img src="./images/Snipaste_2023-07-04_22-44-09.png" alt="Snipaste_2023-07-04_22-44-09.png" width="60%">

</figure>
</div>
</div>
<div id="outline-container-h:488ec2b6-d280-4218-ba75-f79363f6e784" class="outline-6">
<h6 id="h:488ec2b6-d280-4218-ba75-f79363f6e784">甘特图</h6>
<div class="outline-text-6" id="text-h:488ec2b6-d280-4218-ba75-f79363f6e784">
<p>
我们在项目管理的时候，可以通过甘特图来展示项目的现状。
</p>

<div class="org-src-container">
<pre class="src src-text">#+BEGIN_SRC plantuml :file ./images/uml_20230115_151940.png :width 400 :exports both
@startgantt
!theme materia
scale 2

[Prototype design] lasts 15 days
[Test prototype] lasts 10 days

Project starts 2020-07-01
[Prototype design] starts 2020-07-01
[Test prototype] starts 2020-07-16

@endgantt
#+END_SRC
</pre>
</div>


<figure id="org77ddf5f">
<img src="./images/Snipaste_2023-07-04_22-45-17.png" alt="Snipaste_2023-07-04_22-45-17.png" width="60%">

</figure>
</div>
</div>
<div id="outline-container-h:0abdb679-2523-4768-8ca9-4f47b15714ee" class="outline-6">
<h6 id="h:0abdb679-2523-4768-8ca9-4f47b15714ee">思维脑图</h6>
<div class="outline-text-6" id="text-h:0abdb679-2523-4768-8ca9-4f47b15714ee">
<p>
思维脑图也是产品经理经常用到的工具，我们可以通过思维脑图来整理思路。
</p>

<div class="org-src-container">
<pre class="src src-text">#+BEGIN_SRC plantuml :file ./images/uml_20230115_170342.png :width 400 :exports both
@startmindmap
!theme materia
scale 2

+ Emacs&#25945;&#31243;
++ 1.Emacs&#21021;&#35782;
+++ Emacs&#23433;&#35013;&#21551;&#21160;
+++ Emacs&#37197;&#32622;&#25991;&#20214;
+++ Emacs&#37197;&#32622;&#25991;&#20214;
+++ Emacs&#22522;&#26412;&#24555;&#25463;&#38190;
++ 2.Org mode&#21021;&#35782;
+++ Org mode&#30340;&#35821;&#27861;
+++ Org mode&#30340;&#24555;&#25463;&#38190;@endmindmap
++ 3.&#36890;&#36807;Org mode&#26469;&#31649;&#29702;&#37197;&#32622;&#25991;&#20214;
+++ Org babel tangle
+++ tangle&#31532;&#19968;&#20010;&#37197;&#32622;&#25991;&#20214;early-init.el
++ 4.Emacs&#30340;&#21253;&#31649;&#29702;&#22120;
+++ package.el
+++ &#23433;&#35013;use-package&#25554;&#20214;
+++ &#23433;&#35013;quelpa&#25554;&#20214;

@endmindmap
#+END_SRC
</pre>
</div>


<figure id="org5c7d09e">
<img src="./images/Snipaste_2023-07-04_22-50-38.png" alt="Snipaste_2023-07-04_22-50-38.png" width="60%">

</figure>
</div>
</div>
<div id="outline-container-h:2ab8cb15-3443-4065-9b91-365c3db56bd9" class="outline-6">
<h6 id="h:2ab8cb15-3443-4065-9b91-365c3db56bd9">JSON结构</h6>
<div class="outline-text-6" id="text-h:2ab8cb15-3443-4065-9b91-365c3db56bd9">
<p>
我们还可以通过 plantuml 来展示JSON结构：
</p>

<div class="org-src-container">
<pre class="src src-text">#+BEGIN_SRC plantuml :file ./images/uml_20230115_170915.png :width 600
@startjson
!theme materia
scale 2

{
  "firstName": "John",
  "lastName": "Smith",
  "isAlive": true,
  "age": 27,
  "address": {
    "streetAddress": "21 2nd Street",
    "city": "New York",
    "state": "NY",
    "postalCode": "10021-3100"
  },
  "phoneNumbers": [
    {
      "type": "home",
      "number": "212 555-1234"
    },
    {
      "type": "office",
      "number": "646 555-4567"
    }
  ],
  "children": [],
  "spouse": null
}
@endjson
#+END_SRC
</pre>
</div>


<figure id="orgcf026ec">
<img src="./images/Snipaste_2023-07-04_23-08-42.png" alt="Snipaste_2023-07-04_23-08-42.png" width="60%">

</figure>
</div>
</div>
<div id="outline-container-h:bf7ad5ab-ffde-4047-8d23-3b7c9eb22817" class="outline-6">
<h6 id="h:bf7ad5ab-ffde-4047-8d23-3b7c9eb22817">简单的原型</h6>
<div class="outline-text-6" id="text-h:bf7ad5ab-ffde-4047-8d23-3b7c9eb22817">
<p>
我们甚至可以通过 plantuml 来实现一些简单的原型图：
</p>

<div class="org-src-container">
<pre class="src src-text">#+BEGIN_SRC plantuml :file ./images/uml_20230115_171130.png :width 400 :exports both
@startsalt
!theme materia
scale 2

{
        Just plain text
        [This is my button]
        () Unchecked radio
        (X) Checked radio
        [] Uncheck box
        [X] Checked box
        "Enter text here    "
        ^This is a droplist^
}
@endsalt
#+END_SRC
</pre>
</div>


<figure id="orgc5e2558">
<img src="./images/Snipaste_2023-07-04_23-09-59.png" alt="Snipaste_2023-07-04_23-09-59.png" width="60%">

</figure>
</div>
</div>
</div>
<div id="outline-container-h:61c8febf-559a-4c2f-89fd-cf27210e150b" class="outline-5">
<h5 id="h:61c8febf-559a-4c2f-89fd-cf27210e150b">gnuplot绘图</h5>
<div class="outline-text-5" id="text-h:61c8febf-559a-4c2f-89fd-cf27210e150b">
<p>
我们还可以使用 <a href="http://www.gnuplot.info/">gnuplot</a> 来画一些数学相关的图
</p>

<ul class="org-ul">
<li>先通过 <code>brew install gnuplot</code> 安装 gnuplot</li>
<li>安装配置 Emacs 的 <a href="https://github.com/emacs-gnuplot/gnuplot">gnuplot</a> 插件</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> gnuplot
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:mode</span> (<span style="color: #8b2252;">"\\.gp$"</span> . gnuplot-mode)
  <span style="color: #483d8b;">:init</span>
  (add-to-list 'org-src-lang-modes '(<span style="color: #8b2252;">"gnuplot"</span> . gnuplot))
  (org-babel-do-load-languages 'org-babel-load-languages
                               (append org-babel-load-languages
                                       '((gnuplot . t))))
  <span style="color: #483d8b;">:config</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'auto-mode-alist '("\\.gp$" . gnuplot-mode))</span>
  (<span style="color: #a020f0;">setq</span> org-babel-default-header-args:gnuplot
      '((<span style="color: #483d8b;">:exports</span> . <span style="color: #8b2252;">"results"</span>)
        (<span style="color: #483d8b;">:results</span> . <span style="color: #8b2252;">"file"</span>)))
  )
</pre>
</div>

<p>
我们安装完 gnuplot 后，可以通过它来画图：
</p>

<div class="org-src-container">
<pre class="src src-text">#+BEGIN_SRC gnuplot :file ./images/gnuplot_20230115_173519.png :width 400
f(x) = x**2
plot f(x)
#+END_SRC
</pre>
</div>


<figure id="orgc44936f">
<img src="./images/Snipaste_2023-07-04_23-12-55.png" alt="Snipaste_2023-07-04_23-12-55.png" width="60%">

</figure>
</div>
</div>
<div id="outline-container-h:e7eae0f3-b329-4a74-94ea-936967f0968c" class="outline-5">
<h5 id="h:e7eae0f3-b329-4a74-94ea-936967f0968c">Lilypond乐谱绘图</h5>
<div class="outline-text-5" id="text-h:e7eae0f3-b329-4a74-94ea-936967f0968c">
<ul class="org-ul">
<li>提前安装 lilypond 和 mactex-no-gui</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">brew install lilypond
brew install mactex-no-gui
</pre>
</div>

<p>
emacs 配置
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> lilypond-mode
  <span style="color: #483d8b;">:ensure</span> nil
  <span style="color: #483d8b;">:mode</span> (<span style="color: #8b2252;">"\\.i?ly\\'"</span> . LilyPond-mode)
  <span style="color: #483d8b;">:init</span>
  (add-to-list 'org-src-lang-modes '(<span style="color: #8b2252;">"lilypond"</span> . lilypond))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">add support for org babel</span>
  (org-babel-do-load-languages 'org-babel-load-languages
                               (append org-babel-load-languages
                                       '((lilypond . t))))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">set lilypond binary directory</span>
  (<span style="color: #a020f0;">setq</span> org-babel-lilypond-ly-command <span style="color: #8b2252;">"/usr/local/bin/lilypond -dpreview"</span>)
  <span style="color: #483d8b;">:config</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">trim extra space for generated image</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my/trim-lilypond-png</span> (orig-fun
                               <span style="color: #228b22;">&amp;optional</span> arg
                               info
                               param)
    (<span style="color: #a020f0;">when</span> (member (car (org-babel-get-src-block-info)) '(<span style="color: #8b2252;">"lilypond"</span>))
      (<span style="color: #a020f0;">let</span> ((ly-file (alist-get <span style="color: #483d8b;">:file</span> (nth 2 (org-babel-get-src-block-info)))))
        (<span style="color: #a020f0;">let</span> ((ly-preview-file (replace-regexp-in-string <span style="color: #8b2252;">"\\.png"</span> <span style="color: #8b2252;">".preview.png"</span> ly-file)))
          (<span style="color: #a020f0;">when</span> (file-exists-p ly-preview-file)
            (shell-command (concat <span style="color: #8b2252;">"mv "</span> ly-preview-file <span style="color: #8b2252;">" "</span> ly-file)))
          (org-redisplay-inline-images)))))
  (advice-add 'org-babel-execute-src-block <span style="color: #483d8b;">:after</span> #'my/trim-lilypond-png)
  (<span style="color: #a020f0;">setq</span> ob-lilypond-header-args
        '((<span style="color: #483d8b;">:results</span> . <span style="color: #8b2252;">"file replace"</span>)
          (<span style="color: #483d8b;">:exports</span> . <span style="color: #8b2252;">"results"</span>)
          ))
  )
</pre>
</div>

<p>
配置完 lilypond-mode 后，我们就可以通过 lilypond 代码块记录乐谱啦：
</p>

<div class="org-src-container">
<pre class="src src-text">\relative

\new Staff
{
  \clef treble
  \key c \major
  \time 4/4

  \override Lyrics.LyricSpace #'minimum-distance = #1.0

  c'4 c g' g
  a a g2
  f4 f e e
  d d c2
  g4' g f f
  e e d2
  g4 g f f
  e e d2
  c4 c g' g
  a a g2
  f4 f e e
  d d c2

  \bar "|."
}

% \addlyrics {
%   Twin -- kle, twin -- kle, lit -- tle star, how I won -- der what you are!
%   Up a -- bove the sky so high, like a dia -- mond in the sky.
%   Twin -- kle, twin -- kle, lit -- tle star, how I won -- der what you are!
% }

\addlyrics {
  &#19968; &#38378; &#19968; &#38378; &#20142; &#26230; &#26230;&#65292; &#28385; &#22825; &#37117; &#26159; &#23567; &#26143; &#26143;&#12290;
  &#25346; &#22312; &#22825; &#19978; &#25918; &#20809; &#26126;&#65292; &#22909; &#20687; &#35768; &#22810; &#23567; &#30524; &#30555;&#12290;
  &#19968; &#38378; &#19968; &#38378; &#20142; &#26230; &#26230;&#65292; &#28385; &#22825; &#37117; &#26159; &#23567; &#26143; &#26143;&#12290;
}
</pre>
</div>


<figure id="org1b19936">
<img src="./images/Snipaste_2023-07-05_06-56-38.png" alt="Snipaste_2023-07-05_06-56-38.png" width="60%">

</figure>
</div>
</div>
</div>
</div>
</section>
<section id="outline-container-h:49a632ed-9440-4965-9019-b152464b2e3e" class="outline-2">
<h2 id="h:49a632ed-9440-4965-9019-b152464b2e3e">附录-Emacs Lisp Intro</h2>
<div class="outline-text-2" id="text-h:49a632ed-9440-4965-9019-b152464b2e3e">
<p>
`C-h i`或`M-x info`到info界面，Elisp包含所有语言的细节，Emacs Lisp Intro是elisp的简介。了解emacs是如何工作的。
</p>

<p>
官方html：<a href="https://www.gnu.org/software/emacs/manual/eintr.html">https://www.gnu.org/software/emacs/manual/eintr.html</a>
</p>

<p>
elisp专业入门：<a href="http://smacs.github.io/">http://smacs.github.io/</a>
</p>

<p>
阅读操作
</p>

<div class="org-src-container">
<pre class="src src-shell">n/p &#19979;&#19968;&#39029;/&#19978;&#19968;&#39029;
&#31354;&#26684; &#32763;&#39029;
</pre>
</div>
</div>
<div id="outline-container-h:5271f2ed-8270-4180-9537-2daedace7f8f" class="outline-3">
<h3 id="h:5271f2ed-8270-4180-9537-2daedace7f8f">Preface</h3>
<div class="outline-text-3" id="text-h:5271f2ed-8270-4180-9537-2daedace7f8f">
<p>
<b><b>why</b></b>
</p>

<p>
为什么要学习 Emacs Lisp
</p>

<p>
这篇 Emacs Lisp 简介旨在帮助您入门：指导您学习编程的基础知识，更重要的是，向您展示如何自学以走得更远。
</p>

<p>
<b><b>On Reading this Text</b></b>
</p>

<p>
怎么阅读？
</p>

<p>
建议在emacs中阅读。可以分屏操作演示。
</p>

<p>
<b><b>For Whom This is Written</b></b>
</p>

<p>
这是为谁写的
</p>

<p>
非程序员。
</p>

<p>
<b><b>Lisp History</b></b>
</p>

<p>
Lisp历史
</p>

<p>
Lisp 最初于 1950 年代后期在麻省理工学院开发，用于人工智能研究。Lisp 语言的强大功能使其在其他用途上也更胜一筹，例如编写编辑器命令和集成环境。
</p>

<p>
GNU Emacs Lisp 很大程度上受到 Maclisp 的启发，Maclisp 于 1960 年代在麻省理工学院编写。它在某种程度上受到 Common Lisp 的启发，Common Lisp 在 1980 年代成为标准。但是，Emacs Lisp 比 Common Lisp 简单得多。（标准的 Emacs 发行版包含一个可选的扩展文件，el，这为 Emacs Lisp 添加了许多 Common Lisp 功能。）
</p>

<p>
<b><b>A Note for Novices</b></b>
</p>

<p>
新手注意事项
</p>

<p>
学习 Emacs在您的计算机屏幕上移动，可以使用`C-h t`
</p>

<ul class="org-ul">
<li>`C-`: C(trl)意思是按住 Ctrol 键</li>
<li>`M-`: M(eta)意指 Meta 键 (在 Mac 下为 Option 键， win下为alt键)</li>
<li>`C-u`，这称为通用参数。通过参数传递给随后的命令</li>
</ul>
</div>
</div>
<div id="outline-container-h:29f9378f-7a79-4f81-a6a2-6c42e58c380e" class="outline-3">
<h3 id="h:29f9378f-7a79-4f81-a6a2-6c42e58c380e">List Processing</h3>
<div class="outline-text-3" id="text-h:29f9378f-7a79-4f81-a6a2-6c42e58c380e">
<p>
Lisp 代表 LISt Processing，编程语言通过将*列表*（和列表的列表）放在括号之间来处理*列表*。括号标记列表的边界。有时一个列表前面有一个撇号 `'`，在 Lisp 中称为*单引号*。列表是 Lisp 的基础。
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">------------------------------------------------------------</td>
<td class="org-left">----</td>
<td class="org-left">-------------------------------------</td>
</tr>

<tr>
<td class="org-left">• <a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Lisp-Lists.html">Lisp 列表</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">什么是列表？</td>
</tr>

<tr>
<td class="org-left">•<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Run-a-Program.html">运行程序</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Lisp 中的任何列表都是准备运行的程序。</td>
</tr>

<tr>
<td class="org-left">•<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Making-Errors.html">犯错</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">生成错误消息。</td>
</tr>

<tr>
<td class="org-left">•<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Names-_0026-Definitions.html">名称和定义</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">符号名称和函数定义。</td>
</tr>

<tr>
<td class="org-left">• <a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Lisp-Interpreter.html">Lisp 解释器</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Lisp 解释器的作用。</td>
</tr>

<tr>
<td class="org-left">•<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Evaluation.html">评估</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">运行一个程序。</td>
</tr>

<tr>
<td class="org-left">•<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Variables.html">变量</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">从变量返回一个值。</td>
</tr>

<tr>
<td class="org-left">•<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Arguments.html">参数</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">将信息传递给函数。</td>
</tr>

<tr>
<td class="org-left">•<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/set-_0026-setq.html">设置和设置</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">设置变量的值。</td>
</tr>

<tr>
<td class="org-left">•<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Summary.html">总结</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">要点。</td>
</tr>

<tr>
<td class="org-left">•<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Error-Message-Exercises.html">错误消息练习</a></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-h:aabf0d5e-fc9b-460b-b7cb-e1934258df85" class="outline-4">
<h4 id="h:aabf0d5e-fc9b-460b-b7cb-e1934258df85">Lisp Lists</h4>
<div class="outline-text-4" id="text-h:aabf0d5e-fc9b-460b-b7cb-e1934258df85">
<p>
什么是列表
</p>

<p>
在Lisp中，列表如下：`'(rose violet daisy buttercup)`。此列表前面有一个撇号。它也可以写成如下，它看起来更像你可能熟悉的那种列表：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">'(rose
  violet
  daisy
  buttercup)
</pre>
</div>

<p>
这个列表的元素是四种不同花的名称，用空格隔开并用括号包围，就像田野里的花，周围有石墙。
</p>

<p>
单引号代表取值的意思。
</p>

<p>
区别：
</p>

<ul class="org-ul">
<li>列表前面有单引号，列表里的值是纯赋值过程不做任何处理。</li>
<li>列表前面没单引号，列表里一个被当作函数后面为参数。</li>
</ul>

<p>
<b><b>Numbers, Lists inside of Lists</b></b>
</p>

<p>
列表中的数字、列表
</p>

<p>
在 Lisp 中，数据和程序的表示方式相同；也就是说，它们都是单词、数字或其他列表的列表，用空格分隔并用括号括起来。（因为一个程序看起来像数据，一个程序可以很容易地作为另一个程序的数据；这是 Lisp 的一个非常强大的特性。）（顺便说一句，这两个括号注释**不是**Lisp 列表，因为它们包含 ';' 和 '.' 作为标点符号。）
</p>

<p>
列表里可以包含列表
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">'(this list has (a list inside of it))
</pre>
</div>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">'(1 2 3 4)  <span style="color: #b22222;">;</span><span style="color: #b22222;">(1 2 3 4) &#19981;&#20570;&#20219;&#20309;&#22788;&#29702;</span>
(+ 2 2)     <span style="color: #b22222;">;</span><span style="color: #b22222;">4 &#12290;+&#20026;&#20989;&#25968;&#65292;&#21518;&#38754;2&#20010;2&#20026;&#21442;&#25968;</span>
(this is (another list) (another list again)) <span style="color: #b22222;">;</span><span style="color: #b22222;">&#21015;&#34920;&#37324;&#21487;&#21253;&#21547;&#22810;&#20010;&#21015;&#34920;</span>
</pre>
</div>

<p>
<b><b>Lisp Atoms</b></b>
</p>

<p>
在 Lisp 中，我们一直称之为词的东西被称为*原子*。这个术语来自原子这个词的历史意义，意思是“不可分割的”。
</p>

<p>
就 Lisp 而言，我们在列表中使用的单词不能被分成任何更小的部分，并且仍然与程序的一部分具有相同的含义；同样的数字和单字符符号，如 '+'。另一方面，与古老的原子不同，列表可以拆分为多个部分。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">'(this list includes <span style="color: #8b2252;">"text between quotation marks."</span>)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22312;&#21015;&#34920;&#20013;&#65292;&#21407;&#23376;&#24444;&#27492;&#20043;&#38388;&#34987;&#31354;&#26684;&#38548;&#24320;&#12290;&#23427;&#20204;&#21487;&#20197;&#32039;&#25384;&#30528;&#19968;&#20010;&#25324;&#21495;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20687;this&#23601;&#26159;&#26368;&#23567;&#30340;&#21333;&#20301;&#20102;&#65292;&#19981;&#33021;&#20877;&#20998;&#21106;&#20102;</span>
</pre>
</div>

<p>
<b><b>Whitespace in Lists</b></b>
</p>

<p>
列表中的空白
</p>

<p>
列表中的空白数量无关紧要，空格、回车、TAB等都可以，只要能被识别出来。从 Lisp 语言的角度来看，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">'(this list
   looks like this)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#31561;&#20215;</span>
'(this list looks like this)
</pre>
</div>

<p>
<b><b>GNU Emacs Helps You Type Lists</b></b>
</p>

<p>
emacs帮助你输入列表
</p>

<p>
可以自动缩进
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> 2 3
      b)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:b42e91ae-e744-465d-9686-f26ae2138742" class="outline-4">
<h4 id="h:b42e91ae-e744-465d-9686-f26ae2138742">Run a Program</h4>
<div class="outline-text-4" id="text-h:b42e91ae-e744-465d-9686-f26ae2138742">
<p>
Lisp 中的任何列表都是准备运行的程序
</p>

<p>
将光标放在以下列表的右侧括号之后，然后键入`C-x C-e`
</p>
</div>
</div>
<div id="outline-container-h:ad809028-01ea-405d-b001-4b9b03b0f58f" class="outline-4">
<h4 id="h:ad809028-01ea-405d-b001-4b9b03b0f58f">Generate an Error Message</h4>
<div class="outline-text-4" id="text-h:ad809028-01ea-405d-b001-4b9b03b0f58f">
<p>
生成错误信息
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(this is an unquoted list) <span style="color: #b22222;">;; </span><span style="color: #b22222;">this&#19981;&#26159;&#19968;&#20010;&#20989;&#25968;&#65292;&#25191;&#34892;&#20250;&#22312;*Backtrace*&#31383;&#21475;&#20013;&#25253;&#38169;&#12290;&#25353;q&#36864;&#20986;&#25253;&#38169;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:97ce27cd-c7a0-40b4-b62e-a318cde1a47c" class="outline-4">
<h4 id="h:97ce27cd-c7a0-40b4-b62e-a318cde1a47c">Symbol Names and Function Definitions</h4>
<div class="outline-text-4" id="text-h:97ce27cd-c7a0-40b4-b62e-a318cde1a47c">
<p>
符号名称和函数定义
</p>

<p>
符号代表一些方法
</p>

<div class="org-src-container">
<pre class="src src-shell">&#31526;&#21495;+ &#20195;&#34920;plus
</pre>
</div>
</div>
</div>
<div id="outline-container-h:386a16af-0a03-4cb2-bb18-895ab109d091" class="outline-4">
<h4 id="h:386a16af-0a03-4cb2-bb18-895ab109d091">The Lisp Interpreter</h4>
<div class="outline-text-4" id="text-h:386a16af-0a03-4cb2-bb18-895ab109d091">
<p>
Lisp 解释器
</p>

<div class="org-src-container">
<pre class="src src-shell">1.&#26597;&#30475;&#21015;&#34920;&#21069;&#26159;&#21542;&#26377;&#21333;&#24341;&#29992;&#65307;
&#22914;&#26524;&#26377;&#65292;&#21482;&#32473;&#28165;&#21333;&#12290;
&#22914;&#26524;&#27809;&#26377;&#24341;&#29992;&#65292;&#24403;&#25104;&#20989;&#25968;&#30475;&#65292;&#35299;&#37322;&#22120;&#20250;&#26597;&#30475;&#21015;&#34920;&#20013;&#30340;&#31532;&#19968;&#20010;&#20803;&#32032;&#24182;&#26597;&#30475;&#23427;&#26159;&#21542;&#26377;&#20989;&#25968;&#23450;&#20041;&#12290;&#22914;&#26524;&#26159;&#65292;&#35299;&#37322;&#22120;&#25191;&#34892;&#20989;&#25968;&#23450;&#20041;&#20013;&#30340;&#25351;&#20196;&#12290;&#21542;&#21017;&#65292;&#35299;&#37322;&#22120;&#20250;&#25171;&#21360;&#19968;&#26465;&#38169;&#35823;&#28040;&#24687;&#12290;
</pre>
</div>

<p>
<b><b>Byte Compiling</b></b>
</p>

<p>
字节编译
</p>

<p>
Lisp 解释器能够解释两种实体：人类可读的代码，我们将专门关注它，以及经过特殊处理的代码，称为*字节编译*代码，它不是人类可读的。字节编译的代码比人类可读的代码运行得更快。
</p>

<p>
您可以通过运行其中一个编译命令（例如`byte-compile-file`. 字节编译的代码通常存储在一个以 .elc 扩展名而不是 .el延期。您将在emacs/lisp目录; 要读取的文件是那些.el 扩展名。
</p>

<p>
实际上，对于您可能为定制或扩展 Emacs 所做的大多数事情，您不需要字节编译；
</p>
</div>
</div>
<div id="outline-container-h:f4cc5af3-b945-4b17-8960-345f14323f7f" class="outline-4">
<h4 id="h:f4cc5af3-b945-4b17-8960-345f14323f7f">Evaluation</h4>
<div class="outline-text-4" id="text-h:f4cc5af3-b945-4b17-8960-345f14323f7f">
<p>
当 Lisp 解释器处理一个表达式时，该活动的术语称为*评估*。我们说解释器“评估表达式”。
</p>

<p>
<b><b>Evaluating Inner Lists</b></b>
</p>

<p>
列表中的列表
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(+ 2 (+ 3 3)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">8  &#20808;&#25191;&#34892;&#37324;&#38754;&#25324;&#21495;&#30340;</span>
</pre>
</div>

<p>
`C-x C-e`触发名称`eval-last-sexp`的操作
</p>
</div>
</div>
<div id="outline-container-h:db594656-28b0-41f9-8883-c3c7df407bf9" class="outline-4">
<h4 id="h:db594656-28b0-41f9-8883-c3c7df407bf9">Variables</h4>
<div class="outline-text-4" id="text-h:db594656-28b0-41f9-8883-c3c7df407bf9">
<p>
变量
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">fill-column <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20869;&#32622;&#21464;&#37327;&#65292;&#19968;&#34892;&#30340;&#34892;&#23485;</span>
</pre>
</div>

<p>
`C-x C-e`执行
</p>

<p>
<b><b>没有函数的符号的错误信息</b></b>
</p>

<p>
如果把变量当作函数执行就会报错。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(fill-column)
</pre>
</div>

<p>
<b><b>无值符号的错误信息</b></b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(+ 2 2)
</pre>
</div>

<p>
在 GNU Emacs 22 中，`+`没有被定义就会报错
</p>
</div>
</div>
<div id="outline-container-h:6404a22c-d5de-4753-9a0e-c87113e5b56c" class="outline-4">
<h4 id="h:6404a22c-d5de-4753-9a0e-c87113e5b56c">Arguments</h4>
<div class="outline-text-4" id="text-h:6404a22c-d5de-4753-9a0e-c87113e5b56c">
<p>
参数
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(+ 2 2) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25968;&#25454;&#20026;&#20989;&#25968; + &#30340;&#21442;&#25968;</span>
</pre>
</div>

<p>
<b><b>参数的数据类型</b></b>
</p>

<p>
应该传递给函数的数据类型取决于它使用的信息类型。诸如此类的函数`+`的参数 必须具有数字值，因为`+`将数字相加。其他函数使用不同类型的数据作为参数。
</p>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(concat <span style="color: #8b2252;">"abc"</span> <span style="color: #8b2252;">"def"</span>)
(substring <span style="color: #8b2252;">"The quick brown fox jumped."</span> 16 19)
</pre>
</div>

<p>
<b><b>作为变量或列表值的参数</b></b>
</p>

<p>
参数可以是在计算时返回值的符号。例如，当符号`fill-column`本身被执行时，它返回一个数字
</p>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(+ 2 fill-column)
(concat <span style="color: #8b2252;">"The "</span> (number-to-string (+ 2 fill-column)) <span style="color: #8b2252;">" red foxes."</span>)
</pre>
</div>

<p>
<b><b>可变长参数</b></b>
</p>

<p>
函数接受参数的数量。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(+) &#8658; 0
(*) &#8658; 1

(+ 3) &#8658; 3
(* 3) &#8658; 3

(+ 3 4 5) &#8658; 12
(* 3 4 5) &#8658; 60
</pre>
</div>

<p>
<b><b>使用错误的类型对象作为参数</b></b>
</p>

<p>
使用错误的类型对象作为参数会触发错误
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(+ 2 'hello) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25968;&#23383;&#21644;&#23383;&#31526;&#20018;&#26159;&#19981;&#33021;&#30456;&#21152;&#30340;</span>
</pre>
</div>

<p>
报错信息
</p>
<div class="org-src-container">
<pre class="src src-shell">---------- Buffer: *Backtrace* ----------
Debugger entered--Lisp error:
         (wrong-type-argument number-or-marker-p hello)
  +(2 hello)
  <span style="color: #483d8b;">eval</span>((+ 2 <span style="color: #8b2252;">'hello) nil)</span>
<span style="color: #8b2252;">  elisp--eval-last-sexp(t)</span>
<span style="color: #8b2252;">  eval-last-sexp(nil)</span>
<span style="color: #8b2252;">  funcall-interactively(eval-print-last-sexp nil)</span>
<span style="color: #8b2252;">  call-interactively(eval-print-last-sexp nil nil)</span>
<span style="color: #8b2252;">  command-execute(eval-print-last-sexp)</span>
<span style="color: #8b2252;">---------- Buffer: *Backtrace* ----------</span>

</pre>
</div>

<p>
<b><b>message函数</b></b>
</p>

<p>
它用于向用户发送消息，显示最后一条。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(message <span style="color: #8b2252;">"This message appears in the echo area!"</span>)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26684;&#24335;&#21270;</span>
(message <span style="color: #8b2252;">"There are %d %s in the office!"</span>
         (- fill-column 14) <span style="color: #8b2252;">"pink elephants"</span>)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22797;&#26434;&#30340;</span>
(message <span style="color: #8b2252;">"He saw %d %s"</span>
         (- fill-column 32)
         (concat <span style="color: #8b2252;">"red "</span>
                 (substring
                  <span style="color: #8b2252;">"The quick brown foxes jumped."</span> 16 21)
                 <span style="color: #8b2252;">" leaping."</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a366eb77-7d50-4342-a77b-343e89eba604" class="outline-4">
<h4 id="h:a366eb77-7d50-4342-a77b-343e89eba604">set &amp; setq</h4>
<div class="outline-text-4" id="text-h:a366eb77-7d50-4342-a77b-343e89eba604">
<p>
变量的赋值
</p>

<p>
一种方法是使用函数`set`或特殊形式 `setq`的全局变量。另一种方法是使用`let`局部变量
</p>

<p>
<b><b>使用 `set`</b></b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(set 'flowers '(rose violet daisy buttercup)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#32473;flowers&#36171;&#20540;&#12290;&#27880;&#24847;flowers&#21069;&#26377;&#20010;&#21333;&#24341;&#21495;</span>
</pre>
</div>

<p>
`'`引号代表`quote`
</p>

<p>
<b><b>使用 `setq`</b></b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> carnivores '(lion tiger leopard))  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21464;&#37327;&#21517;&#31216;&#21069;&#19981;&#38656;&#35201;&#21333;&#24341;&#21495;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">&#31561;&#20215;&#20110;</span>
(set 'carnivores '(lion tiger leopard))
</pre>
</div>

<p>
变量名称前不需要单引号。同时支持给多个变量赋值
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> trees '(pine fir oak maple)
      herbivores '(gazelle antelope zebra))
</pre>
</div>

<p>
<b><b>counting计数</b></b>
</p>

<p>
写一个计数器
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> counter 0)                <span style="color: #b22222;">; </span><span style="color: #b22222;">Let&#8217;s call this the initializer.</span>
(<span style="color: #a020f0;">setq</span> counter (+ counter 1))    <span style="color: #b22222;">; </span><span style="color: #b22222;">This is the incrementer.</span>
counter                         <span style="color: #b22222;">; </span><span style="color: #b22222;">This is the counter.</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:90137c13-00cf-41dd-85c8-5761e23a66c7" class="outline-3">
<h3 id="h:90137c13-00cf-41dd-85c8-5761e23a66c7">Practicing Evaluation</h3>
<div class="outline-text-3" id="text-h:90137c13-00cf-41dd-85c8-5761e23a66c7">
<p>
运行几个程序
</p>

<p>
<b><b>如何执行</b></b>
</p>

<div class="org-src-container">
<pre class="src src-shell">C-x C-e     ;; &#25191;&#34892;&#65292;&#22312;&#19979;&#26041;&#20132;&#20114;&#21306;&#22495;&#26174;&#31034;
C-u C-x C-e ;; &#21407;&#22320;&#25191;&#34892;
</pre>
</div>

<p>
<b><b>Buffer Names</b></b>
</p>

<div class="org-src-container">
<pre class="src src-shell">(buffer-name)      ;; &#33719;&#21462;buffer&#21517;&#31216;&#12290; &#25191;&#34892; C-u C-x C-e &#26174;&#31034; <span style="color: #8b2252;">"*scratch*"</span>
(buffer-file-name) ;; &#33719;&#21462;buffer&#20195;&#34920;&#25991;&#20214;&#30340;&#21517;&#31216;
</pre>
</div>

<p>
<b><b>Getting Buffers</b></b>
</p>

<div class="org-src-container">
<pre class="src src-shell">(current-buffer)   ;; &#36820;&#22238;buffer&#26412;&#36523;&#65292;&#24403;&#21069;buffer&#12290;&#22914;&#25191;&#34892; C-u C-x C-e &#26174;&#31034; <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;buffer *scratch*&gt;</span>
(other-buffer)     ;; &#36820;&#22238;buffer&#26412;&#36523;&#65292;&#30456;&#24403;&#21069;buffer&#26368;&#36817;&#20351;&#29992;&#30340;buffer &#65292; &#24555;&#25463;&#38190;C-x o
</pre>
</div>

<p>
范例
</p>

<div class="org-src-container">
<pre class="src src-shell">other-buffer&#20351;&#29992;&#24110;&#21161;C-h f&#65306;
(other-buffer &amp;optional BUFFER VISIBLE-OK FRAME)
&#35828;&#26126;&#65306;
optional&#65306;&#20195;&#34920;&#21518;&#38754;&#21442;&#25968;&#37117;&#26159;&#21487;&#36873;&#30340;
BUFFER: buffer&#26412;&#36523;
VISIBLE-OK: &#26159;&#21542;&#21487;&#23637;&#31034;
FRAME: &#25351;&#23450;&#19968;&#20010;&#23454;&#26102;&#24103;&#65292;&#28982;&#21518;&#20351;&#29992;&#35813;&#24103;&#30340;&#32531;&#20914;&#21306;&#21015;&#34920;&#20195;&#26367;&#25152;&#36873;&#24103;&#30340;&#32531;&#20914;&#21306;&#21015;&#34920;
</pre>
</div>

<p>
<b><b>Switching Buffers</b></b>
</p>

<div class="org-src-container">
<pre class="src src-shell">(switch-to-buffer (other-buffer)) ;; &#20999;&#25442;&#21040;&#19978;&#19968;&#20010;buffer
(switch-to-buffer (other-buffer (current-buffer) t)) ;; &#20999;&#25442;&#21040;&#19978;&#19968;&#20010;buffer
</pre>
</div>

<p>
<b><b>缓冲区大小和光标的位置</b></b>
</p>

<div class="org-src-container">
<pre class="src src-shell">(buffer-size)  ;; &#33719;&#21462;&#24403;&#21069;buffer&#30340;&#22823;&#23567;
(point)        ;; &#20809;&#26631;&#25152;&#22312;&#20301;&#32622;&#65292;&#25968;&#23383;
(point-min)    ;; &#20809;&#26631;&#26368;&#24320;&#22987;&#30340;&#20301;&#32622;
(point-max)    ;; &#20809;&#26631;&#26368;&#21518;&#30340;&#20301;&#32622;
</pre>
</div>

<p>
注意：buffer可以隐藏部分字符
</p>

<ul class="org-ul">
<li>`M-x narrow-to-region` 或`C-x n n`   缩小区域</li>
<li>`M-x widen` 或`C-x n w` 恢复</li>
<li>`M-x count-words` 统计总字符大小，包含回车</li>
</ul>
</div>
</div>
<div id="outline-container-h:c11e43fe-6e15-42e0-b305-d72c6563bbf0" class="outline-3">
<h3 id="h:c11e43fe-6e15-42e0-b305-d72c6563bbf0">Writing Defuns</h3>
<div class="outline-text-3" id="text-h:c11e43fe-6e15-42e0-b305-d72c6563bbf0">
<p>
如何编写函数定义。
</p>

<p>
<b><b>关于原始函数的旁白</b></b>
</p>

<p>
函数分为2个语言实现：c和elisp。没有必要区分函数由什么实现。
</p>
</div>
<div id="outline-container-h:3ccde56c-788c-4a93-928d-49cfbbec02ec" class="outline-4">
<h4 id="h:3ccde56c-788c-4a93-928d-49cfbbec02ec"><b><b>如何定义函数</b></b></h4>
<div class="outline-text-4" id="text-h:3ccde56c-788c-4a93-928d-49cfbbec02ec">
<p>
早期`defun`是个函数，现在是个宏。
</p>

<p>
函数定义在单词之后最多有五个部分 `defun`：
</p>

<ol class="org-ol">
<li>函数定义应附加到的符号的名称。</li>
<li>将传递给函数的参数列表。如果没有参数将传递给函数，则这是一个空列表， `()`。</li>
<li>描述函数的文档。（技术上可选，但强烈推荐。）</li>
<li>可选地，一个使函数具有交互性的表达式，以便您可以通过键入M-x然后键入函数的名称来使用它；或通过键入适当的键或键和弦。</li>
<li>指示计算机做什么的代码：函数定义的*主体*</li>
</ol>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20989;&#25968;&#26368;&#22810;&#30001;5&#20010;&#37096;&#20998;&#32452;&#25104;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">function-name</span> (arguments&#8230;)
  <span style="color: #8b2252;">"optional-documentation&#8230;"</span>
  (<span style="color: #a020f0;">interactive</span> argument-passing-info)     <span style="color: #b22222;">; </span><span style="color: #b22222;">optional</span>
  body&#8230;)
&#35828;&#26126;&#65306;
1.&#20989;&#25968;&#21517;&#31216;&#12290;function-name
2.&#20989;&#25968;&#21442;&#25968;&#21015;&#34920;&#12290;&#21487;&#22810;&#20010;&#21442;&#25968;(arg1 arg2 <span style="color: #228b22;">&amp;optional&#21487;&#36873;</span> args <span style="color: #228b22;">&amp;rest&#20854;&#23427;</span> rests)&#12289;&#21487;&#20026;&#31354; ()
3.&#20989;&#25968;&#25991;&#26723;&#12290;&#21487;&#36873;&#12290;&#21033;&#29992;`<span style="color: #008b8b;">&#21629;&#20196;</span>' &#21487;&#21152;&#20837;&#20854;&#23427;&#25991;&#26723;&#36830;&#25509;
<span style="color: #8b2252;">" one </span>
<span style="color: #8b2252;">two two</span>
<span style="color: #8b2252;">`</span><span style="color: #008b8b;">help</span><span style="color: #8b2252;">' &#21487;&#28857;&#20987;&#36830;&#25509;"</span>
4.&#20132;&#20114;&#24335;&#34920;&#36798;&#24335;&#12290;&#21487;&#36873;
5.&#20989;&#25968;&#20307;&#12290;&#21487;&#36873;
</pre>
</div>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">func-name</span> ()
  <span style="color: #8b2252;">"Func name: this is a demo function</span>

<span style="color: #8b2252;">this this</span>
<span style="color: #8b2252;">`</span><span style="color: #008b8b;">help</span><span style="color: #8b2252;">'</span>
<span style="color: #8b2252;">`</span><span style="color: #008b8b;">buffer-size</span><span style="color: #8b2252;">' "</span> <span style="color: #b22222;">;; </span><span style="color: #b22222;">optional</span>
  (<span style="color: #a020f0;">interactive</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">optional</span>
  ...)
</pre>
</div>

<p>
<img src="./images/image-20210916003549727.png" alt="image-20210916003549727.png">]]
</p>
</div>
</div>
<div id="outline-container-h:30419e25-cfe4-4800-aa52-414257f4ca99" class="outline-4">
<h4 id="h:30419e25-cfe4-4800-aa52-414257f4ca99"><b><b>函数安装</b></b></h4>
<div class="outline-text-4" id="text-h:30419e25-cfe4-4800-aa52-414257f4ca99">
<p>
`C-x C-e`执行安装，之后就可以调用了
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">multiply-by-seven</span> (number)
  <span style="color: #8b2252;">"Multiply NUMBER by seven."</span>
  (* 7 number))  <span style="color: #b22222;">;; </span><span style="color: #b22222;">C-x C-e&#23433;&#35013;</span>
(multiply-by-seven 7)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35843;&#29992;</span>
</pre>
</div>

<p>
改变一个函数的定义，还需要执行`C-x C-e`安装更新
</p>
</div>
</div>
<div id="outline-container-h:2941cb28-b629-48fe-b858-fe9981ed4003" class="outline-4">
<h4 id="h:2941cb28-b629-48fe-b858-fe9981ed4003"><b><b>交互式函数interactive</b></b></h4>
<div class="outline-text-4" id="text-h:2941cb28-b629-48fe-b858-fe9981ed4003">
<p>
`interactive`在文档之后就可以了，通过`M-x`然后键入函数的名称来调用交互式 函数
</p>

<p>
交互表达式
</p>

<p>
#+end_src
(interactive &amp;optional ARG-DESCRIPTOR)
说明：
1.ARG-DESCRIPTOR： 表达式，可选
前缀：C-u 或 M-
p &#x2013; 前缀数字
c &#x2013; 字符
</p>

<p>
Code letters available are:
a &#x2013; Function name: symbol with a function definition.
b &#x2013; Name of existing buffer.
B &#x2013; Name of buffer, possibly nonexistent.
c &#x2013; Character (no input method is used).
C &#x2013; Command name: symbol with interactive function definition.
d &#x2013; Value of point as number.  Does not do I/O.
D &#x2013; Directory name.
e &#x2013; Parameterized event (i.e., one that's a list) that invoked this command.
     If used more than once, the Nth e returns the Nth parameterized event.
     This skips events that are integers or symbols.
f &#x2013; Existing file name.
F &#x2013; Possibly nonexistent file name.
G &#x2013; Possibly nonexistent file name, defaulting to just directory name.
i &#x2013; Ignored, i.e. always nil.  Does not do I/O.
k &#x2013; Key sequence (downcase the last event if needed to get a definition).
K &#x2013; Key sequence to be redefined (do not downcase the last event).
m &#x2013; Value of mark as number.  Does not do I/O.
M &#x2013; Any string.  Inherits the current input method.
n &#x2013; Number read using minibuffer.
N &#x2013; Numeric prefix arg, or if none, do like code n.
p &#x2013; Prefix arg converted to number.  Does not do I/O.
P &#x2013; Prefix arg in raw form.  Does not do I/O.
r &#x2013; Region: point and mark as 2 numeric args, smallest first.  Does no I/O.
s &#x2013; Any string.  Does not inherit the current input method.
S &#x2013; Any symbol.
U &#x2013; Mouse up event discarded by a previous k or K argument.
v &#x2013; Variable name: symbol that is custom-variable-p.
x &#x2013; Lisp expression read but not evaluated.
X &#x2013; Lisp expression read and evaluated.
z &#x2013; Coding system.
Z &#x2013; Coding system, nil if no prefix arg.
</p>


<p>
Demos
</p>
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"sName: \nbBuffer: \nP"</span>)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(list (read-string "Name: ")</span>
<span style="color: #b22222;">;;       </span><span style="color: #b22222;">(read-buffer "Buffer: ")</span>
<span style="color: #b22222;">;;       </span><span style="color: #b22222;">current-prefix-arg)</span>
</pre>
</div>
<p>
#+end_src
</p>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">multiply-by-seven</span> (number)       <span style="color: #b22222;">; </span><span style="color: #b22222;">Interactive version.</span>
  <span style="color: #8b2252;">"Multiply NUMBER by seven."</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"p"</span>)
  (message <span style="color: #8b2252;">"The result is %d"</span> (* 7 number)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35843;&#29992;&#20351;&#29992; C-u 3 M-x multiply-by-seven &#25110;  M-3 M-x multiply-by-seven</span>
</pre>
</div>

<p>
<b>*`interactive`不同的选项 *</b>
</p>

<ul class="org-ul">
<li>小p，告诉emacs将你正在键入的`C-u`的前缀数字或者`M-`加上前缀数字作为参数传给函数</li>
<li>B，告诉emacs使用缓冲区的名称作为函数的参数</li>
<li>r，光标所在的buffer的开始值，和结束值(两个数字)</li>
</ul>

<p>
基本格式：
</p>

<ul class="org-ul">
<li>不同的参数间使用`\n`隔开，被隔开的第一个字母代表选项</li>
<li>可以带有提示语句附加在选项后面(不需要使用空白字符隔开)</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">name-of-function</span> (arg char)
  <span style="color: #8b2252;">"documentation&#8230;"</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"p\ncZap to char: "</span>)
  body-of-function&#8230;)

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-func</span> (number char)
  <span style="color: #8b2252;">"..."</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"pNumber\nc&#36755;&#20837;&#19968;&#20010;&#23383;&#31526;"</span>)
  (message <span style="color: #8b2252;">"%d %c"</span> number char))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-func2</span> (buffer)
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"b&#35831;&#36873;&#25321;&#19968;&#20010;buffer"</span>)
  )
</pre>
</div>

<p>
<img src="./images/image-20210916071905754.png" alt="image-20210916071905754.png">]]
</p>
</div>
</div>
<div id="outline-container-h:f789fc67-40e1-4379-88c5-50726c14e1fe" class="outline-4">
<h4 id="h:f789fc67-40e1-4379-88c5-50726c14e1fe"><b><b>永久安装代码</b></b></h4>
<div class="outline-text-4" id="text-h:f789fc67-40e1-4379-88c5-50726c14e1fe">
<ul class="org-ul">
<li>定入到`.emacs`文件中(`init.el`)</li>
<li>写入到一个或多个文件中，通过`load`函数加载</li>
<li>写入到`site-init.el`中</li>
</ul>
</div>
</div>
<div id="outline-container-h:6c52e80f-c778-4e52-9574-99cd851865f8" class="outline-4">
<h4 id="h:6c52e80f-c778-4e52-9574-99cd851865f8"><b><b>let函数</b></b></h4>
<div class="outline-text-4" id="text-h:6c52e80f-c778-4e52-9574-99cd851865f8">
<ul class="org-ul">
<li>局部变量值绑定，由let绑定的值只在let表达式中可用</li>
<li>可以一次绑定多个值</li>
<li>`let*` 可以使用局部变量里的变量</li>
</ul>

<p>
格式
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">let</span> varlist body&#8230;)
(<span style="color: #a020f0;">let</span> ((variable value)
      (variable value)
      &#8230;)
  body&#8230;)
</pre>
</div>

<p>
范例：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">let</span> ((zebra <span style="color: #8b2252;">"stripes"</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23383;&#31526;&#20018;&#29992;&#21452;&#24341;&#21495;</span>
      (tiger <span style="color: #8b2252;">"fierce"</span>))
  (message <span style="color: #8b2252;">"One kind of animal has %s and another is %s."</span>  <span style="color: #b22222;">;; </span><span style="color: #b22222;">%s&#21487;&#20197;&#20195;&#34920;&#19968;&#20999;&#19996;&#35199;</span>
           zebra tiger))  <span style="color: #b22222;">;; </span><span style="color: #b22222;">"One kind of animal has stripes and another is fierce."</span>

(<span style="color: #a020f0;">let</span> ((birch 3)
      pine
      fir
      (oak 'some))    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23383;&#31526;&#20018;&#36171;&#20540;</span>
  (message
   <span style="color: #8b2252;">"Here are %d variables with %s, %s, and %s value."</span>
   birch pine fir oak)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">"Here are 3 variables with nil, nil, and some value."</span>

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">circle-area</span> (radix)
  (<span style="color: #a020f0;">let</span> ((pi 3.1415926)
        area)
    (<span style="color: #a020f0;">setq</span> area (* pi radix radix))
    (message <span style="color: #8b2252;">"&#30452;&#24452;&#20026; %.2f &#30340;&#22278;&#38754;&#31215;&#26159; %.2f"</span> radix area)))
(circle-area 3)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:d71d5f2a-e223-4b75-b5a5-32f45c00fc12" class="outline-4">
<h4 id="h:d71d5f2a-e223-4b75-b5a5-32f45c00fc12"><b><b>if判断</b></b></h4>
<div class="outline-text-4" id="text-h:d71d5f2a-e223-4b75-b5a5-32f45c00fc12">
<p>
#+end_src
(if condition
    then-p ;; 只能执行一种them语句
  else-p)  ;; else语句
#+end_src
</p>

<p>
注意：then行只能执行一条then语句，如果要执行多条，可以使用progn
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> (&gt; 5 4 )
    (message <span style="color: #8b2252;">"5"</span>)
  (message <span style="color: #8b2252;">"4"</span>)) <span style="color: #b22222;">;;</span><span style="color: #b22222;">"5"</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35821;&#21477;&#20013;&#21253;&#21547;&#22810;&#26465;&#29992;progn</span>
(<span style="color: #a020f0;">if</span> (&gt; 5 4 )
    (<span style="color: #a020f0;">progn</span>
      (message <span style="color: #8b2252;">"print result"</span>)
      (message <span style="color: #8b2252;">"5"</span>))
  (message <span style="color: #8b2252;">"4"</span>))
</pre>
</div>

<p>
比较
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> a <span style="color: #8b2252;">"hello"</span>)
(<span style="color: #a020f0;">setq</span> b <span style="color: #8b2252;">"hello"</span>)

<span style="color: #b22222;">;;</span><span style="color: #b22222;">equal&#27604;&#36739;&#19968;&#20999;&#21464;&#37327;&#30340;&#20540;&#26159;&#21542;&#30456;&#31561;</span>
(equal a b) <span style="color: #b22222;">;; </span><span style="color: #b22222;">t</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">eq&#27604;&#36739;&#19968;&#20999;&#21464;&#37327;&#30340;&#20540;&#26159;&#21542;&#30456;&#31561;&#65292;&#36824;&#27979;&#35797;&#25351;&#38024;&#25351;&#21521;&#22320;&#22336;&#26159;&#21542;&#30456;&#31561;</span>
(eq a b)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">nil</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">= &#25968;&#23383;&#27604;&#36739;</span>
(= 3 3.0) <span style="color: #b22222;">;;</span><span style="color: #b22222;">t</span>
(eql 1.0 1)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">nil  &#19981;&#20165;&#27979;&#35797;&#25968;&#23383;&#30340;&#20540;&#26159;&#21542;&#30456;&#31561;&#65292;&#36824;&#27979;&#35797;&#25968;&#23383;&#31867;&#22411;&#26159;&#21542;&#19968;&#33268;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a4f11428-9aa3-4f39-9c23-a5a83c0c7c63" class="outline-4">
<h4 id="h:a4f11428-9aa3-4f39-9c23-a5a83c0c7c63"><b><b>判断真和假</b></b></h4>
<div class="outline-text-4" id="text-h:a4f11428-9aa3-4f39-9c23-a5a83c0c7c63">
<ul class="org-ul">
<li>只要执行后的返回值不是nil，其结果就是真。即只有nil是false</li>

<li>空列表是假</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> 4
    'true
  'false) <span style="color: #b22222;">;;</span><span style="color: #b22222;">true</span>

(<span style="color: #a020f0;">if</span> nil
    'true
  'false) <span style="color: #b22222;">;;</span><span style="color: #b22222;">false </span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:7963ea63-0c2b-41f9-b054-bc01ba68631f" class="outline-4">
<h4 id="h:7963ea63-0c2b-41f9-b054-bc01ba68631f"><b><b>`save-excursion`函数</b></b></h4>
<div class="outline-text-4" id="text-h:7963ea63-0c2b-41f9-b054-bc01ba68631f">
<p>
`save-excursion`函数它保存光标的位置，执行函数体，然后如果点的位置发生变化，则将点恢复到以前的位置。使用场景，执行一些操作再跳转回原来位置。
</p>

<p>
标记光标位置：  `M-x set-mark-command`或`C-@`或`C-SPC 经常被输入法占用`
</p>

<p>
#+end_src
;; 函数体是一个或多个表达式，它们将被 Lisp 解释器按顺序计算。如果主体中有多个表达式，则最后一个的值将作为save-excursion函数的值返回
(save-excursion
  body…)
</p>

<p>
(save-excursion
  first-expression-in-body
  second-expression-in-body
  third-expression-in-body
   …
  last-expression-in-body)
</p>

<p>
;; 在 Emacs Lisp 代码中，save-excursion表达式经常出现在表达式的主体中let
(let varlist
  (save-excursion
    body…))
#+end_src
</p>

<p>
范例
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20445;&#23384;&#20809;&#26631;&#20301;&#32622;&#65292;&#25191;&#34892;&#20869;&#23481;&#24320;&#22987;&#25554;&#20837;hello&#65292;&#32467;&#23616;&#25554;&#20837;bye&#65292;&#26368;&#21518;&#22238;&#21040;&#20809;&#26631;&#20301;&#32622;</span>
(<span style="color: #a020f0;">save-excursion</span>
  (goto-char (point-min))
  (insert <span style="color: #8b2252;">"hello "</span>)
  (goto-char (point-max))
  (insert <span style="color: #8b2252;">"\nbye "</span>))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:1c88e549-ba80-4658-8618-57a40ac5d592" class="outline-3">
<h3 id="h:1c88e549-ba80-4658-8618-57a40ac5d592">Buffer Walk Through</h3>
<div class="outline-text-3" id="text-h:1c88e549-ba80-4658-8618-57a40ac5d592">
<p>
探索一些与缓冲区相关的功能。
</p>
</div>
<div id="outline-container-h:2f84ec1c-8795-4480-96f9-131fc3d3c114" class="outline-4">
<h4 id="h:2f84ec1c-8795-4480-96f9-131fc3d3c114">查找更多的信息</h4>
<div class="outline-text-4" id="text-h:2f84ec1c-8795-4480-96f9-131fc3d3c114">
<ul class="org-ul">
<li>获取函数说明 `C-h f`</li>

<li>获取变量说明 `C-h v`</li>
<li>获取更多说明 `C-h C-h`</li>
<li>函数定义跳转 `M-.`  再使用`M-,`跳回原来位置</li>
</ul>

<p>
如果是指向的是C语言的源代码，需要从官网下载源代码，添加src路径
</p>

<p>
<a href="http://gnu.mirrors.hoobly.com/emacs/">http://gnu.mirrors.hoobly.com/emacs/</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> find-function-C-source-directory <span style="color: #8b2252;">"~/emacs-27.2/src"</span>)
</pre>
</div>

<p>
包含Lisp代码的文件习惯上被称为`库`
</p>
</div>
</div>
<div id="outline-container-h:85d38f3f-df59-4e04-8fa0-c856ccd00c71" class="outline-4">
<h4 id="h:85d38f3f-df59-4e04-8fa0-c856ccd00c71">简化的beginning-of-buffer函数定义</h4>
<div class="outline-text-4" id="text-h:85d38f3f-df59-4e04-8fa0-c856ccd00c71">
<ul class="org-ul">
<li>`M-&lt;` 回到编辑区最开始位置 `beginning-of-buffer`</li>
<li>`M-&gt;` 去往编辑区最后的位置 `end-of-buffer`</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36339;&#36716;&#21040;buferr&#24320;&#22987;&#30340;&#20301;&#32622;</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">simplified-beginning-of-buffer</span> ()
  <span style="color: #8b2252;">"Move point to the beginning of the buffer;</span>
<span style="color: #8b2252;">leave mark at previous position."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (push-mark)  <span style="color: #b22222;">;;</span><span style="color: #b22222;">&#25226;&#24403;&#21069;&#30340;&#20809;&#26631;&#25918;&#21040;mark region&#20013;</span>
  (goto-char (point-min))) <span style="color: #b22222;">;;</span><span style="color: #b22222;">&#36339;&#36716;&#21040;&#26576;&#20010;&#23383;&#31526;</span>
</pre>
</div>

<p>
返回原来光标位置：`C-x C-x`
</p>

<p>
可以尝试写一个`simplified-end-of-buffer`
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">simplified-end-of-buffer</span> ()
  <span style="color: #8b2252;">"Move point to the end of the buffer;</span>
<span style="color: #8b2252;">leave mark at previous position."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (push-mark)
  (goto-char (point-max)))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:86e9ea5e-a031-4b19-9040-3783097e75ad" class="outline-4">
<h4 id="h:86e9ea5e-a031-4b19-9040-3783097e75ad">mark-whole-buffer函数定义</h4>
<div class="outline-text-4" id="text-h:86e9ea5e-a031-4b19-9040-3783097e75ad">
<p>
标记整个缓冲区 `C-x h`
</p>

<p>
emacs 22
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mark-whole-buffer</span> ()
  <span style="color: #8b2252;">"Put point at beginning and mark at end of buffer.</span>
<span style="color: #8b2252;">You probably should not use this function in Lisp programs;</span>
<span style="color: #8b2252;">it is usually a mistake for a Lisp function to use any subroutine</span>
<span style="color: #8b2252;">that uses or sets the mark."</span>
  (<span style="color: #a020f0;">interactive</span>)
  (push-mark (point))
  (push-mark (point-max) nil t)  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26368;&#21518;&#20301;&#32622;&#26631;&#35760;</span>
  (goto-char (point-min))  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36339;&#21040;&#24320;&#22987;&#30340;&#20301;&#32622;</span>
</pre>
</div>

<p>
emacs27中的定义 
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mark-whole-buffer</span> ()
  <span style="color: #8b2252;">"Put point at beginning and mark at end of buffer.</span>
<span style="color: #8b2252;">Also push mark at point before pushing mark at end of buffer.</span>
<span style="color: #8b2252;">If narrowing is in effect, uses only the accessible part of the buffer.</span>
<span style="color: #8b2252;">You probably should not use this function in Lisp programs;</span>
<span style="color: #8b2252;">it is usually a mistake for a Lisp function to use any subroutine</span>
<span style="color: #8b2252;">that uses or sets the mark."</span>
  (<span style="color: #a020f0;">declare</span> (interactive-only t)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20989;&#25968;&#21482;&#33021;&#29992;&#20110;&#20132;&#20114;&#24335;&#35843;&#29992;</span>
  (<span style="color: #a020f0;">interactive</span>)
  (push-ark)
  (push-mark (point-max) nil t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">This is really `</span><span style="color: #008b8b;">point-min</span><span style="color: #b22222;">' in most cases, but if we're in the</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">minibuffer, this is at the end of the prompt.</span>
  (goto-char (minibuffer-prompt-end)))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:6764a003-9c2a-42bd-b2ce-5ec533a5a3df" class="outline-4">
<h4 id="h:6764a003-9c2a-42bd-b2ce-5ec533a5a3df">append-to-buffer函数定义</h4>
<div class="outline-text-4" id="text-h:6764a003-9c2a-42bd-b2ce-5ec533a5a3df">
<p>
从当前缓冲区中拷贝一个域到指定的缓冲区
</p>

<p>
扩展几个函数
</p>

<ul class="org-ul">
<li><p>
`append-to-buffer` 把region内容附加到buffer中
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">append-to-buffer</span> (buffer start end)
   ...
)
</pre>
</div></li>

<li><p>
`get-buffer-create`若缓冲区存在，返回缓冲区；若缓冲区不存在，新建一个缓冲区
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(get-buffer-create buffer)
</pre>
</div></li>

<li><p>
`insert-buffer-substring`向缓冲区中插入子字符串
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(insert-buffer-substring buffer start end)
</pre>
</div></li>

<li>`set-buffer`在代码中切换buffer往往不使用`switch-to-buffer`而使用`set-buffer`</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:0c49d31a-04be-49c5-8e49-3620afb04e4e" class="outline-3">
<h3 id="h:0c49d31a-04be-49c5-8e49-3620afb04e4e">More Complex</h3>
<div class="outline-text-3" id="text-h:0c49d31a-04be-49c5-8e49-3620afb04e4e">
<p>
一些，甚至更复杂的功能
</p>
</div>
<div id="outline-container-h:d84c84fd-137a-4717-b8f8-4a680ffad587" class="outline-4">
<h4 id="h:d84c84fd-137a-4717-b8f8-4a680ffad587">copy-to-buffer 函数定义</h4>
<div class="outline-text-4" id="text-h:d84c84fd-137a-4717-b8f8-4a680ffad587">
<p>
该函数与`append-to-buffer`的区别在于，该函数会覆盖原有缓冲区的内容。因为它使用了`erase-buffer`函数
</p>
</div>
</div>
<div id="outline-container-h:4b41f977-3a86-4d7e-bb9c-1a58c0342fb2" class="outline-4">
<h4 id="h:4b41f977-3a86-4d7e-bb9c-1a58c0342fb2">insert-buffer函数定义</h4>
<div class="outline-text-4" id="text-h:4b41f977-3a86-4d7e-bb9c-1a58c0342fb2">
<p>
将另一个缓冲区的内容拷贝到当前缓冲区。作用与`append-to-buffer`或`copy-to-buffer`正好相反。
</p>

<p>
函数定义（部分）
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">insert-buffer</span> (buffer)
   <span style="color: #8b2252;">"documentation"</span>
   (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"*bInsert buffer: "</span>)
   ...)
</pre>
</div>

<p>
注意：interactive 的变量第一部分带了一个`*`。星号用于缓冲区是一个只读缓冲区的情况。如果对只读缓冲区进行操作，会在回显区打印警告或终端进行警告。
</p>

<div class="org-src-container">
<pre class="src src-shell">interactivet&#36873;&#39033;
b &#21578;&#35785;&#35299;&#37322;&#22120;&#20256;&#30340;&#21464;&#37327;&#24212;&#35813;&#26159;&#19968;&#20010;&#23384;&#22312;&#30340;&#32531;&#20914;&#21306;&#25110;&#32773;&#32531;&#20914;&#21306;&#30340;&#21517;&#31216;&#65288;&#22823;&#20889;&#30340;B&#20801;&#35768;&#20256;&#36882;&#19981;&#23384;&#22312;&#30340;&#32531;&#20914;&#21306;&#65289;
</pre>
</div>

<p>
拓展，bufferp函数
</p>

<p>
用以判断是否是一个缓冲区的函数
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(bufferp buffer)
</pre>
</div>

<p>
在Lisp中经常使用p后缀来进行类型的判断(predicate):
</p>

<ul class="org-ul">
<li>stringp</li>
<li>integerp</li>
<li>booleanp</li>
<li>&#x2026;&#x2026;.</li>
</ul>
</div>
</div>
<div id="outline-container-h:47aed123-8fae-4564-8240-6e9c0a434651" class="outline-4">
<h4 id="h:47aed123-8fae-4564-8240-6e9c0a434651">beginning-of-buffer函数的定义</h4>
<div class="outline-text-4" id="text-h:47aed123-8fae-4564-8240-6e9c0a434651">
<p>
该函数可以带参数使用，也可以不带参数使用。
</p>

<p>
该函数的参数是一个介于1和0之间的数字，表示缓冲区长度的十分之几。
</p>

<p>
`C-u 7 M-&lt;`
</p>

<p>
Lisp中定义函数的可选参数使用`&amp;optional`关键词。注意`&amp;`是关键词的一部分，不可漏掉。`&amp;optional`后面的参数，在调用函数的时候不一定要传
</p>
</div>
</div>
</div>
<div id="outline-container-h:1eeba82f-1be0-486f-ad22-e0e08e6b3d52" class="outline-3">
<h3 id="h:1eeba82f-1be0-486f-ad22-e0e08e6b3d52">Narrowing &amp; Widening</h3>
<div class="outline-text-3" id="text-h:1eeba82f-1be0-486f-ad22-e0e08e6b3d52">
<p>
变窄和增宽。将您和 Emacs 的注意力限制在某个区域
</p>

<ul class="org-ul">
<li>变窄是emacs的一个特性，默认不开启(会让新手不理解)</li>
<li>专注于一个缓冲区的特定部分（而隐藏其它部分，看上去像被删除了，其实没有）</li>
<li>好处是，变窄情景下进行一些操作（如搜索操作）就只会对这一部分进行操作，而不影响其它部分</li>
<li>触发快捷键是`C-x n n`，不能通过undo操作进行反向操作，反向操作是`增宽 C-x n w`</li>
<li>变窄对Lisp解释器也起作用，`what-line`等操作对变窄部分进行统计</li>
</ul>
</div>
<div id="outline-container-h:34bffa38-96e1-45f2-89c7-267090157987" class="outline-4">
<h4 id="h:34bffa38-96e1-45f2-89c7-267090157987">save-restriction特殊表</h4>
<div class="outline-text-4" id="text-h:34bffa38-96e1-45f2-89c7-267090157987">
<p>
该特殊表用来跟踪变窄开启的部分。解释器执行表达式中的代码，并恢复这些代码导致的变窄开启的变更。例如，如果代码取消了变窄开启，执行完之后会恢复变窄开启的缓冲区部分。
</p>

<p>
当同时(并且紧接着)使用`save-excursion`和`save-restriction`时，应当外层使用`save-excursion`：
</p>

<ul class="org-ul">
<li>先恢复变窄缓冲区</li>
<li>再恢复光标位置</li>
</ul>
</div>
</div>
<div id="outline-container-h:b164264c-3529-47d5-8249-0d1fb28237df" class="outline-4">
<h4 id="h:b164264c-3529-47d5-8249-0d1fb28237df">what-line函数</h4>
<div class="outline-text-4" id="text-h:b164264c-3529-47d5-8249-0d1fb28237df">
<p>
该函数返回光标所在的行数。(不止是变窄开启的行数)
</p>
</div>
</div>
</div>
<div id="outline-container-h:7e410508-b802-49dd-9ceb-1f2bdad42baa" class="outline-3">
<h3 id="h:7e410508-b802-49dd-9ceb-1f2bdad42baa">car cdr &amp; cons</h3>
<div class="outline-text-3" id="text-h:7e410508-b802-49dd-9ceb-1f2bdad42baa">
<p>
Lisp 中的基本函数 car cdr &amp; cons
</p>

<ul class="org-ul">
<li>cons用于构造列表</li>
<li>car, cdr用于拆分列表</li>
</ul>
</div>
<div id="outline-container-h:218085ed-db04-4372-96ab-8d53d94bc6bb" class="outline-4">
<h4 id="h:218085ed-db04-4372-96ab-8d53d94bc6bb">car 和cdr函数</h4>
<div class="outline-text-4" id="text-h:218085ed-db04-4372-96ab-8d53d94bc6bb">
<ul class="org-ul">
<li>car返回列表的第一个元素，不对原列表做修改（非破坏性）（first)</li>
<li>cdr返回列表的其余部分（除第一个元素外其余部分），同样是非破坏性的(rest)</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> names '(zs ls ww zl))
(car names) <span style="color: #b22222;">;;</span><span style="color: #b22222;">zs</span>
(cdr names) <span style="color: #b22222;">;;</span><span style="color: #b22222;">(ls ww zl)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:21414547-8e79-4294-9858-be9e865e9186" class="outline-4">
<h4 id="h:21414547-8e79-4294-9858-be9e865e9186">cons函数</h4>
<div class="outline-text-4" id="text-h:21414547-8e79-4294-9858-be9e865e9186">
<ul class="org-ul">
<li>cons用于构造列表</li>
</ul>

<p>
最终返回的是一个列表，所以下面的代码会生成`(test first second third)`:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(cons 'test '(first second third))  <span style="color: #b22222;">;;</span><span style="color: #b22222;">(test first second third)</span>
</pre>
</div>

<p>
把第一个元素插入到第二个元素的开始，形成一个新的列表。
</p>

<p>
所以下面的代码，也构成一个列表，只是列表是一种`点对`（只有两个元素的列表，中间用圆点隔开）：
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(cons '(first second third) 'test)      <span style="color: #b22222;">;;</span><span style="color: #b22222;">((first second third) . test)</span>
</pre>
</div>

<p>
查询列表的长度，使用length函数
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(length '(first second third))          <span style="color: #b22222;">;;</span><span style="color: #b22222;">3</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:bfedcd02-b948-4aa4-800e-d0d8d9be2910" class="outline-4">
<h4 id="h:bfedcd02-b948-4aa4-800e-d0d8d9be2910">nthcdr函数</h4>
<div class="outline-text-4" id="text-h:bfedcd02-b948-4aa4-800e-d0d8d9be2910">
<p>
效果等同于重复调用cdr函数n次
</p>
</div>
</div>
<div id="outline-container-h:1915493a-5415-49a8-87f5-7e1aee1917e3" class="outline-4">
<h4 id="h:1915493a-5415-49a8-87f5-7e1aee1917e3">setcar函数</h4>
<div class="outline-text-4" id="text-h:1915493a-5415-49a8-87f5-7e1aee1917e3">
<p>
重新为第一个元素赋值（car是第一个元素），破坏性，改变原值
</p>
</div>
</div>
<div id="outline-container-h:c071dbef-4b9a-4d54-a40d-3a20b37a305a" class="outline-4">
<h4 id="h:c071dbef-4b9a-4d54-a40d-3a20b37a305a">setcdr函数</h4>
<div class="outline-text-4" id="text-h:c071dbef-4b9a-4d54-a40d-3a20b37a305a">
<p>
setcdr为list剩余部分重新赋值，破坏性，改变原值
</p>
</div>
</div>
</div>
<div id="outline-container-h:a1d957ce-32e7-4467-a207-0b7ebcadb658" class="outline-3">
<h3 id="h:a1d957ce-32e7-4467-a207-0b7ebcadb658">Cutting &amp; Storing Text</h3>
<div class="outline-text-3" id="text-h:a1d957ce-32e7-4467-a207-0b7ebcadb658">
<p>
剪切和存储文本
</p>

<ul class="org-ul">
<li>通过kill命令剪切文本</li>
<li>通过yank重新获取回来</li>
</ul>

<p>
当文本从缓冲区剪切出来时，被存储在列表中。
</p>
</div>
<div id="outline-container-h:2bff4fc7-a36c-4a1b-be7d-6bf455bdc1fd" class="outline-4">
<h4 id="h:2bff4fc7-a36c-4a1b-be7d-6bf455bdc1fd">zap-to-char函数</h4>
<div class="outline-text-4" id="text-h:2bff4fc7-a36c-4a1b-be7d-6bf455bdc1fd">
<p>
该函数将光标当前位置与出现特点字符下一位置之间这一区域的文本剪切掉。（所以对只读区域会报错）
</p>

<p>
函数源码interactive表达式
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"*p\ncZap to Char: "</span>)
</pre>
</div>

<ul class="org-ul">
<li>`*` 表示对只读缓冲区报错</li>
<li>p, 表示前缀（会进行多次删除）通过`C-u`或`M-`来传递</li>
<li>c，后续的参数是一个字符</li>
</ul>

<p>
`kill-region` 绑定`C-w`
</p>

<p>
`search-forward`
</p>

<p>
用于定位字符。如果查询成功，函数会在目标字符串处设置位点。返回t表示查询成功
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(search-forward <span style="color: #8b2252;">"target-string"</span>
   limit-of-search
   what-to-do-if-search-fails
   repeat-count)
</pre>
</div>

<p>
`progn`
</p>

<p>
使其每一个参数被逐一求值并返回最后一个参量的值。
</p>

<ul class="org-ul">
<li>注意，前面参数的求值，只是附带效果，值会被舍弃，只返回最后一个的值</li>
<li>常常用于`if`的表达式中（因为if的执行语句只能添加一条语句）</li>
<li>将一系列语句包装成一条语句（有点类似于其它编程语言的代码块）</li>
</ul>
</div>
</div>
<div id="outline-container-h:01c488ec-6859-4afd-bb93-c8d0ef0c9da8" class="outline-4">
<h4 id="h:01c488ec-6859-4afd-bb93-c8d0ef0c9da8">kill-region函数</h4>
<div class="outline-text-4" id="text-h:01c488ec-6859-4afd-bb93-c8d0ef0c9da8">
<p>
kill-region函数就是删除文档字符串的部分
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">kill-region</span> (beg end)
   (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"*r"</span>)
   (copy-region-as-kill beg end)
   (delete-region beg end))
</pre>
</div>

<p>
通过interactive的选项`*`可以得知，对只读区域进行该函数操作，会得到错误提醒。而`r`可知该函数传入的是位置参数。
</p>

<p>
`copy-region-as-kill`函数将某个区域文本`复制`一份到kill环中。
</p>
</div>
</div>
<div id="outline-container-h:a6890973-85d0-45f4-a43a-2a9bf9f1f7dd" class="outline-4">
<h4 id="h:a6890973-85d0-45f4-a43a-2a9bf9f1f7dd">delete-region函数</h4>
<div class="outline-text-4" id="text-h:a6890973-85d0-45f4-a43a-2a9bf9f1f7dd">
<p>
该函数（c语言写成）用于将一个区域中的内容进行删除操作，无法找回。
</p>

<p>
扩展，该函数的c语言实现
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">DEFUN (<span style="color: #8b2252;">"delete-region"</span>, Fdelete_region, Sdelete_region, 2, 2, '
    <span style="color: #8b2252;">"&#25551;&#36848;&#25991;&#26412;"</span>)
</pre>
</div>

<p>
是一个宏实现。
</p>

<p>
DEFUN后面括号内含有7个部分：
</p>

<ul class="org-ul">
<li>Lisp中的函数名</li>
<li>C语言中的函数名，习惯上以F开头</li>
<li>C语言中常数结构名，是C语言中的函数名，但以S开头。</li>
<li>允许的参数数量的最小值</li>
<li>允许的参数数量的最大值</li>
<li>Lisp函数中interactive后面的参数，本例中`r`指的是传递的参数是某个区域的开始和结束的位置</li>
<li>文档字符串</li>
</ul>
</div>
</div>
<div id="outline-container-h:500c2883-5a94-4b6b-b53b-8e28e9473dbb" class="outline-4">
<h4 id="h:500c2883-5a94-4b6b-b53b-8e28e9473dbb">用defvar初始化变量</h4>
<div class="outline-text-4" id="text-h:500c2883-5a94-4b6b-b53b-8e28e9473dbb">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">NAME</span> VALUE
    <span style="color: #8b2252;">"DOCUMENTATION"</span>)
</pre>
</div>

<p>
扩展，获取一个变量的定义可以使用describe-variable函数，或者使用快捷键`C-h v`
</p>
</div>
</div>
<div id="outline-container-h:f96da67c-9052-4ab5-b161-3ac9b652fef0" class="outline-4">
<h4 id="h:f96da67c-9052-4ab5-b161-3ac9b652fef0">copy-region-as-kill函数</h4>
<div class="outline-text-4" id="text-h:f96da67c-9052-4ab5-b161-3ac9b652fef0">
<p>
扩展
</p>

<p>
`this-command`变量：正常情况下，当一个函数执行时，emacs将该变量设置为正在被执行的函数，而将`last-command`设置为this-command原来的值。
</p>

<p>
扩展concat
</p>

<p>
函数返回一个拼接的字符串。
</p>
</div>
</div>
</div>
<div id="outline-container-h:0dabbb1c-d3b9-464f-9596-c28619eb6566" class="outline-3">
<h3 id="h:0dabbb1c-d3b9-464f-9596-c28619eb6566">List Implementation</h3>
<div class="outline-text-3" id="text-h:0dabbb1c-d3b9-464f-9596-c28619eb6566">
<p>
列表是如何在计算机中实现的
</p>

<p>
原子的记录方式：
</p>

<p>
在Lisp中，原子是一种直观的方式记录在计算机中的。是由紧接着的字符记录下来的。
</p>

<p>
列表的保存方式：
</p>

<p>
列表是用一系列成对的指针保存。每个成对的指针中：
</p>

<ul class="org-ul">
<li>第一个指针要么指向一个原子，要么指向另外一个列表(列表内部元素可以是另外一个列表)</li>
<li>第二个指针要么是指向下一个指针对，要么指向符号nil（标记一个列表的结束）</li>
</ul>

<p>
而指针本身非常简单，就是它指向的内存地址。
</p>

<p>
当给一个变量赋值为一个列表时，实际上就是将列表的第一个指针地址赋值给变量
</p>

<p>
所以，car和cdr对列表的操作实际上是指针的移动操作。
</p>

<p>
<img src="./images/image-20210929233642777.png" alt="image-20210929233642777.png">]]
</p>

<p>
而cons操作也是开始的位置插入了一个指针，并将该指针的第二部分指向了原有的列表。
</p>

<p>
<img src="./images/image-20210929234212573.png" alt="image-20210929234212573.png">]]
</p>
</div>
</div>
<div id="outline-container-h:eca26168-289a-40ff-ac18-86b7ffee9d7e" class="outline-3">
<h3 id="h:eca26168-289a-40ff-ac18-86b7ffee9d7e">Yanking</h3>
<div class="outline-text-3" id="text-h:eca26168-289a-40ff-ac18-86b7ffee9d7e">
<p>
找回文本
</p>

<ul class="org-ul">
<li>GUN Emacs中，不论你何时使用kill从缓冲区剪切了文本，你都能通过`yank`命令将其重新找回。</li>
<li>从缓冲区中剪切的文本都被放在`kill-ring`中，所以yank命令将从kill环中适当的将内容取回插入到缓冲区中</li>
<li>`yank`命令的快捷键是`C-y`</li>
</ul>
</div>
<div id="outline-container-h:843e12cf-bc63-4717-9068-614e250cfebe" class="outline-4">
<h4 id="h:843e12cf-bc63-4717-9068-614e250cfebe">kill环总览</h4>
<div class="outline-text-4" id="text-h:843e12cf-bc63-4717-9068-614e250cfebe">
<ul class="org-ul">
<li>kill环是一个文本字符串的列表</li>
<li>`yank`命令也用于复制文本，被拷贝的文本不是从缓冲区中删除掉，而是将这部分文本的一个拷贝放到kill环中。所以yank也可以将其找回。</li>
</ul>

<p>
从kill环中找回文本的三个函数：
</p>

<ul class="org-ul">
<li>`yank`函数，绑定到`C-y`</li>
<li>`yank-pop`函数，绑定到`M-y`</li>
<li>`rotate-yank-pointer`函数</li>
</ul>

<p>
这些函数通过一个`kill-ring-yank-pointer`变量指向kill环。
</p>
</div>
</div>
<div id="outline-container-h:eb548d6f-4297-4189-98d0-b29c9220100e" class="outline-4">
<h4 id="h:eb548d6f-4297-4189-98d0-b29c9220100e">kill-ring-yank-pointer变量</h4>
<div class="outline-text-4" id="text-h:eb548d6f-4297-4189-98d0-b29c9220100e">
<ul class="org-ul">
<li>kill-ring变量存储的是全部被剪切掉的文本列表，是一个指针；</li>
<li>kill-ring-yank-pointer变量存储的是一个指向列表的指针，指向kill环的某一部分，指向的这部分的第一个元素将被插入到缓冲区中</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:6b23e463-dc2e-4f4f-bd27-f5b3ad02c2ff" class="outline-3">
<h3 id="h:6b23e463-dc2e-4f4f-bd27-f5b3ad02c2ff">Loops &amp; Recursion</h3>
<div class="outline-text-3" id="text-h:6b23e463-dc2e-4f4f-bd27-f5b3ad02c2ff">
<p>
循环和递归
</p>
</div>
</div>
<div id="outline-container-h:737a51d4-6566-4a82-8c68-9eeaea8330a8" class="outline-3">
<h3 id="h:737a51d4-6566-4a82-8c68-9eeaea8330a8">Regexp Search</h3>
<div class="outline-text-3" id="text-h:737a51d4-6566-4a82-8c68-9eeaea8330a8">
</div>
</div>
<div id="outline-container-h:8b7d63a8-c0fd-4ea2-93cc-4c6b107a87d6" class="outline-3">
<h3 id="h:8b7d63a8-c0fd-4ea2-93cc-4c6b107a87d6">Counting Words</h3>
<div class="outline-text-3" id="text-h:8b7d63a8-c0fd-4ea2-93cc-4c6b107a87d6">
</div>
</div>
<div id="outline-container-h:36bc8678-0341-4d13-a897-fb6143b3b766" class="outline-3">
<h3 id="h:36bc8678-0341-4d13-a897-fb6143b3b766">Words in a defun</h3>
<div class="outline-text-3" id="text-h:36bc8678-0341-4d13-a897-fb6143b3b766">
</div>
</div>
<div id="outline-container-h:8f96f424-98ee-4f3f-93ed-9f59d74604a0" class="outline-3">
<h3 id="h:8f96f424-98ee-4f3f-93ed-9f59d74604a0">Readying a Graph</h3>
<div class="outline-text-3" id="text-h:8f96f424-98ee-4f3f-93ed-9f59d74604a0">
</div>
</div>
<div id="outline-container-h:f4c4baa4-872d-43b5-8f52-e5833f264bc9" class="outline-3">
<h3 id="h:f4c4baa4-872d-43b5-8f52-e5833f264bc9">Emacs Initialization</h3>
<div class="outline-text-3" id="text-h:f4c4baa4-872d-43b5-8f52-e5833f264bc9">
</div>
</div>
<div id="outline-container-h:9faeba3d-c813-42a3-9c21-ea3ecccaf003" class="outline-3">
<h3 id="h:9faeba3d-c813-42a3-9c21-ea3ecccaf003">Debugging</h3>
<div class="outline-text-3" id="text-h:9faeba3d-c813-42a3-9c21-ea3ecccaf003">
</div>
</div>
<div id="outline-container-h:59de3f3f-f5af-4ed2-9902-b9c229b6a336" class="outline-3">
<h3 id="h:59de3f3f-f5af-4ed2-9902-b9c229b6a336">Conclusion</h3>
<div class="outline-text-3" id="text-h:59de3f3f-f5af-4ed2-9902-b9c229b6a336">
</div>
</div>
<div id="outline-container-h:076f3d0b-c1b2-4ce4-b093-0d9d89ae0680" class="outline-3">
<h3 id="h:076f3d0b-c1b2-4ce4-b093-0d9d89ae0680">the-the</h3>
<div class="outline-text-3" id="text-h:076f3d0b-c1b2-4ce4-b093-0d9d89ae0680">
</div>
</div>
<div id="outline-container-h:34e83b84-e8ce-4e81-8d92-b0e23e87ea6d" class="outline-3">
<h3 id="h:34e83b84-e8ce-4e81-8d92-b0e23e87ea6d">Kill Ring</h3>
<div class="outline-text-3" id="text-h:34e83b84-e8ce-4e81-8d92-b0e23e87ea6d">
</div>
</div>
<div id="outline-container-h:20282976-9386-4382-8e34-cc736ea12cad" class="outline-3">
<h3 id="h:20282976-9386-4382-8e34-cc736ea12cad">Full Graph</h3>
<div class="outline-text-3" id="text-h:20282976-9386-4382-8e34-cc736ea12cad">
</div>
</div>
<div id="outline-container-h:392ad25e-e75f-4f2d-bf9c-c08bc32a7987" class="outline-3">
<h3 id="h:392ad25e-e75f-4f2d-bf9c-c08bc32a7987">Free Software and Free Manuals</h3>
<div class="outline-text-3" id="text-h:392ad25e-e75f-4f2d-bf9c-c08bc32a7987">
</div>
</div>
<div id="outline-container-h:e46a440f-e390-402c-a033-a6607bb6c582" class="outline-3">
<h3 id="h:e46a440f-e390-402c-a033-a6607bb6c582">GNU Free Documentation License</h3>
<div class="outline-text-3" id="text-h:e46a440f-e390-402c-a033-a6607bb6c582">
</div>
</div>
</section>
<section id="outline-container-h:601b8c3a-9bae-4dfd-b014-c3115c519639" class="outline-2">
<h2 id="h:601b8c3a-9bae-4dfd-b014-c3115c519639">TMP</h2>
<div class="outline-text-2" id="text-h:601b8c3a-9bae-4dfd-b014-c3115c519639">
</div>
<div id="outline-container-h:677ec3f9-d41d-42ab-81c0-aa3c3a55f8fe" class="outline-6">
<h6 id="h:677ec3f9-d41d-42ab-81c0-aa3c3a55f8fe">代码缩进</h6>
<div class="outline-text-6" id="text-h:677ec3f9-d41d-42ab-81c0-aa3c3a55f8fe">
<p>
<code>indent-region</code> 可以帮我们重新缩进所选区域的代码，但是每一次都选中十分麻烦。使用 下面的代码可以一次重新缩进全部缓冲区的代码。（之后也会介绍更好用的，代码格式美化 的插件）
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">indent-buffer</span>()
  (<span style="color: #a020f0;">interactive</span>)
  (indent-region (point-min) (point-max)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">indent-region-or-buffer</span>()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">save-excursion</span>
    (<span style="color: #a020f0;">if</span> (region-active-p)
  (<span style="color: #a020f0;">progn</span>
    (indent-region (region-beginning) (region-end))
    (message <span style="color: #8b2252;">"Indent selected region."</span>))
      (<span style="color: #a020f0;">progn</span>
  (indent-buffer)
  (message <span style="color: #8b2252;">"Indent buffer."</span>)))))
</pre>
</div>

<p>
然后再将其用下面的代码将其绑定为快捷键，第一个 `\` 用于将紧跟的 `\` 进行逃脱（escape）。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20195;&#30721;&#32553;&#36827;</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-M-\\"</span>) 'indent-region-or-buffer)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:2879a827-5551-4b9a-99e0-9268a81aaa2d" class="outline-6">
<h6 id="h:2879a827-5551-4b9a-99e0-9268a81aaa2d">插件-显示缩进线</h6>
<div class="outline-text-6" id="text-h:2879a827-5551-4b9a-99e0-9268a81aaa2d">
<div class="org-src-container">
<pre class="src src-shell">;; Cursor &amp; Current Line
(use-package cursor-line-settings
  :ensure nil
  :init
  ;; blink the cursor
  (blink-cursor-mode 1)
  (global-hl-line-mode 1)
  ;; &#39640;&#20142;&#24403;&#21069;&#34892;&#65292;&#20351;&#29992;&#27973;&#28784;&#33394;&#32972;&#26223;&#26465;
  (set-face-background hl-line-face <span style="color: #8b2252;">"#F2F2F2"</span>)
  ;; &#39640;&#20142;&#24403;&#21069;&#34892;&#65292;&#20351;&#29992;&#19979;&#21010;&#32447;
  ;; (set-face-underline-p <span style="color: #8b2252;">'highlight t)</span>
<span style="color: #8b2252;">  )</span>
</pre>
</div>




<p>
<b>补充</b>
</p>

<p>
整行
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">xt3/sel-cur-line</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (set-mark (line-end-position))
  (beginning-of-line))
(<span style="color: #a020f0;">bind-key</span> <span style="color: #8b2252;">"C-x M-h"</span> #'xt3/sel-cur-line)
</pre>
</div>



<p>
插件-expand-region 选中一个区域
</p>

<p>
使用同样的方法将 expand-region 添加至我们的插件列表中，重启 Emacs 安装插件。
</p>

<ul class="org-ul">
<li>expand-region <a href="https://github.com/magnars/expand-region.el/">https://github.com/magnars/expand-region.el/</a> er/expand-region == <code>C-=</code></li>
</ul>

<p>
再为其绑定一个快捷键，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">expand-region &#26041;&#20415;&#36873;&#20013;&#19968;&#20010;&#21306;&#22495;</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-="</span>) 'er/expand-region)
</pre>
</div>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26041;&#20415;&#36873;&#20013;&#19968;&#20010;&#21306;&#22495;</span>
(<span style="color: #a020f0;">use-package</span> expand-region
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-="</span>) 'er/expand-region))
</pre>
</div>

<p>
使用这个插件可以使我们更方便的选中一个区域。（更多使用方法和文档可以在<a href="https://github.com/magnars/expand-region.el">这里</a>找到）
</p>

<p>
插件-标记环列表
</p>

<p>
<a href="https://github.com/emacs-helm/helm">https://github.com/emacs-helm/helm</a>
</p>

<ul class="org-ul">
<li>M-x helm-mark-all-rings | helm-[global]-mark-ring</li>
</ul>

<p>
<b>补全插件</b>
</p>

<ul class="org-ul">
<li><a href="https://company-mode.github.io/">company</a> 补全</li>
<li><a href="https://github.com/auto-complete/auto-complete">auto-complete</a> 补全（推荐company）</li>
<li><a href="https://github.com/joaotavora/yasnippet">yasnippet</a> （模板）
<ul class="org-ul">
<li>yas-insert-snippet == 绑定到s-i</li>
</ul></li>
</ul>

<p>
删除拓展
</p>

<p>
插件-yank回溯 ivy
</p>


<p>
使用M-y选择要回溯的内容
</p>

<ul class="org-ul">
<li>参考 <a href="http://pragmaticemacs.com/emacs/counsel-yank-pop-with-a-tweak/">http://pragmaticemacs.com/emacs/counsel-yank-pop-with-a-tweak/</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> counsel
  <span style="color: #483d8b;">:bind</span>
  ((<span style="color: #8b2252;">"M-y"</span> . counsel-yank-pop)
   <span style="color: #483d8b;">:map</span> ivy-minibuffer-map
   (<span style="color: #8b2252;">"M-y"</span> . ivy-next-line)))
</pre>
</div>

<p>
插件-helm Kill Ring剪切环:
</p>

<p>
功能与 ivy类似
</p>

<ul class="org-ul">
<li>helm <a href="https://github.com/emacs-helm/helm">https://github.com/emacs-helm/helm</a></li>
</ul>

<p>
helm-show-kill-ring == M-y
</p>

<p>
插件-whole-line-or-region*
</p>

<ul class="org-ul">
<li><a href="https://github.com/purcell/whole-line-or-region/blob/master/whole-line-or-region.el">whole-line-or-region</a> : 区域激活 则应用到区域 否则 应用到当前行</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> whole-line-or-region
  <span style="color: #483d8b;">:diminish</span> whole-line-or-region-mode
  <span style="color: #483d8b;">:config</span>
  (whole-line-or-region-mode t)
  (make-variable-buffer-local 'whole-line-or-region-mode))
</pre>
</div>

<p>
插件-hungry-delete 多空格删除*
</p>

<ul class="org-ul">
<li>hungry-delete 多空格删除 <a href="https://github.com/nflath/hungry-delete">https://github.com/nflath/hungry-delete</a></li>
<li>效果不是很友好</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">mypackages</span> '(
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">--- Better Editor ---</span>
         hungry-delete
         ) <span style="color: #ff0000; font-weight: bold;">"Default packages"</span><span style="color: #ff0000; font-weight: bold;">)</span>
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">hungry-delete</span>)
(global-hungry-delete-mode)
</pre>
</div>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> hungry-delete
<span style="color: #483d8b;">:ensure</span> t
<span style="color: #483d8b;">:config</span>
(global-hungry-delete-mode))
</pre>
</div>

<p>
插件-move-dup复制移动行区域*
</p>

<p>
Copy Kill Move(Kill-[Goto]-Paste)
</p>

<ul class="org-ul">
<li><a href="https://github.com/wyuenho/move-dup">move-dup</a> (行|区域)</li>
</ul>

<div class="org-src-container">
<pre class="src src-shell">md/move-lines-[up|down]
md/duplicate-[up|down]
</pre>
</div>

<p>
插件-Avy复制移动行区域
</p>

<p>
Avy <a href="https://github.com/abo-abo/avy">https://github.com/abo-abo/avy</a>
</p>

<div class="org-src-container">
<pre class="src src-shell">avy-copy-[line|region] (&#21333;&#34892;|&#34892;&#33539;&#22260;)
avy-kill-[line|region] 
avy-move-[line|region] (&#21333;&#34892;|&#21306;&#22495;)
</pre>
</div>

<p>
插件-drag-stuff 区域上下移动
</p>

<p>
在 VSCode 或 Jetbrains 家族的编辑器中，上下移动行/块是非常容易的，但原生的 Emacs 没有提供这样的功能。可通过插件`drag-stuff`来辅助实现。与avy-move-region功能类似
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#34892;/&#21306;&#22495;&#19978;&#19979;&#31227;&#21160;</span>
(<span style="color: #a020f0;">use-package</span> drag-stuff
  <span style="color: #483d8b;">:bind</span> ((<span style="color: #8b2252;">"&lt;M-up&gt;"</span>. drag-stuff-up)
         (<span style="color: #8b2252;">"&lt;M-down&gt;"</span> . drag-stuff-down)))
</pre>
</div>

<p>
搜索
</p>

<p>
<b>拓展</b>
</p>

<ul class="org-ul">
<li>ivy-counsel-swiper 三剑客插件
<ul class="org-ul">
<li>C-s ..
<ul class="org-ul">
<li>Paste : C-y | M-y(Kill Ring)</li>
<li>Next|Previous : C-(n|p)</li>
</ul></li>
</ul></li>
<li>avy 快速搜索定位插件</li>
<li>ag 搜索</li>
<li>multiple-cursors多游标插件</li>
<li>iedit 同时编辑插件</li>
</ul>

<p>
<b>ag 搜索</b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">use-package</span> ag
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<p>
搜索文件
没有ag时，`find-dired`回车指定参数`-name \*org`
</p>

<p>
`ag-project` 搜索
</p>


<p>
安装好 ag 后我们就可以安装 helm-ag 插件了。（它的 GitHub 仓库地址在<a href="https://github.com/syohex/emacs-helm-ag">这里</a>）在安装 完成后可以为其设置快捷键，
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #8b2252;">"C-c p s"</span>) 'helm-do-ag-project-root)
</pre>
</div>

<p>
使用这个插件我们同样可以在缓冲区对搜索到的结果进行直接的修改，这样就可以做到快速 的搜索与替换。
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;&#23383;&#31526;&#31034;&#20363;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#25628;&#32034;&#21253;&#21547;org gtd &#30340;&#23383;&#31526;&#30340;&#25991;&#20214;&#65292;&#24182;&#19988;&#36807;&#28388;&#20854;&#20013;&#30340;abc&#34892;</span>
pattern: org gtd !abc
</pre>
</div>

<p>
[images/image-20210622174126541.png]
经
`C-c C-e`打开buffer可以批量编辑文件
</p>

<p>
<img src="./images/image-20210622174145058.png" alt="image-20210622174145058.png">]]
</p>

<p>
或者使用`counsel-ag`
</p>

<p>
<b>iedit 同时编辑插件</b>
</p>

<p>
iedit 是一个可以同时编辑多个区域的插件，它类似 Sublime Text 中的多光标编辑。它的 GitHub 仓库在<a href="https://github.com/victorhge/iedit">这里</a>。
</p>

<ul class="org-ul">
<li>iedit <a href="https://github.com/victorhge/iedit">https://github.com/victorhge/iedit</a></li>
</ul>

<p>
我们将其绑定快捷键以便更快捷的使用这个模式（ `C-;` 为默认快捷键），
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">config for iedit mode</span>
(global-set-key (kbd <span style="color: #8b2252;">"M-s e"</span>) 'iedit-mode)
</pre>
</div>

<p>
use-package
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21516;&#26102;&#32534;&#36753;</span>
(<span style="color: #a020f0;">use-package</span> iedit
  <span style="color: #483d8b;">:ensure</span> t)
</pre>
</div>

<p>
我们可以使用 Customized-group 来更改其高亮的背景色，将 `highlight` 改为 `region` 。
</p>
</div>
</div>
</section>
<section id="outline-container-h:85b024f2-2e62-4ba2-9672-e46c4975fa72" class="outline-2">
<h2 id="h:85b024f2-2e62-4ba2-9672-e46c4975fa72">参考</h2>
<div class="outline-text-2" id="text-h:85b024f2-2e62-4ba2-9672-e46c4975fa72">
<ul class="org-ul">
<li>Emacs高手修炼手册:<a href="https://juejin.cn/post/7085254713595133960">v1.0</a> <a href="https://juejin.cn/post/7276019934046928933">v2.0</a></li>
<li><a href="https://www.zhihu.com/column/c_1440829147212279808">专业 Emacs 入门教程</a> <a href="https://pavinberg.github.io/emacs-book/zh/">2</a></li>
<li><a href="https://book.emacs-china.org/">21 天学会 Emacs</a></li>
<li><a href="https://www.bilibili.com/video/BV15VUNBfEzG/">在新笔记本上配置 Emacs | Tsoding Daily</a></li>
</ul>
</div>
</section>
</div>
</body>
</html>
