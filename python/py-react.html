<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Python: WEB开发-react</title>
<meta name="generator" content="Org Mode" />
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="me" href="https://emacs.ch/@jasperhsu">
<meta name="google-adsense-account" content="ca-pub-1741779893655624">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1741779893655624" crossorigin="anonymous"></script>
<!-- from -->
<!--
<style>#back-to-top{background:#000;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;bottom:20px;-webkit-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);-moz-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);box-shadow:0 2px 5px 0 rgba(0,0,0,.26);color:#fff;cursor:pointer;display:block;height:56px;opacity:1;outline:0;position:fixed;right:20px;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-transition:bottom .2s,opacity .2s;-o-transition:bottom .2s,opacity .2s;-moz-transition:bottom .2s,opacity .2s;transition:bottom .2s,opacity .2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:56px;z-index:1}#back-to-top svg{display:block;fill:currentColor;height:24px;margin:16px auto 0;width:24px}#back-to-top.hidden{bottom:-56px;opacity:0}</style>
-->
<link rel="stylesheet" href="/static/aandds.com/css/main.css">
<link rel="stylesheet" href="/static/aandds.com/css/drollery.min.css">
<script type="text/javascript" src="/static/aandds.com/js/main.js"></script>
<!--
<script id="MathJax-script" async="" src="/static/aandds.com/js/mathjax.js"></script>

<script type="text/javascript" src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
-->
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">Python: WEB开发-react</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#h:e0381a37-bb3c-4bb1-a725-474027b2d6c5">React项目构建</a>
<ul>
<li><a href="#h:6fc6f19f-fa12-4802-b7cf-3819929b346d">项目依赖安装</a></li>
<li><a href="#h:ea76929b-7b4e-4ca8-a3d9-12ce04e469de">项目整体说明</a></li>
<li><a href="#h:e6f89ae0-205c-4c90-9f90-9a1c4bbbffd7">配置文件详解</a>
<ul>
<li><a href="#h:7d264ecd-4183-4b21-bf1d-ce3239e43e88">package.json</a>
<ul>
<li><a href="#h:a0b2b3d6-c86d-4fef-a822-f837c2cee0f9">版本管理</a></li>
<li><a href="#h:e42b6099-8e41-4501-91eb-3479e7ce5735">项目脚本管理</a></li>
<li><a href="#h:7f24e2a6-c84b-4a25-b351-45a4880b2810">项目依赖</a></li>
<li><a href="#h:fb206ef9-fcae-47bf-9312-67e9c9b1c5ee">开发是依赖</a></li>
<li><a href="#h:dfbff546-bd1c-4167-a14b-62fad09fad2e">运行时依赖</a></li>
</ul>
</li>
<li><a href="#h:50c5bf12-8214-49d3-8dfc-4e79763f0077">babel配置</a></li>
<li><a href="#h:f16a60ec-1cfc-4d02-b521-e2fb6bc95523">webpack配置</a>
<ul>
<li><a href="#h:8219a6b4-0337-453b-ad8a-0c3f996d1161">webpack.config.dev.js</a></li>
</ul>
</li>
<li><a href="#h:261941f1-01ae-4538-a3e3-3464508cda47">vscode配置</a></li>
</ul>
</li>
<li><a href="#h:154d9e8c-2715-49e1-a6e1-179f0a5a4cfa">启动项目</a></li>
</ul>
</li>
<li><a href="#h:475cc518-6293-441a-8315-fcdbfd8eb82a">React技术</a>
<ul>
<li><a href="#h:cde2f5cb-f82a-4ded-8475-4b3ef8d7cb23">简介</a>
<ul>
<li><a href="#h:788d552b-1e2f-461b-8b71-1c697467cbc8">Virtual DOM</a></li>
<li><a href="#h:4e7cd2f0-8325-4578-92bd-001d6a6494dc">支持JSX语法</a></li>
</ul>
</li>
<li><a href="#h:9e2e3ddb-61c5-4071-91fc-07ab02fcb1e5">测试程序</a>
<ul>
<li><a href="#h:513ec94d-6b4a-47a6-9f02-9774a8583a0f">程序解释</a></li>
</ul>
</li>
<li><a href="#h:acbb7e3f-6f06-4d6e-b19a-dc8df3561f65">JSX规范</a></li>
<li><a href="#h:7ef6fa73-f71b-49b0-8344-faeb4a6067c3">组件状态state **</a>
<ul>
<li><a href="#h:a3379f82-ab16-43e6-9aa5-f720a2c59163">复杂的状态例子</a></li>
<li><a href="#h:fdd6bb5a-e2b5-4701-b0e9-6195a510de3b">HTML DOM的JavaScript事件</a></li>
</ul>
</li>
<li><a href="#h:250d3c93-4e40-4ade-bbf4-2634d3244f2a">属性props</a></li>
<li><a href="#h:8ce34831-173d-47cb-82ac-159709a552df">单向数据流</a></li>
<li><a href="#h:cb17f0b3-0c0b-486f-8f7c-8dbe43d45b03">构造器constructor</a></li>
<li><a href="#h:0164d06c-7b64-4ea8-afd1-6e4fdb8d5140">组件的生命周期</a></li>
<li><a href="#h:d4ca3e0f-3b96-4fc0-b642-9d8a9bce90c3">函数式组件</a></li>
<li><a href="#h:b868542a-7890-4a14-be44-7b643600401e">高阶组件</a>
<ul>
<li><a href="#h:aabac657-b75e-4d67-8805-f6e05bdb8cf2">装饰器</a></li>
<li><a href="#h:8eda4a1c-bcc1-4ce2-be44-e7c241682f75">带参装饰器</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav>
<ul class="org-ul">
<li>TAGS: <a href="./index.html">Python</a></li>
</ul>
<section id="outline-container-h:e0381a37-bb3c-4bb1-a725-474027b2d6c5" class="outline-2">
<h2 id="h:e0381a37-bb3c-4bb1-a725-474027b2d6c5">React项目构建</h2>
<div class="outline-text-2" id="text-h:e0381a37-bb3c-4bb1-a725-474027b2d6c5">
</div>
<div id="outline-container-h:6fc6f19f-fa12-4802-b7cf-3819929b346d" class="outline-3">
<h3 id="h:6fc6f19f-fa12-4802-b7cf-3819929b346d">项目依赖安装</h3>
<div class="outline-text-3" id="text-h:6fc6f19f-fa12-4802-b7cf-3819929b346d">
<p>
将项目开发基础文件 react-mobx-starter-master.zip 解压缩，并用这个目录作为项目根目录。
</p>

<p>
在项目根目录中，执行下面的命令，就会自动按照package.json的配置安装依赖模块。
</p>
<div class="org-src-container">
<pre class="src src-sh">npm install <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25110;&#32773; $ npm i</span>
</pre>
</div>

<p>
安装完成后，会生成一个目录 node_modules ，里面是安装的所有依赖的模块
</p>
</div>
</div>
<div id="outline-container-h:ea76929b-7b4e-4ca8-a3d9-12ce04e469de" class="outline-3">
<h3 id="h:ea76929b-7b4e-4ca8-a3d9-12ce04e469de">项目整体说明</h3>
<div class="outline-text-3" id="text-h:ea76929b-7b4e-4ca8-a3d9-12ce04e469de">
<p>
项目目录结构
</p>
<div class="org-src-container">
<pre class="src src-js">.
&#9500;&#9472;&#9472; .babelrc
&#9500;&#9472;&#9472; .gitignore
&#9500;&#9472;&#9472; index.html #&#27979;&#35797;&#26102;&#29992;&#30340;
&#9500;&#9472;&#9472; jsconfig.json
&#9500;&#9472;&#9472; LICENSE
&#9500;&#9472;&#9472; .npmrc
&#9500;&#9472;&#9472; <span style="color: #a020f0;">package</span>.json
&#9500;&#9472;&#9472; README.md
&#9500;&#9472;&#9472; src
&#9474; &#9500;&#9472;&#9472; App.js
&#9474; &#9500;&#9472;&#9472; AppState.js
&#9474; &#9500;&#9472;&#9472; index.html #&#25171;&#21253;&#26102;&#29992;&#30340;
&#9474; &#9492;&#9472;&#9472; index.js
&#9500;&#9472;&#9472; node_modules
&#9474; &#9500;&#9472;&#9472; ...
&#9500;&#9472;&#9472; webpack.config.dev.js
&#9492;&#9472;&#9472; webpack.config.prod.js
</pre>
</div>
</div>
</div>
<div id="outline-container-h:e6f89ae0-205c-4c90-9f90-9a1c4bbbffd7" class="outline-3">
<h3 id="h:e6f89ae0-205c-4c90-9f90-9a1c4bbbffd7">配置文件详解</h3>
<div class="outline-text-3" id="text-h:e6f89ae0-205c-4c90-9f90-9a1c4bbbffd7">
</div>
<div id="outline-container-h:7d264ecd-4183-4b21-bf1d-ce3239e43e88" class="outline-4">
<h4 id="h:7d264ecd-4183-4b21-bf1d-ce3239e43e88">package.json</h4>
<div class="outline-text-4" id="text-h:7d264ecd-4183-4b21-bf1d-ce3239e43e88">
<p>
$ npm init 产生的文件，里面记录项目信息，所有项目依赖
</p>
</div>
<div id="outline-container-h:a0b2b3d6-c86d-4fef-a822-f837c2cee0f9" class="outline-5">
<h5 id="h:a0b2b3d6-c86d-4fef-a822-f837c2cee0f9">版本管理</h5>
<div class="outline-text-5" id="text-h:a0b2b3d6-c86d-4fef-a822-f837c2cee0f9">
<p>
可指定到对应的git仓库
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8b2252;">"repository"</span>: { 
    <span style="color: #8b2252;">"type"</span>: <span style="color: #8b2252;">"git"</span>, 
    <span style="color: #8b2252;">"url"</span>: <span style="color: #8b2252;">"https://192.168.124.135/react-mobx/react-mobx-starter.git"</span>
}
</pre>
</div>
</div>
</div>
<div id="outline-container-h:e42b6099-8e41-4501-91eb-3479e7ce5735" class="outline-5">
<h5 id="h:e42b6099-8e41-4501-91eb-3479e7ce5735">项目脚本管理</h5>
<div class="outline-text-5" id="text-h:e42b6099-8e41-4501-91eb-3479e7ce5735">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8b2252;">"scripts"</span>: {
    <span style="color: #8b2252;">"test"</span>: <span style="color: #8b2252;">"jest"</span>,
    <span style="color: #8b2252;">"start"</span>: <span style="color: #8b2252;">"webpack-dev-server --config webpack.config.dev.js --hot --inline"</span>,
    <span style="color: #8b2252;">"build"</span>: <span style="color: #8b2252;">"rimraf dist &amp;&amp; webpack -p --config webpack.config.prod.js"</span>
}
</pre>
</div>

<p>
scripts属性是一个字典描述，key是名字，value是能够让npm运行的脚本内容。
</p>

<p>
运行时只要输入 <code>npm run key_name</code> 即可。
</p>

<p>
start 指定启动webpack的dev server开发用WEB Server，
主要提供2个功能：静态文件支持、自动刷新和 <b>热替换HMR(Hot Module replacement)</b> 。对应 <code>npm run start</code>
</p>

<ul class="org-ul">
<li>&#x2013;hot 启动HMR
<ul class="org-ul">
<li>HRM可以在应用程序运行中替换、添加、删除模块，而无需重载页面，只把变化部分替换掉。不使用HMR则自动刷新会导致这个页面刷新</li>
</ul></li>

<li>&#x2013;inline 默认模式, 使用HMR的时候建议开启inline模式。热替换时会有消息显示在控制台</li>
</ul>

<p>
build 使用webpack构建打包。对应 <code>npm run build</code>
</p>
</div>
</div>
<div id="outline-container-h:7f24e2a6-c84b-4a25-b351-45a4880b2810" class="outline-5">
<h5 id="h:7f24e2a6-c84b-4a25-b351-45a4880b2810">项目依赖</h5>
<div class="outline-text-5" id="text-h:7f24e2a6-c84b-4a25-b351-45a4880b2810">
<p>
devDependencies 开发时依赖，不会打包到目标文件中。对应 <code>npm install xxx --save-dev</code>
</p>

<p>
例如babel的一些依赖，只是为了帮我们转译代码，没有必要发布到生产环境中.
</p>

<p>
dependencies 运行时依赖，会打包到项目中。对应 <code>npm install xxx --save</code>
</p>
</div>
</div>
<div id="outline-container-h:fb206ef9-fcae-47bf-9312-67e9c9b1c5ee" class="outline-5">
<h5 id="h:fb206ef9-fcae-47bf-9312-67e9c9b1c5ee">开发是依赖</h5>
<div class="outline-text-5" id="text-h:fb206ef9-fcae-47bf-9312-67e9c9b1c5ee">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8b2252;">"devDependencies"</span>: {
    <span style="color: #8b2252;">"babel-core"</span>: <span style="color: #8b2252;">"^6.24.1"</span>,
    <span style="color: #8b2252;">"babel-jest"</span>: <span style="color: #8b2252;">"^19.0.0"</span>,
    <span style="color: #8b2252;">"babel-loader"</span>: <span style="color: #8b2252;">"^6.4.1"</span>,
    <span style="color: #8b2252;">"babel-plugin-transform-decorators-legacy"</span>: <span style="color: #8b2252;">"^1.3.4"</span>,
    <span style="color: #8b2252;">"babel-plugin-transform-runtime"</span>: <span style="color: #8b2252;">"^6.23.0"</span>,
    <span style="color: #8b2252;">"babel-preset-env"</span>: <span style="color: #8b2252;">"^1.4.0"</span>,
    <span style="color: #8b2252;">"babel-preset-react"</span>: <span style="color: #8b2252;">"^6.24.1"</span>,
    <span style="color: #8b2252;">"babel-preset-stage-0"</span>: <span style="color: #8b2252;">"^6.24.1"</span>,
    <span style="color: #8b2252;">"css-loader"</span>: <span style="color: #8b2252;">"^0.28.0"</span>,
    <span style="color: #8b2252;">"html-webpack-plugin"</span>: <span style="color: #8b2252;">"^2.28.0"</span>,
    <span style="color: #8b2252;">"jest"</span>: <span style="color: #8b2252;">"^19.0.2"</span>,
    <span style="color: #8b2252;">"less"</span>: <span style="color: #8b2252;">"^2.7.2"</span>,
    <span style="color: #8b2252;">"less-loader"</span>: <span style="color: #8b2252;">"^4.0.3"</span>,
    <span style="color: #8b2252;">"react-hot-loader"</span>: <span style="color: #8b2252;">"^4.3.12"</span>,
    <span style="color: #8b2252;">"rimraf"</span>: <span style="color: #8b2252;">"^2.6.2"</span>,
    <span style="color: #8b2252;">"source-map"</span>: <span style="color: #8b2252;">"^0.5.6"</span>,
    <span style="color: #8b2252;">"source-map-loader"</span>: <span style="color: #8b2252;">"^0.2.1"</span>,
    <span style="color: #8b2252;">"style-loader"</span>: <span style="color: #8b2252;">"^0.16.1"</span>,
    <span style="color: #8b2252;">"uglify-js"</span>: <span style="color: #8b2252;">"^2.8.22"</span>,
    <span style="color: #8b2252;">"webpack"</span>: <span style="color: #8b2252;">"^2.4.1"</span>,
    <span style="color: #8b2252;">"webpack-dev-server"</span>: <span style="color: #8b2252;">"^2.4.2"</span>
}
</pre>
</div>

<p>
版本号指定
</p>
<ul class="org-ul">
<li>版本号 ，只安装指定版本号的</li>
<li>~版本号 ，例如 ~1.2.3 表示安装1.2.x中最新版本，不低于1.2.3，但不能安装1.3.x</li>
<li>^版本号 ，例如 ^2.4.1 表示安装2.x.x最新版本不低于2.4.1</li>
<li>latest ，安装最新版本</li>
<li>1.2.x或1.x</li>
<li>* 任意版本</li>
<li>1.2.7 || &gt;=1.2.9 &lt;2.0.0, 可以安装1.2.7，或者1.2.9本身或者之上的1.2.x版本，但不能是2.x版本。</li>
</ul>

<p>
babel 转译
</p>
<ul class="org-ul">
<li>因为开发用了很多ES6语法。从6.x开始babel拆分成很多插件，需要什么引入什么。</li>
<li>babel-core 核心</li>
<li>babel-loader webpack的loader，webpack是基于loader装载器的。把HTML,CSS,JS,图片,字体等资源看做模块，就可以像
JS一样加载这些模块。文件类型不同，就需要各种各样的loader。babel-loader加载ES6+代码转换为ES5.</li>
<li>babel-preset-xxx 预设的转换插件</li>
<li>babel-plugin-transform-decorators-legacy 下面的课程用到了装饰器，这个插件就是转换装饰器用的</li>
</ul>

<p>
css样式相关
</p>
<ul class="org-ul">
<li>css-loader、style-loader样式表加载器</li>
<li>less、less-loader是对less文件的支持</li>
<li>react-hot-loader 是react热加载插件，希望改动保存后，直接在页面上直接反馈出来，不需要手动刷新</li>
</ul>

<p>
source-map文件打包，js会合并或者压缩，没法调试，用它来看js原文件是什么。source-map-loader也需webpack的 loader
</p>

<p>
webpack 打包工具，2.4.1 发布于2017年4月，当前2.7.0发布于2017年7月。
</p>

<p>
webpack-dev-server 启动一个开发时用的server
</p>
</div>
</div>
<div id="outline-container-h:dfbff546-bd1c-4167-a14b-62fad09fad2e" class="outline-5">
<h5 id="h:dfbff546-bd1c-4167-a14b-62fad09fad2e">运行时依赖</h5>
<div class="outline-text-5" id="text-h:dfbff546-bd1c-4167-a14b-62fad09fad2e">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #8b2252;">"dependencies"</span>: {
    <span style="color: #8b2252;">"antd"</span>: <span style="color: #8b2252;">"^3.10.9"</span>,
    <span style="color: #8b2252;">"axios"</span>: <span style="color: #8b2252;">"^0.16.1"</span>,
    <span style="color: #8b2252;">"babel-polyfill"</span>: <span style="color: #8b2252;">"^6.23.0"</span>,
    <span style="color: #8b2252;">"babel-runtime"</span>: <span style="color: #8b2252;">"^6.23.0"</span>,
    <span style="color: #8b2252;">"mobx"</span>: <span style="color: #8b2252;">"^4.6.0"</span>,
    <span style="color: #8b2252;">"mobx-react"</span>: <span style="color: #8b2252;">"^5.4.2"</span>,
    <span style="color: #8b2252;">"react"</span>: <span style="color: #8b2252;">"^16.6.3"</span>,
    <span style="color: #8b2252;">"react-dom"</span>: <span style="color: #8b2252;">"^16.6.3"</span>,
    <span style="color: #8b2252;">"react-router"</span>: <span style="color: #8b2252;">"^4.3.1"</span>,
    <span style="color: #8b2252;">"react-router-dom"</span>: <span style="color: #8b2252;">"^4.3.1"</span>
}
</pre>
</div>

<ul class="org-ul">
<li>antd 即 ant design，基于react实现，蚂蚁金服开源的react的UI库。做中后台管理非常方便.</li>
<li>axios 异步请求支持。</li>
<li>polyfill 解决浏览器api不支持的问题。写好polyfill就让你的浏览器支持，帮你抹平差异化</li>

<li>react开发的主框架</li>
<li>react-dom 支持DOM</li>
<li>react-router 支持路由</li>
<li>react-router-dom DOM绑定路由</li>

<li>mobx 状态管理库，透明化。</li>
<li>mobx-react mobx和react结合的模块。react和mobx是一个强强联合</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:50c5bf12-8214-49d3-8dfc-4e79763f0077" class="outline-4">
<h4 id="h:50c5bf12-8214-49d3-8dfc-4e79763f0077">babel配置</h4>
<div class="outline-text-4" id="text-h:50c5bf12-8214-49d3-8dfc-4e79763f0077">
<p>
.babelrc babel转译的配置文件
</p>

<div class="org-src-container">
<pre class="src src-js">{
  <span style="color: #8b2252;">"presets"</span>: [
    <span style="color: #8b2252;">"react"</span>,
    <span style="color: #8b2252;">"env"</span>,
    <span style="color: #8b2252;">"stage-0"</span>
  ],
  <span style="color: #8b2252;">"plugins"</span>: [
    <span style="color: #8b2252;">"transform-decorators-legacy"</span>, 
    <span style="color: #8b2252;">"transform-runtime"</span>,
    <span style="color: #8b2252;">"react-hot-loader/babel"</span>
  ]
}
</pre>
</div>
</div>
</div>
<div id="outline-container-h:f16a60ec-1cfc-4d02-b521-e2fb6bc95523" class="outline-4">
<h4 id="h:f16a60ec-1cfc-4d02-b521-e2fb6bc95523">webpack配置</h4>
<div class="outline-text-4" id="text-h:f16a60ec-1cfc-4d02-b521-e2fb6bc95523">
<p>
webpack-react: <a href="https://webpack.js.org/awesome-webpack/#react">https://webpack.js.org/awesome-webpack/#react</a>
</p>
</div>
<div id="outline-container-h:8219a6b4-0337-453b-ad8a-0c3f996d1161" class="outline-5">
<h5 id="h:8219a6b4-0337-453b-ad8a-0c3f996d1161">webpack.config.dev.js</h5>
<div class="outline-text-5" id="text-h:8219a6b4-0337-453b-ad8a-0c3f996d1161">
<p>
这是一个符合Commonjs的模块
</p>

<p>
module.exports 导出
</p>

<ul class="org-ul">
<li><p>
devtool:'source-map'
</p>

<p>
生成及如何生成source-map文件。
</p>

<p>
source-map适合生成环境使用，会生成完成Sourcemap独立文件。
</p>

<p>
由于在Bundle中添加了引用注释，所以开发工具知道如何找到Sourcemap。
</p></li>

<li><p>
entry入口
</p>

<p>
描述入口。webpack会从入口开始，找出直接或间接的模块和库构建依赖树，最后输出为bundles文件中。
</p>

<p>
entry如果是一个字符串，定义就是入口文件
</p>

<p>
如果是一个数组，数组中最后一项是入口文件，其他项先加载，可以配置的热加载插件来自己刷新页面。
</p>

<p>
如果是一个对象，可以支持多入口。也可是函数，返回以上的字符串或数组或对象，好处是动态生成。
</p></li>

<li><p>
output输出
</p>

<p>
告诉webpack输出bundles到哪里去，如何命名。
</p>

<p>
filename定义输出的bundle的名称
</p>

<p>
path 输出目录是 __dirname+'dist' ，名字叫做 bundle.js 。 __dirname 是nodejs中获取当前js文件所在的目录名
</p>

<p>
publicPath 可以是绝对路径或者相对路径，一般会以/结尾。/assets/表示网站根目录下assets目录下
</p></li>

<li><p>
resolve解析
</p>

<p>
设置模块如何被解析。
</p>

<p>
extensions 自动解析扩展名。'.js'的意思是，如果用户导入模块的时候不带扩展名，它尝试补全
</p></li>

<li><p>
module 模块
</p>

<p>
如何处理不同的模块
</p>

<p>
rules 匹配请求的规则，以应用不同的加载器、解析器等
</p></li>
</ul>


<div class="org-src-container">
<pre class="src src-js">module: {
    rules: [
        {
            test: <span style="color: #8b2252;">/\.js$/</span>,
            exclude: <span style="color: #8b2252;">/node_modules/</span>,
            use: [
                { loader: <span style="color: #8b2252;">'babel-loader'</span> }
            ]
        }, {
            test: <span style="color: #8b2252;">/\.css$/</span>,
            use: [
                { loader: <span style="color: #8b2252;">"style-loader"</span> },
                { loader: <span style="color: #8b2252;">"css-loader"</span> },
            ]
         }, 
         {
            test: <span style="color: #8b2252;">/\.less$/</span>,
            use: [
                 { loader: <span style="color: #8b2252;">"style-loader"</span> },
                 { loader: <span style="color: #8b2252;">"css-loader"</span> },
                 { loader: <span style="color: #8b2252;">"less-loader"</span> }
            ]
        }
    ]
},
</pre>
</div>

<p>
test 匹配条件的
</p>

<pre class="example" id="org81bc887">
exclude 排除的， /node_modules/打包排除目录。这一句一定要有，否则，编
译就把这个目录下所有文件也拿进来了，巨大无比。

use 使用模块的UseEntries列表中的loader

rules中对.js结尾的但不在node_modules目录的文件使用转译babel-loader
</pre>

<p>
加载器：倒着写，先应用数组中的最后一个
</p>

<pre class="example" id="orgc739c24">
style-loader通过 &lt;style&gt; 标签把css添加到DOM中
css-loader 加载css
less-loader 对less的支持
</pre>

<p>
<b>LESS</b>
</p>

<p>
CSS好处简单易学，但是坏处是没有模块化、复用的概念，因为它不是语言。
</p>

<p>
LESS是一门CSS的预处理语言，扩展了CSS，增加了变量、Mixin、函数等开发语言的特性，从而简化了CSS的编写。
</p>

<p>
LESS本身是一套语法规则及解析器，将写好的LESS解析成CSS。LESS可以使用在浏览器端和服务器端。
</p>

<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-css"><span style="color: #b22222;">/*</span><span style="color: #b22222;">test.less</span><span style="color: #b22222;">*/</span>
<span style="color: #483d8b;">@color</span>: <span style="color: #ffffff; background-color: #4D926F;">#4D926F</span>; 

<span style="color: #0000ff;">#header</span> { 
     <span style="color: #a020f0;">color</span>: <span style="color: #483d8b;">@color</span>; 
} 
<span style="color: #0000ff;">h2</span> { 
    <span style="color: #a020f0;">color</span>: <span style="color: #483d8b;">@color</span>; 
}
</pre>
</div>

<p>
可以使用解析成如下的CSS
</p>
<div class="org-src-container">
<pre class="src src-sh">PS D:\project\pyproj\trae\react-mobx-starter-master&gt; ./node_modules/.bin/lessc test.less       
<span style="color: #b22222;">#</span><span style="color: #b22222;">header {</span>
  color: <span style="color: #b22222;">#</span><span style="color: #b22222;">4D926F;</span>
}
h2 {
  color: <span style="color: #b22222;">#</span><span style="color: #b22222;">4D926F;</span>
}
</pre>
</div>

<p>
LESS在服务器端使用，需要使用LESS编译器， $ npm install less ，本项目目录已经安装过了
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#32534;&#35793;&#36755;&#20986;&#21040;&#25511;&#21046;&#21488;</span>
node_modules/.bin/lessc test.less
npx lessc test.less

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#32534;&#35793;&#36755;&#20986;&#21040;&#25991;&#20214;</span>
node_modules/.bin/lessc test.less test.css
npx lessc test.less test.css
</pre>
</div>

<p>
<b>plugins：webpack的插件</b>
</p>

<div class="org-src-container">
<pre class="src src-js">plugins: [
        <span style="color: #a020f0;">new</span> <span style="color: #228b22;">webpack.optimize.OccurrenceOrderPlugin</span>(<span style="color: #008b8b;">true</span>),
        <span style="color: #a020f0;">new</span> <span style="color: #228b22;">webpack.HotModuleReplacementPlugin</span>(),
        <span style="color: #a020f0;">new</span> <span style="color: #228b22;">webpack.DefinePlugin</span>({<span style="color: #8b2252;">'process.env'</span>: {NODE_ENV: JSON.stringify(<span style="color: #8b2252;">'development'</span>)}})
</pre>
</div>

<ul class="org-ul">
<li>HotModuleReplacementPlugin 开启HMR</li>
<li>DefinePlugin 全局常量配置</li>
</ul>

<p>
devServer，开发用server
</p>

<div class="org-src-container">
<pre class="src src-js">devServer: {
     compress: <span style="color: #008b8b;">true</span>,
     port: 3000,
     publicPath: <span style="color: #8b2252;">'/assets/'</span>,
     hot: <span style="color: #008b8b;">true</span>,
     inline: <span style="color: #008b8b;">true</span>,
     historyApiFallback: <span style="color: #008b8b;">true</span>,
     stats: {
        chunks: <span style="color: #008b8b;">false</span>
     },
     proxy: {
         <span style="color: #8b2252;">'/api'</span>: {
             target: <span style="color: #8b2252;">'http://127.0.0.1:8000'</span>,
             changeOrigin: <span style="color: #008b8b;">true</span>,
             pathRewrite: {<span style="color: #8b2252;">'^/api'</span>:<span style="color: #8b2252;">''</span>}
        }
    }
}
</pre>
</div>

<pre class="example" id="orgcb45959">
compress 启动gzip
port 启动端口3000
hot 启用HMR
proxy指定访问/api 开头URL都代理到 http://127.0.0.1:8000 去
</pre>
</div>
</div>
</div>
<div id="outline-container-h:261941f1-01ae-4538-a3e3-3464508cda47" class="outline-4">
<h4 id="h:261941f1-01ae-4538-a3e3-3464508cda47">vscode配置</h4>
<div class="outline-text-4" id="text-h:261941f1-01ae-4538-a3e3-3464508cda47">
<p>
jsconfig.json是vscode的配置文件，覆盖当前配置
</p>

<p>
以上是所有配置文件的解释。拿到这个文件夹后，需要修改name项目名称、
version版本、description描述，需要修改repository仓库地址，需要修改
author作者、license许可证信息。这些信息修改好之后，就可以开始开发了。
</p>
</div>
</div>
</div>
<div id="outline-container-h:154d9e8c-2715-49e1-a6e1-179f0a5a4cfa" class="outline-3">
<h3 id="h:154d9e8c-2715-49e1-a6e1-179f0a5a4cfa">启动项目</h3>
<div class="outline-text-3" id="text-h:154d9e8c-2715-49e1-a6e1-179f0a5a4cfa">
<p>
在项目根目录，使用
</p>
<div class="org-src-container">
<pre class="src src-sh">$ npm run start &#25110; npm start

<span style="color: #b22222;">#</span><span style="color: #b22222;">package.json  start&#28909;&#21152;&#36733;&#36873;&#39033;--hot   --open &#33258;&#21160;&#25171;&#24320;&#27983;&#35272;&#22120;</span>
  <span style="color: #8b2252;">"scripts"</span>: {
    <span style="color: #8b2252;">"test"</span>: <span style="color: #8b2252;">"jest"</span>,
    <span style="color: #8b2252;">"start"</span>: <span style="color: #8b2252;">"webpack-dev-server --config webpack.config.dev.js --hot --inline --open"</span>,
    <span style="color: #8b2252;">"build"</span>: <span style="color: #8b2252;">"webpack -p --config webpack.config.prod.js"</span>
  },
</pre>
</div>

<p>
启动成功应该就可以访问了.
</p>

<p>
webpack使用babel转译、打包，较为耗时，需要等一会儿
</p>
</div>
</div>
</section>
<section id="outline-container-h:475cc518-6293-441a-8315-fcdbfd8eb82a" class="outline-2">
<h2 id="h:475cc518-6293-441a-8315-fcdbfd8eb82a">React技术</h2>
<div class="outline-text-2" id="text-h:475cc518-6293-441a-8315-fcdbfd8eb82a">
</div>
<div id="outline-container-h:cde2f5cb-f82a-4ded-8475-4b3ef8d7cb23" class="outline-3">
<h3 id="h:cde2f5cb-f82a-4ded-8475-4b3ef8d7cb23">简介</h3>
<div class="outline-text-3" id="text-h:cde2f5cb-f82a-4ded-8475-4b3ef8d7cb23">
<p>
React是Facebook开发并开源的前端框架。
</p>

<p>
当时他们的团队在市面上没有找到合适的MVC框架，就自己写了一个Js框架，用来架设Instagram（图片分享社交网络）。2013年React开源。
</p>

<p>
React解决的是前端MVC框架中的View视图层的问题。
</p>
</div>
<div id="outline-container-h:788d552b-1e2f-461b-8b71-1c697467cbc8" class="outline-4">
<h4 id="h:788d552b-1e2f-461b-8b71-1c697467cbc8">Virtual DOM</h4>
<div class="outline-text-4" id="text-h:788d552b-1e2f-461b-8b71-1c697467cbc8">
<p>
DOM（文档对象模型Document Object Model）
</p>


<figure id="orgabc0869">
<img src="./images/img_20250513_212850.png" alt="img_20250513_212850.png" width="50%">

</figure>


<p>
将网页内所有内容映射到一棵树型结构的层级对象模型上，浏览器提供对DOM的
支持，用户可以是用脚本调用DOM API来动态的修改DOM结点，从而达到修改网页
的目的，这种修改是浏览器中完成，浏览器会根据DOM的改变重绘改变的DOM结点
部分。
</p>

<p>
修改DOM重新渲染代价太高，前端框架为了提高效率，尽量减少DOM的重绘，提出
了Virtual DOM。Virtual DOM是一个JavaScript对象，性能更高。所有的修改都
是先生成一个新的Virtual DOM，通过比较算法比较新旧Virtual DOM，得到差异
化VirtualDOM，将这部分差异更新到浏览器DOM，浏览器只需要渲染这部分变化
就行了。
</p>

<p>
React实现了DOM Diff算法可以高效比对Virtual DOM
</p>
</div>
</div>
<div id="outline-container-h:4e7cd2f0-8325-4578-92bd-001d6a6494dc" class="outline-4">
<h4 id="h:4e7cd2f0-8325-4578-92bd-001d6a6494dc">支持JSX语法</h4>
<div class="outline-text-4" id="text-h:4e7cd2f0-8325-4578-92bd-001d6a6494dc">
<p>
JSX是一种JavaScript和XML混写的语法，是JavaScript的扩展
</p>

<div class="org-src-container">
<pre class="src src-js">React.render(
    &lt;div&gt; 
        &lt;div&gt; 
            &lt;div&gt;content&lt;/div&gt; 
        &lt;/div&gt; 
    &lt;/div&gt;, 
    document.getElementById(<span style="color: #8b2252;">'example'</span>)
);
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:9e2e3ddb-61c5-4071-91fc-07ab02fcb1e5" class="outline-3">
<h3 id="h:9e2e3ddb-61c5-4071-91fc-07ab02fcb1e5">测试程序</h3>
<div class="outline-text-3" id="text-h:9e2e3ddb-61c5-4071-91fc-07ab02fcb1e5">
<p>
替换 /src/index.js 为下面的代码
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component { 
    render() {
        <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">Hello World</span>&lt;/<span style="color: #0000ff;">div</span>&gt;;
    }
}

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span>/&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>

<p>
保存文件后，会自动编译，并重新装载刷新浏览器端页面
</p>
</div>
<div id="outline-container-h:513ec94d-6b4a-47a6-9f02-9774a8583a0f" class="outline-4">
<h4 id="h:513ec94d-6b4a-47a6-9f02-9774a8583a0f">程序解释</h4>
<div class="outline-text-4" id="text-h:513ec94d-6b4a-47a6-9f02-9774a8583a0f">
<p>
import React from 'react'; 导入react模块。
</p>

<p>
import ReactDOM from 'react-dom'; 导入react的DOM模块。
</p>


<p>
class Root extends React.Component 组件类定义，从React.Component类上继承。这个类生成JSXElement对象即React元素
render() 渲染函数。返回组件中渲染的内容。注意，只能返回唯一 一个顶级元素回去。
</p>

<p>
ReactDom.render(&lt;Root/&gt;, document.getElementById('root')); 第一个参数是JSXElement对象，第二个是DOM的Element元素。将React元素添加到DOM的Element元素中并渲染。
</p>

<p>
还可以使用React.createElement创建react元素，第一参数是React组件或者一个HTML的标签名称（例如div、span）。
</p>

<p>
改写后代码为
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;
<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
  render() {
    <span style="color: #b22222;">//</span><span style="color: #b22222;">return &lt;div&gt;Hello World&lt;/div&gt;;</span>
    <span style="color: #a020f0;">return</span> React.createElement(<span style="color: #8b2252;">'div'</span>, <span style="color: #008b8b;">null</span>, <span style="color: #8b2252;">'Hello World'</span>);
  }
}
<span style="color: #b22222;">//</span><span style="color: #b22222;">ReactDom.render(&lt;Root/&gt;, document.getElementById('root'));</span>
ReactDom.render(React.createElement(Root), document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>

<p>
很明显JSX更简洁易懂，推荐使用JSX语法
</p>

<p>
增加一个子元素
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">class</span> SubEle <span style="color: #a020f0;">extends</span> React.Component {
  render() {
    <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">Sub content</span>&lt;/<span style="color: #0000ff;">div</span>&gt;;
  }
}

<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
  render() {
    <span style="color: #a020f0;">return</span> (
      &lt;<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;<span style="color: #0000ff;">h2</span>&gt;<span style="color: #000000; background-color: #ffffff;">Hello World</span>&lt;/<span style="color: #0000ff;">h2</span>&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;<span style="color: #0000ff;">br</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;<span style="color: #0000ff;">SubEle</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span> &gt;);
  }
}

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>


<p>
注意：
</p>
<ul class="org-ul">
<li>React组件的render函数return，只能是一个顶级元素</li>
<li>JSX语法是XML，要求所有元素必须闭合，注意 &lt;br /&gt; 不能写成 &lt;br&gt;</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:acbb7e3f-6f06-4d6e-b19a-dc8df3561f65" class="outline-3">
<h3 id="h:acbb7e3f-6f06-4d6e-b19a-dc8df3561f65">JSX规范</h3>
<div class="outline-text-3" id="text-h:acbb7e3f-6f06-4d6e-b19a-dc8df3561f65">
<p>
React快速入门：<a href="https://zh-hans.react.dev/learn">https://zh-hans.react.dev/learn</a>
</p>

<ul class="org-ul">
<li>约定标签中首字母小写就是html标记，首字母大写就是组件</li>
<li>要求严格的HTML标记，要求所有标签都必须闭合</li>
<li>br也应该写成 &lt;br /&gt; ，/前留一个空格</li>
<li>单行省略小括号，多行请使用小括号</li>
<li>元素有嵌套，建议多行，注意缩进</li>
<li>JSX表达式：表达式使用{}括起来，如果大括号内使用了引号，会当做字符串处理，例如 &lt;div&gt;{'2&gt;1?true:false'}&lt;/div&gt; 里面的表达式成了字符串</li>
</ul>
</div>
</div>
<div id="outline-container-h:7ef6fa73-f71b-49b0-8344-faeb4a6067c3" class="outline-3">
<h3 id="h:7ef6fa73-f71b-49b0-8344-faeb4a6067c3">组件状态state **</h3>
<div class="outline-text-3" id="text-h:7ef6fa73-f71b-49b0-8344-faeb4a6067c3">
<p>
每一个React组件都有一个状态属性state，它是一个JavaScript对象，可以为它定义属性来保存值。
</p>

<p>
如果状态变化了，会触发UI的重新渲染。使用setState()方法可以修改state值。
</p>

<p>
注意：state是每个组件自己内部使用的，是组件自己的属性。必须是state，不能是其它名字。
</p>

<p>
依然修改/src/index.js
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
  <span style="color: #b22222;">// </span><span style="color: #b22222;">&#23450;&#20041;&#19968;&#20010;state&#23545;&#35937;</span>
  state = {domain: <span style="color: #8b2252;">'cici.com'</span>, host: <span style="color: #8b2252;">'www'</span>} <span style="color: #b22222;">// </span><span style="color: #b22222;">&#26500;&#36896;&#20989;&#25968;&#20013;&#23450;&#20041;state </span>
  render() { <span style="color: #b22222;">// </span><span style="color: #b22222;">render &#29992;&#26469;&#21576;&#29616;state&#25110;props&#20540;</span>
    <span style="color: #b22222;">// </span><span style="color: #b22222;">this.state.host = 'python'; // &#21487;&#20197;&#20462;&#25913;&#23646;&#24615;&#20540;</span>
    <span style="color: #b22222;">// </span><span style="color: #b22222;">this.setState({host:'python'}); //&#19981;&#21487;&#23545;&#36824;&#22312;&#26356;&#26032;&#20013;&#30340;state&#20351;&#29992;setSate. state&#25913;&#21464;&#20250;&#32487;&#32493;&#24341;&#36215;render, &#36882;&#24402;&#20102;</span>
    <span style="color: #b22222;">//</span><span style="color: #b22222;">Warning: setState(...): Cannot update during an existing state transition (such as within `render` or another component's constructor).</span>
    setTimeout(()=&gt; <span style="color: #008b8b;">this</span>.setState({host:<span style="color: #008b8b;">this</span>.state.host + <span style="color: #8b2252;">'*'</span>}), 3000)
    console.log(<span style="color: #8b2252;">'Root render ~~~~'</span>)
    <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">      Welcome to </span>{<span style="color: #008b8b;">this</span>.state.host}<span style="color: #000000; background-color: #ffffff;">.</span>{<span style="color: #008b8b;">this</span>.state.domain}
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;/<span style="color: #0000ff;">div</span>&gt;
  }
}

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>


<p>
如果将 ·this.state.host = ‘python’· 改为 ·this.setState({host:'python'});· 就会出警告。
</p>

<p>
可以使用延时函数 setTimeout(() =&gt; this.setState({ host: 'python' }), 5000); 即可。
</p>

<p>
使用延时函数好吗？ 不好，一般不推荐这么做，但是它确实不递归。
</p>
</div>
<div id="outline-container-h:a3379f82-ab16-43e6-9aa5-f720a2c59163" class="outline-4">
<h4 id="h:a3379f82-ab16-43e6-9aa5-f720a2c59163">复杂的状态例子</h4>
<div class="outline-text-4" id="text-h:a3379f82-ab16-43e6-9aa5-f720a2c59163">
<p>
先看一个网页
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #0000ff;">html</span>&gt;
&lt;<span style="color: #0000ff;">head</span>&gt;
    &lt;<span style="color: #0000ff;">script</span> <span style="color: #a0522d;">type</span>=<span style="color: #8b2252;">"text/javascript"</span>&gt;
        function getEventTrigger(e) {
            x = e.target; // &#20174;&#20107;&#20214;&#20013;&#33719;&#21462;&#20803;&#32032;
            alert("&#35302;&#21457;&#30340;&#20803;&#32032;&#30340;id&#26159;&#65306;" + x.id);
        }
    &lt;/<span style="color: #0000ff;">script</span>&gt;
&lt;/<span style="color: #0000ff;">head</span>&gt;
&lt;<span style="color: #0000ff;">body</span>&gt;
    &lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"t1"</span> <span style="color: #a0522d;">onmousedown</span>=<span style="color: #8b2252;">"getEventTrigger(event)"</span>&gt;
        &#28857;&#20987;&#36825;&#21477;&#35805;&#65292;&#20250;&#35302;&#21457;&#19968;&#20010;&#20107;&#20214;&#65292;&#24182;&#24377;&#20986;&#19968;&#20010;&#35686;&#31034;&#26694;
    &lt;/<span style="color: #0000ff;">div</span>&gt;
&lt;/<span style="color: #0000ff;">body</span>&gt;
&lt;/<span style="color: #0000ff;">html</span>&gt;
</pre>
</div>

<p>
div的id是t1，鼠标按下事件捆绑了一个函数，只要鼠标在对象上按下就会触发调用getEventTrigger函数，浏览器会送给它一个参数event。event是事件对象，当事件触发时，event包含触发这个事件的对象
</p>
</div>
</div>
<div id="outline-container-h:fdd6bb5a-e2b5-4701-b0e9-6195a510de3b" class="outline-4">
<h4 id="h:fdd6bb5a-e2b5-4701-b0e9-6195a510de3b">HTML DOM的JavaScript事件</h4>
<div class="outline-text-4" id="text-h:fdd6bb5a-e2b5-4701-b0e9-6195a510de3b">
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">属性</th>
<th scope="col" class="org-left">此事件发生在何时</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">onabort</td>
<td class="org-left">图像的加载被中断</td>
</tr>

<tr>
<td class="org-left">onblur</td>
<td class="org-left">元素失去焦点</td>
</tr>

<tr>
<td class="org-left">onchange</td>
<td class="org-left">域的内容被改变</td>
</tr>

<tr>
<td class="org-left">onclick（常用）</td>
<td class="org-left">当用户点击某个对象时调用的事件句柄</td>
</tr>

<tr>
<td class="org-left">ondblclick</td>
<td class="org-left">当用户双击某个对象时调用的事件句柄</td>
</tr>

<tr>
<td class="org-left">onerror</td>
<td class="org-left">在加载文档或图像时发生错误</td>
</tr>

<tr>
<td class="org-left">onfocus</td>
<td class="org-left">元素获得焦点. 例如文本框中光标在里面时聚焦了</td>
</tr>

<tr>
<td class="org-left">onkeydown</td>
<td class="org-left">某个键盘按键被按下</td>
</tr>

<tr>
<td class="org-left">onkeypress</td>
<td class="org-left">某个键盘按键被按下并松开</td>
</tr>

<tr>
<td class="org-left">onkeyup</td>
<td class="org-left">某个键盘按键被松开</td>
</tr>

<tr>
<td class="org-left">onload</td>
<td class="org-left">一张页面或一幅图像完成加载</td>
</tr>

<tr>
<td class="org-left">onmousedown</td>
<td class="org-left">鼠标按钮被按下</td>
</tr>

<tr>
<td class="org-left">onmousemove</td>
<td class="org-left">鼠标被移动</td>
</tr>

<tr>
<td class="org-left">onmouseout</td>
<td class="org-left">鼠标从某元素移开</td>
</tr>

<tr>
<td class="org-left">onmouseover</td>
<td class="org-left">鼠标移到某元素之上</td>
</tr>

<tr>
<td class="org-left">onmouseup</td>
<td class="org-left">鼠标按键被松开</td>
</tr>

<tr>
<td class="org-left">onreset</td>
<td class="org-left">重置按钮被点击</td>
</tr>

<tr>
<td class="org-left">onresize</td>
<td class="org-left">窗口或框架被重新调整大小</td>
</tr>

<tr>
<td class="org-left">onselect</td>
<td class="org-left">文本被选中</td>
</tr>

<tr>
<td class="org-left">onsubmit</td>
<td class="org-left">确认按钮被点击</td>
</tr>

<tr>
<td class="org-left">onunload</td>
<td class="org-left">用户退出页面</td>
</tr>
</tbody>
</table>

<p>
使用React实现上面的传统的HTML
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;
<span style="color: #a020f0;">class</span> Toggle <span style="color: #a020f0;">extends</span> React.Component {

  state = { flag: <span style="color: #008b8b;">true</span> }; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#31867;&#20013;&#23450;&#20041;state </span>
  handleClick(event) {
    console.log(event.target.id);
    console.log(event.target === <span style="color: #008b8b;">this</span>);
    console.log(<span style="color: #008b8b;">this</span>);
    console.log(<span style="color: #008b8b;">this</span>.state);
    <span style="color: #008b8b;">this</span>.setState({ flag: !<span style="color: #008b8b;">this</span>.state.flag });
  }

  render() {<span style="color: #b22222;">/* </span><span style="color: #b22222;">&#27880;&#24847;&#19968;&#23450;&#35201;&#32465;&#23450;this onClick&#20889;&#25104;&#23567;&#39548;&#23792;</span><span style="color: #b22222;"> */</span>
    <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"t1"</span> <span style="color: #a0522d;">onClick</span>={<span style="color: #008b8b;">this</span>.handleClick.bind(<span style="color: #008b8b;">this</span>)}&gt;
<span style="color: #000000; background-color: #ffffff;">      &#28857;&#20987;&#36825;&#21477;&#35805;&#65292;&#20250;&#35302;&#21457;&#19968;&#20010;&#20107;&#20214;&#12290;</span>{<span style="color: #008b8b;">this</span>.state.flag.toString()}
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;;
  }
}
<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
  <span style="color: #b22222;">// </span><span style="color: #b22222;">&#23450;&#20041;&#19968;&#20010;&#23545;&#35937;</span>
  state = { p1: <span style="color: #8b2252;">'www.python'</span>, p2: <span style="color: #8b2252;">'.org'</span> }; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#26500;&#36896;&#20989;&#25968;&#20013;&#23450;&#20041;state </span>
  render() {
    <span style="color: #a020f0;">return</span> (
      &lt;<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">Welcome to </span>{<span style="color: #008b8b;">this</span>.state.p1}{<span style="color: #008b8b;">this</span>.state.p2}&lt;/<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">br</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">Toggle</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);
  }
}
ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>

<p>
Toggle类
</p>
<ul class="org-ul">
<li>它有自己的state属性，就给组件自身增加属性的。</li>
<li>当render完成后，网页上有一个div标签，div标签对象捆绑了一个click事件的处理函数</li>
<li>如果通过点击左键，就触发了click方法关联的handleClick函数，在这个函数里将状态值改变
<ul class="org-ul">
<li>使用this.state.flag = !this.state.flag 方式改变，不会触发render函数执行</li>
<li>使用this.setState({flag: !this.state.flag}) 方式，会触发该组件和其子组件render函数执行。</li>
</ul></li>
</ul>

<p>
注意
</p>
<ul class="org-ul">
<li>{this.handleClick.bind(this)}，不能外加引号</li>
<li>this.handleClick.bind(this) 一定要绑定this，否则当触发捆绑的函数时，this是函数执行的上下文决定的，this已经不是触发事件的对象。
或将handleClick定义为箭头函数也能解决this问题。</li>
<li>console.log(event.target.id)，取回的产生事件的对象的id，但是这不是我
们封装的组件对象。所以，console.log(event.target===this)是false。所
以这里一定要用this，而这个this是通过绑定来的</li>
<li>this写在类中，始终指的是React组件实例本身</li>
</ul>

<p>
React中的事件
</p>
<ul class="org-ul">
<li>使用小驼峰命名</li>
<li>使用JSX表达式，表达式中指定事件处理函数</li>
<li>不能使用return false，如果要阻止事件默认行为，使用event.preventDefault()</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:250d3c93-4e40-4ade-bbf4-2634d3244f2a" class="outline-3">
<h3 id="h:250d3c93-4e40-4ade-bbf4-2634d3244f2a">属性props</h3>
<div class="outline-text-3" id="text-h:250d3c93-4e40-4ade-bbf4-2634d3244f2a">
<p>
props就是组件的属性properties。
</p>

<p>
把React组件当做标签使用，可以为其增加属性，如下
</p>
<div class="org-src-container">
<pre class="src src-js">&lt;Toggle name=<span style="color: #8b2252;">"school"</span> parent={<span style="color: #008b8b;">this</span>} /&gt;
</pre>
</div>

<p>
为上面的Toggle元素增加属性：
</p>
<ul class="org-ul">
<li>name = "school" ，这个属性会作为一个单一的对象传递给组件，加入到组件的props属性中</li>
<li>parent = {this} ，注意这个this是在Root元素中，指的是Root组件本身。parent属性是我们自己添加的。</li>
<li>使用JSX语法为Toggle增加子元素，这些子元素也会被加入Toggle组件的props.children中。
如果要显示这些内容，就必须在Toggle组件中从props中提取出来。</li>
</ul>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">class</span> Toggle <span style="color: #a020f0;">extends</span> React.Component {
  state = { flag: <span style="color: #008b8b;">true</span> }; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#31867;&#20013;&#23450;&#20041;state </span>
  handleClick(event) {
    console.log(event.target.id);
    console.log(event.target === <span style="color: #008b8b;">this</span>);
    console.log(<span style="color: #008b8b;">this</span>);
    console.log(<span style="color: #008b8b;">this</span>.state);
    <span style="color: #008b8b;">this</span>.setState({ flag: !<span style="color: #008b8b;">this</span>.state.flag });
  }

  render() {<span style="color: #b22222;">/* </span><span style="color: #b22222;">&#27880;&#24847;&#19968;&#23450;&#35201;&#32465;&#23450;this onClick&#20889;&#25104;&#23567;&#39548;&#23792;</span><span style="color: #b22222;"> */</span>
    <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"t1"</span> <span style="color: #a0522d;">onClick</span>={<span style="color: #008b8b;">this</span>.handleClick.bind(<span style="color: #008b8b;">this</span>)}
      <span style="color: #a0522d;">style</span>={{backgroundColor:<span style="color: #8b2252;">'white'</span>, margin: <span style="color: #8b2252;">'10'</span> + <span style="color: #8b2252;">'px'</span>}}
    &gt;
<span style="color: #000000; background-color: #ffffff;">      &#28857;&#20987;&#36825;&#21477;&#35805;&#65292;&#20250;&#35302;&#21457;&#19968;&#20010;&#20107;&#20214;&#12290;</span>{<span style="color: #008b8b;">this</span>.state.flag.toString()}&lt;<span style="color: #0000ff;">br</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      &#26174;&#31034;props</span>&lt;<span style="color: #0000ff;">br</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>{<span style="color: #008b8b;">this</span>.props.name}<span style="color: #000000; background-color: #ffffff;"> : </span>{<span style="color: #008b8b;">this</span>.props.parent.state.p1}{<span style="color: #008b8b;">this</span>.props.parent.state.p2}
<span style="color: #000000; background-color: #ffffff;">      </span>{<span style="color: #008b8b;">this</span>.props.children}
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;;
  }
}

<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
  <span style="color: #b22222;">// </span><span style="color: #b22222;">&#23450;&#20041;&#19968;&#20010;&#23545;&#35937; </span>
  state = { p1: <span style="color: #8b2252;">'www.python'</span>, p2: <span style="color: #8b2252;">'.org'</span> }; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#26500;&#36896;&#20989;&#25968;&#20013;&#23450;&#20041;state</span>
  render() {
    <span style="color: #a020f0;">return</span> (
      &lt;<span style="color: #0000ff;">div</span>  <span style="color: #a0522d;">style</span>={{backgroundColor: <span style="color: #8b2252;">'#f0f0f0'</span>}}&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">Welcome to </span>{<span style="color: #008b8b;">this</span>.state.p1}{<span style="color: #008b8b;">this</span>.state.p2}&lt;/<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">br</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">Toggle</span> <span style="color: #a0522d;">name</span>=<span style="color: #8b2252;">"school"</span> <span style="color: #a0522d;">parent</span>={<span style="color: #008b8b;">this</span>}&gt;{<span style="color: #b22222;">/*</span><span style="color: #b22222;">&#33258;&#23450;&#20041;2&#20010;&#23646;&#24615;&#36890;&#36807;props&#20256;&#32473;Toggle&#32452;&#20214;&#23545;&#35937;</span><span style="color: #b22222;">*/</span>}
<span style="color: #000000; background-color: #ffffff;">          </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;{<span style="color: #b22222;">/*</span><span style="color: #b22222;">&#23376;&#20803;&#32032;&#36890;&#36807;props.children&#35775;&#38382;</span><span style="color: #b22222;">*/</span>}
<span style="color: #000000; background-color: #ffffff;">          </span>&lt;<span style="color: #0000ff;">span</span>&gt;<span style="color: #000000; background-color: #ffffff;">&#25105;&#26159;Toggle&#20803;&#32032;&#30340;&#23376;&#20803;&#32032;</span>&lt;/<span style="color: #0000ff;">span</span>&gt;{<span style="color: #b22222;">/*</span><span style="color: #b22222;">&#23376;&#20803;&#32032;&#36890;&#36807;props.children&#35775;&#38382;</span><span style="color: #b22222;">*/</span>}
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;/<span style="color: #0000ff;">Toggle</span>&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);
  }
}

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>


<p>
尝试修改props中的属性值，会抛出 TypeError: Cannot assign to read only property 'name' of object '#&lt;Object&gt;'异常。也就是说props在组件内部不能修改，只读。
</p>

<p>
范例：复杂点的
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">class</span> Sub <span style="color: #a020f0;">extends</span> React.Component {
  render() {<span style="color: #b22222;">// </span><span style="color: #b22222;">render &#29992;&#26469;&#21576;&#29616;state&#25110;props&#20540;</span>
    <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">sub content ++++</span>&lt;/<span style="color: #0000ff;">div</span>&gt;
  }
}

<span style="color: #a020f0;">class</span> Toggle <span style="color: #a020f0;">extends</span> React.Component {
  state = { flag: <span style="color: #008b8b;">true</span> }; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#31867;&#20013;&#23450;&#20041;state </span>

  handleClick(e) {
    console.log(<span style="color: #8b2252;">'toggle handle click ~~~~'</span>)
    <span style="color: #b22222;">// </span><span style="color: #b22222;">e.preventDefault(); // &#38459;&#27490;&#40664;&#35748;&#20107;&#20214;</span>
    <span style="color: #b22222;">// </span><span style="color: #b22222;">console.log(e.target);</span>
    <span style="color: #b22222;">// </span><span style="color: #b22222;">console.log(e.target.id);</span>
    <span style="color: #b22222;">// </span><span style="color: #b22222;">console.log(this) //this &#30340;&#22353;</span>
    <span style="color: #008b8b;">this</span>.setState({ flag: !<span style="color: #008b8b;">this</span>.state.flag });
    <span style="color: #008b8b;">this</span>.props.parent.setState({host: <span style="color: #008b8b;">this</span>.props.parent.state.host + <span style="color: #8b2252;">'@'</span>})
  }

  render() {<span style="color: #b22222;">// </span><span style="color: #b22222;">render &#29992;&#26469;&#21576;&#29616;state&#25110;props&#20540;</span>
    console.log(<span style="color: #8b2252;">'Toggle render ~~~~'</span>)
    console.log(<span style="color: #008b8b;">this</span>.state, <span style="color: #008b8b;">this</span>.props)
    <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"toggle"</span> <span style="color: #a0522d;">onClick</span>={<span style="color: #008b8b;">this</span>.handleClick.bind(<span style="color: #008b8b;">this</span>)}
      <span style="color: #a0522d;">style</span>={{backgroundColor:<span style="color: #8b2252;">'white'</span>, margin: <span style="color: #8b2252;">'10'</span> + <span style="color: #8b2252;">'px'</span>}}
    &gt;
<span style="color: #000000; background-color: #ffffff;">      &#25105;&#26159;&#23376;&#32452;&#20214;Toggle. Flag = </span>{<span style="color: #008b8b;">this</span>.state.flag.toString()}
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      &#23376;&#32452;&#20214;&#21306;&#22495;&#26174;&#31034;props = </span>{<span style="color: #008b8b;">this</span>.props.school}<span style="color: #000000; background-color: #ffffff;"> - </span>{<span style="color: #008b8b;">this</span>.props.parent.state.host}
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">style</span>={{width:<span style="color: #8b2252;">'80%'</span>, border:<span style="color: #8b2252;">'1px solid red'</span>}}&gt;
<span style="color: #000000; background-color: #ffffff;">        Toggle&#30340;&#23376;&#20803;&#32032;&#26174;&#31034;&#21306;&#22495;: </span>{<span style="color: #008b8b;">this</span>.props.children}
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;/<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;
  }
}

<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
  state = { domain: <span style="color: #8b2252;">'cici.com'</span>, host: <span style="color: #8b2252;">'www'</span> }; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#26500;&#36896;&#20989;&#25968;&#20013;&#23450;&#20041;state</span>

  handleClick(e) {
    console.log(<span style="color: #8b2252;">'root click'</span>)
    <span style="color: #008b8b;">this</span>.setState({host:<span style="color: #008b8b;">this</span>.state.host + <span style="color: #8b2252;">'*'</span>})
  }
  render() {
    console.log(<span style="color: #8b2252;">'Root render ++++'</span>)
    <span style="color: #a020f0;">return</span> (
      &lt;<span style="color: #0000ff;">div</span>  <span style="color: #a0522d;">style</span>={{backgroundColor: <span style="color: #8b2252;">'#f0f0f0'</span>}} 
      <span style="color: #a0522d;">onDoubleClick</span>={<span style="color: #008b8b;">this</span>.handleClick.bind(<span style="color: #008b8b;">this</span>)}&gt;
<span style="color: #000000; background-color: #ffffff;">        Welcome to </span>{<span style="color: #008b8b;">this</span>.state.host}<span style="color: #000000; background-color: #ffffff;">.</span>{<span style="color: #008b8b;">this</span>.state.domain}
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">Toggle</span> <span style="color: #a0522d;">school</span>=<span style="color: #8b2252;">'python'</span> <span style="color: #a0522d;">parent</span>={<span style="color: #008b8b;">this</span>}&gt;
<span style="color: #000000; background-color: #ffffff;">          </span>&lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">toggle&#30340;&#23376;&#20803;&#32032;</span>
<span style="color: #000000; background-color: #ffffff;">            </span>&lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">cell</span>&lt;/<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">          </span>&lt;/<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">          </span>&lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">&#31532;&#20108;&#20010;&#23376;&#20803;&#32032;</span>
<span style="color: #000000; background-color: #ffffff;">            </span>&lt;<span style="color: #0000ff;">Sub</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">          </span>&lt;/<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;/<span style="color: #0000ff;">Toggle</span>&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);
  }
}

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>
</div>
</div>
<div id="outline-container-h:8ce34831-173d-47cb-82ac-159709a552df" class="outline-3">
<h3 id="h:8ce34831-173d-47cb-82ac-159709a552df">单向数据流</h3>
<div class="outline-text-3" id="text-h:8ce34831-173d-47cb-82ac-159709a552df">
<ul class="org-ul">
<li>state是私有private的属于组件自己的属性，组件外无法直接访问。可以修改state，但是建议使用setState方法。</li>
<li>props是公有public属性，组件外也可以访问，但组件内只读。</li>
<li>props是一种组件外部传入向组件内部传入数据的一种方式，只不过采用标签属性的方式。</li>
<li>在React中，数据只能由外层通过props传递给内层。这种称为单向数据流Single Data Flow。</li>
</ul>
</div>
</div>
<div id="outline-container-h:cb17f0b3-0c0b-486f-8f7c-8dbe43d45b03" class="outline-3">
<h3 id="h:cb17f0b3-0c0b-486f-8f7c-8dbe43d45b03">构造器constructor</h3>
<div class="outline-text-3" id="text-h:cb17f0b3-0c0b-486f-8f7c-8dbe43d45b03">
<p>
使用ES6的构造器，要提供一个参数props，并把这个参数使用super传递给父类
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;
<span style="color: #a020f0;">class</span> Toggle <span style="color: #a020f0;">extends</span> React.Component {
  <span style="color: #b22222;">//</span><span style="color: #b22222;">state = { flag: true }; // &#31867;&#20013;&#23450;&#20041;state</span>
  constructor(props) {
    <span style="color: #a020f0;">super</span>(props); <span style="color: #b22222;">// </span><span style="color: #b22222;">&#19968;&#23450;&#35201;&#35843;&#29992;super&#29238;&#31867;&#26500;&#36896;&#22120;&#65292;&#21542;&#21017;&#25253;&#38169;</span>
    <span style="color: #008b8b;">this</span>.state = { flag: <span style="color: #008b8b;">true</span> }; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#31867;&#20013;&#23450;&#20041;state</span>
  }

  handleClick(event) {
    console.log(event.target.id);
    console.log(event.target === <span style="color: #008b8b;">this</span>);
    console.log(<span style="color: #008b8b;">this</span>);
    console.log(<span style="color: #008b8b;">this</span>.state);
    <span style="color: #008b8b;">this</span>.setState({ flag: !<span style="color: #008b8b;">this</span>.state.flag });
  }

  render() {<span style="color: #b22222;">/* </span><span style="color: #b22222;">&#27880;&#24847;&#19968;&#23450;&#35201;&#32465;&#23450;this onClick&#20889;&#25104;&#23567;&#39548;&#23792;</span><span style="color: #b22222;"> */</span>
    <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"t1"</span> <span style="color: #a0522d;">onClick</span>={<span style="color: #008b8b;">this</span>.handleClick.bind(<span style="color: #008b8b;">this</span>)}&gt;
<span style="color: #000000; background-color: #ffffff;">      &#28857;&#20987;&#36825;&#21477;&#35805;&#65292;&#20250;&#35302;&#21457;&#19968;&#20010;&#20107;&#20214;&#12290;</span>{<span style="color: #008b8b;">this</span>.state.flag.toString()}&lt;<span style="color: #0000ff;">br</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      &#26174;&#31034;props</span>&lt;<span style="color: #0000ff;">br</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>{<span style="color: #008b8b;">this</span>.props.name}<span style="color: #000000; background-color: #ffffff;"> : </span>{<span style="color: #008b8b;">this</span>.props.parent.state.p1}{<span style="color: #008b8b;">this</span>.props.parent.state.p2}
<span style="color: #000000; background-color: #ffffff;">      </span>{<span style="color: #008b8b;">this</span>.props.children}
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;;
  }
}

<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
  <span style="color: #b22222;">// </span><span style="color: #b22222;">&#23450;&#20041;&#19968;&#20010;&#23545;&#35937; </span>
  state = { p1: <span style="color: #8b2252;">'www.python'</span>, p2: <span style="color: #8b2252;">'.org'</span> }; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#26500;&#36896;&#20989;&#25968;&#20013;&#23450;&#20041;state </span>

  render() {
    <span style="color: #a020f0;">return</span> (
      &lt;<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">Welcome to </span>{<span style="color: #008b8b;">this</span>.state.p1}{<span style="color: #008b8b;">this</span>.state.p2}&lt;/<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">br</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">Toggle</span> <span style="color: #a0522d;">name</span>=<span style="color: #8b2252;">"school"</span> <span style="color: #a0522d;">parent</span>={<span style="color: #008b8b;">this</span>}&gt;{<span style="color: #b22222;">/*</span><span style="color: #b22222;">&#33258;&#23450;&#20041;2&#20010;&#23646;&#24615;&#36890;&#36807;props&#20256;&#32473;Toggle&#32452;&#20214;&#23545;&#35937;</span><span style="color: #b22222;">*/</span>}
<span style="color: #000000; background-color: #ffffff;">          </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;{<span style="color: #b22222;">/*</span><span style="color: #b22222;">&#23376;&#20803;&#32032;&#36890;&#36807;props.children&#35775;&#38382;</span><span style="color: #b22222;">*/</span>}
<span style="color: #000000; background-color: #ffffff;">          </span>&lt;<span style="color: #0000ff;">span</span>&gt;<span style="color: #000000; background-color: #ffffff;">&#25105;&#26159;Toggle&#20803;&#32032;&#30340;&#23376;&#20803;&#32032;</span>&lt;/<span style="color: #0000ff;">span</span>&gt;{<span style="color: #b22222;">/*</span><span style="color: #b22222;">&#23376;&#20803;&#32032;&#36890;&#36807;props.children&#35775;&#38382;</span><span style="color: #b22222;">*/</span>}
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;/<span style="color: #0000ff;">Toggle</span>&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);
  }
}
ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>
</div>
</div>
<div id="outline-container-h:0164d06c-7b64-4ea8-afd1-6e4fdb8d5140" class="outline-3">
<h3 id="h:0164d06c-7b64-4ea8-afd1-6e4fdb8d5140">组件的生命周期</h3>
<div class="outline-text-3" id="text-h:0164d06c-7b64-4ea8-afd1-6e4fdb8d5140">
<p>
组件的生命周期可分成三个状态：
</p>
<ul class="org-ul">
<li>Mounting：已插入真实 DOM</li>
<li>Updating：正在被重新渲染</li>
<li>Unmounting：已移出真实 DOM</li>
</ul>

<p>
组件的生命周期状态，说明在不同时机访问组件，组件正处在生命周期的不同状态上。
</p>

<p>
在不同的生命周期状态访问，就产生不同的方法。
</p>

<p>
生命周期的方法如下：
</p>
<ul class="org-ul">
<li>装载组件触发
<ul class="org-ul">
<li>componentWillMount 在渲染前调用，只会在装载之前调用一次。此方法在V17即将过期。建议在constructor中初始化state。</li>
<li>componentDidMount : 在第一次渲染后调用，只在客户端。之后组件已经生
成了对应的DOM结构，可以通过this.getDOMNode()来进行访问。 如果你想
和其他JavaScript框架一起使用，可以在这个方法中调用setTimeout,
setInterval或者发送A JAX请求等操作(防止异部操作阻塞UI)。只在装载完
成后调用一次，在render之后。</li>
</ul></li>

<li>更新组件触发。这些方法不会在首次render组件的周期调用
<ul class="org-ul">
<li>componentWillReceiveProps(nextProps) 在组件接收到一个新的prop时被调用。这个方法在初始化render时不会被调用。在V17中也即将过期。</li>
<li>shouldComponentUpdate(nextProps,nextState)返回一个布尔值。在组件接收到新的props或者state时被调用。在初始化时或者使用forceUpdate时不被调用。
<ul class="org-ul">
<li>可以在你确认不需要更新组件时使用</li>
<li>如果设置为false，就是不允许更新组件，那么componentWillUpdate、componentDidUpdate不会执行</li>
</ul></li>
<li>componentWillUpdate(nextProps, nextState) 在组件接收到新的props或者state但还没有render时被调用。在初始化时不会被调用。在V17中也即将过期。</li>
<li>componentDidUpdate(prevProps, prevState) 在组件完成更新后立即调用。在初始化时不会被调用。</li>
</ul></li>

<li>卸载组件触发
<ul class="org-ul">
<li>componentWillUnmount在组件从 DOM 中移除的时候立刻被调用</li>
</ul></li>
</ul>



<figure id="org2a45e20">
<img src="./images/img_20250515_160508.png" alt="img_20250515_160508.png" width="50%">

</figure>

<p>
由图可知
constructor构造器是最早执行的函数
</p>

<p>
组件构建好之后，如果更新组件的state或props（注意在组件内props是只读的），就会在render渲染前触发一系列的 更新生命周期函数
</p>

<p>
因此，重新编写/src/index.js
构造两个组件，在子组件Sub中，加入所有生命周期函数
</p>

<p>
下面的例子添加是装载、卸载组件的生命周期函数
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">class</span> Sub <span style="color: #a020f0;">extends</span> React.Component {
  constructor(props) {
    console.log(<span style="color: #8b2252;">'Sub constructor'</span>)
    <span style="color: #a020f0;">super</span>(props); <span style="color: #b22222;">// </span><span style="color: #b22222;">&#35843;&#29992;&#29238;&#31867;&#26500;&#36896;&#22120;   </span>
    <span style="color: #008b8b;">this</span>.state = { count: 0 };
  }

  handleClick(event) {
    <span style="color: #008b8b;">this</span>.setState({ count: <span style="color: #008b8b;">this</span>.state.count + 1 });
  }

  render() {
    console.log(<span style="color: #8b2252;">'Sub render'</span>);
    <span style="color: #a020f0;">return</span> (&lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"sub"</span> <span style="color: #a0522d;">onClick</span>={<span style="color: #008b8b;">this</span>.handleClick.bind(<span style="color: #008b8b;">this</span>)}&gt;
<span style="color: #000000; background-color: #ffffff;">      Sub's count = </span>{<span style="color: #008b8b;">this</span>.state.count}
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);
  }

  componentWillMount() {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">constructor&#20043;&#21518;&#65292;&#31532;&#19968;&#27425;render&#20043;&#21069;  </span>
    console.log(<span style="color: #8b2252;">'Sub componentWillMount'</span>);
  }

  componentDidMount() {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#31532;&#19968;&#27425;render&#20043;&#21518;  </span>
    console.log(<span style="color: #8b2252;">'Sub componentDidMount'</span>);
  }

  componentWillUnmount() {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#28165;&#29702;&#24037;&#20316;  </span>
    console.log(<span style="color: #8b2252;">'Sub componentWillUnmount'</span>);
  }
}

<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
  constructor(props) {
    console.log(<span style="color: #8b2252;">'Root Constructor'</span>)
    <span style="color: #a020f0;">super</span>(props); <span style="color: #b22222;">// </span><span style="color: #b22222;">&#35843;&#29992;&#29238;&#31867;&#26500;&#36896;&#22120;</span>
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#23450;&#20041;&#19968;&#20010;&#23545;&#35937;</span>
    <span style="color: #008b8b;">this</span>.state = {};
  }

  render() {
    <span style="color: #a020f0;">return</span> (
      &lt;<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">Sub</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);
  }
}

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));  
</pre>
</div>


<p>
上面可以看到顺序是
</p>

<p>
constructor -&gt; componentWillMount -&gt; render -&gt; componentDidMount -&#x2014;state或props改变-&#x2014;&gt; render
</p>

<p>
增加 更新组件函数
</p>

<p>
为了演示props的改变，为Root元素增加一个click事件处理函数
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">class</span> Sub <span style="color: #a020f0;">extends</span> React.Component {
  constructor(props) {
    console.log(<span style="color: #8b2252;">'Sub constructor'</span>)
    <span style="color: #a020f0;">super</span>(props); <span style="color: #b22222;">// </span><span style="color: #b22222;">&#35843;&#29992;&#29238;&#31867;&#26500;&#36896;&#22120;</span>
    <span style="color: #008b8b;">this</span>.state = { count: 0 };
  }

  handleClick(event) {
    <span style="color: #008b8b;">this</span>.setState({ count: <span style="color: #008b8b;">this</span>.state.count + 1 });<span style="color: #b22222;">// </span><span style="color: #b22222;">&#19981;&#35201;&#29992;++</span>
  }
  render() {
    console.log(<span style="color: #8b2252;">'Sub render'</span>);
    <span style="color: #a020f0;">return</span> (&lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">style</span>={{
      height: 200 + <span style="color: #8b2252;">'px'</span>, color: <span style="color: #8b2252;">'red'</span>, backgroundColor: <span style="color: #8b2252;">'#f0f0f0'</span>,
      padding: <span style="color: #8b2252;">'20px'</span>
    }}&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;<span style="color: #0000ff;">a</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"sub"</span> <span style="color: #a0522d;">onClick</span>={<span style="color: #008b8b;">this</span>.handleClick.bind(<span style="color: #008b8b;">this</span>)} <span style="color: #a0522d;">style</span>={{ backgroundColor: <span style="color: #8b2252;">'white'</span> }}&gt;
<span style="color: #000000; background-color: #ffffff;">        Sub's count = </span>{<span style="color: #008b8b;">this</span>.state.count}
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;/<span style="color: #0000ff;">a</span>&gt;
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);
  }

  componentWillMount() {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">constructor&#20043;&#21518;&#65292;&#31532;&#19968;&#27425;render&#20043;&#21069;</span>
    console.log(<span style="color: #8b2252;">'Sub componentWillMount'</span>);
  }

  componentDidMount() {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#31532;&#19968;&#27425;render&#20043;&#21518;</span>
    console.log(<span style="color: #8b2252;">'Sub componentDidMount'</span>);
  }

  componentWillUnmount() {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#28165;&#29702;&#24037;&#20316;</span>
    console.log(<span style="color: #8b2252;">'Sub componentWillUnmount'</span>);
  }

  componentWillReceiveProps(nextProps) {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">props&#21464;&#26356;&#26102;&#65292;&#25509;&#21040;&#26032;props&#20102;&#65292;&#20132;&#32473;shouldComponentUpdate&#12290;</span>
    <span style="color: #b22222;">// </span><span style="color: #b22222;">props&#32452;&#20214;&#20869;&#21482;&#35835;&#65292;&#21482;&#33021;&#20174;&#22806;&#37096;&#25913;&#21464;</span>
    console.log(<span style="color: #008b8b;">this</span>.props);
    console.log(nextProps);
    console.log(<span style="color: #8b2252;">'Sub componentWillReceiveProps'</span>, <span style="color: #008b8b;">this</span>.state.count);
  }

  shouldComponentUpdate(nextProps, nextState) {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#26159;&#21542;&#32452;&#20214;&#26356;&#26032;&#65292;props&#25110;state&#26041;&#24335;&#25913;&#21464;&#26102;&#65292;&#36820;&#22238;&#24067;&#23572;&#20540;&#65292;true&#25165;&#20250;&#26356;&#26032;</span>
    console.log(<span style="color: #8b2252;">'Sub shouldComponentUpdate'</span>, <span style="color: #008b8b;">this</span>.state.count, nextState);
    <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">true</span>; <span style="color: #b22222;">// </span><span style="color: #b22222;">return false&#23558;&#25318;&#25130;&#26356;&#26032;</span>
  }

  componentWillUpdate(nextProps, nextState) {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#21516;&#24847;&#26356;&#26032;&#21518;&#65292;&#30495;&#27491;&#26356;&#26032;&#21069;&#65292;&#20043;&#21518;&#35843;&#29992;render </span>
    console.log(<span style="color: #8b2252;">'Sub componentWillUpdate'</span>, <span style="color: #008b8b;">this</span>.state.count, nextState);
  }

  componentDidUpdate(prevProps, prevState) {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#21516;&#24847;&#26356;&#26032;&#21518;&#65292;&#30495;&#27491;&#26356;&#26032;&#21518;&#65292;&#22312;render&#20043;&#21518;&#35843;&#29992;</span>
    console.log(<span style="color: #8b2252;">'Sub componentDidUpdate'</span>, <span style="color: #008b8b;">this</span>.state.count, prevState);
  }
}

<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
  constructor(props) {
    console.log(<span style="color: #8b2252;">'Root Constructor'</span>)
    <span style="color: #a020f0;">super</span>(props); <span style="color: #b22222;">// </span><span style="color: #b22222;">&#35843;&#29992;&#29238;&#31867;&#26500;&#36896;&#22120;  </span>
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#23450;&#20041;&#19968;&#20010;&#23545;&#35937; </span>
    <span style="color: #008b8b;">this</span>.state = { flag: <span style="color: #008b8b;">true</span>, name: <span style="color: #8b2252;">'root'</span> };
  }

  handleClick(event) {
    <span style="color: #008b8b;">this</span>.setState({
      flag: !<span style="color: #008b8b;">this</span>.state.flag,
      name: <span style="color: #008b8b;">this</span>.state.flag ? <span style="color: #008b8b;">this</span>.state.name.toLowerCase() : <span style="color: #008b8b;">this</span>.state.name.toUpperCase()
    });
  }

  render() {
    <span style="color: #a020f0;">return</span> (
      &lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"app"</span> <span style="color: #a0522d;">onClick</span>={<span style="color: #008b8b;">this</span>.handleClick.bind(<span style="color: #008b8b;">this</span>)}&gt;
<span style="color: #000000; background-color: #ffffff;">        My Name is </span>{<span style="color: #008b8b;">this</span>.state.name}
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">Sub</span> /&gt;<span style="color: #000000; background-color: #ffffff;"> </span>{<span style="color: #b22222;">/*</span><span style="color: #b22222;">&#29238;&#32452;&#20214;&#30340;render&#65292;&#20250;&#24341;&#36215;&#19979;&#19968;&#32423;&#32452;&#20214;&#30340;&#26356;&#26032;&#27969;&#31243;&#65292;&#23548;&#33268;props&#37325;&#26032;&#21457;&#36865;&#65292;&#21363;&#20351;&#23376;&#32452;&#20214;props&#27809;&#26377;</span>
<span style="color: #b22222;">  &#25913;&#21464;&#36807;</span><span style="color: #b22222;">*/</span>}
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);
  }
}

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>


<p>
componentWillMount 第一次装载，在首次render之前。例如控制state、props。
</p>

<p>
componentDidMount 第一次装载结束，在首次render之后。例如控制state、props。
</p>


<p>
componentWillReceiveProps 在组件内部，props是只读不可变的，但是这个函
数可以接收到新的props，可以对props做一些处理，this.props =
{name:‘roooooot’};这就是偷梁换柱。componentWillReceiveProps触发，也
会走shouldComponentUpdate。
</p>

<p>
shouldComponentUpdate 判断是否需要组件更新，就是是否render，精确的控制渲染，提高性能。
</p>

<p>
componentWillUpdate 在除了首次render外，每次render前执行，componentDidUpdate在render之后调用。
</p>

<p>
不过，大多数时候，用不上这些函数，这些钩子函数是为了精确的控制。
</p>

<p>
修改Root组件render中的这一句为 &lt;div id="root" onDoubleClick={this.handleClick.bind(this)}&gt; ，可以看到点击Sub中红色的文字，Root不会重绘。
</p>

<p>
如果子组件和父组件使用了相同的事件，可以认为点击子组件也是点击了父组件，
父组件重绘，就会把子组件props更新，引起子组件组件更新流程，就会从
componentWillReceiveProps开始执行。如果子组件自己修改自己的state，不会
执行componentWillReceiveProps。
</p>

<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDOM, {render} from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #b22222;">// </span><span style="color: #b22222;">bundle.js &lt;script src="bundle.js"&gt;&lt;/script&gt;</span>
<span style="color: #b22222;">// </span><span style="color: #b22222;">&#26410;&#26469;bundler.js&#19979;&#36733;&#24182;&#30456;&#24403;&#20110;&#36816;&#34892;&#22312;index.html&#20013;</span>
<span style="color: #a020f0;">class</span> Sub <span style="color: #a020f0;">extends</span> React.Component{ <span style="color: #b22222;">// </span><span style="color: #b22222;">&#21482;&#35201;&#20986;&#29616;&#32452;&#20214;&#65292;&#23601;&#24517;&#39035;&#23548;&#20837;react</span>
  constructor(props) { <span style="color: #b22222;">// </span><span style="color: #b22222;">&#26500;&#36896;&#20989;&#25968;</span>
    <span style="color: #a020f0;">super</span>(props); <span style="color: #b22222;">// </span><span style="color: #b22222;">&#35843;&#29992;&#29238;&#31867;&#30340;&#26500;&#36896;&#20989;&#25968;&#65292;&#24517;&#39035;&#20889;</span>
    console.log(<span style="color: #8b2252;">'&#32452;&#20214;&#23454;&#20363;&#21270;&#20102;'</span>)
    <span style="color: #008b8b;">this</span>.state = {count: 0}<span style="color: #b22222;">// </span><span style="color: #b22222;">&#23450;&#20041;state&#29366;&#24577;</span>
  }
  componentWillMount() {
   console.log(<span style="color: #8b2252;">'&#32452;&#20214;&#23558;&#35201;&#25346;&#36733;&#21040;DOM&#19978;'</span>) 
  }

  <span style="color: #b22222;">// </span><span style="color: #b22222;">&#31532;&#19968;&#27425;&#35843;&#29992;render</span>

  componentDidMount() {
    console.log(<span style="color: #8b2252;">'&#32452;&#20214;&#24050;&#32463;&#25346;&#36733;&#21040;DOM&#19978;'</span>)
  }
  componentWillUnmount() {
    console.log(<span style="color: #8b2252;">'&#32452;&#20214;&#24050;&#32463;&#20174;DOM&#19978;&#21368;&#36733;&#20102;'</span>) 
  }
  <span style="color: #b22222;">/////////////////////////</span>
  componentWillReceiveProps(nextProps) {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">props&#21464;&#26356;&#26102;&#65292;&#25509;&#21040;&#26032;props&#20102;&#65292;&#20132;&#32473;shouldComponentUpdate&#12290;</span>
    <span style="color: #b22222;">// </span><span style="color: #b22222;">props&#32452;&#20214;&#20869;&#21482;&#35835;&#65292;&#21482;&#33021;&#20174;&#22806;&#37096;&#25913;&#21464;</span>
    console.log(<span style="color: #8b2252;">'&#24403;&#21069;&#20540;'</span>, <span style="color: #008b8b;">this</span>.props);
    console.log(<span style="color: #8b2252;">'&#26410;&#26469;&#35201;&#26356;&#26032;&#20540;'</span>, nextProps); <span style="color: #b22222;">// </span><span style="color: #b22222;">&#24453;&#26356;&#26032;&#30340;props</span>
    console.log(<span style="color: #8b2252;">'componentWillReceiveProps&#65292;props&#21457;&#29983;&#20102;&#21464;&#21270;&#65292;&#27880;&#24847;pops&#30340;&#25913;&#21464;&#26469;&#33258;&#22806;&#37096;&#65292;&#20256;&#20837;'</span>)
  }
  shouldComponentUpdate(nextProps, nextState) {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#26159;&#21542;&#32452;&#20214;&#26356;&#26032;&#65292;props&#25110;state&#26041;&#24335;&#25913;&#21464;&#26102;&#65292;&#36820;&#22238;&#24067;&#23572;&#20540;&#65292;true&#25165;&#20250;&#26356;&#26032;</span>
    console.log(<span style="color: #8b2252;">'&#24403;&#21069;&#20540;'</span>, <span style="color: #008b8b;">this</span>.state, <span style="color: #008b8b;">this</span>.props);
    console.log(<span style="color: #8b2252;">'&#26410;&#26469;&#35201;&#26356;&#26032;&#20540;'</span>, nextState, nextProps);
    console.log(<span style="color: #8b2252;">'shouldComponentUpdate, &#30001;props&#25110;state&#21457;&#29983;&#21464;&#21270;&#24341;&#36215;&#25191;&#34892;'</span>)
    <span style="color: #b22222;">// </span><span style="color: #b22222;">return false; // &#23601;&#31639;state&#21644;props&#26377;&#26356;&#26032;&#65292;&#21040;&#24213;&#32467;&#26463;&#65292;&#19981;&#26356;&#26032;&#32452;&#20214;</span>
    <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">true</span>;
  }
  componentWillUpdate(nextProps, nextState) {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#21516;&#24847;&#26356;&#26032;&#21518;&#65292;&#30495;&#27491;&#26356;&#26032;&#21069;&#65292;&#20043;&#21518;&#35843;&#29992;render </span>
    console.log(<span style="color: #8b2252;">'&#24403;&#21069;&#20540;'</span>, <span style="color: #008b8b;">this</span>.state, <span style="color: #008b8b;">this</span>.props);
    console.log(<span style="color: #8b2252;">'&#26410;&#26469;&#35201;&#26356;&#26032;&#20540;'</span>, nextState, nextProps);
    <span style="color: #b22222;">// </span><span style="color: #b22222;">nextProps = {'name': 'componentWillUpdate nextProps'}</span>
    <span style="color: #b22222;">// </span><span style="color: #b22222;">nextProps.name = 'python.org' // &#25913;&#20102;&#27809;&#26377;&#29992;. &#22240;&#20026;props&#21482;&#35835;</span>
    nextState.count = nextState.count + 100; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#25913;&#20102;&#26377;&#25928;&#26524;</span>
    console.log(<span style="color: #8b2252;">'&#26410;&#26469;&#35201;&#26356;&#26032;&#20540;'</span>, nextState, nextProps);
    console.log(<span style="color: #8b2252;">'componentWillUpdate, &#30001;props&#25110;state&#21457;&#29983;&#21464;&#21270;&#24341;&#36215;&#25191;&#34892;'</span>)
  }

  render() {
    console.log(<span style="color: #8b2252;">'render, &#32452;&#20214;&#28210;&#26579;'</span>)
    <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">'sub'</span> 
      <span style="color: #a0522d;">onClick</span>={e =&gt; {
        <span style="color: #008b8b;">this</span>.setState({count: <span style="color: #008b8b;">this</span>.state.count + 10})
      }}
      <span style="color: #a0522d;">style</span>={{backgroundColor:<span style="color: #8b2252;">'#FFF'</span>, width:<span style="color: #8b2252;">'80%'</span>,
      margin: <span style="color: #8b2252;">'5px'</span>
    }}&gt;
<span style="color: #000000; background-color: #ffffff;">      Sub content. props = </span>{<span style="color: #008b8b;">this</span>.props.name}<span style="color: #000000; background-color: #ffffff;"> </span>&lt;<span style="color: #0000ff;">br</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      state = </span>{<span style="color: #008b8b;">this</span>.state.count}
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;
  }

  componentDidUpdate(prevProps, prevState) {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">&#21516;&#24847;&#26356;&#26032;&#21518;&#65292;&#30495;&#27491;&#26356;&#26032;&#21518;&#65292;&#22312;render&#20043;&#21518;&#35843;&#29992;</span>
    console.log(<span style="color: #8b2252;">'&#24403;&#21069;&#20540;'</span>, <span style="color: #008b8b;">this</span>.state, <span style="color: #008b8b;">this</span>.props);
    console.log(<span style="color: #8b2252;">'&#19978;&#27425;&#20540;'</span>, prevState, prevProps);
    console.log(<span style="color: #8b2252;">'componentDidUpdate'</span>)
  }
}

<span style="color: #a020f0;">class</span> App <span style="color: #a020f0;">extends</span> React.Component{ 
  constructor(props) {
    <span style="color: #a020f0;">super</span>(props);
    <span style="color: #008b8b;">this</span>.state = {name: <span style="color: #8b2252;">'APP'</span>}
  }
  handleClick(e) {
    <span style="color: #008b8b;">this</span>.setState({ 
      name: <span style="color: #008b8b;">this</span>.state.name + <span style="color: #8b2252;">'*'</span>
      })
  }
  render() {
    <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span> 
    <span style="color: #a0522d;">onDoubleClick</span>={<span style="color: #008b8b;">this</span>.handleClick.bind(<span style="color: #008b8b;">this</span>)} 
      <span style="color: #a0522d;">style</span>={{backgroundColor: <span style="color: #8b2252;">'#f0f0f0'</span>}}&gt;
<span style="color: #000000; background-color: #ffffff;">      Root state = </span>{<span style="color: #008b8b;">this</span>.state.name}<span style="color: #000000; background-color: #ffffff;"> </span>&lt;<span style="color: #0000ff;">br</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;<span style="color: #0000ff;">Sub</span> <span style="color: #a0522d;">name</span>={<span style="color: #008b8b;">this</span>.state.name} /&gt;
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;
  }
}
render(&lt;<span style="color: #0000ff;">App</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-h:d4ca3e0f-3b96-4fc0-b642-9d8a9bce90c3" class="outline-3">
<h3 id="h:d4ca3e0f-3b96-4fc0-b642-9d8a9bce90c3">函数式组件</h3>
<div class="outline-text-3" id="text-h:d4ca3e0f-3b96-4fc0-b642-9d8a9bce90c3">
<p>
React从15.0开始支持函数式组件，定义如下
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">function</span> <span style="color: #0000ff;">Root</span>(<span style="color: #a0522d;">props</span>) {
  <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span>&gt;{props.schoolName}&lt;/<span style="color: #0000ff;">div</span>&gt;;
}
ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> <span style="color: #a0522d;">schoolName</span>=<span style="color: #8b2252;">"Hello World"</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>

<p>
开发中，很多情况下，组件其实很简单，不需要state状态，也不需要使用生命周期函数。
</p>

<p>
函数式组件的函数应该提供一个参数props，返回一个React元素。
</p>

<p>
函数式组件的函数本身就是render函数。
</p>

<p>
改写上面代码
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Root</span> = props =&gt; &lt;<span style="color: #0000ff;">div</span>&gt;{props.schoolName}&lt;/<span style="color: #0000ff;">div</span>&gt;;

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> <span style="color: #a0522d;">schoolName</span>=<span style="color: #8b2252;">"Hello World"</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>

<p>
以前函数式组件还有个名字叫stateless components无状态组件。当前React发布了16.8，已经可以在函数式组件中使用state了，所以官方建议叫函数式组件。
</p>
</div>
</div>
<div id="outline-container-h:b868542a-7890-4a14-be44-7b643600401e" class="outline-3">
<h3 id="h:b868542a-7890-4a14-be44-7b643600401e">高阶组件</h3>
<div class="outline-text-3" id="text-h:b868542a-7890-4a14-be44-7b643600401e">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Root</span> = props =&gt; &lt;div&gt;{props.schoolName}&lt;/div&gt;;
</pre>
</div>

<p>
如果要在上例的Root组件进行增强怎么办？例如将Root组件的div外部再加入其它div。
</p>

<p>
柯里化这个Wrapper函数
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Wrapper</span> = <span style="color: #a020f0;">function</span> (<span style="color: #a0522d;">Component</span>, <span style="color: #a0522d;">props</span>) {
  <span style="color: #a020f0;">return</span> (  
    &lt;div&gt;
      {props.schoolName}  
       &lt;hr /&gt;   
       &lt;Component /&gt;  
   &lt;/div&gt;
  );
};

<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Root</span> = props =&gt; &lt;div&gt;{props.schoolName}&lt;/div&gt;; 
</pre>
</div>

<p>
柯里化这个Wrapper函数
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Wrapper</span> = <span style="color: #a020f0;">function</span> (<span style="color: #a0522d;">Component</span>) {
  <span style="color: #a020f0;">function</span> <span style="color: #0000ff;">_wrapper</span>(<span style="color: #a0522d;">props</span>) {
   <span style="color: #a020f0;">return</span> (
    &lt;<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>{props.schoolName}
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">      </span>&lt;<span style="color: #0000ff;">Component</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;
  );
  }
  <span style="color: #a020f0;">return</span> _wrapper;
};

<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Root</span> = props =&gt; &lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">Root</span>&lt;/<span style="color: #0000ff;">div</span>&gt;;

<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">NewComp</span> = Wrapper(Root) <span style="color: #b22222;">// </span><span style="color: #b22222;">&#36820;&#22238;&#19968;&#20010;&#21253;&#35013;&#21518;&#30340;&#20803;&#32032;</span>

ReactDom.render(&lt;<span style="color: #0000ff;">NewComp</span> <span style="color: #a0522d;">schoolName</span>=<span style="color: #8b2252;">"Hello World"</span>/&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>

<p>
下面代码本身就是一个无状态组件，内部包裹这一个传入的组件，可以看做增强了传入的组件。
</p>

<p>
传入的组件作为返回的新组件的子组件
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">function</span> <span style="color: #0000ff;">_wrapper</span>(<span style="color: #a0522d;">props</span>) {
  <span style="color: #a020f0;">return</span> (  
   &lt;div&gt;
    {props.schoolName}   
    &lt;hr /&gt;  
    &lt;Component /&gt;  
  &lt;/div&gt;
  );
}
</pre>
</div>

<p>
那么上面代码的Wrapper函数可以看做参数是一个组件，返回一个新组件，即高阶组件。
</p>

<p>
简化Wrapper，箭头函数
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Wrapper</span> = <span style="color: #a020f0;">function</span> (<span style="color: #a0522d;">Component</span>) { 
    <span style="color: #a020f0;">return</span> (props) =&gt; { 
        <span style="color: #a020f0;">return</span> ( 
            &lt;div&gt;
                {props.schoolName}
                &lt;hr /&gt; 
                &lt;Component /&gt; 
            &lt;/div&gt;
        );
    };
};
</pre>
</div>

<p>
再次变化
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Wrapper</span> = <span style="color: #a020f0;">function</span> (<span style="color: #a0522d;">Component</span>) { 
    <span style="color: #a020f0;">return</span> props =&gt;
        ( 
        &lt;div&gt;
            {props.schoolName} 
            &lt;hr /&gt; 
            &lt;Component /&gt; 
        &lt;/div&gt;
    );
};
</pre>
</div>

<p>
再次变化
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Wrapper</span> = Component =&gt; props =&gt;
    (&lt;<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>{props.schoolName}
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">Component</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);

<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Root</span> = props =&gt; &lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">Root</span>&lt;/<span style="color: #0000ff;">div</span>&gt;;

<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">NewComp</span> = Wrapper(Root)

ReactDom.render(&lt;<span style="color: #0000ff;">NewComp</span> <span style="color: #a0522d;">schoolName</span>=<span style="color: #8b2252;">"Hello World"</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>
</div>
<div id="outline-container-h:aabac657-b75e-4d67-8805-f6e05bdb8cf2" class="outline-4">
<h4 id="h:aabac657-b75e-4d67-8805-f6e05bdb8cf2">装饰器</h4>
<div class="outline-text-4" id="text-h:aabac657-b75e-4d67-8805-f6e05bdb8cf2">
<p>
新版ES 2016中增加了装饰器的支持，因此可以使用装饰器来改造上面的代码
</p>

<div class="org-src-container">
<pre class="src src-js">@Wrapper <span style="color: #b22222;">// </span><span style="color: #b22222;">&#36825;&#26159;&#19981;&#23545;&#30340;&#65292;&#35013;&#39280;&#22120;&#35013;&#39280;&#20989;&#25968;&#25110;&#31867;</span>
<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Root</span> = props =&gt; &lt;div&gt;Root&lt;/div&gt;;
</pre>
</div>

<p>
ES 2016的装饰器只能装饰类，所以，将Root改写成类
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;
<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Wrapper</span> = Component =&gt; props =&gt;
    (&lt;<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>{props.schoolName}
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">Component</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);

@Wrapper
<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
    render() {
        <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">Root</span>&lt;/<span style="color: #0000ff;">div</span>&gt;;
    }
}

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> <span style="color: #a0522d;">schoolName</span>=<span style="color: #8b2252;">"Hello World"</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>

<p>
如何让Root也显示出schoolName？
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;
<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Wrapper</span> = Component =&gt; props =&gt;
    (&lt;<span style="color: #0000ff;">div</span>&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>{props.schoolName}
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>{<span style="color: #b22222;">/* </span><span style="color: #b22222;">&lt;Component schoolName={props.schoolName} /&gt;</span><span style="color: #b22222;"> */</span>}
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;<span style="color: #0000ff;">Component</span> {...props} /&gt;
<span style="color: #000000; background-color: #ffffff;">    </span>&lt;/<span style="color: #0000ff;">div</span>&gt;<span style="color: #000000; background-color: #ffffff;">);</span>

<span style="color: #000000; background-color: #ffffff;">@Wrapper</span>
<span style="color: #000000; background-color: #ffffff;">class Root extends React.Component </span>{
    render() {
        <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span>&gt;{<span style="color: #008b8b;">this</span>.props.schoolName}&lt;/<span style="color: #0000ff;">div</span>&gt;;
    }
}

<span style="color: #000000; background-color: #ffffff;">ReactDom.render(</span>&lt;<span style="color: #0000ff;">Root</span> <span style="color: #a0522d;">schoolName</span>=<span style="color: #8b2252;">"Hello World"</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>

<p>
使用 &lt;Component {&#x2026;props} /&gt; 相当于给组件增加了属性。
</p>
</div>
</div>
<div id="outline-container-h:8eda4a1c-bcc1-4ce2-be44-e7c241682f75" class="outline-4">
<h4 id="h:8eda4a1c-bcc1-4ce2-be44-e7c241682f75">带参装饰器</h4>
<div class="outline-text-4" id="text-h:8eda4a1c-bcc1-4ce2-be44-e7c241682f75">
<p>
想给装饰器函数增加一个id参数
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#24102;&#21442;&#35013;&#39280;&#22120;&#20989;&#25968;</span>
<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Wrapper</span> =
    id =&gt; Component =&gt; props =&gt;
        (&lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>={id}&gt;
<span style="color: #000000; background-color: #ffffff;">            </span>{props.schoolName}
<span style="color: #000000; background-color: #ffffff;">            </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">            </span>&lt;<span style="color: #0000ff;">Component</span> {...props} /&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);

@Wrapper(<span style="color: #8b2252;">'wrapper'</span>) <span style="color: #b22222;">// </span><span style="color: #b22222;">&#24102;&#21442;</span>
<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
    render() {
        <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span>&gt;{<span style="color: #008b8b;">this</span>.props.schoolName}&lt;/<span style="color: #0000ff;">div</span>&gt;;
    }
}

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> <span style="color: #a0522d;">schoolName</span>=<span style="color: #8b2252;">"Hello World"</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #a020f0;">import</span> React from <span style="color: #8b2252;">'react'</span>;
<span style="color: #a020f0;">import</span> ReactDom from <span style="color: #8b2252;">'react-dom'</span>;

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#24102;&#21442;&#35013;&#39280;&#22120;&#20989;&#25968;</span>
<span style="color: #a020f0;">let</span> <span style="color: #a0522d;">Wrapper</span> =
    (id, id2) =&gt; Component =&gt; props =&gt;
        (&lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>={id}&gt;
<span style="color: #000000; background-color: #ffffff;">            </span>{props.schoolName}
<span style="color: #000000; background-color: #ffffff;">            </span>&lt;<span style="color: #0000ff;">hr</span> /&gt;
<span style="color: #000000; background-color: #ffffff;">            </span>&lt;<span style="color: #0000ff;">Component</span> {...props} <span style="color: #a0522d;">id</span>={id2}/&gt;
<span style="color: #000000; background-color: #ffffff;">        </span>&lt;/<span style="color: #0000ff;">div</span>&gt;);

@Wrapper(<span style="color: #8b2252;">'wrapper'</span>, <span style="color: #8b2252;">'wrapp_app'</span>) <span style="color: #b22222;">// </span><span style="color: #b22222;">&#24102;&#21442;</span>
<span style="color: #a020f0;">class</span> Root <span style="color: #a020f0;">extends</span> React.Component {
    render() {
        <span style="color: #a020f0;">return</span> &lt;<span style="color: #0000ff;">div</span> <span style="color: #a0522d;">id</span>={<span style="color: #008b8b;">this</span>.props.id}&gt;{<span style="color: #008b8b;">this</span>.props.schoolName}&lt;/<span style="color: #0000ff;">div</span>&gt;;
    }
}

ReactDom.render(&lt;<span style="color: #0000ff;">Root</span> <span style="color: #a0522d;">schoolName</span>=<span style="color: #8b2252;">"Hello World"</span> /&gt;, document.getElementById(<span style="color: #8b2252;">'root'</span>));
</pre>
</div>

<p>
通过上面的改写，就得到带参装饰器。
</p>

<p>
如果觉得不好接受，可以先写成原始的形式，熟悉了箭头函数语法后，再改成精简的形式。
</p>
</div>
</div>
</div>
</section>
</div>
<div id="postamble" class="status">
    <div class=bar data-astro-cid-p3givckg>
        <div class=list data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:gnuemacs height=1em viewBox="0 0 24 24" width=1em>
                    <title>emacs</title>
                    <symbol id=ai:simple-icons:gnuemacs>
                        <path d="M12 24C5.448 24 .118 18.617.118 12S5.448 0 12 0s11.882 5.383 11.882 12S18.552 24 12 24zM12 .661C5.813.661.779 5.748.779 12S5.813 23.339 12 23.339S23.221 18.253 23.221 12S18.187.661 12 .661zM8.03 20.197s.978.069 2.236-.042c.51-.045 2.444-.235 3.891-.552c0 0 1.764-.377 2.707-.725c.987-.364 1.524-.673 1.766-1.11c-.011-.09.074-.408-.381-.599c-1.164-.488-2.514-.4-5.185-.457c-2.962-.102-3.948-.598-4.472-.997c-.503-.405-.25-1.526 1.907-2.513c1.086-.526 5.345-1.496 5.345-1.496c-1.434-.709-4.109-1.955-4.659-2.224c-.482-.236-1.254-.591-1.421-1.021c-.19-.413.448-.768.804-.87c1.147-.331 2.766-.536 4.24-.56c.741-.012.861-.059.861-.059c1.022-.17 1.695-.869 1.414-1.976c-.252-1.13-1.579-1.795-2.84-1.565c-1.188.217-4.05 1.048-4.05 1.048c3.539-.031 4.131.028 4.395.398c.156.218-.071.518-1.015.672c-1.027.168-3.163.37-3.163.37c-2.049.122-3.492.13-3.925 1.046c-.283.599.302 1.129.558 1.46c1.082 1.204 2.646 1.853 3.652 2.331c.379.18 1.49.52 1.49.52c-3.265-.18-5.619.823-7.001 1.977c-1.562 1.445-.871 3.168 2.33 4.228c1.891.626 2.828.921 5.648.667c1.661-.09 1.923-.036 1.939.1c.023.192-1.845.669-2.355.816c-1.298.374-4.699 1.129-4.716 1.133z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:gnuemacs></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Emacs</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:org height=1em viewBox="0 0 24 24" width=1em>
                    <title>org-mode</title>
                    <symbol id=ai:simple-icons:org>
                        <path d="M17.169 0c-.566.004-2.16 3.312-3.376 5.94a2.19 2.19 0 0 1-.408-1.267c-.03-.582-1.089.237-.936 1.275c-.068-.035-1.26.227-1.26.23c-.23-.93-.802-1.618-1.15-.563c-.701 1.663-.88 2.984.115 4.585c-.908 4.058-6.948 6.053-6.32 9.33c.175.004 1.634 3.48 6.337 2.057c5.557-1.577 8.624 2.116 8.978 2.375c.52.526-1.348-4.573-5.302-6.865c-2.339-1.276-.87-3.474-.703-4.25c0 0 1.874 1.312 3.232-.692c1.227.316 2.05-.224 3.105.158c.64.28 3.336.11 2.334-1.396c-.148.129.07.27-.075.46c-.043.056-.128.232-.408.315c-.314.149-.83.27-1.43-.37c-.434-.32-.748-.04-.992-.063c.152-.098.577-.315 1.264-.315c.388 0 .594.336.854.338c.174 0 .685-.262.787-.365c.63-.41.697-.278 1.012-.905c.17-.759-.215-.92-.332-1.129c-.032-.483-.436-.67-.919-.326c-1.106-.198-2.192-.105-2.728-.15c-1.175-.164-2.153-.786-2.153-.786c.143-.19.075-.6-.842-.628c-.315-.104-.45-.2-.745-.307c.61-1.37.674-2.007 1.418-4.004c.261-1.053 1.039-2.685.643-2.682zm-4.297 8.093c.03-.086.443.138.952.176c.395.03.805.048 1.296-.025c.03-.005.172.095-.15.194c-.02.01-.062-.01-.065.196c0 .022-.01.04-.02.046c-.15.152-.708.223-1.065.1c-.436-.17-.482-.316-.517-.443c-.305-.147-.47-.123-.43-.244zM9.685 10.2C8.86 9 8.929 8.36 8.96 7.256C7.961 8.288 6.855 8.3 5.18 8.58c-1.299.234-3.657 2.447-4.025 4.742c-.043.608-.08 2.183.424 3.498c.492 1.13.828 1.727 1.844 2.335c-.882-3.169 5.296-5.33 6.263-8.955z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:org></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Orgmode</p>
                </div>
            </span>
            <a href=/donations.html class=entry data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:astro height=1em viewBox="0 0 24 24" width=1em>
                    <title>Donations</title>
                    <symbol id=ai:simple-icons:astro>
                        <path d="M8.358 20.162c-1.186-1.07-1.532-3.316-1.038-4.944c.856 1.026 2.043 1.352 3.272 1.535c1.897.283 3.76.177 5.522-.678c.202-.098.388-.229.608-.36c.166.473.209.95.151 1.437c-.14 1.185-.738 2.1-1.688 2.794c-.38.277-.782.525-1.175.787c-1.205.804-1.531 1.747-1.078 3.119l.044.148a3.158 3.158 0 0 1-1.407-1.188a3.31 3.31 0 0 1-.544-1.815c-.004-.32-.004-.642-.048-.958c-.106-.769-.472-1.113-1.161-1.133c-.707-.02-1.267.411-1.415 1.09c-.012.053-.028.104-.045.165h.002zm-5.961-4.445s3.24-1.575 6.49-1.575l2.451-7.565c.092-.366.36-.614.662-.614c.302 0 .57.248.662.614l2.45 7.565c3.85 0 6.491 1.575 6.491 1.575L16.088.727C15.93.285 15.663 0 15.303 0H8.697c-.36 0-.615.285-.784.727l-5.516 14.99z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:astro></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>打赏</p>
                </div>
            </span>
            </a>
            <span class=entry data-astro-cid-p3givckg>
                <svg xmlns="http://www.w3.org/2000/svg" class=heading data-astro-cid-p3givckg data-icon=simple-icons:copyright width="1em" height="1em" viewBox="0 0 24 24">
                    <title>Copyright</title>
                    <path fill="currentColor" d="M19 2a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3zm-5 5h-4a1 1 0 0 0-1 1l.007.117A1 1 0 0 0 10 9h3v5a1 1 0 0 1-1.993.117L11 14a1 1 0 0 0-2 0a3 3 0 0 0 6 0V8a1 1 0 0 0-1-1" />
                    <use xlink:href=#ai:simple-icons:copyright></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>© 2025 Jasper Hsu</p>
                </div>
            </span>
        </div>
        <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ class="list license" data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Creative Commons</title>
                    <symbol id=ai:fa6-brands:creative-commons>
                        <path d="m245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93c-22.13 0-33.22 14.61-33.22 43.84c0 23.57 9.21 43.84 33.22 43.84c14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98c-22.6 0-73.96-10.32-73.96-77.05c0-58.69 43-77.06 72.63-77.06c30.72-.01 52.7 11.95 65.99 35.86zm143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93c-22.14 0-33.22 14.61-33.22 43.84c0 23.55 9.23 43.84 33.22 43.84c14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98c-22.69 0-73.96-9.87-73.96-77.05c0-58.67 42.97-77.06 72.63-77.06c30.71-.01 52.58 11.95 65.56 35.86zM247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248c129.93 0 248.44-100.87 248.44-248c0-137.87-106.62-248-248.44-248zm.87 450.81c-112.54 0-203.7-93.04-203.7-202.81c0-105.42 85.43-203.27 203.72-203.27c112.53 0 202.82 89.46 202.82 203.26c-.01 121.69-99.68 202.82-202.84 202.82z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Creative Commons</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-by height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Attribute</title>
                    <symbol id=ai:fa6-brands:creative-commons-by>
                        <path d="M314.9 194.4v101.4h-28.3v120.5h-77.1V295.9h-28.3V194.4c0-4.4 1.6-8.2 4.6-11.3c3.1-3.1 6.9-4.7 11.3-4.7H299c4.1 0 7.8 1.6 11.1 4.7c3.1 3.2 4.8 6.9 4.8 11.3zm-101.5-63.7c0-23.3 11.5-35 34.5-35s34.5 11.7 34.5 35c0 23-11.5 34.5-34.5 34.5s-34.5-11.5-34.5-34.5zM247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256C0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8c103.2 0 202.8-81.1 202.8-202.8c.1-113.8-90.2-203.3-202.8-203.3z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-by></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Attribute</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-nc height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Noncommercial</title>
                    <symbol id=ai:fa6-brands:creative-commons-nc>
                        <path d="M247.6 8C387.4 8 496 115.9 496 256c0 147.2-118.5 248-248.4 248C113.1 504 0 393.2 0 256C0 123.1 104.7 8 247.6 8zM55.8 189.1c-7.4 20.4-11.1 42.7-11.1 66.9c0 110.9 92.1 202.4 203.7 202.4c122.4 0 177.2-101.8 178.5-104.1l-93.4-41.6c-7.7 37.1-41.2 53-68.2 55.4v38.1h-28.8V368c-27.5-.3-52.6-10.2-75.3-29.7l34.1-34.5c31.7 29.4 86.4 31.8 86.4-2.2c0-6.2-2.2-11.2-6.6-15.1c-14.2-6-1.8-.1-219.3-97.4zM248.4 52.3c-38.4 0-112.4 8.7-170.5 93l94.8 42.5c10-31.3 40.4-42.9 63.8-44.3v-38.1h28.8v38.1c22.7 1.2 43.4 8.9 62 23L295 199.7c-42.7-29.9-83.5-8-70 11.1c53.4 24.1 43.8 19.8 93 41.6l127.1 56.7c4.1-17.4 6.2-35.1 6.2-53.1c0-57-19.8-105-59.3-143.9c-39.3-39.9-87.2-59.8-143.6-59.8z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-nc></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Noncommercial</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-sa height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Share Alike</title>
                    <symbol id=ai:fa6-brands:creative-commons-sa>
                        <path d="M247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256C0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8c103.2 0 202.8-81.1 202.8-202.8c.1-113.8-90.2-203.3-202.8-203.3zM137.7 221c13-83.9 80.5-95.7 108.9-95.7c99.8 0 127.5 82.5 127.5 134.2c0 63.6-41 132.9-128.9 132.9c-38.9 0-99.1-20-109.4-97h62.5c1.5 30.1 19.6 45.2 54.5 45.2c23.3 0 58-18.2 58-82.8c0-82.5-49.1-80.6-56.7-80.6c-33.1 0-51.7 14.6-55.8 43.8h18.2l-49.2 49.2l-49-49.2h19.4z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-sa></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Share Alike</p>
                </div>
            </span>
        </a>
    </div>
<!--
<script type="text/javascript" src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/bootstrap@5.2.1/dist/js/bootstrap.min.js"></script>
<div id="back-to-top" class=""><svg viewBox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg></div>
-->
</div>
</body>
</html>
