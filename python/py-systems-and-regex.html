<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Python: 系统编程</title>
<meta name="generator" content="Org Mode" />
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="me" href="https://emacs.ch/@jasperhsu">
<meta name="google-adsense-account" content="ca-pub-1741779893655624">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1741779893655624" crossorigin="anonymous"></script>
<!-- from -->
<!--
<style>#back-to-top{background:#000;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;bottom:20px;-webkit-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);-moz-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);box-shadow:0 2px 5px 0 rgba(0,0,0,.26);color:#fff;cursor:pointer;display:block;height:56px;opacity:1;outline:0;position:fixed;right:20px;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-transition:bottom .2s,opacity .2s;-o-transition:bottom .2s,opacity .2s;-moz-transition:bottom .2s,opacity .2s;transition:bottom .2s,opacity .2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:56px;z-index:1}#back-to-top svg{display:block;fill:currentColor;height:24px;margin:16px auto 0;width:24px}#back-to-top.hidden{bottom:-56px;opacity:0}</style>
-->
<link rel="stylesheet" href="/static/aandds.com/css/main.css">
<link rel="stylesheet" href="/static/aandds.com/css/drollery.min.css">
<script type="text/javascript" src="/static/aandds.com/js/main.js"></script>
<!--
<script id="MathJax-script" async="" src="/static/aandds.com/js/mathjax.js"></script>

<script type="text/javascript" src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
-->
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">Python: 系统编程</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#h:d5334516-b6e0-4a0c-8435-4383cd20ecbd">Python 文件系统操作编程</a>
<ul>
<li><a href="#h:aa553fa8-7914-4598-a6df-15483bdcaa43">文件操作</a>
<ul>
<li><a href="#h:079bec38-5be1-46f3-8df8-f6888e878930">冯诺依曼体系架构</a></li>
<li><a href="#h:1d3ae9f5-c95c-407c-ac01-a0b0bbbc2fb2">文件IO常用操作</a></li>
<li><a href="#h:24ccdda9-2032-492c-a77b-28ab8287fe78">打开操作</a>
<ul>
<li><a href="#h:32f353ed-5a1a-46f4-b550-49e9e58e791b">open的参数</a>
<ul>
<li><a href="#h:bf444f38-d92c-4590-b297-37f83fe9793c">file</a></li>
<li><a href="#h:78a96a9c-fce9-4e6f-86b8-7133695c7d32"><code>mode模式</code></a></li>
<li><a href="#h:5a4dec9b-5fcb-4135-9d69-64895e2f9fc7">文件指针</a></li>
<li><a href="#h:bd928625-c7cf-4d3b-a8c0-853498054828">buffering缓冲区</a></li>
<li><a href="#h:21b590c7-41e5-45e2-8ef2-3eafcf215c9b">encoding</a></li>
<li><a href="#h:20fdf57b-c42d-4c16-8813-1008cda50ad3">errors</a></li>
<li><a href="#h:7b018d8f-d035-4e48-bf05-5ce8f62a45f0">newline</a></li>
<li><a href="#h:0124bd00-d82d-455a-9031-1b6f3a30da7d">其它</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:a6d80630-c7fb-4627-baa6-8ed63b244fcf">read</a></li>
<li><a href="#h:a26b58fd-8e4c-4f78-a083-394ce769a642">行读取</a></li>
<li><a href="#h:d5437ec9-c327-48c5-bb96-ed34b81c3c43">write</a></li>
<li><a href="#h:a71fcfab-5051-44fd-9a84-04a4a580e461">close</a></li>
<li><a href="#h:5bab3a91-7d12-497b-8b7f-0f687fb2927a">其他</a></li>
<li><a href="#h:0af6a034-5e05-4707-8770-52633197628e">上下文管理</a>
<ul>
<li><a href="#h:eba8a9c3-0de1-4d1b-a6df-b6c7787ed5fe">问题的引出</a></li>
<li><a href="#h:9a3b9c16-e60b-4e27-876e-3a72d23dd4b1">上下文管理</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:12de2029-76d5-471f-9f8d-ff42ca340d1d">StringIO和BytesIO</a></li>
<li><a href="#h:b5765d40-b994-4482-b171-0c0039ebe09a">正则表达式基础</a>
<ul>
<li><a href="#h:0e68249f-c9c7-4834-923e-4bac1389a049">概述</a></li>
<li><a href="#h:ffca9d72-1713-4481-a127-aa1fe7c66cf4">分类</a></li>
<li><a href="#h:06cf2469-2748-4006-aa60-a23235f36909">基本语法</a>
<ul>
<li><a href="#h:c6ab72e4-7685-482c-8007-00d4dd5619e7">元字符</a></li>
<li><a href="#h:af31538c-eff4-46bf-ac59-90aa178a1a52">转义</a></li>
<li><a href="#h:72abb7e8-d1ff-40bd-bbba-ac0837d1a337">重复</a></li>
<li><a href="#h:ea4112f7-7370-4d49-b538-78a8e38d886a">或</a></li>
<li><a href="#h:50e30561-3dc3-416a-9f4f-8c26eb60bb86">捕获</a></li>
<li><a href="#h:672d98b4-d983-4bc2-b4eb-3084d1665f8f">断言</a></li>
<li><a href="#h:72e0202f-8876-4b47-8093-a5361a98b8c5">贪婪与非贪婪</a></li>
<li><a href="#h:bedf8c91-a445-422d-bef0-2ba0f2fa4423">引擎选项</a></li>
</ul>
</li>
<li><a href="#h:9e4328c8-2675-4cde-b603-5e481ecca1c2">正则习题</a></li>
</ul>
</li>
<li><a href="#h:5cca339a-c4c0-4e43-ab17-d26507e4091c">路径操作</a>
<ul>
<li><a href="#h:1c5a5158-ec43-4ee1-8782-06089a9859ba">路径操作模块</a></li>
<li><a href="#h:209932a2-f431-4025-8ba5-edd4a324a70b">Path类</a>
<ul>
<li><a href="#h:a20f7330-a11e-4d63-93af-727fefdc95c7">初始化</a></li>
<li><a href="#h:01d9d18a-dad8-4e8d-953d-a19bad63c83f">路径拼接</a></li>
<li><a href="#h:606065eb-0a97-4113-a509-c28f747e205d">分解</a></li>
<li><a href="#h:9d8f9e10-3265-4a7b-8bdb-81a14457520e">获取路径</a></li>
<li><a href="#h:16d6980a-18d1-4dd7-b880-15b0ecbcc9e1">父目录</a></li>
<li><a href="#h:4963685a-a285-4ab2-86b0-42d1e563357b">目录组成部分</a></li>
<li><a href="#h:8b645021-ccc3-4126-929a-bf6e19339ccb">全局方法</a></li>
<li><a href="#h:7bdca2bf-dd95-4657-8701-f4a2e466f296">判断方法</a></li>
<li><a href="#h:8a58941d-4b3f-4d22-abdc-27a8fac91bf9">绝对路径</a></li>
<li><a href="#h:a2efa435-286b-46b9-9e95-4b1240a1273c">其它操作</a></li>
<li><a href="#h:b0294a84-99f0-442c-8659-3c2ccc8892ed">通配符</a></li>
<li><a href="#h:cadec8be-c38d-4683-82b7-51e2e16cbeec">文件操作</a></li>
</ul>
</li>
<li><a href="#h:4e7929e4-c1b0-46de-88ee-7cb083328d26">os模块</a></li>
</ul>
</li>
<li><a href="#h:2ef17ab1-30e3-4714-8f81-6666a8c88240">shutil模块</a>
<ul>
<li><a href="#h:cc1d6eb4-d6d1-4e86-a967-79533ada1241">copy 复制</a></li>
<li><a href="#h:4a18a73e-a92c-44ff-8e4b-aaf707c5fb3a">rm 删除</a></li>
<li><a href="#h:3e59dd36-59cb-4f77-914a-0f962edbae83">move 移动</a></li>
<li><a href="#h:e4e4d1e6-dd0a-43e3-a3aa-6b32b6ef40b1">练习</a>
<ul>
<li><a href="#h:40684f55-fee0-40ac-bca5-918bbb8c3b05">指定一个源文件，实现copy到目标目录</a></li>
<li><a href="#h:f0097f55-a09b-4839-9120-9a94689c10c9">复制目录</a></li>
<li><a href="#h:9dede179-23dc-4f80-81f5-b66390419372">密码强度</a></li>
<li><a href="#h:bc35de77-49f4-4f3c-b9ea-211c85480dac">配置文件转换</a></li>
<li><a href="#h:31da8063-4f1f-4b7e-9ae4-3e70d3f51ca8">单词统计</a></li>
<li><a href="#h:542e3cb1-bf1f-4114-952c-d4bb446f65a4">单词统计进阶</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:5c1e797e-91e2-489f-a7fb-953fdb49cd15">Python的正则表达式</a>
<ul>
<li><a href="#h:189ba1b7-9c52-4053-9d3b-a64bb57b05f7">常量</a></li>
<li><a href="#h:92ea17ad-37d1-406a-bcaf-8aa3d0e50e57">方法</a>
<ul>
<li><a href="#h:efa6f574-efe5-4253-a41e-b64b3e1090f9">编译</a></li>
<li><a href="#h:0d685a42-d452-4b64-a9fb-3f1609415fbb">单次匹配</a></li>
<li><a href="#h:05408d5d-5b3b-4718-a2d0-8507d6c62d62">全文搜索</a></li>
<li><a href="#h:62cf5a2d-490b-4aac-a77b-77bef40a9008">匹配替换</a></li>
<li><a href="#h:77099962-0baa-4908-8627-bfc0ae1c697f">分割字符串</a></li>
<li><a href="#h:5fa828f0-a7a9-4a78-bf05-14983b67c446">分组</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:9a1c6e64-ea35-4b06-af8a-0171e0dbf38b">csv与ini文件</a>
<ul>
<li><a href="#h:a1bdc9ad-39c4-4d99-84d8-b23b72dee4dc">csv文件</a>
<ul>
<li><a href="#h:d2d62266-dff1-4acd-b55d-365cf61c9fcb">csv文件简介</a></li>
<li><a href="#h:606e66e5-f52d-42f3-9cf5-3620c351e54d">手动生成csv文件</a></li>
<li><a href="#h:5895a9b2-2d09-4013-adaa-cec8ca08fa24">csv模块</a></li>
</ul>
</li>
<li><a href="#h:786d3af1-a1f7-4029-9d4d-34b1cc480cdd">ini文件处理</a>
<ul>
<li><a href="#h:eefcbbc9-cc7f-42f3-8390-694eabd1ce25">configparser</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#h:7796246a-59e6-4851-9a51-04b809496f18">序列化和反序列化</a>
<ul>
<li><a href="#h:81322cb8-0372-4f87-a43a-4b4f3c0867d5">为什么要序列化</a></li>
<li><a href="#h:7389e4e0-f18e-4c20-b60b-8d21acd2037d">定义</a></li>
<li><a href="#h:603687a4-ba36-423a-bb8c-dd538a50281f">pickle库</a>
<ul>
<li><a href="#h:2346b2ba-36d0-4d8b-a1f2-1c2b1975b65c">序列化、反序列化实验</a></li>
</ul>
</li>
<li><a href="#h:bee0b6d6-5fad-4ad5-845b-8b77dc251f21">序列化应用</a></li>
<li><a href="#h:ec4b901e-9ca3-4ea3-bb80-2f639abde5b2">Json</a>
<ul>
<li><a href="#h:f3304d95-9245-4304-bc90-ac8621dcf2f4">Json是数据类型</a>
<ul>
<li><a href="#h:dcc98bdd-085d-48bf-9de7-4c2a5c873e1f">值</a></li>
<li><a href="#h:02c06260-2621-4444-8ca1-720fb6286571">字符串</a></li>
<li><a href="#h:46612e5e-7855-4766-b2d9-e96b4f01cb9a">数值</a></li>
<li><a href="#h:f8b0d664-dabf-413c-ad6c-4c311c0cd4dc">对象</a></li>
<li><a href="#h:1636219b-b552-45ac-ba72-beaa961db963">数组</a></li>
</ul>
</li>
<li><a href="#h:fd36de02-62bb-476a-a25b-50729ec7add4">Json 模块</a>
<ul>
<li><a href="#h:e88465b8-94e3-4c1f-8339-bbf11b03ee4a">Python 与 Json</a></li>
<li><a href="#h:435cf8e1-6584-4e6b-9687-b67f7bd73c4d">常用方法</a></li>
</ul>
</li>
<li><a href="#h:ba57e488-9b93-4277-96cf-442739c48bce">MessagePack</a>
<ul>
<li><a href="#h:d23960c5-0445-4531-8eba-1a757fd2d94f">安装</a></li>
<li><a href="#h:94e0d426-f344-4dee-8529-38d2437ce750">常用方法</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav>
<ul class="org-ul">
<li>TAGS: <a href="./index.html">Python</a></li>
</ul>
<section id="outline-container-h:d5334516-b6e0-4a0c-8435-4383cd20ecbd" class="outline-2">
<h2 id="h:d5334516-b6e0-4a0c-8435-4383cd20ecbd">Python 文件系统操作编程</h2>
<div class="outline-text-2" id="text-h:d5334516-b6e0-4a0c-8435-4383cd20ecbd">
<p>
主要内容：
</p>
<ul class="org-ul">
<li>文件打开与文件描述符</li>
<li>文件的编码与UNICODE</li>
<li>二进制文件与文本</li>
<li>文本文件的读写</li>
<li>二进制文件的读写</li>
<li>文件的迭代器读写方式</li>
<li>文件读写的异常与 With 语句</li>
<li>目录与文件遍历</li>
<li>目录创建与删除</li>
<li>目录与文件存在判定</li>
<li>目录与文件属性查看</li>
<li>StringIO 和 ByteIO 使用</li>
<li>高级文件操作模块 Shutil 使用</li>
<li>CSV 文件读写与解析</li>
<li>ini 配置文件的读写与解析</li>
</ul>
</div>
<div id="outline-container-h:aa553fa8-7914-4598-a6df-15483bdcaa43" class="outline-3">
<h3 id="h:aa553fa8-7914-4598-a6df-15483bdcaa43">文件操作</h3>
<div class="outline-text-3" id="text-h:aa553fa8-7914-4598-a6df-15483bdcaa43">
</div>
<div id="outline-container-h:079bec38-5be1-46f3-8df8-f6888e878930" class="outline-4">
<h4 id="h:079bec38-5be1-46f3-8df8-f6888e878930">冯诺依曼体系架构</h4>
<div class="outline-text-4" id="text-h:079bec38-5be1-46f3-8df8-f6888e878930">

<figure id="orgeaaf4bd">
<img src="images/image-20210215092720081.png" alt="image-20210215092720081.png" width="50%">

</figure>

<p>
CPU由运算器和控制器组成：
</p>
<ul class="org-ul">
<li>运算器，完成各种算数运算、逻辑运算、数据传输等数据加工处理</li>
<li>控制器，控制计算机各部件协调运行</li>
<li>存储器，用于记忆程序和数据，例如内存</li>
<li>输入设备，将数据或程序输入到计算机中，例如键盘、鼠标</li>
<li>输出设备，将数据或程序的处理结果展示给用户，例如显示器、打印机等</li>
</ul>

<p>
一般说IO操作，指的是文件IO，如果指的是网络IO，都会直接说网络IO磁盘
</p>

<p>
目前依然是文件持久化最重要设备。
</p>

<p>
1956年，IBM发明可以存储5MB的磁盘驱动器。磁盘使用磁性材料记录数据，使用NS极表示0或1。
</p>

<p>
现代磁盘使用温彻斯特磁盘驱动器，如下
</p>

<p>
温彻斯特磁盘拥有多个同轴金属盘片，盘片上涂上磁性材料，一组可移动磁头。运行时，磁头摆动从飞速旋转的盘片读取或写入数据。一般常见盘片 <b>转速</b> 为5400转/分钟、7200转/分钟等。磁头摆动定位数据过程称为 <b>寻道</b> 。转速、寻道都影响磁盘读写性能。
</p>

<p>
磁头不和盘片接触，磁盘内部也不是真空，磁头悬浮在磁盘上方。一组磁头从0编号。
</p>

<p>
盘片Platter： 涂满磁性材料的盘片，早期是金属的，现在多为玻璃。
</p>

<p>
磁道Track：盘片划分同心圆，同心圆间距越小，一般来说存储容量越大。磁道编号由外向内从0开始。
</p>

<p>
扇区Sector：一个磁道上能够存储的0或1信号太多了，所以需要进一步划分成若干弧段，每一个弧段就是一个扇区。通常一个扇区为512字节。每个扇区都有自己的编号。
</p>

<p>
柱面Cylinder：从垂直方向看，磁道的同心圆就构成了圆柱。编号由外向内从0开始。
</p>



<figure id="orgde7eb8f">
<img src="./images/img_20241230_175531.png" alt="img_20241230_175531.png" width="50%">

</figure>


<p>
注意：盘片内圈扇区面积小，外圈面积大。但扇区都是512字节。外圈磁密度低，内圈磁密度高。
</p>

<p>
如今磁盘，可以做到磁密度一致，所以磁盘划分，外圈可以划分更多扇区，这样可以存储更多数据。这种分区弧长一致的分配扇区方法称为ZBR(Zoned-bit recording)，按照半径分成不同的磁道组称为Zone。这样，转动同样的角度，外圈读取数据更多。
</p>



<figure id="orgc1273be">
<img src="./images/img_20241230_180053.png" alt="img_20241230_180053.png" width="50%">

</figure>


<p>
簇Cluster：操作系统为了优化IO，使用磁盘空间时最小占用的多个扇区。一般簇大小为4-64个扇区(2KB-32KB)。所以，一个文件就有了物理占用空间大小即实际分得的磁盘空间，和逻辑占用大小即文件本身的实际字节数。往往实际占用空间都比文件本身大。越是小文件，越浪费空间。
</p>
</div>
</div>
<div id="outline-container-h:1d3ae9f5-c95c-407c-ac01-a0b0bbbc2fb2" class="outline-4">
<h4 id="h:1d3ae9f5-c95c-407c-ac01-a0b0bbbc2fb2">文件IO常用操作</h4>
<div class="outline-text-4" id="text-h:1d3ae9f5-c95c-407c-ac01-a0b0bbbc2fb2">
<ul class="org-ul">
<li>open 打开</li>
<li>read 读取</li>
<li>write 写稿</li>
<li>close 关闭</li>
<li>readline 行读取</li>
<li>readlines 多行读取</li>
<li>seek 文件指针操作</li>
<li>tell 指针位置</li>
</ul>
</div>
</div>
<div id="outline-container-h:24ccdda9-2032-492c-a77b-28ab8287fe78" class="outline-4">
<h4 id="h:24ccdda9-2032-492c-a77b-28ab8287fe78">打开操作</h4>
<div class="outline-text-4" id="text-h:24ccdda9-2032-492c-a77b-28ab8287fe78">
<p>
open 方法
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #0000ff;">open</span>(
    file, <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25991;&#20214;&#23545;&#35937;&#65292;&#36335;&#24452;</span>
    <span style="color: #a0522d;">mode</span>=<span style="color: #8b2252;">'r'</span>, <span style="color: #b22222;">#</span><span style="color: #b22222;">&#27169;&#24335;</span>
    <span style="color: #a0522d;">buffering</span>=-1, <span style="color: #b22222;">#</span><span style="color: #b22222;">&#32531;&#20914;&#21306;</span>
    <span style="color: #a0522d;">encoding</span>=None, <span style="color: #b22222;">#</span><span style="color: #b22222;">&#32534;&#30721;</span>
    <span style="color: #a0522d;">errors</span>=None, <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20986;&#38169;&#24590;&#20040;&#21150;</span>
    <span style="color: #a0522d;">newline</span>=None, <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36935;&#21040;&#25442;&#34892;&#31526;&#24590;&#20040;&#21150;</span>
    <span style="color: #a0522d;">closefd</span>=True, <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26159;&#21542;&#20851;&#38381;&#25991;&#20214;&#25551;&#36848;&#31526;</span>
    <span style="color: #a0522d;">opener</span>=None, <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25171;&#24320;&#30340;&#26159;&#35841;</span>
)
</pre>
</div>

<p>
打开一个文件，返回一个文件对象（流对象）和文件描述符。打开文件失败，则返回异常
</p>

<p>
基本使用：创建一个文件test，然后打开它，用完 <b>关闭</b>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">open('test') #&#25253;&#38169;&#65292;&#24403;&#21069;&#36335;&#24452;&#19981;&#23384;&#22312;&#65292;FileNotFoundError: [Errno 2] No such file or directory: 'test'</span>

<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'test'</span>)
<span style="color: #b22222;">#</span><span style="color: #b22222;">windows &lt;_io.TextIOWrapper name='test' mode='r' encoding='cp936'&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">linux &lt;_io.TextIOWrapper name='test' mode='r' encoding='UTF-8'&gt;</span>
<span style="color: #483d8b;">print</span>(f.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#35835;&#21462;&#25991;&#20214;</span>
f.close <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20351;&#29992;&#23436;&#21518;&#20851;&#38381;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">open&#25104;&#21151;&#21518;&#65292;&#19968;&#23450;&#21487;&#20197;&#25343;&#21040;&#19968;&#20010;&#25991;&#20214;&#23545;&#35937;&#65292;&#23601;&#21487;&#20197;&#23545;&#23427;&#36827;&#34892;&#22686;&#21024;&#25913;&#26597;&#65292; &#25991;&#20214;&#25805;&#20316;&#65292;&#35835;&#20889;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25991;&#20214;&#23545;&#35937;&#65292;&#40664;&#35748;&#26159;&#25991;&#26412;&#30340;&#25171;&#24320;&#26041;&#24335;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">encoding='cp936' #windows&#40664;&#35748;GBK&#65292;codepage&#20195;&#30721;&#39029; 936 &#31561;&#20215;&#35748;&#20026;&#26159;GBK</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">encoding='UTF-8' #linux&#31995;&#32479;&#40664;&#35748;&#37117;&#26159;&#29992;utf-8 &#20013;&#25991;&#22823;&#22810;&#25968;3&#23383;&#33410;</span>
</pre>
</div>

<p>
文件操作中，最常用的操作就是读和写。
</p>

<p>
文件访问的模式有两种：文本模式和二进制模式。不同模式下，操作函数不尽相同，表现结果也不一样。
</p>

<p>
注：windows中使用codepage代码页，可以认为每一个代码页就是一张编码表。cp936等同于GBK。
</p>
</div>
<div id="outline-container-h:32f353ed-5a1a-46f4-b550-49e9e58e791b" class="outline-5">
<h5 id="h:32f353ed-5a1a-46f4-b550-49e9e58e791b">open的参数</h5>
<div class="outline-text-5" id="text-h:32f353ed-5a1a-46f4-b550-49e9e58e791b">
</div>
<div id="outline-container-h:bf444f38-d92c-4590-b297-37f83fe9793c" class="outline-6">
<h6 id="h:bf444f38-d92c-4590-b297-37f83fe9793c">file</h6>
<div class="outline-text-6" id="text-h:bf444f38-d92c-4590-b297-37f83fe9793c">
<p>
打开或要创建的文件。如果不指定路径，默认是当前路径。
</p>
</div>
</div>
<div id="outline-container-h:78a96a9c-fce9-4e6f-86b8-7133695c7d32" class="outline-6">
<h6 id="h:78a96a9c-fce9-4e6f-86b8-7133695c7d32"><code>mode模式</code></h6>
<div class="outline-text-6" id="text-h:78a96a9c-fce9-4e6f-86b8-7133695c7d32">
<p>
模式描述字符意义：
</p>
<ul class="org-ul">
<li>r 缺省模式，只读打开。文件不存在，立即报错。文件存在，从头开始读，文件指针初始在开头即索引0的位置。</li>
<li>w 只写打开，不支持读取。文件存在，文件内容将被清空，从头写；文件不存在，文件被创建，从头写。白纸一张，从头写，初始位置在0</li>
<li>x 创建并写入一个新文件，不支持读取。文件存在，抛异常；文件不存在不报错，新文件被创建</li>
<li>a 只写打开，追加内容，不支持读取。文件存在，追加写入，文件不存在，创建文件，从头写</li>
<li>b 二进制模式。字节流，将文本按照字节理解，与字符编码无关。二进制模式操作时，字节操作使用bytes类型。不能单独使用，必须和rwax四种之一配合使用，不影响主模式。</li>
<li>t 缺省模式，文本模式。text，默认可以不写。不能单独使用，必须和wrax配合使用，不影响主模式</li>
<li>+ 读或写打开后，使用+来增加缺失的写或读的能力。必须和主模式(rwax)配合使用，不影响主模式。
<ul class="org-ul">
<li>r+ =&gt; rt+ 只读文本模式打开，补充写能力。文件指针在开头。</li>
<li>w+ =&gt; wt+ 只写文本模式打开，补充读能力。w能力不变，会清空所有内容</li>
</ul></li>
</ul>

<p>
在上面的例子中，可以看到默认是文本打开模式，且是只读的。
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">mode rwxabt+</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">r &#21482;&#35835;&#27169;&#24335;</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>)
<span style="color: #483d8b;">print</span>(f) <span style="color: #b22222;">#</span><span style="color: #b22222;">: &lt;_io.TextIOWrapper name='D:/tmp/test' mode='r' encoding='cp936'&gt;</span>
<span style="color: #483d8b;">print</span>(f.readable()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: True &#21487;&#35835;&#30340; r readonly</span>
<span style="color: #483d8b;">print</span>(f.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25991;&#20214;&#31354;&#30340;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">f.write('abc') #&#25253;&#38169; io.UnsupportedOperation: not writable</span>
f.close()


<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, <span style="color: #8b2252;">'r'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21482;&#35835;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">f.write('abc') #&#25253;&#38169; io.UnsupportedOperation: not writable</span>
f.close()

<span style="color: #b22222;">#</span><span style="color: #b22222;">w&#20889;&#27169;&#24335;</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test1'</span>, <span style="color: #8b2252;">'w'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">test1 &#19981;&#23384;&#22312;</span>
<span style="color: #483d8b;">print</span>(f.write(<span style="color: #8b2252;">'abc'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;&#20540;3&#65292;3&#34920;&#31034;&#20889;&#20837;&#30340;&#23383;&#31526;&#25968;&#65311;&#23383;&#33410;&#25968;&#65311;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">print(f.write('&#21834;')) #&#36820;&#22238;1&#65292;&#30446;&#21069;&#36820;&#22238;&#20540;&#26159;&#34920;&#31034;&#23383;&#31526;&#25968;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">f.read() #&#25253;&#38169;&#65292;w&#27169;&#24335;&#26159;&#21482;&#20889;</span>
f.close()

<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test1'</span>, <span style="color: #8b2252;">'w'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">test1&#23384;&#22312;&#65292;w&#25171;&#24320;&#65292;&#20869;&#23481;&#27809;&#20102;</span>
f.write(<span style="color: #8b2252;">'xyz'</span>)
f.close()

<span style="color: #b22222;">#</span><span style="color: #b22222;">a&#27169;&#24335;</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test1'</span>, <span style="color: #8b2252;">'a'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">test1&#23384;&#22312;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">f.read() #a&#27169;&#24335;&#19981;&#25903;&#25345;&#35835;&#21462;</span>
f.write(<span style="color: #8b2252;">'123'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36861;&#21152;&#20889;&#20837;</span>
f.close()


<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test2'</span>, <span style="color: #8b2252;">'a'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">test1&#19981;&#23384;&#22312;&#65292;&#21019;&#24314;&#25991;&#20214;&#65292;&#20174;&#22836;&#20889;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">a&#27169;&#24335;&#65292;&#19981;&#31649;&#25991;&#20214;&#23384;&#22312;&#19982;&#21542;&#65292;&#37117;&#20174;&#23614;&#37096;&#36861;&#21152;&#20889;&#20837;</span>
f.write(<span style="color: #8b2252;">'123</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span>)
f.write(<span style="color: #8b2252;">'789'</span>)
f.close()

<span style="color: #b22222;">#</span><span style="color: #b22222;">x&#27169;&#24335;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">f = open('D:/tmp/test', 'x') #x&#27169;&#24335; exsits&#65292;&#25991;&#20214;&#23384;&#22312;&#65292;&#25253;&#38169;</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/testx'</span>, <span style="color: #8b2252;">'x'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">x&#27169;&#24335; exsits&#65292;&#25991;&#20214;&#19981;&#23384;&#22312;&#65292;&#25991;&#20214;&#34987;&#21019;&#24314;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">f.read() #x&#27169;&#24335;&#19981;&#25903;&#25345;&#35835;&#21462;</span>
f.write(<span style="color: #8b2252;">'testx test'</span>)
f.close()

<span style="color: #b22222;">#</span><span style="color: #b22222;">t&#27169;&#24335; text</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/testx'</span>, <span style="color: #8b2252;">'r'</span>)
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23383;&#31526;&#21644;&#32534;&#30721;&#26377;&#20851;&#65292;&#23383;&#31526;&#20018;&#30340;&#19990;&#30028;&#37117;&#26159;&#30001;&#32534;&#30721;&#30340;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">rwax &#40664;&#35748;&#37117;&#29992;&#25991;&#26412;&#27169;&#24335;&#25171;&#24320; rt wt at xt&#65292;&#19981;&#33021;&#29420;&#31435;&#20351;&#29992;</span>
<span style="color: #483d8b;">print</span>(f) <span style="color: #b22222;">#</span><span style="color: #b22222;">: &lt;_io.TextIOWrapper name='D:/tmp/testx' mode='r' encoding='cp936'&gt;</span>
f.close()

<span style="color: #b22222;">#</span><span style="color: #b22222;">b&#27169;&#24335;&#65292;binnary, &#20108;&#36827;&#21046;</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/testx'</span>, <span style="color: #8b2252;">'rb'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">ab, wb</span>
<span style="color: #483d8b;">print</span>(f) <span style="color: #b22222;"># </span><span style="color: #b22222;">encoding &#23383;&#33410;&#30340;&#19990;&#30028;&#37117;&#26159;0&#21644;1&#32452;&#25104;&#30340;&#23383;&#33410;&#65292;&#21644;&#32534;&#30721;&#26080;&#20851;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: &lt;_io.BufferedReader name='D:/tmp/testx'&gt;</span>
<span style="color: #483d8b;">print</span>(f.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;&#23383;&#33410; : b'testx test'</span>
f.close()

<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/testx'</span>, <span style="color: #8b2252;">'wb'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">ab, wb</span>
f.write(b<span style="color: #8b2252;">'xyz'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;&#19968;&#20010;&#20540;&#65292;&#20889;&#20837;&#30340;&#23383;&#33410;&#25968;</span>
f.write(<span style="color: #8b2252;">'zhongwen'</span>.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#32570;&#23569;&#32534;&#30721;,utf-8&#65292;&#20108;&#36827;&#21046;&#27169;&#24335;&#65292;&#36319;&#23383;&#31526;&#26080;&#20851;</span>
f.close()

<span style="color: #b22222;">#</span><span style="color: #b22222;">+&#27169;&#24335;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">+ &#38468;&#21152;&#30340;&#33021;&#21147;&#65292;&#24517;&#39035;&#21644;&#20027;&#27169;&#24335;(rwax)&#37197;&#21512;&#20351;&#29992;&#65292;&#19981;&#24433;&#21709;&#20027;&#27169;&#24335;&#12290;r+ w+ a+ x+</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/testx'</span>, <span style="color: #8b2252;">'r+'</span>) 
f.read()
f.write(<span style="color: #8b2252;">'xyz'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21487;&#20889;</span>
f.read()  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20889;&#20837;&#26102;&#65292;&#20160;&#20040;&#37117;&#35835;&#19981;&#21040;</span>
f.seek(0) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#29992;&#20102;seek&#20250;&#31435;&#21363;&#20889;&#20837;&#30913;&#30424;</span>
f.read()  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21487;&#20197;&#35835;&#21040; </span>
f.close()

<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/testx'</span>, <span style="color: #8b2252;">'w+'</span>) 
f.read()  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20889;&#20837;&#26102;&#65292;&#20160;&#20040;&#37117;&#35835;&#19981;&#21040;</span>
f.write(<span style="color: #8b2252;">'xyz'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21487;&#20889;</span>
f.close()
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#27880;&#24847;&#25991;&#20214;&#25351;&#38024;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5a4dec9b-5fcb-4135-9d69-64895e2f9fc7" class="outline-6">
<h6 id="h:5a4dec9b-5fcb-4135-9d69-64895e2f9fc7">文件指针</h6>
<div class="outline-text-6" id="text-h:5a4dec9b-5fcb-4135-9d69-64895e2f9fc7">
<p>
文件指针，指向当前字节位置。
</p>

<ul class="org-ul">
<li>mode=r，指针起始在0</li>
<li>mode=a，指针起始在EOF</li>
</ul>

<p>
tell()显示指针当前位置
</p>

<p>
seek(offset[,whence]) 移动文件指针位置。offset偏移多少字节，whence从哪里开始。
</p>

<p>
文本模式下
</p>
<ul class="org-ul">
<li>whence 0 缺省值，表示从头开始，offset只能正整数</li>
<li>whence 1 表示从当前位置，offset只接受0</li>
<li>whence 2 表示从EOF开始，offset只接受0</li>
</ul>

<p>
二进制模式下
</p>
<ul class="org-ul">
<li>whence 0 seek(0) seek(0, 0) seek(x) x &gt;=0</li>
<li>whence 1 表示从当前位置，offset可正可负，不能左超界</li>
<li>whence 2 表示从EOF开始，offset可正可负，不能左超界</li>
</ul>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>

<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, <span style="color: #8b2252;">'w+'</span>)
<span style="color: #483d8b;">print</span>(f.tell()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: 0</span>
<span style="color: #483d8b;">print</span>(f.write(<span style="color: #8b2252;">'abc'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">: 3  &#20889;&#20837;&#20102;3&#20010;&#23383;&#31526;</span>
<span style="color: #483d8b;">print</span>(f.tell()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: 3 &#25351;&#38024;&#31227;&#21160;&#20102;&#65292;&#36820;&#22238;&#30340;&#19968;&#30452;&#26159;&#23383;&#33410;&#30340;&#32034;&#24341;</span>
<span style="color: #483d8b;">print</span>(f.write(<span style="color: #8b2252;">'de'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">: 2  &#20889;&#20837;&#20102;2&#20010;&#23383;&#31526;</span>
<span style="color: #483d8b;">print</span>(f.tell()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: 5 &#25351;&#38024;&#31227;&#21160;&#20102;&#65292;&#24403;&#21069;&#20301;&#32622;&#22312;5</span>
f.close()

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20197;&#25991;&#26412;&#26041;&#24335;&#25171;&#24320; </span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>)
<span style="color: #483d8b;">print</span>(f.tell()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: 0</span>
<span style="color: #483d8b;">print</span>(f.read(2)) <span style="color: #b22222;">#</span><span style="color: #b22222;">: ab</span>
<span style="color: #483d8b;">print</span>(f.tell()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: 2</span>
<span style="color: #483d8b;">print</span>(f.read(1)) <span style="color: #b22222;">#</span><span style="color: #b22222;">: c</span>
<span style="color: #483d8b;">print</span>(f.tell()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: 3</span>
f.seek(0) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#35774;&#32622;&#25351;&#38024;&#20301;&#32622;</span>
<span style="color: #483d8b;">print</span>(f.read(1)) <span style="color: #b22222;">#</span><span style="color: #b22222;">: a</span>
<span style="color: #483d8b;">print</span>(f.tell()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: 1</span>
<span style="color: #483d8b;">print</span>(f.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">bcde &#20174;&#24403;&#21069;&#20301;&#32622;&#21040;&#32467;&#23614;</span>
f.close() 

<span style="color: #b22222;">#</span><span style="color: #b22222;">seek</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>)
f.seek(0, 0) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#31532;&#19968;&#20010;0 &#34920;&#31034;&#20559;&#31227;&#65292;&#31532;&#20108;&#20010;0 &#34920;&#31034;whence 0&#34920;&#31034;&#20174;&#22836;&#24320;&#22987;&#65292;&#25289;&#22238;&#21040;&#24320;&#22836;&#12290;whence 0 &#26159;&#40664;&#35748;&#30340;</span>
<span style="color: #483d8b;">print</span>(f.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">abcde</span>
f.seek(0)
<span style="color: #483d8b;">print</span>(f.read(2)) <span style="color: #b22222;">#</span><span style="color: #b22222;">ab</span>
f.seek(4, 0)
<span style="color: #483d8b;">print</span>(f.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">e</span>
f.seek(0, 2) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36339;&#21040;EOF</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">f.seek(-2, 0) # &#25253;&#38169;&#65292;&#36229;&#20986;&#24038;&#30028;&#65292;&#19981;&#21487;&#20197;</span>
f.seek(20, 0) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21521;&#21491;&#36229;&#30028;&#20801;&#35768;</span>


<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20108;&#36827;&#21046;&#27169;&#24335; seek</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, <span style="color: #8b2252;">'rb'</span>)
f.seek(2)
<span style="color: #b22222;">#</span><span style="color: #b22222;">f.seek(-2) #f.seek(-2, 0) &#30001;&#20110;&#24038;&#36229;&#30028;&#65292;&#25152;&#20197;&#25253;&#38169;</span>
f.seek(-2, 1) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24403;&#21069;&#20301;&#32622;&#21521;&#24038;&#36208;2, &#20294;&#19981;&#33021;&#36229;&#30028;&#65292;&#21542;&#21017;&#25253;&#38169;</span>
<span style="color: #483d8b;">print</span>(f.tell()) <span style="color: #b22222;">#</span><span style="color: #b22222;">0</span>
f.seek(100, 1)
<span style="color: #483d8b;">print</span>(f.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">b'' &#20108;&#36827;&#21046;&#19990;&#30028;&#65292;&#27809;&#26377;&#20160;&#20040;&#20081;&#30721;&#65292;&#26159;&#23383;&#33410;&#23601;&#35835;</span>
</pre>
</div>

<p>
二进制模式支持任意起点的偏移，从头、从尾、从中间位置开始。
</p>

<p>
向后seek可以超界，但是向前seek的时候，不能超界，否则抛异常
</p>
</div>
</div>
<div id="outline-container-h:bd928625-c7cf-4d3b-a8c0-853498054828" class="outline-6">
<h6 id="h:bd928625-c7cf-4d3b-a8c0-853498054828">buffering缓冲区</h6>
<div class="outline-text-6" id="text-h:bd928625-c7cf-4d3b-a8c0-853498054828">
<p>
buffering=-1 使用默认缓冲区大小。如果是二进制模式，使用 <code>io.DEAFAULT_BUFFER_SIZE</code> 值，默认是4096或8192.如果是文本模式，如果是终端设备，是行缓存方式，如果不是，则使用二进制模式的策略。
</p>

<pre class="example" id="org89837db">
0 文本模式不支持；二进制模式无缓冲区, 立即写入磁盘，相当于把文件当做一个FIFO队列用。
1，只在文本模式使用，表示使用行缓冲。意思就是见到换行符\n就flush写入磁盘
  - 文本模式，如果缓冲区撑破了，被迫写入磁盘
  - 二进制模式，1无效，使用的默认缓冲区
- 大于1, 用于指定buffer的大小
  - 文本模式，默认缓冲区
  - 二进制模式，指定大小字节的缓冲区
</pre>


<p>
buffer 缓冲区
</p>

<p>
缓冲区一个内存空间，一般来说是一个FIFO队列，到缓冲区满了或者达到阈值，数据才会flush到磁盘。
</p>

<p>
fush() 将缓冲区数据写入磁盘
</p>

<p>
close() 关闭前会调用flush()
</p>

<p>
<code>io.DEAFAULT_BUFFER_SIZE</code> 缺省缓冲区大小，字节
</p>

<p>
先看二进制模式
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#32531;&#20914;&#21306;&#22823;&#23567;&#20026;0</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, <span style="color: #8b2252;">'w+b'</span>, 0) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25991;&#26412;&#27169;&#24335;&#19981;&#25903;&#25345;&#65292;&#21482;&#22312;&#20108;&#36827;&#21046;&#27169;&#24335;&#65292;&#31435;&#21363;&#20889;&#20837;&#30913;&#30424;</span>
f.write(b<span style="color: #8b2252;">'a'</span>) 
f.write(b<span style="color: #8b2252;">'b'</span>)
<span style="color: #483d8b;">print</span>(f.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;&#31354;&#65292;&#20294;&#25991;&#26412;&#24050;&#34987;&#20889;&#20837;&#20869;&#23481;</span>
f.seek(0)
<span style="color: #483d8b;">print</span>(f.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: b'ab'</span>
f.close()


<span style="color: #b22222;"># </span><span style="color: #b22222;">&#32531;&#20914;&#21306;&#22823;&#23567;&#20026;1</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, <span style="color: #8b2252;">'w+'</span>, 1) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21482;&#22312;&#25991;&#26412;&#27169;&#24335;&#65292;&#20351;&#29992;&#34892;&#32531;&#20914;&#12290;&#35265;&#21040;&#25442;&#34892;&#31526; \n &#23601;flush</span>
f.write(<span style="color: #8b2252;">'a'</span>)
f.write(<span style="color: #8b2252;">'a'</span>)
<span style="color: #483d8b;">print</span>(f.read())
f.write(<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n\t\n</span><span style="color: #8b2252;">'</span>)
<span style="color: #483d8b;">print</span>(f.read())
f.seek(0)
<span style="color: #483d8b;">print</span>(f.read())
f.close()

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#32531;&#20914;&#21306;&#25745;&#30772;&#20102;&#65292;&#34987;&#36843;&#20889;&#20837;&#30913;&#30424;</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, <span style="color: #8b2252;">'w+'</span>, 1) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21482;&#22312;&#25991;&#26412;&#27169;&#24335;&#65292;&#20351;&#29992;&#34892;&#32531;&#20914;&#12290;&#35265;&#21040;&#25442;&#34892;&#31526; \n &#23601;flush</span>
f.write(<span style="color: #8b2252;">'a'</span> * 8100)
f.write(<span style="color: #8b2252;">'b'</span> * 100)
f.close()
<span style="color: #a020f0;">import</span> io
<span style="color: #483d8b;">print</span>(io.DEFAULT_BUFFER_SIZE) <span style="color: #b22222;">#</span><span style="color: #b22222;">: 8192</span>


<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, <span style="color: #8b2252;">'wb+'</span>, 1)  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23545;&#20108;&#36827;&#21046;&#26469;&#35762;&#65292;1&#26080;&#25928;&#65292;</span>
f.write(b<span style="color: #8b2252;">'a'</span>)
f.close()


<span style="color: #b22222;"># </span><span style="color: #b22222;">&#35774;&#32622;&#32531;&#20914;&#21306;&#22823;&#23567;</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, <span style="color: #8b2252;">'wb+'</span>, 2)  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23545;&#20108;&#36827;&#21046;&#26469;&#35762;</span>
f.write(b<span style="color: #8b2252;">'a'</span>)
f.write(b<span style="color: #8b2252;">'b'</span>)
f.close()
</pre>
</div>

<pre class="example" id="orgdb9b8b1">
buffering=-1
t和b，都是io.DEAFAULT_BUFFER_SIZE

buffering=0
b关闭缓冲区
t不支持

bufferin=1
t行缓冲，遇到换行符才flush

buffering&gt;1
b模式表示缓冲大小。缓冲区的值可以超过io.DEAFAULT_BUFFER_SIZE，直到设定的值超出后才把缓冲区flush
t模式，是io.DEAFAULT_BUFFER_SIZE字节，flush完后把当前的字符串也写入磁盘。
</pre>


<p>
一般来说，只需要记得：
</p>
<ul class="org-ul">
<li>文本模式，一般都用默认缓冲区大小</li>
<li>二进制模式，是一个个字节的操作，可以指定buffer大小</li>
<li>一般来说，默认缓冲区大小是个比较好的选择，除非明确知道，否则不调整它</li>
<li>一般编程中，明确知道需要写磁盘了，都会手动调用一次flush，而不是等到自动flush或者close的时候。</li>
</ul>
</div>
</div>
<div id="outline-container-h:21b590c7-41e5-45e2-8ef2-3eafcf215c9b" class="outline-6">
<h6 id="h:21b590c7-41e5-45e2-8ef2-3eafcf215c9b">encoding</h6>
<div class="outline-text-6" id="text-h:21b590c7-41e5-45e2-8ef2-3eafcf215c9b">
<p>
编码，仅文本模式使用
</p>

<p>
None 表示使用缺省编码，依赖操作系统。windows 下缺省 GBK(0xB0A1)， Linux下缺省UTF-8(0xE5 95 8A)
</p>
</div>
</div>
<div id="outline-container-h:20fdf57b-c42d-4c16-8813-1008cda50ad3" class="outline-6">
<h6 id="h:20fdf57b-c42d-4c16-8813-1008cda50ad3">errors</h6>
<div class="outline-text-6" id="text-h:20fdf57b-c42d-4c16-8813-1008cda50ad3">
<p>
什么样的编码错误将被捕获
</p>

<p>
None和'strict' 表示有编码错误将抛出ValueError异常；'ignore'表示忽略
</p>
</div>
</div>
<div id="outline-container-h:7b018d8f-d035-4e48-bf05-5ce8f62a45f0" class="outline-6">
<h6 id="h:7b018d8f-d035-4e48-bf05-5ce8f62a45f0">newline</h6>
<div class="outline-text-6" id="text-h:7b018d8f-d035-4e48-bf05-5ce8f62a45f0">
<p>
文本模式中，换行的转换。取值可以为None、''空串、'\r'、'\n'、'\r\n'
</p>

<p>
读时
</p>
<ul class="org-ul">
<li>None，缺省值，表示'\r'、'\n'、'\r\n' 都被转换为 '\n'</li>
<li>''表示不会自动转换通用换行符，常见换行符都可以认为是换行</li>
<li>其它合法换行字符表示按照该字符分行</li>
</ul>

<p>
写时
</p>
<ul class="org-ul">
<li>None，缺省值，表示'\n'都会被替换为系统缺省行分隔符os.linesep</li>
<li>'\n' 或''空串表示'\n' 不替换</li>
<li>其它合法换行字符表示文本中的'\n'换行符会被替换为指定的换行字符</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">newline &#26032;&#34892;&#65292; \n \r\n</span>
<span style="color: #a0522d;">txt</span> = <span style="color: #8b2252;">'python</span><span style="color: #008b8b;">\r</span><span style="color: #8b2252;">pip</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">xx.com</span><span style="color: #008b8b;">\r\n</span><span style="color: #8b2252;">ok'</span>
<span style="color: #483d8b;">print</span>(txt)

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20889;&#20837;</span>
<span style="color: #a0522d;">txt</span> = <span style="color: #8b2252;">'python</span><span style="color: #008b8b;">\r</span><span style="color: #8b2252;">pip</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">xx.com</span><span style="color: #008b8b;">\r\n</span><span style="color: #8b2252;">ok'</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, <span style="color: #8b2252;">'w+'</span>)
f.write(txt) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20570;&#20102;&#19968;&#20123;&#20107;&#65292;newline </span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">txt = 'python\rpip\r\nxx.com\r\r\nok'</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">None&#65292;&#25226;\n&#25442;&#25104;&#24403;&#21069;&#25805;&#20316;&#31995;&#32479;&#30340;&#40664;&#35748;&#25442;&#34892;&#31526;&#65292;windows \r\n</span>
f.close()

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35835;&#21462;</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">newline=None</span>
<span style="color: #a0522d;">t</span> = f.read()
<span style="color: #483d8b;">print</span>(t.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: b'python\npip\nxx.com\n\nok'</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">None&#65292;\r \n \r\n =&gt; \n &#25226;&#24120;&#35265;&#25442;&#34892;&#31526;&#25442;&#25104;\n</span>
f.seek(0)
<span style="color: #483d8b;">print</span>(f.readlines())<span style="color: #b22222;">#</span><span style="color: #b22222;">: ['python\n', 'pip\n', 'xx.com\n', '\n', 'ok']</span>
f.close


<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, newline=<span style="color: #8b2252;">''</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">newline='' &#20160;&#20040;&#37117;&#19981;&#24178;&#65292;&#25353;&#29031;&#21508;&#31995;&#32479;&#25442;&#34892;&#22788;&#29702;</span>
<span style="color: #a0522d;">t</span> = f.read()
<span style="color: #483d8b;">print</span>(t.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: b'python\rpip\r\nxx.com\r\r\nok'</span>
f.seek(0)
<span style="color: #483d8b;">print</span>(f.readlines()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: ['python\r', 'pip\r\n', 'xx.com\r', '\r\n', 'ok']</span>
f.close


<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, newline=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">newline='\n' &#20160;&#20040;&#37117;&#19981;&#24178;&#65292;&#25991;&#20214;&#22788;&#29702;&#25353;\n&#22788;&#29702;</span>
<span style="color: #a0522d;">t</span> = f.read()
<span style="color: #483d8b;">print</span>(t.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: b'python\rpip\r\nxx.com\r\r\nok'</span>
f.seek(0)
<span style="color: #483d8b;">print</span>(f.readlines()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: ['python\rpip\r\n', 'xx.com\r\r\n', 'ok']</span>
f.close

<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, newline=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\r</span><span style="color: #8b2252;">'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">newline='\r' &#20160;&#20040;&#37117;&#19981;&#24178;&#65292;&#25991;&#20214;&#22788;&#29702;&#25353;\r&#22788;&#29702;</span>
<span style="color: #a0522d;">t</span> = f.read()
<span style="color: #483d8b;">print</span>(t.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: b'python\rpip\r\nxx.com\r\r\nok'</span>
f.seek(0)
<span style="color: #483d8b;">print</span>(f.readlines()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: ['python\r', 'pip\r', '\nxx.com\r', '\r', '\nok']</span>
f.close


<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>, newline=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\r\n</span><span style="color: #8b2252;">'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">newline='\r\n' &#20160;&#20040;&#37117;&#19981;&#24178;&#65292;&#25991;&#20214;&#22788;&#29702;&#25353;\r\n&#22788;&#29702;</span>
<span style="color: #a0522d;">t</span> = f.read()
<span style="color: #483d8b;">print</span>(t.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: b'python\rpip\r\nxx.com\r\r\nok'</span>
f.seek(0)
<span style="color: #483d8b;">print</span>(f.readlines()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: ['python\rpip\r\n', 'xx.com\r\r\n', 'ok']</span>
f.close
</pre>
</div>
</div>
</div>
<div id="outline-container-h:0124bd00-d82d-455a-9031-1b6f3a30da7d" class="outline-6">
<h6 id="h:0124bd00-d82d-455a-9031-1b6f3a30da7d">其它</h6>
<div class="outline-text-6" id="text-h:0124bd00-d82d-455a-9031-1b6f3a30da7d">
<p>
closefd 关闭文件描述符，True表示关闭它。False会在文件关闭后保持这个描述符。fileobj.fileno()查看
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">open(</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">file, #&#25991;&#20214;&#23545;&#35937;&#65292;&#36335;&#24452;</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">mode='r', #&#27169;&#24335;</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">buffering=-1, #&#32531;&#20914;&#21306;</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">encoding=None, #&#32534;&#30721;</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">errors=None, #&#20986;&#38169;&#24590;&#20040;&#21150;</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">newline=None, #&#36935;&#21040;&#25442;&#34892;&#31526;&#24590;&#20040;&#21150;</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">closefd=True, #&#26159;&#21542;&#20851;&#38381;&#25991;&#20214;&#25551;&#36848;&#31526;</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">opener=None, #&#25171;&#24320;&#30340;&#26159;&#35841;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">)</span>

<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>)
<span style="color: #483d8b;">print</span>(f.fileno()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25991;&#20214;&#25551;&#36848;&#31526;</span>
f.close() <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20851;&#38381;&#21518;&#65292;&#25991;&#20214;&#25551;&#36848;&#31526;&#20851;&#38381;</span>
<span style="color: #483d8b;">print</span>(f.closed) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26159;&#21542;&#20851;&#38381;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: 3</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: True</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-h:a6d80630-c7fb-4627-baa6-8ed63b244fcf" class="outline-4">
<h4 id="h:a6d80630-c7fb-4627-baa6-8ed63b244fcf">read</h4>
<div class="outline-text-4" id="text-h:a6d80630-c7fb-4627-baa6-8ed63b244fcf">
<p>
read(size=-1)
</p>

<p>
size表示读取的多少字符或字节；负数或者None表示读取到EOF
</p>
</div>
</div>
<div id="outline-container-h:a26b58fd-8e4c-4f78-a083-394ce769a642" class="outline-4">
<h4 id="h:a26b58fd-8e4c-4f78-a083-394ce769a642">行读取</h4>
<div class="outline-text-4" id="text-h:a26b58fd-8e4c-4f78-a083-394ce769a642">
<p>
readline(size=-1)
</p>

<p>
一行行读取文件内容。size设置一次能读取行内几个字符或字节
</p>

<p>
readlines(hint=-1)
</p>

<p>
读取所有行的列表。指定hint则返回指定的列表。
</p>

<p>
常用的读取方式
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25353;&#34892;&#36845;&#20195;</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'D:/tmp/test'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;&#21487;&#36845;&#20195;&#23545;&#35937;&#65292;&#24816;&#24615;&#30340;</span>

<span style="color: #a020f0;">for</span> line <span style="color: #a020f0;">in</span> f:
    <span style="color: #483d8b;">print</span>(line.strip())

f.close()
</pre>
</div>
</div>
</div>
<div id="outline-container-h:d5437ec9-c327-48c5-bb96-ed34b81c3c43" class="outline-4">
<h4 id="h:d5437ec9-c327-48c5-bb96-ed34b81c3c43">write</h4>
<div class="outline-text-4" id="text-h:d5437ec9-c327-48c5-bb96-ed34b81c3c43">
<p>
write(s)，把字符串s写入到文件中并返回字符的个数
</p>

<p>
writelines(lines)，将字符串列表写入文件。
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'d:/tmp/test'</span>, <span style="color: #8b2252;">'w+'</span>)

<span style="color: #a0522d;">lines</span> = [<span style="color: #8b2252;">'abc'</span>, <span style="color: #8b2252;">'123</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span>, <span style="color: #8b2252;">'cici'</span>] <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25552;&#20379;&#25442;&#34892;&#31526;</span>
f.writelines(lines) <span style="color: #b22222;">#</span><span style="color: #b22222;">writelines &#20294;&#26159;&#19981;&#35299;&#20915;&#25442;&#34892;&#38382;&#39064;</span>

f.seek(0)
<span style="color: #483d8b;">print</span>(f.read())
f.close()

<span style="color: #b22222;">#</span><span style="color: #b22222;">: abc123</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: cici</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a71fcfab-5051-44fd-9a84-04a4a580e461" class="outline-4">
<h4 id="h:a71fcfab-5051-44fd-9a84-04a4a580e461">close</h4>
<div class="outline-text-4" id="text-h:a71fcfab-5051-44fd-9a84-04a4a580e461">
<p>
flush 并关闭文件对象
</p>

<p>
文件已经关闭，再次关闭没有任何效果
</p>
</div>
</div>
<div id="outline-container-h:5bab3a91-7d12-497b-8b7f-0f687fb2927a" class="outline-4">
<h4 id="h:5bab3a91-7d12-497b-8b7f-0f687fb2927a">其他</h4>
<div class="outline-text-4" id="text-h:5bab3a91-7d12-497b-8b7f-0f687fb2927a">
<ul class="org-ul">
<li>seekable() 是否可seek</li>
<li>readable() 是否可读</li>
<li>writeable() 是否可写</li>
<li>closed  是否已经关闭</li>
</ul>
</div>
</div>
<div id="outline-container-h:0af6a034-5e05-4707-8770-52633197628e" class="outline-4">
<h4 id="h:0af6a034-5e05-4707-8770-52633197628e">上下文管理</h4>
<div class="outline-text-4" id="text-h:0af6a034-5e05-4707-8770-52633197628e">
</div>
<div id="outline-container-h:eba8a9c3-0de1-4d1b-a6df-b6c7787ed5fe" class="outline-5">
<h5 id="h:eba8a9c3-0de1-4d1b-a6df-b6c7787ed5fe">问题的引出</h5>
<div class="outline-text-5" id="text-h:eba8a9c3-0de1-4d1b-a6df-b6c7787ed5fe">
<p>
文件打开会占文件描述符。
</p>

<p>
在Linux中，执行
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25171;&#24320;2000&#20010;&#25991;&#20214;</span>
<span style="color: #a0522d;">lst</span> = []
<span style="color: #a020f0;">for</span> _ <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(2000):
    lst.append(<span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'test'</span>))
<span style="color: #b22222;"># </span><span style="color: #b22222;">OSError: [Error 24] Too many open files: 'test'</span>

<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">len</span>(lst))
</pre>
</div>

<p>
lsof 列出打开的文件。 <code>yum install lsof</code> 安装
</p>

<div class="org-src-container">
<pre class="src src-sh">ps aux |grep python

lsof -p 9255|grep test| wc -l

<span style="color: #483d8b;">ulimit</span> -a
open file  1024 <span style="color: #b22222;"># </span><span style="color: #b22222;">&#33021;&#25171;&#24320;&#30340;&#25991;&#20214;&#25551;&#36848;&#31526;&#25968;&#65292;&#40664;&#35748;1024</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9a3b9c16-e60b-4e27-876e-3a72d23dd4b1" class="outline-5">
<h5 id="h:9a3b9c16-e60b-4e27-876e-3a72d23dd4b1">上下文管理</h5>
<div class="outline-text-5" id="text-h:9a3b9c16-e60b-4e27-876e-3a72d23dd4b1">
<p>
上下文管理：
</p>
<ul class="org-ul">
<li>使用with关键字，上下文管理针对的是with后的对象</li>
<li>可以使用as关键字</li>
<li>上下文管理的语句块并不会开启新的作用域</li>
</ul>

<p>
文件对象上下文管理
</p>
<ul class="org-ul">
<li>进入with时，with后的文件对象是被管理对象</li>
<li>as子句后的标识符，指向with后的文件对象</li>
<li>with语句块执行完的时候，会自动关闭文件对象</li>
</ul>

<p>
解决
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>

<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'d:/tmp/test'</span>)
<span style="color: #a020f0;">try</span>:  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23581;&#35797;&#25429;&#33719;try&#24322;&#24120;</span>
    <span style="color: #483d8b;">print</span>(f.closed)
    f.write(<span style="color: #8b2252;">'abc'</span>)
    <span style="color: #483d8b;">print</span>(f.read())
<span style="color: #a020f0;">finally</span>:
    f.close()

<span style="color: #483d8b;">print</span>(f.closed)
</pre>
</div>

<p>
with使用
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">with</span> &#23545;&#35937; [<span style="color: #a020f0;">as</span> &#26631;&#35782;&#31526;]:
    <span style="color: #a020f0;">pass</span> 
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>

<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'d:/tmp/test'</span>) <span style="color: #a020f0;">as</span> <span style="color: #a0522d;">f</span>: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22312;&#25991;&#20214;&#23545;&#35937;with&#23427;&#65292;as f&#65292;f &#23601;&#26159;&#35813;&#25991;&#20214;&#23545;&#35937; f = open('d:/tmp/test')</span>
    <span style="color: #483d8b;">print</span>(f)
    <span style="color: #483d8b;">print</span>(f.closed) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26159;&#19981;&#20851;&#38381;</span>
    <span style="color: #483d8b;">print</span>(f.read())
    <span style="color: #b22222;">#</span><span style="color: #b22222;">with&#35821;&#21477;&#22359;&#32467;&#26463;&#20102;&#65292;&#33258;&#21160;&#35843;&#29992;&#35813;&#25991;&#20214;&#23545;&#35937;&#30340;close&#26041;&#27861;&#65292;&#20986;&#38169;&#26102;&#20063;&#20250;&#35843;&#29992;close&#26041;&#27861;</span>

<span style="color: #a0522d;">f</span> = <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'d:/tmp/test'</span>)
<span style="color: #a020f0;">with</span> f:
    <span style="color: #483d8b;">print</span>(f)
    <span style="color: #483d8b;">print</span>(f.closed)
    <span style="color: #483d8b;">print</span>(f.read())
    <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21738;&#24597;&#20986;&#29616;&#24322;&#24120;&#65292;&#31163;&#24320;with&#26102;&#65292;&#20381;&#28982;&#35843;&#29992;with&#21518;&#25991;&#20214;&#23545;&#35937;&#30340;close&#26041;&#27861;</span>

<span style="color: #483d8b;">print</span>(f.closed) <span style="color: #b22222;">#</span><span style="color: #b22222;">True</span>
</pre>
</div>

<ul class="org-ul">
<li>对象类似于文件对象的IO对象，一般来说都需要在不使用的时候关闭、注销，以释放资源</li>
<li>IO被打开的时候，会获得一个文件描述符。计算机资源是有限的，所以操作系统都会做限制。就是为了保护计算机的资源不要被完全耗尽，计算资源是很多程序共享的，不是独占的。</li>
<li>一般情况下，除非特别明确的知道当前资源情况，否则不要盲目提高资源的限制值解决问题。</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-h:12de2029-76d5-471f-9f8d-ff42ca340d1d" class="outline-3">
<h3 id="h:12de2029-76d5-471f-9f8d-ff42ca340d1d">StringIO和BytesIO</h3>
<div class="outline-text-3" id="text-h:12de2029-76d5-471f-9f8d-ff42ca340d1d">
<p>
<b>StringIO</b>
</p>
<ul class="org-ul">
<li>io模块中的类
<ul class="org-ul">
<li>from io import StringIO</li>
</ul></li>
<li>内存中，开辟的一个 <b>文本模式</b> 的buffer，可以像文件对象一样操作它</li>
<li>当close方法被调用的时候，这个buffer会被释放</li>
</ul>

<p>
getvalue()获取全部内容。跟文件指针没有关系。
</p>

<p>
好处
</p>

<p>
一般来说，磁盘的操作比内存的操作要慢得多，内存足够的情况下，一般的优化思路是少 <b>落地</b> ，减少磁盘IO的过程，可以大大提高程序的运行效率。
</p>

<p>
<b>BytesIO</b>
</p>
<ul class="org-ul">
<li>io模块中类
<ul class="org-ul">
<li>from io import BytesIO</li>
</ul></li>
<li>内存中，开辟的一个二进制模式的buffer，可以像文件对象一样操作它</li>
<li>当close方法被调用的时候，这个buffer会被释放</li>
</ul>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> io <span style="color: #a020f0;">import</span> StringIO, BytesIO

<span style="color: #a0522d;">s</span> = StringIO() <span style="color: #b22222;">#</span><span style="color: #b22222;">IO&#32531;&#20914;&#21306;&#65292;&#25991;&#26412;</span>
<span style="color: #483d8b;">print</span>(s.seekable(), s.readable(), s.writable())
<span style="color: #483d8b;">print</span>(s.read())
<span style="color: #483d8b;">print</span>(s.write(<span style="color: #8b2252;">'abc'</span>))
<span style="color: #483d8b;">print</span>(s.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#27809;&#35835;&#21040;&#65292;&#25991;&#20214;&#25351;&#38024;&#25351;&#21040;&#26368;&#21518;&#20102;</span>
s.seek(0)
<span style="color: #483d8b;">print</span>(s.readlines()) <span style="color: #b22222;">#</span><span style="color: #b22222;">['abc']</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">print(s.fileno()) #&#27809;&#26377;&#25991;&#20214;&#25551;&#36848;&#31526;&#65292;&#27809;&#26377;&#20351;&#29992;&#12290;&#20869;&#23384;&#20013;&#19996;&#35199;</span>
<span style="color: #483d8b;">print</span>(s.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#19978;&#38754;&#35835;&#23436;&#23601;&#35835;&#19981;&#20986;&#19996;&#35199;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'-'</span> * 30)
<span style="color: #483d8b;">print</span>(s.getvalue()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20869;&#23384;&#20013;&#24314;&#31435;&#31867;&#25991;&#20214;&#23545;&#35937;&#65292;&#26080;&#35270;&#25351;&#38024;&#65292;&#30452;&#25509;&#33719;&#21462;&#20840;&#37096;&#25968;&#25454;</span>
s.close()
 <span style="color: #b22222;">#</span><span style="color: #b22222;">True True True</span>
<span style="color: #b22222;">#</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">3</span>
<span style="color: #b22222;">#</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">['abc']</span>
<span style="color: #b22222;">#</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">------------------------------</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">abc</span>



<span style="color: #a0522d;">s</span> = BytesIO() <span style="color: #b22222;">#</span><span style="color: #b22222;">IO&#32531;&#20914;&#21306;&#65292;&#23383;&#33410;</span>
<span style="color: #483d8b;">print</span>(s.seekable(), s.readable(), s.writable())
<span style="color: #483d8b;">print</span>(s.read())
<span style="color: #483d8b;">print</span>(s.write(b<span style="color: #8b2252;">'abc'</span>))
<span style="color: #483d8b;">print</span>(s.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#27809;&#35835;&#21040;&#65292;&#25991;&#20214;&#25351;&#38024;&#25351;&#21040;&#26368;&#21518;&#20102;</span>
s.seek(0)
<span style="color: #483d8b;">print</span>(s.readlines()) <span style="color: #b22222;">#</span><span style="color: #b22222;">[b'abc']</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">print(s.fileno()) #&#27809;&#26377;&#25991;&#20214;&#25551;&#36848;&#31526;&#65292;&#27809;&#26377;&#20351;&#29992;&#12290;&#20869;&#23384;&#20013;&#19996;&#35199;</span>
<span style="color: #483d8b;">print</span>(s.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#19978;&#38754;&#35835;&#23436;&#23601;&#35835;&#19981;&#20986;&#19996;&#35199;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'-'</span> * 30)
<span style="color: #483d8b;">print</span>(s.getvalue()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20869;&#23384;&#20013;&#24314;&#31435;&#31867;&#25991;&#20214;&#23545;&#35937;&#65292;&#26080;&#35270;&#25351;&#38024;&#65292;&#30452;&#25509;&#33719;&#21462;&#20840;&#37096;&#25968;&#25454;</span>
s.close()
<span style="color: #b22222;">#</span><span style="color: #b22222;">True True True</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">b''</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">3</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">b''</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">[b'abc']</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">b''</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">------------------------------</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">b'abc'</span>


<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25903;&#25345;&#19978;&#19979;&#25991;</span>
<span style="color: #a0522d;">s</span> = BytesIO() <span style="color: #b22222;">#</span><span style="color: #b22222;">IO&#32531;&#20914;&#21306;&#65292;&#23383;&#33410;</span>
<span style="color: #a020f0;">with</span> s:
    <span style="color: #483d8b;">print</span>(s.seekable(), s.readable(), s.writable())
    <span style="color: #483d8b;">print</span>(s.read())
    <span style="color: #483d8b;">print</span>(s.write(b<span style="color: #8b2252;">'abc'</span>))
    <span style="color: #483d8b;">print</span>(s.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#27809;&#35835;&#21040;&#65292;&#25991;&#20214;&#25351;&#38024;&#25351;&#21040;&#26368;&#21518;&#20102;</span>
    s.seek(0)
    <span style="color: #483d8b;">print</span>(s.readlines()) <span style="color: #b22222;">#</span><span style="color: #b22222;">[b'abc']</span>
    <span style="color: #b22222;">#</span><span style="color: #b22222;">print(s.fileno()) #&#27809;&#26377;&#25991;&#20214;&#25551;&#36848;&#31526;&#65292;&#27809;&#26377;&#20351;&#29992;&#12290;&#20869;&#23384;&#20013;&#19996;&#35199;</span>
    <span style="color: #483d8b;">print</span>(s.read()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#19978;&#38754;&#35835;&#23436;&#23601;&#35835;&#19981;&#20986;&#19996;&#35199;</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'-'</span> * 30)
    <span style="color: #483d8b;">print</span>(s.getvalue()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20869;&#23384;&#20013;&#24314;&#31435;&#31867;&#25991;&#20214;&#23545;&#35937;&#65292;&#26080;&#35270;&#25351;&#38024;&#65292;&#30452;&#25509;&#33719;&#21462;&#20840;&#37096;&#25968;&#25454;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">s.close()</span>
<span style="color: #483d8b;">print</span>(s.closed)
</pre>
</div>

<p>
<b>flie-like对象</b>
</p>
<ul class="org-ul">
<li>类文件对象，可以像文件对象一样操作</li>
<li>socket对象、标准输入输出对象(stdin、stdout) 都是类文件对象</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> sys <span style="color: #a020f0;">import</span> stderr, stdout <span style="color: #b22222;">#</span><span style="color: #b22222;">0 stdin; 1 stdout; 2 stderr</span>

<span style="color: #a0522d;">f</span> = stdout <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21487;&#20889;</span>
<span style="color: #483d8b;">print</span>(f.seekable(), f.writable(), f.readable())
f.write(<span style="color: #8b2252;">'abc'</span>)
<span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'xzy'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#35843;&#29992;stdout</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: True True False</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: abcxzy</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> sys <span style="color: #a020f0;">import</span> stderr, stdout <span style="color: #b22222;">#</span><span style="color: #b22222;">0 stdin; 1 stdout; 2 stderr</span>
<span style="color: #a0522d;">f1</span> = stderr
<span style="color: #483d8b;">print</span>(f1.seekable(), f1.writable(), f1.readable())
f1.write(<span style="color: #8b2252;">'123'</span>)
<span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'456'</span>, <span style="color: #483d8b;">file</span>=stderr)

<span style="color: #b22222;">#</span><span style="color: #b22222;">False True False</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">123456</span>
</pre>
</div>


<div class="org-src-container">
<pre class="src src-sh">&gt;&gt;&gt; help(print)
Help on built-in <span style="color: #a020f0;">function</span> <span style="color: #0000ff;">print</span><span style="color: #a020f0;"> in</span> module builtins:

<span style="color: #0000ff;">print</span>(*args, <span style="color: #a0522d;">sep</span>=<span style="color: #8b2252;">' '</span>, <span style="color: #a0522d;">end</span>=<span style="color: #8b2252;">'\n'</span>, <span style="color: #a0522d;">file</span>=None, <span style="color: #a0522d;">flush</span>=False)
    Prints the values to a stream, or to sys.stdout by default.

    sep
      string inserted between values, default a space.
    end
      string appended after the last value, default a newline.
    file
      a file-like object (stream); defaults to the current sys.stdout.
    flush
      whether to forcibly flush the stream.
</pre>
</div>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'d:/tmp/test'</span>, <span style="color: #8b2252;">'w'</span>) <span style="color: #a020f0;">as</span> f:
    <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'abcdef</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">1234'</span>, <span style="color: #483d8b;">file</span>=f) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20889;&#21040;&#25991;&#20214;&#20013;</span>
    <span style="color: #b22222;">#</span><span style="color: #b22222;">f.close()</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:b5765d40-b994-4482-b171-0c0039ebe09a" class="outline-3">
<h3 id="h:b5765d40-b994-4482-b171-0c0039ebe09a">正则表达式基础</h3>
<div class="outline-text-3" id="text-h:b5765d40-b994-4482-b171-0c0039ebe09a">
</div>
<div id="outline-container-h:0e68249f-c9c7-4834-923e-4bac1389a049" class="outline-4">
<h4 id="h:0e68249f-c9c7-4834-923e-4bac1389a049">概述</h4>
<div class="outline-text-4" id="text-h:0e68249f-c9c7-4834-923e-4bac1389a049">
<p>
正则表达式，Regular Expression，缩写为regex、regexp、RE等
</p>

<p>
正则表达式是文本处理极为重要的技术，用它可以对字符串按照某种规则进行检索、替换。
</p>

<p>
1970年代，Unix之父Ken Thompson将正则表达式引入到Unix中文本编辑器ed和grep命令中，由此正则表达式普及开来。
</p>

<p>
1980年后，perl语言对HenrySpencer编写的库，扩展了很多新的特性。1997年开始，Philip Hazel开发出了PCRE (Perl Compatible Regular Expressions)，它被PHP和HTTPD等工具采用。
</p>

<p>
正则表达式应用极其广泛，shell中处理文本的命令、各种高级编程语言都支持正则表达式。
</p>

<p>
参考
</p>
<ul class="org-ul">
<li>正则表达式30分钟入门教程 <a href="https://www.w3cschool.cn/regex_rmjc/">https://www.w3cschool.cn/regex_rmjc/</a></li>
<li>perl文官正则: <a href="https://perldoc.perl.org/perlre">https://perldoc.perl.org/perlre</a></li>
<li>grep 中正则: <a href="https://www.gnu.org/software/grep/manual/grep.html#Regular-Expressions">https://www.gnu.org/software/grep/manual/grep.html#Regular-Expressions</a></li>
<li>python re正则表达式: <a href="https://docs.python.org/zh-cn/3/library/re.html">https://docs.python.org/zh-cn/3/library/re.html</a></li>
<li>Microsoft
<ul class="org-ul">
<li>.NET正则: <a href="https://learn.microsoft.com/en-us/dotnet/standard/base-types/regular-expressions">https://learn.microsoft.com/en-us/dotnet/standard/base-types/regular-expressions</a></li>
<li>visual studio ide 正则: <a href="https://learn.microsoft.com/en-us/visualstudio/ide/using-regular-expressions-in-visual-studio?view=vs-2022">https://learn.microsoft.com/en-us/visualstudio/ide/using-regular-expressions-in-visual-studio?view=vs-2022</a></li>
</ul></li>
<li>基础正则表达式: <a href="https://www.cnblogs.com/f-ck-need-u/p/9621130.html">https://www.cnblogs.com/f-ck-need-u/p/9621130.html</a></li>
<li>Perl正则表达式超详细教程: <a href="https://www.cnblogs.com/f-ck-need-u/p/9648439.html">https://www.cnblogs.com/f-ck-need-u/p/9648439.html</a></li>
</ul>

<p>
测试：
</p>
<ul class="org-ul">
<li>正则测试工具RegEx Tester: <a href="https://sourceforge.net/projects/regextester/">https://sourceforge.net/projects/regextester/</a></li>
<li>在线测试：<a href="https://regextester.github.io/">https://regextester.github.io/</a></li>
</ul>

<p>
正则表达式是一个特殊的字符序列，用于判断一个字符串是否与我们所设定的字符序列是否匹配，也就是说检查一个字符串是否与某种模式匹配。
</p>

<p>
正则表达式可以包含普通或者特殊字符。绝大部分普通字符，比如 'A' , 'a' , 或者 '0' ，都是最简单的正则表达式。它们就匹配自身。你可以拼接普通字符，所以 cici 匹配字符串 'cici' .
</p>

<p>
一些字符，如 <code>'|'</code> or <code>'('</code> ，是特殊的。特殊字符要么代表普通字符的类别，要么影响它们周围的正则表达式的解释方式。正则表达式模式字符串可能不包含空字节，但可以使用 \number 符号指定空字节，例如 '\x00' .
</p>

<p>
重复修饰符 ( * , + , ? , {m,n} , 等) 不能直接嵌套。这样避免了非贪婪后缀 ? 修饰符，和其他实现中的修饰符产生的多义性。要应用一个内层重复嵌套，可以使用括号。 比如，表达式 <code>(?:a{6})*</code> 匹配6个 'a' 字符重复任意次数。
</p>
</div>
</div>
<div id="outline-container-h:ffca9d72-1713-4481-a127-aa1fe7c66cf4" class="outline-4">
<h4 id="h:ffca9d72-1713-4481-a127-aa1fe7c66cf4">分类</h4>
<div class="outline-text-4" id="text-h:ffca9d72-1713-4481-a127-aa1fe7c66cf4">
<ul class="org-ul">
<li>BRE 基本正则表达式，grep、sed、vi等软件支持。vim有扩展</li>
<li>ERE 扩展正则表达式，egrep(grep -E) 、sed -r等</li>
<li>PCRE 几乎所有高级语言都是PCRE的方言或变种。Python从1.6开始使用SRE正则表达式引擎，可以认为是PCRE的子集，见模块re。</li>
</ul>
</div>
</div>
<div id="outline-container-h:06cf2469-2748-4006-aa60-a23235f36909" class="outline-4">
<h4 id="h:06cf2469-2748-4006-aa60-a23235f36909">基本语法</h4>
<div class="outline-text-4" id="text-h:06cf2469-2748-4006-aa60-a23235f36909">
</div>
<div id="outline-container-h:c6ab72e4-7685-482c-8007-00d4dd5619e7" class="outline-5">
<h5 id="h:c6ab72e4-7685-482c-8007-00d4dd5619e7">元字符</h5>
<div class="outline-text-5" id="text-h:c6ab72e4-7685-482c-8007-00d4dd5619e7">
<p>
metacharacter
<a href="https://www.cnblogs.com/f-ck-need-u/p/9621130.html#%E5%85%83%E5%AD%97%E7%AC%A6">https://www.cnblogs.com/f-ck-need-u/p/9621130.html#%E5%85%83%E5%AD%97%E7%AC%A6</a>
</p>

<pre class="example" id="org4e81854">
. 匹配除换行符外的任意一个字符。如.
[abc] 字符集合，只能表示一个字符位置。匹配所包含的任意一个字符。如[abc]匹配plain中的'a'
[^abc] 字符集合，只能表示一个字符位置。匹配除去集合内字符的任意一个字符。如 [^abc]可以匹配plain中的'p'、'l'、'i' 或者'n'
[a-z] 字符范围，也是个集合，表示一个字符位置 ；匹配所有包含的任意字符。常用[A-Z][0-9]
[^a-z] 字符范围，也是个集合，表示一个字符位置;匹配除去集合内字符的任意一个字符。
\b 匹配单词的边界。如\bb在文本中找到单词中b开头的b字符
\B 不匹配单词的边界。如t\B 包含t的单词但是不以t结尾的t字符，例如write; \Bb不以b开头的含有b的单词，例如able
\d [0-9]匹配1位数字
\D [^0-9]匹配1位数字 
\s 匹配1位空白字符，包含换行符、制表符、空格 [\f\r\n\t\v]
\S 匹配1位非空白字符
\w 匹配[a-zA-Z0-9_]
\W 匹配\w之外的字符
</pre>

<p>
范例：使用正则工具或者在线正则网站测试
</p>
<pre class="example" id="org64c6c69">
abc xyz
123
中文
</pre>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">.</span> <span style="color: #b22222;">#</span><span style="color: #b22222;">&#38750;&#22810;&#34892;&#21644;&#21333;&#34892;&#19979;&#65292;&#40664;&#35748;&#21305;&#37197;&#38500;&#25442;&#34892;&#31526;&#20043;&#22806;&#20219;&#24847;&#19968;&#20010;&#23383;&#31526;</span>
\w\w <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;2&#20010;&#23383;&#31526;</span>
\d <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;1&#20010;&#25968;&#23383;</span>
[abc ] <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;abc&#21644;&#31354;&#26684;&#20013;&#20219;&#24847;&#19968;&#20010;&#23383;&#31526;</span>
[abc\s] <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;abc&#21644;&#31354;&#26684;&#23383;&#31526;&#20013;&#20219;&#24847;&#19968;&#20010;&#23383;&#31526;</span>
\w\s\w <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;c x&#21644;z&#25442;&#34892;1&#21644;3&#25442;&#34892;&#20013;</span>
[\d\s\d] <span style="color: #b22222;">#</span><span style="color: #b22222;">&#30456;&#24403;&#20110;[\d\s] &#21305;&#37197;&#25968;&#23383;&#21644;&#31354;&#30333;&#23383;&#31526;&#20013;&#20219;&#24847;&#23383;&#31526;</span>
\b\w\w\b <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21363;&#20316;&#35789;&#39318;&#21448;&#20316;&#35789;&#23614;&#65292;&#21305;&#37197;&#20013;&#25991;</span>
</pre>
</div>



<figure id="orge8f040d">
<img src="./images/img_20250103_141447.png" alt="img_20250103_141447.png" width="50%">

</figure>



<figure id="orgf0a060e">
<img src="./images/img_20250103_141659.png" alt="img_20250103_141659.png" width="50%">

</figure>
</div>
</div>
<div id="outline-container-h:af31538c-eff4-46bf-ac59-90aa178a1a52" class="outline-5">
<h5 id="h:af31538c-eff4-46bf-ac59-90aa178a1a52">转义</h5>
<div class="outline-text-5" id="text-h:af31538c-eff4-46bf-ac59-90aa178a1a52">
<p>
凡是在正则表达式中有特殊意义的符号，如果想使用它的本意，请使用\转义。
</p>

<p>
反斜杠自身，得使用<br>
</p>

<p>
\r、\n还是转义后代表回车、换行
</p>
</div>
</div>
<div id="outline-container-h:72abb7e8-d1ff-40bd-bbba-ac0837d1a337" class="outline-5">
<h5 id="h:72abb7e8-d1ff-40bd-bbba-ac0837d1a337">重复</h5>
<div class="outline-text-5" id="text-h:72abb7e8-d1ff-40bd-bbba-ac0837d1a337">
<p>
<a href="https://www.cnblogs.com/f-ck-need-u/p/9621130.html#%E5%85%83%E5%AD%97%E7%AC%A6">https://www.cnblogs.com/f-ck-need-u/p/9621130.html#%E5%85%83%E5%AD%97%E7%AC%A6</a>
</p>

<pre class="example" id="org2522844">
* 表示前面的正则表达式会重复0次或多次。如e\w*单词中e后面可以有非空白字符
+ 表示前面的正则表达式重复至少1次。如e\w+单词中e后面至少有一个非空白字符
? 表示前面的正则表达式会重复0次或1次。如e\w?单词中e后面至多有一个非空白字符
{n} 重复固定的n次。如e\w{1} 单词中e后面只能有一个非空白字符
{n,} 重复至少n次。如 e\w{1,} =&gt; e\w+  e\w{0,} =&gt; e\w* e\w{0,1} =&gt; e\w?
{n,m} 重复n到m次。如e\w{1,10}单词中e后面至少1个，至多10个非空白字符
</pre>

<p>
范例：使用正则工具或者在线正则网站测试
</p>
<pre class="example" id="orga185f84">
abc xyz
123
中文
</pre>

<div class="org-src-container">
<pre class="src src-sh">\w\w?  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;&#19968;&#20010;&#23383;&#31526;&#65292;&#21518;&#38754;&#21487;&#26377;&#21487;&#26080;&#19968;&#20010;&#23383;&#31526;</span>
\w\w+  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;&#19968;&#20010;&#23383;&#31526;&#65292;&#21518;&#38754;&#33267;&#23569;&#26377;&#19968;&#20010;&#23383;&#31526;&#30340;&#23383;&#31526;&#20018;&#12290;&#21487;&#21305;&#37197;abc, xyz, 123, &#20013;&#25991;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:ea4112f7-7370-4d49-b538-78a8e38d886a" class="outline-5">
<h5 id="h:ea4112f7-7370-4d49-b538-78a8e38d886a">或</h5>
<div class="outline-text-5" id="text-h:ea4112f7-7370-4d49-b538-78a8e38d886a">
<p>
x|y 匹配x或者y
</p>

<p>
took food wood foot  使用 w|food 或者 (w|f)ood
</p>



<figure id="org033eb39">
<img src="./images/img_20250103_175739.png" alt="img_20250103_175739.png" width="50%">

</figure>
</div>
</div>
<div id="outline-container-h:50e30561-3dc3-416a-9f4f-8c26eb60bb86" class="outline-5">
<h5 id="h:50e30561-3dc3-416a-9f4f-8c26eb60bb86">捕获</h5>
<div class="outline-text-5" id="text-h:50e30561-3dc3-416a-9f4f-8c26eb60bb86">
<ul class="org-ul">
<li><p>
(pattern)
</p>

<p>
使用小括号指定一个子表达式，也叫分组；
</p>

<p>
捕获后会自动分配组号 <b>从1开始</b> 可以改变优先级
</p></li>

<li><p>
\数字
</p>

<p>
匹配对应的分组
</p>

<p>
例： (very) \1 匹配very very，但捕获的组group是very
</p></li>

<li><p>
(?:pattern)
</p>

<p>
如果仅仅为了改变优先级，就不需要捕获分组
</p>

<p>
例：
(?:w|f)ood
</p>

<p>
'industr(?:y|ies)等价 'industry|industries'
</p></li>

<li><p>
(?&lt;name&gt;exp) 或者 (?'name'exp)
</p>

<p>
命名分组捕获，但是可以通过name访问分组。 如果不命名的话是从1开始编号的。
</p>

<p>
Python语法必须是(?P&lt;name&gt;exp)
</p></li>
</ul>



<figure id="org1f8409f">
<img src="./images/img_20250103_180723.png" alt="img_20250103_180723.png" width="50%">

<figcaption><span class="figure-number">Figure 7: </span>(pattern)分组</figcaption>
</figure>



<figure id="org9e779bc">
<img src="./images/img_20250103_180854.png" alt="img_20250103_180854.png" width="50%">

<figcaption><span class="figure-number">Figure 8: </span>(?:pattern)  不捕获分组</figcaption>
</figure>



<figure id="org2e836a5">
<img src="./images/img_20250103_181430.png" alt="img_20250103_181430.png" width="50%">

</figure>



<figure id="orgdaa6242">
<img src="./images/img_20250103_181531.png" alt="img_20250103_181531.png" width="50%">

</figure>



<figure id="org7a82f87">
<img src="./images/img_20250104_125323.png" alt="img_20250104_125323.png" width="50%">

<figcaption><span class="figure-number">Figure 11: </span>(?&lt;name&gt;exp)命名分组捕获</figcaption>
</figure>
</div>
</div>
<div id="outline-container-h:672d98b4-d983-4bc2-b4eb-3084d1665f8f" class="outline-5">
<h5 id="h:672d98b4-d983-4bc2-b4eb-3084d1665f8f">断言</h5>
<div class="outline-text-5" id="text-h:672d98b4-d983-4bc2-b4eb-3084d1665f8f">
<p>
"环视"锚定，即lookaround anchor，也称为”零宽断言”，它表示匹配的是位置，不是字符。 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#38646;&#23485;&#26029;&#35328;</span>
<span style="color: #0000ff;">-</span> (?=exp)  &#20174;&#24038;&#21521;&#21491;&#30340;&#39034;&#24207;&#29615;&#35270;&#65292;&#21448;&#21483;&#38646;&#23485;&#24230;&#27491;&#39044;&#27979;&#20808;&#34892;&#26029;&#35328;&#12290;&#26029;&#35328;exp&#19968;&#23450;&#22312;&#21305;&#37197;&#30340;&#21491;&#36793;&#20986;&#29616;&#65292;&#20063;&#23601;&#26159;&#35828;&#26029;&#35328;&#21518;&#38754;&#19968;&#23450;&#36319;&#20010;exp
<span style="color: #0000ff;">-</span> (?&lt;=exp) &#20174;&#21491;&#21521;&#24038;&#30340;&#36870;&#24207;&#29615;&#35270;&#65292;&#21448;&#21483;&#38646;&#23485;&#24230;&#27491;&#22238;&#39038;&#21518;&#21457;&#26029;&#35328;&#12290;&#26029;&#35328;exp&#19968;&#23450;&#20986;&#29616;&#22312;&#21305;&#37197;&#30340;&#24038;&#36793;&#20986;&#29616;&#65292;&#20063;&#23601;&#26159;&#35828;&#21069;&#38754;&#19968;&#23450;&#26377;&#20010;exp&#21069;&#32512;

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#36127;&#21521;&#38646;&#23485;&#26029;&#35328;</span>
<span style="color: #0000ff;">-</span> (?!exp) &#39034;&#24207;&#29615;&#35270;&#30340;&#21462;&#21453;&#65292;&#21448;&#21483;&#38646;&#23485;&#24230;&#36127;&#39044;&#27979;&#20808;&#34892;&#26029;&#35328;&#12290;&#26029;&#35328;exp&#19968;&#23450;&#19981;&#20250;&#20986;&#29616;&#22312;&#21491;&#20391;&#65292;&#20063;&#23601;&#26159;&#35828;&#26029;&#35328;&#21518;&#38754;&#19968;&#23450;&#19981;&#26159;exp
<span style="color: #0000ff;">-</span> (?&lt;!exp) &#36870;&#24207;&#29615;&#35270;&#30340;&#21462;&#21453;&#65292;&#21448;&#21483;&#38646;&#23485;&#24230;&#36127;&#22238;&#39038;&#21518;&#21457;&#26029;&#35328;&#12290;&#26029;&#35328;exp&#19968;&#23450;&#19981;&#33021;&#20986;&#29616;&#22312;&#24038;&#20391;&#65292;&#20063;&#23601;&#26159;&#35828;&#26029;&#35328;&#21069;&#38754;&#19968;&#23450;&#19981;&#33021;&#26159;exp
<span style="color: #0000ff;">-</span> (?#comment) &#27880;&#37322;
</pre>
</div>

<p>
关于”环视”锚定，最需要注意的一点是匹配的结果不占用任何字符，它仅仅只是锚定位置。所以断言只是个条件。
</p>

<p>
另外，无论是哪种锚定，都是从左向右匹配再做回溯的(假设允许回溯)，即使是逆序环视。
</p>


<p>
范例：测试字符串为wood took foot food
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#39034;&#24207;&#29615;&#35270;</span>
<span style="color: #0000ff;">f</span>(?=oo) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;f&#65292;&#20294;f&#21518;&#38754;&#19968;&#23450;&#26377;oo&#20986;&#29616;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36870;&#24207;&#29615;&#35270;&#65292;&#36825;&#37324;&#33021;&#36870;&#24207;&#21305;&#37197;&#25104;&#21151;&#65292;&#38752;&#30340;&#26159;&#38170;&#23450;&#25324;&#21495;&#21518;&#38754;&#30340;ood\ook</span>
(?&lt;=f)ood <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;ood&#65292;ook&#21069;&#19968;&#23450;&#26377;t&#20986;&#29616;</span>
(?&lt;=t)ook <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;ook&#65292;ook&#21069;&#19968;&#23450;&#26377;t&#20986;&#29616;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#39034;&#24207;&#21542;&#23450;&#29615;&#35270;</span>
<span style="color: #0000ff;">foo</span>(?!d) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;foo&#65292;&#20294;foo&#21518;&#38754;&#19968;&#23450;&#19981;&#26159;d</span>
\d{3}(?!\d) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;3&#20301;&#25968;&#23383;&#65292;&#26029;&#35328;3&#20301;&#25968;&#23383;&#21518;&#38754;&#19968;&#23450;&#19981;&#33021;&#26159;&#25968;&#23383;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36870;&#24207;&#21542;&#23450;&#29615;&#35270;</span>
(?&lt;!f)ood <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;ood&#65292;&#20294;ood&#30340;&#24038;&#36793;&#19968;&#23450;&#19981;&#26159;f</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#27880;&#37322;</span>
<span style="color: #0000ff;">f</span>(?=oo)(?#&#36825;&#20010;&#21518;&#26029;&#35328;&#19981;&#25429;&#33719;)
</pre>
</div>



<figure id="org802ceac">
<img src="./images/img_20250104_133231.png" alt="img_20250104_133231.png" width="50%">

<figcaption><span class="figure-number">Figure 12: </span>(?=&#x2026;)从左向右顺序环视</figcaption>
</figure>



<figure id="org86183ef">
<img src="./images/img_20250104_134019.png" alt="img_20250104_134019.png" width="50%">

<figcaption><span class="figure-number">Figure 13: </span>(?!&#x2026;) 顺序环视的取反</figcaption>
</figure>



<figure id="orge98f742">
<img src="./images/img_20250104_133518.png" alt="img_20250104_133518.png" width="50%">

<figcaption><span class="figure-number">Figure 14: </span>(?&lt;=&#x2026;) 从右向左逆序环视</figcaption>
</figure>



<figure id="org85b8599">
<img src="./images/img_20250104_133834.png" alt="img_20250104_133834.png" width="50%">

<figcaption><span class="figure-number">Figure 15: </span>(?&lt;!&#x2026;) 逆序环视的取反</figcaption>
</figure>


<p>
注意：
断言会不会捕获呢？也就是断言占不占分组号呢？
</p>

<p>
断言不占分组号。断言如同条件，只是要求匹配必须满⾜断言的条件。
</p>

<p>
分组和捕获是同一个意思。
</p>

<p>
使用正则表达式时，能用简单表达式，就不要复杂的表达式。
</p>

<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">a</span> = <span style="color: #8b2252;">'wood took foot food'</span>

<span style="color: #a0522d;">findall</span> = re.findall(<span style="color: #8b2252;">'f(?=oo)'</span>, a)
<span style="color: #483d8b;">print</span>(findall) <span style="color: #b22222;"># </span><span style="color: #b22222;">['f', 'f']</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:72e0202f-8876-4b47-8093-a5361a98b8c5" class="outline-5">
<h5 id="h:72e0202f-8876-4b47-8093-a5361a98b8c5">贪婪与非贪婪</h5>
<div class="outline-text-5" id="text-h:72e0202f-8876-4b47-8093-a5361a98b8c5">
<p>
默认是贪婪模式，也就是说尽量多匹配更长的字符串。
</p>

<p>
非贪婪很简单，在重复的符号后面加上一个?问号，就尽量的少匹配了。
</p>

<div class="org-src-container">
<pre class="src src-sh">&#20195;&#30721; &#35828;&#26126; &#20030;&#20363;
*? &#21305;&#37197;&#20219;&#24847;&#27425;&#65292;&#20294;&#23613;&#21487;&#33021;&#23569;&#37325;&#22797; 
+? &#21305;&#37197;&#33267;&#23569;1&#27425;&#65292;&#65292;&#20294;&#23613;&#21487;&#33021;&#23569;&#37325;&#22797; 
?? &#21305;&#37197;0&#27425;&#25110;1&#27425;&#65292;&#65292;&#20294;&#23613;&#21487;&#33021;&#23569;&#37325;&#22797; 
{n,}? &#21305;&#37197;&#33267;&#23569;n&#27425;&#65292;&#20294;&#23613;&#21487;&#33021;&#23569;&#37325;&#22797; 
{n,m}? &#21305;&#37197;&#33267;&#23569;n&#27425;&#65292;&#33267;&#22810;m&#27425;&#65292;&#20294;&#23613;&#21487;&#33021;&#23569;&#37325;&#22797; 
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">very very happy &#20351;&#29992;v.*y&#21644;v.*?y

<span style="color: #b22222;">#</span><span style="color: #b22222;">so very very vary vary sorry vys</span>
v.*y <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36138;&#23146;&#65292;&#23613;&#21487;&#33021;&#22810;&#21305;&#37197;&#12290;&#21305;&#37197;very very vary vary sorry vy</span>
v.*?y <span style="color: #b22222;">#</span><span style="color: #b22222;">&#38750;&#36138;&#23146;, &#23613;&#21487;&#33021;&#30701;&#12290;&#21305;&#37197;very&#12289; very&#12289; vary&#12289; vary&#12289;vy</span>
v.+?y <span style="color: #b22222;">#</span><span style="color: #b22222;">&#38750;&#36138;&#23146;&#65292;&#23613;&#21487;&#33021;&#30701;&#12290;&#21305;&#37197;very&#12289; very &#12289;vary&#12289;vary</span>
v.??y <span style="color: #b22222;">#</span><span style="color: #b22222;">&#38750;&#36138;&#23146;&#65292;&#21305;&#37197;0&#27425;&#25110;1&#27425;&#12290;&#21305;&#37197;vy</span>
v.{2,}?y <span style="color: #b22222;">#</span><span style="color: #b22222;">&#38750;&#36138;&#23146;&#65292;&#21305;&#37197;2&#27425;&#12290;&#21305;&#37197;very&#12289; very &#12289;vary&#12289;vary</span>
</pre>
</div>

<p>
如果要使用非贪婪，则加一个 ? ，上面的例子修改如下：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">a</span> = <span style="color: #8b2252;">'java*&amp;39android##@@python'</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#36138;&#23146;&#19982;&#38750;&#36138;&#23146;</span>
<span style="color: #a0522d;">re_findall</span> = re.findall(<span style="color: #8b2252;">'[a-z]{4,7}?'</span>, a)
<span style="color: #483d8b;">print</span>(re_findall)
</pre>
</div>

<p>
输出结果如下：
</p>
<div class="org-src-container">
<pre class="src src-sh">[<span style="color: #8b2252;">'java'</span>, <span style="color: #8b2252;">'andr'</span>, <span style="color: #8b2252;">'pyth'</span>]
</pre>
</div>
</div>
</div>
<div id="outline-container-h:bedf8c91-a445-422d-bef0-2ba0f2fa4423" class="outline-5">
<h5 id="h:bedf8c91-a445-422d-bef0-2ba0f2fa4423">引擎选项</h5>
<div class="outline-text-5" id="text-h:bedf8c91-a445-422d-bef0-2ba0f2fa4423">
<pre class="example" id="org141c038">
IgnoreCase 匹配时忽略大小写。如re.I re.IGNORECASE

Singleline 单行模式，即整个测试文本被认为是单行。可以匹配所有字符，包括\n。如re.S re.DOTALL

Multiline 多行模式，^行首、$行尾。如re.M re.MULTLINE

IgnorePatternWhitespace 忽略表达式中的空白字符，如果要使用空白字符用转义，#可以用来做注释。 如re.X re.VERBOSE
</pre>

<ul class="org-ul">
<li>默认模式：将整个测试字符串看做一个一行的大字符串，.不能代表\n</li>
<li>单行模式：将整个测试字符串看做一个一行的大字符串，.可以匹配\n</li>
<li>多行模式：终于可以把一行大字符串用\n分割成多行，^指的是行首，$行尾，.行为不变</li>
</ul>

<pre class="example" id="org6721df5">
单行模式：
. 可以匹配所有字符，包括换行符
^ 表示整个字符串的开头，$整个字符串的结尾

多行模式
. 可以匹配除了换行符之外的字符，多行不影响.点号
^ 表示行首，$行尾，只不过这里的行是每一行

默认模式：可以看做待匹配的文本是一行，不能看做多行，.点号不能匹配换行符，^和$表示行首和行尾，而行首行尾就是整个字符的开头和结尾
单行模式：基本和默认模式一样，只是.点号终于可以匹配任意一个字符包括换行符，这时所有文本就是一个长长的只有一行的字符串。^就是这一行字符串的行首，$就是这一行的行尾。
多行模式：重新定义了行的概念，但不影响.点号的行为，^和$还是行首行尾的意思，只不过因为多行模式可以识别换行符了。“开始”指的是\n后紧接着下一个字符；“结束”指的是\n前的字符，注意最后一行结尾可以没有\n

简单讲，单行模式只影响.点号行为，多行模式重新定义行影响了^和$

注意：字符串看不见的换行符，\r\n会影响e$的测试，e$只能匹配e\n
</pre>

<p>
范例
</p>
<pre class="example" id="orgcc7a127">
so very very sorry
vys ray

v.*y 匹配，整个看做一行，从very 到sorry，遇到\n不能突破，后面再匹配vys ray
so =very very sorry=
=vys ray=

v.*y 单行模式匹配，可以突破\n
=very very sooryvys ray=

^v.*y 单行模式匹配。 空
^v.*y 默认匹配。 空

v.*y 多行模式匹配
so =very very sorry=
=vys ray=

^v.*y 多行模式匹配
=vys ray=

^v.*y 单行和多行模式匹配
=vys ray=


^v.*y$ 单行模式匹配。 空
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9e4328c8-2675-4cde-b603-5e481ecca1c2" class="outline-4">
<h4 id="h:9e4328c8-2675-4cde-b603-5e481ecca1c2">正则习题</h4>
<div class="outline-text-4" id="text-h:9e4328c8-2675-4cde-b603-5e481ecca1c2">
<p>
<b>匹配1个0~999之间的任意数字</b>
</p>

<pre class="example" id="org7d953d5">
1
12
885
9999
102
02
003
4d
</pre>

<pre class="example" id="orgce4049f">
\d                      1位数
[1-9]?\d                1-2位数
^[1-9]?\d\d?            1-3位数
^([1-9]\d\d?|\d)        1-3位数
^([1-9]\d\d?|\d)$       1-3位数的行
^([1-9]\d\d?|\d)\r?$
^([1-9]\d\d?|\d)(?!\d)  数字开头1-3位数且之后不能是数字，注意9999
</pre>

<p>
<b>IP地址</b>
</p>

<p>
匹配合法的IP地址
</p>

<div class="org-src-container">
<pre class="src src-sh">192.168.1.150
0.0.0.0
255.255.255.255
17.16.52.100
172.16.0.100
400.400.999.888
001.022.003.000
257.257.255.256
</pre>
</div>

<pre class="example" id="org08384a0">
IPV4 
(\d{1,3}\.){3}\d{1,3}
([0-2]?\d\d?\.){3}
((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}
((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)
(?&lt;![0-9])(?:(?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2}))(?![0-9])
</pre>

<p>
<b>提取文件名</b>
</p>

<p>
选出含有ftp的链接，且文件类型是gz或者xz的文件名
</p>
<div class="org-src-container">
<pre class="src src-sh">ftp://ftp.astron.com/pub/file/file-5.14.tar.gz
ftp://ftp.gmplib.org/pub/gmp-5.1.2/gmp-5.1.2.tar.xz
ftp://ftp.vim.org/pub/vim/unix/vim-7.3.tar.bz2
http://anduin.linuxfromscratch.org/sources/LFS/lfs-packages/conglomeration//iana-etc/iana-etc-2.30.tar.bz2
http://anduin.linuxfromscratch.org/sources/other/udev-lfs-205-1.tar.bz2
http://download.savannah.gnu.org/releases/libpipeline/libpipeline-1.2.4.tar.gz
http://download.savannah.gnu.org/releases/man-db/man-db-2.6.5.tar.xz
http://download.savannah.gnu.org/releases/sysvinit/sysvinit-2.88dsf.tar.bz2
http://ftp.altlinux.org/pub/people/legion/kbd/kbd-1.15.5.tar.gz
http://mirror.hust.edu.cn/gnu/autoconf/autoconf-2.69.tar.xz
http://mirror.hust.edu.cn/gnu/automake/automake-1.14.tar.xz
</pre>
</div>

<pre class="example" id="orgdb0ebd4">
ftp.*\.(xz|gz)$
ftp.*/.+\.(xz|gz)$

(?&lt;=.*ftp.*/)[^/\s]+\.(?:xz|gz)$
</pre>

<p>
<b>匹配邮箱地址</b>
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #483d8b;">test</span>@hot-mail.com
v-ip@cici.com
web.manager@cici.com.cn
super.user@google.com
a@w-a-com
</pre>
</div>

<pre class="example" id="orgfdc1713">
\w[\w-.]+@[\w-.]+
\w[\w-.]+@\w[\w-]*(\.[a-zA-z0-9]+)+
\w[\w-.]+@\w[\w-]*(\.\w+)+
</pre>

<p>
<b>匹配html标记</b>
</p>

<p>
提取href中的链接url，提取文字“CiCi”
</p>

<div class="org-src-container">
<pre class="src src-sh">&lt;a <span style="color: #a0522d;">href</span>=<span style="color: #8b2252;">'http://www.cici.com/index.html'</span> <span style="color: #a0522d;">target</span>=<span style="color: #8b2252;">'_blank'</span>&gt;CiCi&lt;/a&gt;
</pre>
</div>

<pre class="example" id="orgd90af58">
&gt;(\w+)&lt;  拿分组

拿href中内容
(?&lt;=href\s*=\s*['"]?)[^\s'"&lt;&gt;]+  断言复杂
href\s*=\s*['"]?([^\s'"&lt;&gt;]+)  拿分组
</pre>

<p>
<b>匹配URL</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">http://www.cici.com/index.html
https://login.cici.com
file:///ect/sysconfig/network
</pre>
</div>

<pre class="example" id="orgbb0cc33">
(\w+)://[^\s'"]+
</pre>

<p>
<b>匹配二代中国身份证ID</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">321105700101003
321105197001010030
11210020170101054X

17&#20301;&#25968;&#23383;+1&#20301;&#26657;&#39564;&#30721;&#32452;&#25104;
&#21069;6&#20301;&#22320;&#22336;&#30721;&#65292;8&#20301;&#20986;&#29983;&#24180;&#26376;&#65292;3&#20301;&#25968;&#23383;&#65292;1&#20301;&#26657;&#39564;&#20301;&#65288;0-9&#25110;X&#65289;

&#22320;&#22336;&#30721;+&#20986;&#29983;&#26085;&#26399;&#30721;+&#39034;&#24207;&#30721;+&#26657;&#39564;&#30721;

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#26684;&#24335;&#35498;&#26126;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#9484;&#9472;&#9472;&#30465;&#20221;(&#31532;1-2&#20301;)</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#9474; &#9484;&#9472;&#9472;&#22478;&#24066;(&#31532;3-4&#20301;)</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#9474; &#9474; &#9484;&#9472;&#9472;&#21306;&#21439;(&#31532;5-6&#20301;)</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#9474; &#9474; &#9474;  &#9484;&#9472;&#20986;&#29983;&#24180; &#26376; &#26085;(&#31532;7-14&#20301;)</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#9474; &#9474; &#9474;  &#9474;        &#9484;&#9472;&#39034;&#24207;&#30721;(&#31532;15-17&#20301;&#65292;&#31532;17&#20301;&#20195;&#34920;&#24615;&#21035;&#65292;&#22855;&#25968;&#20026;&#30007;&#24615;&#20598;&#25968;&#20026;&#22899;&#24615;)</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#9474; &#9474; &#9474;  &#9474;        &#9474;   &#9484;&#9472;&#26657;&#39564;&#30721;(&#31532;18&#20301;&#65292;&#26657;&#39564;&#27491;&#30830;&#24615;&#12290;&#31532;18&#20301;&#22914;&#26524;&#35745;&#31639;&#20986;&#26469;&#26159;10&#65292;&#36523;&#20221;&#21495;&#23601;&#21464;&#25104;19&#20301;&#21495;&#20102;&#65292;&#29992;X&#20195;&#26367;10&#65292;&#32599;&#39532;&#25968;&#23383;X&#34920;&#31034;10)</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#9474; &#9474; &#9474;  &#9474;        &#9474;   &#9474;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">xxxxxx xxxxxxxx xxx x</span>
</pre>
</div>

<pre class="example" id="org994f677">
\d{17}[\dXx]|\d{15}
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5cca339a-c4c0-4e43-ab17-d26507e4091c" class="outline-3">
<h3 id="h:5cca339a-c4c0-4e43-ab17-d26507e4091c">路径操作</h3>
<div class="outline-text-3" id="text-h:5cca339a-c4c0-4e43-ab17-d26507e4091c">
</div>
<div id="outline-container-h:1c5a5158-ec43-4ee1-8782-06089a9859ba" class="outline-4">
<h4 id="h:1c5a5158-ec43-4ee1-8782-06089a9859ba">路径操作模块</h4>
<div class="outline-text-4" id="text-h:1c5a5158-ec43-4ee1-8782-06089a9859ba">
<p>
<a href="https://docs.python.org/3/library/os.path.html">https://docs.python.org/3/library/os.path.html</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">os &#27169;&#22359;&#24120;&#29992;&#20989;&#25968; os.path&#27169;&#22359;</span>
<span style="color: #a020f0;">from</span> os <span style="color: #a020f0;">import</span> path

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#25340;&#25509;</span>
<span style="color: #a0522d;">p1</span> = path.join(<span style="color: #8b2252;">'d:/tmp'</span>, <span style="color: #8b2252;">'conf'</span>, <span style="color: #8b2252;">'a/b'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25340;&#25509;</span>

<span style="color: #483d8b;">print</span>(p1, <span style="color: #483d8b;">type</span>(p1)) <span style="color: #b22222;">#</span><span style="color: #b22222;">b basename&#22522;&#21517;, d:/tmp/conf/a &#36335;&#24452;&#21517;dirname</span>
<span style="color: #483d8b;">print</span>(p1.split(<span style="color: #8b2252;">'/'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">str.split</span>
<span style="color: #483d8b;">print</span>(path.split(p1)) <span style="color: #b22222;">#</span><span style="color: #b22222;">p1:str &#19968;&#20992;, replit, sep \ /</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: d:/tmp\conf\a/b &lt;class 'str'&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: ['d:', 'tmp\\conf\\a', 'b']</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: ('d:/tmp\\conf\\a', 'b')</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#38548;</span>
<span style="color: #a0522d;">d</span>, <span style="color: #a0522d;">b</span> = path.split(p1)  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20999;&#25104;&#36335;&#24452;&#21517;&#21644;&#22522;&#21517;</span>
<span style="color: #483d8b;">print</span>(d, b) <span style="color: #b22222;">#</span><span style="color: #b22222;">: d:/tmp\conf\a b</span>
<span style="color: #483d8b;">print</span>(path.split(d)) <span style="color: #b22222;">#</span><span style="color: #b22222;">: ('d:/tmp\\conf', 'a')</span>
<span style="color: #483d8b;">print</span>(d, path.dirname(d), path.basename(d)) <span style="color: #b22222;">#</span><span style="color: #b22222;">: d:/tmp\conf\a d:/tmp\conf a</span>

<span style="color: #483d8b;">print</span>(path.exists(<span style="color: #8b2252;">'d:/tmp'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23384;&#22312;</span>
<span style="color: #483d8b;">print</span>(path.exists(<span style="color: #8b2252;">'d:/tmp/test'</span>))
<span style="color: #483d8b;">print</span>(path.splitdrive(<span style="color: #8b2252;">'d:/tmp/test'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20165;windows&#65292;&#21306;&#20998;&#39537;&#21160;&#22120;</span>
<span style="color: #483d8b;">print</span>(path.abspath(<span style="color: #8b2252;">'d:/tmp/test'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23545;&#24212;&#30340;&#32477;&#23545;&#36335;&#24452;</span>
<span style="color: #483d8b;">print</span>(__file__) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24403;&#21069;&#25991;&#20214;&#33258;&#24049;&#30340;&#36335;&#24452;</span>
<span style="color: #483d8b;">print</span>(path.isdir(<span style="color: #8b2252;">'d:/'</span>)) <span style="color: #b22222;"># </span><span style="color: #b22222;">d&#30424;&#30340;/&#26159;&#30446;&#24405;&#21527;</span>
<span style="color: #483d8b;">print</span>(path.isfile(<span style="color: #8b2252;">'d:/tmp/test'</span>)) <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26159;&#25991;&#20214;&#21527;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: True</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: True</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: ('d:', '/tmp/test')</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">d:\tmp\test</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;stdin&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">True</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">True</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#36941;&#21382;&#65292;&#25171;&#21360;&#29238;&#30446;&#24405;</span>
<span style="color: #a0522d;">p</span> = <span style="color: #8b2252;">'d:/tmp/test'</span>
<span style="color: #a020f0;">while</span> p != path.dirname(p):
    <span style="color: #a0522d;">p</span> = path.dirname(p)
    <span style="color: #483d8b;">print</span>(p)
<span style="color: #b22222;">#</span><span style="color: #b22222;">d:/tmp</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">d:/</span>
</pre>
</div>

<p>
3.4版本开始，建议使用pathlib模块，提供Path对象来操作。包括目录和文件。
</p>
</div>
</div>
<div id="outline-container-h:209932a2-f431-4025-8ba5-edd4a324a70b" class="outline-4">
<h4 id="h:209932a2-f431-4025-8ba5-edd4a324a70b">Path类</h4>
<div class="outline-text-4" id="text-h:209932a2-f431-4025-8ba5-edd4a324a70b">
<p>
从3.4开始python提供了pathlib模块，使用path类操作目录更加方便。
</p>

<p>
<a href="https://docs.python.org/3/library/pathlib.html">https://docs.python.org/3/library/pathlib.html</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20869;&#37096;&#35843;&#29992;&#30340;os.path</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#33719;&#21462;&#24403;&#21069;&#36335;&#24452;&#23545;&#35937;</span>
<span style="color: #483d8b;">print</span>(Path(), Path(<span style="color: #8b2252;">''</span>), Path(<span style="color: #8b2252;">'.'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20250;&#26816;&#26597;&#24403;&#21069;&#25805;&#20316;&#31995;&#32479;&#65292;&#24182;&#36820;&#22238;&#24403;&#21069;&#31995;&#32479;&#25903;&#25345;&#30340;&#25805;&#20316;&#23545;&#35937;  WindowsPath('.')</span>
<span style="color: #483d8b;">print</span>(Path().absolute()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#32477;&#23545;&#36335;&#24452; WindowsPath('D:/project/pyprojs')</span>
<span style="color: #a020f0;">import</span> os
<span style="color: #483d8b;">print</span>(os.path.abspath(<span style="color: #8b2252;">''</span>), os.path.abspath(<span style="color: #8b2252;">'.'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#32477;&#23545;&#36335;&#24452;&#65292;&#30456;&#27604;Path&#31867;&#20351;&#29992;&#22797;&#26434;&#20123;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23383;&#31526;&#20018;&#26174;&#29616;&#26041;&#27861;&#65292;&#36335;&#24452;&#25340;&#25509;</span>
<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'/etc/'</span>, <span style="color: #8b2252;">'sysconfig'</span>, <span style="color: #8b2252;">'c/d'</span>)
<span style="color: #483d8b;">print</span>(p) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#33258;&#21160;&#35843;&#25972;&#12290;windows &#19979;: \etc\sysconfig\c\d</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">str</span>(p), <span style="color: #483d8b;">repr</span>(p), <span style="color: #483d8b;">bytes</span>(p)) <span style="color: #b22222;">#</span><span style="color: #b22222;">p &#20869;&#37096;&#35843;&#29992;&#30340;&#26159;repr : \etc\sysconfig\c\d WindowsPath('/etc/sysconfig/c/d') b'\\etc\\sysconfig\\c\\d'</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">bytes(p) == str(p).encode()</span>

<span style="color: #483d8b;">print</span>(Path(<span style="color: #8b2252;">'.'</span>, <span style="color: #8b2252;">'a'</span>, <span style="color: #8b2252;">'b/c'</span>, <span style="color: #8b2252;">''</span>, Path(<span style="color: #8b2252;">''</span>), Path(<span style="color: #8b2252;">'e/f'</span>))) <span style="color: #b22222;">#</span><span style="color: #b22222;">WindowsPath('a/b/c/e/f')</span>

<span style="color: #483d8b;">print</span>(Path(<span style="color: #8b2252;">'a'</span>) / <span style="color: #8b2252;">'b/c'</span>) <span style="color: #b22222;"># </span><span style="color: #b22222;">/ &#36816;&#31639;&#31526;&#37325;&#36733; #: a\b\c</span>
<span style="color: #483d8b;">print</span>(Path(<span style="color: #8b2252;">'a'</span>) / <span style="color: #8b2252;">'b/c'</span> / <span style="color: #8b2252;">''</span> / Path(<span style="color: #8b2252;">'d'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">: a\b\c\d</span>
<span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'a/b'</span> / Path(<span style="color: #8b2252;">'c'</span>, <span style="color: #8b2252;">'d'</span>, Path(<span style="color: #8b2252;">'e/f'</span>))) <span style="color: #b22222;">#</span><span style="color: #b22222;">: a\b\c\d\e\f</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">print('a/b' / 'c/d' / Path('e/f')) # &#25253;&#38169;&#65292;&#23383;&#31526;&#19981;&#33021;&#30456;&#38500;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'a/b'</span> / (<span style="color: #8b2252;">'c/d'</span> / Path(<span style="color: #8b2252;">'e/f'</span>))) <span style="color: #b22222;">#</span><span style="color: #b22222;">a\b\c\d\e\f</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">str / Path =&gt; Path</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">Path / Path =&gt; Path</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">Path / str =&gt; Path</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">str / str &#38169;&#30340;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#30001;&#21738;&#20123;&#37096;&#20998;&#32452;&#25104;</span>
<span style="color: #a0522d;">p</span> = (<span style="color: #8b2252;">'a/b'</span> / (<span style="color: #8b2252;">'c/d'</span> / Path(<span style="color: #8b2252;">'e/f'</span>)))
<span style="color: #483d8b;">print</span>(p.parts) <span style="color: #b22222;">#</span><span style="color: #b22222;">('a', 'b', 'c', 'd', 'e', 'f')</span>

<span style="color: #a0522d;">p1</span> = (<span style="color: #8b2252;">'/a/b'</span> / (<span style="color: #8b2252;">'c/d'</span> / Path(<span style="color: #8b2252;">'e/f'</span>)))
<span style="color: #483d8b;">print</span>(p1.parts) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#32477;&#23545;&#36335;&#24452;&#65292;&#22810;&#20102;&#26681; ('\\', 'a', 'b', 'c', 'd', 'e', 'f')</span>

<span style="color: #483d8b;">print</span>(p1.parent) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21462;&#29238;&#36335;&#24452; \a\b\c\d\e</span>
<span style="color: #483d8b;">print</span>(p1.parent.parent.parent.parent.parent.parent) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21462;&#29238;&#36335;&#24452; \</span>
<span style="color: #483d8b;">print</span>(p1.parent.joinpath(<span style="color: #8b2252;">'d1'</span>, <span style="color: #8b2252;">'d2/d3'</span>, Path(<span style="color: #8b2252;">'d4'</span>, <span style="color: #8b2252;">'d5'</span>))) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36335;&#24452;&#25340;&#25509; \a\b\c\d\e\d1\d2\d3\d4\d5</span>
<span style="color: #a0522d;">l</span> = p1.parents <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24816;&#24615;&#23545;&#35937;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">list</span>(l), p1) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#29238;&#36335;&#24452;&#65292;&#26159;&#30001;&#36817;&#21450;&#36828;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">[WindowsPath('/a/b/c/d/e'), WindowsPath('/a/b/c/d'), WindowsPath('/a/b/c'), WindowsPath('/a/b'), WindowsPath('/a'), WindowsPath('/')] \a\b\c\d\e\f</span>
</pre>
</div>
</div>
<div id="outline-container-h:a20f7330-a11e-4d63-93af-727fefdc95c7" class="outline-5">
<h5 id="h:a20f7330-a11e-4d63-93af-727fefdc95c7">初始化</h5>
<div class="outline-text-5" id="text-h:a20f7330-a11e-4d63-93af-727fefdc95c7">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p</span> = Path() <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24403;&#21069;&#30446;&#24405;&#65292;Path() Path('.') Path('')</span>
<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'a'</span>, <span style="color: #8b2252;">'b'</span>, <span style="color: #8b2252;">'c/d'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24403;&#21069;&#30446;&#24405;&#19979;&#30340; a/b/c/d</span>
<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'/etc'</span>, Path(<span style="color: #8b2252;">'sysconfig'</span>), <span style="color: #8b2252;">'network/ifcfg'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26681;&#19979;&#30340;etc&#30446;&#24405;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:01d9d18a-dad8-4e8d-953d-a19bad63c83f" class="outline-5">
<h5 id="h:01d9d18a-dad8-4e8d-953d-a19bad63c83f">路径拼接</h5>
<div class="outline-text-5" id="text-h:01d9d18a-dad8-4e8d-953d-a19bad63c83f">
<p>
操作符 /
</p>
<ul class="org-ul">
<li>Path对象 / Path对象</li>
<li>Path对象 / Path对象</li>
<li>字符串 / Path对象</li>
</ul>

<p>
joinpath
</p>
<ul class="org-ul">
<li>joinpath(*other) 在当前Path路径上连接多个字符串返回新路径对象</li>
</ul>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p1</span> = (<span style="color: #8b2252;">'/a/b'</span> / (<span style="color: #8b2252;">'c/d'</span> / Path(<span style="color: #8b2252;">'e/f'</span>)))
<span style="color: #483d8b;">print</span>(p1.parent) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21462;&#29238;&#36335;&#24452; \a\b\c\d\e</span>
<span style="color: #483d8b;">print</span>(p1.parent.joinpath(<span style="color: #8b2252;">'d1'</span>, <span style="color: #8b2252;">'d2/d3'</span>, Path(<span style="color: #8b2252;">'d4'</span>, <span style="color: #8b2252;">'d5'</span>))) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36335;&#24452;&#25340;&#25509; \a\b\c\d\e\d1\d2\d3\d4\d5</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:606065eb-0a97-4113-a509-c28f747e205d" class="outline-5">
<h5 id="h:606065eb-0a97-4113-a509-c28f747e205d">分解</h5>
<div class="outline-text-5" id="text-h:606065eb-0a97-4113-a509-c28f747e205d">
<p>
parts 属性，会返回目录各部分的元组
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'/a/b/c/d'</span>)
<span style="color: #483d8b;">print</span>(p.parts) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26368;&#24038;&#36793;&#30340;&#26159;/&#26159;&#26681;&#30446;&#24405;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: ('\\', 'a', 'b', 'c', 'd')</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9d8f9e10-3265-4a7b-8bdb-81a14457520e" class="outline-5">
<h5 id="h:9d8f9e10-3265-4a7b-8bdb-81a14457520e">获取路径</h5>
<div class="outline-text-5" id="text-h:9d8f9e10-3265-4a7b-8bdb-81a14457520e">
<p>
str 获取路径字符串
</p>

<p>
bytes 获取路径字符串的 bytes
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path
<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'/etc'</span>)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">str</span>(p), <span style="color: #483d8b;">bytes</span>(p)) <span style="color: #b22222;">#</span><span style="color: #b22222;">: \etc b'\\etc'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:16d6980a-18d1-4dd7-b880-15b0ecbcc9e1" class="outline-5">
<h5 id="h:16d6980a-18d1-4dd7-b880-15b0ecbcc9e1">父目录</h5>
<div class="outline-text-5" id="text-h:16d6980a-18d1-4dd7-b880-15b0ecbcc9e1">
<p>
parent 目录的逻辑父目录
</p>

<p>
parents 父目录惰性可迭代对象，索引0是直接的父
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path
<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'/data/mysql/install/my.tar.gz'</span>)
<span style="color: #483d8b;">print</span>(p.parent) <span style="color: #b22222;">#</span><span style="color: #b22222;">: \data\mysql\install</span>

<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> p.parents: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21487;&#36845;&#20195;&#23545;&#35937;</span>
    <span style="color: #483d8b;">print</span>(x)
<span style="color: #b22222;">#</span><span style="color: #b22222;">: \data\mysql\install</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: \data\mysql</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: \data</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: \</span>


<span style="color: #b22222;">#</span><span style="color: #b22222;">&#30456;&#23545;&#36335;&#24452;</span>
<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'data/mysql/install/my.tar.gz'</span>)  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36335;&#24452;&#31995;&#32479;&#24403;&#20013;&#65292;2&#29305;&#27530;&#30340;&#30446;&#24405;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">. &#24341;&#29992;&#65292;&#23545;&#24403;&#21069;&#30446;&#24405;&#33258;&#36523;&#30340;&#24341;&#29992;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">.. &#23545;&#24403;&#21069;&#30446;&#24405;&#30340;&#29238;&#30446;&#24405;&#30340;&#24341;&#29992;</span>
<span style="color: #483d8b;">print</span>(p.parent) <span style="color: #b22222;">#</span><span style="color: #b22222;">data\mysql\install</span>

<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> p.parents: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21487;&#36845;&#20195;&#23545;&#35937;</span>
    <span style="color: #483d8b;">print</span>(x)
<span style="color: #b22222;">#</span><span style="color: #b22222;">data\mysql\install</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">data\mysql</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">data</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">.</span>

<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">list</span>(p.parents))
<span style="color: #b22222;">#</span><span style="color: #b22222;">[WindowsPath('data/mysql/install'), WindowsPath('data/mysql'), WindowsPath('data'), WindowsPath('.')]</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:4963685a-a285-4ab2-86b0-42d1e563357b" class="outline-5">
<h5 id="h:4963685a-a285-4ab2-86b0-42d1e563357b">目录组成部分</h5>
<div class="outline-text-5" id="text-h:4963685a-a285-4ab2-86b0-42d1e563357b">
<p>
name、stem、suffix、suffixes、with_suffix(suffix)、with_name(name)
</p>

<ul class="org-ul">
<li>name 目录的最后一个部分</li>
<li>stem 目录最后一个部分，没有后缀</li>
<li>suffix 目录最后一个部分的扩展名</li>
<li>name = stem + suffix</li>
</ul>

<p>
suffixes 返回多个扩展名列表
</p>
<ul class="org-ul">
<li>with_suffix(suffix) 有扩展名则替换，无则补充扩展名</li>
<li>with_name(name)替换目录最后一个部分并返回一个新的路径</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path
<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'/data/mysql/my.tar.gz'</span>)
<span style="color: #483d8b;">print</span>(p.exists()) <span style="color: #b22222;">#</span><span style="color: #b22222;">: False</span>

<span style="color: #483d8b;">print</span>(p.name, p.parent) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36335;&#24452;&#25104;&#20998; &#22522;&#21517; &#29238;&#30446;&#24405; : my.tar.gz \data\mysql</span>
<span style="color: #483d8b;">print</span>(p.suffix, p.suffixes, p.stem) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25991;&#20214;&#25193;&#23637;&#21517; : .gz ['.tar', '.gz'] my.tar</span>

<span style="color: #483d8b;">print</span>(p.with_name(<span style="color: #8b2252;">'config'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25442;&#22522;&#21517; : \data\mysql\config</span>
<span style="color: #483d8b;">print</span>(p.parent.with_name(<span style="color: #8b2252;">'config'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25442;&#22522;&#21517; : \data\config</span>
<span style="color: #483d8b;">print</span>(p.parent.parent / <span style="color: #8b2252;">'redis'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25442;&#22522;&#21517;: \data\redis</span>
<span style="color: #483d8b;">print</span>(p.with_suffix(<span style="color: #8b2252;">'.xz'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25442;&#25193;&#23637;&#21517; : \data\mysql\my.tar.xz</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:8b645021-ccc3-4126-929a-bf6e19339ccb" class="outline-5">
<h5 id="h:8b645021-ccc3-4126-929a-bf6e19339ccb">全局方法</h5>
<div class="outline-text-5" id="text-h:8b645021-ccc3-4126-929a-bf6e19339ccb">
<ul class="org-ul">
<li>cwd() 返回当前工作目录</li>
<li>home() 返回当前家目录</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p</span> = <span style="color: #8b2252;">'d:/tmp'</span>
<span style="color: #483d8b;">print</span>(Path(p).cwd(), Path.cwd())
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#24403;&#21069;&#24037;&#20316;&#36335;&#24452;&#19981;&#20250;&#38543;&#30528;&#20320;&#36335;&#24452;&#30340;&#21464;&#21270;&#32780;&#21464;&#21270;&#65292;&#30456;&#24403;&#20110;&#24120;&#37327;&#65292;&#36890;&#36807;&#20219;&#20309;&#36335;&#24452;&#37117;&#21487;&#20197;&#26041;&#20415;&#35843;&#29992;&#21040;&#24403;&#21069;&#24037;&#20316;&#36335;&#24452;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23478;&#30446;&#24405;&#20063;&#26159;&#19968;&#26679;&#65292;&#30456;&#24403;&#20110;&#24120;&#37327;</span>
<span style="color: #483d8b;">print</span>(Path(<span style="color: #8b2252;">'abc'</span>).home(), Path.home())
</pre>
</div>
</div>
</div>
<div id="outline-container-h:7bdca2bf-dd95-4657-8701-f4a2e466f296" class="outline-5">
<h5 id="h:7bdca2bf-dd95-4657-8701-f4a2e466f296">判断方法</h5>
<div class="outline-text-5" id="text-h:7bdca2bf-dd95-4657-8701-f4a2e466f296">
<ul class="org-ul">
<li>exists() 目录或文件是否存在</li>
<li>is_dir() 是否是目录，目录存在返回True</li>
<li>is_file() 是否是普通文件，文件存在返回True</li>
<li>is_symlink() 是否是软链接</li>
<li>is_socket() 是否是socket文件</li>
<li>is_block_device() 是否是块设备</li>
<li>is_char_device() 是否是字符设备</li>
<li>is_absolute() 是否是绝对路径</li>
</ul>

<p>
注意： <b>文件只有存在</b> ，才能知道它是什么类型文件
</p>

<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p1</span> = Path(<span style="color: #8b2252;">'/dev'</span>)
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'bus'</span>).is_dir())
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'console'</span>).is_char_device())
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'cdrom'</span>).is_symlink())
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'cdrom'</span>).is_file())
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'abcdea'</span>).is_file()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#19981;&#30693;&#36947;&#26159;&#35841;&#65292;False. &#20869;&#37096;&#35843;&#29992;&#20102;exits()&#30446;&#24405;&#25110;&#25991;&#20214;&#26159;&#21542;&#23384;&#22312;</span>
<span style="color: #483d8b;">print</span>(p1.is_absolute())       
</pre>
</div>
</div>
</div>
<div id="outline-container-h:8a58941d-4b3f-4d22-abdc-27a8fac91bf9" class="outline-5">
<h5 id="h:8a58941d-4b3f-4d22-abdc-27a8fac91bf9">绝对路径</h5>
<div class="outline-text-5" id="text-h:8a58941d-4b3f-4d22-abdc-27a8fac91bf9">
<ul class="org-ul">
<li>resolve() 非windows，返回一个新的路径，这个新路径就是当前Path对象的绝对路径。如果是软链接则直接被解析</li>
<li>absolute() 获取绝对路径</li>
</ul>

<p>
范例
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>

<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p1</span> = Path(<span style="color: #8b2252;">'/dev'</span>)
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'cdrom'</span>).is_symlink())
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'cdrom'</span>).absolute())
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'cdrom'</span>).resolve()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#26159;&#36719;&#38142;&#25509;&#36820;&#22238;&#30495;&#23454;&#36335;&#24452;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">True</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">/dev/cdrom</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">/dev/sr0   </span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:a2efa435-286b-46b9-9e95-4b1240a1273c" class="outline-5">
<h5 id="h:a2efa435-286b-46b9-9e95-4b1240a1273c">其它操作</h5>
<div class="outline-text-5" id="text-h:a2efa435-286b-46b9-9e95-4b1240a1273c">
<ul class="org-ul">
<li>rmdir() 删除空目录。没有提供判断目录为的方法</li>
<li>touch(mode=0o666, exist_ok=True) 创建一个文件</li>
<li>as_uri() 将路径返回成URI，例如'file:///etc/passwd'</li>
<li><p>
mkdir(mode=0o777, parents=False, exist_ok=False)
</p>

<p>
parents 是否创建父目录，True等同于mkdir -p。False时，父目录不存在，则抛出FileExistsError被忽略
</p>

<p>
exist_ok 在3.5版本加入。False时，路径存在，抛出FileExistsError； True时 FileExistsError被忽略
</p></li>

<li>iterdir() 迭代当前目录，不递归</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'d:/tmp/mydir'</span>)
p.mkdir(parents=<span style="color: #008b8b;">True</span>, exist_ok=<span style="color: #008b8b;">True</span>)

<span style="color: #483d8b;">print</span>(p.is_file()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;False</span>
<span style="color: #483d8b;">print</span>(p.exists()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;True</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">list</span>(p.absolute().iterdir())) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;[]  &#36941;&#21382;&#30446;&#24405;&#65292;iterdir&#26041;&#27861;&#36941;&#21382;&#65292;&#36820;&#22238;&#29983;&#25104;&#22120;&#23545;&#35937;&#65292;&#36941;&#21382;&#30446;&#24405;&#19981;&#36882;&#24402;</span>
(p / <span style="color: #8b2252;">'d1'</span>).mkdir(exist_ok=<span style="color: #008b8b;">True</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21019;&#24314;&#30446;&#24405;</span>
(p / <span style="color: #8b2252;">'c1/c2/c3'</span>).mkdir(parents=<span style="color: #008b8b;">True</span>, exist_ok=<span style="color: #008b8b;">True</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21019;&#24314;&#30446;&#24405;&#65292;mkdir -p </span>
(p / <span style="color: #8b2252;">'c1/a.py'</span>).touch() <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21019;&#24314;&#25991;&#20214;</span>
(p / <span style="color: #8b2252;">'../a.py'</span>).touch() <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21019;&#24314;&#25991;&#20214;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#36941;&#21382;&#29238;&#36335;&#24452;</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> (p / <span style="color: #8b2252;">'d1'</span>).parent.iterdir():
    <span style="color: #483d8b;">print</span>(x)
<span style="color: #b22222;">#</span><span style="color: #b22222;">: d:\tmp\mydir\c1</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: d:\tmp\mydir\d1</span>
</pre>
</div>

<p>
范例：d:/tmp下的所有文件，不递归，判断是否为空目录，判断文件类型
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'d:/tmp/c1/c2'</span>)

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21487;&#20197;&#29992;parents&#25805;&#20316;&#65292;&#20063;&#21487;&#20197;&#29992;parent&#25805;&#20316;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">print(list(p.parents))</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">for x in p.parents[len(p.parents)-2].iterdir(): #&#19981;&#25903;&#25345;&#36127;&#32034;&#24341;</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> p.parent.parent.iterdir():
    <span style="color: #483d8b;">print</span>(x, <span style="color: #483d8b;">type</span>(x))
    <span style="color: #a020f0;">if</span> x.is_dir():
        <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'dir'</span>, x)
<span style="color: #b22222;">#        </span><span style="color: #b22222;">flag = False #&#19981;&#20026;&#31354;</span>
<span style="color: #b22222;">#        </span><span style="color: #b22222;">for z in x.iterdir():</span>
<span style="color: #b22222;">#            </span><span style="color: #b22222;">flag = True</span>
<span style="color: #b22222;">#            </span><span style="color: #b22222;">break</span>
<span style="color: #b22222;">#        </span><span style="color: #b22222;">print('Not empty' if flag else 'Empty')</span>
        <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'Not empty'</span> <span style="color: #a020f0;">if</span> <span style="color: #483d8b;">next</span>(x.iterdir(), <span style="color: #008b8b;">False</span>) <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">'Empty'</span>)  <span style="color: #b22222;">#</span><span style="color: #b22222;">next(&#36845;&#20195;&#23545;&#35937;, False) &#22914;&#26524;&#27809;&#26377;&#36820;&#22238;False</span>
    <span style="color: #a020f0;">elif</span> x.is_file():
        <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'file'</span>, x)
    <span style="color: #a020f0;">else</span>:
        <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'other'</span>, x)
</pre>
</div>

<ul class="org-ul">
<li>stat 相当于stat -L命令，跟踪软链接</li>
<li>lstat 使用方法同stat()，但如果是符号链接，则显示符号链接本身的文件信息。</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>

<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p1</span> = Path(<span style="color: #8b2252;">'/dev/'</span>)
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'cdrom'</span>).is_symlink())

<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'cdrom'</span>))
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'cdrom'</span>).stat()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20250;&#36319;&#36394;&#36719;&#38142;&#25509;&#65292;&#26159;&#30495;&#23454;&#36335;&#24452;&#30340;&#29366;&#24577;                                                                                                                                                              </span>
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'cdrom'</span>).resolve())
<span style="color: #483d8b;">print</span>((p1 / <span style="color: #8b2252;">'cdrom'</span>).resolve().stat())
<span style="color: #b22222;">#</span><span style="color: #b22222;">True</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">/dev/cdrom</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">os.stat_result(st_mode=25008, st_ino=160, st_dev=5, st_nlink=1, st_uid=0, st_gid=24, st_size=0, st_atime=1735647858, st_mtime=1735647858, st_ctime=1735647858)</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">/dev/sr0</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">os.stat_result(st_mode=25008, st_ino=160, st_dev=5, st_nlink=1, st_uid=0, st_gid=24, st_size=0, st_atime=1735647858, st_mtime=1735647858, st_ctime=1735647858)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:b0294a84-99f0-442c-8659-3c2ccc8892ed" class="outline-5">
<h5 id="h:b0294a84-99f0-442c-8659-3c2ccc8892ed">通配符</h5>
<div class="outline-text-5" id="text-h:b0294a84-99f0-442c-8659-3c2ccc8892ed">
<ul class="org-ul">
<li>glob(pattern) 通配给定的模式，返回生成器对象</li>
<li>rglob(pattern) 通配给定的模式，递归目录，返回生成器对象</li>
<li>? 代表一个字符</li>
<li>* 表示任意个字符</li>
<li>[abc]或[a-z]表示一个字符</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#36890;&#37197;&#31526;&#65292;&#19981;&#26159;&#27491;&#21017;&#34920;&#36798;&#24335;</span>
<span style="color: #a0522d;">p1</span> = Path(<span style="color: #8b2252;">'d:/tmp'</span>)

<span style="color: #483d8b;">print</span>(p1.glob(<span style="color: #8b2252;">'*'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24403;&#21069;&#30446;&#24405;&#19979;&#25152;&#26377;&#25991;&#20214;&#65292;&#36820;&#22238;&#21487;&#36845;&#20195;&#23545;&#35937;: &lt;generator object Path.glob at 0x0000027452864120&gt;</span>
<span style="color: #483d8b;">print</span>(p1.glob(<span style="color: #8b2252;">'*.py'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24403;&#21069;&#30446;&#24405;&#19979;&#25152;&#26377;.py&#25991;&#20214;</span>
<span style="color: #483d8b;">print</span>(p1.glob(<span style="color: #8b2252;">'*/*/*.py'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24403;&#21069;&#30446;&#24405;&#19979;&#23376;&#30446;&#24405;&#19979;&#25152;&#26377;.py&#25991;&#20214;</span>
<span style="color: #483d8b;">print</span>(p1.glob(<span style="color: #8b2252;">'**/*.py'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24403;&#21069;&#30446;&#24405;&#19979;&#20219;&#24847;&#30446;&#24405;&#19979;&#25152;&#26377;.py&#25991;&#20214;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">? &#19968;&#20010;</span>
p1.glob(<span style="color: #8b2252;">'**/[a-z]*.??'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">[a-z]*.?? &#20195;&#34920;a&#21040;z&#20219;&#24847;&#19968;&#20010;&#23383;&#31526;&#21518;&#38754;&#36319;&#20219;&#20309;&#23383;&#31526;&#65292;&#20877;&#25509;&#20010;.??</span>
p1.rglob(<span style="color: #8b2252;">'**/[a-z]*.??'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36882;&#24402;glob&#65292;&#23618;&#32423;&#23601;&#19981;&#29992;&#20889;&#20102;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:cadec8be-c38d-4683-82b7-51e2e16cbeec" class="outline-5">
<h5 id="h:cadec8be-c38d-4683-82b7-51e2e16cbeec">文件操作</h5>
<div class="outline-text-5" id="text-h:cadec8be-c38d-4683-82b7-51e2e16cbeec">
<p>
<code>Path.open(mode='r', buffering=-1, encoding=None, errors=None, newline=None)</code>
</p>

<p>
使用方法类似内建函数open。返回一个文件对象
</p>

<p>
3.5增加了新函数
</p>

<p>
<code>Path.read_bytes()</code> 以 'rb' 读取路径对应文件，并返回二进制流。看源码
</p>

<p>
<code>Path.read_text(encoding=None, errors=None)</code> 以'rt'方式读取路径对应文件，返回文本
</p>

<p>
<code>Path.write_bytes(date)</code> 以'wb'方式写入数据到路径对应文本
</p>

<p>
<code>Path.write_text(date, encoding=None, errors=None)</code> 以'wt'方式写入字符串到路径对应文件
</p>

<p>
open()函数文件操作
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'d:/tmp/a.py'</span>)

<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(p, <span style="color: #8b2252;">'w+'</span>) <span style="color: #a020f0;">as</span> f: <span style="color: #b22222;">#</span><span style="color: #b22222;">open&#25991;&#20214;&#21442;&#25968;&#21487;&#20197;&#26159; Path&#23545;&#35937;&#12289;&#23383;&#31526;&#20018;&#12289;&#25991;&#20214;&#23545;&#35937;</span>
    f.write(<span style="color: #8b2252;">'abc'</span>)
    f.seek(0)
    <span style="color: #483d8b;">print</span>(f.read())
</pre>
</div>

<p>
Path类中的文件操作
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p</span> = Path(<span style="color: #8b2252;">'d:/tmp/a.py'</span>)

p.write_text(<span style="color: #8b2252;">'abc'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20869;&#37096;&#29992;&#20102;open(mode='w')</span>
p.write_bytes(b<span style="color: #8b2252;">'abc'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20869;&#37096;&#29992;&#20102;open(mode='wb')</span>
<span style="color: #483d8b;">print</span>(p.read_text()) <span style="color: #b22222;">#</span><span style="color: #b22222;">open(mode='rt')</span>
<span style="color: #483d8b;">print</span>(p.read_bytes()) <span style="color: #b22222;">#</span><span style="color: #b22222;">open(mode='rb')</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: abc</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">: b'abc'</span>

<span style="color: #a020f0;">with</span> p.<span style="color: #483d8b;">open</span>() <span style="color: #a020f0;">as</span> f: <span style="color: #b22222;">#</span><span style="color: #b22222;">self.open(mode, ...) open(file, mode)</span>
    <span style="color: #483d8b;">print</span>(f.read())
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:4e7929e4-c1b0-46de-88ee-7cb083328d26" class="outline-4">
<h4 id="h:4e7929e4-c1b0-46de-88ee-7cb083328d26">os模块</h4>
<div class="outline-text-4" id="text-h:4e7929e4-c1b0-46de-88ee-7cb083328d26">
<p>
操作系统平台
</p>

<ul class="org-ul">
<li><code>os.name</code> windows是nt，linux是posix</li>
<li><code>os.uname()</code> *nix支持</li>
<li><code>sys.platform</code> windows显示win32, linux显示linux</li>
</ul>

<p>
os.listdir('d:/tmp') 返回指定目录内容列表，不递归
</p>

<p>
os也有open、read、write等方法，但是太底层，建议使用内建函数open、read、write，使用方式相似
</p>

<p>
<code>os.stat(path, *, dir_fd=None, follow_symlinks=True)</code> 本质上调用linux系统的stat
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">import</span> os
<span style="color: #a020f0;">import</span> sys

<span style="color: #483d8b;">print</span>(os.name, sys.platform)
<span style="color: #b22222;">#</span><span style="color: #b22222;">: nt win32</span>

<span style="color: #483d8b;">print</span>(os.listdir(<span style="color: #8b2252;">'d:/tmp'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;&#23383;&#31526;&#20018;&#21015;&#34920;&#65292;&#23601;&#19981;&#36882;&#24402;</span>
<span style="color: #483d8b;">print</span>(os.path.isdir(<span style="color: #8b2252;">'d:/tmp'</span>))
<span style="color: #483d8b;">print</span>(os.stat(<span style="color: #8b2252;">'d:/tmp/test'</span>))  <span style="color: #b22222;">#</span><span style="color: #b22222;">mode=33188</span>
<span style="color: #483d8b;">print</span>(os.lstat(<span style="color: #8b2252;">'d:/tmp/test'</span>))
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">oct</span>(31888)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20843;&#36827;&#21046; 0o76220 &#26435;&#38480;&#20026;rwww</span>
</pre>
</div>

<p>
<code>os.chmod(path, mode, *, dir_fd=None, follow_symlinks=True)</code>
</p>

<p>
<code>os.chmod('test', 0o777)</code>
</p>

<p>
<code>os.chown(path, uid, git)</code> 改变文件的属性、属组，但需要足够的权限
</p>
</div>
</div>
</div>
<div id="outline-container-h:2ef17ab1-30e3-4714-8f81-6666a8c88240" class="outline-3">
<h3 id="h:2ef17ab1-30e3-4714-8f81-6666a8c88240">shutil模块</h3>
<div class="outline-text-3" id="text-h:2ef17ab1-30e3-4714-8f81-6666a8c88240">
<p>
文件拷贝：使用打开2文件对象，源文件读取内容，写入目标文件中来完成拷贝过程。但是这样丢失stat数据信息(权限等)，因为根本没有复制这些信息过去。
</p>

<p>
目录复制又怎么办呢？
</p>

<p>
Python提供了一个方便的库shutil(高级文件操作)
</p>
</div>
<div id="outline-container-h:cc1d6eb4-d6d1-4e86-a967-79533ada1241" class="outline-4">
<h4 id="h:cc1d6eb4-d6d1-4e86-a967-79533ada1241">copy 复制</h4>
<div class="outline-text-4" id="text-h:cc1d6eb4-d6d1-4e86-a967-79533ada1241">
<p>
<code>copyfileobj(fsrc, fdst[, length])</code>
</p>

<ul class="org-ul">
<li>文件对象的复制，fsrc和fdst是open打开的文件对象，复制内容。fdst要求可写。</li>
<li>length指定了表示buffer的大小</li>
<li>阅读copyfileobj函数。</li>
</ul>

<p>
<code>copyfile(src, dst, *, follow_symlinks=True)</code>
</p>
<ul class="org-ul">
<li>复制文件内容，不含元数据。src、dst为文件的路径字符串。</li>
<li>本质上调用的就是copyfileobj，所以不带元数据二进制内容复制。</li>
</ul>

<p>
<code>copymode(src, dst, *, follow_symlinks=True)</code>
</p>
<ul class="org-ul">
<li>仅复制权限</li>
</ul>

<p>
<code>copystat(src, dst, *, follow_symlinks=True)</code>
</p>
<ul class="org-ul">
<li>复制文件权限和元数据</li>
</ul>

<p>
<code>copy(src, dst, *, follow_symlinks=True)</code>
</p>
<ul class="org-ul">
<li>内部用了copyfile() 和 copymode()</li>
</ul>

<p>
<code>copy2(src, dst, *, follow_symlinks=True)</code>
</p>
<ul class="org-ul">
<li>内部用了copyfile() 和 copystat()</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path
<span style="color: #a020f0;">import</span> shutil

<span style="color: #a0522d;">src</span> = Path(<span style="color: #8b2252;">'d:/tmp/test'</span>)
<span style="color: #a0522d;">dst</span> = Path(<span style="color: #8b2252;">'d:/tmp/t.txt'</span>)

<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(src, <span style="color: #8b2252;">'rb'</span>) <span style="color: #a020f0;">as</span> fsrc:
    <span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(dst, <span style="color: #8b2252;">'wb'</span>) <span style="color: #a020f0;">as</span> fdst:
        <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20174;src&#35835;&#21462;&#65292;&#20889;&#20837;dst</span>
        shutil.copyfileobj(fsrc, fdst)

shutil.copyfile(src,dst) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23454;&#38469;&#19978;&#26159;&#19978;&#38754;&#30340;&#23454;&#29616;&#12290;</span>
shutil.copymode(src,dst) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22797;&#21046;&#26435;&#38480;</span>
shutil.copystat(src,dst) <span style="color: #b22222;">#</span><span style="color: #b22222;">stat &#20840;&#38754;&#20803;&#25968;&#25454;&#65292;&#21253;&#25324;mode</span>
shutil.copy(src,dst) <span style="color: #b22222;">#</span><span style="color: #b22222;">copyfile copymode</span>
shutil.copy2(src,dst) <span style="color: #b22222;">#</span><span style="color: #b22222;">copyfile copystat</span>
</pre>
</div>



<p>
<code>copytree(src, dst, symlinks=False, ignore=None, copy_function=copy2, ignore_dangling_symlinks=False)</code>
</p>
<ul class="org-ul">
<li>递归复制目录。默认使用copy2，也就是带更多的元数据复制。</li>
<li>src, dst必须是目录，src必须存在，dst必须不存在。</li>
<li>ignore = func ，提供一个callable(src, names) -&gt; ignored_names。 提供一个函数，它会被调用。
src是源目录，names是os.listdir(src)的结果，就是列出src中的文件名，返回值是要被过滤的文件的set类型数据。</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path
<span style="color: #a020f0;">import</span> shutil

<span style="color: #a0522d;">src</span> = Path(<span style="color: #8b2252;">'d:/tmp/d1'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36882;&#24402;copy d1 &#23376;&#25991;&#20214;</span>
<span style="color: #a0522d;">dst</span> = Path(<span style="color: #8b2252;">'d:/tmp/dx'</span>)

<span style="color: #b22222;">#</span><span style="color: #b22222;">shutil.copytree(src, dst) #&#28304;&#30446;&#24405;&#36882;&#24402;copy&#21040;dst&#65292;&#35201;&#27714;&#30446;&#26631;&#36335;&#24452;&#19981;&#33021;&#23384;&#22312;</span>

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">fn</span>(src, files): <span style="color: #b22222;">#</span><span style="color: #b22222;">src, name&#34920;&#31034;src&#25152;&#26377;&#30452;&#25509;&#30340;&#25991;&#20214;</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">print(src, files) #d:/tmp/d1 ['b.txt', 'd2']</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">ignore_names = set() #&#38598;&#21512;&#35299;&#26512;&#24335;</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">for name in names: #&#19981;&#35201;copy .py&#25991;&#20214; #&#25991;&#20214;&#21517;&#23383;&#31526;&#20018;&#21015;&#34920;</span>
<span style="color: #b22222;">#        </span><span style="color: #b22222;">print(name, type(name))</span>
<span style="color: #b22222;">#        </span><span style="color: #b22222;">if name.endswith('.py') or name.endswith('.txt'):</span>
<span style="color: #b22222;">#            </span><span style="color: #b22222;">ignore_names.add(name)</span>
<span style="color: #b22222;">#    </span><span style="color: #b22222;">return ignore_names #&#36820;&#22238;&#21487;&#36845;&#20195;&#23545;&#35937;</span>
    <span style="color: #b22222;">#</span><span style="color: #b22222;">return { name for name in names if name.endswith('.py') or name.endswith('.txt')}</span>
    <span style="color: #a020f0;">return</span> <span style="color: #483d8b;">set</span>(<span style="color: #483d8b;">filter</span>(<span style="color: #a020f0;">lambda</span> name: name.endswith(<span style="color: #8b2252;">'.py'</span>) <span style="color: #a020f0;">or</span> name.endswith(<span style="color: #8b2252;">'.txt'</span>), names)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21487;&#36845;&#20195;&#23545;&#35937;&#12290;filter&#36820;&#22238;&#19968;&#20010;&#36845;&#20195;&#22120;&#65292;&#29992;&#23436;&#23601;&#27809;&#20102;&#12290;&#25152;&#20197;&#36825;&#37324;&#29992;set() &#21464;&#20026;&#21487;&#36845;&#20195;&#23545;&#35937;&#12290;</span>

shutil.rmtree(<span style="color: #8b2252;">'d:/tmp/dx'</span>, ignore_errors=<span style="color: #008b8b;">True</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21024;&#38500;&#30446;&#24405;</span>
shutil.copytree(src, dst, ignore=fn) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#28304;&#30446;&#24405;&#36882;&#24402;copy&#21040;dst&#65292;&#35201;&#27714;&#30446;&#26631;&#36335;&#24452;&#19981;&#33021;&#23384;&#22312;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:4a18a73e-a92c-44ff-8e4b-aaf707c5fb3a" class="outline-4">
<h4 id="h:4a18a73e-a92c-44ff-8e4b-aaf707c5fb3a">rm 删除</h4>
<div class="outline-text-4" id="text-h:4a18a73e-a92c-44ff-8e4b-aaf707c5fb3a">
<p>
<code>shutil.rmtree(path, ignore_errors=False, onerror=None)</code>
</p>

<p>
递归删除。如同rm -fr一样危险，慎用。
</p>

<div class="org-src-container">
<pre class="src src-python">shutil.rmtree(<span style="color: #8b2252;">'d:/tmp'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#31867;&#20284;rm -fr</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:3e59dd36-59cb-4f77-914a-0f962edbae83" class="outline-4">
<h4 id="h:3e59dd36-59cb-4f77-914a-0f962edbae83">move 移动</h4>
<div class="outline-text-4" id="text-h:3e59dd36-59cb-4f77-914a-0f962edbae83">
<p>
<code>move(src, dst, copy_function=copy)</code>
</p>

<p>
递归移动文件、目录到目标，返回目标。
</p>

<p>
本身使用的是 os.rename 方法。
</p>

<p>
如果不支持rename，如果是目录则copytree再删除源目录
</p>

<p>
默认使用copy2方法
</p>


<div class="org-src-container">
<pre class="src src-python">shutil.move(<span style="color: #8b2252;">'d:/a'</span>, <span style="color: #8b2252;">'d:/aaa'</span>)
os.rename(<span style="color: #8b2252;">'d:/t.txt'</span>, <span style="color: #8b2252;">'d:/tmp/t'</span>)
os.rename(<span style="color: #8b2252;">'test3'</span>, <span style="color: #8b2252;">'d:/tmp/taa'</span>)
</pre>
</div>

<p>
shutil还有打包功能。生成tar并压缩。支持zip, gz, bz, xz。
</p>
</div>
</div>
<div id="outline-container-h:e4e4d1e6-dd0a-43e3-a3aa-6b32b6ef40b1" class="outline-4">
<h4 id="h:e4e4d1e6-dd0a-43e3-a3aa-6b32b6ef40b1">练习</h4>
<div class="outline-text-4" id="text-h:e4e4d1e6-dd0a-43e3-a3aa-6b32b6ef40b1">
<ol class="org-ol">
<li><p>
指定一个源文件，实现copy到目标目录
</p>

<p>
例如把/tmp/test.txt拷贝到/tmp/test1.txt
</p></li>

<li><p>
单词统计
</p>

<p>
有一个文件(<a href="https://docs.python.org/zh-cn/3.13/library/os.path.html">https://docs.python.org/zh-cn/3.13/library/os.path.html</a>)，对其进行单词统计，不区分大小写，并显示单词重复最多的10个单词
</p></li>

<li><p>
单词统计进阶
</p>

<p>
在上一题的基础上，要求用户可以排除一些单词的统计，例如a, the, of等不应该出现在具有实际意义的统计中，应当忽略。要求全部代码使用函数封装，并调用完成
</p></li>

<li><p>
配置文件转换
</p>

<p>
有一个配置文件test.ini内容如下，将其转换成json格式文件
</p>

<pre class="example" id="org9faa0d3">
[DEFAULT]
a = test

[mysql]
default-character-set=utf8
a = 100

[mysqld]
datadir =/dbserver/data
port = 33060
character-set-server=utf8
sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES
</pre></li>

<li><p>
复制目录
</p>

<p>
选择一个已存在的目录作为当前工作目录，在其下创建a/b/c/d这样的子目录结构并在这些子目录的不同层级生成50个普通文件，要求文件名由随机4个小写字母构成。
</p>

<p>
将a目录下所有内容复制到当前工作目录dst目录下，要求复制的普通文件的文件名必须是x, y, z开头。
</p>

<p>
举例，假设工作目录/tmp，构建的目录结构是/tmp/a/b/c/d。在a, b, c, d目录中放入随机生成的文件，这些文件的名称也是随机生成的。最终把a目录下所有的目录也就是b, c, d目录，和文件名开头是x, y, z开头的文件。
</p></li>
</ol>
</div>
<div id="outline-container-h:40684f55-fee0-40ac-bca5-918bbb8c3b05" class="outline-5">
<h5 id="h:40684f55-fee0-40ac-bca5-918bbb8c3b05">指定一个源文件，实现copy到目标目录</h5>
<div class="outline-text-5" id="text-h:40684f55-fee0-40ac-bca5-918bbb8c3b05">
<p>
例如把/tmp/test.txt拷贝到/tmp/test1.txt
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #a020f0;">from</span> os <span style="color: #a020f0;">import</span> path
<span style="color: #a020f0;">import</span> shutil

<span style="color: #a0522d;">base</span> = <span style="color: #8b2252;">'d:/tmp'</span>
<span style="color: #a0522d;">src</span> = <span style="color: #8b2252;">'test.txt'</span>
<span style="color: #a0522d;">dst</span> = <span style="color: #8b2252;">'test1.txt'</span>

<span style="color: #a0522d;">src</span> = path.join(base, src)
<span style="color: #a0522d;">dst</span> = path.join(base,dst)

<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(src, <span style="color: #8b2252;">'w'</span>, encoding=<span style="color: #8b2252;">'utf-8'</span>) <span style="color: #a020f0;">as</span> f:
    f.write(<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span>.join([<span style="color: #8b2252;">'123'</span>,<span style="color: #8b2252;">'abc'</span>, <span style="color: #8b2252;">'&#20320;&#22909;'</span>]))

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">copy</span>(src, dst):
    <span style="color: #a0522d;">length</span> = 16 * 1024
    <span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(src, <span style="color: #8b2252;">'rb'</span>, ) <span style="color: #a020f0;">as</span> f1:
        <span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(dst, <span style="color: #8b2252;">'wb'</span>) <span style="color: #a020f0;">as</span> f2:
            <span style="color: #a020f0;">while</span> <span style="color: #008b8b;">True</span>:
                <span style="color: #483d8b;">buffer</span> = f1.read(length)
                <span style="color: #a020f0;">if</span> <span style="color: #a020f0;">not</span> <span style="color: #483d8b;">buffer</span>:
                    <span style="color: #a020f0;">break</span>
                f2.write(<span style="color: #483d8b;">buffer</span>)

copy(src, dst) 
<span style="color: #b22222;">#</span><span style="color: #b22222;">shutil.copyfile(src,dst) #shutil.copyfileobj(fsrc,fdst)                </span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">shutil.copy(src,dst)</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">shutil.copy2(src,dst)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:f0097f55-a09b-4839-9120-9a94689c10c9" class="outline-5">
<h5 id="h:f0097f55-a09b-4839-9120-9a94689c10c9">复制目录</h5>
<div class="outline-text-5" id="text-h:f0097f55-a09b-4839-9120-9a94689c10c9">
<p>
选择一个已存在的目录作为当前工作目录，在其下创建a/b/c/d这样的子目录结构并在这些子目录的不同层级生成50个普通文件，要求文件名由随机4个小写字母构成。
</p>

<p>
将a目录下所有内容复制到当前工作目录dst目录下，要求复制的普通文件的文件名必须是x, y, z开头。
</p>

<p>
举例，假设工作目录/tmp，构建的目录结构是/tmp/a/b/c/d。在a, b, c, d目录中放入随机生成的文件，这些文件的名称也是随机生成的。最终把a目录下所有的目录也就是b, c, d目录，和文件名开头是x, y, z开头的文件。
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20934;&#22791;&#35201;&#29992;&#30340;&#30446;&#24405;</span>

<span style="color: #a020f0;">import</span> shutil
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">base</span> = Path(<span style="color: #8b2252;">'d:/tmp'</span>)
<span style="color: #a0522d;">sub</span>  = Path(<span style="color: #8b2252;">'a/b/c/d'</span>)

<span style="color: #b22222;">#</span><span style="color: #b22222;">(base / sub).mkdir(parents=True, exist_ok=True) #&#36335;&#24452;&#65292;&#38656;&#35201;&#29238;&#36335;&#24452;&#12290;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35299;&#19968;&#19979;parentes</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">print(*sub.parents)  #: a\b\c a\b a .  &#30456;&#23545;&#36335;&#24452;&#26377;&#20010;&#28857;&#65292;&#35201;&#21435;&#25481;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">list</span>(sub.parents)[:-1]) <span style="color: #b22222;">#</span><span style="color: #b22222;">: [WindowsPath('a/b/c'), WindowsPath('a/b'), WindowsPath('a')]</span>

<span style="color: #a0522d;">dirs</span> = [sub] + <span style="color: #483d8b;">list</span>(sub.parents)[:-1]
<span style="color: #483d8b;">print</span>(dirs) <span style="color: #b22222;">#</span><span style="color: #b22222;">: [WindowsPath('a/b/c/d'), WindowsPath('a/b/c'), WindowsPath('a/b'), WindowsPath('a')]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#38543;&#26426;&#25991;&#20214;</span>

<span style="color: #a020f0;">import</span> shutil
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path
<span style="color: #a020f0;">from</span> string <span style="color: #a020f0;">import</span> ascii_lowercase
<span style="color: #a020f0;">import</span> random

<span style="color: #a0522d;">base</span> = Path(<span style="color: #8b2252;">'d:/tmp/mydir'</span>)
<span style="color: #a0522d;">sub</span>  = Path(<span style="color: #8b2252;">'a/b/c/d'</span>)

<span style="color: #a0522d;">dirs</span> = [sub] + <span style="color: #483d8b;">list</span>(sub.parents)[:-1]
<span style="color: #b22222;">#</span><span style="color: #b22222;">: [WindowsPath('a/b/c/d'), WindowsPath('a/b/c'), WindowsPath('a/b'), WindowsPath('a')]</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21024;&#38500;&#30446;&#24405;</span>
<span style="color: #a020f0;">if</span> base.exists():
    shutil.rmtree(<span style="color: #483d8b;">str</span>(base))
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21019;&#24314;&#30446;&#24405;</span>
(base / sub).mkdir(parents=<span style="color: #008b8b;">True</span>, exist_ok=<span style="color: #008b8b;">True</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36335;&#24452;&#65292;&#38656;&#35201;&#29238;&#36335;&#24452;&#12290;</span>

<span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(20):
    <span style="color: #a0522d;">name</span> = <span style="color: #8b2252;">""</span>.join(random.choices(ascii_lowercase, k=4))
    <span style="color: #b22222;">#</span><span style="color: #b22222;">print(name)</span>
    (base / random.choice(dirs) / name).touch()

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#36941;&#21382;&#25152;&#26377;&#25991;&#20214;</span>
<span style="color: #483d8b;">print</span>(*<span style="color: #483d8b;">list</span>(base.rglob(<span style="color: #8b2252;">'*'</span>)), sep=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;"># </span><span style="color: #b22222;">coding: utf-8</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22797;&#21046;&#30446;&#24405;</span>

<span style="color: #a020f0;">import</span> shutil
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path
<span style="color: #a020f0;">from</span> string <span style="color: #a020f0;">import</span> ascii_lowercase
<span style="color: #a020f0;">import</span> random

<span style="color: #a0522d;">base</span> = Path(<span style="color: #8b2252;">'d:/tmp/mydir'</span>)
<span style="color: #a0522d;">sub</span>  = Path(<span style="color: #8b2252;">'a/b/c/d'</span>)

<span style="color: #a0522d;">dirs</span> = [sub] + <span style="color: #483d8b;">list</span>(sub.parents)[:-1]
<span style="color: #b22222;">#</span><span style="color: #b22222;">: [WindowsPath('a/b/c/d'), WindowsPath('a/b/c'), WindowsPath('a/b'), WindowsPath('a')]</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21024;&#38500;&#30446;&#24405;</span>
<span style="color: #a020f0;">if</span> base.exists():
    shutil.rmtree(<span style="color: #483d8b;">str</span>(base))
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21019;&#24314;&#30446;&#24405;</span>
(base / sub).mkdir(parents=<span style="color: #008b8b;">True</span>, exist_ok=<span style="color: #008b8b;">True</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36335;&#24452;&#65292;&#38656;&#35201;&#29238;&#36335;&#24452;&#12290;</span>

<span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(20):
    <span style="color: #a0522d;">name</span> = <span style="color: #8b2252;">""</span>.join(random.choices(ascii_lowercase, k=4))
    <span style="color: #b22222;">#</span><span style="color: #b22222;">print(name)</span>
    (base / random.choice(dirs) / name).touch()

<span style="color: #b22222;">#</span><span style="color: #b22222;">copy</span>
<span style="color: #a0522d;">headers</span> = <span style="color: #483d8b;">set</span>(<span style="color: #8b2252;">'xyz'</span>)
<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">ignore_files</span>(src, names):
    <span style="color: #b22222;"># </span><span style="color: #b22222;">return {name for name in names</span>
    <span style="color: #b22222;">#         </span><span style="color: #b22222;">if name[0] not in headers and Path(src, name).is_file()}</span>
    <span style="color: #a020f0;">return</span> <span style="color: #483d8b;">set</span>(<span style="color: #483d8b;">filter</span>(<span style="color: #a020f0;">lambda</span> name: name[0] <span style="color: #a020f0;">not</span> <span style="color: #a020f0;">in</span> headers <span style="color: #a020f0;">and</span> Path(src, name).is_file(), names))

shutil.copytree(<span style="color: #483d8b;">str</span>(base / <span style="color: #8b2252;">'a'</span>), <span style="color: #483d8b;">str</span>(base / <span style="color: #8b2252;">'dst'</span>), ignore=ignore_files)

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#36941;&#21382;&#25152;&#26377;&#25991;&#20214;</span>
<span style="color: #483d8b;">print</span>(*(base / <span style="color: #8b2252;">'dst'</span>).rglob(<span style="color: #8b2252;">'*'</span>), sep=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9dede179-23dc-4f80-81f5-b66390419372" class="outline-5">
<h5 id="h:9dede179-23dc-4f80-81f5-b66390419372">密码强度</h5>
<div class="outline-text-5" id="text-h:9dede179-23dc-4f80-81f5-b66390419372">
<pre class="example" id="org6cbdd8b">
要求密码必须由10-15位，指定字符组成：
十进制数字
大写字母
小写字母
下划线
要求四种类型的字符都要出现才算合法的强密码

例如：Aatb32_67mnq，其中包含大写字母、小写字母、数字和下划线，是合格的强密码

^[a-zA-Z0-9_]{10,15}$
但是还是没有解决类似于11111111112这种密码问题，如果解决？

较好的思路：
1. 给一个列表，打标记[0,0,0,0]
2. 首先长度判断
3. 遍历密码原文字符串的字符，判断这个字符是哪一个分类，如果不是上面4类，直接返回非常密码。
   如果每一个字符都合格，属于哪个分类就在该分类上标记为1
4. 如果4类都有，则列表为[1,1,1,1]，哪一种字符没出现过，就是0

这样既可以判断密码强弱，还知道了密码的强度等级。
</pre>
</div>
</div>
<div id="outline-container-h:bc35de77-49f4-4f3c-b9ea-211c85480dac" class="outline-5">
<h5 id="h:bc35de77-49f4-4f3c-b9ea-211c85480dac">配置文件转换</h5>
<div class="outline-text-5" id="text-h:bc35de77-49f4-4f3c-b9ea-211c85480dac">
<p>
有一个配置文件test.ini内容如下，将其转换成json格式文件
</p>

<pre class="example" id="org6e6bd0f">
[DEFAULT]
a = test

[mysql]
default-character-set=utf8
a = 100

[mysqld]
datadir =/dbserver/data
port = 33060
character-set-server=utf8
sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES
</pre>

<p>
代码
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> json
<span style="color: #a020f0;">from</span> configparser <span style="color: #a020f0;">import</span> ConfigParser

<span style="color: #a0522d;">src</span> = <span style="color: #8b2252;">'test.ini'</span>
<span style="color: #a0522d;">dst</span> = <span style="color: #8b2252;">'test.json'</span>

<span style="color: #a0522d;">cfg</span> = ConfigParser()
cfg.read(src)

<span style="color: #a0522d;">d</span> = {}

<span style="color: #a020f0;">for</span> section <span style="color: #a020f0;">in</span> cfg.sections(): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#19981;&#24102;&#32570;&#30465;&#20540;</span>
    <span style="color: #483d8b;">print</span>(section, <span style="color: #483d8b;">type</span>(section))
    <span style="color: #483d8b;">print</span>(cfg.items(section))
    <span style="color: #b22222;"># </span><span style="color: #b22222;">['mysql', 'mysqld']</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">mysql &lt;class 'str'&gt;</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">[('a', '100'), ('default-character-set', 'utf8')]</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">mysqld &lt;class 'str'&gt;</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">[('a', 'test'), ('datadir', '/dbserver/data'), ('port', '33060'), ('character-set-server', 'utf8'), ('sql_mode', 'NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES')]</span>

    <span style="color: #a0522d;">d</span>[section] = <span style="color: #483d8b;">dict</span>(cfg.items(section))

<span style="color: #483d8b;">print</span>(d)
<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(dst, <span style="color: #8b2252;">'w'</span>, encoding=<span style="color: #8b2252;">'utf-8'</span>) <span style="color: #a020f0;">as</span> f:
    json.dump(d, f)
</pre>
</div>

<p>
查看新文件内容
</p>
<div class="org-src-container">
<pre class="src src-sh">(.venv) PS D:\project\pyproj&gt; python -m json.tool .\test.json
{
    <span style="color: #8b2252;">"mysql"</span>: {
        <span style="color: #8b2252;">"a"</span>: <span style="color: #8b2252;">"100"</span>,
        <span style="color: #8b2252;">"default-character-set"</span>: <span style="color: #8b2252;">"utf8"</span>
    },
    <span style="color: #8b2252;">"mysqld"</span>: {
        <span style="color: #8b2252;">"a"</span>: <span style="color: #8b2252;">"test"</span>,
        <span style="color: #8b2252;">"datadir"</span>: <span style="color: #8b2252;">"/dbserver/data"</span>,
        <span style="color: #8b2252;">"port"</span>: <span style="color: #8b2252;">"33060"</span>,
        <span style="color: #8b2252;">"character-set-server"</span>: <span style="color: #8b2252;">"utf8"</span>,
        <span style="color: #8b2252;">"sql_mode"</span>: <span style="color: #8b2252;">"NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES"</span>
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-h:31da8063-4f1f-4b7e-9ae4-3e70d3f51ca8" class="outline-5">
<h5 id="h:31da8063-4f1f-4b7e-9ae4-3e70d3f51ca8">单词统计</h5>
<div class="outline-text-5" id="text-h:31da8063-4f1f-4b7e-9ae4-3e70d3f51ca8">
<p>
有一个文件(<a href="https://docs.python.org/zh-cn/3.13/library/os.path.html">https://docs.python.org/zh-cn/3.13/library/os.path.html</a>)，对其进行单词统计，不区分大小写，并显示单词重复最多的10个单词
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">from</span> collections <span style="color: #a020f0;">import</span> defaultdict
<span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">filename</span> = <span style="color: #8b2252;">'sample.txt'</span>

<span style="color: #a0522d;">d</span> = {}
<span style="color: #b22222;">#</span><span style="color: #b22222;">d = defaultdict(lambda :0)</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22788;&#29702;os.path.commonpath(['/usr/lib'</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">line = "os.path.commonpath(['/usr/lib'"</span>
<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key1</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #b22222;">#</span><span style="color: #b22222;">line = line.lower()</span>
    <span style="color: #a0522d;">pattern</span> = r<span style="color: #8b2252;">"""[~`!@#$%^&amp;*()-_=+|\{}\[\]:;"'&lt;&gt;?/,.\s]+"""</span>
    <span style="color: #a0522d;">ret</span> = re.split(pattern, line)
    <span style="color: #a020f0;">return</span> ret

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key2</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #b22222;">#</span><span style="color: #b22222;">line = line.lower()</span>
    <span style="color: #a0522d;">chars</span> = <span style="color: #483d8b;">set</span>(r<span style="color: #8b2252;">"""~`!@#$%^&amp;*()-_=+|\{}[]:;"'&lt;&gt;?/,."""</span>)
    <span style="color: #a0522d;">ret</span> = []
    <span style="color: #a020f0;">for</span> c <span style="color: #a020f0;">in</span> line:
        <span style="color: #a020f0;">if</span> c <span style="color: #a020f0;">in</span> chars:
            ret.append(<span style="color: #8b2252;">' '</span>)
        <span style="color: #a020f0;">else</span>:
            ret.append(c)
    <span style="color: #a020f0;">return</span> <span style="color: #8b2252;">''</span>.join(ret).split()

<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(filename, encoding=<span style="color: #8b2252;">'utf-8'</span>) <span style="color: #a020f0;">as</span> f:
    <span style="color: #a020f0;">for</span> line <span style="color: #a020f0;">in</span> f: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36880;&#34892;&#22788;&#29702;</span>
        <span style="color: #b22222;">#</span><span style="color: #b22222;">&#19981;&#21306;&#20998;&#22823;&#23567;&#20889;</span>
        <span style="color: #b22222;"># </span><span style="color: #b22222;">line = line.lower()</span>
        <span style="color: #b22222;"># </span><span style="color: #b22222;">words = line.split()</span>
        <span style="color: #b22222;"># </span><span style="color: #b22222;">for word in words:</span>
        <span style="color: #b22222;"># </span><span style="color: #b22222;">for word in map(lambda x:x.lower(), make_key1(line)):</span>
        <span style="color: #a020f0;">for</span> word <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">map</span>(<span style="color: #483d8b;">str</span>.lower, make_key1(line)):
            <span style="color: #b22222;"># </span><span style="color: #b22222;">print(word)</span>
            <span style="color: #b22222;">#</span><span style="color: #b22222;">d[word] += 1</span>
            <span style="color: #a0522d;">d</span>[word] = d.get(word, 0) + 1

<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">sorted</span>(d.items(), key=<span style="color: #a020f0;">lambda</span> item:item[1], reverse=<span style="color: #008b8b;">True</span>) )

<span style="color: #b22222;"># </span><span style="color: #b22222;">for k in d.keys():</span>
<span style="color: #b22222;">#     </span><span style="color: #b22222;">if k.find('path') &gt; -1:</span>
<span style="color: #b22222;">#         </span><span style="color: #b22222;">print(k)</span>
<span style="color: #483d8b;">print</span>(*<span style="color: #483d8b;">filter</span>(<span style="color: #a020f0;">lambda</span> k: k.find(<span style="color: #8b2252;">'path'</span>) &gt; -1, d.keys()), sep=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span>)


<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key3</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #b22222;">#</span><span style="color: #b22222;">line = line.lower()</span>
    <span style="color: #a0522d;">chars</span> = <span style="color: #483d8b;">set</span>(<span style="color: #8b2252;">"""~`!@#$%^&amp;*()-_=+|\{}[]:;"'&lt;&gt;?/,.</span><span style="color: #008b8b;">\n\r\t</span><span style="color: #8b2252;">"""</span>)
    <span style="color: #a0522d;">ret</span> = []
    <span style="color: #a0522d;">start</span> = 0
    <span style="color: #a0522d;">length</span>  = <span style="color: #483d8b;">len</span>(line)
    <span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(line):
        <span style="color: #a020f0;">if</span> c <span style="color: #a020f0;">in</span> chars:
            <span style="color: #a020f0;">if</span> start == i:
                <span style="color: #a0522d;">start</span> = i + 1
                <span style="color: #a020f0;">continue</span>
            ret.append(line[start:i])
            <span style="color: #a0522d;">start</span> = i + 1 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20551;&#23450;&#19979;&#19968;&#20010;&#23383;&#31526;&#26159;OK&#30340;</span>
    <span style="color: #a020f0;">else</span>:
        <span style="color: #a020f0;">if</span> start &lt; length:
            ret.append(line[start:])
    <span style="color: #a020f0;">return</span> ret
<span style="color: #a0522d;">line</span> = <span style="color: #8b2252;">"os.path.commonpath(['/usr/lib'"</span>
<span style="color: #483d8b;">print</span>(make_key3(line))


<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key4</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #b22222;">#</span><span style="color: #b22222;">line = line.lower()</span>
    <span style="color: #a0522d;">chars</span> = <span style="color: #483d8b;">set</span>(<span style="color: #8b2252;">"""~`!@#$%^&amp;*()-_=+|\{}[]:;"'&lt;&gt;?/,.</span><span style="color: #008b8b;">\n\r\t</span><span style="color: #8b2252;">"""</span>)
    <span style="color: #b22222;"># </span><span style="color: #b22222;">ret = []</span>
    <span style="color: #a0522d;">start</span> = 0
    <span style="color: #a0522d;">length</span>  = <span style="color: #483d8b;">len</span>(line)
    <span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(line):
        <span style="color: #a020f0;">if</span> c <span style="color: #a020f0;">in</span> chars:
            <span style="color: #a020f0;">if</span> start == i:
                <span style="color: #a0522d;">start</span> = i + 1
                <span style="color: #a020f0;">continue</span>
            <span style="color: #b22222;"># </span><span style="color: #b22222;">ret.append(line[start:i])</span>
            <span style="color: #a020f0;">yield</span> line[start:i]
            <span style="color: #a0522d;">start</span> = i + 1 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20551;&#23450;&#19979;&#19968;&#20010;&#23383;&#31526;</span>
    <span style="color: #a020f0;">else</span>:
        <span style="color: #a020f0;">if</span> start &lt; length:
            <span style="color: #b22222;"># </span><span style="color: #b22222;">ret.append(line[start:])</span>
            <span style="color: #a020f0;">yield</span> line[start:]

<span style="color: #a0522d;">line</span> = <span style="color: #8b2252;">"os.path.commonpath(['/usr/lib'"</span>
<span style="color: #483d8b;">print</span>(*make_key4(line))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">from</span> collections <span style="color: #a020f0;">import</span> defaultdict
<span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">filename</span> = <span style="color: #8b2252;">'sample.txt'</span>


<span style="color: #b22222;">#</span><span style="color: #b22222;">d = defaultdict(lambda :0)</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22788;&#29702;os.path.commonpath(['/usr/lib'</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">line = "os.path.commonpath(['/usr/lib'"</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(r<span style="color: #8b2252;">"""[~`!@#$%^&amp;*() -_=+|\{}\[\]:;"'&lt;&gt;?/,.\s]+"""</span>)
<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key1</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #b22222;">#</span><span style="color: #b22222;">line = line.lower()</span>
    <span style="color: #a0522d;">ret</span> = regex.split(line)
    <span style="color: #a020f0;">return</span> ret

<span style="color: #a0522d;">chars</span> = <span style="color: #483d8b;">set</span>(<span style="color: #8b2252;">"""~`!@#$%^&amp;*()-_=+|\{}[]:;"'&lt;&gt;?/,. </span><span style="color: #008b8b;">\n\r\t</span><span style="color: #8b2252;">"""</span>)

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key2</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #b22222;">#</span><span style="color: #b22222;">line = line.lower()</span>
    <span style="color: #a0522d;">ret</span> = []
    <span style="color: #a020f0;">for</span> c <span style="color: #a020f0;">in</span> line:
        <span style="color: #a020f0;">if</span> c <span style="color: #a020f0;">in</span> chars:
            ret.append(<span style="color: #8b2252;">' '</span>)
        <span style="color: #a020f0;">else</span>:
            ret.append(c)
    <span style="color: #a020f0;">return</span> <span style="color: #8b2252;">''</span>.join(ret).split()

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key3</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #b22222;">#</span><span style="color: #b22222;">line = line.lower()</span>
    <span style="color: #a0522d;">ret</span> = []
    <span style="color: #a0522d;">start</span> = 0
    <span style="color: #a0522d;">length</span>  = <span style="color: #483d8b;">len</span>(line)
    <span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(line):
        <span style="color: #a020f0;">if</span> c <span style="color: #a020f0;">in</span> chars:
            <span style="color: #a020f0;">if</span> start == i:
                <span style="color: #a0522d;">start</span> = i + 1
                <span style="color: #a020f0;">continue</span>
            ret.append(line[start:i])
            <span style="color: #a0522d;">start</span> = i + 1 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20551;&#23450;&#19979;&#19968;&#20010;&#23383;&#31526;&#26159;OK&#30340;</span>
    <span style="color: #a020f0;">else</span>:
        <span style="color: #a020f0;">if</span> start &lt; length:
            ret.append(line[start:])
    <span style="color: #a020f0;">return</span> ret

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key4</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #a0522d;">start</span> = 0
    <span style="color: #a0522d;">length</span>  = <span style="color: #483d8b;">len</span>(line)
    <span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(line):
        <span style="color: #a020f0;">if</span> c <span style="color: #a020f0;">in</span> chars:
            <span style="color: #a020f0;">if</span> start == i:
                <span style="color: #a0522d;">start</span> = i + 1
                <span style="color: #a020f0;">continue</span>
            <span style="color: #a020f0;">yield</span> line[start:i]
            <span style="color: #a0522d;">start</span> = i + 1 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20551;&#23450;&#19979;&#19968;&#20010;&#23383;&#31526;</span>
    <span style="color: #a020f0;">else</span>:
        <span style="color: #a020f0;">if</span> start &lt; length:
            <span style="color: #a020f0;">yield</span> line[start:]

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">wordcount</span>(filename, enconding=<span style="color: #8b2252;">'utf-8'</span>, ignore=<span style="color: #008b8b;">None</span>):
    <span style="color: #a0522d;">d</span> = {}
    <span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(filename, encoding=<span style="color: #8b2252;">'utf-8'</span>) <span style="color: #a020f0;">as</span> f:
        <span style="color: #a020f0;">for</span> line <span style="color: #a020f0;">in</span> f: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36880;&#34892;&#22788;&#29702;</span>
            <span style="color: #a020f0;">for</span> word <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">map</span>(<span style="color: #483d8b;">str</span>.lower, make_key4(line)):
                <span style="color: #a0522d;">d</span>[word] = d.get(word, 0) + 1
    <span style="color: #a020f0;">return</span> d

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">topN</span>(d:<span style="color: #483d8b;">dict</span>, n:<span style="color: #483d8b;">int</span>=10):
    <span style="color: #a020f0;">return</span> <span style="color: #483d8b;">sorted</span>(d.items(), key=<span style="color: #a020f0;">lambda</span> item:item[1], reverse=<span style="color: #008b8b;">True</span>)[:n]

<span style="color: #a0522d;">t</span> = topN(wordcount(filename))
<span style="color: #483d8b;">print</span>(t)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:542e3cb1-bf1f-4114-952c-d4bb446f65a4" class="outline-5">
<h5 id="h:542e3cb1-bf1f-4114-952c-d4bb446f65a4">单词统计进阶</h5>
<div class="outline-text-5" id="text-h:542e3cb1-bf1f-4114-952c-d4bb446f65a4">
<p>
在上一题的基础上，要求用户可以排除一些单词的统计，例如a, the, of等不应该出现在具有实际意义的统计中，应当忽略。要求全部代码使用函数封装，并调用完成
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">filename</span> = <span style="color: #8b2252;">'sample.txt'</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22788;&#29702;os.path.commonpath(['/usr/lib'</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">line = "os.path.commonpath(['/usr/lib'"</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(r<span style="color: #8b2252;">"""[~`!@#$%^&amp;*()-_=+|\{}\[\]:;"'&lt;&gt;?/,.\s]+"""</span>)
<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key1</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #b22222;">#</span><span style="color: #b22222;">line = line.lower()</span>
    <span style="color: #a0522d;">ret</span> = regex.split(line)
    <span style="color: #a020f0;">return</span> ret

<span style="color: #a0522d;">chars</span> = <span style="color: #483d8b;">set</span>(<span style="color: #8b2252;">"""~`!@#$%^&amp;*()-_=+|\{}[]:;"'&lt;&gt;?/,. </span><span style="color: #008b8b;">\n\r\t</span><span style="color: #8b2252;">"""</span>)

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key2</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #b22222;">#</span><span style="color: #b22222;">line = line.lower()</span>
    <span style="color: #a0522d;">ret</span> = []
    <span style="color: #a020f0;">for</span> c <span style="color: #a020f0;">in</span> line:
        <span style="color: #a020f0;">if</span> c <span style="color: #a020f0;">in</span> chars:
            ret.append(<span style="color: #8b2252;">' '</span>)
        <span style="color: #a020f0;">else</span>:
            ret.append(c)
    <span style="color: #a020f0;">return</span> <span style="color: #8b2252;">''</span>.join(ret).split()

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key3</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #b22222;">#</span><span style="color: #b22222;">line = line.lower()</span>
    <span style="color: #a0522d;">ret</span> = []
    <span style="color: #a0522d;">start</span> = 0
    <span style="color: #a0522d;">length</span>  = <span style="color: #483d8b;">len</span>(line)
    <span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(line):
        <span style="color: #a020f0;">if</span> c <span style="color: #a020f0;">in</span> chars:
            <span style="color: #a020f0;">if</span> start == i:
                <span style="color: #a0522d;">start</span> = i + 1
                <span style="color: #a020f0;">continue</span>
            ret.append(line[start:i])
            <span style="color: #a0522d;">start</span> = i + 1 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20551;&#23450;&#19979;&#19968;&#20010;&#23383;&#31526;&#26159;OK&#30340;</span>
    <span style="color: #a020f0;">else</span>:
        <span style="color: #a020f0;">if</span> start &lt; length:
            ret.append(line[start:])
    <span style="color: #a020f0;">return</span> ret

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">make_key4</span>(line:<span style="color: #483d8b;">str</span>):
    <span style="color: #a0522d;">start</span> = 0
    <span style="color: #a0522d;">length</span>  = <span style="color: #483d8b;">len</span>(line)
    <span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(line):
        <span style="color: #a020f0;">if</span> c <span style="color: #a020f0;">in</span> chars:
            <span style="color: #a020f0;">if</span> start == i:
                <span style="color: #a0522d;">start</span> = i + 1
                <span style="color: #a020f0;">continue</span>
            <span style="color: #a020f0;">yield</span> line[start:i]
            <span style="color: #a0522d;">start</span> = i + 1 <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20551;&#23450;&#19979;&#19968;&#20010;&#23383;&#31526;</span>
    <span style="color: #a020f0;">else</span>:
        <span style="color: #a020f0;">if</span> start &lt; length:
            <span style="color: #a020f0;">yield</span> line[start:]

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">wordcount</span>(filename, enconding=<span style="color: #8b2252;">'utf-8'</span>, ignore=<span style="color: #008b8b;">None</span>):
    <span style="color: #a0522d;">d</span> = {}
    <span style="color: #a020f0;">if</span> ignore <span style="color: #a020f0;">is</span> <span style="color: #008b8b;">None</span>: <span style="color: #b22222;">#</span><span style="color: #b22222;">stopwords</span>
        <span style="color: #a0522d;">ignore</span> = <span style="color: #483d8b;">set</span>()
    <span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(filename, encoding=<span style="color: #8b2252;">'utf-8'</span>) <span style="color: #a020f0;">as</span> f:
        <span style="color: #a020f0;">for</span> line <span style="color: #a020f0;">in</span> f: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36880;&#34892;&#22788;&#29702;</span>
            <span style="color: #a020f0;">for</span> word <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">map</span>(<span style="color: #483d8b;">str</span>.lower, make_key4(line)):
                <span style="color: #a020f0;">if</span> word <span style="color: #a020f0;">not</span> <span style="color: #a020f0;">in</span> ignore:
                    <span style="color: #a0522d;">d</span>[word] = d.get(word, 0) + 1
    <span style="color: #a020f0;">return</span> d

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">topN</span>(d:<span style="color: #483d8b;">dict</span>, n:<span style="color: #483d8b;">int</span>=10):
    <span style="color: #b22222;"># </span><span style="color: #b22222;">return sorted(d.items(), key=lambda item:item[1], reverse=True)[:n]</span>
    <span style="color: #a020f0;">yield</span>  <span style="color: #a020f0;">from</span> <span style="color: #483d8b;">sorted</span>(d.items(), key=<span style="color: #a020f0;">lambda</span> item:item[1], reverse=<span style="color: #008b8b;">True</span>)[:n]
<span style="color: #a0522d;">t</span> = topN(wordcount(filename, ignore={<span style="color: #8b2252;">'the'</span>, <span style="color: #8b2252;">'is'</span>, <span style="color: #8b2252;">'a'</span>}))
<span style="color: #483d8b;">print</span>(*t)
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-h:5c1e797e-91e2-489f-a7fb-953fdb49cd15" class="outline-3">
<h3 id="h:5c1e797e-91e2-489f-a7fb-953fdb49cd15">Python的正则表达式</h3>
<div class="outline-text-3" id="text-h:5c1e797e-91e2-489f-a7fb-953fdb49cd15">
<p>
Python使用re模块提供了正则表达式处理的能力
</p>
</div>
<div id="outline-container-h:189ba1b7-9c52-4053-9d3b-a64bb57b05f7" class="outline-4">
<h4 id="h:189ba1b7-9c52-4053-9d3b-a64bb57b05f7">常量</h4>
<div class="outline-text-4" id="text-h:189ba1b7-9c52-4053-9d3b-a64bb57b05f7">
<pre class="example" id="org8dff016">
多行模式
- re.M
- re.MULTILINE

单行模式
- re.S
- re.DOTALL

忽略大小写
- re.I
- re.IGNORECASE

忽略表达式中空白字符
- re.X
- re.VERBOSE
</pre>
</div>
</div>
<div id="outline-container-h:92ea17ad-37d1-406a-bcaf-8aa3d0e50e57" class="outline-4">
<h4 id="h:92ea17ad-37d1-406a-bcaf-8aa3d0e50e57">方法</h4>
<div class="outline-text-4" id="text-h:92ea17ad-37d1-406a-bcaf-8aa3d0e50e57">
</div>
<div id="outline-container-h:efa6f574-efe5-4253-a41e-b64b3e1090f9" class="outline-5">
<h5 id="h:efa6f574-efe5-4253-a41e-b64b3e1090f9">编译</h5>
<div class="outline-text-5" id="text-h:efa6f574-efe5-4253-a41e-b64b3e1090f9">
<pre class="example" id="orgd17e8ab">
re.compile(pattern, flags=0)
</pre>

<ul class="org-ul">
<li>设定flags，编译模式，返回正则表达式对象regex</li>
<li>pattern就是正则表达式字符串，flags是选项，指代当前工作模式。正则表达式需要被编译，为了提高效率，这些编译后的结果被保存，下次使用同样的pattern的时候，就不需要再次编译</li>
<li>re的其他方法为了提高效率都调用了编译方法，就是为了提速</li>
</ul>

<p>
范例
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'\s'</span>, re.S | re.M) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:0d685a42-d452-4b64-a9fb-3f1609415fbb" class="outline-5">
<h5 id="h:0d685a42-d452-4b64-a9fb-3f1609415fbb">单次匹配</h5>
<div class="outline-text-5" id="text-h:0d685a42-d452-4b64-a9fb-3f1609415fbb">
<p>
match
</p>

<pre class="example" id="orgf136aa3">
re.match(pattern, string, flags=0)
regex.match(string[, pos[, endpos]])
</pre>
<ul class="org-ul">
<li>match匹配从字符串的开头匹配，索引为0的位置，regex对象match方法可以重设定开始位置和结束位置，返回match对象</li>
</ul>

<p>
search
</p>
<pre class="example" id="orgc57ef68">
re.search(pattern, string, flags=0)
regex.search(string[, pos[, endpos]])
</pre>
<ul class="org-ul">
<li>search匹配从头搜索直到第一个匹配，regex对象search方法可以重设定开始位置和结束位置，返回match对象</li>
</ul>

<p>
fullmatch
</p>
<pre class="example" id="org385f2f1">
re.fullmatch(pattern, string, flags=0)
regex.fullmatch(string[, pos[, endpos]])
</pre>
<ul class="org-ul">
<li>全长完全匹配，整个字符串和正则表达式匹配</li>
</ul>

<p>
范例：加强对match的理解
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""bottle</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">bag</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">big</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">apple"""</span>
<span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(s, 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#23383;&#31526;&#20018;&#32034;&#24341;&#23545;&#24212;&#20851;&#31995;</span>
    <span style="color: #483d8b;">print</span>((i-1,c), end=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span> <span style="color: #a020f0;">if</span> i%10==0 <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">''</span>)
<span style="color: #b22222;"># </span><span style="color: #b22222;">(0, 'b')(1, 'o')(2, 't')(3, 't')(4, 'l')(5, 'e')(6, '\n')(7, 'b')(8, 'a')(9, 'g')</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">(10, '\n')(11, 'b')(12, 'i')(13, 'g')(14, '\n')(15, 'a')(16, 'p')(17, 'p')(18, 'l')(19, 'e')</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">re.compile('\s', re.S | re.M) #&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">match &#21333;&#27425;&#21305;&#37197;, &#24182;&#19981;&#20570;&#20840;&#25991;&#25628;&#32034;&#65292;&#32780;&#19988;&#35201;&#27714;&#24517;&#39035;&#26159;&#20174;&#22836;&#21305;&#37197; &#32034;&#24341;0</span>
<span style="color: #a0522d;">r</span> = re.<span style="color: #a020f0;">match</span>(<span style="color: #8b2252;">'a'</span>, s)
<span style="color: #483d8b;">print</span>(r) <span style="color: #b22222;">#</span><span style="color: #b22222;">None</span>
<span style="color: #a0522d;">r</span> = re.<span style="color: #a020f0;">match</span>(<span style="color: #8b2252;">'^a'</span>, s)
<span style="color: #483d8b;">print</span>(r) <span style="color: #b22222;">#</span><span style="color: #b22222;">None &#40664;&#35748;&#27169;&#24335;&#65292;&#19968;&#25972;&#34892;&#65292;&#27809;&#26377;a&#24320;&#22836;&#30340;</span>
<span style="color: #a0522d;">r</span> = re.<span style="color: #a020f0;">match</span>(<span style="color: #8b2252;">'^a'</span>, s, re.M)
<span style="color: #483d8b;">print</span>(r) <span style="color: #b22222;">#</span><span style="color: #b22222;">None &#20174;&#32034;&#24341;0&#24320;&#22987;&#21305;&#37197;&#65292;&#25152;&#20197;&#21305;&#37197;&#19981;&#19978;</span>
<span style="color: #a0522d;">r</span> = re.<span style="color: #a020f0;">match</span>(<span style="color: #8b2252;">'a'</span>, s, re.M)
<span style="color: #483d8b;">print</span>(r) <span style="color: #b22222;">#</span><span style="color: #b22222;">None</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21363;&#20415;&#26159; MULTILINE &#22810;&#34892;&#27169;&#24335;&#65292; re.match() &#20063;&#21482;&#21305;&#37197;&#23383;&#31526;&#20018;&#30340;&#24320;&#22987;&#20301;&#32622;&#65292;&#32780;&#19981;&#21305;&#37197;&#27599;&#34892;&#24320;&#22987;</span>

<span style="color: #a0522d;">r</span> = re.<span style="color: #a020f0;">match</span>(<span style="color: #8b2252;">'b.+'</span>, s, re.S)
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;&#19981;&#19978;&#36820;&#22238;None&#65307;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21305;&#37197;&#19978;&#65292;&#24471;&#21040;match&#31867;&#22411;&#23454;&#20363;&#65292;span (start, end), math=xxx &#21305;&#37197;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=[0, 20), match='bottle\nbag\nbig\napple'&gt;</span>
<span style="color: #483d8b;">print</span>(r.start(), r.end()) <span style="color: #b22222;">#</span><span style="color: #b22222;">0 20 &#12290;&#21305;&#37197;&#20174;&#22836;&#33267;&#23614;</span>
<span style="color: #483d8b;">print</span>(s[r.start():r.end()].encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">b'bottle\nbag\nbig\napple'</span>
<span style="color: #483d8b;">print</span>(r.string.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21407;&#23383;&#31526;&#20018;&#20869;&#23481;&#65292;&#21363;s&#26412;&#36523;&#20869;&#23481; b'bottle\nbag\nbig\napple'</span>

<span style="color: #a0522d;">r</span> = re.<span style="color: #a020f0;">match</span>(<span style="color: #8b2252;">'b.+'</span>, s, re.M) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22810;&#34892;&#27169;&#24335;&#21305;&#37197;&#65292;&#20294;match&#21482;&#20570;&#21333;&#27425;&#21305;&#37197;&#65292;&#25152;&#20197;&#21482;&#25343;&#21040;bottle</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(0, 6), match='bottle'&gt;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">match&#20869;&#37096;&#29992;&#20102;&#32534;&#35793;&#65292;&#19981;&#38656;&#35201;&#21453;&#22797;&#20570;&#32534;&#35793;&#65292;&#37027;&#20040;&#25105;&#20204;&#21487;&#20197;&#20808;&#32534;&#35793;&#20877;match</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#38656;&#35201;&#22810;&#27425;&#20351;&#29992;&#36825;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#30340;&#35805;&#65292;&#20351;&#29992; re.compile() &#21644;&#20445;&#23384;&#36825;&#20010;&#27491;&#21017;&#23545;&#35937;&#20197;&#20415;&#22797;&#29992;&#65292;&#21487;&#20197;&#35753;&#31243;&#24207;&#26356;&#21152;&#39640;&#25928;&#12290;</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'b.+'</span>, re.M)
<span style="color: #483d8b;">print</span>(regex.<span style="color: #a020f0;">match</span>(s)) <span style="color: #b22222;"># </span><span style="color: #b22222;">&#21333;&#27425;&#21305;&#37197; &lt;re.Match object; span=(0, 6), match='bottle'&gt;</span>
<span style="color: #483d8b;">print</span>(regex.<span style="color: #a020f0;">match</span>(s, pos=1)) <span style="color: #b22222;">#</span><span style="color: #b22222;">pos&#25351;&#23450;&#23383;&#31526;&#20018;&#32034;&#24341;&#20301;&#32622;&#12290; &#20174;s&#30340;&#32034;&#24341;1&#20301;&#32622;&#21363;o&#24320;&#22987;&#21305;&#37197;&#65292;&#27809;&#21305;&#37197;&#21040;&#65292;&#36820;&#22238;None</span>
<span style="color: #483d8b;">print</span>(regex.<span style="color: #a020f0;">match</span>(s, 7)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20174;&#32034;&#24341;7&#20301;&#32622;&#24320;&#22987;&#21305;&#37197;&#65292;&#33021;&#21305;&#37197;&#21040; &lt;re.Match object; span=(7, 10), match='bag'&gt;</span>

<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'b'</span>)
<span style="color: #a0522d;">m</span> = regex.<span style="color: #a020f0;">match</span>(s)
<span style="color: #483d8b;">print</span>(m) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#27169;&#24335;&#65292;&#20174;&#32034;&#24341;0&#24320;&#22987;&#21305;&#37197;&#65292;&lt;re.Match object; span=(0, 1), match='b'&gt;</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'^b'</span>)
<span style="color: #483d8b;">print</span>(regex.<span style="color: #a020f0;">match</span>(s)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#27169;&#24335;&#65292;&#20174;&#32034;&#24341;0&#24320;&#22987;&#21305;&#37197;&#65292;&lt;re.Match object; span=(0, 1), match='b'&gt;</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'^a'</span>)
<span style="color: #483d8b;">print</span>(regex.<span style="color: #a020f0;">match</span>(s)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#27169;&#24335;&#65292;&#20174;&#32034;&#24341;0&#24320;&#22987;&#21305;&#37197;&#65292;None</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'^a'</span>, re.M)
<span style="color: #483d8b;">print</span>(regex.<span style="color: #a020f0;">match</span>(s)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22810;&#34892;&#27169;&#24335;&#65292;&#20174;&#32034;&#24341;0&#24320;&#22987;&#21305;&#37197;&#65292;None</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'^a'</span>, re.M)
<span style="color: #483d8b;">print</span>(regex.<span style="color: #a020f0;">match</span>(s, 8)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22810;&#34892;&#27169;&#24335;&#65292;&#20174;&#32034;&#24341;8&#24320;&#22987;&#21305;&#37197;&#65292;&#20294;&#35201;&#27714;&#26159;&#34892;&#39318;&#65292;None</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'^a'</span>, re.M)
<span style="color: #483d8b;">print</span>(regex.<span style="color: #a020f0;">match</span>(s, 15)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22810;&#34892;&#27169;&#24335;&#65292;&#20174;&#32034;&#24341;15&#24320;&#22987;&#21305;&#37197;&#65292;&#26159;&#34892;&#39318;&#65292;&lt;re.Match object; span=(15, 16), match='a'&gt;</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'a'</span>, re.M)
<span style="color: #483d8b;">print</span>(regex.<span style="color: #a020f0;">match</span>(s, 8)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22810;&#34892;&#27169;&#24335;&#65292;&#20174;&#32034;&#24341;8&#24320;&#22987;&#21305;&#37197;&#65292;&lt;re.Match object; span=(8, 9), match='a'&gt;</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'^a'</span>,)
<span style="color: #483d8b;">print</span>(regex.<span style="color: #a020f0;">match</span>(s, 15)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#27169;&#24335;&#65292;&#20174;&#32034;&#24341;15&#24320;&#22987;&#21305;&#37197;&#65292;&#20294;a&#19981;&#26159;&#34892;&#39318;&#65292;None</span>
</pre>
</div>

<p>
范例：search匹配
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""bottle</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">bag</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">big</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">apple"""</span>
<span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(s, 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#23383;&#31526;&#20018;&#32034;&#24341;&#23545;&#24212;&#20851;&#31995;</span>
    <span style="color: #483d8b;">print</span>((i-1,c), end=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span> <span style="color: #a020f0;">if</span> i%10==0 <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">''</span>)
<span style="color: #b22222;"># </span><span style="color: #b22222;">(0, 'b')(1, 'o')(2, 't')(3, 't')(4, 'l')(5, 'e')(6, '\n')(7, 'b')(8, 'a')(9, 'g')</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">(10, '\n')(11, 'b')(12, 'i')(13, 'g')(14, '\n')(15, 'a')(16, 'p')(17, 'p')(18, 'l')(19, 'e')</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">re.compile('\s', re.S | re.M) #&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">match &#21333;&#27425;&#21305;&#37197;, &#24182;&#19981;&#20570;&#20840;&#25991;&#25628;&#32034;&#65292;&#32780;&#19988;&#35201;&#27714;&#24517;&#39035;&#26159;&#20174;&#22836;&#21305;&#37197; &#32034;&#24341;0</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">search &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#20294;&#26159;&#20174;index&#20026;0&#24320;&#22987;&#21521;&#21518;&#25214;&#65292;&#25214;&#21040;&#19968;&#27425;&#23601;&#31639;&#21305;&#37197;&#21040;&#65292;&#25214;&#19981;&#21040;&#36820;&#22238;None&#12290;</span>
<span style="color: #a0522d;">r</span> = re.search(<span style="color: #8b2252;">'b'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(0, 1), match='b'&gt;</span>
<span style="color: #a0522d;">r</span> = re.search(<span style="color: #8b2252;">'a'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(8, 9), match='a'&gt;</span>
<span style="color: #a0522d;">r</span> = re.search(<span style="color: #8b2252;">'a'</span>, s, re.M)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(8, 9), match='a'&gt;</span>
<span style="color: #a0522d;">r</span> = re.search(<span style="color: #8b2252;">'^a'</span>, s, re.M)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(15, 16), match='a'&gt;</span>
<span style="color: #a0522d;">r</span> = re.search(<span style="color: #8b2252;">'^a'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#27169;&#24335;&#65292;&#25972;&#20010;&#31639;&#19968;&#25972;&#34892;&#12290;&lt;class 'NoneType'&gt; None</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#38656;&#35201;&#22810;&#27425;&#20351;&#29992;&#36825;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#30340;&#35805;&#65292;&#20351;&#29992; re.compile() &#21644;&#20445;&#23384;&#36825;&#20010;&#27491;&#21017;&#23545;&#35937;&#20197;&#20415;&#22797;&#29992;&#65292;&#21487;&#20197;&#35753;&#31243;&#24207;&#26356;&#21152;&#39640;&#25928;&#12290;</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'^a'</span>)
<span style="color: #a0522d;">r</span> = regex.search(s)
<span style="color: #483d8b;">print</span>(r) <span style="color: #b22222;">#</span><span style="color: #b22222;">None</span>
<span style="color: #483d8b;">print</span>(regex.search(s, 15)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#27169;&#24335;&#65292;&#25972;&#20010;&#31639;&#19968;&#25972;&#34892;&#12290;&#19981;&#26159;a&#24320;&#22836;&#12290;&#24182;&#19981;&#26159;&#22810;&#34892;&#27169;&#24335;</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'^a'</span>, re.M)
<span style="color: #483d8b;">print</span>(regex.search(s, 15)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22810;&#34892;&#27169;&#24335;&#65292;a&#26159;&#36825;&#19968;&#34892;&#30340;&#34892;&#39318; &lt;re.Match object; span=(15, 16), match='a'&gt;</span>
</pre>
</div>

<p>
范例：fullmatch匹配
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""bottle</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">bag</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">big</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">apple"""</span>
<span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(s, 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#23383;&#31526;&#20018;&#32034;&#24341;&#23545;&#24212;&#20851;&#31995;</span>
    <span style="color: #483d8b;">print</span>((i-1,c), end=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span> <span style="color: #a020f0;">if</span> i%10==0 <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">''</span>)
<span style="color: #b22222;"># </span><span style="color: #b22222;">(0, 'b')(1, 'o')(2, 't')(3, 't')(4, 'l')(5, 'e')(6, '\n')(7, 'b')(8, 'a')(9, 'g')</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">(10, '\n')(11, 'b')(12, 'i')(13, 'g')(14, '\n')(15, 'a')(16, 'p')(17, 'p')(18, 'l')(19, 'e')</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">re.compile('\s', re.S | re.M) #&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">match &#21333;&#27425;&#21305;&#37197;, &#24182;&#19981;&#20570;&#20840;&#25991;&#25628;&#32034;&#65292;&#32780;&#19988;&#35201;&#27714;&#24517;&#39035;&#26159;&#20174;&#22836;&#21305;&#37197; &#32034;&#24341;0</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">search &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#20294;&#26159;&#20174;index&#20026;0&#24320;&#22987;&#21521;&#21518;&#25214;&#65292;&#25214;&#21040;&#19968;&#27425;&#23601;&#31639;&#21305;&#37197;&#21040;&#65292;&#25214;&#19981;&#21040;&#36820;&#22238;None&#12290;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">fullmatch &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#35201;&#27714;&#25351;&#23450;&#21306;&#38388;&#20840;&#37096;&#21305;&#37197;</span>
<span style="color: #a0522d;">r</span> = re.fullmatch(<span style="color: #8b2252;">'b.+'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'NoneType'&gt; None</span>
<span style="color: #a0522d;">r</span> = re.fullmatch(<span style="color: #8b2252;">'bag'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'NoneType'&gt; None</span>
<span style="color: #a0522d;">r</span> = re.fullmatch(<span style="color: #8b2252;">'b.+'</span>, s, re.S)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(0, 20), match='bottle\nbag\nbig\napple'&gt;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#38656;&#35201;&#22810;&#27425;&#20351;&#29992;&#36825;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#30340;&#35805;&#65292;&#20351;&#29992; re.compile() &#21644;&#20445;&#23384;&#36825;&#20010;&#27491;&#21017;&#23545;&#35937;&#20197;&#20415;&#22797;&#29992;&#65292;&#21487;&#20197;&#35753;&#31243;&#24207;&#26356;&#21152;&#39640;&#25928;&#12290;</span>
<span style="color: #a0522d;">r</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'bag'</span>)
<span style="color: #483d8b;">print</span>(r.fullmatch(s, 7)) <span style="color: #b22222;">#</span><span style="color: #b22222;">None</span>
<span style="color: #483d8b;">print</span>(r.fullmatch(s, 7, 11)) <span style="color: #b22222;">#</span><span style="color: #b22222;">None  &#21306;&#38388;&#21069;&#21253;&#21518;&#19981;&#21253; [7, 11)</span>
<span style="color: #483d8b;">print</span>(r.fullmatch(s, 7, 10)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;re.Match object; span=(7, 10), match='bag'&gt;</span>
<span style="color: #483d8b;">print</span>(r.fullmatch(s, 7, 9)) <span style="color: #b22222;">#</span><span style="color: #b22222;">None</span>
<span style="color: #a0522d;">r</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'^bag'</span>)
<span style="color: #483d8b;">print</span>(r.fullmatch(s, 7, 10)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#27169;&#24335;&#65292;bag&#19981;&#26159;&#39318;&#34892;&#12290;None</span>
<span style="color: #a0522d;">r</span> = re.<span style="color: #483d8b;">compile</span>(<span style="color: #8b2252;">'^bag'</span>, re.M)
<span style="color: #483d8b;">print</span>(r.fullmatch(s, 7, 10)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22810;&#34892;&#27169;&#24335;&#65292;bag&#26159;&#34892;&#39318;&#65292;&#24182;&#19988;&#22312;&#25351;&#23450;&#21306;&#38388;&#20869;&#21305;&#37197;&lt;re.Match object; span=(7, 10), match='bag'&gt;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:05408d5d-5b3b-4718-a2d0-8507d6c62d62" class="outline-5">
<h5 id="h:05408d5d-5b3b-4718-a2d0-8507d6c62d62">全文搜索</h5>
<div class="outline-text-5" id="text-h:05408d5d-5b3b-4718-a2d0-8507d6c62d62">
<p>
findall
</p>
<pre class="example" id="org5807b4f">
re.findall(pattern,string,flags=0)
regex.findall(string[, pos[, endpos]])
</pre>
<ul class="org-ul">
<li>对整个字符串，从左至右匹配，返回所有匹配项的列表，里面是str</li>
</ul>

<p>
finditer
</p>
<pre class="example" id="orgcdfefac">
re.finditer(pattern,string,flags=0)
regex.finditer(string[, pos[, endpos]])
</pre>
<ul class="org-ul">
<li>对整个字符串，从左至右匹配，返回所有匹配项，返回迭代器</li>
<li>注意每次迭代返回的是match对象</li>
</ul>

<p>
范例：findall匹配
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""bottle</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">bag</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">big</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">apple"""</span>
<span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(s, 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#23383;&#31526;&#20018;&#32034;&#24341;&#23545;&#24212;&#20851;&#31995;</span>
    <span style="color: #483d8b;">print</span>((i-1,c), end=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span> <span style="color: #a020f0;">if</span> i%10==0 <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">''</span>)
<span style="color: #b22222;"># </span><span style="color: #b22222;">(0, 'b')(1, 'o')(2, 't')(3, 't')(4, 'l')(5, 'e')(6, '\n')(7, 'b')(8, 'a')(9, 'g')</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">(10, '\n')(11, 'b')(12, 'i')(13, 'g')(14, '\n')(15, 'a')(16, 'p')(17, 'p')(18, 'l')(19, 'e')</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">re.compile('\s', re.S | re.M) #&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">findall &#36820;&#22238;&#21015;&#34920;&#65292;&#36820;&#22238;&#21305;&#37197;&#30340;&#23383;&#31526;&#20018;&#12290;&#36319;&#24179;&#24120;&#29702;&#35299;&#30340;&#27491;&#21017;&#26159;&#19968;&#26679;&#30340;</span>
<span style="color: #a0522d;">r</span> = re.findall(<span style="color: #8b2252;">'b'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'list'&gt; ['b', 'b', 'b']</span>
<span style="color: #a0522d;">r</span> = re.findall(r<span style="color: #8b2252;">'b\w+'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'list'&gt; ['bottle', 'bag', 'big']</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#38656;&#35201;&#22810;&#27425;&#20351;&#29992;&#36825;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#30340;&#35805;&#65292;&#20351;&#29992; re.compile() &#21644;&#20445;&#23384;&#36825;&#20010;&#27491;&#21017;&#23545;&#35937;&#20197;&#20415;&#22797;&#29992;&#65292;&#21487;&#20197;&#35753;&#31243;&#24207;&#26356;&#21152;&#39640;&#25928;&#12290;</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(r<span style="color: #8b2252;">'b\w+'</span>)
<span style="color: #483d8b;">print</span>(regex.findall(s, 1)) <span style="color: #b22222;">#</span><span style="color: #b22222;">['bag', 'big']</span>
<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(r<span style="color: #8b2252;">'^b\w+'</span>)
<span style="color: #483d8b;">print</span>(regex.findall(s, 0)) <span style="color: #b22222;">#</span><span style="color: #b22222;">['bottle']</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">match &#21333;&#27425;&#21305;&#37197;, &#24182;&#19981;&#20570;&#20840;&#25991;&#25628;&#32034;&#65292;&#32780;&#19988;&#35201;&#27714;&#24517;&#39035;&#26159;&#20174;&#22836;&#21305;&#37197; &#32034;&#24341;0</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">search &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#20294;&#26159;&#20174;index&#20026;0&#24320;&#22987;&#21521;&#21518;&#25214;&#65292;&#25214;&#21040;&#19968;&#27425;&#23601;&#31639;&#21305;&#37197;&#21040;&#65292;&#25214;&#19981;&#21040;&#36820;&#22238;None&#12290;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">fullmatch &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#35201;&#27714;&#25351;&#23450;&#21306;&#38388;&#20840;&#37096;&#21305;&#37197;</span>
</pre>
</div>

<p>
范例：finditer匹配
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""bottle</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">bag</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">big</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">apple"""</span>
<span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(s, 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#23383;&#31526;&#20018;&#32034;&#24341;&#23545;&#24212;&#20851;&#31995;</span>
    <span style="color: #483d8b;">print</span>((i-1,c), end=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span> <span style="color: #a020f0;">if</span> i%10==0 <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">''</span>)
<span style="color: #b22222;"># </span><span style="color: #b22222;">(0, 'b')(1, 'o')(2, 't')(3, 't')(4, 'l')(5, 'e')(6, '\n')(7, 'b')(8, 'a')(9, 'g')</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">(10, '\n')(11, 'b')(12, 'i')(13, 'g')(14, '\n')(15, 'a')(16, 'p')(17, 'p')(18, 'l')(19, 'e')</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">re.compile('\s', re.S | re.M) #&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">findall &#36820;&#22238;&#21015;&#34920;&#65292;&#36820;&#22238;&#21305;&#37197;&#30340;&#23383;&#31526;&#20018;&#12290;&#36319;&#24179;&#24120;&#29702;&#35299;&#30340;&#27491;&#21017;&#26159;&#19968;&#26679;&#30340;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">finditer &#36820;&#22238;&#19968;&#20010;&#36845;&#20195;&#22120;&#65292;&#27599;&#19968;&#20010;&#20803;&#32032;&#37117;&#26159;match&#23454;&#20363;</span>
<span style="color: #a0522d;">r</span> = re.finditer(r<span style="color: #8b2252;">'b\w+'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'callable_iterator'&gt; &lt;callable_iterator object at 0x00000249B4052B30&gt;</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> r:
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(x), x)
<span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(0, 6), match='bottle'&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(7, 10), match='bag'&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(11, 14), match='big'&gt;</span>

<span style="color: #a0522d;">r</span> = re.finditer(r<span style="color: #8b2252;">'^b'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'callable_iterator'&gt; &lt;callable_iterator object at 0x00000179427D27A0&gt;</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> r:
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(x), x)
<span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(0, 1), match='b'&gt;</span>

<span style="color: #a0522d;">r</span> = re.finditer(r<span style="color: #8b2252;">'^b'</span>, s, re.M)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'callable_iterator'&gt; &lt;callable_iterator object at 0x0000024685441FF0&gt;</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> r:
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(x), x)
<span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(0, 1), match='b'&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(7, 8), match='b'&gt;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(11, 12), match='b'&gt;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#38656;&#35201;&#22810;&#27425;&#20351;&#29992;&#36825;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#30340;&#35805;&#65292;&#20351;&#29992; re.compile() &#21644;&#20445;&#23384;&#36825;&#20010;&#27491;&#21017;&#23545;&#35937;&#20197;&#20415;&#22797;&#29992;&#65292;&#21487;&#20197;&#35753;&#31243;&#24207;&#26356;&#21152;&#39640;&#25928;&#12290;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">match &#21333;&#27425;&#21305;&#37197;, &#24182;&#19981;&#20570;&#20840;&#25991;&#25628;&#32034;&#65292;&#32780;&#19988;&#35201;&#27714;&#24517;&#39035;&#26159;&#20174;&#22836;&#21305;&#37197; &#32034;&#24341;0</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">search &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#20294;&#26159;&#20174;index&#20026;0&#24320;&#22987;&#21521;&#21518;&#25214;&#65292;&#25214;&#21040;&#19968;&#27425;&#23601;&#31639;&#21305;&#37197;&#21040;&#65292;&#25214;&#19981;&#21040;&#36820;&#22238;None&#12290;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">fullmatch &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#35201;&#27714;&#25351;&#23450;&#21306;&#38388;&#20840;&#37096;&#21305;&#37197;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:62cf5a2d-490b-4aac-a77b-77bef40a9008" class="outline-5">
<h5 id="h:62cf5a2d-490b-4aac-a77b-77bef40a9008">匹配替换</h5>
<div class="outline-text-5" id="text-h:62cf5a2d-490b-4aac-a77b-77bef40a9008">
<p>
sub
</p>
<pre class="example" id="org39ef797">
re.sub(pattern, replacement, string, count=0, flags=0)
regex.sub(replacement, string, count=0)
</pre>
<ul class="org-ul">
<li>使用pattern对字符串string进行匹配，对匹配项使用replacement替换，返回的是str</li>
<li>replacement可是是string、bytes、function</li>
</ul>

<p>
subn
</p>
<pre class="example" id="org21ad69f">
re.subn(pattern, replacement, string, count=0, flags=0)
regex.subn(replacement, string, count=0)
</pre>
<ul class="org-ul">
<li>同sub返回一个元祖(new_string, number_of_subs_made)</li>
</ul>

<p>
范例：sub和subn匹配替换
</p>

<p>
简单的用str.replace替换， <code>"123".replace('12', 'ab')</code>
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""bottle</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">bag</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">big</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">apple"""</span>
<span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(s, 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#23383;&#31526;&#20018;&#32034;&#24341;&#23545;&#24212;&#20851;&#31995;</span>
    <span style="color: #483d8b;">print</span>((i-1,c), end=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span> <span style="color: #a020f0;">if</span> i%10==0 <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">''</span>)
<span style="color: #b22222;"># </span><span style="color: #b22222;">(0, 'b')(1, 'o')(2, 't')(3, 't')(4, 'l')(5, 'e')(6, '\n')(7, 'b')(8, 'a')(9, 'g')</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">(10, '\n')(11, 'b')(12, 'i')(13, 'g')(14, '\n')(15, 'a')(16, 'p')(17, 'p')(18, 'l')(19, 'e')</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">re.compile('\s', re.S | re.M) #&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">sub &#27169;&#24335;&#26367;&#25442;&#65292;&#21487;&#20197;&#25351;&#23450;&#33267;&#22810;&#26367;&#25442;&#30340;&#27425;&#25968;&#65292;&#36820;&#22238;&#26367;&#25442;&#32467;&#26524;</span>
<span style="color: #a0522d;">r</span> = re.sub(r<span style="color: #8b2252;">'b\w+'</span>, <span style="color: #8b2252;">'abc'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'str'&gt; b'abc\nabc\nabc\napple'</span>
<span style="color: #a0522d;">r</span> = re.sub(r<span style="color: #8b2252;">'b\w+'</span>, <span style="color: #8b2252;">'abc'</span>, s, count=1) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26368;&#22810;&#26367;&#25442;1&#27425;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'str'&gt; b'abc\nbag\nbig\napple'</span>
<span style="color: #a0522d;">r</span> = re.sub(r<span style="color: #8b2252;">'b\w+'</span>, <span style="color: #8b2252;">'abc'</span>, s, count=10) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26368;&#22810;&#26367;&#25442;10&#27425;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'str'&gt; b'abc\nabc\nabc\napple'</span>

<span style="color: #a0522d;">regex</span> = re.<span style="color: #483d8b;">compile</span>(r<span style="color: #8b2252;">'b\w+'</span>)
<span style="color: #483d8b;">print</span>(regex.sub(<span style="color: #8b2252;">'abc'</span>,s, 2).encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">b'abc\nabc\nbig\napple'</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">subn &#27169;&#24335;&#26367;&#25442;&#65292;&#21487;&#20197;&#25351;&#23450;&#33267;&#22810;&#26367;&#25442;&#30340;&#27425;&#25968;&#65292;&#36820;&#22238;&#20803;&#32452;(&#26367;&#25442;&#30340;&#32467;&#26524;, &#26367;&#25442;&#30340;&#27425;&#25968;)</span>
<span style="color: #a0522d;">r</span> = re.subn(r<span style="color: #8b2252;">'b\w+'</span>, <span style="color: #8b2252;">'abc'</span>, s, count=10) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26368;&#22810;&#26367;&#25442;10&#27425;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'tuple'&gt; ('abc\nabc\nabc\napple', 3) &#36820;&#22238;&#20803;&#32452;&#65292;&#21518;&#38754;&#25968;&#23383;&#26159;&#26367;&#25442;&#30340;&#27425;&#25968;</span>
<span style="color: #a0522d;">r</span> = re.subn(r<span style="color: #8b2252;">'b\w+'</span>, <span style="color: #8b2252;">'abc'</span>, s, count=1) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26368;&#22810;&#26367;&#25442;1&#27425;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(r), r) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'tuple'&gt; ('abc\nbag\nbig\napple', 1) &#36820;&#22238;&#20803;&#32452;&#65292;&#21518;&#38754;&#25968;&#23383;&#26159;&#26367;&#25442;&#30340;&#27425;&#25968;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">findall &#36820;&#22238;&#21015;&#34920;&#65292;&#36820;&#22238;&#21305;&#37197;&#30340;&#23383;&#31526;&#20018;&#12290;&#36319;&#24179;&#24120;&#29702;&#35299;&#30340;&#27491;&#21017;&#26159;&#19968;&#26679;&#30340;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">finditer &#36820;&#22238;&#19968;&#20010;&#36845;&#20195;&#22120;&#65292;&#27599;&#19968;&#20010;&#20803;&#32032;&#37117;&#26159;match&#23454;&#20363;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">match &#21333;&#27425;&#21305;&#37197;, &#24182;&#19981;&#20570;&#20840;&#25991;&#25628;&#32034;&#65292;&#32780;&#19988;&#35201;&#27714;&#24517;&#39035;&#26159;&#20174;&#22836;&#21305;&#37197; &#32034;&#24341;0</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">search &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#20294;&#26159;&#20174;index&#20026;0&#24320;&#22987;&#21521;&#21518;&#25214;&#65292;&#25214;&#21040;&#19968;&#27425;&#23601;&#31639;&#21305;&#37197;&#21040;&#65292;&#25214;&#19981;&#21040;&#36820;&#22238;None&#12290;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">fullmatch &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#35201;&#27714;&#25351;&#23450;&#21306;&#38388;&#20840;&#37096;&#21305;&#37197;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:77099962-0baa-4908-8627-bfc0ae1c697f" class="outline-5">
<h5 id="h:77099962-0baa-4908-8627-bfc0ae1c697f">分割字符串</h5>
<div class="outline-text-5" id="text-h:77099962-0baa-4908-8627-bfc0ae1c697f">
<pre class="example" id="org5ffc248">
re.split(pattern, string, maxsplit=0, flags=0)
</pre>

<p>
范例：split分割匹配
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""bottle</span><span style="color: #008b8b;">\n\t\t\t\t</span><span style="color: #8b2252;"> </span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">bag</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">big</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">apple"""</span>
<span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(s, 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#23383;&#31526;&#20018;&#32034;&#24341;&#23545;&#24212;&#20851;&#31995;</span>
    <span style="color: #483d8b;">print</span>((i-1,c), end=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span> <span style="color: #a020f0;">if</span> i%10==0 <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">''</span>)
<span style="color: #b22222;">#</span><span style="color: #b22222;">(0, 'b')(1, 'o')(2, 't')(3, 't')(4, 'l')(5, 'e')(6, '\n')(7, '\t')(8, '\t')(9, '\t')</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">(10, '\t')(11, ' ')(12, '\n')(13, 'b')(14, 'a')(15, 'g')(16, '\n')(17, 'b')(18, 'i')(19, 'g')</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">(20, '\n')(21, 'a')(22, 'p')(23, 'p')(24, 'l')(25, 'e')</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">re.compile('\s', re.S | re.M) #&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">split &#20998;&#21106;&#65292;&#25351;&#23450;&#20998;&#21106;&#31526;</span>
<span style="color: #483d8b;">print</span>(s.split()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#40664;&#35748;&#20351;&#29992; \s+ &#20998;&#21106; ['bottle', 'bag', 'big', 'apple']</span>

<span style="color: #483d8b;">print</span>(re.split(r<span style="color: #8b2252;">'\s+'</span>, s, maxsplit=1)) <span style="color: #b22222;">#</span><span style="color: #b22222;">['bottle', 'bag\nbig\napple']</span>
<span style="color: #483d8b;">print</span>(re.split(r<span style="color: #8b2252;">'\s+'</span>, s)) <span style="color: #b22222;">#</span><span style="color: #b22222;">['bottle', 'bag', 'big', 'apple']</span>

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""</span>
<span style="color: #8b2252;">os.path.abspath(path)</span>
<span style="color: #8b2252;">path. ([path)]</span>
<span style="color: #8b2252;">"""</span>

<span style="color: #483d8b;">print</span>(re.split(r<span style="color: #8b2252;">'\s'</span>, s)) <span style="color: #b22222;">#</span><span style="color: #b22222;">['', 'os.path.abspath(path)', 'path.', '([path)]', '']</span>
<span style="color: #483d8b;">print</span>(re.split(r<span style="color: #8b2252;">'[\s().\[\]{}]'</span>, s)) <span style="color: #b22222;">#</span><span style="color: #b22222;">['', 'os', 'path', 'abspath', 'path', '', 'path', '', '', '[path', ']', '']</span>
<span style="color: #483d8b;">print</span>(re.split(r<span style="color: #8b2252;">'[\s().\[\]{}]+'</span>, s)) <span style="color: #b22222;">#</span><span style="color: #b22222;">['', 'os', 'path', 'abspath', 'path', 'path', 'path', '']</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">sub &#27169;&#24335;&#26367;&#25442;&#65292;&#21487;&#20197;&#25351;&#23450;&#33267;&#22810;&#26367;&#25442;&#30340;&#27425;&#25968;&#65292;&#36820;&#22238;&#26367;&#25442;&#32467;&#26524;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">subn &#27169;&#24335;&#26367;&#25442;&#65292;&#21487;&#20197;&#25351;&#23450;&#33267;&#22810;&#26367;&#25442;&#30340;&#27425;&#25968;&#65292;&#36820;&#22238;&#20803;&#32452;(&#26367;&#25442;&#30340;&#32467;&#26524;, &#26367;&#25442;&#30340;&#27425;&#25968;)</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">findall &#36820;&#22238;&#21015;&#34920;&#65292;&#36820;&#22238;&#21305;&#37197;&#30340;&#23383;&#31526;&#20018;&#12290;&#36319;&#24179;&#24120;&#29702;&#35299;&#30340;&#27491;&#21017;&#26159;&#19968;&#26679;&#30340;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">finditer &#36820;&#22238;&#19968;&#20010;&#36845;&#20195;&#22120;&#65292;&#27599;&#19968;&#20010;&#20803;&#32032;&#37117;&#26159;match&#23454;&#20363;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">match &#21333;&#27425;&#21305;&#37197;, &#24182;&#19981;&#20570;&#20840;&#25991;&#25628;&#32034;&#65292;&#32780;&#19988;&#35201;&#27714;&#24517;&#39035;&#26159;&#20174;&#22836;&#21305;&#37197; &#32034;&#24341;0</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">search &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#20294;&#26159;&#20174;index&#20026;0&#24320;&#22987;&#21521;&#21518;&#25214;&#65292;&#25214;&#21040;&#19968;&#27425;&#23601;&#31639;&#21305;&#37197;&#21040;&#65292;&#25214;&#19981;&#21040;&#36820;&#22238;None&#12290;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">fullmatch &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#35201;&#27714;&#25351;&#23450;&#21306;&#38388;&#20840;&#37096;&#21305;&#37197;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5fa828f0-a7a9-4a78-bf05-14983b67c446" class="outline-5">
<h5 id="h:5fa828f0-a7a9-4a78-bf05-14983b67c446">分组</h5>
<div class="outline-text-5" id="text-h:5fa828f0-a7a9-4a78-bf05-14983b67c446">
<ul class="org-ul">
<li>使用小括号的pattern捕获的数据被放到了组group中</li>
<li>match、search函数可以返回match对象</li>
<li>findall返回字符穿列表；finditer返回一个个match对象</li>
</ul>

<p>
如果pattern中使用了分组，如果有匹配的结果，会在match对象中：
</p>
<ol class="org-ol">
<li>使用group(N)方式返回对应分组，1到N是对应的分组，0返回整个匹配的字符串，N不写缺省为0</li>
<li>如果使用了命名分组，可以使用group(‘name’)的方式取分组</li>
<li>也可以使用groups()返回所有组</li>
<li>使用groupdict()返回所有命名的分组</li>
</ol>


<p>
范例：分组
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""bottle</span><span style="color: #008b8b;">\n\t\t\t\t</span><span style="color: #8b2252;"> </span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">bag</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">big</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">apple"""</span>
<span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(s, 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#23383;&#31526;&#20018;&#32034;&#24341;&#23545;&#24212;&#20851;&#31995;</span>
    <span style="color: #483d8b;">print</span>((i-1,c), end=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span> <span style="color: #a020f0;">if</span> i%10==0 <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">''</span>)
<span style="color: #b22222;">#</span><span style="color: #b22222;">(0, 'b')(1, 'o')(2, 't')(3, 't')(4, 'l')(5, 'e')(6, '\n')(7, '\t')(8, '\t')(9, '\t')</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">(10, '\t')(11, ' ')(12, '\n')(13, 'b')(14, 'a')(15, 'g')(16, '\n')(17, 'b')(18, 'i')(19, 'g')</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">(20, '\n')(21, 'a')(22, 'p')(23, 'p')(24, 'l')(25, 'e')</span>
<span style="color: #483d8b;">print</span>()

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">re.compile('\s', re.S | re.M) #&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">split &#20998;&#21106;&#65292;&#25351;&#23450;&#20998;&#21106;&#31526;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">sub &#27169;&#24335;&#26367;&#25442;&#65292;&#21487;&#20197;&#25351;&#23450;&#33267;&#22810;&#26367;&#25442;&#30340;&#27425;&#25968;&#65292;&#36820;&#22238;&#26367;&#25442;&#32467;&#26524;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">subn &#27169;&#24335;&#26367;&#25442;&#65292;&#21487;&#20197;&#25351;&#23450;&#33267;&#22810;&#26367;&#25442;&#30340;&#27425;&#25968;&#65292;&#36820;&#22238;&#20803;&#32452;(&#26367;&#25442;&#30340;&#32467;&#26524;, &#26367;&#25442;&#30340;&#27425;&#25968;)</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">findall &#36820;&#22238;&#21015;&#34920;&#65292;&#36820;&#22238;&#21305;&#37197;&#30340;&#23383;&#31526;&#20018;&#12290;&#36319;&#24179;&#24120;&#29702;&#35299;&#30340;&#27491;&#21017;&#26159;&#19968;&#26679;&#30340;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">finditer &#36820;&#22238;&#19968;&#20010;&#36845;&#20195;&#22120;&#65292;&#27599;&#19968;&#20010;&#20803;&#32032;&#37117;&#26159;match&#23454;&#20363;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">match &#21333;&#27425;&#21305;&#37197;, &#24182;&#19981;&#20570;&#20840;&#25991;&#25628;&#32034;&#65292;&#32780;&#19988;&#35201;&#27714;&#24517;&#39035;&#26159;&#20174;&#22836;&#21305;&#37197; &#32034;&#24341;0</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">search &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#20294;&#26159;&#20174;index&#20026;0&#24320;&#22987;&#21521;&#21518;&#25214;&#65292;&#25214;&#21040;&#19968;&#27425;&#23601;&#31639;&#21305;&#37197;&#21040;&#65292;&#25214;&#19981;&#21040;&#36820;&#22238;None&#12290;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">fullmatch &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#35201;&#27714;&#25351;&#23450;&#21306;&#38388;&#20840;&#37096;&#21305;&#37197;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#32452; group</span>
<span style="color: #a0522d;">m</span> = re.<span style="color: #a020f0;">match</span>(r<span style="color: #8b2252;">'b\w+'</span>, s) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#19981;&#20998;&#32452;&#35201;&#30475;&#27491;&#21017;&#34920;&#36798;&#24335;&#20013;&#26377;&#27809;&#26377;&#25324;&#21495;</span>
<span style="color: #483d8b;">print</span>(m) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;re.Match object; span=(0, 6), match='bottle'&gt;</span>
<span style="color: #483d8b;">print</span>(m.groups()) <span style="color: #b22222;">#</span><span style="color: #b22222;">()  &#21462;&#20998;&#32452;</span>

<span style="color: #a0522d;">m</span> = re.<span style="color: #a020f0;">match</span>(r<span style="color: #8b2252;">'(b)(\w+)'</span>, s) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#19981;&#20998;&#32452;&#35201;&#30475;&#27491;&#21017;&#34920;&#36798;&#24335;&#20013;&#26377;&#27809;&#26377;&#25324;&#21495;</span>
<span style="color: #483d8b;">print</span>(m) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;re.Match object; span=(0, 6), match='bottle'&gt;</span>
<span style="color: #483d8b;">print</span>(m.groups()) <span style="color: #b22222;">#</span><span style="color: #b22222;">('b', 'ottle') &#21462;&#20998;&#32452;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">m = re.search(r'^(a)(\w+)', s) #&#21305;&#37197;&#19981;&#21040;&#65292;&#25253;&#38169;</span>

<span style="color: #a0522d;">m</span> = re.search(r<span style="color: #8b2252;">'^(a)(\w+)'</span>, s, re.M) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#19981;&#20998;&#32452;&#35201;&#30475;&#27491;&#21017;&#34920;&#36798;&#24335;&#20013;&#26377;&#27809;&#26377;&#25324;&#21495;</span>
<span style="color: #483d8b;">print</span>(m) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;re.Match object; span=(21, 26), match='apple'&gt;</span>
<span style="color: #483d8b;">print</span>(m.groups()) <span style="color: #b22222;">#</span><span style="color: #b22222;">('a', 'pple') &#21462;&#20998;&#32452;</span>

<span style="color: #a0522d;">m</span> = re.search(r<span style="color: #8b2252;">'(a)(\w+)'</span>, s, re.M) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#19981;&#20998;&#32452;&#35201;&#30475;&#27491;&#21017;&#34920;&#36798;&#24335;&#20013;&#26377;&#27809;&#26377;&#25324;&#21495;</span>
<span style="color: #483d8b;">print</span>(m) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;re.Match object; span=(14, 16), match='ag'&gt;</span>
<span style="color: #483d8b;">print</span>(m.groups()) <span style="color: #b22222;">#</span><span style="color: #b22222;">('a', 'g') &#21462;&#20998;&#32452;</span>
<span style="color: #483d8b;">print</span>(m.group()) <span style="color: #b22222;">#</span><span style="color: #b22222;">ag &#32452;&#65292;&#32452;&#21495;&#65292;&#20174;1&#24320;&#22987;</span>
<span style="color: #483d8b;">print</span>(m.group(0)) <span style="color: #b22222;">#</span><span style="color: #b22222;">m.group() &#31561;&#20215;&#65292;&#32452;0&#34920;&#31034;&lt;re.Match object; span=(14, 16), match='ag'&gt;&#20013;match</span>

<span style="color: #a0522d;">m</span> = re.search(r<span style="color: #8b2252;">'a(\w+)'</span>, s, re.M) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#19981;&#20998;&#32452;&#35201;&#30475;&#27491;&#21017;&#34920;&#36798;&#24335;&#20013;&#26377;&#27809;&#26377;&#25324;&#21495;</span>
<span style="color: #483d8b;">print</span>(m) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;re.Match object; span=(14, 16), match='ag'&gt;</span>
<span style="color: #483d8b;">print</span>(m.groups()) <span style="color: #b22222;">#</span><span style="color: #b22222;">('g',) &#21462;&#20998;&#32452;</span>
<span style="color: #483d8b;">print</span>(m.group()) <span style="color: #b22222;">#</span><span style="color: #b22222;">ag &#32452;&#65292;&#32452;&#21495;&#65292;&#20174;1&#24320;&#22987;</span>
<span style="color: #483d8b;">print</span>(m.group(0)) <span style="color: #b22222;">#</span><span style="color: #b22222;">m.group() &#31561;&#20215;&#65292;&#32452;0&#34920;&#31034;&lt;re.Match object; span=(14, 16), match='ag'&gt;&#20013;match</span>
<span style="color: #483d8b;">print</span>(m.group(1)) <span style="color: #b22222;">#</span><span style="color: #b22222;">g &#32452;&#65292;&#32452;&#21495;&#65292;&#20174;1&#24320;&#22987;</span>

<span style="color: #a0522d;">m</span> = re.search(r<span style="color: #8b2252;">'a\w+'</span>, s, re.M) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#19981;&#20998;&#32452;&#35201;&#30475;&#27491;&#21017;&#34920;&#36798;&#24335;&#20013;&#26377;&#27809;&#26377;&#25324;&#21495;</span>
<span style="color: #a020f0;">if</span> m: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#21305;&#37197;&#25104;&#21151;</span>
    <span style="color: #483d8b;">print</span>(m) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;re.Match object; span=(14, 16), match='ag'&gt;</span>
    <span style="color: #483d8b;">print</span>(m.groups()) <span style="color: #b22222;">#</span><span style="color: #b22222;">() &#21462;&#20998;&#32452;</span>
    <span style="color: #483d8b;">print</span>(m.group()) <span style="color: #b22222;">#</span><span style="color: #b22222;">ag &#32452;&#65292;&#32452;&#21495;&#65292;&#20174;1&#24320;&#22987;</span>
    <span style="color: #483d8b;">print</span>(m.group(0)) <span style="color: #b22222;">#</span><span style="color: #b22222;">m.group() &#31561;&#20215;&#65292;&#32452;0&#34920;&#31034;&lt;re.Match object; span=(14, 16), match='ag'&gt;&#20013;match</span>

</pre>
</div>

<p>
范例：命名分组
</p>

<p>
findall用法
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""bottle</span><span style="color: #008b8b;">\n\t\t\t\t</span><span style="color: #8b2252;"> </span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">bag</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">big</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">apple"""</span>
<span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(s, 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#23383;&#31526;&#20018;&#32034;&#24341;&#23545;&#24212;&#20851;&#31995;</span>
    <span style="color: #483d8b;">print</span>((i-1,c), end=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span> <span style="color: #a020f0;">if</span> i%10==0 <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">''</span>)
<span style="color: #b22222;">#</span><span style="color: #b22222;">(0, 'b')(1, 'o')(2, 't')(3, 't')(4, 'l')(5, 'e')(6, '\n')(7, '\t')(8, '\t')(9, '\t')</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">(10, '\t')(11, ' ')(12, '\n')(13, 'b')(14, 'a')(15, 'g')(16, '\n')(17, 'b')(18, 'i')(19, 'g')</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">(20, '\n')(21, 'a')(22, 'p')(23, 'p')(24, 'l')(25, 'e')</span>
<span style="color: #483d8b;">print</span>()

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">re.compile('\s', re.S | re.M) #&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">split &#20998;&#21106;&#65292;&#25351;&#23450;&#20998;&#21106;&#31526;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">sub &#27169;&#24335;&#26367;&#25442;&#65292;&#21487;&#20197;&#25351;&#23450;&#33267;&#22810;&#26367;&#25442;&#30340;&#27425;&#25968;&#65292;&#36820;&#22238;&#26367;&#25442;&#32467;&#26524;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">subn &#27169;&#24335;&#26367;&#25442;&#65292;&#21487;&#20197;&#25351;&#23450;&#33267;&#22810;&#26367;&#25442;&#30340;&#27425;&#25968;&#65292;&#36820;&#22238;&#20803;&#32452;(&#26367;&#25442;&#30340;&#32467;&#26524;, &#26367;&#25442;&#30340;&#27425;&#25968;)</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">findall &#36820;&#22238;&#21015;&#34920;&#65292;&#36820;&#22238;&#21305;&#37197;&#30340;&#23383;&#31526;&#20018;&#12290;&#36319;&#24179;&#24120;&#29702;&#35299;&#30340;&#27491;&#21017;&#26159;&#19968;&#26679;&#30340;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">finditer &#36820;&#22238;&#19968;&#20010;&#36845;&#20195;&#22120;&#65292;&#27599;&#19968;&#20010;&#20803;&#32032;&#37117;&#26159;match&#23454;&#20363;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">match &#21333;&#27425;&#21305;&#37197;, &#24182;&#19981;&#20570;&#20840;&#25991;&#25628;&#32034;&#65292;&#32780;&#19988;&#35201;&#27714;&#24517;&#39035;&#26159;&#20174;&#22836;&#21305;&#37197; &#32034;&#24341;0</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">search &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#20294;&#26159;&#20174;index&#20026;0&#24320;&#22987;&#21521;&#21518;&#25214;&#65292;&#25214;&#21040;&#19968;&#27425;&#23601;&#31639;&#21305;&#37197;&#21040;&#65292;&#25214;&#19981;&#21040;&#36820;&#22238;None&#12290;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">fullmatch &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#35201;&#27714;&#25351;&#23450;&#21306;&#38388;&#20840;&#37096;&#21305;&#37197;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#32452; group</span>
<span style="color: #a0522d;">m</span> = re.search(r<span style="color: #8b2252;">'a(?P&lt;tail&gt;\w+)'</span>, s, re.M) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#19981;&#20998;&#32452;&#35201;&#30475;&#27491;&#21017;&#34920;&#36798;&#24335;&#20013;&#26377;&#27809;&#26377;&#25324;&#21495;</span>
<span style="color: #a020f0;">if</span> m: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#21305;&#37197;&#25104;&#21151;</span>
    <span style="color: #483d8b;">print</span>(m) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;re.Match object; span=(14, 16), match='ag'&gt;</span>
    <span style="color: #483d8b;">print</span>(m.groups()) <span style="color: #b22222;">#</span><span style="color: #b22222;">('g',) &#21462;&#20998;&#32452;</span>
    <span style="color: #483d8b;">print</span>(m.group()) <span style="color: #b22222;">#</span><span style="color: #b22222;">ag &#32452;&#65292;&#32452;&#21495;&#65292;&#20174;1&#24320;&#22987;</span>
    <span style="color: #483d8b;">print</span>(m.group(0)) <span style="color: #b22222;">#</span><span style="color: #b22222;">m.group() &#31561;&#20215;&#65292;&#32452;0&#34920;&#31034;&lt;re.Match object; span=(14, 16), match='ag'&gt;&#20013;match</span>
    <span style="color: #483d8b;">print</span>()
    <span style="color: #483d8b;">print</span>(m.group(1))  <span style="color: #b22222;"># </span><span style="color: #b22222;">g &#21629;&#21517;&#20998;&#32452;&#20063;&#26377;&#32452;&#21495;</span>
    <span style="color: #483d8b;">print</span>(m.groupdict()) <span style="color: #b22222;">#</span><span style="color: #b22222;">{'tail': 'g'}</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#32452; findall&#29992;&#27861;</span>
<span style="color: #a0522d;">m</span> = re.findall(r<span style="color: #8b2252;">'(b\w+)\s+(?P&lt;name2&gt;b\w+)\s+(?P&lt;name3&gt;b\w+)'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(m), m) <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26159;&#20160;&#20040;&#31867;&#22411; &lt;class 'list'&gt; [('bottle', 'bag', 'big')]</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> m: <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26377;&#20960;&#39033;&#65292;&#33021;&#36845;&#20195;&#20960;&#19979;&#65311;&#21305;&#37197;&#20102;1&#19979;&#12290;</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(x), x) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'tuple'&gt; ('bottle', 'bag', 'big')</span>

<span style="color: #a0522d;">m</span> = re.findall(r<span style="color: #8b2252;">'(b\w+)\s+\w+\s+b\w+'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(m), m) <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26159;&#20160;&#20040;&#31867;&#22411; &lt;class 'list'&gt; ['bottle']</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> m: <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26377;&#20960;&#39033;&#65292;&#33021;&#36845;&#20195;&#20960;&#19979;&#65311;&#21305;&#37197;&#20102;1&#19979;&#12290;</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(x), x) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'str'&gt; bottle</span>

<span style="color: #a0522d;">m</span> = re.findall(r<span style="color: #8b2252;">'(b\w+)\s+\w+\s+b(\w+)'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(m), m) <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26159;&#20160;&#20040;&#31867;&#22411;&lt;class 'list'&gt; [('bottle', 'ig')]</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> m: <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26377;&#20960;&#39033;&#65292;&#33021;&#36845;&#20195;&#20960;&#19979;&#65311;&#21305;&#37197;&#20102;1&#19979;&#12290;</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(x), x) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'tuple'&gt; ('bottle', 'ig')</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21462;&#28040;&#20998;&#32452;&#30475;&#30475;</span>
<span style="color: #a0522d;">m</span> = re.findall(r<span style="color: #8b2252;">'b\w+\s+b\w+\s+b\w+'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(m), m) <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26159;&#20160;&#20040;&#31867;&#22411; &lt;class 'list'&gt; ['bottle\n\t\t\t\t \nbag\nbig']</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> m: <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26377;&#20960;&#39033;&#65292;&#33021;&#36845;&#20195;&#20960;&#19979;&#65311;&#21305;&#37197;&#20102;1&#19979;&#12290;</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(x), x.encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'str'&gt; b'bottle\n\t\t\t\t \nbag\nbig'</span>
</pre>
</div>

<p>
finditer用法
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> re

<span style="color: #a0522d;">s</span> = <span style="color: #8b2252;">"""bottle</span><span style="color: #008b8b;">\n\t\t\t\t</span><span style="color: #8b2252;"> </span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">bag</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">big</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">apple"""</span>
<span style="color: #a020f0;">for</span> i,c <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>(s, 1): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26597;&#30475;&#23383;&#31526;&#20018;&#32034;&#24341;&#23545;&#24212;&#20851;&#31995;</span>
    <span style="color: #483d8b;">print</span>((i-1,c), end=<span style="color: #8b2252;">'</span><span style="color: #008b8b;">\n</span><span style="color: #8b2252;">'</span> <span style="color: #a020f0;">if</span> i%10==0 <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">''</span>)
<span style="color: #b22222;">#</span><span style="color: #b22222;">(0, 'b')(1, 'o')(2, 't')(3, 't')(4, 'l')(5, 'e')(6, '\n')(7, '\t')(8, '\t')(9, '\t')</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">(10, '\t')(11, ' ')(12, '\n')(13, 'b')(14, 'a')(15, 'g')(16, '\n')(17, 'b')(18, 'i')(19, 'g')</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">(20, '\n')(21, 'a')(22, 'p')(23, 'p')(24, 'l')(25, 'e')</span>
<span style="color: #483d8b;">print</span>()

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#39044;&#32534;&#35793;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">re.compile('\s', re.S | re.M) #&#39044;&#32534;&#35793;&#65292;&#21333;&#34892;&#25110;&#32773;&#22810;&#34892;&#27169;&#24335;&#65292;&#24471;&#21040;&#19968;&#20010;&#27491;&#21017;&#34920;&#36798;&#24335;&#23545;&#35937;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">split &#20998;&#21106;&#65292;&#25351;&#23450;&#20998;&#21106;&#31526;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">sub &#27169;&#24335;&#26367;&#25442;&#65292;&#21487;&#20197;&#25351;&#23450;&#33267;&#22810;&#26367;&#25442;&#30340;&#27425;&#25968;&#65292;&#36820;&#22238;&#26367;&#25442;&#32467;&#26524;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">subn &#27169;&#24335;&#26367;&#25442;&#65292;&#21487;&#20197;&#25351;&#23450;&#33267;&#22810;&#26367;&#25442;&#30340;&#27425;&#25968;&#65292;&#36820;&#22238;&#20803;&#32452;(&#26367;&#25442;&#30340;&#32467;&#26524;, &#26367;&#25442;&#30340;&#27425;&#25968;)</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">findall &#36820;&#22238;&#21015;&#34920;&#65292;&#36820;&#22238;&#21305;&#37197;&#30340;&#23383;&#31526;&#20018;&#12290;&#36319;&#24179;&#24120;&#29702;&#35299;&#30340;&#27491;&#21017;&#26159;&#19968;&#26679;&#30340;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">finditer &#36820;&#22238;&#19968;&#20010;&#36845;&#20195;&#22120;&#65292;&#27599;&#19968;&#20010;&#20803;&#32032;&#37117;&#26159;match&#23454;&#20363;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">match &#21333;&#27425;&#21305;&#37197;, &#24182;&#19981;&#20570;&#20840;&#25991;&#25628;&#32034;&#65292;&#32780;&#19988;&#35201;&#27714;&#24517;&#39035;&#26159;&#20174;&#22836;&#21305;&#37197; &#32034;&#24341;0</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">search &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#20294;&#26159;&#20174;index&#20026;0&#24320;&#22987;&#21521;&#21518;&#25214;&#65292;&#25214;&#21040;&#19968;&#27425;&#23601;&#31639;&#21305;&#37197;&#21040;&#65292;&#25214;&#19981;&#21040;&#36820;&#22238;None&#12290;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">fullmatch &#26159;&#21333;&#27425;&#21305;&#37197;&#65292;&#35201;&#27714;&#25351;&#23450;&#21306;&#38388;&#20840;&#37096;&#21305;&#37197;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#32452; group</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#32452; findall&#29992;&#27861;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20998;&#32452; finditer&#29992;&#27861;</span>
<span style="color: #a0522d;">m</span> = re.finditer(r<span style="color: #8b2252;">'(b\w+)\s+(?P&lt;name2&gt;b\w+)\s+(?P&lt;name3&gt;b\w+)'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(m), m) <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26159;&#20160;&#20040;&#31867;&#22411; &lt;class 'callable_iterator'&gt; &lt;callable_iterator object at 0x00000199F139DF90&gt;</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> m: <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26377;&#20960;&#39033;&#65292;&#33021;&#36845;&#20195;&#20960;&#19979;&#65311;&#21305;&#37197;&#20102;1&#19979;&#12290;</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(x), x) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 're.Match'&gt; &lt;re.Match object; span=(0, 20), match='bottle\n\t\t\t\t \nbag\nbig'&gt;</span>
    <span style="color: #483d8b;">print</span>(x.group().encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">b'bottle\n\t\t\t\t \nbag\nbig'</span>
    <span style="color: #483d8b;">print</span>(x.groups()) <span style="color: #b22222;">#</span><span style="color: #b22222;">('bottle', 'bag', 'big')</span>
    <span style="color: #483d8b;">print</span>(x.groupdict()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20197;&#21629;&#21517;&#26041;&#24335;&#25552;&#21462;&#20998;&#32452; {'name2': 'bag', 'name3': 'big'}</span>

<span style="color: #a0522d;">m</span> = re.<span style="color: #a020f0;">match</span>(r<span style="color: #8b2252;">'(b\w+)\s+(?P&lt;name2&gt;b\w+)\s+(?P&lt;name3&gt;b\w+)'</span>, s)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(m), m) <span style="color: #b22222;">#</span><span style="color: #b22222;">m&#26159;&#20160;&#20040;&#31867;&#22411; &lt;class 're.Match'&gt; &lt;re.Match object; span=(0, 20), match='bottle\n\t\t\t\t \nbag\nbig'&gt;</span>
<span style="color: #483d8b;">print</span>(m.group().encode()) <span style="color: #b22222;">#</span><span style="color: #b22222;">b'bottle\n\t\t\t\t \nbag\nbig'</span>
<span style="color: #483d8b;">print</span>(m.groups()) <span style="color: #b22222;">#</span><span style="color: #b22222;">('bottle', 'bag', 'big')</span>
<span style="color: #483d8b;">print</span>(m.groupdict()) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20197;&#21629;&#21517;&#26041;&#24335;&#25552;&#21462;&#20998;&#32452; {'name2': 'bag', 'name3': 'big'}</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-h:9a1c6e64-ea35-4b06-af8a-0171e0dbf38b" class="outline-3">
<h3 id="h:9a1c6e64-ea35-4b06-af8a-0171e0dbf38b">csv与ini文件</h3>
<div class="outline-text-3" id="text-h:9a1c6e64-ea35-4b06-af8a-0171e0dbf38b">
</div>
<div id="outline-container-h:a1bdc9ad-39c4-4d99-84d8-b23b72dee4dc" class="outline-4">
<h4 id="h:a1bdc9ad-39c4-4d99-84d8-b23b72dee4dc">csv文件</h4>
<div class="outline-text-4" id="text-h:a1bdc9ad-39c4-4d99-84d8-b23b72dee4dc">
</div>
<div id="outline-container-h:d2d62266-dff1-4acd-b55d-365cf61c9fcb" class="outline-5">
<h5 id="h:d2d62266-dff1-4acd-b55d-365cf61c9fcb">csv文件简介</h5>
<div class="outline-text-5" id="text-h:d2d62266-dff1-4acd-b55d-365cf61c9fcb">
<ul class="org-ul">
<li>参看 RFC 4180 <a href="http://www.ietf.org/rfc/rfc4180.txt">http://www.ietf.org/rfc/rfc4180.txt</a></li>
<li>逗号分隔值Comma-Separated Values</li>
<li>CSV 是一个被行分隔符、列分隔符划分成行和列的文本文件</li>
<li>CSV不指定字符编码</li>
<li>行分隔符为\r\n，最后一行可以没有换行符</li>
<li>列分隔符常为逗号或者制表符</li>
<li>每一行成为一条记录record</li>
<li>字段可以使用双引号括起来，也可以不使用。如果字段中出现了双引号、逗号、换行符必须使用双引号括起来。如果字段的值是双引号，使用两个双引号表示一个转义</li>
<li>表头可选，和字段列对齐就行</li>
</ul>
</div>
</div>
<div id="outline-container-h:606e66e5-f52d-42f3-9cf5-3620c351e54d" class="outline-5">
<h5 id="h:606e66e5-f52d-42f3-9cf5-3620c351e54d">手动生成csv文件</h5>
<div class="outline-text-5" id="text-h:606e66e5-f52d-42f3-9cf5-3620c351e54d">
<p>
为了理解csv格式
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">p1</span> = Path(<span style="color: #8b2252;">'d:/tmp/mydir/my.csv'</span>)
p1.parent.mkdir(parents=<span style="color: #008b8b;">True</span>, exist_ok=<span style="color: #008b8b;">True</span>)

<span style="color: #b22222;"># </span><span style="color: #b22222;">"""\ &#20013;\&#26012;&#26464;&#34920;&#31034;&#32493;&#34892;&#31526;&#65292;&#36817;&#25509;&#30528;&#21518;&#38754;&#23383;&#31526;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">""&#21452;&#21452;&#24341;&#21495;&#20195;&#34920;&#19968;&#20010;&#21452;&#24341;&#21495;</span>
<span style="color: #a0522d;">csv_body</span> = <span style="color: #8b2252;">"""\</span>
<span style="color: #8b2252;">id,name,age,comment</span>
<span style="color: #8b2252;">1,zs,20, I'm 20</span>
<span style="color: #8b2252;">2,ls,18,"test string""1223."</span>
<span style="color: #8b2252;">3,ww,30,"</span>
<span style="color: #8b2252;">python</span>

<span style="color: #8b2252;">&#20320;&#22909;</span>
<span style="color: #8b2252;">"</span>
<span style="color: #8b2252;">"""</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">with p1.open('w', encoding='utf-8') as f: # newline = None \n &#36716;&#25442;&#25104; OS&#23545;&#24212;&#30340;&#25442;&#34892;&#31526;</span>
<span style="color: #b22222;">#     </span><span style="color: #b22222;">f.write(csv_body)</span>
<span style="color: #483d8b;">print</span>(csv_body.encode())
<span style="color: #b22222;">#</span><span style="color: #b22222;">b'id,name,age,comment\n1,zs,20, I\'m 20\n2,ls,18,"test string""1223."\n3,ww,30,"\npython\n\n\xe4\xbd\xa0\xe5\xa5\xbd\n"\n'</span>

p1.write_text(csv_body, encoding=<span style="color: #8b2252;">'utf-8'</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:5895a9b2-2d09-4013-adaa-cec8ca08fa24" class="outline-5">
<h5 id="h:5895a9b2-2d09-4013-adaa-cec8ca08fa24">csv模块</h5>
<div class="outline-text-5" id="text-h:5895a9b2-2d09-4013-adaa-cec8ca08fa24">
<pre class="example" id="orga3c1e56">
csv.reader(iterable, dialect='excel', *args, **kwargs)
</pre>
<ul class="org-ul">
<li>返回reader 对象，是一个行迭代器</li>
<li>默认使用excel方言，如下：
<ul class="org-ul">
<li>delimiter 列分隔符，逗号</li>
<li>lineterminator 行分隔符\r\n</li>
<li>quotechar 字段的引用符号，缺省为 " 双引号</li>
<li>双引号的处理
<ul class="org-ul">
<li>doublequote 双引号的处理，默认为True。如果碰到数据中有双引号，而quotechar也是双引号，True则使用2个双引号表示，False表示使用转义字符将作为双引号的前缀</li>
<li>escapechar 一个转义字符，默认为None</li>
<li>writer = csv.writer(f, doublequote=False, escapechar=’@’)遇到双引号，则必须提供转义字符</li>
</ul></li>
<li>quoting 指定双引号的规则
<ul class="org-ul">
<li>QUOTE_ALL 所有字段</li>
<li>QUOTE_MINIMAL 特殊字符字段，Excel方言使用该规则</li>
<li>QUOTE_NONNUMERIC 非数字字段</li>
<li>QUOTE_NONE 都不使用引号</li>
</ul></li>
</ul></li>
</ul>

<pre class="example" id="org9640d42">
csv.writer(fileobj, dialect='excel', *args, **kwargs)
</pre>
<ul class="org-ul">
<li>返回DictWriter的实例</li>
<li>主要方法有writerow、writerows</li>
</ul>

<pre class="example" id="orgdfa1ce2">
writerow(iterable)
</pre>
<ul class="org-ul">
<li>说明row行，需要一个可迭代就可以，可迭代的每一个元素，将作为csv行的每一个元素</li>
<li>windows下回再每行末尾多出一个/r，解决办法 open(‘test.csv’, ‘w’, newline=’’)</li>
</ul>

<p>
范例：读取csv文件
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path
<span style="color: #a020f0;">import</span> csv

<span style="color: #a0522d;">p1</span> = Path(<span style="color: #8b2252;">'d:/tmp/mydir/my.csv'</span>)
p1.parent.mkdir(parents=<span style="color: #008b8b;">True</span>, exist_ok=<span style="color: #008b8b;">True</span>)

<span style="color: #b22222;"># </span><span style="color: #b22222;">"""\ &#20013;\&#26012;&#26464;&#34920;&#31034;&#32493;&#34892;&#31526;&#65292;&#36817;&#25509;&#30528;&#21518;&#38754;&#23383;&#31526;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">""&#21452;&#21452;&#24341;&#21495;&#20195;&#34920;&#19968;&#20010;&#21452;&#24341;&#21495;</span>
<span style="color: #a0522d;">csv_body</span> = <span style="color: #8b2252;">"""\</span>
<span style="color: #8b2252;">id,name,age,comment</span>
<span style="color: #8b2252;">1,zs,20, I'm 20</span>
<span style="color: #8b2252;">2,ls,18,"test string""1223."</span>
<span style="color: #8b2252;">3,ww,30,"</span>
<span style="color: #8b2252;">python</span>

<span style="color: #8b2252;">&#20320;&#22909;</span>
<span style="color: #8b2252;">"</span>
<span style="color: #8b2252;">"""</span>

<span style="color: #a020f0;">with</span> p1.<span style="color: #483d8b;">open</span>(encoding=<span style="color: #8b2252;">'utf-8'</span>) <span style="color: #a020f0;">as</span> f: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22312;windows&#19979;&#40664;&#35748;&#20351;&#29992;gbk&#32534;&#30721;&#35835;&#21462;</span>
    <span style="color: #a0522d;">reader</span> = csv.reader(f)
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">next</span>(reader)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23383;&#27573;&#20998;&#24320;&#65292;&#36820;&#22238;&#21015;&#34920;&#65292;&#27599;&#19968;&#20010;&#23383;&#27573;&#39033;</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">next</span>(reader))
    <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'-'</span> * 30)
    <span style="color: #a020f0;">for</span> line <span style="color: #a020f0;">in</span> reader:
        <span style="color: #483d8b;">print</span>(line)

<span style="color: #b22222;"># </span><span style="color: #b22222;">['id', 'name', 'age', 'comment']</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['1', 'zs', '20', " I'm 20"]</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">------------------------------</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['2', 'ls', '18', 'test string"1223.']</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['3', 'ww', '30', '\npython\n\n&#20320;&#22909;\n']</span>
</pre>
</div>

<p>
范例：写csv文件
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path
<span style="color: #a020f0;">import</span> csv

<span style="color: #a0522d;">p1</span> = Path(<span style="color: #8b2252;">'d:/tmp/mydir/my.csv'</span>)
p1.parent.mkdir(parents=<span style="color: #008b8b;">True</span>, exist_ok=<span style="color: #008b8b;">True</span>)

<span style="color: #b22222;"># </span><span style="color: #b22222;">"""\ &#20013;\&#26012;&#26464;&#34920;&#31034;&#32493;&#34892;&#31526;&#65292;&#36817;&#25509;&#30528;&#21518;&#38754;&#23383;&#31526;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">""&#21452;&#21452;&#24341;&#21495;&#20195;&#34920;&#19968;&#20010;&#21452;&#24341;&#21495;</span>
<span style="color: #a0522d;">csv_body</span> = <span style="color: #8b2252;">"""\</span>
<span style="color: #8b2252;">id,name,age,comment</span>
<span style="color: #8b2252;">1,zs,20, I'm 20</span>
<span style="color: #8b2252;">2,ls,18,"test string""1223."</span>
<span style="color: #8b2252;">3,ww,30,"</span>
<span style="color: #8b2252;">python</span>

<span style="color: #8b2252;">&#20320;&#22909;</span>
<span style="color: #8b2252;">"</span>
<span style="color: #8b2252;">"""</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20889;csv&#25991;&#20214;</span>
<span style="color: #a0522d;">p2</span> = Path(<span style="color: #8b2252;">'d:/tmp/mydir/test.csv'</span>)
<span style="color: #a0522d;">rows</span> = [
    [<span style="color: #8b2252;">'id'</span>, <span style="color: #8b2252;">'name'</span>, <span style="color: #8b2252;">"age"</span>],
    <span style="color: #483d8b;">range</span>(3),  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#25968;&#23383; -&gt; &#25991;&#26412;&#25991;&#20214; -&gt; 0 &#23383;&#31526;&#20018;</span>
    <span style="color: #8b2252;">'abcdefg'</span>,
    (1, <span style="color: #8b2252;">'tom'</span>, <span style="color: #8b2252;">'20'</span>),
    ((1,), (2,)),
    ([1], [2])
]

<span style="color: #a020f0;">with</span> p2.<span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'w'</span>, encoding=<span style="color: #8b2252;">'utf-8'</span>, newline=<span style="color: #8b2252;">''</span>) <span style="color: #a020f0;">as</span> f: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20889;&#26102;&#65292;- '\n' &#25110;''&#31354;&#20018;&#34920;&#31034;'\n' &#19981;&#26367;&#25442;</span>
    <span style="color: #a0522d;">writer</span> = csv.writer(f)
    writer.writerow(rows[0]) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20889;&#31532;&#19968;&#34892;</span>
    writer.writerows(rows[1:]) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20889;&#22810;&#34892;</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">id,name,age</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">0,1,2</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">a,b,c,d,e,f,g</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">1,tom,20</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">"(1,)","(2,)"</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">[1],[2]</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35835;&#25991;&#20214;</span>
<span style="color: #a020f0;">with</span> p2.<span style="color: #483d8b;">open</span>(encoding=<span style="color: #8b2252;">'utf-8'</span>, newline=<span style="color: #8b2252;">''</span>) <span style="color: #a020f0;">as</span> f: <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22312;windows&#19979;&#40664;&#35748;&#20351;&#29992;gbk&#32534;&#30721;&#35835;&#21462;.</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">newline='' &#34920;&#31034;&#19981;&#20250;&#33258;&#21160;&#36716;&#25442;&#36890;&#29992;&#25442;&#34892;&#31526;&#65292;&#24120;&#35265;&#25442;&#34892;&#31526;&#37117;&#21487;&#20197;&#35748;&#20026;&#26159;&#25442;&#34892;</span>
    <span style="color: #a0522d;">reader</span> = csv.reader(f)
    <span style="color: #a0522d;">first</span> = <span style="color: #483d8b;">next</span>(reader) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23383;&#27573;&#20998;&#24320;&#65292;&#36820;&#22238;&#21015;&#34920;&#65292;&#27599;&#19968;&#20010;&#23383;&#27573;&#39033;</span>
    <span style="color: #483d8b;">print</span>(first)
    <span style="color: #a0522d;">second</span> = <span style="color: #483d8b;">next</span>(reader)
    <span style="color: #483d8b;">print</span>(second)
    <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'-'</span> * 30)
    <span style="color: #a020f0;">for</span> line <span style="color: #a020f0;">in</span> reader:
        <span style="color: #483d8b;">print</span>(line)
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35835;&#22238;&#26469;&#30340;&#37117;&#26159;&#23383;&#31526;&#20018;&#65292;&#31867;&#22411;&#27809;&#26377;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['id', 'name', 'age']</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['0', '1', '2']</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">------------------------------</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['a', 'b', 'c', 'd', 'e', 'f', 'g']</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['1', 'tom', '20']</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['(1,)', '(2,)']</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['[1]', '[2]']</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:786d3af1-a1f7-4029-9d4d-34b1cc480cdd" class="outline-4">
<h4 id="h:786d3af1-a1f7-4029-9d4d-34b1cc480cdd">ini文件处理</h4>
<div class="outline-text-4" id="text-h:786d3af1-a1f7-4029-9d4d-34b1cc480cdd">
<p>
作为配置文件，ini文件的格式很流畅
</p>

<pre class="example" id="org36f5124">
[DEFAULT]
a = test

[mysql]
default-character-set=utf8

[mysqld]
datadir =/dbserver/data
port = 33060
character-set-server=utf8
sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES
</pre>

<ul class="org-ul">
<li>中括号里面的部分称为section，译作节、区、段</li>
<li>每一个section内，都是key=value形成的键值对，key称为option选项</li>
<li>注意这里的DEFAULT是缺省section的名字，必须大写</li>
</ul>
</div>
<div id="outline-container-h:eefcbbc9-cc7f-42f3-8390-694eabd1ce25" class="outline-5">
<h5 id="h:eefcbbc9-cc7f-42f3-8390-694eabd1ce25">configparser</h5>
<div class="outline-text-5" id="text-h:eefcbbc9-cc7f-42f3-8390-694eabd1ce25">
<ul class="org-ul">
<li>configparser模块的ConfigParser类就是用来操作</li>
<li>可以将section当做key，section存储着键值对组成的字典，可以把ini配置文件当做一个嵌套的字典。默认使用的是有序字典</li>
</ul>

<pre class="example" id="orgc5fdd26">
read(filenames, encoding=None)
- 读取ini文件，可以是单个文件，也可以是文件列表。可以指定文件编码

sections()
- 返回section列表。缺省section不包括在内

add_section(section_name)
- 增加一个section

has_section(section, option)
- 判断seciton是否存在

options(section)
- 返回section的所有option，会追加缺省section的option

has_option(section, option)
- 判断section是否存在这个option

get(section, option, *, raw=False, vars=None[, fallback])
- 从指定的段的选项上取值，如果找到返回，如果没有找到就去找DEFAULT段有没有

getint(section, option, *, raw=False, vars=None[, fallback])
getfloat(section, option, *, raw=False,vars=None[, fallback])
getboolean(section, option, *, raw=False,vars=None[, fallback])
上面3个方法和get一样，返回指定类型数据

items(raw=False, vars=None)

items(section, raw=Fale, vars=None)
- 没有section，则返回所有section名字及其对象；如果指定section，则返回这个指定的seciton的键值对组成而元组

set(section, option, value)
- section存在的情况下，写入option=value，要求option、value必须是字符串

remove_section(section)
- 移除seciton及其所有option

remove_option(section, option)
- 移除section下的option

write(fileobject, space_aroud_delimiters=True)
- 将当前config的所有内容写入fileobject中，一般open函数使用w模式
</pre>

<p>
范例：读取
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> configparser <span style="color: #b22222;">#</span><span style="color: #b22222;">&#37197;&#32622;&#25991;&#20214;&#35299;&#26512;&#22120; ini</span>

<span style="color: #a0522d;">cfg</span> = configparser.ConfigParser()
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#37197;&#32622;&#25991;&#20214;&#35299;&#26512;&#22120;&#23545;&#35937;</span>
<span style="color: #483d8b;">print</span>(cfg) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;configparser.ConfigParser object at 0x0000014E8B2056A0&gt;</span>
<span style="color: #a0522d;">r</span> = cfg.read(<span style="color: #8b2252;">'mysql.ini'</span>)
<span style="color: #b22222;">#</span><span style="color: #b22222;">r = cfg.read(('mysql.ini', 'mysql.ini'))</span>
<span style="color: #483d8b;">print</span>(r) <span style="color: #b22222;">#</span><span style="color: #b22222;">['mysql.ini']</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35835;&#21462;section</span>
<span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> cfg.sections(): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;&#30340;&#26159;&#25152;&#26377;section&#65292;&#20294;&#19981;&#21253;&#21547;&#29305;&#27530;&#30340;&#32570;&#30465;section</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(x), x)
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'str'&gt; mysql</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'str'&gt; mysqld</span>
    <span style="color: #483d8b;">print</span>(cfg.options(x)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#27599;&#20010;section&#19979;&#30340;options&#65292;&#21253;&#21547;&#32570;&#30465;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['default-character-set', 'a']</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">['datadir', 'port', 'character-set-server', 'sql_mode', 'a']</span>

<span style="color: #483d8b;">print</span>(cfg.items()) <span style="color: #b22222;">#</span><span style="color: #b22222;">ItemsView(&lt;configparser.ConfigParser object at 0x000002D346FE56A0&gt;)</span>
<span style="color: #a020f0;">for</span> y <span style="color: #a020f0;">in</span> cfg.items(): <span style="color: #b22222;">#</span><span style="color: #b22222;">items() &#36845;&#20195;&#26102;&#65292;&#21253;&#21547;&#20102;DEFAULT</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(y), y)
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'tuple'&gt; ('DEFAULT', &lt;Section: DEFAULT&gt;)</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'tuple'&gt; ('mysql', &lt;Section: mysql&gt;)</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'tuple'&gt; ('mysqld', &lt;Section: mysqld&gt;)</span>
<span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'-'</span> * 30)
<span style="color: #a020f0;">for</span> k,v <span style="color: #a020f0;">in</span> cfg.items(): <span style="color: #b22222;">#</span><span style="color: #b22222;">items() &#36845;&#20195;&#26102;&#65292;&#21253;&#21547;&#20102;DEFAULT</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(k), k) <span style="color: #b22222;">#</span><span style="color: #b22222;">k str</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(v), v) <span style="color: #b22222;">#</span><span style="color: #b22222;">v section&#23545;&#35937;</span>
    <span style="color: #483d8b;">print</span>(cfg.items(k)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20108;&#20803;&#32452;&#21487;&#36845;&#20195;&#23545;&#35937;&#65292;</span>
    <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'+'</span> * 30)
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'str'&gt; DEFAULT</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'configparser.SectionProxy'&gt; &lt;Section: DEFAULT&gt;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">[('a', 'test')]</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">++++++++++++++++++++++++++++++</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'str'&gt; mysql</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'configparser.SectionProxy'&gt; &lt;Section: mysql&gt;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">[('a', 'test'), ('default-character-set', 'utf8')]</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">++++++++++++++++++++++++++++++</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'str'&gt; mysqld</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'configparser.SectionProxy'&gt; &lt;Section: mysqld&gt;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">[('a', 'test'), ('datadir', '/dbserver/data'), ('port', '33060'), ('character-set-server', 'utf8'), ('sql_mode', 'NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES')]</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">++++++++++++++++++++++++++++++</span>

<span style="color: #483d8b;">print</span>(cfg.has_option(<span style="color: #8b2252;">'mysqld'</span>, <span style="color: #8b2252;">'a'</span>))  <span style="color: #b22222;">#</span><span style="color: #b22222;">mysql&#19979;&#26377;&#27809;&#26377;a&#65311; &#26377; &#36820;&#22238;True</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21462;&#20540;</span>
<span style="color: #a0522d;">t</span> = cfg.get(<span style="color: #8b2252;">'mysqld'</span>, <span style="color: #8b2252;">'a'</span>)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(t), t) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'str'&gt; test</span>
<span style="color: #a0522d;">t</span> = cfg.get(<span style="color: #8b2252;">'mysqld'</span>, <span style="color: #8b2252;">'port'</span>, fallback=[]) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22914;&#26524;&#27809;&#26377;&#20540;&#65292;&#36820;&#22238;fallback&#30340;&#20540;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(t), t) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'str'&gt; 33060</span>
<span style="color: #a0522d;">t</span> = cfg.getint(<span style="color: #8b2252;">'mysqld'</span>, <span style="color: #8b2252;">'port'</span>, fallback=3306) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#31867;&#22411;&#36716;&#25442;&#65292; int(get()) &#22914;&#26524;&#27809;&#26377;&#20540;&#65292;&#36820;&#22238;fallback&#30340;&#20540;.</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(t), t) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'int'&gt; 33060</span>
</pre>
</div>

<p>
范例：写入
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> configparser <span style="color: #b22222;">#</span><span style="color: #b22222;">&#37197;&#32622;&#25991;&#20214;&#35299;&#26512;&#22120; ini</span>

<span style="color: #a0522d;">cfg</span> = configparser.ConfigParser()
<span style="color: #b22222;"># </span><span style="color: #b22222;">&#37197;&#32622;&#25991;&#20214;&#35299;&#26512;&#22120;&#23545;&#35937;</span>
<span style="color: #483d8b;">print</span>(cfg) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;configparser.ConfigParser object at 0x0000014E8B2056A0&gt;</span>
<span style="color: #a0522d;">r</span> = cfg.read(<span style="color: #8b2252;">'mysql.ini'</span>)
<span style="color: #b22222;">#</span><span style="color: #b22222;">r = cfg.read(('mysql.ini', 'mysql.ini'))</span>
<span style="color: #483d8b;">print</span>(r) <span style="color: #b22222;">#</span><span style="color: #b22222;">['mysql.ini']</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20889;&#20837;</span>
cfg.<span style="color: #483d8b;">set</span>(<span style="color: #8b2252;">'mysqld'</span>, <span style="color: #8b2252;">'a'</span>, <span style="color: #8b2252;">'100'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#22312;&#20869;&#23384;&#20013;&#25805;&#20316;&#12290; &#35774;&#32622;mysqld&#19978;a&#30340;&#20540;&#20026;100</span>
<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'t.ini'</span>, <span style="color: #8b2252;">'w'</span>, encoding=<span style="color: #8b2252;">'utf-8'</span>) <span style="color: #a020f0;">as</span> f:
    cfg.write(f)

<span style="color: #a020f0;">if</span> cfg.has_section(<span style="color: #8b2252;">'test'</span>):
    cfg.remove_section(<span style="color: #8b2252;">'test'</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26412;section&#25152;&#26377;options&#20840;&#37096;&#21024;&#38500;</span>

cfg.add_section(<span style="color: #8b2252;">'test'</span>)
<span style="color: #483d8b;">print</span>(cfg[<span style="color: #8b2252;">'mysql'</span>]) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;Section: mysql&gt;</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23383;&#20856;&#25805;&#20316;&#26356;&#31616;&#21333;</span>
cfg[<span style="color: #8b2252;">'test'</span>][<span style="color: #8b2252;">'t1'</span>] = <span style="color: #8b2252;">'1000'</span>
cfg[<span style="color: #8b2252;">'test'</span>][<span style="color: #8b2252;">'t2'</span>] = <span style="color: #483d8b;">str</span>([1,2,3])
<span style="color: #a0522d;">t</span> = cfg[<span style="color: #8b2252;">'test'</span>][<span style="color: #8b2252;">'t2'</span>]
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(t), t) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'str'&gt; [1, 2, 3]</span>
<span style="color: #483d8b;">print</span>(cfg.get(<span style="color: #8b2252;">'test'</span>, <span style="color: #8b2252;">'t2'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">[1, 2, 3]</span>

<span style="color: #a0522d;">cfg</span>[<span style="color: #8b2252;">'test'</span>] = {<span style="color: #8b2252;">'t3'</span>: <span style="color: #8b2252;">'abc'</span>} <span style="color: #b22222;">#</span><span style="color: #b22222;">section&#23384;&#22312;&#65292;&#30452;&#25509;&#35206;&#30422;test&#20013;&#30340;&#20869;&#23481;</span>
<span style="color: #483d8b;">print</span>(cfg.options(<span style="color: #8b2252;">'test'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">['t3', 'a']</span>
<span style="color: #a0522d;">cfg</span>[<span style="color: #8b2252;">'test2'</span>] = {<span style="color: #8b2252;">'y'</span>: <span style="color: #8b2252;">'1000'</span>} <span style="color: #b22222;">#</span><span style="color: #b22222;">section&#19981;&#23384;&#22312;</span>
<span style="color: #483d8b;">print</span>(cfg.options(<span style="color: #8b2252;">'test2'</span>)) <span style="color: #b22222;">#</span><span style="color: #b22222;">['y', 'a']</span>

<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'t.ini'</span>, <span style="color: #8b2252;">'w'</span>, encoding=<span style="color: #8b2252;">'utf-8'</span>) <span style="color: #a020f0;">as</span> f:
    cfg.write(f)

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20854;&#20182;</span>
<span style="color: #483d8b;">print</span>(cfg._sections)
<span style="color: #b22222;">#</span><span style="color: #b22222;">{'mysql': {'default-character-set': 'utf8'}, 'mysqld': {'datadir': '/dbserver/data', 'port': '33060', 'character-set-server': 'utf8', 'sql_mode': 'NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES', 'a': '100'}, 'test': {'t3': 'abc'}}</span>
<span style="color: #a020f0;">for</span> k,v <span style="color: #a020f0;">in</span> cfg._sections.items():
    <span style="color: #483d8b;">print</span>(k,v)
<span style="color: #b22222;"># </span><span style="color: #b22222;">mysql {'default-character-set': 'utf8'}</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">mysqld {'datadir': '/dbserver/data', 'port': '33060', 'character-set-server': 'utf8', 'sql_mode': 'NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES', 'a': '100'}</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">test {'t3': 'abc'}</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="outline-container-h:7796246a-59e6-4851-9a51-04b809496f18" class="outline-2">
<h2 id="h:7796246a-59e6-4851-9a51-04b809496f18">序列化和反序列化</h2>
<div class="outline-text-2" id="text-h:7796246a-59e6-4851-9a51-04b809496f18">
<p>
主要内容：
</p>
<ul class="org-ul">
<li>序列化、反序列化重要性</li>
<li>Python 序列化库 Pickle</li>
<li>文本序列化方案 Json</li>
<li>高效二进制序列化库 Msgpack</li>
<li>常用序列化方案比较和适用场景</li>
</ul>
</div>
<div id="outline-container-h:81322cb8-0372-4f87-a43a-4b4f3c0867d5" class="outline-3">
<h3 id="h:81322cb8-0372-4f87-a43a-4b4f3c0867d5">为什么要序列化</h3>
<div class="outline-text-3" id="text-h:81322cb8-0372-4f87-a43a-4b4f3c0867d5">
<ul class="org-ul">
<li>内存中的字典、列表、集合以及各种对象，如何保存到一个文件中？</li>
<li>如果是自己定义的类的实例，如何保存到一个文件中？</li>
<li>如何从文件中读取数据，并让他们在内存中再次恢复成自己对应的类的实例？</li>
</ul>

<p>
要设一套 <b>协议</b> ，就按照某种规则，把内存中数据保存到文件中。文件是一个字节序列，所以必须把数据转换成字节序列，输出到文件。这就是 <b>序列化</b> 。
</p>

<p>
反之，把文件的字节序列恢复到内存并且还是原来的类型，就是 <b>反序列化</b>
</p>
</div>
</div>
<div id="outline-container-h:7389e4e0-f18e-4c20-b60b-8d21acd2037d" class="outline-3">
<h3 id="h:7389e4e0-f18e-4c20-b60b-8d21acd2037d">定义</h3>
<div class="outline-text-3" id="text-h:7389e4e0-f18e-4c20-b60b-8d21acd2037d">
<p>
serialization 序列化
</p>
<ul class="org-ul">
<li>将内存中对象存储下来，把它变成一个个字节 -&gt;二进制</li>
</ul>

<p>
deserialization 反序列化
</p>
<ul class="org-ul">
<li>将文件的一个个字节恢复成内存中对象 -&gt; 二进制</li>
</ul>

<p>
序列化保存到文件就是持久化
</p>
<ul class="org-ul">
<li>可以将数据序列化后持久化，或者网络传输；也可以将文件中或者网络接收到的字节序列反序列化</li>
</ul>

<p>
Python提供了pickle库
</p>
</div>
</div>
<div id="outline-container-h:603687a4-ba36-423a-bb8c-dd538a50281f" class="outline-3">
<h3 id="h:603687a4-ba36-423a-bb8c-dd538a50281f">pickle库</h3>
<div class="outline-text-3" id="text-h:603687a4-ba36-423a-bb8c-dd538a50281f">
<p>
Python中的序列化、反序列化模块
</p>

<p>
对应函数
</p>
<pre class="example" id="orgbf48f1e">
dumps  对象序列化为bytes对象
dump   对象序列化到文件对象，就是存入文件
loads  从bytes对象反序列化
load   对象反序列化，从文件读取数据
</pre>

<p>
范例：序列化、反序列化
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;">#</span><span style="color: #b22222;">&#29702;&#35299;&#20108;&#36827;&#21046;</span>
<span style="color: #a020f0;">import</span> pickle
<span style="color: #a020f0;">from</span> pathlib <span style="color: #a020f0;">import</span> Path

<span style="color: #a0522d;">filename</span> = <span style="color: #8b2252;">'d:/tmp/mydir/ser.bin'</span>

Path(filename).parent.mkdir(parents=<span style="color: #008b8b;">True</span>,exist_ok=<span style="color: #008b8b;">True</span>)

<span style="color: #a0522d;">i</span> = 99 <span style="color: #b22222;">#</span><span style="color: #b22222;">int</span>
<span style="color: #a0522d;">c</span> = <span style="color: #8b2252;">'c'</span> <span style="color: #b22222;">#</span><span style="color: #b22222;">str</span>
<span style="color: #a0522d;">l</span> = <span style="color: #483d8b;">list</span>(<span style="color: #483d8b;">range</span>(1,4))
<span style="color: #a0522d;">d</span> = {<span style="color: #8b2252;">'a'</span>: 1, <span style="color: #8b2252;">'b'</span>: <span style="color: #8b2252;">'abc'</span>, <span style="color: #8b2252;">'c'</span>:[1,2,3]}

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#20889;&#20837;&#65292;&#24207;&#21015;&#21270;</span>
<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(filename, <span style="color: #8b2252;">'wb'</span>) <span style="color: #a020f0;">as</span> f:
    pickle.dump(i, f) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#24207;&#21015;&#21270; 99&#30340;16&#36827;&#21046; 0x63 , &#20108;&#36827;&#21046;&#25991;&#20214;&#30340;&#34920;&#29616;&#65292;80 04 int 63 &#36793;&#30028;2e</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;"># hexdump.exe -C ser.bin</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000000  80 04 4b 63 2e                                    |..Kc.|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000005</span>
    pickle.dump(c, f) <span style="color: #b22222;">#</span><span style="color: #b22222;">c 0x8004 str 0x63 &#36793;&#30028;\x2e</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;"># hexdump.exe -C ser.bin</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000000  80 04 4b 63 2e 80 04 95  05 00 00 00 00 00 00 00  |..Kc............|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000010  8c 01 63 94 2e                                    |..c..|</span>
    pickle.dump(l, f) <span style="color: #b22222;">#</span><span style="color: #b22222;">l 0x8004 list 0x4b01 0x4b02 0x4b03 &#36793;&#30028;\x2e</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;"># hexdump.exe -C ser.bin</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000000  80 04 4b 63 2e 80 04 95  05 00 00 00 00 00 00 00  |..Kc............|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000010  8c 01 63 94 2e 80 04 95  0b 00 00 00 00 00 00 00  |..c.............|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000020  5d 94 28 4b 01 4b 02 4b  03 65 2e                 |].(K.K.K.e.|</span>
    pickle.dump(d, f) <span style="color: #b22222;">#</span><span style="color: #b22222;">d 0x8004 dict xx &#36793;&#30028;\x2e</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;"># hexdump.exe -C ser.bin</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000000  80 04 4b 63 2e 80 04 95  05 00 00 00 00 00 00 00  |..Kc............|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000010  8c 01 63 94 2e 80 04 95  0b 00 00 00 00 00 00 00  |..c.............|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000020  5d 94 28 4b 01 4b 02 4b  03 65 2e 80 04 95 23 00  |].(K.K.K.e....#.|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000030  00 00 00 00 00 00 7d 94  28 8c 01 61 94 4b 01 8c  |......}.(..a.K..|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000040  01 62 94 8c 03 61 62 63  94 8c 01 63 94 5d 94 28  |.b...abc...c.].(|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000050  4b 01 4b 02 4b 03 65 75  2e                       |K.K.K.eu.|</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#35835;&#21462;&#65292;&#21453;&#24207;&#21015;&#21270;</span>
<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(filename, <span style="color: #8b2252;">'rb'</span>) <span style="color: #a020f0;">as</span> f:
    <span style="color: #a020f0;">for</span> i <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">range</span>(4):
        <span style="color: #a0522d;">t</span> = pickle.load(f)
        <span style="color: #483d8b;">print</span>(i+1, <span style="color: #483d8b;">type</span>(t), t)
<span style="color: #b22222;"># </span><span style="color: #b22222;">1 &lt;class 'int'&gt; 99</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">2 &lt;class 'str'&gt; c</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">3 &lt;class 'list'&gt; [1, 2, 3]</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">4 &lt;class 'dict'&gt; {'a': 1, 'b': 'abc', 'c': [1, 2, 3]}</span>
</pre>
</div>

<p>
可以看到二进制的序列化文件中，每一个数据最重要的，为了保存数据并在以后可以还原它，至少需要保存数据的 <code>类型 数据 边界</code> 。
</p>

<p>
对象序列化
</p>

<div class="org-src-container">
<pre class="src src-python">
<span style="color: #a020f0;">import</span> pickle

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#31867;</span>
<span style="color: #a020f0;">class</span> <span style="color: #228b22;">AAA</span>:
    <span style="color: #a0522d;">tttt</span> = <span style="color: #8b2252;">'ABC'</span>  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#31867;&#23646;&#24615;</span>
    <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">__init__</span>(<span style="color: #a020f0;">self</span>): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#21021;&#22987;&#21270;&#26041;&#27861;</span>
        <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'init~~~~~'</span>)
        <span style="color: #a020f0;">self</span>.<span style="color: #a0522d;">cccc</span> = <span style="color: #8b2252;">'AABBCC'</span> <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23454;&#20363;&#30340;&#23646;&#24615;&#65292;&#27599;&#19968;&#20010;&#23454;&#20363;&#37117;&#19981;&#21516;</span>
    <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">show</span>(<span style="color: #a020f0;">self</span>): <span style="color: #b22222;">#</span><span style="color: #b22222;">def &#26041;&#27861;</span>
        <span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'aabbcc'</span>)

<span style="color: #a0522d;">a1</span> = AAA()  <span style="color: #b22222;">#</span><span style="color: #b22222;">&#23454;&#20363;&#21270;&#65292;&#20250;&#35843;&#29992;__init__</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#24207;&#21015;&#21270;</span>
<span style="color: #a0522d;">ser</span> = pickle.dumps(a1)
<span style="color: #483d8b;">print</span>(<span style="color: #8b2252;">'ser={}'</span>.<span style="color: #483d8b;">format</span>(ser))
<span style="color: #b22222;"># </span><span style="color: #b22222;">ser=b'\x80\x04\x95+\x00\x00\x00\x00\x00\x00\x00\x8c\x08__main__\x94\x8c\x03AAA\x94\x93\x94)\x81\x94}\x94\x8c\x04cccc\x94\x8c\x06AABBCC\x94sb.'</span>

<span style="color: #a020f0;">with</span> <span style="color: #483d8b;">open</span>(<span style="color: #8b2252;">'d:/tmp/mydir/ser'</span>, <span style="color: #8b2252;">'wb'</span>) <span style="color: #a020f0;">as</span> f:
    f.write(ser)
<span style="color: #b22222;"># </span><span style="color: #b22222;"># hexdump.exe -C ser</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000000  80 04 95 2b 00 00 00 00  00 00 00 8c 08 5f 5f 6d  |...+.........__m|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000010  61 69 6e 5f 5f 94 8c 03  41 41 41 94 93 94 29 81  |ain__...AAA...).|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000020  94 7d 94 8c 04 63 63 63  63 94 8c 06 41 41 42 42  |.}...cccc...AABB|</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">00000030  43 43 94 73 62 2e                                 |CC.sb.|</span>


<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21453;&#24207;&#21015;&#21270;</span>
<span style="color: #a0522d;">obj</span> = pickle.loads(ser)
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(obj)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#36820;&#22238;&#30340;&#26159;&#31867;&#22411;&#21517; AAA &lt;class '__main__.AAA'&gt;</span>
<span style="color: #483d8b;">print</span>(obj) <span style="color: #b22222;">#</span><span style="color: #b22222;">AAA object&#23545;&#35937;&#23454;&#20363;&#65292;&#22312;&#20869;&#23384;&#20013;&#30340;&#20301;&#32622; &lt;__main__.AAA object at 0x0000019E2D687D90&gt;</span>
<span style="color: #483d8b;">print</span>(obj.tttt) <span style="color: #b22222;">#</span><span style="color: #b22222;">ABC</span>
obj.show() <span style="color: #b22222;">#</span><span style="color: #b22222;">aabbcc</span>
<span style="color: #483d8b;">print</span>(obj.cccc) <span style="color: #b22222;">#</span><span style="color: #b22222;">AABBCC</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#24207;&#21015;&#21270;&#20043;&#21518;&#65292;&#21453;&#24207;&#21015;&#21270;&#30340;&#26102;&#20505;&#20351;&#29992;&#21516;&#26679;&#30340;&#23450;&#20041;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">list&#23454;&#20363;&#65292;&#21453;&#24207;&#21015;&#21270;&#26102;&#19981;&#20250;&#26377;&#36825;&#26679;&#30340;&#29616;&#35937;&#65292;</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">&#22240;&#20026;&#20320;&#26681;&#26412;&#19981;&#20250;&#20351;&#29992;&#33258;&#23450;&#20041;&#30340;list&#65292;&#29992;&#30340;&#36824;&#26159;python&#30340;list</span>
</pre>
</div>

<p>
上面的例子中，故意使用了连续的AAA、ABC、abc等字符串，就是为了在二进制文件中能容易的发现它们
上例中，其实就保存了一个类名，因为所有的其他东西都是类定义的东西，是不变的，所以只序列化一个AAA类名。反序列化的时候找到类就可以恢复一个对象
</p>

<p>
可以看出这回除了必须保存的AAA，还序列化了aaaa和abc，因为这是每一个对象自己的属性，每一个对象不一样的，所以这些数据需要序列化
</p>
</div>
<div id="outline-container-h:2346b2ba-36d0-4d8b-a1f2-1c2b1975b65c" class="outline-4">
<h4 id="h:2346b2ba-36d0-4d8b-a1f2-1c2b1975b65c">序列化、反序列化实验</h4>
<div class="outline-text-4" id="text-h:2346b2ba-36d0-4d8b-a1f2-1c2b1975b65c">
<p>
序列化的类定义和反序列化的类定义可能是不一致的。
</p>

<p>
因为反序列化时会找当前代码中的类名。有则使用当前类。
</p>

<p>
因此，序列化、反序列化必须保证使用同一套类的定义，否则会带来不可预料的结果
</p>
</div>
</div>
</div>
<div id="outline-container-h:bee0b6d6-5fad-4ad5-845b-8b77dc251f21" class="outline-3">
<h3 id="h:bee0b6d6-5fad-4ad5-845b-8b77dc251f21">序列化应用</h3>
<div class="outline-text-3" id="text-h:bee0b6d6-5fad-4ad5-845b-8b77dc251f21">
<p>
一般来说，本地序列化的情况，应用较少。大多数场景都应用在网络传输中。
</p>

<p>
将数据序列化后通过网络传输到远程节点，远程服务器上的服务将接受到的数据反序列化后，就可以使用了
</p>

<p>
但是需要注意，远程接受端，反序列化时必须有对应的数据类型，否则就会报错。尤其是自定义类，必须远程得有一致的定义
</p>

<p>
现在，大多数项目，都不是单机的，也不是单服务的，需要多个程序之间配合。需要通过网络将数据传送到其他节点上去，这就需要大量的序列化、反序列化过程
</p>

<p>
但是，问题是，Python程序之间还可以都用pickle解决序列化、反序列化，如果是跨平台、跨语言、跨协议。pickle就不太适合，需要公共的协议。例如XML、Json、Protocol Buffer等
</p>

<p>
不同的协议，效率不同，适用不同的场景，根据不同的情况分析选型
</p>
</div>
</div>
<div id="outline-container-h:ec4b901e-9ca3-4ea3-bb80-2f639abde5b2" class="outline-3">
<h3 id="h:ec4b901e-9ca3-4ea3-bb80-2f639abde5b2">Json</h3>
<div class="outline-text-3" id="text-h:ec4b901e-9ca3-4ea3-bb80-2f639abde5b2">
<p>
Json(JavaScript Object Notation,JS 对象标记)是一种轻量级的数据交换格式。它基于 ECMAScript(w3c组织制定的JS规范)的一个子集，采用完全独立于变成语言的文本格式来存储和表示数据
</p>

<p>
Json官网：<a href="http://json.org/">http://json.org/</a>
</p>
</div>
<div id="outline-container-h:f3304d95-9245-4304-bc90-ac8621dcf2f4" class="outline-4">
<h4 id="h:f3304d95-9245-4304-bc90-ac8621dcf2f4">Json是数据类型</h4>
<div class="outline-text-4" id="text-h:f3304d95-9245-4304-bc90-ac8621dcf2f4">
</div>
<div id="outline-container-h:dcc98bdd-085d-48bf-9de7-4c2a5c873e1f" class="outline-5">
<h5 id="h:dcc98bdd-085d-48bf-9de7-4c2a5c873e1f">值</h5>
<div class="outline-text-5" id="text-h:dcc98bdd-085d-48bf-9de7-4c2a5c873e1f">
<p>
双引号引起来的字符串，数值，true和false，null，对象，数组。这些都是值
</p>


<figure id="org9bf14c0">
<img src="https://www.json.org/img/value.png" alt="value.png" width="50%">

</figure>
</div>
</div>
<div id="outline-container-h:02c06260-2621-4444-8ca1-720fb6286571" class="outline-5">
<h5 id="h:02c06260-2621-4444-8ca1-720fb6286571">字符串</h5>
<div class="outline-text-5" id="text-h:02c06260-2621-4444-8ca1-720fb6286571">
<p>
由双引号包围起来的任意字符的组合，可以有转义字符
</p>
</div>
</div>
<div id="outline-container-h:46612e5e-7855-4766-b2d9-e96b4f01cb9a" class="outline-5">
<h5 id="h:46612e5e-7855-4766-b2d9-e96b4f01cb9a">数值</h5>
<div class="outline-text-5" id="text-h:46612e5e-7855-4766-b2d9-e96b4f01cb9a">
<p>
有正负，有整数、浮点数
</p>
</div>
</div>
<div id="outline-container-h:f8b0d664-dabf-413c-ad6c-4c311c0cd4dc" class="outline-5">
<h5 id="h:f8b0d664-dabf-413c-ad6c-4c311c0cd4dc">对象</h5>
<div class="outline-text-5" id="text-h:f8b0d664-dabf-413c-ad6c-4c311c0cd4dc">
<p>
无序的键值对的集合
</p>

<p>
格式：{key1:value1,…,keyn:valuen}
</p>

<p>
key必须是一个字符串，需要双引号包围这个字符串
</p>

<p>
value可以是任意合法的值
</p>


<figure id="org07f8050">
<img src="https://www.json.org/img/object.png" alt="object.png" width="50%">

</figure>
</div>
</div>
<div id="outline-container-h:1636219b-b552-45ac-ba72-beaa961db963" class="outline-5">
<h5 id="h:1636219b-b552-45ac-ba72-beaa961db963">数组</h5>
<div class="outline-text-5" id="text-h:1636219b-b552-45ac-ba72-beaa961db963">
<p>
有序的值的集合
</p>

<p>
格式：[val1,…,valn]
</p>


<figure id="org7d60fc5">
<img src="https://www.json.org/img/array.png" alt="array.png" width="50%">

</figure>


<p>
范例
</p>
<div class="org-src-container">
<pre class="src src-sh">{
    <span style="color: #8b2252;">"person"</span>:[
        {
            <span style="color: #8b2252;">"name"</span>: <span style="color: #8b2252;">"tom"</span>,
            <span style="color: #8b2252;">"age"</span>: 18
        },
        {
            <span style="color: #8b2252;">"name"</span>: <span style="color: #8b2252;">"jerry"</span>,
            <span style="color: #8b2252;">"age"</span>: 16
        }
    ],
    <span style="color: #8b2252;">"total"</span>: 2
}      
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:fd36de02-62bb-476a-a25b-50729ec7add4" class="outline-4">
<h4 id="h:fd36de02-62bb-476a-a25b-50729ec7add4">Json 模块</h4>
<div class="outline-text-4" id="text-h:fd36de02-62bb-476a-a25b-50729ec7add4">
</div>
<div id="outline-container-h:e88465b8-94e3-4c1f-8339-bbf11b03ee4a" class="outline-5">
<h5 id="h:e88465b8-94e3-4c1f-8339-bbf11b03ee4a">Python 与 Json</h5>
<div class="outline-text-5" id="text-h:e88465b8-94e3-4c1f-8339-bbf11b03ee4a">
<p>
Python支持少量内建数据类型到Json类型的转换
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Python类型</th>
<th scope="col" class="org-left">Json类型</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">True</td>
<td class="org-left">true</td>
</tr>

<tr>
<td class="org-left">False</td>
<td class="org-left">false</td>
</tr>

<tr>
<td class="org-left">None</td>
<td class="org-left">null</td>
</tr>

<tr>
<td class="org-left">str</td>
<td class="org-left">string</td>
</tr>

<tr>
<td class="org-left">int</td>
<td class="org-left">integer</td>
</tr>

<tr>
<td class="org-left">float</td>
<td class="org-left">float</td>
</tr>

<tr>
<td class="org-left">list</td>
<td class="org-left">array</td>
</tr>

<tr>
<td class="org-left">dict</td>
<td class="org-left">object</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-h:435cf8e1-6584-4e6b-9687-b67f7bd73c4d" class="outline-5">
<h5 id="h:435cf8e1-6584-4e6b-9687-b67f7bd73c4d">常用方法</h5>
<div class="outline-text-5" id="text-h:435cf8e1-6584-4e6b-9687-b67f7bd73c4d">
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Python类型</th>
<th scope="col" class="org-left">Json类型</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">dumps</td>
<td class="org-left">json编码</td>
</tr>

<tr>
<td class="org-left">dump</td>
<td class="org-left">json编码并存入文件</td>
</tr>

<tr>
<td class="org-left">loads</td>
<td class="org-left">json编码</td>
</tr>

<tr>
<td class="org-left">load</td>
<td class="org-left">json编码，从文件读取数据</td>
</tr>
</tbody>
</table>

<p>
范例：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> json

<span style="color: #a0522d;">d</span> = {
    <span style="color: #8b2252;">'name'</span>:<span style="color: #8b2252;">'Tom'</span>,
    <span style="color: #8b2252;">'age'</span>:20,
    <span style="color: #8b2252;">'insterest'</span>:(<span style="color: #8b2252;">'movie'</span>, <span style="color: #8b2252;">'music'</span>),  <span style="color: #b22222;"># </span><span style="color: #b22222;">?</span>
    <span style="color: #8b2252;">'class'</span>:[<span style="color: #8b2252;">'python'</span>] <span style="color: #b22222;">#</span><span style="color: #b22222;">array</span>
} <span style="color: #b22222;">#</span><span style="color: #b22222;">dict =&gt; object</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#24207;&#21015;&#21270;json</span>
<span style="color: #a0522d;">s</span> = json.dumps(d)  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36716;&#25104;&#23383;&#31526;&#24207;&#21015;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(s), <span style="color: #483d8b;">len</span>(s)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'str'&gt; 80</span>
<span style="color: #483d8b;">print</span>(s) <span style="color: #b22222;">#</span><span style="color: #b22222;">{"name": "Tom", "age": 20, "insterest": ["movie", "music"], "class": ["python"]}</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21453;&#24207;&#21015;&#21270;json</span>
<span style="color: #a0522d;">new</span> = json.loads(s) <span style="color: #b22222;"># </span><span style="color: #b22222;">str =&gt; dict &#23454;&#38469;&#19978;&#26159; js:object =&gt; dict</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(new)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'dict'&gt;</span>
<span style="color: #483d8b;">print</span>(new) <span style="color: #b22222;">#</span><span style="color: #b22222;">{'name': 'Tom', 'age': 20, 'insterest': ['movie', 'music'], 'class': ['python']}</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#23613;&#37327;&#20889;&#25104;js&#25903;&#25345;&#30340;&#31867;&#22411;</span>
<span style="color: #a0522d;">d</span> = {
    <span style="color: #8b2252;">'name'</span>:<span style="color: #8b2252;">'Tom'</span>,
    <span style="color: #8b2252;">'age'</span>:20,
    <span style="color: #8b2252;">'insterest'</span>:[<span style="color: #8b2252;">'movie'</span>, <span style="color: #8b2252;">'music'</span>],
    <span style="color: #8b2252;">'class'</span>:[<span style="color: #8b2252;">'python'</span>] <span style="color: #b22222;">#</span><span style="color: #b22222;">array</span>
} <span style="color: #b22222;">#</span><span style="color: #b22222;">dict =&gt; object</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#24207;&#21015;&#21270;json</span>
<span style="color: #a0522d;">s</span> = json.dumps(d)  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#36716;&#25104;&#23383;&#31526;&#24207;&#21015;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(s), <span style="color: #483d8b;">len</span>(s)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'str'&gt; 80</span>
<span style="color: #483d8b;">print</span>(s) <span style="color: #b22222;">#</span><span style="color: #b22222;">{"name": "Tom", "age": 20, "insterest": ["movie", "music"], "class": ["python"]}</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21453;&#24207;&#21015;&#21270;json</span>
<span style="color: #a0522d;">new</span> = json.loads(s) <span style="color: #b22222;"># </span><span style="color: #b22222;">str =&gt; dict &#23454;&#38469;&#19978;&#26159; js:object =&gt; dict</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(new)) <span style="color: #b22222;">#</span><span style="color: #b22222;">&lt;class 'dict'&gt;</span>
<span style="color: #483d8b;">print</span>(new) <span style="color: #b22222;">#</span><span style="color: #b22222;">{'name': 'Tom', 'age': 20, 'insterest': ['movie', 'music'], 'class': ['python']}</span>


<span style="color: #483d8b;">print</span>(d == new) <span style="color: #b22222;"># </span><span style="color: #b22222;">? True &#31561;&#21495;&#20195;&#34920;&#20869;&#23481;&#26159;&#21542;&#30456;&#21516;</span>
<span style="color: #483d8b;">print</span>(d <span style="color: #a020f0;">is</span> new) <span style="color: #b22222;"># </span><span style="color: #b22222;">? False is&#20195;&#34920;&#20869;&#23384;&#20301;&#32622;&#26159;&#21542;&#30456;&#21516;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">id</span>(d), <span style="color: #483d8b;">id</span>(new)) <span style="color: #b22222;">#</span><span style="color: #b22222;">2713103083392 2713101598528</span>
</pre>
</div>

<p>
一般json编码的数据很少落地，数据都是通过网络传输。传输的时候，要考虑压缩它
</p>

<p>
本质上来说它就是个文本，就是个字符串
</p>

<p>
json很简单，几乎编程语言都支持json，所以应用范围十分广泛
</p>
</div>
</div>
</div>
<div id="outline-container-h:ba57e488-9b93-4277-96cf-442739c48bce" class="outline-4">
<h4 id="h:ba57e488-9b93-4277-96cf-442739c48bce">MessagePack</h4>
<div class="outline-text-4" id="text-h:ba57e488-9b93-4277-96cf-442739c48bce">
<p>
官网：<a href="https://msgpack.org/">https://msgpack.org/</a>
</p>

<p>
MessagePack是一个基于 <b>二进制</b> 高效的对象序列化类库，可用于跨语言通信
</p>

<p>
它可以像Json那样，在许多语言之间交换结构对象
</p>

<p>
但是它比Json更快速也更轻巧
</p>

<p>
支持Python、Ruby、Java、C/C++等众多语言。
</p>

<p>
兼容json和pickle
</p>

<p>
可以看出，大大的节约了空间
</p>

<pre class="example" id="orgc24e9c0">
# Json：27 bytes
{"person":[{"name":"tom","age":18},{"name":"jerry",."age":16}],"total":2}

# MessagePack：18 bytes
# 82 a7 63 6f 6d 70 61 63 74 c3 a6 73 63 68 65 6d 61 00

#流量就是金钱，在流量很大时就能体现出来了
</pre>
</div>
<div id="outline-container-h:d23960c5-0445-4531-8eba-1a757fd2d94f" class="outline-5">
<h5 id="h:d23960c5-0445-4531-8eba-1a757fd2d94f">安装</h5>
<div class="outline-text-5" id="text-h:d23960c5-0445-4531-8eba-1a757fd2d94f">
<div class="org-src-container">
<pre class="src src-sh">pip install msgpack
</pre>
</div>
</div>
</div>
<div id="outline-container-h:94e0d426-f344-4dee-8529-38d2437ce750" class="outline-5">
<h5 id="h:94e0d426-f344-4dee-8529-38d2437ce750">常用方法</h5>
<div class="outline-text-5" id="text-h:94e0d426-f344-4dee-8529-38d2437ce750">
<ul class="org-ul">
<li>packb 序列化对象。提供了dumps来兼容pickle和json</li>
<li>unpackb 反序列化对象。提供了loads来兼容</li>
<li>pack 序列化对象保存到文件对象。提供了dump来兼容</li>
<li>unpack 反序列化对象保存到文件对象。提供了load来兼容</li>
</ul>

<p>
MessagePack简单易用，高效压缩，支持语言丰富
所以，用它序列化也是一种很好的选择。Python很多大名鼎鼎的库都是用了msgpack
</p>

<p>
范例：对比
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> json
<span style="color: #a020f0;">import</span> pickle
<span style="color: #a020f0;">import</span> msgpack

<span style="color: #a0522d;">d</span> = {
    <span style="color: #8b2252;">'Persons'</span>:[
        {<span style="color: #8b2252;">'name'</span>:<span style="color: #8b2252;">'tom'</span>, <span style="color: #8b2252;">'age'</span>:20}, <span style="color: #b22222;">#</span><span style="color: #b22222;">dict =&gt; object</span>
        {<span style="color: #8b2252;">'name'</span>:<span style="color: #8b2252;">'jerry'</span>, <span style="color: #8b2252;">'age'</span>:18}
    ], <span style="color: #b22222;">#</span><span style="color: #b22222;">list =&gt; array</span>
    <span style="color: #8b2252;">'test'</span>:<span style="color: #8b2252;">'aaaaaa'</span>,
    <span style="color: #8b2252;">'total'</span>: 2
} <span style="color: #b22222;"># </span><span style="color: #b22222;">dict =&gt; object</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#24207;&#21015;&#21270;</span>
<span style="color: #a020f0;">for</span> i,module <span style="color: #a020f0;">in</span> <span style="color: #483d8b;">enumerate</span>((pickle, json, msgpack)): <span style="color: #b22222;">#</span><span style="color: #b22222;">&#20803;&#32452;&#65292; &#19977;&#20010;&#20803;&#32032;</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">pickle.dumps(d) #99 bytes</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">json.dumps(d) #101 bytes &#20250;&#26377;&#19968;&#20123;&#26080;&#25928;&#30340;&#31354;&#26684;</span>
    <span style="color: #b22222;"># </span><span style="color: #b22222;">msgpack.dumps(d) #61 bytes</span>
    <span style="color: #a0522d;">data</span> = module.dumps(d)
    <span style="color: #483d8b;">print</span>(module.<span style="color: #483d8b;">__name__</span>, <span style="color: #8b2252;">"len={}"</span>.<span style="color: #483d8b;">format</span>(<span style="color: #483d8b;">len</span>(data)), <span style="color: #483d8b;">type</span>(data))
    <span style="color: #483d8b;">print</span>(i, data)
<span style="color: #b22222;"># </span><span style="color: #b22222;">pickle len=99 &lt;class 'bytes'&gt;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">0 b'\x80\x04\x95X\x00\x00\x00\x00\x00\x00\x00}\x94(\x8c\x07Persons\x94]\x94(}\x94(\x8c\x04name\x94\x8c\x03tom\x94\x8c\x03age\x94K\x14u}\x94(h\x04\x8c\x05jerry\x94h\x06K\x12ue\x8c\x04test\x94\x8c\x06aaaaaa\x94\x8c\x05total\x94K\x02u.'</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">json len=101 &lt;class 'str'&gt;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">1 {"Persons": [{"name": "tom", "age": 20}, {"name": "jerry", "age": 18}], "test": "aaaaaa", "total": 2}</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">msgpack len=61 &lt;class 'bytes'&gt;</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">2 b'\x83\xa7Persons\x92\x82\xa4name\xa3tom\xa3age\x14\x82\xa4name\xa5jerry\xa3age\x12\xa4test\xa6aaaaaa\xa5total\x02'</span>

<span style="color: #b22222;">#</span><span style="color: #b22222;">&#21453;&#24207;&#21015;&#21270;</span>
<span style="color: #a0522d;">u</span> = msgpack.loads(data) <span style="color: #b22222;">#</span><span style="color: #b22222;">utf-8</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(u), u)

<span style="color: #a0522d;">u2</span> = msgpack.loads(data, raw=<span style="color: #008b8b;">True</span>) <span style="color: #b22222;">#</span><span style="color: #b22222;">&#26032;&#29256; raw=True &#29992;&#21407;&#22987;&#30340;&#65292;&#19981;&#36716;&#23383;&#31526;&#20018;&#20102;</span>
<span style="color: #483d8b;">print</span>(<span style="color: #483d8b;">type</span>(u2), u2)
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'dict'&gt; {'Persons': [{'name': 'tom', 'age': 20}, {'name': 'jerry', 'age': 18}], 'test': 'aaaaaa', 'total': 2}</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">&lt;class 'dict'&gt; {b'Persons': [{b'name': b'tom', b'age': 20}, {b'name': b'jerry', b'age': 18}], b'test': b'aaaaaa', b'total': 2}</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</section>
</div>
<div id="postamble" class="status">
    <div class=bar data-astro-cid-p3givckg>
        <div class=list data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:gnuemacs height=1em viewBox="0 0 24 24" width=1em>
                    <title>emacs</title>
                    <symbol id=ai:simple-icons:gnuemacs>
                        <path d="M12 24C5.448 24 .118 18.617.118 12S5.448 0 12 0s11.882 5.383 11.882 12S18.552 24 12 24zM12 .661C5.813.661.779 5.748.779 12S5.813 23.339 12 23.339S23.221 18.253 23.221 12S18.187.661 12 .661zM8.03 20.197s.978.069 2.236-.042c.51-.045 2.444-.235 3.891-.552c0 0 1.764-.377 2.707-.725c.987-.364 1.524-.673 1.766-1.11c-.011-.09.074-.408-.381-.599c-1.164-.488-2.514-.4-5.185-.457c-2.962-.102-3.948-.598-4.472-.997c-.503-.405-.25-1.526 1.907-2.513c1.086-.526 5.345-1.496 5.345-1.496c-1.434-.709-4.109-1.955-4.659-2.224c-.482-.236-1.254-.591-1.421-1.021c-.19-.413.448-.768.804-.87c1.147-.331 2.766-.536 4.24-.56c.741-.012.861-.059.861-.059c1.022-.17 1.695-.869 1.414-1.976c-.252-1.13-1.579-1.795-2.84-1.565c-1.188.217-4.05 1.048-4.05 1.048c3.539-.031 4.131.028 4.395.398c.156.218-.071.518-1.015.672c-1.027.168-3.163.37-3.163.37c-2.049.122-3.492.13-3.925 1.046c-.283.599.302 1.129.558 1.46c1.082 1.204 2.646 1.853 3.652 2.331c.379.18 1.49.52 1.49.52c-3.265-.18-5.619.823-7.001 1.977c-1.562 1.445-.871 3.168 2.33 4.228c1.891.626 2.828.921 5.648.667c1.661-.09 1.923-.036 1.939.1c.023.192-1.845.669-2.355.816c-1.298.374-4.699 1.129-4.716 1.133z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:gnuemacs></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Emacs</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:org height=1em viewBox="0 0 24 24" width=1em>
                    <title>org-mode</title>
                    <symbol id=ai:simple-icons:org>
                        <path d="M17.169 0c-.566.004-2.16 3.312-3.376 5.94a2.19 2.19 0 0 1-.408-1.267c-.03-.582-1.089.237-.936 1.275c-.068-.035-1.26.227-1.26.23c-.23-.93-.802-1.618-1.15-.563c-.701 1.663-.88 2.984.115 4.585c-.908 4.058-6.948 6.053-6.32 9.33c.175.004 1.634 3.48 6.337 2.057c5.557-1.577 8.624 2.116 8.978 2.375c.52.526-1.348-4.573-5.302-6.865c-2.339-1.276-.87-3.474-.703-4.25c0 0 1.874 1.312 3.232-.692c1.227.316 2.05-.224 3.105.158c.64.28 3.336.11 2.334-1.396c-.148.129.07.27-.075.46c-.043.056-.128.232-.408.315c-.314.149-.83.27-1.43-.37c-.434-.32-.748-.04-.992-.063c.152-.098.577-.315 1.264-.315c.388 0 .594.336.854.338c.174 0 .685-.262.787-.365c.63-.41.697-.278 1.012-.905c.17-.759-.215-.92-.332-1.129c-.032-.483-.436-.67-.919-.326c-1.106-.198-2.192-.105-2.728-.15c-1.175-.164-2.153-.786-2.153-.786c.143-.19.075-.6-.842-.628c-.315-.104-.45-.2-.745-.307c.61-1.37.674-2.007 1.418-4.004c.261-1.053 1.039-2.685.643-2.682zm-4.297 8.093c.03-.086.443.138.952.176c.395.03.805.048 1.296-.025c.03-.005.172.095-.15.194c-.02.01-.062-.01-.065.196c0 .022-.01.04-.02.046c-.15.152-.708.223-1.065.1c-.436-.17-.482-.316-.517-.443c-.305-.147-.47-.123-.43-.244zM9.685 10.2C8.86 9 8.929 8.36 8.96 7.256C7.961 8.288 6.855 8.3 5.18 8.58c-1.299.234-3.657 2.447-4.025 4.742c-.043.608-.08 2.183.424 3.498c.492 1.13.828 1.727 1.844 2.335c-.882-3.169 5.296-5.33 6.263-8.955z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:org></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Orgmode</p>
                </div>
            </span>
            <a href=/donations.html class=entry data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=simple-icons:astro height=1em viewBox="0 0 24 24" width=1em>
                    <title>Donations</title>
                    <symbol id=ai:simple-icons:astro>
                        <path d="M8.358 20.162c-1.186-1.07-1.532-3.316-1.038-4.944c.856 1.026 2.043 1.352 3.272 1.535c1.897.283 3.76.177 5.522-.678c.202-.098.388-.229.608-.36c.166.473.209.95.151 1.437c-.14 1.185-.738 2.1-1.688 2.794c-.38.277-.782.525-1.175.787c-1.205.804-1.531 1.747-1.078 3.119l.044.148a3.158 3.158 0 0 1-1.407-1.188a3.31 3.31 0 0 1-.544-1.815c-.004-.32-.004-.642-.048-.958c-.106-.769-.472-1.113-1.161-1.133c-.707-.02-1.267.411-1.415 1.09c-.012.053-.028.104-.045.165h.002zm-5.961-4.445s3.24-1.575 6.49-1.575l2.451-7.565c.092-.366.36-.614.662-.614c.302 0 .57.248.662.614l2.45 7.565c3.85 0 6.491 1.575 6.491 1.575L16.088.727C15.93.285 15.663 0 15.303 0H8.697c-.36 0-.615.285-.784.727l-5.516 14.99z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:simple-icons:astro></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>打赏</p>
                </div>
            </span>
            </a>
            <span class=entry data-astro-cid-p3givckg>
                <svg xmlns="http://www.w3.org/2000/svg" class=heading data-astro-cid-p3givckg data-icon=simple-icons:copyright width="1em" height="1em" viewBox="0 0 24 24">
                    <title>Copyright</title>
                    <path fill="currentColor" d="M19 2a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3zm-5 5h-4a1 1 0 0 0-1 1l.007.117A1 1 0 0 0 10 9h3v5a1 1 0 0 1-1.993.117L11 14a1 1 0 0 0-2 0a3 3 0 0 0 6 0V8a1 1 0 0 0-1-1" />
                    <use xlink:href=#ai:simple-icons:copyright></use>
                </svg>
                <div class="content left" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>© 2025 Jasper Hsu</p>
                </div>
            </span>
        </div>
        <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ class="list license" data-astro-cid-p3givckg>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Creative Commons</title>
                    <symbol id=ai:fa6-brands:creative-commons>
                        <path d="m245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93c-22.13 0-33.22 14.61-33.22 43.84c0 23.57 9.21 43.84 33.22 43.84c14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98c-22.6 0-73.96-10.32-73.96-77.05c0-58.69 43-77.06 72.63-77.06c30.72-.01 52.7 11.95 65.99 35.86zm143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93c-22.14 0-33.22 14.61-33.22 43.84c0 23.55 9.23 43.84 33.22 43.84c14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98c-22.69 0-73.96-9.87-73.96-77.05c0-58.67 42.97-77.06 72.63-77.06c30.71-.01 52.58 11.95 65.56 35.86zM247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248c129.93 0 248.44-100.87 248.44-248c0-137.87-106.62-248-248.44-248zm.87 450.81c-112.54 0-203.7-93.04-203.7-202.81c0-105.42 85.43-203.27 203.72-203.27c112.53 0 202.82 89.46 202.82 203.26c-.01 121.69-99.68 202.82-202.84 202.82z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Creative Commons</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-by height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Attribute</title>
                    <symbol id=ai:fa6-brands:creative-commons-by>
                        <path d="M314.9 194.4v101.4h-28.3v120.5h-77.1V295.9h-28.3V194.4c0-4.4 1.6-8.2 4.6-11.3c3.1-3.1 6.9-4.7 11.3-4.7H299c4.1 0 7.8 1.6 11.1 4.7c3.1 3.2 4.8 6.9 4.8 11.3zm-101.5-63.7c0-23.3 11.5-35 34.5-35s34.5 11.7 34.5 35c0 23-11.5 34.5-34.5 34.5s-34.5-11.5-34.5-34.5zM247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256C0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8c103.2 0 202.8-81.1 202.8-202.8c.1-113.8-90.2-203.3-202.8-203.3z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-by></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Attribute</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-nc height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Noncommercial</title>
                    <symbol id=ai:fa6-brands:creative-commons-nc>
                        <path d="M247.6 8C387.4 8 496 115.9 496 256c0 147.2-118.5 248-248.4 248C113.1 504 0 393.2 0 256C0 123.1 104.7 8 247.6 8zM55.8 189.1c-7.4 20.4-11.1 42.7-11.1 66.9c0 110.9 92.1 202.4 203.7 202.4c122.4 0 177.2-101.8 178.5-104.1l-93.4-41.6c-7.7 37.1-41.2 53-68.2 55.4v38.1h-28.8V368c-27.5-.3-52.6-10.2-75.3-29.7l34.1-34.5c31.7 29.4 86.4 31.8 86.4-2.2c0-6.2-2.2-11.2-6.6-15.1c-14.2-6-1.8-.1-219.3-97.4zM248.4 52.3c-38.4 0-112.4 8.7-170.5 93l94.8 42.5c10-31.3 40.4-42.9 63.8-44.3v-38.1h28.8v38.1c22.7 1.2 43.4 8.9 62 23L295 199.7c-42.7-29.9-83.5-8-70 11.1c53.4 24.1 43.8 19.8 93 41.6l127.1 56.7c4.1-17.4 6.2-35.1 6.2-53.1c0-57-19.8-105-59.3-143.9c-39.3-39.9-87.2-59.8-143.6-59.8z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-nc></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Noncommercial</p>
                </div>
            </span>
            <span class=entry data-astro-cid-p3givckg>
                <svg class=heading data-astro-cid-p3givckg data-icon=fa6-brands:creative-commons-sa height=1em viewBox="0 0 496 512" width=0.97em>
                    <title>Share Alike</title>
                    <symbol id=ai:fa6-brands:creative-commons-sa>
                        <path d="M247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256C0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8c103.2 0 202.8-81.1 202.8-202.8c.1-113.8-90.2-203.3-202.8-203.3zM137.7 221c13-83.9 80.5-95.7 108.9-95.7c99.8 0 127.5 82.5 127.5 134.2c0 63.6-41 132.9-128.9 132.9c-38.9 0-99.1-20-109.4-97h62.5c1.5 30.1 19.6 45.2 54.5 45.2c23.3 0 58-18.2 58-82.8c0-82.5-49.1-80.6-56.7-80.6c-33.1 0-51.7 14.6-55.8 43.8h18.2l-49.2 49.2l-49-49.2h19.4z" fill=currentColor/>
                    </symbol>
                    <use xlink:href=#ai:fa6-brands:creative-commons-sa></use>
                </svg>
                <div class="content right" data-astro-cid-p3givckg>
                    <p data-astro-cid-p3givckg>Share Alike</p>
                </div>
            </span>
        </a>
    </div>
<!--
<script type="text/javascript" src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/bootstrap@5.2.1/dist/js/bootstrap.min.js"></script>
<div id="back-to-top" class=""><svg viewBox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg></div>
-->
</div>
</body>
</html>
